(self.webpackChunkSyndash_angular=self.webpackChunkSyndash_angular||[]).push([[179],{3709:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{e:()=>wt});var D=fe(520),A=(fe(2340),fe(8505)),l=fe(4004),oe=fe(262),lt=fe(9646);class Ke{constructor(st,at,ft,tn,kt,dn,Qn,on,Cn,se,Wi,ii){this.id=st,this.nombre=at,this.apellidos=ft,this.email=tn,this.password=kt,this.imagen=dn,this.rol=Qn,this.google=on,this.estado=Cn,this.cantidad_reportes=se,this.created_at=Wi,this.updated_at=ii}get imagenUrl(){return this.imagen?this.imagen.includes("https")?this.imagen:this.imagen?`\u200bhttp://3.95.196.218/api/usuarios/getImagenById/${this.imagen}`:"\u200bhttp://3.95.196.218/api/usuarios/getImagenById/no-image":"\u200bhttp://3.95.196.218/api/usuarios/getImagenById/no-image"}}var ct=fe(1810),_t=fe(4893);let wt=(()=>{class Bt{constructor(at,ft){this.http=at,this.router=ft,this.router.events.subscribe(tn=>{tn instanceof ct.m2&&(this.id=this.router.url.split("/").pop(),this.id2=this.router.url.split("/").pop())})}get idUser(){return this.usuario.id}register(at,ft,tn,kt){return this.http.post("http://3.95.196.218/api/registro",{nombre:at,apellidos:ft,email:tn,password:kt}).pipe((0,A.b)(on=>{localStorage.setItem("token",on.token)}))}login(at,ft){return this.http.post("http://3.95.196.218/api/login",{email:at,password:ft}).pipe((0,A.b)(kt=>{localStorage.setItem("token",kt.token)}))}validarToken(){const at=localStorage.getItem("token")||"",ft=new D.WM({"Content-Type":"application/json",Authorization:"Bearer "+at});return this.http.get("http://3.95.196.218/api/renew",{headers:ft}).pipe((0,A.b)(tn=>{console.log(tn),console.log("entro");const{id:kt,nombre:dn,apellidos:Qn,email:on,password:Cn,imagen:se,rol:Wi,google:ii,estado:kn}=tn.user;this.usuario=new Ke(kt,dn,Qn,on,Cn,se,Wi,ii,kn),console.log(this.usuario),localStorage.setItem("token",tn.token)}),(0,l.U)(tn=>!0),(0,oe.K)(tn=>(0,lt.of)(!1)))}actualizarPerfil(at){return at=Object.assign(Object.assign({},at),{nombre:at.nombre,apellidos:at.apellidos,email:at.email}),this.http.post(`http://3.95.196.218/api/actualizar/${this.id}`,at,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}})}loginGoogle(at){return this.http.post("http://3.95.196.218/api/google",{token:at}).pipe((0,A.b)(ft=>{localStorage.setItem("token",ft.token)}))}getHeaders(){return{headers:new D.WM({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})}}get rol(){return this.usuario.rol||""}logout(){localStorage.removeItem("token")}verificarCodigo(at){return this.http.post("http://3.95.196.218/api/verificar_codigo",{codigo:at})}reenviarCodigo(at){return this.http.post("http://3.95.196.218/api/reenviar_codigo_email",{email:at})}olvidoConstraseina(at){return this.http.post("http://3.95.196.218/api/recuperar_contrasenia",{email:at})}olvidoContra(at,ft){const kt={password:at,confirmarPassword:ft};return console.log(this.id),this.http.put(`http://3.95.196.218/api/olvido_contrasenia/${this.id}`,kt)}cambiarContra(at,ft,tn){const kt={contrasenaActual:at,contrasenaNueva:ft,contrasenaConfirmar:tn};return console.log(this.id2),this.http.put(`http://3.95.196.218/api/cambiar_contrasenia/${this.id2}`,kt)}cambiarContraPerfil(at,ft,tn){const kt={contrasenaActual:at,contrasenaNueva:ft,contrasenaConfirmar:tn};return console.log(this.id2),this.http.put(`http://3.95.196.218/api/cambiar_contraseniaperfil/${this.idUser}`,kt,this.getHeaders())}}return Bt.\u0275fac=function(at){return new(at||Bt)(_t.LFG(D.eN),_t.LFG(ct.F0))},Bt.\u0275prov=_t.Yz7({token:Bt,factory:Bt.\u0275fac,providedIn:"root"}),Bt})()},1305:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{J:()=>A});var D=fe(5861),N=fe(4893);let A=(()=>{class l{constructor(){}actualizarFoto(lt,At,Ke){return(0,D.Z)(function*(){const ct=localStorage.getItem("token")||"";try{const _t="http://3.95.196.218/api/actualizar_imagen/"+At+"/"+Ke,Nt=new FormData;Nt.append("imagen",lt);const Bt=yield(yield fetch(_t,{method:"POST",headers:{Authorization:"Bearer "+ct},body:Nt})).json();return console.log(Bt),Bt?(console.log("entro if"),Bt.nombreArchivo):(console.log("entro else"),console.log(Bt.msg),!1)}catch(_t){return console.log("entro error catch"),console.log(_t),!1}})()}actualizarFotoRepo(lt,At,Ke){return(0,D.Z)(function*(){console.log("fileupload",Ke);const ct=localStorage.getItem("token")||"";try{const _t="http://3.95.196.218/api/actualizar_imagen/reportes/"+Ke,Nt=new FormData;Nt.append("imagen",lt);const Bt=yield(yield fetch(_t,{method:"POST",headers:{Authorization:"Bearer "+ct},body:Nt})).json();return console.log(Bt),Bt?(console.log("entro if"),Bt.nombreArchivo):(console.log("entro else"),console.log(Bt.msg),!1)}catch(_t){return console.log("entro error catch"),console.log(_t),!1}})()}}return l.\u0275fac=function(lt){return new(lt||l)},l.\u0275prov=N.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})()},7592:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{e:()=>l});var D=fe(5861),N=fe(4893),A=fe(520);let l=(()=>{class oe{constructor(At){this.http=At,this._ocultarModal=!0,this.tipo="usuarios",this.nuevaImagen=new N.vpe,this.noImg="defaul"}get ocultarModal(){return this._ocultarModal}abrirModal(At,Ke,ct="no-img"){!this._ocultarModal||(this._ocultarModal=!1,this.tipo=At,this.id=Ke,this.img=ct,this.img="no-img"===this.img?"http://3.95.196.218/api/"+At+"/getImagenById/"+this.noImg:"http://3.95.196.218/api/"+At+"/getImagenById/"+ct)}cerrarModal(){this._ocultarModal=!0}delvolverImgen(At){var Ke=this;return(0,D.Z)(function*(){const _t=`http://3.95.196.218/api/reportes/getImagenById/${At}`;try{const Nt=localStorage.getItem("token")||"",wt=new A.WM({"Content-Type":"application/json",Authorization:"Bearer "+Nt}),Bt=yield Ke.http.get(_t,{headers:wt}).toPromise();return Ke.img=Bt.url||"",Ke.img}catch(Nt){return console.log("Error al obtener la imagen:",Nt),null}})()}}return oe.\u0275fac=function(At){return new(At||oe)(N.LFG(A.eN))},oe.\u0275prov=N.Yz7({token:oe,factory:oe.\u0275fac,providedIn:"root"}),oe})()},9131:(Bi,Zt,fe)=>{"use strict";fe.r(Zt),fe.d(Zt,{DashboardModule:()=>tn});var D=fe(9808),N=fe(1810),A=fe(4893),l=fe(5436),oe=fe(937);let lt=(()=>{class kt{constructor(){}ngOnInit(){$.getScript("./assets/js/analytics-dashboard.js")}}return kt.\u0275fac=function(Qn){return new(Qn||kt)},kt.\u0275cmp=A.Xpm({type:kt,selectors:[["app-analytics"]],decls:531,vars:0,consts:[[1,"row"],[1,"col-12","col-lg-4"],[1,"card","radius-15","overflow-hidden"],[1,"card-body"],[1,"d-flex"],[1,"mb-0","font-weight-bold"],[1,"mb-0"],[1,"ms-auto","align-self-end"],[1,"mb-0","font-14","text-primary"],[1,"bx","bxs-up-arrow-circle"],["id","chart1"],[1,"mb-0","font-14","text-success"],["id","chart2"],[1,"mb-0","font-14","text-danger"],[1,"bx","bxs-down-arrow-circle"],["id","chart3"],[1,"col-12","col-lg-8","d-flex"],[1,"card","radius-15","w-100"],[1,"card-header","border-bottom-0"],[1,"d-flex","align-items-center"],[1,"mb-lg-0"],[1,"ms-auto","mb-2","mb-lg-0"],[1,"btn-group-round"],[1,"btn-group"],["type","button",1,"btn","btn-white"],["ngbDropdown","","role","group","aria-label","Button group with nested dropdown",1,"btn-group"],["ngbDropdownToggle","",1,"btn","btn-white","dropdown-toggle","dropdown-toggle-split"],["ngbDropdownMenu","",1,"dropdown-menu"],["ngbDropdownItem",""],["id","chart4"],[1,"col-12","col-lg-4","d-flex"],[1,"d-lg-flex","align-items-center"],[1,"mb-4"],["id","chart5"],[1,"list-group","list-group-flush","mb-0"],[1,"list-group-item","border-top","d-flex","justify-content-between","align-items-center","bg-transparent"],[1,"badge","bg-danger","rounded-pill"],[1,"list-group-item","d-flex","justify-content-between","align-items-center","bg-transparent"],[1,"badge","bg-primary","rounded-pill"],[1,"badge","bg-warning","rounded-pill","text-dark"],[1,"col-12","col-lg-12","col-xl-6","d-flex"],[1,"row","row-cols-1","row-cols-md-3","g-3"],[1,"col"],[1,"card","radius-15","mb-0","shadow-none","border"],[1,"card-body","text-center"],[1,"widgets-icons","mx-auto","rounded-circle","bg-info","text-white"],[1,"bx","bx-time"],[1,"mb-0","font-weight-bold","mt-3"],[1,"widgets-icons","mx-auto","bg-wall","text-white","rounded-circle"],[1,"bx","bx-bookmark-alt"],[1,"widgets-icons","mx-auto","bg-rose","rounded-circle","text-white"],[1,"bx","bx-bulb"],[1,"widgets-icons","mx-auto","rounded-circle","bg-danger","text-white"],[1,"bx","bx-line-chart"],[1,"widgets-icons","mx-auto","bg-primary","rounded-circle","text-white"],[1,"bx","bx-group"],[1,"widgets-icons","mx-auto","bg-success","text-white","rounded-circle"],[1,"bx","bx-cloud-download"],[1,"d-lg-flex","align-items-center","mb-4"],[1,"ms-auto"],[1,"font-14"],[1,"dashboard-social-list",3,"perfectScrollbar"],[1,"list-group","list-group-flush"],[1,"list-group-item","d-flex","align-items-center"],[1,"d-flex","align-items-center","gap-2"],[1,"widgets-social","bg-youtube","rounded-circle","text-white"],[1,"bx","bxl-youtube"],[1,""],[1,"widgets-social","bg-facebook","rounded-circle","text-white"],[1,"bx","bxl-facebook"],[1,"widgets-social","bg-linkedin","rounded-circle","text-white"],[1,"bx","bxl-linkedin"],[1,"widgets-social","bg-twitter","rounded-circle","text-white"],[1,"bx","bxl-twitter"],[1,"widgets-social","bg-tumblr","rounded-circle","text-white"],[1,"bx","bxl-tumblr"],[1,"widgets-social","bg-dribbble","rounded-circle","text-white"],[1,"bx","bxl-dribbble"],[1,"col-12","col-lg-12","col-xl-8"],[1,"card","radius-15"],[1,"card-title"],["id","geographic-map"],[1,"col-12","col-lg-12","col-xl-4"],[1,"dashboard-top-countries",3,"perfectScrollbar"],[1,"font-20"],[1,"flag-icon","flag-icon-in"],[1,"flag-icon","flag-icon-us"],[1,"media-body","ml-2"],[1,"flag-icon","flag-icon-vn"],[1,"flag-icon","flag-icon-au"],[1,"flag-icon","flag-icon-dz"],[1,"flag-icon","flag-icon-ax"],[1,"flag-icon","flag-icon-ar"],[1,"flag-icon","flag-icon-be"],[1,"row","row-cols-1","row-cols-lg-3"],[1,"col","d-flex"],[1,"d-flex","align-items-center","gap-3"],["src","assets/images/icons/chrome.png","width","35","height","35","alt",""],[1,"mb-0","ms-auto"],["src","assets/images/icons/firefox.png","width","35","height","35","alt",""],["src","assets/images/icons/edge.png","width","35","height","35","alt",""],["src","assets/images/icons/opera.png","width","35","height","35","alt",""],["src","assets/images/icons/safari.png","width","35","height","35","alt",""],[1,"table-responsive"],[1,"table","table-striped","mb-0"],["id","chart6"],[1,"table","mb-0"],[1,"thead-dark"],["href","https://themeforest.net/item/synadmin-bootstrap4-admin-template/29014766","target","_blank"],["href","https://codervent.com/wipe-admin-dark/dashboard/v3","target","_blank"],["href","https://themeforest.net/item/dashtreme-multipurpose-bootstrap4-admin-template/23059455","target","_blank"],["href","https://themeforest.net/item/rukada-responsive-bootstrap-4-admin-template/22820477","target","_blank"],["href","https://codervent.com/rocker-angular/dashboard/v1","target","_blank"]],template:function(Qn,on){1&Qn&&(A.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div")(6,"p",5),A._uU(7,"Sessions"),A.qZA(),A.TgZ(8,"h2",6),A._uU(9,"501"),A.qZA()(),A.TgZ(10,"div",7)(11,"p",8),A._UZ(12,"i",9),A.TgZ(13,"span"),A._uU(14,"1.01% 31 days ago"),A.qZA()()()(),A._UZ(15,"div",10),A.qZA()()(),A.TgZ(16,"div",1)(17,"div",2)(18,"div",3)(19,"div",4)(20,"div")(21,"p",5),A._uU(22,"Visitors"),A.qZA(),A.TgZ(23,"h2",6),A._uU(24,"409"),A.qZA()(),A.TgZ(25,"div",7)(26,"p",11),A._UZ(27,"i",9),A.TgZ(28,"span"),A._uU(29,"0.49% 31 days ago"),A.qZA()()()(),A._UZ(30,"div",12),A.qZA()()(),A.TgZ(31,"div",1)(32,"div",2)(33,"div",3)(34,"div",4)(35,"div")(36,"p",5),A._uU(37,"Page Views"),A.qZA(),A.TgZ(38,"h2",6),A._uU(39,"2,346"),A.qZA()(),A.TgZ(40,"div",7)(41,"p",13),A._UZ(42,"i",14),A.TgZ(43,"span"),A._uU(44,"130.68% 31 days ago"),A.qZA()()()(),A._UZ(45,"div",15),A.qZA()()()(),A.TgZ(46,"div",0)(47,"div",16)(48,"div",17)(49,"div",18)(50,"div",19)(51,"div")(52,"h5",20),A._uU(53,"New VS Returning Visitors"),A.qZA()(),A.TgZ(54,"div",21)(55,"div",22)(56,"div",23)(57,"button",24),A._uU(58,"This Month"),A.qZA(),A.TgZ(59,"div",25),A._UZ(60,"button",26),A.TgZ(61,"div",27)(62,"button",28),A._uU(63,"This Week"),A.qZA(),A.TgZ(64,"button",28),A._uU(65,"This Year"),A.qZA()()()()()()()(),A.TgZ(66,"div",3),A._UZ(67,"div",29),A.qZA()()(),A.TgZ(68,"div",30)(69,"div",17)(70,"div",3)(71,"div",31)(72,"div")(73,"h5",32),A._uU(74,"Devices of Visitors"),A.qZA()()(),A._UZ(75,"div",33),A.qZA(),A.TgZ(76,"ul",34)(77,"li",35),A._uU(78,"Mobile"),A.TgZ(79,"span",36),A._uU(80,"25%"),A.qZA()(),A.TgZ(81,"li",37),A._uU(82,"Desktop"),A.TgZ(83,"span",38),A._uU(84,"65%"),A.qZA()(),A.TgZ(85,"li",37),A._uU(86,"Tablet"),A.TgZ(87,"span",39),A._uU(88,"10%"),A.qZA()()()()()(),A.TgZ(89,"div",0)(90,"div",40)(91,"div",17)(92,"div",3)(93,"div",41)(94,"div",42)(95,"div",43)(96,"div",44)(97,"div",45),A._UZ(98,"i",46),A.qZA(),A.TgZ(99,"h4",47),A._uU(100,"2m 28s"),A.qZA(),A.TgZ(101,"p",6),A._uU(102,"Avg. Time on Site"),A.qZA()()()(),A.TgZ(103,"div",42)(104,"div",43)(105,"div",44)(106,"div",48),A._UZ(107,"i",49),A.qZA(),A.TgZ(108,"h4",47),A._uU(109,"4.68"),A.qZA(),A.TgZ(110,"p",6),A._uU(111,"Pages/Session"),A.qZA()()()(),A.TgZ(112,"div",42)(113,"div",43)(114,"div",44)(115,"div",50),A._UZ(116,"i",51),A.qZA(),A.TgZ(117,"h4",47),A._uU(118,"78%"),A.qZA(),A.TgZ(119,"p",6),A._uU(120,"New Sessions"),A.qZA()()()(),A.TgZ(121,"div",42)(122,"div",43)(123,"div",44)(124,"div",52),A._UZ(125,"i",53),A.qZA(),A.TgZ(126,"h4",47),A._uU(127,"23.4%"),A.qZA(),A.TgZ(128,"p",6),A._uU(129,"Bounce Rate"),A.qZA()()()(),A.TgZ(130,"div",42)(131,"div",43)(132,"div",44)(133,"div",54),A._UZ(134,"i",55),A.qZA(),A.TgZ(135,"h4",47),A._uU(136,"4,286"),A.qZA(),A.TgZ(137,"p",6),A._uU(138,"New Users"),A.qZA()()()(),A.TgZ(139,"div",42)(140,"div",43)(141,"div",44)(142,"div",56),A._UZ(143,"i",57),A.qZA(),A.TgZ(144,"h4",47),A._uU(145,"78%"),A.qZA(),A.TgZ(146,"p",6),A._uU(147,"Downloads"),A.qZA()()()()()()()(),A.TgZ(148,"div",40)(149,"div",17)(150,"div",3)(151,"div",58)(152,"div")(153,"h5",6),A._uU(154,"Social Media Traffic"),A.qZA()(),A.TgZ(155,"div",59)(156,"h3",6)(157,"span",60),A._uU(158,"Total Visits:"),A.qZA(),A._uU(159," 874"),A.qZA()()(),A._UZ(160,"hr"),A.TgZ(161,"div",61)(162,"ul",62)(163,"li",63)(164,"div",64)(165,"div",65),A._UZ(166,"i",66),A.qZA(),A.TgZ(167,"div",67)(168,"h6",6),A._uU(169,"YouTube"),A.qZA()()(),A.TgZ(170,"div",59),A._uU(171,"298"),A.qZA()(),A.TgZ(172,"li",63)(173,"div",64)(174,"div",68),A._UZ(175,"i",69),A.qZA(),A.TgZ(176,"div",67)(177,"h6",6),A._uU(178,"Facebook"),A.qZA()()(),A.TgZ(179,"div",59),A._uU(180,"324"),A.qZA()(),A.TgZ(181,"li",63)(182,"div",64)(183,"div",70),A._UZ(184,"i",71),A.qZA(),A.TgZ(185,"div",67)(186,"h6",6),A._uU(187,"Linkedin"),A.qZA()()(),A.TgZ(188,"div",59),A._uU(189,"127"),A.qZA()(),A.TgZ(190,"li",63)(191,"div",64)(192,"div",72),A._UZ(193,"i",73),A.qZA(),A.TgZ(194,"div",67)(195,"h6",6),A._uU(196,"Twitter"),A.qZA()()(),A.TgZ(197,"div",59),A._uU(198,"325"),A.qZA()(),A.TgZ(199,"li",63)(200,"div",64)(201,"div",74),A._UZ(202,"i",75),A.qZA(),A.TgZ(203,"div",67)(204,"h6",6),A._uU(205,"Tumblr"),A.qZA()()(),A.TgZ(206,"div",59),A._uU(207,"287"),A.qZA()(),A.TgZ(208,"li",63)(209,"div",64)(210,"div",76),A._UZ(211,"i",77),A.qZA(),A.TgZ(212,"div",67)(213,"h6",6),A._uU(214,"Dribbble"),A.qZA()()(),A.TgZ(215,"div",59),A._uU(216,"154"),A.qZA()()()()()()()(),A.TgZ(217,"div",0)(218,"div",78)(219,"div",79)(220,"div",3)(221,"div",80)(222,"h5",6),A._uU(223,"Geographic"),A.qZA()(),A._UZ(224,"hr")(225,"div",81),A.qZA()()(),A.TgZ(226,"div",82)(227,"div",79)(228,"div",3)(229,"div",58)(230,"div")(231,"h5",6),A._uU(232,"Top countries"),A.qZA()(),A.TgZ(233,"div",59)(234,"h3",6)(235,"span",60),A._uU(236,"Total Visits:"),A.qZA(),A._uU(237," 9587"),A.qZA()()(),A._UZ(238,"hr"),A.TgZ(239,"div",83)(240,"ul",62)(241,"li",63)(242,"div",64)(243,"div",84),A._UZ(244,"i",85),A.qZA(),A.TgZ(245,"div",67)(246,"h6",6),A._uU(247,"India"),A.qZA()()(),A.TgZ(248,"div",59),A._uU(249,"647"),A.qZA()(),A.TgZ(250,"li",63)(251,"div",64)(252,"div",84),A._UZ(253,"i",86),A.qZA(),A.TgZ(254,"div",87)(255,"h6",6),A._uU(256,"United States"),A.qZA()()(),A.TgZ(257,"div",59),A._uU(258,"435"),A.qZA()(),A.TgZ(259,"li",63)(260,"div",64)(261,"div",84),A._UZ(262,"i",88),A.qZA(),A.TgZ(263,"div",67)(264,"h6",6),A._uU(265,"Vietnam"),A.qZA()()(),A.TgZ(266,"div",59),A._uU(267,"287"),A.qZA()(),A.TgZ(268,"li",63)(269,"div",64)(270,"div",84),A._UZ(271,"i",89),A.qZA(),A.TgZ(272,"div",67)(273,"h6",6),A._uU(274,"Australia"),A.qZA()()(),A.TgZ(275,"div",59),A._uU(276,"432"),A.qZA()(),A.TgZ(277,"li",63)(278,"div",64)(279,"div",84),A._UZ(280,"i",90),A.qZA(),A.TgZ(281,"div",67)(282,"h6",6),A._uU(283,"Angola"),A.qZA()()(),A.TgZ(284,"div",59),A._uU(285,"345"),A.qZA()(),A.TgZ(286,"li",63)(287,"div",64)(288,"div",84),A._UZ(289,"i",91),A.qZA(),A.TgZ(290,"div",67)(291,"h6",6),A._uU(292,"Aland Islands"),A.qZA()()(),A.TgZ(293,"div",59),A._uU(294,"134"),A.qZA()(),A.TgZ(295,"li",63)(296,"div",64)(297,"div",84),A._UZ(298,"i",92),A.qZA(),A.TgZ(299,"div",67)(300,"h6",6),A._uU(301,"Argentina"),A.qZA()()(),A.TgZ(302,"div",59),A._uU(303,"147"),A.qZA()(),A.TgZ(304,"li",63)(305,"div",64)(306,"div",84),A._UZ(307,"i",93),A.qZA(),A.TgZ(308,"div",67)(309,"h6",6),A._uU(310,"Belgium"),A.qZA()()(),A.TgZ(311,"div",59),A._uU(312,"210"),A.qZA()()()()()()()(),A.TgZ(313,"div",94)(314,"div",95)(315,"div",17)(316,"div",3)(317,"div",80)(318,"h5",6),A._uU(319,"Browser Statistics "),A.qZA()(),A._UZ(320,"hr"),A.TgZ(321,"div",96)(322,"div"),A._UZ(323,"img",97),A.qZA(),A.TgZ(324,"div",67)(325,"h6",6),A._uU(326,"587"),A.qZA(),A.TgZ(327,"p",6),A._uU(328,"Chrome"),A.qZA()(),A.TgZ(329,"p",98),A._uU(330,"24.3%"),A.qZA()(),A._UZ(331,"hr"),A.TgZ(332,"div",96)(333,"div"),A._UZ(334,"img",99),A.qZA(),A.TgZ(335,"div",67)(336,"h6",6),A._uU(337,"358"),A.qZA(),A.TgZ(338,"p",6),A._uU(339,"Firefox"),A.qZA()(),A.TgZ(340,"p",98),A._uU(341,"12.3%"),A.qZA()(),A._UZ(342,"hr"),A.TgZ(343,"div",96)(344,"div"),A._UZ(345,"img",100),A.qZA(),A.TgZ(346,"div",67)(347,"h6",6),A._uU(348,"867"),A.qZA(),A.TgZ(349,"p",6),A._uU(350,"Edge"),A.qZA()(),A.TgZ(351,"p",98),A._uU(352,"24.3%"),A.qZA()(),A._UZ(353,"hr"),A.TgZ(354,"div",96)(355,"div"),A._UZ(356,"img",101),A.qZA(),A.TgZ(357,"div",67)(358,"h6",6),A._uU(359,"752"),A.qZA(),A.TgZ(360,"p",6),A._uU(361,"Opera"),A.qZA()(),A.TgZ(362,"p",98),A._uU(363,"27.3%"),A.qZA()(),A._UZ(364,"hr"),A.TgZ(365,"div",96)(366,"div"),A._UZ(367,"img",102),A.qZA(),A.TgZ(368,"div",67)(369,"h6",6),A._uU(370,"586"),A.qZA(),A.TgZ(371,"p",6),A._uU(372,"Safari"),A.qZA()(),A.TgZ(373,"p",98),A._uU(374,"14.5%"),A.qZA()()()()(),A.TgZ(375,"div",95)(376,"div",17)(377,"div",3)(378,"div",80)(379,"h5",6),A._uU(380,"Traffic Sources "),A.qZA()(),A._UZ(381,"hr"),A.TgZ(382,"div",103)(383,"table",104)(384,"thead")(385,"tr")(386,"th"),A._uU(387,"Source"),A.qZA(),A.TgZ(388,"th"),A._uU(389,"Visitors"),A.qZA(),A.TgZ(390,"th"),A._uU(391,"Bounce Rate"),A.qZA()()(),A.TgZ(392,"tbody")(393,"tr")(394,"td"),A._uU(395,"(direct)"),A.qZA(),A.TgZ(396,"td"),A._uU(397,"56"),A.qZA(),A.TgZ(398,"td"),A._uU(399,"10%"),A.qZA()(),A.TgZ(400,"tr")(401,"td"),A._uU(402,"google"),A.qZA(),A.TgZ(403,"td"),A._uU(404,"29"),A.qZA(),A.TgZ(405,"td"),A._uU(406,"12%"),A.qZA()(),A.TgZ(407,"tr")(408,"td"),A._uU(409,"linkedin.com"),A.qZA(),A.TgZ(410,"td"),A._uU(411,"68"),A.qZA(),A.TgZ(412,"td"),A._uU(413,"33%"),A.qZA()(),A.TgZ(414,"tr")(415,"td"),A._uU(416,"bing"),A.qZA(),A.TgZ(417,"td"),A._uU(418,"14"),A.qZA(),A.TgZ(419,"td"),A._uU(420,"24%"),A.qZA()(),A.TgZ(421,"tr")(422,"td"),A._uU(423,"facebook.com"),A.qZA(),A.TgZ(424,"td"),A._uU(425,"87"),A.qZA(),A.TgZ(426,"td"),A._uU(427,"22%"),A.qZA()(),A.TgZ(428,"tr")(429,"td"),A._uU(430,"twitter.com"),A.qZA(),A.TgZ(431,"td"),A._uU(432,"88"),A.qZA(),A.TgZ(433,"td"),A._uU(434,"43%"),A.qZA()(),A.TgZ(435,"tr")(436,"td"),A._uU(437,"other"),A.qZA(),A.TgZ(438,"td"),A._uU(439,"98"),A.qZA(),A.TgZ(440,"td"),A._uU(441,"27%"),A.qZA()()()()()()()(),A.TgZ(442,"div",95)(443,"div",17)(444,"div",3)(445,"div",80)(446,"h5",6),A._uU(447,"Visitors By Gender "),A.qZA()(),A._UZ(448,"hr")(449,"div",105),A.qZA()()()(),A.TgZ(450,"div",79)(451,"div",3)(452,"div",80)(453,"h5",6),A._uU(454,"Top pages by views "),A.qZA()(),A._UZ(455,"hr"),A.TgZ(456,"div",103)(457,"table",106)(458,"thead",107)(459,"tr")(460,"th"),A._uU(461,"#"),A.qZA(),A.TgZ(462,"th"),A._uU(463,"Title"),A.qZA(),A.TgZ(464,"th"),A._uU(465,"Views"),A.qZA(),A.TgZ(466,"th"),A._uU(467,"Avg. Time"),A.qZA(),A.TgZ(468,"th"),A._uU(469,"Bounce Rate"),A.qZA()()(),A.TgZ(470,"tbody")(471,"tr")(472,"td"),A._uU(473,"1"),A.qZA(),A.TgZ(474,"td")(475,"a",108),A._uU(476,"https://themeforest.net/item/synadmin-bootstrap4-admin-template/29014766"),A.qZA()(),A.TgZ(477,"td"),A._uU(478,"660"),A.qZA(),A.TgZ(479,"td"),A._uU(480,"55s"),A.qZA(),A.TgZ(481,"td"),A._uU(482,"3.6%"),A.qZA()(),A.TgZ(483,"tr")(484,"td"),A._uU(485,"2"),A.qZA(),A.TgZ(486,"td")(487,"a",109),A._uU(488,"https://codervent.com/wipe-admin-dark/dashboard/v3"),A.qZA()(),A.TgZ(489,"td"),A._uU(490,"352"),A.qZA(),A.TgZ(491,"td"),A._uU(492,"16s"),A.qZA(),A.TgZ(493,"td"),A._uU(494,"8.4%"),A.qZA()(),A.TgZ(495,"tr")(496,"td"),A._uU(497,"3"),A.qZA(),A.TgZ(498,"td")(499,"a",110),A._uU(500,"https://themeforest.net/item/dashtreme-multipurpose-bootstrap4-admin-template/23059455"),A.qZA()(),A.TgZ(501,"td"),A._uU(502,"101"),A.qZA(),A.TgZ(503,"td"),A._uU(504,"10s"),A.qZA(),A.TgZ(505,"td"),A._uU(506,"6.7%"),A.qZA()(),A.TgZ(507,"tr")(508,"td"),A._uU(509,"4"),A.qZA(),A.TgZ(510,"td")(511,"a",111),A._uU(512,"https://themeforest.net/item/rukada-responsive-bootstrap-4-admin-template/22820477"),A.qZA()(),A.TgZ(513,"td"),A._uU(514,"95"),A.qZA(),A.TgZ(515,"td"),A._uU(516,"57s"),A.qZA(),A.TgZ(517,"td"),A._uU(518,"5.2%"),A.qZA()(),A.TgZ(519,"tr")(520,"td"),A._uU(521,"5"),A.qZA(),A.TgZ(522,"td")(523,"a",112),A._uU(524,"https://codervent.com/rocker-angular/dashboard/v1"),A.qZA()(),A.TgZ(525,"td"),A._uU(526,"102"),A.qZA(),A.TgZ(527,"td"),A._uU(528,"45s"),A.qZA(),A.TgZ(529,"td"),A._uU(530,"7.2%"),A.qZA()()()()()()())},directives:[l.jt,l.iD,l.Vi,l.TH,oe.$V],styles:[""]}),kt})(),At=(()=>{class kt{constructor(){}ngOnInit(){$.getScript("./assets/js/sales-dashboard.js")}}return kt.\u0275fac=function(Qn){return new(Qn||kt)},kt.\u0275cmp=A.Xpm({type:kt,selectors:[["app-sales"]],decls:564,vars:0,consts:[[1,"row"],[1,"col-12","col-lg-3"],[1,"card","radius-15","bg-voilet"],[1,"card-body"],[1,"d-flex","align-items-center"],[1,"mb-0","text-white"],[1,"bx","bxs-up-arrow-alt","font-14","text-white"],[1,"ms-auto","font-35","text-white"],[1,"bx","bx-cart-alt"],[1,"ms-auto","font-14","text-white"],[1,"card","radius-15","bg-primary-blue"],[1,"bx","bxs-down-arrow-alt","font-14","text-white"],[1,"bx","bx-support"],[1,"card","radius-15","bg-rose"],[1,"bx","bx-tachometer"],[1,"card","radius-15","bg-sunset"],[1,"bx","bx-user"],[1,"card","radius-15"],[1,"card-header","border-bottom-0"],[1,"d-lg-flex","align-items-center"],[1,"mb-2","mb-lg-0"],[1,"ms-lg-auto","mb-2","mb-lg-0"],[1,"btn-group-round"],[1,"btn-group"],["type","button",1,"btn","btn-white"],["id","chart1"],[1,"col-12","col-lg-6"],[1,"mb-0"],[1,"dropdown","ms-auto"],["data-bs-toggle","dropdown",1,"cursor-pointer","font-24","dropdown-toggle","dropdown-toggle-nocaret"],[1,"bx","bx-dots-horizontal-rounded"],[1,"dropdown-menu","dropdown-menu-right"],["href","javascript:;",1,"dropdown-item"],[1,"dropdown-divider"],["id","chart2"],[1,"legends"],[1,"col-12","col-lg-5"],[1,"d-flex","align-items-center","justify-content-between"],[1,"text-secondary"],[1,"bx","bxs-circle","font-13","text-primary-blue","me-2"],[1,"my-2"],[1,"bx","bxs-circle","font-13","text-shineblue","me-2"],[1,"col-12","col-lg-2"],[1,"vertical-separater"],[1,"bx","bxs-circle","font-13","text-primary","me-2"],[1,"bx","bxs-circle","font-13","text-red","me-2"],[1,"row","mt-3","g-3"],[1,"card","radius-15","border","shadow-none"],[1,"ms-auto","text-success"],[1,"ms-auto","text-purple"],["id","chart3"],[1,"col-12","col-lg-4","d-flex"],[1,"card","radius-15","w-100"],[1,"mb-4"],[1,"progress-wrapper","mb-4"],[1,"mb-1"],[1,"float-end"],[1,"progress","radius-15",2,"height","5px"],["role","progressbar",1,"progress-bar",2,"width","45%"],["role","progressbar",1,"progress-bar","bg-voilet",2,"width","55%"],["role","progressbar",1,"progress-bar","bg-red-light",2,"width","64%"],["role","progressbar",1,"progress-bar","bg-sunset",2,"width","78%"],["role","progressbar",1,"progress-bar","bg-wall",2,"width","82%"],[1,"progress-wrapper"],["role","progressbar",1,"progress-bar","bg-dark",2,"width","89%"],[1,"col-12","col-lg-8","d-flex"],[1,"d-flex","align-items-center","mb-3"],["data-bs-toggle","dropdown",1,"cursor-pointer","text-dark","font-24","dropdown-toggle","dropdown-toggle-nocaret"],[1,"row","g-3"],[1,"card","radius-15","border","shadow-none","mb-0"],[1,"card-body","pb-0"],[1,"d-flex","flex-row","align-items-center"],[1,""],[1,"text-secondary","mb-0"],[1,"fs-2","ms-auto"],[1,"bx","bx-wallet-alt"],["id","chart4",1,"ms-auto","mt-1"],[1,"bx","bx-bar-chart-alt-2"],["id","chart5",1,"ms-auto","mt-1"],[1,"bx","bx-shopping-bag"],["id","chart6",1,"ms-auto","mt-1"],[1,"bx","bx-group"],["id","chart7",1,"ms-auto","mt-1"],[1,"card","radius-15","w-100","overflow-hidden"],["id","location-map"],[1,"table-responsive"],[1,"table","mb-0"],["scope","col",1,"text-blue-ribbon"],["scope","col",1,"text-brink-pink"],["scope","col",1,"text-mountain-meadow"],[1,"flag-icon","flag-icon-um","me-2"],[1,"text-semibold"],[1,"flag-icon","flag-icon-nl","me-2"],[1,"flag-icon","flag-icon-us","me-2"],[1,"flag-icon","flag-icon-ca","me-2"],[1,"flag-icon","flag-icon-au","me-2"],[1,"mb-0","ms-auto"],[1,"bx","bx-dots-horizontal-rounded","float-right","font-24"],[1,"d-flex","align-items-center","mt-3","gap-2"],["src","assets/images/avatars/avatar-1.png","width","45","height","45","alt","",1,"rounded-circle"],[1,"flex-grow-1"],[1,"font-weight-bold","mb-0"],["href","javascript:;",1,"btn","btn-sm","btn-light-primary","px-4","radius-10"],[1,"d-flex","align-items-center","gap-2"],["src","assets/images/avatars/avatar-2.png","width","45","height","45","alt","",1,"rounded-circle"],["src","assets/images/avatars/avatar-3.png","width","45","height","45","alt","",1,"rounded-circle"],["src","assets/images/avatars/avatar-4.png","width","45","height","45","alt","",1,"rounded-circle"],["id","chart8"],[1,"card","radius-15","overflow-hidden"],[1,"ms-auto"],["type","button",1,"btn","btn-white","btn-sm","px-4","radius-15"],[1,"card-body","p-0"],[1,"product-img","bg-transparent","border"],["src","assets/images/icons/smartphone.png","width","35","alt",""],["href","javascript:;",1,"btn","btn-sm","btn-light-success","btn-block","radius-30"],["src","assets/images/icons/watch.png","width","35","alt",""],["href","javascript:;",1,"btn","btn-sm","btn-light-warning","btn-block","radius-30"],["src","assets/images/icons/laptop.png","width","35","alt",""],["src","assets/images/icons/shirt.png","width","35","alt",""],["href","javascript:;",1,"btn","btn-sm","btn-light-danger","btn-block","radius-30"],["src","assets/images/icons/wine-glass.png","width","35","alt",""],["src","assets/images/icons/headphones.png","width","35","alt",""]],template:function(Qn,on){1&Qn&&(A.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div")(6,"h2",5),A._uU(7,"649 "),A._UZ(8,"i",6),A.qZA()(),A.TgZ(9,"div",7),A._UZ(10,"i",8),A.qZA()(),A.TgZ(11,"div",4)(12,"div")(13,"p",5),A._uU(14,"Item Delivered"),A.qZA()(),A.TgZ(15,"div",9),A._uU(16,"+23.4%"),A.qZA()()()()(),A.TgZ(17,"div",1)(18,"div",10)(19,"div",3)(20,"div",4)(21,"div")(22,"h2",5),A._uU(23,"114 "),A._UZ(24,"i",11),A.qZA()(),A.TgZ(25,"div",7),A._UZ(26,"i",12),A.qZA()(),A.TgZ(27,"div",4)(28,"div")(29,"p",5),A._uU(30,"Refund Request"),A.qZA()(),A.TgZ(31,"div",9),A._uU(32,"+14.7%"),A.qZA()()()()(),A.TgZ(33,"div",1)(34,"div",13)(35,"div",3)(36,"div",4)(37,"div")(38,"h2",5),A._uU(39,"98 "),A._UZ(40,"i",6),A.qZA()(),A.TgZ(41,"div",7),A._UZ(42,"i",14),A.qZA()(),A.TgZ(43,"div",4)(44,"div")(45,"p",5),A._uU(46,"Cancelled Orders"),A.qZA()(),A.TgZ(47,"div",9),A._uU(48,"-12.9%"),A.qZA()()()()(),A.TgZ(49,"div",1)(50,"div",15)(51,"div",3)(52,"div",4)(53,"div")(54,"h2",5),A._uU(55,"208 "),A._UZ(56,"i",6),A.qZA()(),A.TgZ(57,"div",7),A._UZ(58,"i",16),A.qZA()(),A.TgZ(59,"div",4)(60,"div")(61,"p",5),A._uU(62,"New Users"),A.qZA()(),A.TgZ(63,"div",9),A._uU(64,"+13.6%"),A.qZA()()()()()(),A.TgZ(65,"div",17)(66,"div",18)(67,"div",19)(68,"div")(69,"h5",20),A._uU(70,"Sales Update"),A.qZA()(),A.TgZ(71,"div",21)(72,"div",22)(73,"div",23)(74,"button",24),A._uU(75,"Daiiy"),A.qZA(),A.TgZ(76,"button",24),A._uU(77,"Weekly"),A.qZA(),A.TgZ(78,"button",24),A._uU(79,"Monthly"),A.qZA()()()()()(),A.TgZ(80,"div",3),A._UZ(81,"div",25),A.qZA()(),A.TgZ(82,"div",0)(83,"div",26)(84,"div",17)(85,"div",3)(86,"div",4)(87,"div")(88,"h5",27),A._uU(89,"Revenue By Device"),A.qZA()(),A.TgZ(90,"div",28)(91,"div",29),A._UZ(92,"i",30),A.qZA(),A.TgZ(93,"div",31)(94,"a",32),A._uU(95,"Action"),A.qZA(),A.TgZ(96,"a",32),A._uU(97,"Another action"),A.qZA(),A._UZ(98,"div",33),A.TgZ(99,"a",32),A._uU(100,"Something else here"),A.qZA()()()(),A._UZ(101,"div",34),A.TgZ(102,"div",35)(103,"div",0)(104,"div",36)(105,"div",37)(106,"div",38),A._UZ(107,"i",39),A._uU(108,"Desktop"),A.qZA(),A.TgZ(109,"div"),A._uU(110,"$850.04"),A.qZA(),A.TgZ(111,"div",38),A._uU(112,"64.4%"),A.qZA()(),A._UZ(113,"div",40),A.TgZ(114,"div",37)(115,"div",38),A._UZ(116,"i",41),A._uU(117,"Mobile"),A.qZA(),A.TgZ(118,"div"),A._uU(119,"$755.08"),A.qZA(),A.TgZ(120,"div",38),A._uU(121,"48.6%"),A.qZA()()(),A.TgZ(122,"div",42),A._UZ(123,"div",43),A.qZA(),A.TgZ(124,"div",36)(125,"div",37)(126,"div",38),A._UZ(127,"i",44),A._uU(128,"Tablet"),A.qZA(),A.TgZ(129,"div"),A._uU(130,"$687.03"),A.qZA(),A.TgZ(131,"div",38),A._uU(132,"24.7%"),A.qZA()(),A._UZ(133,"div",40),A.TgZ(134,"div",37)(135,"div",38),A._UZ(136,"i",45),A._uU(137,"Unknown"),A.qZA(),A.TgZ(138,"div"),A._uU(139,"$142.07"),A.qZA(),A.TgZ(140,"div",38),A._uU(141,"14.8%"),A.qZA()()()()()()()(),A.TgZ(142,"div",26)(143,"div",17)(144,"div",3)(145,"div",4)(146,"div")(147,"h5",27),A._uU(148,"Traffic"),A.qZA()(),A.TgZ(149,"div",28)(150,"div",29),A._UZ(151,"i",30),A.qZA(),A.TgZ(152,"div",31)(153,"a",32),A._uU(154,"Action"),A.qZA(),A.TgZ(155,"a",32),A._uU(156,"Another action"),A.qZA(),A._UZ(157,"div",33),A.TgZ(158,"a",32),A._uU(159,"Something else here"),A.qZA()()()(),A.TgZ(160,"div",46)(161,"div",26)(162,"div",47)(163,"div",3)(164,"div",4)(165,"div")(166,"p",27),A._uU(167,"Store Visits"),A.qZA()(),A.TgZ(168,"div",48)(169,"span"),A._uU(170,"+22%"),A.qZA()()(),A.TgZ(171,"h4",27),A._uU(172,"8950"),A.qZA()()()(),A.TgZ(173,"div",26)(174,"div",47)(175,"div",3)(176,"div",4)(177,"div")(178,"p",27),A._uU(179,"Visitors"),A.qZA()(),A.TgZ(180,"div",49)(181,"span"),A._uU(182,"-24%"),A.qZA()()(),A.TgZ(183,"h4",27),A._uU(184,"1520"),A.qZA()()()()(),A._UZ(185,"div",50),A.qZA()()()(),A.TgZ(186,"div",0)(187,"div",51)(188,"div",52)(189,"div",3)(190,"div",19)(191,"div")(192,"h5",53),A._uU(193,"Top Categories"),A.qZA()(),A.TgZ(194,"div",28)(195,"div",29),A._UZ(196,"i",30),A.qZA(),A.TgZ(197,"div",31)(198,"a",32),A._uU(199,"Action"),A.qZA(),A.TgZ(200,"a",32),A._uU(201,"Another action"),A.qZA(),A._UZ(202,"div",33),A.TgZ(203,"a",32),A._uU(204,"Something else here"),A.qZA()()()(),A.TgZ(205,"div",54)(206,"p",55),A._uU(207,"Electronics "),A.TgZ(208,"span",56),A._uU(209,"45%"),A.qZA()(),A.TgZ(210,"div",57),A._UZ(211,"div",58),A.qZA()(),A.TgZ(212,"div",54)(213,"p",55),A._uU(214,"Clothing "),A.TgZ(215,"span",56),A._uU(216,"55%"),A.qZA()(),A.TgZ(217,"div",57),A._UZ(218,"div",59),A.qZA()(),A.TgZ(219,"div",54)(220,"p",55),A._uU(221,"Furniture "),A.TgZ(222,"span",56),A._uU(223,"64%"),A.qZA()(),A.TgZ(224,"div",57),A._UZ(225,"div",60),A.qZA()(),A.TgZ(226,"div",54)(227,"p",55),A._uU(228,"Accessories "),A.TgZ(229,"span",56),A._uU(230,"78%"),A.qZA()(),A.TgZ(231,"div",57),A._UZ(232,"div",61),A.qZA()(),A.TgZ(233,"div",54)(234,"p",55),A._uU(235,"Jewellery "),A.TgZ(236,"span",56),A._uU(237,"82%"),A.qZA()(),A.TgZ(238,"div",57),A._UZ(239,"div",62),A.qZA()(),A.TgZ(240,"div",63)(241,"p",55),A._uU(242,"Mobiles "),A.TgZ(243,"span",56),A._uU(244,"89%"),A.qZA()(),A.TgZ(245,"div",57),A._UZ(246,"div",64),A.qZA()()()()(),A.TgZ(247,"div",65)(248,"div",52)(249,"div",3)(250,"div",66)(251,"div")(252,"h5",27),A._uU(253,"Sales Forecast"),A.qZA()(),A.TgZ(254,"div",28)(255,"div",67),A._UZ(256,"i",30),A.qZA(),A.TgZ(257,"div",31)(258,"a",32),A._uU(259,"Action"),A.qZA(),A.TgZ(260,"a",32),A._uU(261,"Another action"),A.qZA(),A._UZ(262,"div",33),A.TgZ(263,"a",32),A._uU(264,"Something else here"),A.qZA()()()(),A.TgZ(265,"div",68)(266,"div",26)(267,"div",69)(268,"div",70)(269,"div",71)(270,"div",72)(271,"p",73),A._uU(272,"Revenue"),A.qZA(),A.TgZ(273,"h4",27),A._uU(274,"+24.5%"),A.qZA()(),A.TgZ(275,"div",74),A._UZ(276,"i",75),A.qZA()(),A._UZ(277,"div",76),A.qZA()()(),A.TgZ(278,"div",26)(279,"div",69)(280,"div",70)(281,"div",71)(282,"div",72)(283,"p",73),A._uU(284,"Net Profit"),A.qZA(),A.TgZ(285,"h4",27),A._uU(286,"-2.7%"),A.qZA()(),A.TgZ(287,"div",74),A._UZ(288,"i",77),A.qZA()(),A._UZ(289,"div",78),A.qZA()()(),A.TgZ(290,"div",26)(291,"div",69)(292,"div",70)(293,"div",71)(294,"div",72)(295,"p",73),A._uU(296,"Orders"),A.qZA(),A.TgZ(297,"h4",27),A._uU(298,"+32.6%"),A.qZA()(),A.TgZ(299,"div",74),A._UZ(300,"i",79),A.qZA()(),A._UZ(301,"div",80),A.qZA()()(),A.TgZ(302,"div",26)(303,"div",69)(304,"div",70)(305,"div",71)(306,"div",72)(307,"p",73),A._uU(308,"Visitors"),A.qZA(),A.TgZ(309,"h4",27),A._uU(310,"+60.2%"),A.qZA()(),A.TgZ(311,"div",74),A._UZ(312,"i",81),A.qZA()(),A._UZ(313,"div",82),A.qZA()()()()()()()(),A.TgZ(314,"div",0)(315,"div",65)(316,"div",83)(317,"div",18)(318,"div",4)(319,"div")(320,"h5",27),A._uU(321,"Revenue By Locations"),A.qZA()(),A.TgZ(322,"div",28)(323,"div",29),A._UZ(324,"i",30),A.qZA(),A.TgZ(325,"div",31)(326,"a",32),A._uU(327,"Action"),A.qZA(),A.TgZ(328,"a",32),A._uU(329,"Another action"),A.qZA(),A._UZ(330,"div",33),A.TgZ(331,"a",32),A._uU(332,"Something else here"),A.qZA()()()()(),A.TgZ(333,"div",3),A._UZ(334,"div",84),A.qZA(),A.TgZ(335,"div",85)(336,"table",86)(337,"thead")(338,"tr")(339,"th",87),A._uU(340,"Countries"),A.qZA(),A.TgZ(341,"th",88),A._uU(342,"Orders"),A.qZA(),A.TgZ(343,"th",89),A._uU(344,"Earnings"),A.qZA()()(),A.TgZ(345,"tbody")(346,"tr")(347,"td",4),A._UZ(348,"i",90),A.TgZ(349,"div"),A._uU(350,"United States"),A.qZA()(),A.TgZ(351,"td"),A._uU(352,"13,495"),A.qZA(),A.TgZ(353,"td",91),A._uU(354,"$58,430.75"),A.qZA()(),A.TgZ(355,"tr")(356,"td",4),A._UZ(357,"i",92),A.TgZ(358,"div"),A._uU(359,"Netherlands"),A.qZA()(),A.TgZ(360,"td"),A._uU(361,"11,495"),A.qZA(),A.TgZ(362,"td",91),A._uU(363,"$68,253.90"),A.qZA()(),A.TgZ(364,"tr")(365,"td",4),A._UZ(366,"i",93),A.TgZ(367,"div"),A._uU(368,"United Kingdom"),A.qZA()(),A.TgZ(369,"td"),A._uU(370,"09,348"),A.qZA(),A.TgZ(371,"td",91),A._uU(372,"$87,295.70"),A.qZA()(),A.TgZ(373,"tr")(374,"td",4),A._UZ(375,"i",94),A.TgZ(376,"div"),A._uU(377,"Canada"),A.qZA()(),A.TgZ(378,"td"),A._uU(379,"07,845"),A.qZA(),A.TgZ(380,"td",91),A._uU(381,"$64,914.20"),A.qZA()(),A.TgZ(382,"tr")(383,"td",4),A._UZ(384,"i",95),A.TgZ(385,"div"),A._uU(386,"Australia"),A.qZA()(),A.TgZ(387,"td"),A._uU(388,"05,945"),A.qZA(),A.TgZ(389,"td",91),A._uU(390,"$94,335.60"),A.qZA()()()()()()(),A.TgZ(391,"div",51)(392,"div",52)(393,"div",3)(394,"div",47)(395,"div",3)(396,"div",4)(397,"h5",27),A._uU(398,"New Users"),A.qZA(),A.TgZ(399,"p",96),A._UZ(400,"i",97),A.qZA()(),A.TgZ(401,"div",98),A._UZ(402,"img",99),A.TgZ(403,"div",100)(404,"p",101),A._uU(405,"Neil Wagner"),A.qZA(),A.TgZ(406,"p",73),A._uU(407,"United Kingdom"),A.qZA()(),A.TgZ(408,"a",102),A._uU(409,"Add"),A.qZA()(),A._UZ(410,"hr"),A.TgZ(411,"div",103),A._UZ(412,"img",104),A.TgZ(413,"div",100)(414,"p",101),A._uU(415,"Sampoll Dinga"),A.qZA(),A.TgZ(416,"p",73),A._uU(417,"America"),A.qZA()(),A.TgZ(418,"a",102),A._uU(419,"Add"),A.qZA()(),A._UZ(420,"hr"),A.TgZ(421,"div",103),A._UZ(422,"img",105),A.TgZ(423,"div",100)(424,"p",101),A._uU(425,"Loona Ting"),A.qZA(),A.TgZ(426,"p",73),A._uU(427,"Canada"),A.qZA()(),A.TgZ(428,"a",102),A._uU(429,"Add"),A.qZA()(),A._UZ(430,"hr"),A.TgZ(431,"div",103),A._UZ(432,"img",106),A.TgZ(433,"div",100)(434,"p",101),A._uU(435,"Lee Jong"),A.qZA(),A.TgZ(436,"p",73),A._uU(437,"China"),A.qZA()(),A.TgZ(438,"a",102),A._uU(439,"Add"),A.qZA()()()(),A.TgZ(440,"div",69)(441,"div",3)(442,"h4",27),A._uU(443,"87.52%"),A.qZA(),A.TgZ(444,"p",27),A._uU(445,"Bounce Rate"),A.qZA()(),A._UZ(446,"div",107),A.qZA()()()()(),A.TgZ(447,"div",108)(448,"div",18)(449,"div",4)(450,"div")(451,"h5",27),A._uU(452,"Recent Orders"),A.qZA()(),A.TgZ(453,"div",109)(454,"button",110),A._uU(455,"View More"),A.qZA()()()(),A.TgZ(456,"div",111)(457,"div",85)(458,"table",86)(459,"thead")(460,"tr")(461,"th"),A._uU(462,"Photo"),A.qZA(),A.TgZ(463,"th"),A._uU(464,"Product Name"),A.qZA(),A.TgZ(465,"th"),A._uU(466,"Customer"),A.qZA(),A.TgZ(467,"th"),A._uU(468,"Product id"),A.qZA(),A.TgZ(469,"th"),A._uU(470,"Price"),A.qZA(),A.TgZ(471,"th"),A._uU(472,"Status"),A.qZA()()(),A.TgZ(473,"tbody")(474,"tr")(475,"td")(476,"div",112),A._UZ(477,"img",113),A.qZA()(),A.TgZ(478,"td"),A._uU(479,"Honor Mobile 7x"),A.qZA(),A.TgZ(480,"td"),A._uU(481,"Mitchell Daniel"),A.qZA(),A.TgZ(482,"td"),A._uU(483,"#835478"),A.qZA(),A.TgZ(484,"td"),A._uU(485,"$54.68"),A.qZA(),A.TgZ(486,"td")(487,"a",114),A._uU(488,"Delivered"),A.qZA()()(),A.TgZ(489,"tr")(490,"td")(491,"div",112),A._UZ(492,"img",115),A.qZA()(),A.TgZ(493,"td"),A._uU(494,"Hand Watch"),A.qZA(),A.TgZ(495,"td"),A._uU(496,"Milona Burke"),A.qZA(),A.TgZ(497,"td"),A._uU(498,"#987546"),A.qZA(),A.TgZ(499,"td"),A._uU(500,"$43.78"),A.qZA(),A.TgZ(501,"td")(502,"a",116),A._uU(503,"Pending"),A.qZA()()(),A.TgZ(504,"tr")(505,"td")(506,"div",112),A._UZ(507,"img",117),A.qZA()(),A.TgZ(508,"td"),A._uU(509,"Mini Laptop"),A.qZA(),A.TgZ(510,"td"),A._uU(511,"Craig Clayton"),A.qZA(),A.TgZ(512,"td"),A._uU(513,"#325687"),A.qZA(),A.TgZ(514,"td"),A._uU(515,"$62.21"),A.qZA(),A.TgZ(516,"td")(517,"a",114),A._uU(518,"Delivered"),A.qZA()()(),A.TgZ(519,"tr")(520,"td")(521,"div",112),A._UZ(522,"img",118),A.qZA()(),A.TgZ(523,"td"),A._uU(524,"Slim-T-Shirt"),A.qZA(),A.TgZ(525,"td"),A._uU(526,"Clark Andola"),A.qZA(),A.TgZ(527,"td"),A._uU(528,"#658972"),A.qZA(),A.TgZ(529,"td"),A._uU(530,"$75.68"),A.qZA(),A.TgZ(531,"td")(532,"a",119),A._uU(533,"Cancelled"),A.qZA()()(),A.TgZ(534,"tr")(535,"td")(536,"div",112),A._UZ(537,"img",120),A.qZA()(),A.TgZ(538,"td"),A._uU(539,"Mini Laptop"),A.qZA(),A.TgZ(540,"td"),A._uU(541,"Craig Clayton"),A.qZA(),A.TgZ(542,"td"),A._uU(543,"#325687"),A.qZA(),A.TgZ(544,"td"),A._uU(545,"$62.21"),A.qZA(),A.TgZ(546,"td")(547,"a",114),A._uU(548,"Delivered"),A.qZA()()(),A.TgZ(549,"tr")(550,"td")(551,"div",112),A._UZ(552,"img",121),A.qZA()(),A.TgZ(553,"td"),A._uU(554,"Honor Mobile 7x"),A.qZA(),A.TgZ(555,"td"),A._uU(556,"Mitchell Daniel"),A.qZA(),A.TgZ(557,"td"),A._uU(558,"#835478"),A.qZA(),A.TgZ(559,"td"),A._uU(560,"$54.68"),A.qZA(),A.TgZ(561,"td")(562,"a",114),A._uU(563,"Delivered"),A.qZA()()()()()()()())},styles:[""]}),kt})();var Ke=fe(6709),ct=fe(3464);const _t=["map"],wt=[{path:"",children:[{path:"analytics",component:lt,data:{title:"Analytics"}},{path:"mapa",component:ct.W},{path:"sales",component:At,data:{title:"Sales"}},{path:"inicio",component:(()=>{class kt{constructor(Qn){this.reportesService=Qn,this.marcadores=[],this.center=[10.05490747193752,-84.4323471267699],this.zoomLevel=15,this.reportes=[]}ngOnInit(){this.reportesService.getAllReportes()}ngAfterViewInit(){}}return kt.\u0275fac=function(Qn){return new(Qn||kt)(A.Y36(Ke.j))},kt.\u0275cmp=A.Xpm({type:kt,selectors:[["app-inicio"]],viewQuery:function(Qn,on){if(1&Qn&&A.Gf(_t,5),2&Qn){let Cn;A.iGM(Cn=A.CRH())&&(on.mapContainer=Cn.first)}},decls:1,vars:0,template:function(Qn,on){1&Qn&&A._UZ(0,"app-mapabox")},directives:[ct.W],styles:[".map-container[_ngcontent-%COMP%]{height:100vh;position:fixed;right:0;top:0;width:100vw}.map-frame[_ngcontent-%COMP%]{border:2px solid black;height:100%}#map[_ngcontent-%COMP%]{height:100%;width:100%}.row[_ngcontent-%COMP%]{background-color:#fff;border-radius:5px;bottom:50px;right:80px;padding:10px;position:fixed;z-index:999;width:280px}"]}),kt})(),data:{title:"Inicio"}}]}];let Bt=(()=>{class kt{}return kt.\u0275fac=function(Qn){return new(Qn||kt)},kt.\u0275mod=A.oAB({type:kt}),kt.\u0275inj=A.cJS({imports:[[N.Bz.forChild(wt)],N.Bz]}),kt})();var st=fe(6531),at=fe(4466),ft=fe(3075);let tn=(()=>{class kt{}return kt.\u0275fac=function(Qn){return new(Qn||kt)},kt.\u0275mod=A.oAB({type:kt}),kt.\u0275inj=A.cJS({imports:[[D.ez,l.IJ,Bt,oe.Xd,st.ReportesModule,at.m,ft.UX]]}),kt})()},3464:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{W:()=>_t});var D=fe(4128),l=(fe(8483),fe(9898)),lt=fe(4893),At=fe(6709),Ke=fe(9808);const ct=["mapa"];let _t=(()=>{class Nt{constructor(Bt){this.reporteService=Bt,this.center=[-84.4323471267699,10.05490747193752],this.marcadores=[],this.zoomLevel=14,this.categorias=[],this.latitud=0,this.longitud=0,this.reportes=this.reporteService.reportes}ngOnInit(){(0,D.D)([this.reporteService.getAllCategorias(),this.reporteService.getReportesAceptados()]).subscribe(([Bt,st])=>{console.log("categorias"),console.log(Bt),this.categorias=Bt.categorias,console.log("reportes"),console.log(st),this.latitud=st.reportes.map(at=>at.latitud),this.longitud=st.reportes.map(at=>at.longitud),this.reportes=[this.longitud,this.latitud],this.crearMarcadores(st.reportes)})}crearMarcadores(Bt){if(console.log("Crear marcadores"),Bt.forEach(at=>{var ft;let tn="",kt="";const dn=this.categorias.find(se=>se.id===at.categoria_id);dn&&(tn=dn.color,kt=dn.descripcion),"Finalizado"===at.estado&&(tn="lightgray");const Qn=(new l.Popup).setHTML(`\n    <div class="card">\n      <div class="card-body">\n        <h5 class="card-title">${"Finalizado"===at.estado?"Reporte Finalizado":"Titulo: "+at.titulo}</h5>\n        <span><strong>T\xedtulo:</strong> ${at.titulo}</span>\n        <br>\n        <span><strong>Descripci\xf3n:</strong> ${at.descripcion}</span>\n        <br>\n        <span class="card-text"><strong>Categoria:</strong> ${kt}</span>\n        <br>\n        <span class="card-text"><strong>Estado:</strong> ${at.estado}</span>\n        <br>\n        <span class="card-text"><strong>Imagen:</strong></span>\n        <img src="${null==at.imagen?"https://www.thermaxglobal.com/wp-content/uploads/2020/05/image-not-found.jpg":at.imagen}" class="card-img-top" alt="image" style="max-height: 150px;">\n      </div>\n    </div>\n  `),on=document.createElement("div");on.className="marker-check-icon","Finalizado"===at.estado&&(on.innerHTML="&#10003;",on.style.color="#00ff00",on.style.marginTop="-45px",on.style.marginLeft="20px",on.style.fontSize="20px");const Cn=new l.Marker({color:tn}).setLngLat([at.longitud,at.latitud]).setPopup(Qn).addTo(this.mapa);null===(ft=Cn.getElement())||void 0===ft||ft.appendChild(on),this.marcadores.push({color:tn,marker:Cn})}),null==this.marcadores)return;const st=new l.LngLatBounds;1===this.marcadores.length?(this.marcadores.forEach(at=>{st.extend(at.marker.getLngLat())}),this.mapa.fitBounds(st,{padding:380})):(this.marcadores.forEach(at=>{st.extend(at.marker.getLngLat())}),this.mapa.fitBounds(st,{padding:300}))}ngOnDestroy(){this.mapa.off("zoom",()=>{}),this.mapa.off("zoomend",()=>{}),this.mapa.off("move",()=>{})}ngAfterViewInit(){console.log("ngAfterViewInit"),console.log(this.reportes),this.mapa=new l.Map({container:this.mapContainer.nativeElement,style:"mapbox://styles/mapbox/satellite-streets-v11",center:this.center,zoom:14,maxZoom:19,minZoom:14}),this.mapa.on("zoom",Bt=>{this.zoomLevel=this.mapa.getZoom()}),this.mapa.on("zoomend",Bt=>{this.mapa.getZoom()>19&&this.mapa.zoomTo(19)}),this.mapa.on("move",Bt=>{const st=Bt.target,{lng:at,lat:ft}=st.getCenter();this.center=[at,ft]})}zoomOut(){this.mapa.zoomOut()}zoomIn(){this.mapa.zoomIn()}zoomCambio(Bt){this.mapa.zoomTo(Number(Bt))}agregarMarcador(){const Bt="#xxxxxx".replace(/x/g,at=>(16*Math.random()|0).toString(16)),st=new l.Marker({draggable:!0,color:Bt}).setLngLat(this.center).addTo(this.mapa);this.marcadores.push({color:Bt,marker:st}),this.guardarMarcadoresLocalStorage(),st.on("dragend",()=>{this.guardarMarcadoresLocalStorage()})}guardarMarcadoresLocalStorage(){const Bt=[];this.marcadores.forEach(st=>{const at=st.color,{lng:ft,lat:tn}=st.marker.getLngLat();Bt.push({color:at,centro:[ft,tn]})}),localStorage.setItem("marcadores",JSON.stringify(Bt))}}return Nt.\u0275fac=function(Bt){return new(Bt||Nt)(lt.Y36(At.j))},Nt.\u0275cmp=lt.Xpm({type:Nt,selectors:[["app-mapabox"]],viewQuery:function(Bt,st){if(1&Bt&&lt.Gf(ct,5),2&Bt){let at;lt.iGM(at=lt.CRH())&&(st.mapContainer=at.first)}},decls:14,vars:4,consts:[[1,"map-container"],["mapa",""],[1,"row"],[1,"col-12"],[1,"form-label"],["type","range","min","14","max","19",1,"form-range",3,"value","input"],["zoomInput",""],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-primary","float-end",3,"click"]],template:function(Bt,st){if(1&Bt){const at=lt.EpF();lt.TgZ(0,"div",0,1)(2,"div",2)(3,"div",3)(4,"label",4),lt._uU(5),lt.ALo(6,"number"),lt.qZA(),lt.TgZ(7,"input",5,6),lt.NdJ("input",function(){lt.CHM(at);const tn=lt.MAs(8);return st.zoomCambio(tn.value)}),lt.qZA()(),lt.TgZ(9,"div",3)(10,"button",7),lt.NdJ("click",function(){return st.zoomOut()}),lt._uU(11," - "),lt.qZA(),lt.TgZ(12,"button",8),lt.NdJ("click",function(){return st.zoomIn()}),lt._uU(13," + "),lt.qZA()()()()}2&Bt&&(lt.xp6(5),lt.hij(" Zoom: ",lt.lcZ(6,2,st.zoomLevel)," "),lt.xp6(2),lt.Q6J("value",st.zoomLevel))},pipes:[Ke.JJ],styles:[".map-container[_ngcontent-%COMP%]{height:100vh;position:fixed;right:0;top:0;width:100vw}.list-group[_ngcontent-%COMP%]{width:100px;top:40px;left:40px}li[_ngcontent-%COMP%]{cursor:pointer}.row[_ngcontent-%COMP%]{background-color:#fff;border-radius:5px;bottom:50px;right:80px;padding:10px;position:fixed;z-index:999;width:280px}.marker-check-icon[_ngcontent-%COMP%]{position:relative;width:20px;height:20px;border-radius:50%;background-color:green;color:#fff;font-size:16px;text-align:center;line-height:20px}"]}),Nt})()},1040:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{n:()=>D});class D{constructor(A,l,oe,lt,At,Ke,ct,_t){this.id=A,this.longitud=l,this.latitud=oe,this.titulo=lt,this.descripcion=At,this.imagen=Ke,this.categoria_id=ct,this.user_id=_t}get imagenUrl(){return this.imagen&&this.imagen?`\u200bhttp://3.95.196.218/api/reportes/getImagenById/${this.imagen}`:"\u200bhttp://3.95.196.218/api/reportes/getImagenById/no-image"}}},6531:(Bi,Zt,fe)=>{"use strict";fe.r(Zt),fe.d(Zt,{ReportesModule:()=>Br});var D=fe(9808),N=fe(1810),A=fe(5226),l=fe.n(A),oe=fe(4893),lt=fe(6709),At=fe(7592);function Ke(yn,oi){if(1&yn&&oe._UZ(0,"img",38),2&yn){const Tt=oe.oxw(3);oe.Q6J("src",Tt.photoURL(),oe.LSH)}}function ct(yn,oi){if(1&yn&&oe._UZ(0,"img",39),2&yn){const Tt=oe.oxw().$implicit;oe.Q6J("src",Tt.imagen,oe.LSH)}}function _t(yn,oi){if(1&yn&&(oe.ynx(0),oe._uU(1),oe.BQk()),2&yn){const Tt=oe.oxw().$implicit;oe.xp6(1),oe.hij(" ",Tt.titulo," ")}}function Nt(yn,oi){if(1&yn&&(oe.TgZ(0,"span"),oe._uU(1),oe.qZA()),2&yn){const Tt=oe.oxw(2).$implicit,En=oe.oxw(2);oe.xp6(1),oe.Oqu(En.getShortTitle(Tt.titulo))}}function wt(yn,oi){if(1&yn&&(oe.TgZ(0,"span"),oe._uU(1),oe.qZA()),2&yn){const Tt=oe.oxw(2).$implicit;oe.xp6(1),oe.Oqu(Tt.titulo)}}function Bt(yn,oi){if(1&yn&&(oe.ynx(0),oe.YNc(1,Nt,2,1,"span",27),oe.YNc(2,wt,2,1,"span",27),oe.BQk()),2&yn){const Tt=oe.oxw().$implicit;oe.xp6(1),oe.Q6J("ngIf",!Tt.mostrarMas),oe.xp6(1),oe.Q6J("ngIf",Tt.mostrarMas)}}function st(yn,oi){if(1&yn){const Tt=oe.EpF();oe.TgZ(0,"a",40),oe.NdJ("click",function(){oe.CHM(Tt);const si=oe.oxw().$implicit;return oe.oxw(2).toggleMostrarMas(si)}),oe._uU(1,"...Ver m\xe1s"),oe.qZA()}}function at(yn,oi){if(1&yn){const Tt=oe.EpF();oe.TgZ(0,"a",41),oe.NdJ("click",function(){oe.CHM(Tt);const si=oe.oxw().$implicit;return oe.oxw(2).toggleMostrarMas(si)}),oe._UZ(1,"br"),oe._uU(2," Ver menos"),oe.qZA()}}function ft(yn,oi){if(1&yn&&(oe.TgZ(0,"span",42),oe._uU(1),oe.qZA()),2&yn){const Tt=oe.oxw().$implicit;oe.xp6(1),oe.Oqu(Tt.estado)}}function tn(yn,oi){if(1&yn&&(oe.TgZ(0,"span",43),oe._uU(1),oe.qZA()),2&yn){const Tt=oe.oxw().$implicit;oe.xp6(1),oe.Oqu(Tt.estado)}}function kt(yn,oi){if(1&yn&&(oe.TgZ(0,"span",44),oe._uU(1),oe.qZA()),2&yn){const Tt=oe.oxw().$implicit;oe.xp6(1),oe.Oqu(Tt.estado)}}function dn(yn,oi){if(1&yn&&(oe.TgZ(0,"span",45),oe._uU(1),oe.qZA()),2&yn){const Tt=oe.oxw().$implicit;oe.xp6(1),oe.Oqu(Tt.estado)}}function Qn(yn,oi){if(1&yn){const Tt=oe.EpF();oe.TgZ(0,"tr")(1,"td"),oe.YNc(2,Ke,1,1,"img",24),oe.YNc(3,ct,1,1,"img",25),oe.qZA(),oe.TgZ(4,"td",26),oe.YNc(5,_t,2,1,"ng-container",27),oe.YNc(6,Bt,3,2,"ng-container",27),oe.YNc(7,st,2,0,"a",28),oe.YNc(8,at,3,0,"a",29),oe.qZA(),oe.TgZ(9,"td",20),oe._uU(10),oe.qZA(),oe.TgZ(11,"td",20),oe._uU(12),oe.ALo(13,"date"),oe.qZA(),oe.TgZ(14,"td",20),oe.YNc(15,ft,2,1,"span",30),oe.YNc(16,tn,2,1,"span",31),oe.YNc(17,kt,2,1,"span",32),oe.YNc(18,dn,2,1,"span",33),oe.qZA(),oe.TgZ(19,"td",20)(20,"div",34)(21,"div",35)(22,"button",36),oe.NdJ("click",function(){const fi=oe.CHM(Tt).$implicit;return oe.oxw(2).mostrarDetallesReporte(fi.id)}),oe._UZ(23,"i",37),oe.qZA()()()()()}if(2&yn){const Tt=oi.$implicit,En=oe.oxw(2);oe.xp6(2),oe.Q6J("ngIf",null==Tt.imagen),oe.xp6(1),oe.Q6J("ngIf",null!=Tt.imagen),oe.xp6(2),oe.Q6J("ngIf",Tt.titulo.length<=En.maxTitleLength),oe.xp6(1),oe.Q6J("ngIf",Tt.titulo.length>En.maxTitleLength),oe.xp6(1),oe.Q6J("ngIf",Tt.titulo.length>En.maxTitleLength&&!Tt.mostrarMas),oe.xp6(1),oe.Q6J("ngIf",Tt.titulo.length>En.maxTitleLength&&Tt.mostrarMas),oe.xp6(2),oe.Oqu(Tt.categoria.descripcion),oe.xp6(2),oe.Oqu(oe.xi3(13,12,Tt.created_at,"short")),oe.xp6(3),oe.Q6J("ngIf","Finalizado"==Tt.estado),oe.xp6(1),oe.Q6J("ngIf","Aceptado"==Tt.estado),oe.xp6(1),oe.Q6J("ngIf","Rechazado"==Tt.estado),oe.xp6(1),oe.Q6J("ngIf","En espera"==Tt.estado)}}function on(yn,oi){if(1&yn){const Tt=oe.EpF();oe.TgZ(0,"div",11)(1,"div",12)(2,"div",13)(3,"h5",14),oe._uU(4,"Reportes generados: "),oe.qZA(),oe.TgZ(5,"span",15),oe._uU(6),oe.qZA()(),oe.TgZ(7,"div",13)(8,"h5",14),oe._uU(9,"P\xe1gina: "),oe.qZA(),oe.TgZ(10,"span",15),oe._uU(11),oe.qZA()()(),oe.TgZ(12,"div",16)(13,"div",17)(14,"table",18)(15,"thead")(16,"tr",19)(17,"th"),oe._uU(18,"Imagen"),oe.qZA(),oe.TgZ(19,"th",20),oe._uU(20,"T\xedtulo"),oe.qZA(),oe.TgZ(21,"th",20),oe._uU(22,"Categor\xeda"),oe.qZA(),oe.TgZ(23,"th",20),oe._uU(24,"Fecha & Hora"),oe.qZA(),oe.TgZ(25,"th",20),oe._uU(26,"Estado"),oe.qZA(),oe.TgZ(27,"th",20),oe._uU(28,"Ver detalles"),oe.qZA()()(),oe.TgZ(29,"tbody"),oe.YNc(30,Qn,24,15,"tr",21),oe.qZA()()(),oe.TgZ(31,"div",22)(32,"button",23),oe.NdJ("click",function(){return oe.CHM(Tt),oe.oxw().cambiarPagina(-1)}),oe._uU(33,"Anteriores"),oe.qZA(),oe._uU(34," \xa0 "),oe.TgZ(35,"button",23),oe.NdJ("click",function(){return oe.CHM(Tt),oe.oxw().cambiarPagina(1)}),oe._uU(36,"Siguientes"),oe.qZA()()()()}if(2&yn){const Tt=oe.oxw();oe.xp6(6),oe.hij(" ",Tt.totalReportes,""),oe.xp6(5),oe.hij(" ",Tt.page,""),oe.xp6(19),oe.Q6J("ngForOf",Tt.reportes),oe.xp6(2),oe.Q6J("disabled",Tt.currentPage<=1),oe.xp6(3),oe.Q6J("disabled",Tt.ultimaPagina==Tt.page)}}function Cn(yn,oi){1&yn&&(oe.TgZ(0,"div",46),oe._UZ(1,"img",47),oe.TgZ(2,"p",48),oe._uU(3,"No ha creado reportes"),oe.qZA()()),2&yn&&(oe.xp6(1),oe.Q6J("src","https://imgur.com/KAcQNao.png",oe.LSH))}let se=(()=>{class yn{constructor(Tt,En,si){this.reporteService=Tt,this.modalService=En,this.router=si,this.reportes=[],this.imagenes=[],this.imgUrl="",this.imgTemp=null,this.maxTitleLength=20,this.mostrarMas=!1,this.categoriaDescripcion="",this.page=1,this.ultimaPagina=0,this.currentPage=0,this.totalReportes=0,this.reporte=Tt.reporte,this.imgUrl=null!=this.reporteService.reporte?this.reporteService.reporte.imagenUrl:"\u200bhttp://3.95.196.218/api/reportes/getImagenById/no-image"}photoURL(){let Tt=this.imgUrl.slice(1);if(null!=Tt)return Tt}ngOnInit(){this.cargarReportes()}cargarReportes(){this.reporteService.getReportes(this.page).subscribe(Tt=>{console.log(Tt),this.reportes=Tt.reportes.data,this.ultimaPagina=Tt.reportes.last_page,this.currentPage=Tt.reportes.current_page,this.totalReportes=Tt.reportes.total},Tt=>{console.log(Tt.error.message)})}cambiarPagina(Tt){this.page+=Tt,console.log(this.page),this.page<1?this.page=1:this.page>this.ultimaPagina&&(this.page-=Tt),this.cargarReportes()}devolverImagen(Tt){return this.modalService.delvolverImgen(Tt.imagen)}abrirModal(Tt){this.modalService.abrirModal("reportes",Tt.id,Tt.imagen)}refrescarPagina(){window.location.reload()}mostrarDetallesReporte(Tt){const En=this.reportes.find(Zr=>Zr.id===Tt),si=En.descripcion,fi=En.imagen;let Tr=`<div><h4>Imagen </h4><br><img src="${fi}" alt="Imagen del reporte" style="max-width: 100%;"></div>`;fi||(Tr=`<div><h4>Imagen </h4><img src="${this.photoURL()}" alt="Imagen del reporte" style="max-width: 100%;"></div>`),"Rechazado"===En.estado?this.reporteService.mostrar_justificacion(Tt).subscribe(Zr=>{const Ur=Zr.justificacion;let Mn="";Ur&&(Mn=`<p><h4>Justificaci\xf3n de rechazo </h4> ${Ur}</p>`),l().fire({title:"Detalles del reporte",icon:"info",confirmButtonColor:"#968d90",html:`<h4>ID del reporte</h4>${Tt}<br></b><p><h4>Descripci\xf3n </h4><br>${si}</p>${Mn}${Tr}`,confirmButtonText:"Cerrar"})},Zr=>{404===Zr.status?l().fire({title:"Detalles del reporte",icon:"info",confirmButtonColor:"#968d90",html:`<h4>ID del reporte</h4>${Tt}<br><p><h4>Descripci\xf3n </h4><br>${si}</p>${Tr}`,confirmButtonText:"Cerrar"}):(console.log(Zr),l().fire({title:"Error",icon:"error",text:"Ha ocurrido un error al obtener los detalles del reporte. Por favor, intenta de nuevo m\xe1s tarde.",confirmButtonColor:"#968d90",confirmButtonText:"Cerrar"}))}):l().fire({title:"Detalles del reporte",icon:"info",confirmButtonColor:"#968d90",html:`<h4>ID del reporte</h4>${Tt}<br><p><h4>Descripci\xf3n </h4><br>${si}</p>${Tr}`,confirmButtonText:"Cerrar"})}getShortTitle(Tt){if(this.mostrarMas)return Tt;if(Tt.length>this.maxTitleLength){const En=Tt.substring(0,this.maxTitleLength).trim(),si=En.lastIndexOf("");return En.substring(0,si)}return Tt}toggleMostrarMas(Tt){Tt.mostrarMas=!Tt.mostrarMas}verDetalles(){this.router.navigate(["/reportes","detalle-reporte"])}}return yn.\u0275fac=function(Tt){return new(Tt||yn)(oe.Y36(lt.j),oe.Y36(At.e),oe.Y36(N.F0))},yn.\u0275cmp=oe.Xpm({type:yn,selectors:[["app-ver-reportes"]],decls:13,vars:2,consts:[[1,"page-breadcrumb","d-none","d-sm-flex","align-items-center","mb-3"],[1,"breadcrumb-title","pe-3"],[1,"ps-3"],["aria-label","breadcrumb"],[1,"breadcrumb","mb-0","p-0"],[1,"breadcrumb-item"],["href","#",3,"click"],[1,"bx","bxs-report","icon-color-3"],["aria-current","page",1,"breadcrumb-item","active"],["class","card radius-15 overflow-hidden",4,"ngIf"],["class","text-center mt-5",4,"ngIf"],[1,"card","radius-15","overflow-hidden"],[1,"card-header","border-bottom-0"],[1,"d-flex","align-items-center","flex-row"],[1,"mb-0"],[1,"color","ml-2","letra"],[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","mb-0"],[1,"table"],[1,"text-center"],[4,"ngFor","ngForOf"],[1,"card-footer","d-flex","justify-content-end"],[1,"btn","btn-light",3,"disabled","click"],["alt","reporte","class","img-avatar","width","50","height","35","style","border-radius: 40%;",3,"src",4,"ngIf"],["class","img-avatar img-fluid d-block","width","50","height","35","style","border-radius: 40%;",3,"src",4,"ngIf"],[1,"text-center","table-justificacion"],[4,"ngIf"],["class","ver-mas",3,"click",4,"ngIf"],["class","ver-menos",3,"click",4,"ngIf"],["class","btn btn-sm btn-light-secondary btn-block radius-30",4,"ngIf"],["class","btn btn-sm btn-light-success btn-block radius-30",4,"ngIf"],["class","btn btn-sm btn-light-danger btn-block radius-30",4,"ngIf"],["class","btn btn-sm btn-light-warning btn-block radius-30",4,"ngIf"],[1,"d-flex","justify-content-center","flex-wrap-nowrap"],[1,"mx-1"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"bx","bx-file","me-0"],["alt","reporte","width","50","height","35",1,"img-avatar",2,"border-radius","40%",3,"src"],["width","50","height","35",1,"img-avatar","img-fluid","d-block",2,"border-radius","40%",3,"src"],[1,"ver-mas",3,"click"],[1,"ver-menos",3,"click"],[1,"btn","btn-sm","btn-light-secondary","btn-block","radius-30"],[1,"btn","btn-sm","btn-light-success","btn-block","radius-30"],[1,"btn","btn-sm","btn-light-danger","btn-block","radius-30"],[1,"btn","btn-sm","btn-light-warning","btn-block","radius-30"],[1,"text-center","mt-5"],["alt","img","width","150","height","150",1,"img-fluid",3,"src"],[1,"lead","mt-4"]],template:function(Tt,En){1&Tt&&(oe.TgZ(0,"div",0)(1,"div",1),oe._uU(2,"Reportes"),oe.qZA(),oe.TgZ(3,"div",2)(4,"nav",3)(5,"ol",4)(6,"li",5)(7,"span",6),oe.NdJ("click",function(fi){return fi.preventDefault()}),oe._UZ(8,"i",7),oe.qZA()(),oe.TgZ(9,"li",8),oe._uU(10,"Ver reportes"),oe.qZA()()()()(),oe.YNc(11,on,37,5,"div",9),oe.YNc(12,Cn,4,1,"div",10)),2&Tt&&(oe.xp6(11),oe.Q6J("ngIf",En.reportes.length>0),oe.xp6(1),oe.Q6J("ngIf",0===En.reportes.length))},directives:[D.O5,D.sg],pipes:[D.uU],styles:['@charset "UTF-8";.card-floating[_ngcontent-%COMP%]{z-index:9999}.cursor[_ngcontent-%COMP%]{cursor:pointer}.tabla[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:center}.btn-secondary[_ngcontent-%COMP%]{position:relative;border-radius:10px;background-color:#4caf50;border:none}.btn-secondary[_ngcontent-%COMP%]:before{content:"Ver detalles";position:absolute;top:-30px;left:50%;transform:translate(-50%);background-color:#968d90;color:#fff;padding:5px 10px;border-radius:4px;font-size:12px;white-space:nowrap;opacity:0;transition:opacity .3s ease-in-out}.btn-secondary[_ngcontent-%COMP%]:hover:before{opacity:1}.btn-success[_ngcontent-%COMP%]{position:relative;border-radius:10px;border:none}.btn-success[_ngcontent-%COMP%]:before{content:"Actualizar categor\\ed a";position:absolute;top:-30px;left:50%;transform:translate(-50%);background-color:#968d90;color:#fff;padding:5px 10px;border-radius:4px;font-size:12px;white-space:nowrap;opacity:0;transition:opacity .3s ease-in-out}.btn-success[_ngcontent-%COMP%]:hover:before{opacity:1}.color[_ngcontent-%COMP%]{color:#968d90}.letra[_ngcontent-%COMP%]{font-size:20px}.table-justificacion[_ngcontent-%COMP%]{white-space:pre-wrap}']}),yn})();var Wi=fe(3075),ii=fe(520),kn=fe(665);function Ci(yn,oi){if(1&yn&&(oe.TgZ(0,"p"),oe._uU(1),oe.qZA()),2&yn){const Tt=oe.oxw();oe.xp6(1),oe.Oqu(Tt.errorMensajeTitulo)}}function Jt(yn,oi){if(1&yn&&(oe.TgZ(0,"p"),oe._uU(1),oe.qZA()),2&yn){const Tt=oe.oxw();oe.xp6(1),oe.Oqu(Tt.errorMensajeDescripcion)}}function $t(yn,oi){if(1&yn&&(oe.TgZ(0,"p"),oe._uU(1),oe.qZA()),2&yn){const Tt=oe.oxw();oe.xp6(1),oe.Oqu(Tt.errorMensajeImagen)}}function en(yn,oi){if(1&yn&&(oe.TgZ(0,"option",17),oe._uU(1),oe.qZA()),2&yn){const Tt=oi.$implicit;oe.Q6J("value",Tt.id),oe.xp6(1),oe.Oqu(Tt.descripcion)}}function an(yn,oi){if(1&yn&&(oe.TgZ(0,"p"),oe._uU(1),oe.qZA()),2&yn){const Tt=oe.oxw();oe.xp6(1),oe.Oqu(Tt.errorMensajeTipo)}}let Yt=(()=>{class yn{constructor(Tt,En,si,fi){this.fb=Tt,this.http=En,this.reporteService=si,this.mapService=fi,this.lng=[],this.lat=[],this.categorias=[],this.reportForm=this.fb.group({titulo:["",[Wi.kI.required,Wi.kI.maxLength(40),Wi.kI.pattern("^[a-zA-Z\xf1\xd1\xe1\xe9\xed\xf3\xfa\xc1\xc9\xcd\xd3\xda ]*$")]],descripcion:["",[Wi.kI.required,Wi.kI.maxLength(250)]],imagen:[null],categoria_id:["",[Wi.kI.required]],longitud:[this.lng],latitud:[this.lat]})}ngOnInit(){this.reporteService.getAllCategorias().subscribe(Tt=>{this.categorias=Tt.categorias,console.log("categorias"),console.log(this.categorias)},Tt=>{console.log(Tt.error.message),l().fire("Error",Tt.error.message,"error")})}agregarMarcador(){this.mapService.agregarMarcador()}get errorMensajeMarcador(){var Tt;const En=null===(Tt=this.reportForm.get("marcador"))||void 0===Tt?void 0:Tt.errors;return(null==En?void 0:En.required)?"Debe seleccionar un marcador":(null==this.reportForm.get("marcador")&&console.log("Debe seleccionar un marcador"),"")}campoValido(Tt){var En,si;return!!((null===(En=this.reportForm.get(Tt))||void 0===En?void 0:En.invalid)&&this.reportForm&&(null===(si=this.reportForm.get(Tt))||void 0===si?void 0:si.touched))}reporte(){var Tt,En;if(this.reportForm.invalid)return void this.reportForm.markAllAsTouched();if(console.log(this.mapService.leerMarcadoresLocalStorage()),this.reportForm.invalid||null==this.mapService.leerMarcadoresLocalStorage())return void console.log("Invalido");const{lat:si,lng:fi}=this.mapService.leerMarcadoresLocalStorage();null===(Tt=this.reportForm.get("longitud"))||void 0===Tt||Tt.setValue(fi),null===(En=this.reportForm.get("latitud"))||void 0===En||En.setValue(si);const{titulo:nr,descripcion:Tr,imagen:Zr,longitud:Ur,latitud:Mn,categoria_id:yo}=this.reportForm.value;console.log(this.reportForm.value),this.reporteService.crearReporte(nr,Tr,Zr,Ur,Mn,yo).subscribe(qr=>{console.log(qr),l().fire("",qr.message,"success")},qr=>{console.log(qr.error.message),l().fire("Error",qr.error.message,"error")}),console.log(this.reportForm.value),this.reportForm.reset(),this.mapService.borrarMarcadorLocalStorage()}eliminarMarcador(){this.mapService.borrarMarcadorLocalStorage()}get errorMensajeTitulo(){var Tt;const En=null===(Tt=this.reportForm.get("titulo"))||void 0===Tt?void 0:Tt.errors;return(null==En?void 0:En.required)?"El t\xedtulo es obligatorio":(null==En?void 0:En.pattern)?"El t\xedtulo no puede contener n\xfameros o caracteres especiales":(null==En?void 0:En.maxlength)?"El valor ingresado no puede exceder m\xe1s de 40 caracteres":""}get errorMensajeDescripcion(){var Tt;const En=null===(Tt=this.reportForm.get("descripcion"))||void 0===Tt?void 0:Tt.errors;return(null==En?void 0:En.required)?"Debe contener una breve descripci\xf3n del reporte":(null==En?void 0:En.maxlength)?"No se debe exceder m\xe1s de 250 caracteres en la descripci\xf3n":""}get errorMensajeTipo(){var Tt;const En=null===(Tt=this.reportForm.get("categoria_id"))||void 0===Tt?void 0:Tt.errors;return(null==En?void 0:En.required)?"Debe seleccionar un tipo de reporte":""}onSubmit(){console.log(this.reportForm.value)}subirImagen(Tt){const En=new FormData;En.append("imagen",Tt);const si=localStorage.getItem("token")||"",fi=new ii.WM({Authorization:"Bearer "+si});this.http.post("http://3.95.196.218/api/imgur",En,{headers:fi}).subscribe(nr=>{var Tr;console.log(nr),console.log("res"),console.log(nr.nombre),null===(Tr=this.reportForm.get("imagen"))||void 0===Tr||Tr.setValue(nr.nombre),console.log(this.reportForm.value)},nr=>{console.log(nr)})}}return yn.\u0275fac=function(Tt){return new(Tt||yn)(oe.Y36(Wi.qu),oe.Y36(ii.eN),oe.Y36(lt.j),oe.Y36(kn.S))},yn.\u0275cmp=oe.Xpm({type:yn,selectors:[["app-form"]],decls:40,vars:6,consts:[[3,"formGroup","ngSubmit"],[1,"form-group"],["for","name"],["type","text","id","titulo","placeholder","T\xedtulo","formControlName","titulo",1,"form-control"],[1,"col","text-danger"],[4,"ngIf"],["rows","4","cols","50","id","descripcion","placeholder","Descripci\xf3n","formControlName","descripcion",1,"form-control"],["type","file","id","imagen","placeholder","Imagen",1,"form-control",3,"change"],["id","categoria_id","formControlName","categoria_id",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],[1,"d-grid","font-weight-bold","text-white",2,"margin","10px"],["type","button",1,"btn","bg-success","font-weight-bold","text-white",3,"click"],[1,"bx","bx-map"],[1,"col-12"],[1,"frame"],["type","submit",1,"btn","btn-primary",2,"margin","10px","display","block","margin-left","auto","margin-right","auto"],[1,"bx","bxs-report"],[3,"value"]],template:function(Tt,En){1&Tt&&(oe.TgZ(0,"form",0),oe.NdJ("ngSubmit",function(){return En.reporte()}),oe.TgZ(1,"div",1)(2,"label",2),oe._uU(3,"T\xedtulo del reporte"),oe.qZA(),oe._UZ(4,"input",3),oe.TgZ(5,"div",4),oe.YNc(6,Ci,2,1,"p",5),oe.qZA()(),oe._UZ(7,"br"),oe.TgZ(8,"div",1)(9,"label",2),oe._uU(10,"Descripci\xf3n"),oe.qZA(),oe.TgZ(11,"textarea",6),oe._uU(12,"            Descripci\xf3n general del reporte"),oe.qZA(),oe.TgZ(13,"div",4),oe.YNc(14,Jt,2,1,"p",5),oe.qZA()(),oe.TgZ(15,"div",1)(16,"label",2),oe._uU(17,"Imagen"),oe.qZA(),oe.TgZ(18,"input",7),oe.NdJ("change",function(fi){return En.subirImagen(fi.target.files[0])}),oe.qZA(),oe.TgZ(19,"div",4),oe.YNc(20,$t,2,1,"p",5),oe.qZA(),oe._UZ(21,"br"),oe.TgZ(22,"div",1)(23,"label",2),oe._uU(24,"Categor\xeda del reporte"),oe.qZA(),oe.TgZ(25,"select",8),oe.YNc(26,en,2,2,"option",9),oe.qZA(),oe.TgZ(27,"div",4),oe.YNc(28,an,2,1,"p",5),oe.qZA()(),oe.TgZ(29,"div",1)(30,"div",10)(31,"a",11),oe.NdJ("click",function(){return En.agregarMarcador()}),oe._UZ(32,"i",12),oe._uU(33,"Agregar marcador"),oe.qZA()(),oe.TgZ(34,"div",13)(35,"div",14)(36,"button",15),oe._UZ(37,"i",16),oe._uU(38,"Crear reporte"),oe.qZA()()(),oe._UZ(39,"form"),oe.qZA()()()),2&Tt&&(oe.Q6J("formGroup",En.reportForm),oe.xp6(6),oe.Q6J("ngIf",En.campoValido("titulo")),oe.xp6(8),oe.Q6J("ngIf",En.campoValido("descripcion")),oe.xp6(6),oe.Q6J("ngIf",En.campoValido("imagen")),oe.xp6(6),oe.Q6J("ngForOf",En.categorias),oe.xp6(2),oe.Q6J("ngIf",En.campoValido("categoria_id")))},directives:[Wi._Y,Wi.JL,Wi.sg,Wi.Fj,Wi.JJ,Wi.u,D.O5,Wi.EJ,D.sg,Wi.YN,Wi.Kr],styles:[".margen[_ngcontent-%COMP%]{margin-top:10px}.button[_ngcontent-%COMP%]{background-color:#00bfff;color:#000;padding:20px;text-align:center;text-decoration:none;display:inline-block;font-size:16px;margin:4px 2px;cursor:pointer;border-radius:8px}"]}),yn})();fe(8483);var Sn=fe(9898);const Mi=["mapa"];let mr=(()=>{class yn{constructor(Tt){this.mapService=Tt,this.center=[-84.4323471267699,10.05490747193752],this.marcadores=[],this.zoomLevel=14}ngAfterViewInit(){this.mapa=new Sn.Map({container:this.mapContainer.nativeElement,style:"mapbox://styles/mapbox/satellite-streets-v11",center:this.center,zoom:this.zoomLevel,maxZoom:19,minZoom:14}),this.mapService.setMap(this.mapa),this.mapService.leerMarcadoresLocalStorage(),this.mapa.on("zoom",Tt=>{this.zoomLevel=this.mapa.getZoom()}),this.mapa.on("zoomend",Tt=>{this.mapa.getZoom()>19&&this.mapa.zoomTo(19)}),this.mapa.on("move",Tt=>{const En=Tt.target,{lng:si,lat:fi}=En.getCenter();this.center=[si,fi]})}zoomOut(){this.mapa.zoomOut()}zoomIn(){this.mapa.zoomIn()}zoomCambio(Tt){this.mapa.zoomTo(Number(Tt))}agregarMarcador(){const Tt="#xxxxxx".replace(/x/g,si=>(16*Math.random()|0).toString(16)),En=new Sn.Marker({draggable:!0,color:Tt}).setLngLat(this.center).addTo(this.mapa);this.marcadores.push({color:Tt,marker:En}),this.guardarMarcadoresLocalStorage(),En.on("dragend",()=>{this.guardarMarcadoresLocalStorage()})}guardarMarcadoresLocalStorage(){const Tt=[];this.marcadores.forEach(En=>{const si=En.color,{lng:fi,lat:nr}=En.marker.getLngLat();Tt.push({color:si,centro:[fi,nr]})}),localStorage.setItem("marcadores",JSON.stringify(Tt))}}return yn.\u0275fac=function(Tt){return new(Tt||yn)(oe.Y36(kn.S))},yn.\u0275cmp=oe.Xpm({type:yn,selectors:[["app-mapa"]],viewQuery:function(Tt,En){if(1&Tt&&oe.Gf(Mi,5),2&Tt){let si;oe.iGM(si=oe.CRH())&&(En.mapContainer=si.first)}},decls:14,vars:4,consts:[[1,"map-container"],["mapa",""],[1,"row"],[1,"col-12"],[1,"form-label"],["type","range","min","14","max","19",1,"form-range",3,"value","input"],["zoomInput",""],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-primary","float-end",3,"click"]],template:function(Tt,En){if(1&Tt){const si=oe.EpF();oe.TgZ(0,"div",0,1)(2,"div",2)(3,"div",3)(4,"label",4),oe._uU(5),oe.ALo(6,"number"),oe.qZA(),oe.TgZ(7,"input",5,6),oe.NdJ("input",function(){oe.CHM(si);const nr=oe.MAs(8);return En.zoomCambio(nr.value)}),oe.qZA()(),oe.TgZ(9,"div",3)(10,"button",7),oe.NdJ("click",function(){return En.zoomOut()}),oe._uU(11," - "),oe.qZA(),oe.TgZ(12,"button",8),oe.NdJ("click",function(){return En.zoomIn()}),oe._uU(13," + "),oe.qZA()()()()}2&Tt&&(oe.xp6(5),oe.hij(" Zoom: ",oe.lcZ(6,2,En.zoomLevel)," "),oe.xp6(2),oe.Q6J("value",En.zoomLevel))},pipes:[D.JJ],styles:[".map-container[_ngcontent-%COMP%]{height:100vh;position:fixed;right:0;top:0;width:50vw}.list-group[_ngcontent-%COMP%]{width:100px;top:40px;left:40px}li[_ngcontent-%COMP%]{cursor:pointer}.row[_ngcontent-%COMP%]{background-color:#fff;border-radius:5px;bottom:40px;right:30px;padding:10px;position:fixed;z-index:999;width:220px}"]}),yn})();const _i=["map"],ui=[{path:"ver-reportes",component:se,data:{title:"Ver reportes"}},{path:"crear-reportes",component:(()=>{class yn{constructor(){}mostrarForm(){}ngOnInit(){}}return yn.\u0275fac=function(Tt){return new(Tt||yn)},yn.\u0275cmp=oe.Xpm({type:yn,selectors:[["app-crear-reportes"]],decls:16,vars:0,consts:[[1,"page-breadcrumb","d-none","d-sm-flex","align-items-center","mb-3"],[1,"breadcrumb-title","pe-3"],[1,"ps-3"],["aria-label","breadcrumb"],[1,"breadcrumb","mb-0","p-0"],[1,"breadcrumb-item"],["href","#",3,"click"],[1,"bx","bxs-report","icon-color-3"],["aria-current","page",1,"breadcrumb-item","active"],[1,"row"],[1,"col-4"],[1,"col-6"]],template:function(Tt,En){1&Tt&&(oe.TgZ(0,"div",0)(1,"div",1),oe._uU(2,"Reportes"),oe.qZA(),oe.TgZ(3,"div",2)(4,"nav",3)(5,"ol",4)(6,"li",5)(7,"a",6),oe.NdJ("click",function(fi){return fi.preventDefault()}),oe._UZ(8,"i",7),oe.qZA()(),oe.TgZ(9,"li",8),oe._uU(10,"Crear reportes"),oe.qZA()()()()(),oe.TgZ(11,"div",9)(12,"div",10),oe._UZ(13,"app-form"),oe.qZA()(),oe.TgZ(14,"div",11),oe._UZ(15,"app-mapa"),oe.qZA())},directives:[Yt,mr],styles:['.central[_ngcontent-%COMP%]{position:center}.frame[_ngcontent-%COMP%]{width:90%;margin:40px auto;text-align:center}.custom-btn[_ngcontent-%COMP%]{width:130px;height:40px;color:#fff;border-radius:5px;padding:10px 25px;font-family:"Times New Roman 12";font-weight:500;background:transparent;cursor:pointer;transition:all .3s ease;position:relative;display:inline-block;box-shadow:inset 2px 2px 2px #ffffff80,7px 7px 20px #0000001a,4px 4px 5px #0000001a;outline:none}.btn-5[_ngcontent-%COMP%]{width:130px;height:40px;line-height:42px;padding:0;border:none;background:#fe1308;background:linear-gradient(0deg,#fe1309 0%,#fe1509 100%)}.btn-5[_ngcontent-%COMP%]:hover{color:#f0094a;background:transparent;box-shadow:none}.btn-5[_ngcontent-%COMP%]:before, .btn-5[_ngcontent-%COMP%]:after{content:"";position:absolute;top:0;right:0;height:2px;width:0;background:#f0094a;box-shadow:-1px -1px 5px #fff,7px 7px 20px #0003,4px 4px 5px #0002;transition:.4s ease all}.btn-5[_ngcontent-%COMP%]:after{right:inherit;top:inherit;left:0;bottom:0}.btn-5[_ngcontent-%COMP%]:hover:before, .btn-5[_ngcontent-%COMP%]:hover:after{width:100%;transition:.8s ease all}']}),yn})(),data:{title:"Crear reportes"}},{path:"mini-map",component:(()=>{class yn{ngAfterViewInit(){var Tt;if(!(null===(Tt=this.divMap)||void 0===Tt?void 0:Tt.nativeElement))throw"Map Div not found";if(!this.lngLat)throw"LngLat can't be null";const En=new Sn.Map({container:this.divMap.nativeElement,style:"mapbox://styles/mapbox/satellite-streets-v11",center:this.lngLat,zoom:15,interactive:!1});(new Sn.Marker).setLngLat(this.lngLat).addTo(En)}ngOnInit(){}}return yn.\u0275fac=function(Tt){return new(Tt||yn)},yn.\u0275cmp=oe.Xpm({type:yn,selectors:[["app-mini-map"]],viewQuery:function(Tt,En){if(1&Tt&&oe.Gf(_i,5),2&Tt){let si;oe.iGM(si=oe.CRH())&&(En.divMap=si.first)}},inputs:{lngLat:"lngLat"},decls:2,vars:0,consts:[["map",""]],template:function(Tt,En){1&Tt&&oe._UZ(0,"div",null,0)},styles:["div[_ngcontent-%COMP%]{width:100%;height:150px;margin:0}"]}),yn})(),data:{title:"Mini mapa"}}];let Ti=(()=>{class yn{}return yn.\u0275fac=function(Tt){return new(Tt||yn)},yn.\u0275mod=oe.oAB({type:yn}),yn.\u0275inj=oe.cJS({imports:[[N.Bz.forChild(ui)],N.Bz]}),yn})(),Br=(()=>{class yn{}return yn.\u0275fac=function(Tt){return new(Tt||yn)},yn.\u0275mod=oe.oAB({type:yn}),yn.\u0275inj=oe.cJS({imports:[[D.ez,Ti,Wi.UX]]}),yn})()},665:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{S:()=>oe});var D=fe(9898),A=fe(1040),l=fe(4893);let oe=(()=>{class lt{constructor(){this.reporte=new A.n,this.latitud=this.reporte.latitud,this.longitud=this.reporte.longitud,this.marcadores=[],this.nuevoMarcador=[-84.4323471267699,10.05490747193752],this.center=[-84.4323471267699,10.05490747193752],this.nuevo={lng:-84.4323471267699,lat:10.05490747193752}}get isMapReady(){return!!this.map}setMap(Ke){this.map=Ke}agregarMarcador(){if(console.log(this.marcadores.length),0==this.marcadores.length){const ct=new D.Marker({draggable:!0,color:"red"}).setLngLat(this.center).addTo(this.map);this.marcadores.push({marker:ct,color:"red"}),this.guardarMarcadoresLocalStorage(),ct.on("dragend",()=>{this.guardarMarcadoresLocalStorage(),console.log(ct.getLngLat())})}else console.log("Solo se puede agregar un marcador")}guardarMarcadoresLocalStorage(){const Ke=[];this.marcadores.forEach(ct=>{const _t=ct.color,{lng:Nt,lat:wt}=ct.marker.getLngLat();Ke.push({color:_t,centro:[Nt,wt]})}),localStorage.setItem("marcadores",JSON.stringify(Ke))}leerMarcadoresLocalStorage(){if(localStorage.getItem("marcadores"))return 0==this.marcadores.length&&JSON.parse(localStorage.getItem("marcadores")).forEach(ct=>{const _t=new D.Marker({color:ct.color,draggable:!0}).setLngLat(ct.centro).addTo(this.map);this.marcadores.push({marker:_t,color:ct.color}),_t.on("dragend",()=>{this.guardarMarcadoresLocalStorage(),this.nuevo=_t.getLngLat()})}),this.marcadores[0].marker.getLngLat()}borrarMarcadorLocalStorage(){localStorage.removeItem("marcadores"),this.marcadores.forEach(Ke=>{var ct;return null===(ct=Ke.marker)||void 0===ct?void 0:ct.remove()}),this.marcadores=[]}}return lt.\u0275fac=function(Ke){return new(Ke||lt)},lt.\u0275prov=l.Yz7({token:lt,factory:lt.\u0275fac,providedIn:"root"}),lt})()},6709:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{j:()=>oe});var D=fe(520),N=fe(1040),A=fe(8505),l=fe(4893);let oe=(()=>{class lt{constructor(Ke){this.http=Ke,this.reportes=[]}getToken(){return{headers:new D.WM({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})}}get id(){return this.reporte.id}getHeaders(){return{headers:new D.WM({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})}}crearReporte(Ke,ct,_t,Nt,wt,Bt){return this.http.post("http://3.95.196.218/api/crear_reporte",{titulo:Ke,descripcion:ct,imagen:_t,longitud:Nt,latitud:wt,categoria_id:Bt},this.getHeaders())}getReportes(Ke){return this.http.get(`http://3.95.196.218/api/user_reportes/?page=${Ke}`,this.getHeaders())}getAllReportes(){return this.http.get("http://3.95.196.218/api/mostrar_reportes").pipe((0,A.b)(Ke=>{const{longitud:ct,latitud:_t,titulo:Nt,descripcion:wt,imagen:Bt,categoria_id:st}=Ke.reportes;this.reporte=new N.n(ct,_t,Nt,wt,Bt,st),this.reportes=Ke.reportes.map(at=>[at.longitud,at.latitud])}))}getReportesAceptados(){return this.http.get("http://3.95.196.218/api/aceptados_finalizados").pipe((0,A.b)(Ke=>{const{longitud:ct,latitud:_t,titulo:Nt,descripcion:wt,imagen:Bt,categoria_id:st}=Ke.reportes;this.reporte=new N.n(ct,_t,Nt,wt,Bt,st),this.reportes=Ke.reportes.map(at=>[at.longitud,at.latitud])}))}getReporteUTE(Ke){return this.http.get(`http://3.95.196.218/api/mostrar_reportes_UTE/?page=${Ke}`,this.getHeaders()).pipe((0,A.b)(ct=>{const{longitud:_t,latitud:Nt,titulo:wt,descripcion:Bt,imagen:st,categoria_id:at}=ct.reportes;this.reporte=new N.n(_t,Nt,wt,Bt,st,at)}))}getReporteId(Ke){return this.http.get("http://3.95.196.218/api/showById/"+Ke).pipe((0,A.b)(ct=>{this.reporteId=ct.reporte.id,console.log(this.reporteId)}))}getAllCategorias(){return this.http.get("http://3.95.196.218/api/mostrar_categoria",this.getHeaders()).pipe((0,A.b)(Ke=>{console.log(Ke)}))}getImagenReporte(Ke){let ct="";return ct="http://3.95.196.218/api/reportes/getImagenById/"+Ke,ct}aceptarReporte(Ke){const ct=`http://3.95.196.218/api/aceptar_reporte/${Ke}`,_t=this.getHeaders();return this.http.put(ct,null,_t)}rechazarReporte(Ke,ct){return this.http.put("http://3.95.196.218/api/rechazar_reporte/"+ct,{motivo:Ke},this.getHeaders())}finalizarReporte(Ke){const ct=`http://3.95.196.218/api/finalizar_reporte/${Ke}`,_t=this.getHeaders();return this.http.put(ct,null,_t)}subirImagen(Ke){const ct=new FormData;return ct.append("imagen",Ke,Ke.name),this.http.post("http://3.95.196.218/api/drive",ct)}actualizar_categoria_reporte(Ke,ct){return this.http.put("http://3.95.196.218/api/actualizar_categoria_reporte/"+Ke+"?categoria_id="+ct,{},this.getHeaders())}mostrarReportesByEstado(Ke,ct){return this.http.get(`http://3.95.196.218/api/reportes_estado_ute/${Ke}?page=${ct}`,this.getHeaders())}mostrar_justificacion(Ke){return this.http.get("http://3.95.196.218/api/mostrar_justificacion/"+Ke,this.getHeaders()).pipe((0,A.b)(ct=>{console.log(ct)}))}mostrarReporteId(Ke){return this.http.get("http://3.95.196.218/api/detalles_reportes/"+Ke,this.getHeaders())}}return lt.\u0275fac=function(Ke){return new(Ke||lt)(l.LFG(D.eN))},lt.\u0275prov=l.Yz7({token:lt,factory:lt.\u0275fac,providedIn:"root"}),lt})()},4466:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{m:()=>lt});var D=fe(9808),N=fe(1810),A=fe(5436),l=fe(937),oe=fe(4893);let lt=(()=>{class At{}return At.\u0275fac=function(ct){return new(ct||At)},At.\u0275mod=oe.oAB({type:At}),At.\u0275inj=oe.cJS({providers:[],imports:[[N.Bz,D.ez,A.IJ,l.Xd],D.ez,A.IJ]}),At})()},2340:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{N:()=>D});const D={production:!1,apiUrl:"\u200bhttp://3.95.196.218/api",baseUrl:"http://3.95.196.218",mapboxToken:"pk.eyJ1IjoibHVpc2NyMTAiLCJhIjoiY2w5dXQ3dGo3MGs4ZjN3cXlkNzc5dzZzZCJ9.q21HIAk0ofHdjb-XExV42A"}},7563:(Bi,Zt,fe)=>{"use strict";var D=fe(9808),N=fe(4893);class A extends D.w_{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class l extends A{static makeCurrent(){(0,D.HT)(new l)}onAndCancel(P,S,H){return P.addEventListener(S,H,!1),()=>{P.removeEventListener(S,H,!1)}}dispatchEvent(P,S){P.dispatchEvent(S)}remove(P){P.parentNode&&P.parentNode.removeChild(P)}createElement(P,S){return(S=S||this.getDefaultDocument()).createElement(P)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(P){return P.nodeType===Node.ELEMENT_NODE}isShadowRoot(P){return P instanceof DocumentFragment}getGlobalEventTarget(P,S){return"window"===S?window:"document"===S?P:"body"===S?P.body:null}getBaseHref(P){const S=function lt(){return oe=oe||document.querySelector("base"),oe?oe.getAttribute("href"):null}();return null==S?null:function Ke(G){At=At||document.createElement("a"),At.setAttribute("href",G);const P=At.pathname;return"/"===P.charAt(0)?P:`/${P}`}(S)}resetBaseElement(){oe=null}getUserAgent(){return window.navigator.userAgent}getCookie(P){return(0,D.Mx)(document.cookie,P)}}let At,oe=null;const ct=new N.OlP("TRANSITION_ID"),Nt=[{provide:N.ip1,useFactory:function _t(G,P,S){return()=>{S.get(N.CZH).donePromise.then(()=>{const H=(0,D.q)(),me=P.querySelectorAll(`style[ng-transition="${G}"]`);for(let Ne=0;Ne<me.length;Ne++)H.remove(me[Ne])})}},deps:[ct,D.K0,N.zs3],multi:!0}];class wt{static init(){(0,N.VLi)(new wt)}addToWindow(P){N.dqk.getAngularTestability=(H,me=!0)=>{const Ne=P.findTestabilityInTree(H,me);if(null==Ne)throw new Error("Could not find testability for element.");return Ne},N.dqk.getAllAngularTestabilities=()=>P.getAllTestabilities(),N.dqk.getAllAngularRootElements=()=>P.getAllRootElements(),N.dqk.frameworkStabilizers||(N.dqk.frameworkStabilizers=[]),N.dqk.frameworkStabilizers.push(H=>{const me=N.dqk.getAllAngularTestabilities();let Ne=me.length,Qe=!1;const pt=function(Qt){Qe=Qe||Qt,Ne--,0==Ne&&H(Qe)};me.forEach(function(Qt){Qt.whenStable(pt)})})}findTestabilityInTree(P,S,H){if(null==S)return null;const me=P.getTestability(S);return null!=me?me:H?(0,D.q)().isShadowRoot(S)?this.findTestabilityInTree(P,S.host,!0):this.findTestabilityInTree(P,S.parentElement,!0):null}}let Bt=(()=>{class G{build(){return new XMLHttpRequest}}return G.\u0275fac=function(S){return new(S||G)},G.\u0275prov=N.Yz7({token:G,factory:G.\u0275fac}),G})();const st=new N.OlP("EventManagerPlugins");let at=(()=>{class G{constructor(S,H){this._zone=H,this._eventNameToPlugin=new Map,S.forEach(me=>me.manager=this),this._plugins=S.slice().reverse()}addEventListener(S,H,me){return this._findPluginFor(H).addEventListener(S,H,me)}addGlobalEventListener(S,H,me){return this._findPluginFor(H).addGlobalEventListener(S,H,me)}getZone(){return this._zone}_findPluginFor(S){const H=this._eventNameToPlugin.get(S);if(H)return H;const me=this._plugins;for(let Ne=0;Ne<me.length;Ne++){const Qe=me[Ne];if(Qe.supports(S))return this._eventNameToPlugin.set(S,Qe),Qe}throw new Error(`No event manager plugin found for event ${S}`)}}return G.\u0275fac=function(S){return new(S||G)(N.LFG(st),N.LFG(N.R0b))},G.\u0275prov=N.Yz7({token:G,factory:G.\u0275fac}),G})();class ft{constructor(P){this._doc=P}addGlobalEventListener(P,S,H){const me=(0,D.q)().getGlobalEventTarget(this._doc,P);if(!me)throw new Error(`Unsupported event target ${me} for event ${S}`);return this.addEventListener(me,S,H)}}let tn=(()=>{class G{constructor(){this._stylesSet=new Set}addStyles(S){const H=new Set;S.forEach(me=>{this._stylesSet.has(me)||(this._stylesSet.add(me),H.add(me))}),this.onStylesAdded(H)}onStylesAdded(S){}getAllStyles(){return Array.from(this._stylesSet)}}return G.\u0275fac=function(S){return new(S||G)},G.\u0275prov=N.Yz7({token:G,factory:G.\u0275fac}),G})(),kt=(()=>{class G extends tn{constructor(S){super(),this._doc=S,this._hostNodes=new Map,this._hostNodes.set(S.head,[])}_addStylesToHost(S,H,me){S.forEach(Ne=>{const Qe=this._doc.createElement("style");Qe.textContent=Ne,me.push(H.appendChild(Qe))})}addHost(S){const H=[];this._addStylesToHost(this._stylesSet,S,H),this._hostNodes.set(S,H)}removeHost(S){const H=this._hostNodes.get(S);H&&H.forEach(dn),this._hostNodes.delete(S)}onStylesAdded(S){this._hostNodes.forEach((H,me)=>{this._addStylesToHost(S,me,H)})}ngOnDestroy(){this._hostNodes.forEach(S=>S.forEach(dn))}}return G.\u0275fac=function(S){return new(S||G)(N.LFG(D.K0))},G.\u0275prov=N.Yz7({token:G,factory:G.\u0275fac}),G})();function dn(G){(0,D.q)().remove(G)}const Qn={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},on=/%COMP%/g;function Jt(G,P,S){for(let H=0;H<P.length;H++){let me=P[H];Array.isArray(me)?Jt(G,me,S):(me=me.replace(on,G),S.push(me))}return S}function $t(G){return P=>{if("__ngUnwrap__"===P)return G;!1===G(P)&&(P.preventDefault(),P.returnValue=!1)}}let an=(()=>{class G{constructor(S,H,me){this.eventManager=S,this.sharedStylesHost=H,this.appId=me,this.rendererByCompId=new Map,this.defaultRenderer=new Yt(S)}createRenderer(S,H){if(!S||!H)return this.defaultRenderer;switch(H.encapsulation){case N.ifc.Emulated:{let me=this.rendererByCompId.get(H.id);return me||(me=new Mi(this.eventManager,this.sharedStylesHost,H,this.appId),this.rendererByCompId.set(H.id,me)),me.applyToHost(S),me}case 1:case N.ifc.ShadowDom:return new mr(this.eventManager,this.sharedStylesHost,S,H);default:if(!this.rendererByCompId.has(H.id)){const me=Jt(H.id,H.styles,[]);this.sharedStylesHost.addStyles(me),this.rendererByCompId.set(H.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return G.\u0275fac=function(S){return new(S||G)(N.LFG(at),N.LFG(kt),N.LFG(N.AFp))},G.\u0275prov=N.Yz7({token:G,factory:G.\u0275fac}),G})();class Yt{constructor(P){this.eventManager=P,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(P,S){return S?document.createElementNS(Qn[S]||S,P):document.createElement(P)}createComment(P){return document.createComment(P)}createText(P){return document.createTextNode(P)}appendChild(P,S){P.appendChild(S)}insertBefore(P,S,H){P&&P.insertBefore(S,H)}removeChild(P,S){P&&P.removeChild(S)}selectRootElement(P,S){let H="string"==typeof P?document.querySelector(P):P;if(!H)throw new Error(`The selector "${P}" did not match any elements`);return S||(H.textContent=""),H}parentNode(P){return P.parentNode}nextSibling(P){return P.nextSibling}setAttribute(P,S,H,me){if(me){S=me+":"+S;const Ne=Qn[me];Ne?P.setAttributeNS(Ne,S,H):P.setAttribute(S,H)}else P.setAttribute(S,H)}removeAttribute(P,S,H){if(H){const me=Qn[H];me?P.removeAttributeNS(me,S):P.removeAttribute(`${H}:${S}`)}else P.removeAttribute(S)}addClass(P,S){P.classList.add(S)}removeClass(P,S){P.classList.remove(S)}setStyle(P,S,H,me){me&(N.JOm.DashCase|N.JOm.Important)?P.style.setProperty(S,H,me&N.JOm.Important?"important":""):P.style[S]=H}removeStyle(P,S,H){H&N.JOm.DashCase?P.style.removeProperty(S):P.style[S]=""}setProperty(P,S,H){P[S]=H}setValue(P,S){P.nodeValue=S}listen(P,S,H){return"string"==typeof P?this.eventManager.addGlobalEventListener(P,S,$t(H)):this.eventManager.addEventListener(P,S,$t(H))}}class Mi extends Yt{constructor(P,S,H,me){super(P),this.component=H;const Ne=Jt(me+"-"+H.id,H.styles,[]);S.addStyles(Ne),this.contentAttr=function kn(G){return"_ngcontent-%COMP%".replace(on,G)}(me+"-"+H.id),this.hostAttr=function Ci(G){return"_nghost-%COMP%".replace(on,G)}(me+"-"+H.id)}applyToHost(P){super.setAttribute(P,this.hostAttr,"")}createElement(P,S){const H=super.createElement(P,S);return super.setAttribute(H,this.contentAttr,""),H}}class mr extends Yt{constructor(P,S,H,me){super(P),this.sharedStylesHost=S,this.hostEl=H,this.shadowRoot=H.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const Ne=Jt(me.id,me.styles,[]);for(let Qe=0;Qe<Ne.length;Qe++){const pt=document.createElement("style");pt.textContent=Ne[Qe],this.shadowRoot.appendChild(pt)}}nodeOrShadowRoot(P){return P===this.hostEl?this.shadowRoot:P}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(P,S){return super.appendChild(this.nodeOrShadowRoot(P),S)}insertBefore(P,S,H){return super.insertBefore(this.nodeOrShadowRoot(P),S,H)}removeChild(P,S){return super.removeChild(this.nodeOrShadowRoot(P),S)}parentNode(P){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(P)))}}let wi=(()=>{class G extends ft{constructor(S){super(S)}supports(S){return!0}addEventListener(S,H,me){return S.addEventListener(H,me,!1),()=>this.removeEventListener(S,H,me)}removeEventListener(S,H,me){return S.removeEventListener(H,me)}}return G.\u0275fac=function(S){return new(S||G)(N.LFG(D.K0))},G.\u0275prov=N.Yz7({token:G,factory:G.\u0275fac}),G})();const _i=["alt","control","meta","shift"],ui={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Ti={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Br={alt:G=>G.altKey,control:G=>G.ctrlKey,meta:G=>G.metaKey,shift:G=>G.shiftKey};let yn=(()=>{class G extends ft{constructor(S){super(S)}supports(S){return null!=G.parseEventName(S)}addEventListener(S,H,me){const Ne=G.parseEventName(H),Qe=G.eventCallback(Ne.fullKey,me,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>(0,D.q)().onAndCancel(S,Ne.domEventName,Qe))}static parseEventName(S){const H=S.toLowerCase().split("."),me=H.shift();if(0===H.length||"keydown"!==me&&"keyup"!==me)return null;const Ne=G._normalizeKey(H.pop());let Qe="";if(_i.forEach(Qt=>{const mn=H.indexOf(Qt);mn>-1&&(H.splice(mn,1),Qe+=Qt+".")}),Qe+=Ne,0!=H.length||0===Ne.length)return null;const pt={};return pt.domEventName=me,pt.fullKey=Qe,pt}static getEventFullKey(S){let H="",me=function oi(G){let P=G.key;if(null==P){if(P=G.keyIdentifier,null==P)return"Unidentified";P.startsWith("U+")&&(P=String.fromCharCode(parseInt(P.substring(2),16)),3===G.location&&Ti.hasOwnProperty(P)&&(P=Ti[P]))}return ui[P]||P}(S);return me=me.toLowerCase()," "===me?me="space":"."===me&&(me="dot"),_i.forEach(Ne=>{Ne!=me&&Br[Ne](S)&&(H+=Ne+".")}),H+=me,H}static eventCallback(S,H,me){return Ne=>{G.getEventFullKey(Ne)===S&&me.runGuarded(()=>H(Ne))}}static _normalizeKey(S){return"esc"===S?"escape":S}}return G.\u0275fac=function(S){return new(S||G)(N.LFG(D.K0))},G.\u0275prov=N.Yz7({token:G,factory:G.\u0275fac}),G})();const nr=(0,N.eFA)(N._c5,"browser",[{provide:N.Lbi,useValue:D.bD},{provide:N.g9A,useValue:function Tt(){l.makeCurrent(),wt.init()},multi:!0},{provide:D.K0,useFactory:function si(){return(0,N.RDi)(document),document},deps:[]}]),Tr=[{provide:N.zSh,useValue:"root"},{provide:N.qLn,useFactory:function En(){return new N.qLn},deps:[]},{provide:st,useClass:wi,multi:!0,deps:[D.K0,N.R0b,N.Lbi]},{provide:st,useClass:yn,multi:!0,deps:[D.K0]},{provide:an,useClass:an,deps:[at,kt,N.AFp]},{provide:N.FYo,useExisting:an},{provide:tn,useExisting:kt},{provide:kt,useClass:kt,deps:[D.K0]},{provide:N.dDg,useClass:N.dDg,deps:[N.R0b]},{provide:at,useClass:at,deps:[st,N.R0b]},{provide:D.JF,useClass:Bt,deps:[]}];let Zr=(()=>{class G{constructor(S){if(S)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(S){return{ngModule:G,providers:[{provide:N.AFp,useValue:S.appId},{provide:ct,useExisting:N.AFp},Nt]}}}return G.\u0275fac=function(S){return new(S||G)(N.LFG(G,12))},G.\u0275mod=N.oAB({type:G}),G.\u0275inj=N.cJS({providers:Tr,imports:[D.ez,N.hGG]}),G})();"undefined"!=typeof window&&window;let Me=(()=>{class G{}return G.\u0275fac=function(S){return new(S||G)},G.\u0275prov=N.Yz7({token:G,factory:function(S){let H=null;return H=S?new(S||G):N.LFG(Xe),H},providedIn:"root"}),G})(),Xe=(()=>{class G extends Me{constructor(S){super(),this._doc=S}sanitize(S,H){if(null==H)return null;switch(S){case N.q3G.NONE:return H;case N.q3G.HTML:return(0,N.qzn)(H,"HTML")?(0,N.z3N)(H):(0,N.EiD)(this._doc,String(H)).toString();case N.q3G.STYLE:return(0,N.qzn)(H,"Style")?(0,N.z3N)(H):H;case N.q3G.SCRIPT:if((0,N.qzn)(H,"Script"))return(0,N.z3N)(H);throw new Error("unsafe value used in a script context");case N.q3G.URL:return(0,N.yhl)(H),(0,N.qzn)(H,"URL")?(0,N.z3N)(H):(0,N.mCW)(String(H));case N.q3G.RESOURCE_URL:if((0,N.qzn)(H,"ResourceURL"))return(0,N.z3N)(H);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${S} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(S){return(0,N.JVY)(S)}bypassSecurityTrustStyle(S){return(0,N.L6k)(S)}bypassSecurityTrustScript(S){return(0,N.eBb)(S)}bypassSecurityTrustUrl(S){return(0,N.LAX)(S)}bypassSecurityTrustResourceUrl(S){return(0,N.pB0)(S)}}return G.\u0275fac=function(S){return new(S||G)(N.LFG(D.K0))},G.\u0275prov=N.Yz7({token:G,factory:function(S){let H=null;return H=S?new S:function We(G){return new Xe(G.get(D.K0))}(N.LFG(N.zs3)),H},providedIn:"root"}),G})();class Gt{}const nt="*";function Se(G,P=null){return{type:2,steps:G,options:P}}function Be(G){return{type:6,styles:G,offset:null}}function qt(G){Promise.resolve(null).then(G)}class Gr{constructor(P=0,S=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=P+S}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(P=>P()),this._onDoneFns=[])}onStart(P){this._onStartFns.push(P)}onDone(P){this._onDoneFns.push(P)}onDestroy(P){this._onDestroyFns.push(P)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){qt(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(P=>P()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(P=>P()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(P){this._position=this.totalTime?P*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(P){const S="start"==P?this._onStartFns:this._onDoneFns;S.forEach(H=>H()),S.length=0}}class gr{constructor(P){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=P;let S=0,H=0,me=0;const Ne=this.players.length;0==Ne?qt(()=>this._onFinish()):this.players.forEach(Qe=>{Qe.onDone(()=>{++S==Ne&&this._onFinish()}),Qe.onDestroy(()=>{++H==Ne&&this._onDestroy()}),Qe.onStart(()=>{++me==Ne&&this._onStart()})}),this.totalTime=this.players.reduce((Qe,pt)=>Math.max(Qe,pt.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(P=>P()),this._onDoneFns=[])}init(){this.players.forEach(P=>P.init())}onStart(P){this._onStartFns.push(P)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(P=>P()),this._onStartFns=[])}onDone(P){this._onDoneFns.push(P)}onDestroy(P){this._onDestroyFns.push(P)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(P=>P.play())}pause(){this.players.forEach(P=>P.pause())}restart(){this.players.forEach(P=>P.restart())}finish(){this._onFinish(),this.players.forEach(P=>P.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(P=>P.destroy()),this._onDestroyFns.forEach(P=>P()),this._onDestroyFns=[])}reset(){this.players.forEach(P=>P.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(P){const S=P*this.totalTime;this.players.forEach(H=>{const me=H.totalTime?Math.min(1,S/H.totalTime):1;H.setPosition(me)})}getPosition(){const P=this.players.reduce((S,H)=>null===S||H.totalTime>S.totalTime?H:S,null);return null!=P?P.getPosition():0}beforeDestroy(){this.players.forEach(P=>{P.beforeDestroy&&P.beforeDestroy()})}triggerCallback(P){const S="start"==P?this._onStartFns:this._onDoneFns;S.forEach(H=>H()),S.length=0}}const ti=!1;function Er(G){return new N.vHH(3e3,ti)}function zs(){return"undefined"!=typeof window&&void 0!==window.document}function Qr(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function da(G){switch(G.length){case 0:return new Gr;case 1:return G[0];default:return new gr(G)}}function Da(G,P,S,H,me={},Ne={}){const Qe=[],pt=[];let Qt=-1,mn=null;if(H.forEach(Ri=>{const ar=Ri.offset,Pr=ar==Qt,oo=Pr&&mn||{};Object.keys(Ri).forEach(kr=>{let Or=kr,_r=Ri[kr];if("offset"!==kr)switch(Or=P.normalizePropertyName(Or,Qe),_r){case"!":_r=me[kr];break;case nt:_r=Ne[kr];break;default:_r=P.normalizeStyleValue(kr,Or,_r,Qe)}oo[Or]=_r}),Pr||pt.push(oo),mn=oo,Qt=ar}),Qe.length)throw function Ir(G){return new N.vHH(3502,ti)}();return pt}function Us(G,P,S,H){switch(P){case"start":G.onStart(()=>H(S&&Sa(S,"start",G)));break;case"done":G.onDone(()=>H(S&&Sa(S,"done",G)));break;case"destroy":G.onDestroy(()=>H(S&&Sa(S,"destroy",G)))}}function Sa(G,P,S){const H=S.totalTime,Ne=qs(G.element,G.triggerName,G.fromState,G.toState,P||G.phaseName,null==H?G.totalTime:H,!!S.disabled),Qe=G._data;return null!=Qe&&(Ne._data=Qe),Ne}function qs(G,P,S,H,me="",Ne=0,Qe){return{element:G,triggerName:P,fromState:S,toState:H,phaseName:me,totalTime:Ne,disabled:!!Qe}}function Oo(G,P,S){let H;return G instanceof Map?(H=G.get(P),H||G.set(P,H=S)):(H=G[P],H||(H=G[P]=S)),H}function Mo(G){const P=G.indexOf(":");return[G.substring(1,P),G.substr(P+1)]}let eo=(G,P)=>!1,Xo=(G,P,S)=>[],As=null;function Ms(G){const P=G.parentNode||G.host;return P===As?null:P}(Qr()||"undefined"!=typeof Element)&&(zs()?(As=(()=>document.documentElement)(),eo=(G,P)=>{for(;P;){if(P===G)return!0;P=Ms(P)}return!1}):eo=(G,P)=>G.contains(P),Xo=(G,P,S)=>{if(S)return Array.from(G.querySelectorAll(P));const H=G.querySelector(P);return H?[H]:[]});let ds=null,ea=!1;function Vs(G){ds||(ds=function Wr(){return"undefined"!=typeof document?document.body:null}()||{},ea=!!ds.style&&"WebkitAppearance"in ds.style);let P=!0;return ds.style&&!function Aa(G){return"ebkit"==G.substring(1,6)}(G)&&(P=G in ds.style,!P&&ea&&(P="Webkit"+G.charAt(0).toUpperCase()+G.substr(1)in ds.style)),P}const fs=eo,js=Xo;let Wa=(()=>{class G{validateStyleProperty(S){return Vs(S)}matchesElement(S,H){return!1}containsElement(S,H){return fs(S,H)}getParentElement(S){return Ms(S)}query(S,H,me){return js(S,H,me)}computeStyle(S,H,me){return me||""}animate(S,H,me,Ne,Qe,pt=[],Qt){return new Gr(me,Ne)}}return G.\u0275fac=function(S){return new(S||G)},G.\u0275prov=N.Yz7({token:G,factory:G.\u0275fac}),G})(),I=(()=>{class G{}return G.NOOP=new Wa,G})();const Ee="ng-enter",Ae="ng-leave",Le="ng-trigger",Y=".ng-trigger",le="ng-animating",ee=".ng-animating";function be(G){if("number"==typeof G)return G;const P=G.match(/^(-?[\.\d]+)(m?s)/);return!P||P.length<2?0:je(parseFloat(P[1]),P[2])}function je(G,P){return"s"===P?1e3*G:G}function Ye(G,P,S){return G.hasOwnProperty("duration")?G:function mt(G,P,S){let me,Ne=0,Qe="";if("string"==typeof G){const pt=G.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===pt)return P.push(Er()),{duration:0,delay:0,easing:""};me=je(parseFloat(pt[1]),pt[2]);const Qt=pt[3];null!=Qt&&(Ne=je(parseFloat(Qt),pt[4]));const mn=pt[5];mn&&(Qe=mn)}else me=G;if(!S){let pt=!1,Qt=P.length;me<0&&(P.push(function Mr(){return new N.vHH(3100,ti)}()),pt=!0),Ne<0&&(P.push(function Nr(){return new N.vHH(3101,ti)}()),pt=!0),pt&&P.splice(Qt,0,Er())}return{duration:me,delay:Ne,easing:Qe}}(G,P,S)}function On(G,P={}){return Object.keys(G).forEach(S=>{P[S]=G[S]}),P}function wn(G,P,S={}){if(P)for(let H in G)S[H]=G[H];else On(G,S);return S}function er(G,P,S){return S?P+":"+S+";":""}function ji(G){let P="";for(let S=0;S<G.style.length;S++){const H=G.style.item(S);P+=er(0,H,G.style.getPropertyValue(H))}for(const S in G.style)G.style.hasOwnProperty(S)&&!S.startsWith("_")&&(P+=er(0,Jo(S),G.style[S]));G.setAttribute("style",P)}function Lr(G,P,S){G.style&&(Object.keys(P).forEach(H=>{const me=vi(H);S&&!S.hasOwnProperty(H)&&(S[H]=G.style[me]),G.style[me]=P[H]}),Qr()&&ji(G))}function Zi(G,P){G.style&&(Object.keys(P).forEach(S=>{const H=vi(S);G.style[H]=""}),Qr()&&ji(G))}function bi(G){return Array.isArray(G)?1==G.length?G[0]:Se(G):G}const he=new RegExp("{{\\s*(.+?)\\s*}}","g");function ae(G){let P=[];if("string"==typeof G){let S;for(;S=he.exec(G);)P.push(S[1]);he.lastIndex=0}return P}function Re(G,P,S){const H=G.toString(),me=H.replace(he,(Ne,Qe)=>{let pt=P[Qe];return P.hasOwnProperty(Qe)||(S.push(function Fi(G){return new N.vHH(3003,ti)}()),pt=""),pt.toString()});return me==H?G:me}function gn(G){const P=[];let S=G.next();for(;!S.done;)P.push(S.value),S=G.next();return P}const xi=/-+([a-z0-9])/g;function vi(G){return G.replace(xi,(...P)=>P[1].toUpperCase())}function Jo(G){return G.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function No(G,P,S){switch(P.type){case 7:return G.visitTrigger(P,S);case 0:return G.visitState(P,S);case 1:return G.visitTransition(P,S);case 2:return G.visitSequence(P,S);case 3:return G.visitGroup(P,S);case 4:return G.visitAnimate(P,S);case 5:return G.visitKeyframes(P,S);case 6:return G.visitStyle(P,S);case 8:return G.visitReference(P,S);case 9:return G.visitAnimateChild(P,S);case 10:return G.visitAnimateRef(P,S);case 11:return G.visitQuery(P,S);case 12:return G.visitStagger(P,S);default:throw function Xi(G){return new N.vHH(3004,ti)}()}}function xs(G,P){return window.getComputedStyle(G)[P]}function Qo(G,P){const S=[];return"string"==typeof G?G.split(/\s*,\s*/).forEach(H=>function yl(G,P,S){if(":"==G[0]){const Qt=function Ua(G,P){switch(G){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(S,H)=>parseFloat(H)>parseFloat(S);case":decrement":return(S,H)=>parseFloat(H)<parseFloat(S);default:return P.push(function xr(G){return new N.vHH(3016,ti)}()),"* => *"}}(G,S);if("function"==typeof Qt)return void P.push(Qt);G=Qt}const H=G.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==H||H.length<4)return S.push(function po(G){return new N.vHH(3015,ti)}()),P;const me=H[1],Ne=H[2],Qe=H[3];P.push(Ma(me,Qe));"<"==Ne[0]&&!("*"==me&&"*"==Qe)&&P.push(Ma(Qe,me))}(H,S,P)):S.push(G),S}const hl=new Set(["true","1"]),Ya=new Set(["false","0"]);function Ma(G,P){const S=hl.has(G)||Ya.has(G),H=hl.has(P)||Ya.has(P);return(me,Ne)=>{let Qe="*"==G||G==me,pt="*"==P||P==Ne;return!Qe&&S&&"boolean"==typeof me&&(Qe=me?hl.has(G):Ya.has(G)),!pt&&H&&"boolean"==typeof Ne&&(pt=Ne?hl.has(P):Ya.has(P)),Qe&&pt}}const ss=new RegExp("s*:selfs*,?","g");function ba(G,P,S,H){return new xa(G).build(P,S,H)}class xa{constructor(P){this._driver=P}build(P,S,H){const me=new Is(S);this._resetContextStyleTimingState(me);const Ne=No(this,bi(P),me);return me.unsupportedCSSPropertiesFound.size&&me.unsupportedCSSPropertiesFound.keys(),Ne}_resetContextStyleTimingState(P){P.currentQuerySelector="",P.collectedStyles={},P.collectedStyles[""]={},P.currentTime=0}visitTrigger(P,S){let H=S.queryCount=0,me=S.depCount=0;const Ne=[],Qe=[];return"@"==P.name.charAt(0)&&S.errors.push(function yi(){return new N.vHH(3006,ti)}()),P.definitions.forEach(pt=>{if(this._resetContextStyleTimingState(S),0==pt.type){const Qt=pt,mn=Qt.name;mn.toString().split(/\s*,\s*/).forEach(Ri=>{Qt.name=Ri,Ne.push(this.visitState(Qt,S))}),Qt.name=mn}else if(1==pt.type){const Qt=this.visitTransition(pt,S);H+=Qt.queryCount,me+=Qt.depCount,Qe.push(Qt)}else S.errors.push(function Ji(){return new N.vHH(3007,ti)}())}),{type:7,name:P.name,states:Ne,transitions:Qe,queryCount:H,depCount:me,options:null}}visitState(P,S){const H=this.visitStyle(P.styles,S),me=P.options&&P.options.params||null;if(H.containsDynamicStyles){const Ne=new Set,Qe=me||{};H.styles.forEach(pt=>{if(_s(pt)){const Qt=pt;Object.keys(Qt).forEach(mn=>{ae(Qt[mn]).forEach(Ri=>{Qe.hasOwnProperty(Ri)||Ne.add(Ri)})})}}),Ne.size&&(gn(Ne.values()),S.errors.push(function Ko(G,P){return new N.vHH(3008,ti)}()))}return{type:0,name:P.name,style:H,options:me?{params:me}:null}}visitTransition(P,S){S.queryCount=0,S.depCount=0;const H=No(this,bi(P.animation),S);return{type:1,matchers:Qo(P.expr,S.errors),animation:H,queryCount:S.queryCount,depCount:S.depCount,options:Ia(P.options)}}visitSequence(P,S){return{type:2,steps:P.steps.map(H=>No(this,H,S)),options:Ia(P.options)}}visitGroup(P,S){const H=S.currentTime;let me=0;const Ne=P.steps.map(Qe=>{S.currentTime=H;const pt=No(this,Qe,S);return me=Math.max(me,S.currentTime),pt});return S.currentTime=me,{type:3,steps:Ne,options:Ia(P.options)}}visitAnimate(P,S){const H=function Va(G,P){let S=null;if(G.hasOwnProperty("duration"))S=G;else if("number"==typeof G)return bl(Ye(G,P).duration,0,"");const H=G;if(H.split(/\s+/).some(Ne=>"{"==Ne.charAt(0)&&"{"==Ne.charAt(1))){const Ne=bl(0,0,"");return Ne.dynamic=!0,Ne.strValue=H,Ne}return S=S||Ye(H,P),bl(S.duration,S.delay,S.easing)}(P.timings,S.errors);S.currentAnimateTimings=H;let me,Ne=P.styles?P.styles:Be({});if(5==Ne.type)me=this.visitKeyframes(Ne,S);else{let Qe=P.styles,pt=!1;if(!Qe){pt=!0;const mn={};H.easing&&(mn.easing=H.easing),Qe=Be(mn)}S.currentTime+=H.duration+H.delay;const Qt=this.visitStyle(Qe,S);Qt.isEmptyStep=pt,me=Qt}return S.currentAnimateTimings=null,{type:4,timings:H,style:me,options:null}}visitStyle(P,S){const H=this._makeStyleAst(P,S);return this._validateStyleAst(H,S),H}_makeStyleAst(P,S){const H=[];Array.isArray(P.styles)?P.styles.forEach(Qe=>{"string"==typeof Qe?Qe==nt?H.push(Qe):S.errors.push(function us(G){return new N.vHH(3002,ti)}()):H.push(Qe)}):H.push(P.styles);let me=!1,Ne=null;return H.forEach(Qe=>{if(_s(Qe)){const pt=Qe,Qt=pt.easing;if(Qt&&(Ne=Qt,delete pt.easing),!me)for(let mn in pt)if(pt[mn].toString().indexOf("{{")>=0){me=!0;break}}}),{type:6,styles:H,easing:Ne,offset:P.offset,containsDynamicStyles:me,options:null}}_validateStyleAst(P,S){const H=S.currentAnimateTimings;let me=S.currentTime,Ne=S.currentTime;H&&Ne>0&&(Ne-=H.duration+H.delay),P.styles.forEach(Qe=>{"string"!=typeof Qe&&Object.keys(Qe).forEach(pt=>{if(!this._driver.validateStyleProperty(pt))return delete Qe[pt],void S.unsupportedCSSPropertiesFound.add(pt);const Qt=S.collectedStyles[S.currentQuerySelector],mn=Qt[pt];let Ri=!0;mn&&(Ne!=me&&Ne>=mn.startTime&&me<=mn.endTime&&(S.errors.push(function Hi(G,P,S,H,me){return new N.vHH(3010,ti)}()),Ri=!1),Ne=mn.startTime),Ri&&(Qt[pt]={startTime:Ne,endTime:me}),S.options&&function ge(G,P,S){const H=P.params||{},me=ae(G);me.length&&me.forEach(Ne=>{H.hasOwnProperty(Ne)||S.push(function Wn(G){return new N.vHH(3001,ti)}())})}(Qe[pt],S.options,S.errors)})})}visitKeyframes(P,S){const H={type:5,styles:[],options:null};if(!S.currentAnimateTimings)return S.errors.push(function lr(){return new N.vHH(3011,ti)}()),H;let Ne=0;const Qe=[];let pt=!1,Qt=!1,mn=0;const Ri=P.steps.map(Lo=>{const qo=this._makeStyleAst(Lo,S);let ia=null!=qo.offset?qo.offset:function wa(G){if("string"==typeof G)return null;let P=null;if(Array.isArray(G))G.forEach(S=>{if(_s(S)&&S.hasOwnProperty("offset")){const H=S;P=parseFloat(H.offset),delete H.offset}});else if(_s(G)&&G.hasOwnProperty("offset")){const S=G;P=parseFloat(S.offset),delete S.offset}return P}(qo.styles),Ja=0;return null!=ia&&(Ne++,Ja=qo.offset=ia),Qt=Qt||Ja<0||Ja>1,pt=pt||Ja<mn,mn=Ja,Qe.push(Ja),qo});Qt&&S.errors.push(function ks(){return new N.vHH(3012,ti)}()),pt&&S.errors.push(function Po(){return new N.vHH(3200,ti)}());const ar=P.steps.length;let Pr=0;Ne>0&&Ne<ar?S.errors.push(function Dr(){return new N.vHH(3202,ti)}()):0==Ne&&(Pr=1/(ar-1));const oo=ar-1,kr=S.currentTime,Or=S.currentAnimateTimings,_r=Or.duration;return Ri.forEach((Lo,qo)=>{const ia=Pr>0?qo==oo?1:Pr*qo:Qe[qo],Ja=ia*_r;S.currentTime=kr+Or.delay+Ja,Or.duration=Ja,this._validateStyleAst(Lo,S),Lo.offset=ia,H.styles.push(Lo)}),H}visitReference(P,S){return{type:8,animation:No(this,bi(P.animation),S),options:Ia(P.options)}}visitAnimateChild(P,S){return S.depCount++,{type:9,options:Ia(P.options)}}visitAnimateRef(P,S){return{type:10,animation:this.visitReference(P.animation,S),options:Ia(P.options)}}visitQuery(P,S){const H=S.currentQuerySelector,me=P.options||{};S.queryCount++,S.currentQuery=P;const[Ne,Qe]=function gs(G){const P=!!G.split(/\s*,\s*/).find(S=>":self"==S);return P&&(G=G.replace(ss,"")),G=G.replace(/@\*/g,Y).replace(/@\w+/g,S=>Y+"-"+S.substr(1)).replace(/:animating/g,ee),[G,P]}(P.selector);S.currentQuerySelector=H.length?H+" "+Ne:Ne,Oo(S.collectedStyles,S.currentQuerySelector,{});const pt=No(this,bi(P.animation),S);return S.currentQuery=null,S.currentQuerySelector=H,{type:11,selector:Ne,limit:me.limit||0,optional:!!me.optional,includeSelf:Qe,animation:pt,originalSelector:P.selector,options:Ia(P.options)}}visitStagger(P,S){S.currentQuery||S.errors.push(function Uo(){return new N.vHH(3013,ti)}());const H="full"===P.timings?{duration:0,delay:0,easing:"full"}:Ye(P.timings,S.errors,!0);return{type:12,animation:No(this,bi(P.animation),S),timings:H,options:null}}}class Is{constructor(P){this.errors=P,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function _s(G){return!Array.isArray(G)&&"object"==typeof G}function Ia(G){return G?(G=On(G)).params&&(G.params=function vl(G){return G?On(G):null}(G.params)):G={},G}function bl(G,P,S){return{duration:G,delay:P,easing:S}}function io(G,P,S,H,me,Ne,Qe=null,pt=!1){return{type:1,element:G,keyframes:P,preStyleProps:S,postStyleProps:H,duration:me,delay:Ne,totalTime:me+Ne,easing:Qe,subTimeline:pt}}class Fa{constructor(){this._map=new Map}get(P){return this._map.get(P)||[]}append(P,S){let H=this._map.get(P);H||this._map.set(P,H=[]),H.push(...S)}has(P){return this._map.has(P)}clear(){this._map.clear()}}const Xa=new RegExp(":enter","g"),Ol=new RegExp(":leave","g");function nl(G,P,S,H,me,Ne={},Qe={},pt,Qt,mn=[]){return(new Pa).buildKeyframes(G,P,S,H,me,Ne,Qe,pt,Qt,mn)}class Pa{buildKeyframes(P,S,H,me,Ne,Qe,pt,Qt,mn,Ri=[]){mn=mn||new Fa;const ar=new Ba(P,S,mn,me,Ne,Ri,[]);ar.options=Qt,ar.currentTimeline.setStyles([Qe],null,ar.errors,Qt),No(this,H,ar);const Pr=ar.timelines.filter(oo=>oo.containsAnimation());if(Object.keys(pt).length){let oo;for(let kr=Pr.length-1;kr>=0;kr--){const Or=Pr[kr];if(Or.element===S){oo=Or;break}}oo&&!oo.allowOnlyTimelineStyles()&&oo.setStyles([pt],null,ar.errors,Qt)}return Pr.length?Pr.map(oo=>oo.buildKeyframes()):[io(S,[],[],[],0,0,"",!1)]}visitTrigger(P,S){}visitState(P,S){}visitTransition(P,S){}visitAnimateChild(P,S){const H=S.subInstructions.get(S.element);if(H){const me=S.createSubContext(P.options),Ne=S.currentTimeline.currentTime,Qe=this._visitSubInstructions(H,me,me.options);Ne!=Qe&&S.transformIntoNewTimeline(Qe)}S.previousNode=P}visitAnimateRef(P,S){const H=S.createSubContext(P.options);H.transformIntoNewTimeline(),this.visitReference(P.animation,H),S.transformIntoNewTimeline(H.currentTimeline.currentTime),S.previousNode=P}_visitSubInstructions(P,S,H){let Ne=S.currentTimeline.currentTime;const Qe=null!=H.duration?be(H.duration):null,pt=null!=H.delay?be(H.delay):null;return 0!==Qe&&P.forEach(Qt=>{const mn=S.appendInstructionToTimeline(Qt,Qe,pt);Ne=Math.max(Ne,mn.duration+mn.delay)}),Ne}visitReference(P,S){S.updateOptions(P.options,!0),No(this,P.animation,S),S.previousNode=P}visitSequence(P,S){const H=S.subContextCount;let me=S;const Ne=P.options;if(Ne&&(Ne.params||Ne.delay)&&(me=S.createSubContext(Ne),me.transformIntoNewTimeline(),null!=Ne.delay)){6==me.previousNode.type&&(me.currentTimeline.snapshotCurrentStyles(),me.previousNode=Ps);const Qe=be(Ne.delay);me.delayNextStep(Qe)}P.steps.length&&(P.steps.forEach(Qe=>No(this,Qe,me)),me.currentTimeline.applyStylesToKeyframe(),me.subContextCount>H&&me.transformIntoNewTimeline()),S.previousNode=P}visitGroup(P,S){const H=[];let me=S.currentTimeline.currentTime;const Ne=P.options&&P.options.delay?be(P.options.delay):0;P.steps.forEach(Qe=>{const pt=S.createSubContext(P.options);Ne&&pt.delayNextStep(Ne),No(this,Qe,pt),me=Math.max(me,pt.currentTimeline.currentTime),H.push(pt.currentTimeline)}),H.forEach(Qe=>S.currentTimeline.mergeTimelineCollectedStyles(Qe)),S.transformIntoNewTimeline(me),S.previousNode=P}_visitTiming(P,S){if(P.dynamic){const H=P.strValue;return Ye(S.params?Re(H,S.params,S.errors):H,S.errors)}return{duration:P.duration,delay:P.delay,easing:P.easing}}visitAnimate(P,S){const H=S.currentAnimateTimings=this._visitTiming(P.timings,S),me=S.currentTimeline;H.delay&&(S.incrementTime(H.delay),me.snapshotCurrentStyles());const Ne=P.style;5==Ne.type?this.visitKeyframes(Ne,S):(S.incrementTime(H.duration),this.visitStyle(Ne,S),me.applyStylesToKeyframe()),S.currentAnimateTimings=null,S.previousNode=P}visitStyle(P,S){const H=S.currentTimeline,me=S.currentAnimateTimings;!me&&H.getCurrentStyleProperties().length&&H.forwardFrame();const Ne=me&&me.easing||P.easing;P.isEmptyStep?H.applyEmptyStep(Ne):H.setStyles(P.styles,Ne,S.errors,S.options),S.previousNode=P}visitKeyframes(P,S){const H=S.currentAnimateTimings,me=S.currentTimeline.duration,Ne=H.duration,pt=S.createSubContext().currentTimeline;pt.easing=H.easing,P.styles.forEach(Qt=>{pt.forwardTime((Qt.offset||0)*Ne),pt.setStyles(Qt.styles,Qt.easing,S.errors,S.options),pt.applyStylesToKeyframe()}),S.currentTimeline.mergeTimelineCollectedStyles(pt),S.transformIntoNewTimeline(me+Ne),S.previousNode=P}visitQuery(P,S){const H=S.currentTimeline.currentTime,me=P.options||{},Ne=me.delay?be(me.delay):0;Ne&&(6===S.previousNode.type||0==H&&S.currentTimeline.getCurrentStyleProperties().length)&&(S.currentTimeline.snapshotCurrentStyles(),S.previousNode=Ps);let Qe=H;const pt=S.invokeQuery(P.selector,P.originalSelector,P.limit,P.includeSelf,!!me.optional,S.errors);S.currentQueryTotal=pt.length;let Qt=null;pt.forEach((mn,Ri)=>{S.currentQueryIndex=Ri;const ar=S.createSubContext(P.options,mn);Ne&&ar.delayNextStep(Ne),mn===S.element&&(Qt=ar.currentTimeline),No(this,P.animation,ar),ar.currentTimeline.applyStylesToKeyframe(),Qe=Math.max(Qe,ar.currentTimeline.currentTime)}),S.currentQueryIndex=0,S.currentQueryTotal=0,S.transformIntoNewTimeline(Qe),Qt&&(S.currentTimeline.mergeTimelineCollectedStyles(Qt),S.currentTimeline.snapshotCurrentStyles()),S.previousNode=P}visitStagger(P,S){const H=S.parentContext,me=S.currentTimeline,Ne=P.timings,Qe=Math.abs(Ne.duration),pt=Qe*(S.currentQueryTotal-1);let Qt=Qe*S.currentQueryIndex;switch(Ne.duration<0?"reverse":Ne.easing){case"reverse":Qt=pt-Qt;break;case"full":Qt=H.currentStaggerTime}const Ri=S.currentTimeline;Qt&&Ri.delayNextStep(Qt);const ar=Ri.currentTime;No(this,P.animation,S),S.previousNode=P,H.currentStaggerTime=me.currentTime-ar+(me.startTime-H.currentTimeline.startTime)}}const Ps={};class Ba{constructor(P,S,H,me,Ne,Qe,pt,Qt){this._driver=P,this.element=S,this.subInstructions=H,this._enterClassName=me,this._leaveClassName=Ne,this.errors=Qe,this.timelines=pt,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Ps,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=Qt||new ws(this._driver,S,0),pt.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(P,S){if(!P)return;const H=P;let me=this.options;null!=H.duration&&(me.duration=be(H.duration)),null!=H.delay&&(me.delay=be(H.delay));const Ne=H.params;if(Ne){let Qe=me.params;Qe||(Qe=this.options.params={}),Object.keys(Ne).forEach(pt=>{(!S||!Qe.hasOwnProperty(pt))&&(Qe[pt]=Re(Ne[pt],Qe,this.errors))})}}_copyOptions(){const P={};if(this.options){const S=this.options.params;if(S){const H=P.params={};Object.keys(S).forEach(me=>{H[me]=S[me]})}}return P}createSubContext(P=null,S,H){const me=S||this.element,Ne=new Ba(this._driver,me,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(me,H||0));return Ne.previousNode=this.previousNode,Ne.currentAnimateTimings=this.currentAnimateTimings,Ne.options=this._copyOptions(),Ne.updateOptions(P),Ne.currentQueryIndex=this.currentQueryIndex,Ne.currentQueryTotal=this.currentQueryTotal,Ne.parentContext=this,this.subContextCount++,Ne}transformIntoNewTimeline(P){return this.previousNode=Ps,this.currentTimeline=this.currentTimeline.fork(this.element,P),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(P,S,H){const me={duration:null!=S?S:P.duration,delay:this.currentTimeline.currentTime+(null!=H?H:0)+P.delay,easing:""},Ne=new ts(this._driver,P.element,P.keyframes,P.preStyleProps,P.postStyleProps,me,P.stretchStartingKeyframe);return this.timelines.push(Ne),me}incrementTime(P){this.currentTimeline.forwardTime(this.currentTimeline.duration+P)}delayNextStep(P){P>0&&this.currentTimeline.delayNextStep(P)}invokeQuery(P,S,H,me,Ne,Qe){let pt=[];if(me&&pt.push(this.element),P.length>0){P=(P=P.replace(Xa,"."+this._enterClassName)).replace(Ol,"."+this._leaveClassName);let mn=this._driver.query(this.element,P,1!=H);0!==H&&(mn=H<0?mn.slice(mn.length+H,mn.length):mn.slice(0,H)),pt.push(...mn)}return!Ne&&0==pt.length&&Qe.push(function ca(G){return new N.vHH(3014,ti)}()),pt}}class ws{constructor(P,S,H,me){this._driver=P,this.element=S,this.startTime=H,this._elementTimelineStylesLookup=me,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(S),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(S,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(P){const S=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||S?(this.forwardTime(this.currentTime+P),S&&this.snapshotCurrentStyles()):this.startTime+=P}fork(P,S){return this.applyStylesToKeyframe(),new ws(this._driver,P,S||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(P){this.applyStylesToKeyframe(),this.duration=P,this._loadKeyframe()}_updateStyle(P,S){this._localTimelineStyles[P]=S,this._globalTimelineStyles[P]=S,this._styleSummary[P]={time:this.currentTime,value:S}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(P){P&&(this._previousKeyframe.easing=P),Object.keys(this._globalTimelineStyles).forEach(S=>{this._backFill[S]=this._globalTimelineStyles[S]||nt,this._currentKeyframe[S]=nt}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(P,S,H,me){S&&(this._previousKeyframe.easing=S);const Ne=me&&me.params||{},Qe=function fa(G,P){const S={};let H;return G.forEach(me=>{"*"===me?(H=H||Object.keys(P),H.forEach(Ne=>{S[Ne]=nt})):wn(me,!1,S)}),S}(P,this._globalTimelineStyles);Object.keys(Qe).forEach(pt=>{const Qt=Re(Qe[pt],Ne,H);this._pendingStyles[pt]=Qt,this._localTimelineStyles.hasOwnProperty(pt)||(this._backFill[pt]=this._globalTimelineStyles.hasOwnProperty(pt)?this._globalTimelineStyles[pt]:nt),this._updateStyle(pt,Qt)})}applyStylesToKeyframe(){const P=this._pendingStyles,S=Object.keys(P);0!=S.length&&(this._pendingStyles={},S.forEach(H=>{this._currentKeyframe[H]=P[H]}),Object.keys(this._localTimelineStyles).forEach(H=>{this._currentKeyframe.hasOwnProperty(H)||(this._currentKeyframe[H]=this._localTimelineStyles[H])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(P=>{const S=this._localTimelineStyles[P];this._pendingStyles[P]=S,this._updateStyle(P,S)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const P=[];for(let S in this._currentKeyframe)P.push(S);return P}mergeTimelineCollectedStyles(P){Object.keys(P._styleSummary).forEach(S=>{const H=this._styleSummary[S],me=P._styleSummary[S];(!H||me.time>H.time)&&this._updateStyle(S,me.value)})}buildKeyframes(){this.applyStylesToKeyframe();const P=new Set,S=new Set,H=1===this._keyframes.size&&0===this.duration;let me=[];this._keyframes.forEach((pt,Qt)=>{const mn=wn(pt,!0);Object.keys(mn).forEach(Ri=>{const ar=mn[Ri];"!"==ar?P.add(Ri):ar==nt&&S.add(Ri)}),H||(mn.offset=Qt/this.duration),me.push(mn)});const Ne=P.size?gn(P.values()):[],Qe=S.size?gn(S.values()):[];if(H){const pt=me[0],Qt=On(pt);pt.offset=0,Qt.offset=1,me=[pt,Qt]}return io(this.element,me,Ne,Qe,this.duration,this.startTime,this.easing,!1)}}class ts extends ws{constructor(P,S,H,me,Ne,Qe,pt=!1){super(P,S,Qe.delay),this.keyframes=H,this.preStyleProps=me,this.postStyleProps=Ne,this._stretchStartingKeyframe=pt,this.timings={duration:Qe.duration,delay:Qe.delay,easing:Qe.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let P=this.keyframes,{delay:S,duration:H,easing:me}=this.timings;if(this._stretchStartingKeyframe&&S){const Ne=[],Qe=H+S,pt=S/Qe,Qt=wn(P[0],!1);Qt.offset=0,Ne.push(Qt);const mn=wn(P[0],!1);mn.offset=bo(pt),Ne.push(mn);const Ri=P.length-1;for(let ar=1;ar<=Ri;ar++){let Pr=wn(P[ar],!1);Pr.offset=bo((S+Pr.offset*H)/Qe),Ne.push(Pr)}H=Qe,S=0,me="",P=Ne}return io(this.element,P,this.preStyleProps,this.postStyleProps,H,S,me,!0)}}function bo(G,P=3){const S=Math.pow(10,P-1);return Math.round(G*S)/S}class Cr{}class Rl extends Cr{normalizePropertyName(P,S){return vi(P)}normalizeStyleValue(P,S,H,me){let Ne="";const Qe=H.toString().trim();if(Za[S]&&0!==H&&"0"!==H)if("number"==typeof H)Ne="px";else{const pt=H.match(/^[+-]?[\d\.]+([a-z]*)$/);pt&&0==pt[1].length&&me.push(function Gi(G,P){return new N.vHH(3005,ti)}())}return Qe+Ne}}const Za=(()=>function Ue(G){const P={};return G.forEach(S=>P[S]=!0),P}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function gt(G,P,S,H,me,Ne,Qe,pt,Qt,mn,Ri,ar,Pr){return{type:0,element:G,triggerName:P,isRemovalTransition:me,fromState:S,fromStyles:Ne,toState:H,toStyles:Qe,timelines:pt,queriedElements:Qt,preStyleProps:mn,postStyleProps:Ri,totalTime:ar,errors:Pr}}const Ut={};class vn{constructor(P,S,H){this._triggerName=P,this.ast=S,this._stateStyles=H}match(P,S,H,me){return function Wt(G,P,S,H,me){return G.some(Ne=>Ne(P,S,H,me))}(this.ast.matchers,P,S,H,me)}buildStyles(P,S,H){const me=this._stateStyles["*"],Ne=this._stateStyles[P],Qe=me?me.buildStyles(S,H):{};return Ne?Ne.buildStyles(S,H):Qe}build(P,S,H,me,Ne,Qe,pt,Qt,mn,Ri){const ar=[],Pr=this.ast.options&&this.ast.options.params||Ut,kr=this.buildStyles(H,pt&&pt.params||Ut,ar),Or=Qt&&Qt.params||Ut,_r=this.buildStyles(me,Or,ar),Lo=new Set,qo=new Map,ia=new Map,Ja="void"===me,Yc={params:Object.assign(Object.assign({},Pr),Or)},Hl=Ri?[]:nl(P,S,this.ast.animation,Ne,Qe,kr,_r,Yc,mn,ar);let Sl=0;if(Hl.forEach(Bl=>{Sl=Math.max(Bl.duration+Bl.delay,Sl)}),ar.length)return gt(S,this._triggerName,H,me,Ja,kr,_r,[],[],qo,ia,Sl,ar);Hl.forEach(Bl=>{const nc=Bl.element,bh=Oo(qo,nc,{});Bl.preStyleProps.forEach(Pc=>bh[Pc]=!0);const du=Oo(ia,nc,{});Bl.postStyleProps.forEach(Pc=>du[Pc]=!0),nc!==S&&Lo.add(nc)});const Fl=gn(Lo.values());return gt(S,this._triggerName,H,me,Ja,kr,_r,Hl,Fl,qo,ia,Sl)}}class Bn{constructor(P,S,H){this.styles=P,this.defaultParams=S,this.normalizer=H}buildStyles(P,S){const H={},me=On(this.defaultParams);return Object.keys(P).forEach(Ne=>{const Qe=P[Ne];null!=Qe&&(me[Ne]=Qe)}),this.styles.styles.forEach(Ne=>{if("string"!=typeof Ne){const Qe=Ne;Object.keys(Qe).forEach(pt=>{let Qt=Qe[pt];Qt.length>1&&(Qt=Re(Qt,me,S));const mn=this.normalizer.normalizePropertyName(pt,S);Qt=this.normalizer.normalizeStyleValue(pt,mn,Qt,S),H[mn]=Qt})}}),H}}class ai{constructor(P,S,H){this.name=P,this.ast=S,this._normalizer=H,this.transitionFactories=[],this.states={},S.states.forEach(me=>{this.states[me.name]=new Bn(me.style,me.options&&me.options.params||{},H)}),pr(this.states,"true","1"),pr(this.states,"false","0"),S.transitions.forEach(me=>{this.transitionFactories.push(new vn(P,me,this.states))}),this.fallbackTransition=function Ii(G,P,S){return new vn(G,{type:1,animation:{type:2,steps:[],options:null},matchers:[(Qe,pt)=>!0],options:null,queryCount:0,depCount:0},P)}(P,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(P,S,H,me){return this.transitionFactories.find(Qe=>Qe.match(P,S,H,me))||null}matchStyles(P,S,H){return this.fallbackTransition.buildStyles(P,S,H)}}function pr(G,P,S){G.hasOwnProperty(P)?G.hasOwnProperty(S)||(G[S]=G[P]):G.hasOwnProperty(S)&&(G[P]=G[S])}const Ni=new Fa;class cr{constructor(P,S,H){this.bodyNode=P,this._driver=S,this._normalizer=H,this._animations={},this._playersById={},this.players=[]}register(P,S){const H=[],Ne=ba(this._driver,S,H,[]);if(H.length)throw function Vo(G){return new N.vHH(3503,ti)}();this._animations[P]=Ne}_buildPlayer(P,S,H){const me=P.element,Ne=Da(0,this._normalizer,0,P.keyframes,S,H);return this._driver.animate(me,Ne,P.duration,P.delay,P.easing,[],!0)}create(P,S,H={}){const me=[],Ne=this._animations[P];let Qe;const pt=new Map;if(Ne?(Qe=nl(this._driver,S,Ne,Ee,Ae,{},{},H,Ni,me),Qe.forEach(Ri=>{const ar=Oo(pt,Ri.element,{});Ri.postStyleProps.forEach(Pr=>ar[Pr]=null)})):(me.push(function ya(){return new N.vHH(3300,ti)}()),Qe=[]),me.length)throw function hs(G){return new N.vHH(3504,ti)}();pt.forEach((Ri,ar)=>{Object.keys(Ri).forEach(Pr=>{Ri[Pr]=this._driver.computeStyle(ar,Pr,nt)})});const mn=da(Qe.map(Ri=>{const ar=pt.get(Ri.element);return this._buildPlayer(Ri,{},ar)}));return this._playersById[P]=mn,mn.onDestroy(()=>this.destroy(P)),this.players.push(mn),mn}destroy(P){const S=this._getPlayer(P);S.destroy(),delete this._playersById[P];const H=this.players.indexOf(S);H>=0&&this.players.splice(H,1)}_getPlayer(P){const S=this._playersById[P];if(!S)throw function lo(G){return new N.vHH(3301,ti)}();return S}listen(P,S,H,me){const Ne=qs(S,"","","");return Us(this._getPlayer(P),H,Ne,me),()=>{}}command(P,S,H,me){if("register"==H)return void this.register(P,me[0]);if("create"==H)return void this.create(P,S,me[0]||{});const Ne=this._getPlayer(P);switch(H){case"play":Ne.play();break;case"pause":Ne.pause();break;case"reset":Ne.reset();break;case"restart":Ne.restart();break;case"finish":Ne.finish();break;case"init":Ne.init();break;case"setPosition":Ne.setPosition(parseFloat(me[0]));break;case"destroy":this.destroy(P)}}}const yr="ng-animate-queued",J="ng-animate-disabled",Jn=[],xo={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Ts={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Hr="__ng_removed";class Os{constructor(P,S=""){this.namespaceId=S;const H=P&&P.hasOwnProperty("value");if(this.value=function x(G){return null!=G?G:null}(H?P.value:P),H){const Ne=On(P);delete Ne.value,this.options=Ne}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(P){const S=P.params;if(S){const H=this.options.params;Object.keys(S).forEach(me=>{null==H[me]&&(H[me]=S[me])})}}}const il="void",rl=new Os(il);class Ta{constructor(P,S,H){this.id=P,this.hostElement=S,this._engine=H,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+P,Ze(S,this._hostClassName)}listen(P,S,H,me){if(!this._triggers.hasOwnProperty(S))throw function Qs(G,P){return new N.vHH(3302,ti)}();if(null==H||0==H.length)throw function va(G){return new N.vHH(3303,ti)}();if(!function U(G){return"start"==G||"done"==G}(H))throw function ua(G,P){return new N.vHH(3400,ti)}();const Ne=Oo(this._elementListeners,P,[]),Qe={name:S,phase:H,callback:me};Ne.push(Qe);const pt=Oo(this._engine.statesByElement,P,{});return pt.hasOwnProperty(S)||(Ze(P,Le),Ze(P,Le+"-"+S),pt[S]=rl),()=>{this._engine.afterFlush(()=>{const Qt=Ne.indexOf(Qe);Qt>=0&&Ne.splice(Qt,1),this._triggers[S]||delete pt[S]})}}register(P,S){return!this._triggers[P]&&(this._triggers[P]=S,!0)}_getTrigger(P){const S=this._triggers[P];if(!S)throw function $o(G){return new N.vHH(3401,ti)}();return S}trigger(P,S,H,me=!0){const Ne=this._getTrigger(S),Qe=new v(this.id,S,P);let pt=this._engine.statesByElement.get(P);pt||(Ze(P,Le),Ze(P,Le+"-"+S),this._engine.statesByElement.set(P,pt={}));let Qt=pt[S];const mn=new Os(H,this.id);if(!(H&&H.hasOwnProperty("value"))&&Qt&&mn.absorbOptions(Qt.options),pt[S]=mn,Qt||(Qt=rl),mn.value!==il&&Qt.value===mn.value){if(!function ro(G,P){const S=Object.keys(G),H=Object.keys(P);if(S.length!=H.length)return!1;for(let me=0;me<S.length;me++){const Ne=S[me];if(!P.hasOwnProperty(Ne)||G[Ne]!==P[Ne])return!1}return!0}(Qt.params,mn.params)){const Or=[],_r=Ne.matchStyles(Qt.value,Qt.params,Or),Lo=Ne.matchStyles(mn.value,mn.params,Or);Or.length?this._engine.reportError(Or):this._engine.afterFlush(()=>{Zi(P,_r),Lr(P,Lo)})}return}const Pr=Oo(this._engine.playersByElement,P,[]);Pr.forEach(Or=>{Or.namespaceId==this.id&&Or.triggerName==S&&Or.queued&&Or.destroy()});let oo=Ne.matchTransition(Qt.value,mn.value,P,mn.params),kr=!1;if(!oo){if(!me)return;oo=Ne.fallbackTransition,kr=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:P,triggerName:S,transition:oo,fromState:Qt,toState:mn,player:Qe,isFallbackTransition:kr}),kr||(Ze(P,yr),Qe.onStart(()=>{zt(P,yr)})),Qe.onDone(()=>{let Or=this.players.indexOf(Qe);Or>=0&&this.players.splice(Or,1);const _r=this._engine.playersByElement.get(P);if(_r){let Lo=_r.indexOf(Qe);Lo>=0&&_r.splice(Lo,1)}}),this.players.push(Qe),Pr.push(Qe),Qe}deregister(P){delete this._triggers[P],this._engine.statesByElement.forEach((S,H)=>{delete S[P]}),this._elementListeners.forEach((S,H)=>{this._elementListeners.set(H,S.filter(me=>me.name!=P))})}clearElementCache(P){this._engine.statesByElement.delete(P),this._elementListeners.delete(P);const S=this._engine.playersByElement.get(P);S&&(S.forEach(H=>H.destroy()),this._engine.playersByElement.delete(P))}_signalRemovalForInnerTriggers(P,S){const H=this._engine.driver.query(P,Y,!0);H.forEach(me=>{if(me[Hr])return;const Ne=this._engine.fetchNamespacesByElement(me);Ne.size?Ne.forEach(Qe=>Qe.triggerLeaveAnimation(me,S,!1,!0)):this.clearElementCache(me)}),this._engine.afterFlushAnimationsDone(()=>H.forEach(me=>this.clearElementCache(me)))}triggerLeaveAnimation(P,S,H,me){const Ne=this._engine.statesByElement.get(P),Qe=new Map;if(Ne){const pt=[];if(Object.keys(Ne).forEach(Qt=>{if(Qe.set(Qt,Ne[Qt].value),this._triggers[Qt]){const mn=this.trigger(P,Qt,il,me);mn&&pt.push(mn)}}),pt.length)return this._engine.markElementAsRemoved(this.id,P,!0,S,Qe),H&&da(pt).onDone(()=>this._engine.processLeaveNode(P)),!0}return!1}prepareLeaveAnimationListeners(P){const S=this._elementListeners.get(P),H=this._engine.statesByElement.get(P);if(S&&H){const me=new Set;S.forEach(Ne=>{const Qe=Ne.name;if(me.has(Qe))return;me.add(Qe);const Qt=this._triggers[Qe].fallbackTransition,mn=H[Qe]||rl,Ri=new Os(il),ar=new v(this.id,Qe,P);this._engine.totalQueuedPlayers++,this._queue.push({element:P,triggerName:Qe,transition:Qt,fromState:mn,toState:Ri,player:ar,isFallbackTransition:!0})})}}removeNode(P,S){const H=this._engine;if(P.childElementCount&&this._signalRemovalForInnerTriggers(P,S),this.triggerLeaveAnimation(P,S,!0))return;let me=!1;if(H.totalAnimations){const Ne=H.players.length?H.playersByQueriedElement.get(P):[];if(Ne&&Ne.length)me=!0;else{let Qe=P;for(;Qe=Qe.parentNode;)if(H.statesByElement.get(Qe)){me=!0;break}}}if(this.prepareLeaveAnimationListeners(P),me)H.markElementAsRemoved(this.id,P,!1,S);else{const Ne=P[Hr];(!Ne||Ne===xo)&&(H.afterFlush(()=>this.clearElementCache(P)),H.destroyInnerAnimations(P),H._onRemovalComplete(P,S))}}insertNode(P,S){Ze(P,this._hostClassName)}drainQueuedTransitions(P){const S=[];return this._queue.forEach(H=>{const me=H.player;if(me.destroyed)return;const Ne=H.element,Qe=this._elementListeners.get(Ne);Qe&&Qe.forEach(pt=>{if(pt.name==H.triggerName){const Qt=qs(Ne,H.triggerName,H.fromState.value,H.toState.value);Qt._data=P,Us(H.player,pt.phase,Qt,pt.callback)}}),me.markedForDestroy?this._engine.afterFlush(()=>{me.destroy()}):S.push(H)}),this._queue=[],S.sort((H,me)=>{const Ne=H.transition.ast.depCount,Qe=me.transition.ast.depCount;return 0==Ne||0==Qe?Ne-Qe:this._engine.driver.containsElement(H.element,me.element)?1:-1})}destroy(P){this.players.forEach(S=>S.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,P)}elementContainsData(P){let S=!1;return this._elementListeners.has(P)&&(S=!0),S=!!this._queue.find(H=>H.element===P)||S,S}}class c{constructor(P,S,H){this.bodyNode=P,this.driver=S,this._normalizer=H,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(me,Ne)=>{}}_onRemovalComplete(P,S){this.onRemovalComplete(P,S)}get queuedPlayers(){const P=[];return this._namespaceList.forEach(S=>{S.players.forEach(H=>{H.queued&&P.push(H)})}),P}createNamespace(P,S){const H=new Ta(P,S,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,S)?this._balanceNamespaceList(H,S):(this.newHostElements.set(S,H),this.collectEnterElement(S)),this._namespaceLookup[P]=H}_balanceNamespaceList(P,S){const H=this._namespaceList,me=this.namespacesByHostElement,Ne=H.length-1;if(Ne>=0){let Qe=!1;if(void 0!==this.driver.getParentElement){let pt=this.driver.getParentElement(S);for(;pt;){const Qt=me.get(pt);if(Qt){const mn=H.indexOf(Qt);H.splice(mn+1,0,P),Qe=!0;break}pt=this.driver.getParentElement(pt)}}else for(let pt=Ne;pt>=0;pt--)if(this.driver.containsElement(H[pt].hostElement,S)){H.splice(pt+1,0,P),Qe=!0;break}Qe||H.unshift(P)}else H.push(P);return me.set(S,P),P}register(P,S){let H=this._namespaceLookup[P];return H||(H=this.createNamespace(P,S)),H}registerTrigger(P,S,H){let me=this._namespaceLookup[P];me&&me.register(S,H)&&this.totalAnimations++}destroy(P,S){if(!P)return;const H=this._fetchNamespace(P);this.afterFlush(()=>{this.namespacesByHostElement.delete(H.hostElement),delete this._namespaceLookup[P];const me=this._namespaceList.indexOf(H);me>=0&&this._namespaceList.splice(me,1)}),this.afterFlushAnimationsDone(()=>H.destroy(S))}_fetchNamespace(P){return this._namespaceLookup[P]}fetchNamespacesByElement(P){const S=new Set,H=this.statesByElement.get(P);if(H){const me=Object.keys(H);for(let Ne=0;Ne<me.length;Ne++){const Qe=H[me[Ne]].namespaceId;if(Qe){const pt=this._fetchNamespace(Qe);pt&&S.add(pt)}}}return S}trigger(P,S,H,me){if(C(S)){const Ne=this._fetchNamespace(P);if(Ne)return Ne.trigger(S,H,me),!0}return!1}insertNode(P,S,H,me){if(!C(S))return;const Ne=S[Hr];if(Ne&&Ne.setForRemoval){Ne.setForRemoval=!1,Ne.setForMove=!0;const Qe=this.collectedLeaveElements.indexOf(S);Qe>=0&&this.collectedLeaveElements.splice(Qe,1)}if(P){const Qe=this._fetchNamespace(P);Qe&&Qe.insertNode(S,H)}me&&this.collectEnterElement(S)}collectEnterElement(P){this.collectedEnterElements.push(P)}markElementAsDisabled(P,S){S?this.disabledNodes.has(P)||(this.disabledNodes.add(P),Ze(P,J)):this.disabledNodes.has(P)&&(this.disabledNodes.delete(P),zt(P,J))}removeNode(P,S,H,me){if(C(S)){const Ne=P?this._fetchNamespace(P):null;if(Ne?Ne.removeNode(S,me):this.markElementAsRemoved(P,S,!1,me),H){const Qe=this.namespacesByHostElement.get(S);Qe&&Qe.id!==P&&Qe.removeNode(S,me)}}else this._onRemovalComplete(S,me)}markElementAsRemoved(P,S,H,me,Ne){this.collectedLeaveElements.push(S),S[Hr]={namespaceId:P,setForRemoval:me,hasAnimation:H,removedBeforeQueried:!1,previousTriggersValues:Ne}}listen(P,S,H,me,Ne){return C(S)?this._fetchNamespace(P).listen(S,H,me,Ne):()=>{}}_buildInstruction(P,S,H,me,Ne){return P.transition.build(this.driver,P.element,P.fromState.value,P.toState.value,H,me,P.fromState.options,P.toState.options,S,Ne)}destroyInnerAnimations(P){let S=this.driver.query(P,Y,!0);S.forEach(H=>this.destroyActiveAnimationsForElement(H)),0!=this.playersByQueriedElement.size&&(S=this.driver.query(P,ee,!0),S.forEach(H=>this.finishActiveQueriedAnimationOnElement(H)))}destroyActiveAnimationsForElement(P){const S=this.playersByElement.get(P);S&&S.forEach(H=>{H.queued?H.markedForDestroy=!0:H.destroy()})}finishActiveQueriedAnimationOnElement(P){const S=this.playersByQueriedElement.get(P);S&&S.forEach(H=>H.finish())}whenRenderingDone(){return new Promise(P=>{if(this.players.length)return da(this.players).onDone(()=>P());P()})}processLeaveNode(P){var S;const H=P[Hr];if(H&&H.setForRemoval){if(P[Hr]=xo,H.namespaceId){this.destroyInnerAnimations(P);const me=this._fetchNamespace(H.namespaceId);me&&me.clearElementCache(P)}this._onRemovalComplete(P,H.setForRemoval)}(null===(S=P.classList)||void 0===S?void 0:S.contains(J))&&this.markElementAsDisabled(P,!1),this.driver.query(P,".ng-animate-disabled",!0).forEach(me=>{this.markElementAsDisabled(me,!1)})}flush(P=-1){let S=[];if(this.newHostElements.size&&(this.newHostElements.forEach((H,me)=>this._balanceNamespaceList(H,me)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let H=0;H<this.collectedEnterElements.length;H++)Ze(this.collectedEnterElements[H],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const H=[];try{S=this._flushAnimations(H,P)}finally{for(let me=0;me<H.length;me++)H[me]()}}else for(let H=0;H<this.collectedLeaveElements.length;H++)this.processLeaveNode(this.collectedLeaveElements[H]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(H=>H()),this._flushFns=[],this._whenQuietFns.length){const H=this._whenQuietFns;this._whenQuietFns=[],S.length?da(S).onDone(()=>{H.forEach(me=>me())}):H.forEach(me=>me())}}reportError(P){throw function ha(G){return new N.vHH(3402,ti)}()}_flushAnimations(P,S){const H=new Fa,me=[],Ne=new Map,Qe=[],pt=new Map,Qt=new Map,mn=new Map,Ri=new Set;this.disabledNodes.forEach(rr=>{Ri.add(rr);const Rr=this.driver.query(rr,".ng-animate-queued",!0);for(let Sr=0;Sr<Rr.length;Sr++)Ri.add(Rr[Sr])});const ar=this.bodyNode,Pr=Array.from(this.statesByElement.keys()),oo=Pe(Pr,this.collectedEnterElements),kr=new Map;let Or=0;oo.forEach((rr,Rr)=>{const Sr=Ee+Or++;kr.set(Rr,Sr),rr.forEach(wo=>Ze(wo,Sr))});const _r=[],Lo=new Set,qo=new Set;for(let rr=0;rr<this.collectedLeaveElements.length;rr++){const Rr=this.collectedLeaveElements[rr],Sr=Rr[Hr];Sr&&Sr.setForRemoval&&(_r.push(Rr),Lo.add(Rr),Sr.hasAnimation?this.driver.query(Rr,".ng-star-inserted",!0).forEach(wo=>Lo.add(wo)):qo.add(Rr))}const ia=new Map,Ja=Pe(Pr,Array.from(Lo));Ja.forEach((rr,Rr)=>{const Sr=Ae+Or++;ia.set(Rr,Sr),rr.forEach(wo=>Ze(wo,Sr))}),P.push(()=>{oo.forEach((rr,Rr)=>{const Sr=kr.get(Rr);rr.forEach(wo=>zt(wo,Sr))}),Ja.forEach((rr,Rr)=>{const Sr=ia.get(Rr);rr.forEach(wo=>zt(wo,Sr))}),_r.forEach(rr=>{this.processLeaveNode(rr)})});const Yc=[],Hl=[];for(let rr=this._namespaceList.length-1;rr>=0;rr--)this._namespaceList[rr].drainQueuedTransitions(S).forEach(Sr=>{const wo=Sr.player,Ca=Sr.element;if(Yc.push(wo),this.collectedEnterElements.length){const al=Ca[Hr];if(al&&al.setForMove){if(al.previousTriggersValues&&al.previousTriggersValues.has(Sr.triggerName)){const xc=al.previousTriggersValues.get(Sr.triggerName),fu=this.statesByElement.get(Sr.element);fu&&fu[Sr.triggerName]&&(fu[Sr.triggerName].value=xc)}return void wo.destroy()}}const za=!ar||!this.driver.containsElement(ar,Ca),pl=ia.get(Ca),Oc=kr.get(Ca),ra=this._buildInstruction(Sr,H,Oc,pl,za);if(ra.errors&&ra.errors.length)return void Hl.push(ra);if(za)return wo.onStart(()=>Zi(Ca,ra.fromStyles)),wo.onDestroy(()=>Lr(Ca,ra.toStyles)),void me.push(wo);if(Sr.isFallbackTransition)return wo.onStart(()=>Zi(Ca,ra.fromStyles)),wo.onDestroy(()=>Lr(Ca,ra.toStyles)),void me.push(wo);const Rc=[];ra.timelines.forEach(al=>{al.stretchStartingKeyframe=!0,this.disabledNodes.has(al.element)||Rc.push(al)}),ra.timelines=Rc,H.append(Ca,ra.timelines),Qe.push({instruction:ra,player:wo,element:Ca}),ra.queriedElements.forEach(al=>Oo(pt,al,[]).push(wo)),ra.preStyleProps.forEach((al,xc)=>{const fu=Object.keys(al);if(fu.length){let Ru=Qt.get(xc);Ru||Qt.set(xc,Ru=new Set),fu.forEach(xh=>Ru.add(xh))}}),ra.postStyleProps.forEach((al,xc)=>{const fu=Object.keys(al);let Ru=mn.get(xc);Ru||mn.set(xc,Ru=new Set),fu.forEach(xh=>Ru.add(xh))})});if(Hl.length){const rr=[];Hl.forEach(Rr=>{rr.push(function Qi(G,P){return new N.vHH(3505,ti)}())}),Yc.forEach(Rr=>Rr.destroy()),this.reportError(rr)}const Sl=new Map,Fl=new Map;Qe.forEach(rr=>{const Rr=rr.element;H.has(Rr)&&(Fl.set(Rr,Rr),this._beforeAnimationBuild(rr.player.namespaceId,rr.instruction,Sl))}),me.forEach(rr=>{const Rr=rr.element;this._getPreviousPlayers(Rr,!1,rr.namespaceId,rr.triggerName,null).forEach(wo=>{Oo(Sl,Rr,[]).push(wo),wo.destroy()})});const Bl=_r.filter(rr=>co(rr,Qt,mn)),nc=new Map;ye(nc,this.driver,qo,mn,nt).forEach(rr=>{co(rr,Qt,mn)&&Bl.push(rr)});const du=new Map;oo.forEach((rr,Rr)=>{ye(du,this.driver,new Set(rr),Qt,"!")}),Bl.forEach(rr=>{const Rr=nc.get(rr),Sr=du.get(rr);nc.set(rr,Object.assign(Object.assign({},Rr),Sr))});const Pc=[],nd=[],Kc={};Qe.forEach(rr=>{const{element:Rr,player:Sr,instruction:wo}=rr;if(H.has(Rr)){if(Ri.has(Rr))return Sr.onDestroy(()=>Lr(Rr,wo.toStyles)),Sr.disabled=!0,Sr.overrideTotalTime(wo.totalTime),void me.push(Sr);let Ca=Kc;if(Fl.size>1){let pl=Rr;const Oc=[];for(;pl=pl.parentNode;){const ra=Fl.get(pl);if(ra){Ca=ra;break}Oc.push(pl)}Oc.forEach(ra=>Fl.set(ra,Ca))}const za=this._buildAnimation(Sr.namespaceId,wo,Sl,Ne,du,nc);if(Sr.setRealPlayer(za),Ca===Kc)Pc.push(Sr);else{const pl=this.playersByElement.get(Ca);pl&&pl.length&&(Sr.parentPlayer=da(pl)),me.push(Sr)}}else Zi(Rr,wo.fromStyles),Sr.onDestroy(()=>Lr(Rr,wo.toStyles)),nd.push(Sr),Ri.has(Rr)&&me.push(Sr)}),nd.forEach(rr=>{const Rr=Ne.get(rr.element);if(Rr&&Rr.length){const Sr=da(Rr);rr.setRealPlayer(Sr)}}),me.forEach(rr=>{rr.parentPlayer?rr.syncPlayerEvents(rr.parentPlayer):rr.destroy()});for(let rr=0;rr<_r.length;rr++){const Rr=_r[rr],Sr=Rr[Hr];if(zt(Rr,Ae),Sr&&Sr.hasAnimation)continue;let wo=[];if(pt.size){let za=pt.get(Rr);za&&za.length&&wo.push(...za);let pl=this.driver.query(Rr,ee,!0);for(let Oc=0;Oc<pl.length;Oc++){let ra=pt.get(pl[Oc]);ra&&ra.length&&wo.push(...ra)}}const Ca=wo.filter(za=>!za.destroyed);Ca.length?qn(this,Rr,Ca):this.processLeaveNode(Rr)}return _r.length=0,Pc.forEach(rr=>{this.players.push(rr),rr.onDone(()=>{rr.destroy();const Rr=this.players.indexOf(rr);this.players.splice(Rr,1)}),rr.play()}),Pc}elementContainsData(P,S){let H=!1;const me=S[Hr];return me&&me.setForRemoval&&(H=!0),this.playersByElement.has(S)&&(H=!0),this.playersByQueriedElement.has(S)&&(H=!0),this.statesByElement.has(S)&&(H=!0),this._fetchNamespace(P).elementContainsData(S)||H}afterFlush(P){this._flushFns.push(P)}afterFlushAnimationsDone(P){this._whenQuietFns.push(P)}_getPreviousPlayers(P,S,H,me,Ne){let Qe=[];if(S){const pt=this.playersByQueriedElement.get(P);pt&&(Qe=pt)}else{const pt=this.playersByElement.get(P);if(pt){const Qt=!Ne||Ne==il;pt.forEach(mn=>{mn.queued||!Qt&&mn.triggerName!=me||Qe.push(mn)})}}return(H||me)&&(Qe=Qe.filter(pt=>!(H&&H!=pt.namespaceId||me&&me!=pt.triggerName))),Qe}_beforeAnimationBuild(P,S,H){const Ne=S.element,Qe=S.isRemovalTransition?void 0:P,pt=S.isRemovalTransition?void 0:S.triggerName;for(const Qt of S.timelines){const mn=Qt.element,Ri=mn!==Ne,ar=Oo(H,mn,[]);this._getPreviousPlayers(mn,Ri,Qe,pt,S.toState).forEach(oo=>{const kr=oo.getRealPlayer();kr.beforeDestroy&&kr.beforeDestroy(),oo.destroy(),ar.push(oo)})}Zi(Ne,S.fromStyles)}_buildAnimation(P,S,H,me,Ne,Qe){const pt=S.triggerName,Qt=S.element,mn=[],Ri=new Set,ar=new Set,Pr=S.timelines.map(kr=>{const Or=kr.element;Ri.add(Or);const _r=Or[Hr];if(_r&&_r.removedBeforeQueried)return new Gr(kr.duration,kr.delay);const Lo=Or!==Qt,qo=function Pi(G){const P=[];return Vi(G,P),P}((H.get(Or)||Jn).map(Sl=>Sl.getRealPlayer())).filter(Sl=>!!Sl.element&&Sl.element===Or),ia=Ne.get(Or),Ja=Qe.get(Or),Yc=Da(0,this._normalizer,0,kr.keyframes,ia,Ja),Hl=this._buildPlayer(kr,Yc,qo);if(kr.subTimeline&&me&&ar.add(Or),Lo){const Sl=new v(P,pt,Or);Sl.setRealPlayer(Hl),mn.push(Sl)}return Hl});mn.forEach(kr=>{Oo(this.playersByQueriedElement,kr.element,[]).push(kr),kr.onDone(()=>function g(G,P,S){let H;if(G instanceof Map){if(H=G.get(P),H){if(H.length){const me=H.indexOf(S);H.splice(me,1)}0==H.length&&G.delete(P)}}else if(H=G[P],H){if(H.length){const me=H.indexOf(S);H.splice(me,1)}0==H.length&&delete G[P]}return H}(this.playersByQueriedElement,kr.element,kr))}),Ri.forEach(kr=>Ze(kr,le));const oo=da(Pr);return oo.onDestroy(()=>{Ri.forEach(kr=>zt(kr,le)),Lr(Qt,S.toStyles)}),ar.forEach(kr=>{Oo(me,kr,[]).push(oo)}),oo}_buildPlayer(P,S,H){return S.length>0?this.driver.animate(P.element,S,P.duration,P.delay,P.easing,H):new Gr(P.duration,P.delay)}}class v{constructor(P,S,H){this.namespaceId=P,this.triggerName=S,this.element=H,this._player=new Gr,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(P){this._containsRealPlayer||(this._player=P,Object.keys(this._queuedCallbacks).forEach(S=>{this._queuedCallbacks[S].forEach(H=>Us(P,S,void 0,H))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(P.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(P){this.totalTime=P}syncPlayerEvents(P){const S=this._player;S.triggerCallback&&P.onStart(()=>S.triggerCallback("start")),P.onDone(()=>this.finish()),P.onDestroy(()=>this.destroy())}_queueEvent(P,S){Oo(this._queuedCallbacks,P,[]).push(S)}onDone(P){this.queued&&this._queueEvent("done",P),this._player.onDone(P)}onStart(P){this.queued&&this._queueEvent("start",P),this._player.onStart(P)}onDestroy(P){this.queued&&this._queueEvent("destroy",P),this._player.onDestroy(P)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(P){this.queued||this._player.setPosition(P)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(P){const S=this._player;S.triggerCallback&&S.triggerCallback(P)}}function C(G){return G&&1===G.nodeType}function Q(G,P){const S=G.style.display;return G.style.display=null!=P?P:"none",S}function ye(G,P,S,H,me){const Ne=[];S.forEach(Qt=>Ne.push(Q(Qt)));const Qe=[];H.forEach((Qt,mn)=>{const Ri={};Qt.forEach(ar=>{const Pr=Ri[ar]=P.computeStyle(mn,ar,me);(!Pr||0==Pr.length)&&(mn[Hr]=Ts,Qe.push(mn))}),G.set(mn,Ri)});let pt=0;return S.forEach(Qt=>Q(Qt,Ne[pt++])),Qe}function Pe(G,P){const S=new Map;if(G.forEach(pt=>S.set(pt,[])),0==P.length)return S;const me=new Set(P),Ne=new Map;function Qe(pt){if(!pt)return 1;let Qt=Ne.get(pt);if(Qt)return Qt;const mn=pt.parentNode;return Qt=S.has(mn)?mn:me.has(mn)?1:Qe(mn),Ne.set(pt,Qt),Qt}return P.forEach(pt=>{const Qt=Qe(pt);1!==Qt&&S.get(Qt).push(pt)}),S}function Ze(G,P){var S;null===(S=G.classList)||void 0===S||S.add(P)}function zt(G,P){var S;null===(S=G.classList)||void 0===S||S.remove(P)}function qn(G,P,S){da(S).onDone(()=>G.processLeaveNode(P))}function Vi(G,P){for(let S=0;S<G.length;S++){const H=G[S];H instanceof gr?Vi(H.players,P):P.push(H)}}function co(G,P,S){const H=S.get(G);if(!H)return!1;let me=P.get(G);return me?H.forEach(Ne=>me.add(Ne)):P.set(G,H),S.delete(G),!0}class Zs{constructor(P,S,H){this.bodyNode=P,this._driver=S,this._normalizer=H,this._triggerCache={},this.onRemovalComplete=(me,Ne)=>{},this._transitionEngine=new c(P,S,H),this._timelineEngine=new cr(P,S,H),this._transitionEngine.onRemovalComplete=(me,Ne)=>this.onRemovalComplete(me,Ne)}registerTrigger(P,S,H,me,Ne){const Qe=P+"-"+me;let pt=this._triggerCache[Qe];if(!pt){const Qt=[],Ri=ba(this._driver,Ne,Qt,[]);if(Qt.length)throw function vs(G,P){return new N.vHH(3404,ti)}();pt=function Vn(G,P,S){return new ai(G,P,S)}(me,Ri,this._normalizer),this._triggerCache[Qe]=pt}this._transitionEngine.registerTrigger(S,me,pt)}register(P,S){this._transitionEngine.register(P,S)}destroy(P,S){this._transitionEngine.destroy(P,S)}onInsert(P,S,H,me){this._transitionEngine.insertNode(P,S,H,me)}onRemove(P,S,H,me){this._transitionEngine.removeNode(P,S,me||!1,H)}disableAnimations(P,S){this._transitionEngine.markElementAsDisabled(P,S)}process(P,S,H,me){if("@"==H.charAt(0)){const[Ne,Qe]=Mo(H);this._timelineEngine.command(Ne,S,Qe,me)}else this._transitionEngine.trigger(P,S,H,me)}listen(P,S,H,me,Ne){if("@"==H.charAt(0)){const[Qe,pt]=Mo(H);return this._timelineEngine.listen(Qe,S,pt,Ne)}return this._transitionEngine.listen(P,S,H,me,Ne)}flush(P=-1){this._transitionEngine.flush(P)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let kl=(()=>{class G{constructor(S,H,me){this._element=S,this._startStyles=H,this._endStyles=me,this._state=0;let Ne=G.initialStylesByElement.get(S);Ne||G.initialStylesByElement.set(S,Ne={}),this._initialStyles=Ne}start(){this._state<1&&(this._startStyles&&Lr(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Lr(this._element,this._initialStyles),this._endStyles&&(Lr(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(G.initialStylesByElement.delete(this._element),this._startStyles&&(Zi(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Zi(this._element,this._endStyles),this._endStyles=null),Lr(this._element,this._initialStyles),this._state=3)}}return G.initialStylesByElement=new WeakMap,G})();function dl(G){let P=null;const S=Object.keys(G);for(let H=0;H<S.length;H++){const me=S[H];El(me)&&(P=P||{},P[me]=G[me])}return P}function El(G){return"display"===G||"position"===G}class Gs{constructor(P,S,H,me){this.element=P,this.keyframes=S,this.options=H,this._specialStyles=me,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=H.duration,this._delay=H.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(P=>P()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const P=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,P,this.options),this._finalKeyframe=P.length?P[P.length-1]:{},this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(P,S,H){return P.animate(S,H)}onStart(P){this._onStartFns.push(P)}onDone(P){this._onDoneFns.push(P)}onDestroy(P){this._onDestroyFns.push(P)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(P=>P()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(P=>P()),this._onDestroyFns=[])}setPosition(P){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=P*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const P={};if(this.hasStarted()){const S=this._finalKeyframe;Object.keys(S).forEach(H=>{"offset"!=H&&(P[H]=this._finished?S[H]:xs(this.element,H))})}this.currentSnapshot=P}triggerCallback(P){const S="start"==P?this._onStartFns:this._onDoneFns;S.forEach(H=>H()),S.length=0}}class lu{validateStyleProperty(P){return Vs(P)}matchesElement(P,S){return!1}containsElement(P,S){return fs(P,S)}getParentElement(P){return Ms(P)}query(P,S,H){return js(P,S,H)}computeStyle(P,S,H){return window.getComputedStyle(P)[S]}animate(P,S,H,me,Ne,Qe=[]){const Qt={duration:H,delay:me,fill:0==me?"both":"forwards"};Ne&&(Qt.easing=Ne);const mn={},Ri=Qe.filter(Pr=>Pr instanceof Gs);(function ms(G,P){return 0===G||0===P})(H,me)&&Ri.forEach(Pr=>{let oo=Pr.currentSnapshot;Object.keys(oo).forEach(kr=>mn[kr]=oo[kr])}),S=function bs(G,P,S){const H=Object.keys(S);if(H.length&&P.length){let Ne=P[0],Qe=[];if(H.forEach(pt=>{Ne.hasOwnProperty(pt)||Qe.push(pt),Ne[pt]=S[pt]}),Qe.length)for(var me=1;me<P.length;me++){let pt=P[me];Qe.forEach(function(Qt){pt[Qt]=xs(G,Qt)})}}return P}(P,S=S.map(Pr=>wn(Pr,!1)),mn);const ar=function Tl(G,P){let S=null,H=null;return Array.isArray(P)&&P.length?(S=dl(P[0]),P.length>1&&(H=dl(P[P.length-1]))):P&&(S=dl(P)),S||H?new kl(G,S,H):null}(P,S);return new Gs(P,S,Qt,ar)}}let Cl=(()=>{class G extends Gt{constructor(S,H){super(),this._nextAnimationId=0,this._renderer=S.createRenderer(H.body,{id:"0",encapsulation:N.ifc.None,styles:[],data:{animation:[]}})}build(S){const H=this._nextAnimationId.toString();this._nextAnimationId++;const me=Array.isArray(S)?Se(S):S;return ol(this._renderer,null,H,"register",[me]),new Ls(H,this._renderer)}}return G.\u0275fac=function(S){return new(S||G)(N.LFG(N.FYo),N.LFG(D.K0))},G.\u0275prov=N.Yz7({token:G,factory:G.\u0275fac}),G})();class Ls extends class Rt{}{constructor(P,S){super(),this._id=P,this._renderer=S}create(P,S){return new uc(this._id,P,S||{},this._renderer)}}class uc{constructor(P,S,H,me){this.id=P,this.element=S,this._renderer=me,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",H)}_listen(P,S){return this._renderer.listen(this.element,`@@${this.id}:${P}`,S)}_command(P,...S){return ol(this._renderer,this.element,this.id,P,S)}onDone(P){this._listen("done",P)}onStart(P){this._listen("start",P)}onDestroy(P){this._listen("destroy",P)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(P){this._command("setPosition",P)}getPosition(){var P,S;return null!==(S=null===(P=this._renderer.engine.players[+this.id])||void 0===P?void 0:P.getPosition())&&void 0!==S?S:0}}function ol(G,P,S,H,me){return G.setProperty(P,`@@${S}:${H}`,me)}const sl="@.disabled";let Fs=(()=>{class G{constructor(S,H,me){this.delegate=S,this.engine=H,this._zone=me,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),H.onRemovalComplete=(Ne,Qe)=>{const pt=null==Qe?void 0:Qe.parentNode(Ne);pt&&Qe.removeChild(pt,Ne)}}createRenderer(S,H){const Ne=this.delegate.createRenderer(S,H);if(!(S&&H&&H.data&&H.data.animation)){let Ri=this._rendererCache.get(Ne);return Ri||(Ri=new Nl("",Ne,this.engine),this._rendererCache.set(Ne,Ri)),Ri}const Qe=H.id,pt=H.id+"-"+this._currentId;this._currentId++,this.engine.register(pt,S);const Qt=Ri=>{Array.isArray(Ri)?Ri.forEach(Qt):this.engine.registerTrigger(Qe,pt,S,Ri.name,Ri)};return H.data.animation.forEach(Qt),new Oi(this,pt,Ne,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(S,H,me){S>=0&&S<this._microtaskId?this._zone.run(()=>H(me)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(Ne=>{const[Qe,pt]=Ne;Qe(pt)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([H,me]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return G.\u0275fac=function(S){return new(S||G)(N.LFG(N.FYo),N.LFG(Zs),N.LFG(N.R0b))},G.\u0275prov=N.Yz7({token:G,factory:G.\u0275fac}),G})();class Nl{constructor(P,S,H){this.namespaceId=P,this.delegate=S,this.engine=H,this.destroyNode=this.delegate.destroyNode?me=>S.destroyNode(me):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(P,S){return this.delegate.createElement(P,S)}createComment(P){return this.delegate.createComment(P)}createText(P){return this.delegate.createText(P)}appendChild(P,S){this.delegate.appendChild(P,S),this.engine.onInsert(this.namespaceId,S,P,!1)}insertBefore(P,S,H,me=!0){this.delegate.insertBefore(P,S,H),this.engine.onInsert(this.namespaceId,S,P,me)}removeChild(P,S,H){this.engine.onRemove(this.namespaceId,S,this.delegate,H)}selectRootElement(P,S){return this.delegate.selectRootElement(P,S)}parentNode(P){return this.delegate.parentNode(P)}nextSibling(P){return this.delegate.nextSibling(P)}setAttribute(P,S,H,me){this.delegate.setAttribute(P,S,H,me)}removeAttribute(P,S,H){this.delegate.removeAttribute(P,S,H)}addClass(P,S){this.delegate.addClass(P,S)}removeClass(P,S){this.delegate.removeClass(P,S)}setStyle(P,S,H,me){this.delegate.setStyle(P,S,H,me)}removeStyle(P,S,H){this.delegate.removeStyle(P,S,H)}setProperty(P,S,H){"@"==S.charAt(0)&&S==sl?this.disableAnimations(P,!!H):this.delegate.setProperty(P,S,H)}setValue(P,S){this.delegate.setValue(P,S)}listen(P,S,H){return this.delegate.listen(P,S,H)}disableAnimations(P,S){this.engine.disableAnimations(P,S)}}class Oi extends Nl{constructor(P,S,H,me){super(S,H,me),this.factory=P,this.namespaceId=S}setProperty(P,S,H){"@"==S.charAt(0)?"."==S.charAt(1)&&S==sl?this.disableAnimations(P,H=void 0===H||!!H):this.engine.process(this.namespaceId,P,S.substr(1),H):this.delegate.setProperty(P,S,H)}listen(P,S,H){if("@"==S.charAt(0)){const me=function yc(G){switch(G){case"body":return document.body;case"document":return document;case"window":return window;default:return G}}(P);let Ne=S.substr(1),Qe="";return"@"!=Ne.charAt(0)&&([Ne,Qe]=function gh(G){const P=G.indexOf(".");return[G.substring(0,P),G.substr(P+1)]}(Ne)),this.engine.listen(this.namespaceId,me,Ne,Qe,pt=>{this.factory.scheduleListenerCallback(pt._data||-1,H,pt)})}return this.delegate.listen(P,S,H)}}let Ic=(()=>{class G extends Zs{constructor(S,H,me){super(S.body,H,me)}ngOnDestroy(){this.flush()}}return G.\u0275fac=function(S){return new(S||G)(N.LFG(D.K0),N.LFG(I),N.LFG(Cr))},G.\u0275prov=N.Yz7({token:G,factory:G.\u0275fac}),G})();const hc=new N.OlP("AnimationModuleType"),_h=[{provide:Gt,useClass:Cl},{provide:Cr,useFactory:function Rs(){return new Rl}},{provide:Zs,useClass:Ic},{provide:N.FYo,useFactory:function Yu(G,P,S){return new Fs(G,P,S)},deps:[an,Zs,N.R0b]}],Du=[{provide:I,useFactory:()=>new lu},{provide:hc,useValue:"BrowserAnimations"},..._h],Jh=[{provide:I,useClass:Wa},{provide:hc,useValue:"NoopAnimations"},..._h];let Qh=(()=>{class G{static withConfig(S){return{ngModule:G,providers:S.disableAnimations?Jh:Du}}}return G.\u0275fac=function(S){return new(S||G)},G.\u0275mod=N.oAB({type:G}),G.\u0275inj=N.cJS({providers:Du,imports:[Zr]}),G})();var Ga=fe(520),vc=fe(5436),Hs=fe(4466),Ys=fe(1810);let ec=(()=>{class G{constructor(){this.toggled=!1}toggle(){this.toggled=!this.toggled}getSidebarState(){return this.toggled}setSidebarState(S){this.toggled=S}}return G.\u0275fac=function(S){return new(S||G)},G.\u0275prov=N.Yz7({token:G,factory:G.\u0275fac,providedIn:"root"}),G})();var Ku=fe(7592);const Xu=[{path:"/dashboard/inicio",title:"Inicio",icon:"bx bx-home-alt icon-color-1",class:"",badge:"",badgeClass:"",isExternalLink:!1,submenu:[]},{path:"/user-profile",title:"Perfil",icon:"bx bx-user-circle icon-color-4",class:"",badge:"",badgeClass:"",isExternalLink:!1,submenu:[]},{path:"",title:"Reportes",icon:"bx bxs-report icon-color-3",class:"sub",badge:"",badgeClass:"",isExternalLink:!1,submenu:[{path:"/reportes/crear-reportes",title:"Crear reportes",icon:"bx bx-right-arrow-alt",class:"",badge:"",badgeClass:"",isExternalLink:!1,submenu:[]},{path:"/reportes/ver-reportes",title:"Ver reportes",icon:"bx bx-right-arrow-alt",class:"",badge:"",badgeClass:"",isExternalLink:!1,submenu:[]}]},{path:"",title:"Admin",icon:"bx bxs-user-check icon-color-16",class:"sub",badge:"",badgeClass:"",isExternalLink:!1,submenu:[{path:"/admin/estadisticas",title:"Estad\xedsticas",icon:"bx bx-right-arrow-alt",class:"",badge:"",badgeClass:"",isExternalLink:!1,submenu:[]},{path:"",title:"Unidad T\xe9cnica Especializada",icon:"bx bx-right-arrow-alt",class:"sub",badge:"",badgeClass:"",isExternalLink:!1,submenu:[{path:"/admin/gestionar-ute",title:"Registrar UTE",icon:"bx bx-right-arrow-alt",class:"",badge:"",badgeClass:"",isExternalLink:!1,submenu:[]}]},{path:"",title:"Categor\xedas",icon:"bx bx-right-arrow-alt",class:"sub",badge:"",badgeClass:"",isExternalLink:!1,submenu:[{path:"admin/categorias",title:"Agregar categor\xeda",icon:"bx bx-right-arrow-alt",class:"",badge:"",badgeClass:"",isExternalLink:!1,submenu:[]},{path:"/admin/categorias/ver-categorias",title:"Ver Categor\xeda",icon:"bx bx-right-arrow-alt",class:"",badge:"",badgeClass:"",isExternalLink:!1,submenu:[]}]},{path:"/admin/bitacoras",title:"Bitacoras",icon:"bx bx-right-arrow-alt",class:"",badge:"",badgeClass:"",isExternalLink:!1,submenu:[]},{path:"",title:"Usuarios",icon:"bx bx-right-arrow-alt",class:"sub",badge:"",badgeClass:"",isExternalLink:!1,submenu:[{path:"/admin/gestionar-ciudadano",title:"Ciudadanos",icon:"bx bx-right-arrow-alt",class:"",badge:"",badgeClass:"",isExternalLink:!1,submenu:[]},{path:"/admin/gestionar-ute/ver-ute",title:"UTE",icon:"bx bx-right-arrow-alt",class:"",badge:"",badgeClass:"",isExternalLink:!1,submenu:[]}]}]}],Dl=[{path:"/dashboard/inicio",title:"Inicio",icon:"bx bx-home-alt icon-color-1",class:"",badge:"",badgeClass:"",isExternalLink:!1,submenu:[]},{path:"/user-profile",title:"Perfil",icon:"bx bx-user-circle icon-color-4",class:"",badge:"",badgeClass:"",isExternalLink:!1,submenu:[]},{path:"",title:"Reportes",icon:"bx bxs-report icon-color-3",class:"sub",badge:"",badgeClass:"",isExternalLink:!1,submenu:[{path:"/reportes/crear-reportes",title:"Crear reportes",icon:"bx bx-right-arrow-alt",class:"",badge:"",badgeClass:"",isExternalLink:!1,submenu:[]},{path:"/reportes/ver-reportes",title:"Ver reportes",icon:"bx bx-right-arrow-alt",class:"",badge:"",badgeClass:"",isExternalLink:!1,submenu:[]}]}],Zl=[{path:"/dashboard/inicio",title:"Inicio",icon:"bx bx-home-alt icon-color-1",class:"",badge:"",badgeClass:"",isExternalLink:!1,submenu:[]},{path:"/user-profile",title:"Perfil",icon:"bx bx-user-circle icon-color-4",class:"",badge:"",badgeClass:"",isExternalLink:!1,submenu:[]},{path:"",title:"Reportes",icon:"bx bxs-report icon-color-3",class:"sub",badge:"",badgeClass:"",isExternalLink:!1,submenu:[{path:"/reportes/crear-reportes",title:"Crear reportes",icon:"bx bx-right-arrow-alt",class:"",badge:"",badgeClass:"",isExternalLink:!1,submenu:[]},{path:"/reportes/ver-reportes",title:"Ver reportes",icon:"bx bx-right-arrow-alt",class:"",badge:"",badgeClass:"",isExternalLink:!1,submenu:[]}]},{path:"",title:"UTE",icon:"bx bxs-user-detail icon-color-10",class:"sub",badge:"",badgeClass:"",isExternalLink:!1,submenu:[{path:"/ute/gestionar-reporte",title:"Gestionar reporte",icon:"bx bx-right-arrow-alt",class:"",badge:"",badgeClass:"",isExternalLink:!1,submenu:[]}]}];var Gl=fe(8259),Ll=fe(3709),tc=fe(937);function Su(G,P){1&G&&(N.TgZ(0,"ul",8)(1,"li")(2,"a",9),N._UZ(3,"i",10),N.TgZ(4,"span",11),N._uU(5,"Inicio"),N.qZA()()()())}const na=function(G){return[G]};function yh(G,P){if(1&G&&(N.TgZ(0,"span",18),N._uU(1),N.qZA()),2&G){const S=N.oxw(2).$implicit;N.Q6J("ngClass",N.VKq(2,na,S.badgeClass)),N.xp6(1),N.Oqu(S.badge)}}function Au(G,P){if(1&G&&(N.TgZ(0,"a",17),N._UZ(1,"i",18),N.TgZ(2,"span",19),N._uU(3),N.qZA(),N.YNc(4,yh,2,4,"span",20),N.qZA()),2&G){const S=N.oxw().$implicit;N.Q6J("routerLink",""===S.class?N.VKq(5,na,S.path):null)("ngClass",""===S.class?"":"cursor-pointer"),N.xp6(1),N.Q6J("ngClass",N.VKq(7,na,S.icon)),N.xp6(2),N.Oqu(S.title),N.xp6(1),N.Q6J("ngIf",""!=S.badge)}}function ed(G,P){if(1&G&&(N.TgZ(0,"span",18),N._uU(1),N.qZA()),2&G){const S=N.oxw(2).$implicit;N.Q6J("ngClass",N.VKq(2,na,S.badgeClass)),N.xp6(1),N.Oqu(S.badge)}}function Mu(G,P){if(1&G&&(N.TgZ(0,"a",21),N._UZ(1,"i",18),N.TgZ(2,"span",19),N._uU(3),N.qZA(),N.YNc(4,ed,2,4,"span",20),N.qZA()),2&G){const S=N.oxw().$implicit;N.Q6J("href",N.VKq(4,na,S.path),N.LSH),N.xp6(1),N.Q6J("ngClass",N.VKq(6,na,S.icon)),N.xp6(2),N.Oqu(S.title),N.xp6(1),N.Q6J("ngIf",""!=S.badge)}}function fl(G,P){if(1&G&&(N.TgZ(0,"span",18),N._uU(1),N.qZA()),2&G){const S=N.oxw(2).$implicit;N.Q6J("ngClass",N.VKq(2,na,S.badgeClass)),N.xp6(1),N.Oqu(S.badge)}}function uu(G,P){if(1&G&&(N.TgZ(0,"a",17),N._UZ(1,"i",18),N.TgZ(2,"span",26),N._uU(3),N.qZA(),N.YNc(4,fl,2,4,"span",20),N.qZA()),2&G){const S=N.oxw().$implicit,H=N.oxw(2).$implicit;N.Q6J("routerLink",S.submenu.length>0?null:N.VKq(5,na,S.path))("ngClass",""===H.class?"":"cursor-pointer"),N.xp6(1),N.Q6J("ngClass",N.VKq(7,na,S.icon)),N.xp6(2),N.Oqu(S.title),N.xp6(1),N.Q6J("ngIf",""!=S.badge)}}function bc(G,P){if(1&G&&(N.TgZ(0,"span",18),N._uU(1),N.qZA()),2&G){const S=N.oxw(2).$implicit;N.Q6J("ngClass",N.VKq(2,na,S.badgeClass)),N.xp6(1),N.Oqu(S.badge)}}function Iu(G,P){if(1&G&&(N.TgZ(0,"a",21),N._UZ(1,"i",18),N.TgZ(2,"span",26),N._uU(3),N.qZA(),N.YNc(4,bc,2,4,"span",20),N.qZA()),2&G){const S=N.oxw().$implicit;N.Q6J("href",N.VKq(4,na,S.path),N.LSH),N.xp6(1),N.Q6J("ngClass",N.VKq(6,na,S.icon)),N.xp6(2),N.Oqu(S.title),N.xp6(1),N.Q6J("ngIf",""!=S.badge)}}function vh(G,P){if(1&G&&(N.TgZ(0,"span",18),N._uU(1),N.qZA()),2&G){const S=N.oxw(2).$implicit;N.Q6J("ngClass",N.VKq(2,na,S.badgeClass)),N.xp6(1),N.Oqu(S.badge)}}function td(G,P){if(1&G&&(N.TgZ(0,"a",31),N._UZ(1,"i",18),N.TgZ(2,"span",26),N._uU(3),N.qZA(),N.YNc(4,vh,2,4,"span",20),N.qZA()),2&G){const S=N.oxw().$implicit;N.Q6J("routerLink",N.VKq(4,na,S.path)),N.xp6(1),N.Q6J("ngClass",N.VKq(6,na,S.icon)),N.xp6(2),N.Oqu(S.title),N.xp6(1),N.Q6J("ngIf",""!=S.badge)}}function Pu(G,P){if(1&G&&(N.TgZ(0,"span",18),N._uU(1),N.qZA()),2&G){const S=N.oxw(2).$implicit;N.Q6J("ngClass",N.VKq(2,na,S.badgeClass)),N.xp6(1),N.Oqu(S.badge)}}function hu(G,P){if(1&G&&(N.TgZ(0,"a",21),N._UZ(1,"i",18),N.TgZ(2,"span",26),N._uU(3),N.qZA(),N.YNc(4,Pu,2,4,"span",20),N.qZA()),2&G){const S=N.oxw().$implicit;N.Q6J("href",N.VKq(4,na,S.path),N.LSH),N.xp6(1),N.Q6J("ngClass",N.VKq(6,na,S.icon)),N.xp6(2),N.Oqu(S.title),N.xp6(1),N.Q6J("ngIf",""!=S.badge)}}const d=function(){return{exact:!0}};function i(G,P){if(1&G&&(N.TgZ(0,"li",28),N.YNc(1,td,5,8,"a",29),N.YNc(2,hu,5,8,"ng-template",null,30,N.W1O),N.qZA()),2&G){const S=P.$implicit,H=N.MAs(3);N.Q6J("routerLinkActiveOptions",N.DdM(4,d))("ngClass",N.VKq(5,na,S.class)),N.xp6(1),N.Q6J("ngIf",!S.isExternalLink)("ngIfElse",H)}}function u(G,P){if(1&G&&(N.TgZ(0,"ul",22),N.YNc(1,i,4,7,"li",27),N.qZA()),2&G){const S=N.oxw().$implicit;N.xp6(1),N.Q6J("ngForOf",S.submenu)}}function m(G,P){if(1&G&&(N.TgZ(0,"li",24),N.YNc(1,uu,5,9,"a",14),N.YNc(2,Iu,5,8,"ng-template",null,25,N.W1O),N.YNc(4,u,2,1,"ul",16),N.qZA()),2&G){const S=P.$implicit,H=N.MAs(3);N.Q6J("routerLinkActive",S.submenu.length>0?"":"active")("ngClass",N.VKq(5,na,S.class)),N.xp6(1),N.Q6J("ngIf",!S.isExternalLink)("ngIfElse",H),N.xp6(3),N.Q6J("ngIf",S.submenu.length>0)}}function E(G,P){if(1&G&&(N.TgZ(0,"ul",22),N.YNc(1,m,5,7,"li",23),N.qZA()),2&G){const S=N.oxw().$implicit;N.xp6(1),N.Q6J("ngForOf",S.submenu)}}function M(G,P){if(1&G&&(N.TgZ(0,"li",13),N.YNc(1,Au,5,9,"a",14),N.YNc(2,Mu,5,8,"ng-template",null,15,N.W1O),N.YNc(4,E,2,1,"ul",16),N.qZA()),2&G){const S=P.$implicit,H=N.MAs(3);N.Q6J("ngClass",N.VKq(6,na,S.class))("routerLinkActive",0!=S.submenu.length?"":"active")("routerLinkActiveOptions",N.DdM(8,d)),N.xp6(1),N.Q6J("ngIf",!S.isExternalLink)("ngIfElse",H),N.xp6(3),N.Q6J("ngIf",S.submenu.length>0)}}function z(G,P){if(1&G&&(N.TgZ(0,"ul",8),N.YNc(1,M,5,9,"li",12),N.qZA()),2&G){const S=N.oxw();N.xp6(1),N.Q6J("ngForOf",S.menuItems)}}let Z=(()=>{class G{constructor(S,H,me){this.sidebarservice=S,this.router=H,this.usuarioService=me,this.usuario=me.usuario,H.events.subscribe(Ne=>{Ne instanceof Ys.m2&&Gl(window).width()<1025&&("complete"==document.readyState||!1)&&this.toggleSidebar(),Ne instanceof Ys.Q3&&console.log(Ne.error)})}toggleSidebar(){this.sidebarservice.setSidebarState(!this.sidebarservice.getSidebarState()),Gl(".wrapper").hasClass("nav-collapsed")?(Gl(".wrapper").removeClass("nav-collapsed"),Gl(".sidebar-wrapper").unbind("hover")):(Gl(".wrapper").addClass("nav-collapsed"),Gl(".sidebar-wrapper").hover(function(){Gl(".wrapper").addClass("sidebar-hovered")},function(){Gl(".wrapper").removeClass("sidebar-hovered")}))}getSideBarState(){return this.sidebarservice.getSidebarState()}hideSidebar(){this.sidebarservice.setSidebarState(!0)}ngOnInit(){this.menuItems=this.isCiudadano()?Dl.filter(S=>S):this.isUte()?Zl.filter(S=>S):Xu.filter(S=>S),Gl.getScript("./assets/js/app-sidebar.js")}isUte(){return"UTE"==this.usuario.rol}isCiudadano(){return"Ciudadano"==this.usuario.rol}isLogeado(){return null!=this.usuarioService.usuario}}return G.\u0275fac=function(S){return new(S||G)(N.Y36(ec),N.Y36(Ys.F0),N.Y36(Ll.e))},G.\u0275cmp=N.Xpm({type:G,selectors:[["app-sidebar"]],decls:9,vars:2,consts:[[1,"sidebar","sidebar-wrapper"],[1,"sidebar-header"],[1,""],["src","assets/images/Muni.png","alt","",2,"height","70%","width","90%"],["href","#",1,"toggle-btn","ms-auto",3,"click"],[1,"bx","bx-menu"],[1,"sidebar-content",3,"perfectScrollbar"],["class","navigation",4,"ngIf"],[1,"navigation"],["ngClass","!cursor-pointer ","routerLinkActive","active"],["ngClass","bx bx-home-alt icon-color-1"],["routerLinkActive","active",1,"menu-title"],[3,"ngClass","routerLinkActive","routerLinkActiveOptions",4,"ngFor","ngForOf"],[3,"ngClass","routerLinkActive","routerLinkActiveOptions"],[3,"routerLink","ngClass",4,"ngIf","ngIfElse"],["externalLinkBlock",""],["class","menu-content",4,"ngIf"],[3,"routerLink","ngClass"],[3,"ngClass"],[1,"menu-title"],[3,"ngClass",4,"ngIf"],["target","_blank",3,"href"],[1,"menu-content"],[3,"routerLinkActive","ngClass",4,"ngFor","ngForOf"],[3,"routerLinkActive","ngClass"],["externalSubLinkBlock",""],[1,"sub-menu-title"],["routerLinkActive","active",3,"routerLinkActiveOptions","ngClass",4,"ngFor","ngForOf"],["routerLinkActive","active",3,"routerLinkActiveOptions","ngClass"],[3,"routerLink",4,"ngIf","ngIfElse"],["externalSubSubLinkBlock",""],[3,"routerLink"]],template:function(S,H){1&S&&(N.TgZ(0,"div",0)(1,"div",1)(2,"div",2),N._UZ(3,"img",3),N.qZA(),N.TgZ(4,"a",4),N.NdJ("click",function(Ne){return Ne.preventDefault(),H.toggleSidebar()}),N._UZ(5,"i",5),N.qZA()(),N.TgZ(6,"div",6),N.YNc(7,Su,6,0,"ul",7),N.YNc(8,z,2,1,"ul",7),N.qZA()()),2&S&&(N.xp6(7),N.Q6J("ngIf",!H.isLogeado()),N.xp6(1),N.Q6J("ngIf",H.isLogeado()))},directives:[tc.$V,D.O5,D.mk,Ys.Od,D.sg,Ys.yS],styles:[""]}),G})();function K(G,P){if(1&G){const S=N.EpF();N.TgZ(0,"div",6)(1,"div",6)(2,"button",8),N.NdJ("click",function(){return N.CHM(S),N.oxw().inicia()}),N._uU(3,"Inicia Sesi\xf3n"),N.qZA(),N.TgZ(4,"button",9),N.NdJ("click",function(){return N.CHM(S),N.oxw().registro()}),N._uU(5,"Reg\xedstrate"),N.qZA()()()}}function de(G,P){if(1&G){const S=N.EpF();N.TgZ(0,"ul",10)(1,"li",11)(2,"a",12),N.NdJ("click",function(me){return me.preventDefault()}),N.TgZ(3,"div",13)(4,"div",14)(5,"p",15),N._uU(6),N.qZA()(),N._UZ(7,"img",16),N.qZA()(),N.TgZ(8,"div",17),N._UZ(9,"div",18),N.TgZ(10,"a",19),N.NdJ("click",function(){return N.CHM(S),N.oxw().navegarPerfil()}),N._UZ(11,"i",20),N.TgZ(12,"span"),N._uU(13,"Perfil"),N.qZA()(),N.TgZ(14,"a",21),N.NdJ("click",function(){return N.CHM(S),N.oxw().logout()}),N._UZ(15,"i",22),N.TgZ(16,"span"),N._uU(17,"Cerrar Sesi\xf3n"),N.qZA()()()()()}if(2&G){const S=N.oxw();N.xp6(6),N.Oqu(S.usuario.nombre),N.xp6(1),N.Q6J("src",S.photoURL(),N.LSH)("alt",S.user)}}let pe=(()=>{class G{constructor(S,H,me,Ne){this.sidebarservice=S,this.authService=H,this.router=me,this.sanitizer=Ne,this.imgUrl="",this.usuario=H.usuario,this.usuario&&(this.imgUrl=H.usuario.imagenUrl)}photoURL(){return this.imgUrl.slice(1)}toggleSidebar(){this.sidebarservice.setSidebarState(!this.sidebarservice.getSidebarState())}navegarPerfil(){this.router.navigateByUrl("/user-profile")}navegarReportes(){this.router.navigateByUrl("/reportes/ver-reportes")}getSideBarState(){return this.sidebarservice.getSidebarState()}hideSidebar(){this.sidebarservice.setSidebarState(!0)}usuarioLogeado(){return this.authService.usuario}logout(){this.authService.logout()}inicia(){this.router.navigateByUrl("/auth/login")}registro(){this.router.navigateByUrl("/auth/register")}ngOnInit(){$(document).ready(function(){$(".search-btn-mobile").on("click",function(){$(".search-bar").addClass("full-search-bar")}),$(".search-arrow-back").on("click",function(){$(".search-bar").removeClass("full-search-bar")})})}}return G.\u0275fac=function(S){return new(S||G)(N.Y36(ec),N.Y36(Ll.e),N.Y36(Ys.F0),N.Y36(Me))},G.\u0275cmp=N.Xpm({type:G,selectors:[["app-navbar"]],decls:8,vars:2,consts:[[1,"top-header"],[1,"navbar","navbar-expand"],[1,"left-topbar","d-flex","align-items-center"],["href","#",1,"toggle-btn",3,"click"],[1,"bx","bx-menu"],["class","right-topbar ms-auto",4,"ngIf"],[1,"right-topbar","ms-auto"],["class","navbar-nav",4,"ngIf"],["type","submit",1,"btn","btn-primary",2,"margin","10px","right","150px","top","0","position","absolute","display","block",3,"click"],["type","submit",1,"btn","btn-primary",2,"margin","10px","right","30px","top","0","position","absolute","display","block",3,"click"],[1,"navbar-nav"],["ngbDropdown","",1,"nav-item","dropdown-user-profile"],["href","#","id","dropdownBasic3","ngbDropdownToggle","",1,"nav-link","dropdown-toggle-nocaret",3,"click"],[1,"d-flex","user-box","align-items-center"],[1,"user-info"],[1,"user-name","mb-0"],[1,"user-img",3,"src","alt"],["ngbDropdownMenu","","aria-labelledby","dropdownBasic3",1,"dropdown-menu-end"],[1,"dropdown-divider","mb-0"],["ngbDropdownItem","",3,"click"],[1,"bx","bx-user"],["ngbDropdownItem","","href","#",3,"click"],[1,"bx","bx-power-off"]],template:function(S,H){1&S&&(N.TgZ(0,"header",0)(1,"nav",1)(2,"div",2)(3,"a",3),N.NdJ("click",function(Ne){return Ne.preventDefault()})("click",function(){return H.toggleSidebar()}),N._UZ(4,"i",4),N.qZA()(),N.YNc(5,K,6,0,"div",5),N.TgZ(6,"div",6),N.YNc(7,de,18,3,"ul",7),N.qZA()()()),2&S&&(N.xp6(5),N.Q6J("ngIf",!H.usuarioLogeado()),N.xp6(2),N.Q6J("ngIf",H.usuarioLogeado()))},directives:[vc.M2,D.O5,vc.jt,vc.iD,vc.Vi,vc.TH],styles:[".botonInicio[_ngcontent-%COMP%]{position:absolute;right:0;top:0}.centrar[_ngcontent-%COMP%]{margin:0 auto;display:block;text-align:center;padding:auto;z-index:999}"]}),G})(),De=(()=>{class G{constructor(){this.date=(new Date).getFullYear()}ngOnInit(){$(document).ready(function(){$(window).on("scroll",function(){$(this).scrollTop()>300?$(".back-to-top").fadeIn():$(".back-to-top").fadeOut()}),$(".back-to-top").on("click",function(){return $("html, body").animate({scrollTop:0},600),!1})})}}return G.\u0275fac=function(S){return new(S||G)},G.\u0275cmp=N.Xpm({type:G,selectors:[["app-footer"]],decls:7,vars:1,consts:[["href","#",1,"back-to-top",3,"click"],[1,"bx","bxs-up-arrow-alt"],[1,"footer"],[1,"mb-0"],["href","https://www.munipalmares.go.cr/index.php?option=com_content&view=article&layout=edit&id=99","target","_blank"]],template:function(S,H){1&S&&(N.TgZ(0,"a",0),N.NdJ("click",function(Ne){return Ne.preventDefault()}),N._UZ(1,"i",1),N.qZA(),N.TgZ(2,"div",2)(3,"p",3),N._uU(4),N.TgZ(5,"a",4),N._uU(6,"YoReporto"),N.qZA()()()),2&S&&(N.xp6(4),N.hij("",H.date," | Municipalidad Palmares | Pol\xedticas de uso: "))},styles:[""]}),G})();var Fe=fe(5226),Je=fe.n(Fe),Ge=fe(1305);function He(G,P){if(1&G&&N._UZ(0,"img",15),2&G){const S=N.oxw();N.Q6J("src",S.modalService.img,N.LSH)}}function $e(G,P){if(1&G&&N._UZ(0,"img",15),2&G){const S=N.oxw();N.Q6J("src",S.imgTemp,N.LSH)}}function ze(G,P){if(1&G){const S=N.EpF();N.TgZ(0,"button",16),N.NdJ("click",function(){return N.CHM(S),N.oxw().subirImagen()}),N._uU(1," Actualizar foto"),N.qZA()}}function tt(G,P){if(1&G){const S=N.EpF();N.TgZ(0,"button",16),N.NdJ("click",function(){return N.CHM(S),N.oxw().subirImagenRepo()}),N._uU(1," Actualizar foto"),N.qZA()}}let et=(()=>{class G{constructor(S,H){this.modalService=S,this.fileUploadService=H,this.imgTemp=null}ngOnInit(){}cerrarModal(){this.imgTemp=null,this.modalService.cerrarModal()}cambiarImagen(S){if(this.imagenSubir=S,!S)return this.imgTemp=null;const H=new FileReader;H.readAsDataURL(S),H.onloadend=()=>{this.imgTemp=H.result}}subirImagen(){const S=this.modalService.id;console.log("subir imagen",this.imagenSubir),console.log("id",S),this.fileUploadService.actualizarFoto(this.imagenSubir,"usuarios",S).then(me=>{Je().fire("Guardado","Imagen de usuario actualizada","success"),this.modalService.nuevaImagen.emit(me),this.cerrarModal()}).catch(me=>{console.log(me),Je().fire("Error","No se pudo subir la imagen","error")})}subirImagenRepo(){this.fileUploadService.actualizarFotoRepo(this.imagenSubir,"reportes",this.modalService.id).then(me=>{Je().fire("Guardado","Imagen de usuario actualizada","success"),this.modalService.nuevaImagen.emit(me),this.cerrarModal()}).catch(me=>{console.log(me),Je().fire("Error","No se pudo subir la imagen","error")})}}return G.\u0275fac=function(S){return new(S||G)(N.Y36(Ku.e),N.Y36(Ge.J))},G.\u0275cmp=N.Xpm({type:G,selectors:[["app-modal-imagen"]],decls:22,vars:6,consts:[[1,"fondo-modal-imagen","animated","fadeIn","fast"],["id","exampleModal","tabindex","-1","role","dialog","aria-labelledby","exampleModalLabel1",1,"modal","fade","show",2,"display","block"],["role","document",1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","exampleModalLabel1",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"text-center"],["class","img-avatar","width","130","height","130",3,"src",4,"ngIf"],["type","file",3,"change"],[1,"modal-footer"],["type","button","data-dismiss","modal",1,"btn","btn-default",3,"click"],["type","button","class","btn btn-primary",3,"click",4,"ngIf"],["width","130","height","130",1,"img-avatar",3,"src"],["type","button",1,"btn","btn-primary",3,"click"]],template:function(S,H){1&S&&(N.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h4",5),N._uU(6,"Cargar imagen"),N.qZA(),N.TgZ(7,"button",6),N.NdJ("click",function(){return H.cerrarModal()}),N.TgZ(8,"span",7),N._uU(9,"\xd7"),N.qZA()()(),N.TgZ(10,"div",8)(11,"h3"),N._uU(12,"Seleccione una imagen"),N.qZA(),N.TgZ(13,"div",9),N.YNc(14,He,1,1,"img",10),N.YNc(15,$e,1,1,"img",10),N.qZA(),N.TgZ(16,"input",11),N.NdJ("change",function(Ne){return H.cambiarImagen(Ne.target.files[0])}),N.qZA()(),N.TgZ(17,"div",12)(18,"button",13),N.NdJ("click",function(){return H.cerrarModal()}),N._uU(19," Cancelar "),N.qZA(),N.YNc(20,ze,2,0,"button",14),N.YNc(21,tt,2,0,"button",14),N.qZA()()()()()),2&S&&(N.ekj("oculto",H.modalService.ocultarModal),N.xp6(14),N.Q6J("ngIf",!H.imgTemp),N.xp6(1),N.Q6J("ngIf",H.imgTemp),N.xp6(5),N.Q6J("ngIf","usuarios"===H.modalService.tipo),N.xp6(1),N.Q6J("ngIf","reportes"===H.modalService.tipo))},directives:[D.O5],styles:[".oculto[_ngcontent-%COMP%]{display:none}.fondo-modal-imagen[_ngcontent-%COMP%]{background-color:#0006;left:0;height:100%;position:fixed;top:0;width:100%;z-index:9999}"]}),G})(),Mt=(()=>{class G{constructor(){this.theme=localStorage.getItem("theme")||"light-theme"}ngOnInit(){$(".switcher-btn").on("click",function(){$(".switcher-wrapper").toggleClass("switcher-toggled")}),$("#darkmode").on("click",function(){$("html").attr("class","dark-theme"),localStorage.setItem("theme","dark-theme")}),$("#lightmode").on("click",function(){$("html").attr("class","light-theme"),localStorage.setItem("theme","light-theme")}),$("#darksidebar").on("click",function(){$("html").attr("class","dark-sidebar")}),$("#ColorLessIcons").on("click",function(){$("html").toggleClass("ColorLessIcons")}),$("html").attr("class",this.theme),"dark-theme"==this.theme?$("#darkmode").prop("checked",!0):$("#lightmode").prop("checked",!0)}}return G.\u0275fac=function(S){return new(S||G)},G.\u0275cmp=N.Xpm({type:G,selectors:[["app-color-switcher"]],decls:22,vars:0,consts:[[1,"switcher-body"],["type","button","data-bs-toggle","offcanvas","data-bs-target","#offcanvasScrolling","aria-controls","offcanvasScrolling",1,"btn","btn-primary","btn-switcher","shadow-sm"],[1,"bx","bx-cog","bx-spin"],["data-bs-scroll","true","data-bs-backdrop","false","tabindex","-1","id","offcanvasScrolling",1,"offcanvas","offcanvas-end","shadow","border-start-0","p-2"],[1,"offcanvas-header","border-bottom"],["id","offcanvasScrollingLabel",1,"offcanvas-title"],["type","button","data-bs-dismiss","offcanvas",1,"btn-close","text-reset"],[1,"offcanvas-body"],[1,"mb-0"],[1,"form-check","form-check-inline"],["type","radio","name","inlineRadioOptions","id","lightmode","value","option1","checked","",1,"form-check-input"],["for","lightmode",1,"form-check-label"],["type","radio","name","inlineRadioOptions","id","darkmode","value","option2",1,"form-check-input"],["for","darkmode",1,"form-check-label"]],template:function(S,H){1&S&&(N.TgZ(0,"div",0)(1,"button",1),N._UZ(2,"i",2),N.qZA(),N.TgZ(3,"div",3)(4,"div",4)(5,"h5",5),N._uU(6,"Seleccione el tema"),N.qZA(),N._UZ(7,"button",6),N.qZA(),N.TgZ(8,"div",7)(9,"h6",8),N._uU(10,"Varaciones de tema"),N.qZA(),N._UZ(11,"hr"),N.TgZ(12,"div",9),N._UZ(13,"input",10),N.TgZ(14,"label",11),N._uU(15,"Claro"),N.qZA()(),N._UZ(16,"hr"),N.TgZ(17,"div",9),N._UZ(18,"input",12),N.TgZ(19,"label",13),N._uU(20,"Oscuro"),N.qZA()(),N._UZ(21,"hr"),N.qZA()()())},styles:[""]}),G})();function Et(G,P){1&G&&(N.ynx(0),N._UZ(1,"app-modal-imagen"),N.BQk())}const yt=function(G){return{"nav-collapsed":G}},It=function(G){return{show:G}};let Ct=(()=>{class G{constructor(S,H,me){this.sidebarservice=S,this.router=H,this.modalService=me}toggleSidebar(){this.sidebarservice.setSidebarState(!this.sidebarservice.getSidebarState())}getSideBarState(){return this.sidebarservice.getSidebarState()}hideSidebar(){this.sidebarservice.setSidebarState(!0)}ngOnInit(){this.router.events.subscribe(S=>{S instanceof Ys.m2&&window.scrollTo(0,0)})}}return G.\u0275fac=function(S){return new(S||G)(N.Y36(ec),N.Y36(Ys.F0),N.Y36(Ku.e))},G.\u0275cmp=N.Xpm({type:G,selectors:[["app-full-layout"]],decls:11,vars:7,consts:[[1,"wrapper",3,"ngClass"],[1,"page-wrapper"],[1,"page-content-wrapper"],[1,"page-content"],[1,"overlay",3,"ngClass","click"],[4,"ngIf"]],template:function(S,H){1&S&&(N.TgZ(0,"div",0),N._UZ(1,"app-sidebar")(2,"app-navbar"),N.TgZ(3,"div",1)(4,"div",2)(5,"div",3),N._UZ(6,"router-outlet"),N.TgZ(7,"div",4),N.NdJ("click",function(){return H.toggleSidebar()}),N.qZA()()()(),N._UZ(8,"app-footer"),N.YNc(9,Et,2,0,"ng-container",5),N.qZA(),N._UZ(10,"app-color-switcher")),2&S&&(N.Q6J("ngClass",N.VKq(3,yt,H.getSideBarState())),N.xp6(7),N.Q6J("ngClass",N.VKq(5,It,H.getSideBarState())),N.xp6(2),N.Q6J("ngIf",!H.modalService.ocultarModal))},directives:[D.mk,Z,pe,Ys.lC,De,D.O5,et,Mt],styles:[""]}),G})(),Vt=(()=>{class G{}return G.\u0275fac=function(S){return new(S||G)},G.\u0275cmp=N.Xpm({type:G,selectors:[["app-content-layout"]],decls:1,vars:0,template:function(S,H){1&S&&N._UZ(0,"router-outlet")},directives:[Ys.lC],styles:[""]}),G})();var sn=fe(8505),ni=fe(6709);let Xt=(()=>{class G{constructor(S,H,me){this.authService=S,this.route=H,this.serviceReportes=me}canActivate(S,H){return this.authService.validarToken().pipe((0,sn.b)(me=>{me||this.route.navigateByUrl("/inicio-sin-logeo")}))}}return G.\u0275fac=function(S){return new(S||G)(N.LFG(Ll.e),N.LFG(Ys.F0),N.LFG(ni.j))},G.\u0275prov=N.Yz7({token:G,factory:G.\u0275fac,providedIn:"root"}),G})();const di=[{path:"dashboard",loadChildren:()=>Promise.resolve().then(fe.bind(fe,9131)).then(G=>G.DashboardModule),canActivate:[Xt]},{path:"emailapp",loadChildren:()=>fe.e(126).then(fe.bind(fe,126)).then(G=>G.EmailappModule)},{path:"widgets",loadChildren:()=>fe.e(671).then(fe.bind(fe,3671)).then(G=>G.WidgetsModule)},{path:"user-profile",loadChildren:()=>fe.e(124).then(fe.bind(fe,9124)).then(G=>G.UserProfileModule),canActivate:[Xt]},{path:"content",loadChildren:()=>fe.e(911).then(fe.bind(fe,2911)).then(G=>G.ContentModule)},{path:"reportes",loadChildren:()=>Promise.resolve().then(fe.bind(fe,6531)).then(G=>G.ReportesModule),canActivate:[Xt]},{path:"ute",loadChildren:()=>fe.e(97).then(fe.bind(fe,5097)).then(G=>G.UteModule),canActivate:[(()=>{class G{constructor(S,H,me){this.authService=S,this.reporteService=H,this.router=me}canActivate(S,H){return this.authService.validarToken().pipe((0,sn.b)(me=>me?"UTE"===this.authService.rol||"ADMIN"===this.authService.rol||(this.router.navigateByUrl("/dashboard/inicio"),!1):(this.router.navigateByUrl("/dashboard/inicio"),!0)))}}return G.\u0275fac=function(S){return new(S||G)(N.LFG(Ll.e),N.LFG(ni.j),N.LFG(Ys.F0))},G.\u0275prov=N.Yz7({token:G,factory:G.\u0275fac,providedIn:"root"}),G})()]},{path:"admin",loadChildren:()=>fe.e(597).then(fe.bind(fe,7597)).then(G=>G.AdminModule),canActivate:[(()=>{class G{constructor(S,H){this.authService=S,this.route=H}canActivate(S,H){return this.authService.validarToken().pipe((0,sn.b)(me=>"ADMIN"===this.authService.rol||(this.route.navigateByUrl("/dashboard/inicio"),!1)))}}return G.\u0275fac=function(S){return new(S||G)(N.LFG(Ll.e),N.LFG(Ys.F0))},G.\u0275prov=N.Yz7({token:G,factory:G.\u0275fac,providedIn:"root"}),G})()]}],li=[{path:"error",loadChildren:()=>fe.e(517).then(fe.bind(fe,6517)).then(G=>G.ErrorModule),canActivate:[Xt]},{path:"auth",loadChildren:()=>fe.e(955).then(fe.bind(fe,6955)).then(G=>G.AuthModule),canActivate:[(()=>{class G{constructor(S){this.authService=S}canActivate(S,H){return this.authService.validarToken().subscribe(me=>{console.log(me)}),!0}}return G.\u0275fac=function(S){return new(S||G)(N.LFG(Ll.e))},G.\u0275prov=N.Yz7({token:G,factory:G.\u0275fac,providedIn:"root"}),G})()]}];var Un=fe(3464);const Ai=function(G){return{"nav-collapsed":G}},gi=function(G){return{show:G}},vr=[{path:"",redirectTo:"dashboard/inicio",pathMatch:"full"},{path:"inicio-sin-logeo",component:(()=>{class G{constructor(S,H){this.sidebarservice=S,this.router=H}toggleSidebar(){this.sidebarservice.setSidebarState(!this.sidebarservice.getSidebarState())}getSideBarState(){return this.sidebarservice.getSidebarState()}hideSidebar(){this.sidebarservice.setSidebarState(!0)}ngOnInit(){this.router.events.subscribe(S=>{S instanceof Ys.m2&&window.scrollTo(0,0)})}}return G.\u0275fac=function(S){return new(S||G)(N.Y36(ec),N.Y36(Ys.F0))},G.\u0275cmp=N.Xpm({type:G,selectors:[["app-inicio-sin-logeo"]],decls:10,vars:6,consts:[[1,"wrapper",3,"ngClass"],[1,"page-wrapper"],[1,"page-content-wrapper"],[1,"page-content"],[1,"overlay",3,"ngClass","click"]],template:function(S,H){1&S&&(N.TgZ(0,"div",0),N._UZ(1,"app-sidebar")(2,"app-navbar"),N.TgZ(3,"div",1)(4,"div",2)(5,"div",3),N._UZ(6,"app-mapabox"),N.TgZ(7,"div",4),N.NdJ("click",function(){return H.toggleSidebar()}),N.qZA()()()(),N._UZ(8,"app-footer"),N.qZA(),N._UZ(9,"app-color-switcher")),2&S&&(N.Q6J("ngClass",N.VKq(2,Ai,H.getSideBarState())),N.xp6(7),N.Q6J("ngClass",N.VKq(4,gi,H.getSideBarState())))},directives:[D.mk,Z,pe,Un.W,De,Mt],styles:[""]}),G})()},{path:"",component:Ct,data:{title:"full Views"},children:di},{path:"",component:Vt,data:{title:"content Views"},children:li},{path:"**",redirectTo:"dashboard/inicio"}];let jr=(()=>{class G{}return G.\u0275fac=function(S){return new(S||G)},G.\u0275mod=N.oAB({type:G}),G.\u0275inj=N.cJS({imports:[[Ys.Bz.forRoot(vr,{preloadingStrategy:Ys.wm,useHash:!0})],Ys.Bz]}),G})(),mo=(()=>{class G{}return G.\u0275fac=function(S){return new(S||G)},G.\u0275cmp=N.Xpm({type:G,selectors:[["app-root"]],decls:1,vars:0,template:function(S,H){1&S&&N._UZ(0,"router-outlet")},directives:[Ys.lC],styles:[""]}),G})();var tr=fe(9131);const Kr={suppressScrollX:!0,wheelPropagation:!1};let Ro=(()=>{class G{}return G.\u0275fac=function(S){return new(S||G)},G.\u0275mod=N.oAB({type:G,bootstrap:[mo]}),G.\u0275inj=N.cJS({providers:[{provide:tc.op,useValue:Kr},Ku.e],imports:[[Zr,Qh,vc.IJ,Ga.JF,vc.IJ,jr,Hs.m,tc.Xd,tr.DashboardModule]]}),G})();var Es=fe(2340);fe(9898).accessToken=Es.N.mapboxToken,Es.N.production&&(0,N.G48)(),nr().bootstrapModule(Ro).catch(G=>console.error(G))},8259:function(Bi,Zt){var D;!function(N,A){"use strict";"object"==typeof Bi.exports?Bi.exports=N.document?A(N,!0):function(l){if(!l.document)throw new Error("jQuery requires a window with a document");return A(l)}:A(N)}("undefined"!=typeof window?window:this,function(N,A){"use strict";var l=[],oe=Object.getPrototypeOf,lt=l.slice,At=l.flat?function(I){return l.flat.call(I)}:function(I){return l.concat.apply([],I)},Ke=l.push,ct=l.indexOf,_t={},Nt=_t.toString,wt=_t.hasOwnProperty,Bt=wt.toString,st=Bt.call(Object),at={},ft=function(V){return"function"==typeof V&&"number"!=typeof V.nodeType&&"function"!=typeof V.item},tn=function(V){return null!=V&&V===V.window},kt=N.document,dn={type:!0,src:!0,nonce:!0,noModule:!0};function Qn(I,V,ne){var ce,Ee,Ae=(ne=ne||kt).createElement("script");if(Ae.text=I,V)for(ce in dn)(Ee=V[ce]||V.getAttribute&&V.getAttribute(ce))&&Ae.setAttribute(ce,Ee);ne.head.appendChild(Ae).parentNode.removeChild(Ae)}function on(I){return null==I?I+"":"object"==typeof I||"function"==typeof I?_t[Nt.call(I)]||"object":typeof I}var se=function(I,V){return new se.fn.init(I,V)};function Wi(I){var V=!!I&&"length"in I&&I.length,ne=on(I);return!ft(I)&&!tn(I)&&("array"===ne||0===V||"number"==typeof V&&V>0&&V-1 in I)}se.fn=se.prototype={jquery:"3.6.1",constructor:se,length:0,toArray:function(){return lt.call(this)},get:function(I){return null==I?lt.call(this):I<0?this[I+this.length]:this[I]},pushStack:function(I){var V=se.merge(this.constructor(),I);return V.prevObject=this,V},each:function(I){return se.each(this,I)},map:function(I){return this.pushStack(se.map(this,function(V,ne){return I.call(V,ne,V)}))},slice:function(){return this.pushStack(lt.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(se.grep(this,function(I,V){return(V+1)%2}))},odd:function(){return this.pushStack(se.grep(this,function(I,V){return V%2}))},eq:function(I){var V=this.length,ne=+I+(I<0?V:0);return this.pushStack(ne>=0&&ne<V?[this[ne]]:[])},end:function(){return this.prevObject||this.constructor()},push:Ke,sort:l.sort,splice:l.splice},se.extend=se.fn.extend=function(){var I,V,ne,ce,Ee,Ae,Le=arguments[0]||{},Y=1,le=arguments.length,ee=!1;for("boolean"==typeof Le&&(ee=Le,Le=arguments[Y]||{},Y++),"object"!=typeof Le&&!ft(Le)&&(Le={}),Y===le&&(Le=this,Y--);Y<le;Y++)if(null!=(I=arguments[Y]))for(V in I)ce=I[V],"__proto__"!==V&&Le!==ce&&(ee&&ce&&(se.isPlainObject(ce)||(Ee=Array.isArray(ce)))?(ne=Le[V],Ae=Ee&&!Array.isArray(ne)?[]:Ee||se.isPlainObject(ne)?ne:{},Ee=!1,Le[V]=se.extend(ee,Ae,ce)):void 0!==ce&&(Le[V]=ce));return Le},se.extend({expando:"jQuery"+("3.6.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(I){throw new Error(I)},noop:function(){},isPlainObject:function(I){var V,ne;return!(!I||"[object Object]"!==Nt.call(I)||(V=oe(I))&&("function"!=typeof(ne=wt.call(V,"constructor")&&V.constructor)||Bt.call(ne)!==st))},isEmptyObject:function(I){var V;for(V in I)return!1;return!0},globalEval:function(I,V,ne){Qn(I,{nonce:V&&V.nonce},ne)},each:function(I,V){var ne,ce=0;if(Wi(I))for(ne=I.length;ce<ne&&!1!==V.call(I[ce],ce,I[ce]);ce++);else for(ce in I)if(!1===V.call(I[ce],ce,I[ce]))break;return I},makeArray:function(I,V){var ne=V||[];return null!=I&&(Wi(Object(I))?se.merge(ne,"string"==typeof I?[I]:I):Ke.call(ne,I)),ne},inArray:function(I,V,ne){return null==V?-1:ct.call(V,I,ne)},merge:function(I,V){for(var ne=+V.length,ce=0,Ee=I.length;ce<ne;ce++)I[Ee++]=V[ce];return I.length=Ee,I},grep:function(I,V,ne){for(var Ee=[],Ae=0,Le=I.length,Y=!ne;Ae<Le;Ae++)!V(I[Ae],Ae)!==Y&&Ee.push(I[Ae]);return Ee},map:function(I,V,ne){var ce,Ee,Ae=0,Le=[];if(Wi(I))for(ce=I.length;Ae<ce;Ae++)null!=(Ee=V(I[Ae],Ae,ne))&&Le.push(Ee);else for(Ae in I)null!=(Ee=V(I[Ae],Ae,ne))&&Le.push(Ee);return At(Le)},guid:1,support:at}),"function"==typeof Symbol&&(se.fn[Symbol.iterator]=l[Symbol.iterator]),se.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(I,V){_t["[object "+V+"]"]=V.toLowerCase()});var ii=function(I){var V,ne,ce,Ee,Ae,Le,Y,le,ee,be,je,Ye,mt,On,Ui,wn,er,ji,Lr,Zi="sizzle"+1*new Date,bi=I.document,ge=0,he=0,ae=Fa(),Re=Fa(),gn=Fa(),xi=Fa(),vi=function(Ue,gt){return Ue===gt&&(je=!0),0},Jo={}.hasOwnProperty,ms=[],bs=ms.pop,No=ms.push,xs=ms.push,ka=ms.slice,ta=function(Ue,gt){for(var Ut=0,vn=Ue.length;Ut<vn;Ut++)if(Ue[Ut]===gt)return Ut;return-1},Hn="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ki="[\\x20\\t\\r\\n\\f]",Go="(?:\\\\[\\da-fA-F]{1,6}"+ki+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",os="\\["+ki+"*("+Go+")(?:"+ki+"*([*^$|!~]?=)"+ki+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+Go+"))|)"+ki+"*\\]",Na=":("+Go+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+os+")*)|.*)\\)|)",La=new RegExp(ki+"+","g"),Qo=new RegExp("^"+ki+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ki+"+$","g"),yl=new RegExp("^"+ki+"*,"+ki+"*"),Ua=new RegExp("^"+ki+"*([>+~]|"+ki+")"+ki+"*"),hl=new RegExp(ki+"|>"),Ya=new RegExp(Na),Ma=new RegExp("^"+Go+"$"),Ws={ID:new RegExp("^#("+Go+")"),CLASS:new RegExp("^\\.("+Go+")"),TAG:new RegExp("^("+Go+"|[*])"),ATTR:new RegExp("^"+os),PSEUDO:new RegExp("^"+Na),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ki+"*(even|odd|(([+-]|)(\\d*)n|)"+ki+"*(?:([+-]|)"+ki+"*(\\d+)|))"+ki+"*\\)|)","i"),bool:new RegExp("^(?:"+Hn+")$","i"),needsContext:new RegExp("^"+ki+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ki+"*((?:-\\d)?\\d*)"+ki+"*\\)|)(?=[^-]|$)","i")},ss=/HTML$/i,ba=/^(?:input|select|textarea|button)$/i,Ka=/^h\d$/i,xa=/^[^{]+\{\s*\[native \w/,gs=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,vl=/[+~]/,Is=new RegExp("\\\\[\\da-fA-F]{1,6}"+ki+"?|\\\\([^\\r\\n\\f])","g"),wa=function(Ue,gt){var Ut="0x"+Ue.slice(1)-65536;return gt||(Ut<0?String.fromCharCode(Ut+65536):String.fromCharCode(Ut>>10|55296,1023&Ut|56320))},_s=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,Va=function(Ue,gt){return gt?"\0"===Ue?"\ufffd":Ue.slice(0,-1)+"\\"+Ue.charCodeAt(Ue.length-1).toString(16)+" ":"\\"+Ue},Ia=function(){Ye()},bl=bo(function(Ue){return!0===Ue.disabled&&"fieldset"===Ue.nodeName.toLowerCase()},{dir:"parentNode",next:"legend"});try{xs.apply(ms=ka.call(bi.childNodes),bi.childNodes)}catch(Ue){xs={apply:ms.length?function(gt,Ut){No.apply(gt,ka.call(Ut))}:function(gt,Ut){for(var vn=gt.length,Wt=0;gt[vn++]=Ut[Wt++];);gt.length=vn-1}}}function io(Ue,gt,Ut,vn){var Wt,Bn,Vn,ai,Ii,pr,Ni,cr=gt&&gt.ownerDocument,yr=gt?gt.nodeType:9;if(Ut=Ut||[],"string"!=typeof Ue||!Ue||1!==yr&&9!==yr&&11!==yr)return Ut;if(!vn&&(Ye(gt),gt=gt||mt,Ui)){if(11!==yr&&(Ii=gs.exec(Ue)))if(Wt=Ii[1]){if(9===yr){if(!(Vn=gt.getElementById(Wt)))return Ut;if(Vn.id===Wt)return Ut.push(Vn),Ut}else if(cr&&(Vn=cr.getElementById(Wt))&&Lr(gt,Vn)&&Vn.id===Wt)return Ut.push(Vn),Ut}else{if(Ii[2])return xs.apply(Ut,gt.getElementsByTagName(Ue)),Ut;if((Wt=Ii[3])&&ne.getElementsByClassName&&gt.getElementsByClassName)return xs.apply(Ut,gt.getElementsByClassName(Wt)),Ut}if(ne.qsa&&!xi[Ue+" "]&&(!wn||!wn.test(Ue))&&(1!==yr||"object"!==gt.nodeName.toLowerCase())){if(Ni=Ue,cr=gt,1===yr&&(hl.test(Ue)||Ua.test(Ue))){for(((cr=vl.test(Ue)&&Ba(gt.parentNode)||gt)!==gt||!ne.scope)&&((ai=gt.getAttribute("id"))?ai=ai.replace(_s,Va):gt.setAttribute("id",ai=Zi)),Bn=(pr=Le(Ue)).length;Bn--;)pr[Bn]=(ai?"#"+ai:":scope")+" "+ts(pr[Bn]);Ni=pr.join(",")}try{return xs.apply(Ut,cr.querySelectorAll(Ni)),Ut}catch(q){xi(Ue,!0)}finally{ai===Zi&&gt.removeAttribute("id")}}}return le(Ue.replace(Qo,"$1"),gt,Ut,vn)}function Fa(){var Ue=[];return function gt(Ut,vn){return Ue.push(Ut+" ")>ce.cacheLength&&delete gt[Ue.shift()],gt[Ut+" "]=vn}}function Ns(Ue){return Ue[Zi]=!0,Ue}function es(Ue){var gt=mt.createElement("fieldset");try{return!!Ue(gt)}catch(Ut){return!1}finally{gt.parentNode&&gt.parentNode.removeChild(gt),gt=null}}function Xa(Ue,gt){for(var Ut=Ue.split("|"),vn=Ut.length;vn--;)ce.attrHandle[Ut[vn]]=gt}function xl(Ue,gt){var Ut=gt&&Ue,vn=Ut&&1===Ue.nodeType&&1===gt.nodeType&&Ue.sourceIndex-gt.sourceIndex;if(vn)return vn;if(Ut)for(;Ut=Ut.nextSibling;)if(Ut===gt)return-1;return Ue?1:-1}function Ol(Ue){return function(gt){return"input"===gt.nodeName.toLowerCase()&&gt.type===Ue}}function nl(Ue){return function(gt){var Ut=gt.nodeName.toLowerCase();return("input"===Ut||"button"===Ut)&&gt.type===Ue}}function Pa(Ue){return function(gt){return"form"in gt?gt.parentNode&&!1===gt.disabled?"label"in gt?"label"in gt.parentNode?gt.parentNode.disabled===Ue:gt.disabled===Ue:gt.isDisabled===Ue||gt.isDisabled!==!Ue&&bl(gt)===Ue:gt.disabled===Ue:"label"in gt&&gt.disabled===Ue}}function Ps(Ue){return Ns(function(gt){return gt=+gt,Ns(function(Ut,vn){for(var Wt,Bn=Ue([],Ut.length,gt),Vn=Bn.length;Vn--;)Ut[Wt=Bn[Vn]]&&(Ut[Wt]=!(vn[Wt]=Ut[Wt]))})})}function Ba(Ue){return Ue&&void 0!==Ue.getElementsByTagName&&Ue}for(V in ne=io.support={},Ae=io.isXML=function(Ue){var Ut=Ue&&(Ue.ownerDocument||Ue).documentElement;return!ss.test(Ue&&Ue.namespaceURI||Ut&&Ut.nodeName||"HTML")},Ye=io.setDocument=function(Ue){var gt,Ut,vn=Ue?Ue.ownerDocument||Ue:bi;return vn==mt||9!==vn.nodeType||!vn.documentElement||(On=(mt=vn).documentElement,Ui=!Ae(mt),bi!=mt&&(Ut=mt.defaultView)&&Ut.top!==Ut&&(Ut.addEventListener?Ut.addEventListener("unload",Ia,!1):Ut.attachEvent&&Ut.attachEvent("onunload",Ia)),ne.scope=es(function(Wt){return On.appendChild(Wt).appendChild(mt.createElement("div")),void 0!==Wt.querySelectorAll&&!Wt.querySelectorAll(":scope fieldset div").length}),ne.attributes=es(function(Wt){return Wt.className="i",!Wt.getAttribute("className")}),ne.getElementsByTagName=es(function(Wt){return Wt.appendChild(mt.createComment("")),!Wt.getElementsByTagName("*").length}),ne.getElementsByClassName=xa.test(mt.getElementsByClassName),ne.getById=es(function(Wt){return On.appendChild(Wt).id=Zi,!mt.getElementsByName||!mt.getElementsByName(Zi).length}),ne.getById?(ce.filter.ID=function(Wt){var Bn=Wt.replace(Is,wa);return function(Vn){return Vn.getAttribute("id")===Bn}},ce.find.ID=function(Wt,Bn){if(void 0!==Bn.getElementById&&Ui){var Vn=Bn.getElementById(Wt);return Vn?[Vn]:[]}}):(ce.filter.ID=function(Wt){var Bn=Wt.replace(Is,wa);return function(Vn){var ai=void 0!==Vn.getAttributeNode&&Vn.getAttributeNode("id");return ai&&ai.value===Bn}},ce.find.ID=function(Wt,Bn){if(void 0!==Bn.getElementById&&Ui){var Vn,ai,Ii,pr=Bn.getElementById(Wt);if(pr){if((Vn=pr.getAttributeNode("id"))&&Vn.value===Wt)return[pr];for(Ii=Bn.getElementsByName(Wt),ai=0;pr=Ii[ai++];)if((Vn=pr.getAttributeNode("id"))&&Vn.value===Wt)return[pr]}return[]}}),ce.find.TAG=ne.getElementsByTagName?function(Wt,Bn){return void 0!==Bn.getElementsByTagName?Bn.getElementsByTagName(Wt):ne.qsa?Bn.querySelectorAll(Wt):void 0}:function(Wt,Bn){var Vn,ai=[],Ii=0,pr=Bn.getElementsByTagName(Wt);if("*"===Wt){for(;Vn=pr[Ii++];)1===Vn.nodeType&&ai.push(Vn);return ai}return pr},ce.find.CLASS=ne.getElementsByClassName&&function(Wt,Bn){if(void 0!==Bn.getElementsByClassName&&Ui)return Bn.getElementsByClassName(Wt)},er=[],wn=[],(ne.qsa=xa.test(mt.querySelectorAll))&&(es(function(Wt){var Bn;On.appendChild(Wt).innerHTML="<a id='"+Zi+"'></a><select id='"+Zi+"-\r\\' msallowcapture=''><option selected=''></option></select>",Wt.querySelectorAll("[msallowcapture^='']").length&&wn.push("[*^$]="+ki+"*(?:''|\"\")"),Wt.querySelectorAll("[selected]").length||wn.push("\\["+ki+"*(?:value|"+Hn+")"),Wt.querySelectorAll("[id~="+Zi+"-]").length||wn.push("~="),(Bn=mt.createElement("input")).setAttribute("name",""),Wt.appendChild(Bn),Wt.querySelectorAll("[name='']").length||wn.push("\\["+ki+"*name"+ki+"*="+ki+"*(?:''|\"\")"),Wt.querySelectorAll(":checked").length||wn.push(":checked"),Wt.querySelectorAll("a#"+Zi+"+*").length||wn.push(".#.+[+~]"),Wt.querySelectorAll("\\\f"),wn.push("[\\r\\n\\f]")}),es(function(Wt){Wt.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var Bn=mt.createElement("input");Bn.setAttribute("type","hidden"),Wt.appendChild(Bn).setAttribute("name","D"),Wt.querySelectorAll("[name=d]").length&&wn.push("name"+ki+"*[*^$|!~]?="),2!==Wt.querySelectorAll(":enabled").length&&wn.push(":enabled",":disabled"),On.appendChild(Wt).disabled=!0,2!==Wt.querySelectorAll(":disabled").length&&wn.push(":enabled",":disabled"),Wt.querySelectorAll("*,:x"),wn.push(",.*:")})),(ne.matchesSelector=xa.test(ji=On.matches||On.webkitMatchesSelector||On.mozMatchesSelector||On.oMatchesSelector||On.msMatchesSelector))&&es(function(Wt){ne.disconnectedMatch=ji.call(Wt,"*"),ji.call(Wt,"[s!='']:x"),er.push("!=",Na)}),wn=wn.length&&new RegExp(wn.join("|")),er=er.length&&new RegExp(er.join("|")),gt=xa.test(On.compareDocumentPosition),Lr=gt||xa.test(On.contains)?function(Wt,Bn){var Vn=9===Wt.nodeType?Wt.documentElement:Wt,ai=Bn&&Bn.parentNode;return Wt===ai||!(!ai||1!==ai.nodeType||!(Vn.contains?Vn.contains(ai):Wt.compareDocumentPosition&&16&Wt.compareDocumentPosition(ai)))}:function(Wt,Bn){if(Bn)for(;Bn=Bn.parentNode;)if(Bn===Wt)return!0;return!1},vi=gt?function(Wt,Bn){if(Wt===Bn)return je=!0,0;var Vn=!Wt.compareDocumentPosition-!Bn.compareDocumentPosition;return Vn||(1&(Vn=(Wt.ownerDocument||Wt)==(Bn.ownerDocument||Bn)?Wt.compareDocumentPosition(Bn):1)||!ne.sortDetached&&Bn.compareDocumentPosition(Wt)===Vn?Wt==mt||Wt.ownerDocument==bi&&Lr(bi,Wt)?-1:Bn==mt||Bn.ownerDocument==bi&&Lr(bi,Bn)?1:be?ta(be,Wt)-ta(be,Bn):0:4&Vn?-1:1)}:function(Wt,Bn){if(Wt===Bn)return je=!0,0;var Vn,ai=0,Ii=Wt.parentNode,pr=Bn.parentNode,Ni=[Wt],cr=[Bn];if(!Ii||!pr)return Wt==mt?-1:Bn==mt?1:Ii?-1:pr?1:be?ta(be,Wt)-ta(be,Bn):0;if(Ii===pr)return xl(Wt,Bn);for(Vn=Wt;Vn=Vn.parentNode;)Ni.unshift(Vn);for(Vn=Bn;Vn=Vn.parentNode;)cr.unshift(Vn);for(;Ni[ai]===cr[ai];)ai++;return ai?xl(Ni[ai],cr[ai]):Ni[ai]==bi?-1:cr[ai]==bi?1:0}),mt},io.matches=function(Ue,gt){return io(Ue,null,null,gt)},io.matchesSelector=function(Ue,gt){if(Ye(Ue),ne.matchesSelector&&Ui&&!xi[gt+" "]&&(!er||!er.test(gt))&&(!wn||!wn.test(gt)))try{var Ut=ji.call(Ue,gt);if(Ut||ne.disconnectedMatch||Ue.document&&11!==Ue.document.nodeType)return Ut}catch(vn){xi(gt,!0)}return io(gt,mt,null,[Ue]).length>0},io.contains=function(Ue,gt){return(Ue.ownerDocument||Ue)!=mt&&Ye(Ue),Lr(Ue,gt)},io.attr=function(Ue,gt){(Ue.ownerDocument||Ue)!=mt&&Ye(Ue);var Ut=ce.attrHandle[gt.toLowerCase()],vn=Ut&&Jo.call(ce.attrHandle,gt.toLowerCase())?Ut(Ue,gt,!Ui):void 0;return void 0!==vn?vn:ne.attributes||!Ui?Ue.getAttribute(gt):(vn=Ue.getAttributeNode(gt))&&vn.specified?vn.value:null},io.escape=function(Ue){return(Ue+"").replace(_s,Va)},io.error=function(Ue){throw new Error("Syntax error, unrecognized expression: "+Ue)},io.uniqueSort=function(Ue){var gt,Ut=[],vn=0,Wt=0;if(je=!ne.detectDuplicates,be=!ne.sortStable&&Ue.slice(0),Ue.sort(vi),je){for(;gt=Ue[Wt++];)gt===Ue[Wt]&&(vn=Ut.push(Wt));for(;vn--;)Ue.splice(Ut[vn],1)}return be=null,Ue},Ee=io.getText=function(Ue){var gt,Ut="",vn=0,Wt=Ue.nodeType;if(Wt){if(1===Wt||9===Wt||11===Wt){if("string"==typeof Ue.textContent)return Ue.textContent;for(Ue=Ue.firstChild;Ue;Ue=Ue.nextSibling)Ut+=Ee(Ue)}else if(3===Wt||4===Wt)return Ue.nodeValue}else for(;gt=Ue[vn++];)Ut+=Ee(gt);return Ut},(ce=io.selectors={cacheLength:50,createPseudo:Ns,match:Ws,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(Ue){return Ue[1]=Ue[1].replace(Is,wa),Ue[3]=(Ue[3]||Ue[4]||Ue[5]||"").replace(Is,wa),"~="===Ue[2]&&(Ue[3]=" "+Ue[3]+" "),Ue.slice(0,4)},CHILD:function(Ue){return Ue[1]=Ue[1].toLowerCase(),"nth"===Ue[1].slice(0,3)?(Ue[3]||io.error(Ue[0]),Ue[4]=+(Ue[4]?Ue[5]+(Ue[6]||1):2*("even"===Ue[3]||"odd"===Ue[3])),Ue[5]=+(Ue[7]+Ue[8]||"odd"===Ue[3])):Ue[3]&&io.error(Ue[0]),Ue},PSEUDO:function(Ue){var gt,Ut=!Ue[6]&&Ue[2];return Ws.CHILD.test(Ue[0])?null:(Ue[3]?Ue[2]=Ue[4]||Ue[5]||"":Ut&&Ya.test(Ut)&&(gt=Le(Ut,!0))&&(gt=Ut.indexOf(")",Ut.length-gt)-Ut.length)&&(Ue[0]=Ue[0].slice(0,gt),Ue[2]=Ut.slice(0,gt)),Ue.slice(0,3))}},filter:{TAG:function(Ue){var gt=Ue.replace(Is,wa).toLowerCase();return"*"===Ue?function(){return!0}:function(Ut){return Ut.nodeName&&Ut.nodeName.toLowerCase()===gt}},CLASS:function(Ue){var gt=ae[Ue+" "];return gt||(gt=new RegExp("(^|"+ki+")"+Ue+"("+ki+"|$)"))&&ae(Ue,function(Ut){return gt.test("string"==typeof Ut.className&&Ut.className||void 0!==Ut.getAttribute&&Ut.getAttribute("class")||"")})},ATTR:function(Ue,gt,Ut){return function(vn){var Wt=io.attr(vn,Ue);return null==Wt?"!="===gt:!gt||(Wt+="","="===gt?Wt===Ut:"!="===gt?Wt!==Ut:"^="===gt?Ut&&0===Wt.indexOf(Ut):"*="===gt?Ut&&Wt.indexOf(Ut)>-1:"$="===gt?Ut&&Wt.slice(-Ut.length)===Ut:"~="===gt?(" "+Wt.replace(La," ")+" ").indexOf(Ut)>-1:"|="===gt&&(Wt===Ut||Wt.slice(0,Ut.length+1)===Ut+"-"))}},CHILD:function(Ue,gt,Ut,vn,Wt){var Bn="nth"!==Ue.slice(0,3),Vn="last"!==Ue.slice(-4),ai="of-type"===gt;return 1===vn&&0===Wt?function(Ii){return!!Ii.parentNode}:function(Ii,pr,Ni){var cr,yr,q,J,Ie,ut,pn=Bn!==Vn?"nextSibling":"previousSibling",Jn=Ii.parentNode,xo=ai&&Ii.nodeName.toLowerCase(),Ts=!Ni&&!ai,Hr=!1;if(Jn){if(Bn){for(;pn;){for(J=Ii;J=J[pn];)if(ai?J.nodeName.toLowerCase()===xo:1===J.nodeType)return!1;ut=pn="only"===Ue&&!ut&&"nextSibling"}return!0}if(ut=[Vn?Jn.firstChild:Jn.lastChild],Vn&&Ts){for(Hr=(Ie=(cr=(yr=(q=(J=Jn)[Zi]||(J[Zi]={}))[J.uniqueID]||(q[J.uniqueID]={}))[Ue]||[])[0]===ge&&cr[1])&&cr[2],J=Ie&&Jn.childNodes[Ie];J=++Ie&&J&&J[pn]||(Hr=Ie=0)||ut.pop();)if(1===J.nodeType&&++Hr&&J===Ii){yr[Ue]=[ge,Ie,Hr];break}}else if(Ts&&(Hr=Ie=(cr=(yr=(q=(J=Ii)[Zi]||(J[Zi]={}))[J.uniqueID]||(q[J.uniqueID]={}))[Ue]||[])[0]===ge&&cr[1]),!1===Hr)for(;(J=++Ie&&J&&J[pn]||(Hr=Ie=0)||ut.pop())&&((ai?J.nodeName.toLowerCase()!==xo:1!==J.nodeType)||!++Hr||(Ts&&((yr=(q=J[Zi]||(J[Zi]={}))[J.uniqueID]||(q[J.uniqueID]={}))[Ue]=[ge,Hr]),J!==Ii)););return(Hr-=Wt)===vn||Hr%vn==0&&Hr/vn>=0}}},PSEUDO:function(Ue,gt){var Ut,vn=ce.pseudos[Ue]||ce.setFilters[Ue.toLowerCase()]||io.error("unsupported pseudo: "+Ue);return vn[Zi]?vn(gt):vn.length>1?(Ut=[Ue,Ue,"",gt],ce.setFilters.hasOwnProperty(Ue.toLowerCase())?Ns(function(Wt,Bn){for(var Vn,ai=vn(Wt,gt),Ii=ai.length;Ii--;)Wt[Vn=ta(Wt,ai[Ii])]=!(Bn[Vn]=ai[Ii])}):function(Wt){return vn(Wt,0,Ut)}):vn}},pseudos:{not:Ns(function(Ue){var gt=[],Ut=[],vn=Y(Ue.replace(Qo,"$1"));return vn[Zi]?Ns(function(Wt,Bn,Vn,ai){for(var Ii,pr=vn(Wt,null,ai,[]),Ni=Wt.length;Ni--;)(Ii=pr[Ni])&&(Wt[Ni]=!(Bn[Ni]=Ii))}):function(Wt,Bn,Vn){return gt[0]=Wt,vn(gt,null,Vn,Ut),gt[0]=null,!Ut.pop()}}),has:Ns(function(Ue){return function(gt){return io(Ue,gt).length>0}}),contains:Ns(function(Ue){return Ue=Ue.replace(Is,wa),function(gt){return(gt.textContent||Ee(gt)).indexOf(Ue)>-1}}),lang:Ns(function(Ue){return Ma.test(Ue||"")||io.error("unsupported lang: "+Ue),Ue=Ue.replace(Is,wa).toLowerCase(),function(gt){var Ut;do{if(Ut=Ui?gt.lang:gt.getAttribute("xml:lang")||gt.getAttribute("lang"))return(Ut=Ut.toLowerCase())===Ue||0===Ut.indexOf(Ue+"-")}while((gt=gt.parentNode)&&1===gt.nodeType);return!1}}),target:function(Ue){var gt=I.location&&I.location.hash;return gt&&gt.slice(1)===Ue.id},root:function(Ue){return Ue===On},focus:function(Ue){return Ue===mt.activeElement&&(!mt.hasFocus||mt.hasFocus())&&!!(Ue.type||Ue.href||~Ue.tabIndex)},enabled:Pa(!1),disabled:Pa(!0),checked:function(Ue){var gt=Ue.nodeName.toLowerCase();return"input"===gt&&!!Ue.checked||"option"===gt&&!!Ue.selected},selected:function(Ue){return!0===Ue.selected},empty:function(Ue){for(Ue=Ue.firstChild;Ue;Ue=Ue.nextSibling)if(Ue.nodeType<6)return!1;return!0},parent:function(Ue){return!ce.pseudos.empty(Ue)},header:function(Ue){return Ka.test(Ue.nodeName)},input:function(Ue){return ba.test(Ue.nodeName)},button:function(Ue){var gt=Ue.nodeName.toLowerCase();return"input"===gt&&"button"===Ue.type||"button"===gt},text:function(Ue){var gt;return"input"===Ue.nodeName.toLowerCase()&&"text"===Ue.type&&(null==(gt=Ue.getAttribute("type"))||"text"===gt.toLowerCase())},first:Ps(function(){return[0]}),last:Ps(function(Ue,gt){return[gt-1]}),eq:Ps(function(Ue,gt,Ut){return[Ut<0?Ut+gt:Ut]}),even:Ps(function(Ue,gt){for(var Ut=0;Ut<gt;Ut+=2)Ue.push(Ut);return Ue}),odd:Ps(function(Ue,gt){for(var Ut=1;Ut<gt;Ut+=2)Ue.push(Ut);return Ue}),lt:Ps(function(Ue,gt,Ut){for(var vn=Ut<0?Ut+gt:Ut>gt?gt:Ut;--vn>=0;)Ue.push(vn);return Ue}),gt:Ps(function(Ue,gt,Ut){for(var vn=Ut<0?Ut+gt:Ut;++vn<gt;)Ue.push(vn);return Ue})}}).pseudos.nth=ce.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})ce.pseudos[V]=Ol(V);for(V in{submit:!0,reset:!0})ce.pseudos[V]=nl(V);function ws(){}function ts(Ue){for(var gt=0,Ut=Ue.length,vn="";gt<Ut;gt++)vn+=Ue[gt].value;return vn}function bo(Ue,gt,Ut){var vn=gt.dir,Wt=gt.next,Bn=Wt||vn,Vn=Ut&&"parentNode"===Bn,ai=he++;return gt.first?function(Ii,pr,Ni){for(;Ii=Ii[vn];)if(1===Ii.nodeType||Vn)return Ue(Ii,pr,Ni);return!1}:function(Ii,pr,Ni){var cr,yr,q,J=[ge,ai];if(Ni){for(;Ii=Ii[vn];)if((1===Ii.nodeType||Vn)&&Ue(Ii,pr,Ni))return!0}else for(;Ii=Ii[vn];)if(1===Ii.nodeType||Vn)if(yr=(q=Ii[Zi]||(Ii[Zi]={}))[Ii.uniqueID]||(q[Ii.uniqueID]={}),Wt&&Wt===Ii.nodeName.toLowerCase())Ii=Ii[vn]||Ii;else{if((cr=yr[Bn])&&cr[0]===ge&&cr[1]===ai)return J[2]=cr[2];if(yr[Bn]=J,J[2]=Ue(Ii,pr,Ni))return!0}return!1}}function fa(Ue){return Ue.length>1?function(gt,Ut,vn){for(var Wt=Ue.length;Wt--;)if(!Ue[Wt](gt,Ut,vn))return!1;return!0}:Ue[0]}function Cr(Ue,gt,Ut,vn,Wt){for(var Bn,Vn=[],ai=0,Ii=Ue.length,pr=null!=gt;ai<Ii;ai++)(Bn=Ue[ai])&&(!Ut||Ut(Bn,vn,Wt))&&(Vn.push(Bn),pr&&gt.push(ai));return Vn}function ja(Ue,gt,Ut,vn,Wt,Bn){return vn&&!vn[Zi]&&(vn=ja(vn)),Wt&&!Wt[Zi]&&(Wt=ja(Wt,Bn)),Ns(function(Vn,ai,Ii,pr){var Ni,cr,yr,q=[],J=[],Ie=ai.length,ut=Vn||function wl(Ue,gt,Ut){for(var vn=0,Wt=gt.length;vn<Wt;vn++)io(Ue,gt[vn],Ut);return Ut}(gt||"*",Ii.nodeType?[Ii]:Ii,[]),pn=!Ue||!Vn&&gt?ut:Cr(ut,q,Ue,Ii,pr),Jn=Ut?Wt||(Vn?Ue:Ie||vn)?[]:ai:pn;if(Ut&&Ut(pn,Jn,Ii,pr),vn)for(Ni=Cr(Jn,J),vn(Ni,[],Ii,pr),cr=Ni.length;cr--;)(yr=Ni[cr])&&(Jn[J[cr]]=!(pn[J[cr]]=yr));if(Vn){if(Wt||Ue){if(Wt){for(Ni=[],cr=Jn.length;cr--;)(yr=Jn[cr])&&Ni.push(pn[cr]=yr);Wt(null,Jn=[],Ni,pr)}for(cr=Jn.length;cr--;)(yr=Jn[cr])&&(Ni=Wt?ta(Vn,yr):q[cr])>-1&&(Vn[Ni]=!(ai[Ni]=yr))}}else Jn=Cr(Jn===ai?Jn.splice(Ie,Jn.length):Jn),Wt?Wt(null,ai,Jn,pr):xs.apply(ai,Jn)})}function Rl(Ue){for(var gt,Ut,vn,Wt=Ue.length,Bn=ce.relative[Ue[0].type],Vn=Bn||ce.relative[" "],ai=Bn?1:0,Ii=bo(function(cr){return cr===gt},Vn,!0),pr=bo(function(cr){return ta(gt,cr)>-1},Vn,!0),Ni=[function(cr,yr,q){var J=!Bn&&(q||yr!==ee)||((gt=yr).nodeType?Ii(cr,yr,q):pr(cr,yr,q));return gt=null,J}];ai<Wt;ai++)if(Ut=ce.relative[Ue[ai].type])Ni=[bo(fa(Ni),Ut)];else{if((Ut=ce.filter[Ue[ai].type].apply(null,Ue[ai].matches))[Zi]){for(vn=++ai;vn<Wt&&!ce.relative[Ue[vn].type];vn++);return ja(ai>1&&fa(Ni),ai>1&&ts(Ue.slice(0,ai-1).concat({value:" "===Ue[ai-2].type?"*":""})).replace(Qo,"$1"),Ut,ai<vn&&Rl(Ue.slice(ai,vn)),vn<Wt&&Rl(Ue=Ue.slice(vn)),vn<Wt&&ts(Ue))}Ni.push(Ut)}return fa(Ni)}return ws.prototype=ce.filters=ce.pseudos,ce.setFilters=new ws,Le=io.tokenize=function(Ue,gt){var Ut,vn,Wt,Bn,Vn,ai,Ii,pr=Re[Ue+" "];if(pr)return gt?0:pr.slice(0);for(Vn=Ue,ai=[],Ii=ce.preFilter;Vn;){for(Bn in(!Ut||(vn=yl.exec(Vn)))&&(vn&&(Vn=Vn.slice(vn[0].length)||Vn),ai.push(Wt=[])),Ut=!1,(vn=Ua.exec(Vn))&&(Ut=vn.shift(),Wt.push({value:Ut,type:vn[0].replace(Qo," ")}),Vn=Vn.slice(Ut.length)),ce.filter)(vn=Ws[Bn].exec(Vn))&&(!Ii[Bn]||(vn=Ii[Bn](vn)))&&(Ut=vn.shift(),Wt.push({value:Ut,type:Bn,matches:vn}),Vn=Vn.slice(Ut.length));if(!Ut)break}return gt?Vn.length:Vn?io.error(Ue):Re(Ue,ai).slice(0)},Y=io.compile=function(Ue,gt){var Ut,vn=[],Wt=[],Bn=gn[Ue+" "];if(!Bn){for(gt||(gt=Le(Ue)),Ut=gt.length;Ut--;)(Bn=Rl(gt[Ut]))[Zi]?vn.push(Bn):Wt.push(Bn);Bn=gn(Ue,function Za(Ue,gt){var Ut=gt.length>0,vn=Ue.length>0,Wt=function(Bn,Vn,ai,Ii,pr){var Ni,cr,yr,q=0,J="0",Ie=Bn&&[],ut=[],pn=ee,Jn=Bn||vn&&ce.find.TAG("*",pr),xo=ge+=null==pn?1:Math.random()||.1,Ts=Jn.length;for(pr&&(ee=Vn==mt||Vn||pr);J!==Ts&&null!=(Ni=Jn[J]);J++){if(vn&&Ni){for(cr=0,!Vn&&Ni.ownerDocument!=mt&&(Ye(Ni),ai=!Ui);yr=Ue[cr++];)if(yr(Ni,Vn||mt,ai)){Ii.push(Ni);break}pr&&(ge=xo)}Ut&&((Ni=!yr&&Ni)&&q--,Bn&&Ie.push(Ni))}if(q+=J,Ut&&J!==q){for(cr=0;yr=gt[cr++];)yr(Ie,ut,Vn,ai);if(Bn){if(q>0)for(;J--;)Ie[J]||ut[J]||(ut[J]=bs.call(Ii));ut=Cr(ut)}xs.apply(Ii,ut),pr&&!Bn&&ut.length>0&&q+gt.length>1&&io.uniqueSort(Ii)}return pr&&(ge=xo,ee=pn),Ie};return Ut?Ns(Wt):Wt}(Wt,vn)),Bn.selector=Ue}return Bn},le=io.select=function(Ue,gt,Ut,vn){var Wt,Bn,Vn,ai,Ii,pr="function"==typeof Ue&&Ue,Ni=!vn&&Le(Ue=pr.selector||Ue);if(Ut=Ut||[],1===Ni.length){if((Bn=Ni[0]=Ni[0].slice(0)).length>2&&"ID"===(Vn=Bn[0]).type&&9===gt.nodeType&&Ui&&ce.relative[Bn[1].type]){if(!(gt=(ce.find.ID(Vn.matches[0].replace(Is,wa),gt)||[])[0]))return Ut;pr&&(gt=gt.parentNode),Ue=Ue.slice(Bn.shift().value.length)}for(Wt=Ws.needsContext.test(Ue)?0:Bn.length;Wt--&&!ce.relative[ai=(Vn=Bn[Wt]).type];)if((Ii=ce.find[ai])&&(vn=Ii(Vn.matches[0].replace(Is,wa),vl.test(Bn[0].type)&&Ba(gt.parentNode)||gt))){if(Bn.splice(Wt,1),!(Ue=vn.length&&ts(Bn)))return xs.apply(Ut,vn),Ut;break}}return(pr||Y(Ue,Ni))(vn,gt,!Ui,Ut,!gt||vl.test(Ue)&&Ba(gt.parentNode)||gt),Ut},ne.sortStable=Zi.split("").sort(vi).join("")===Zi,ne.detectDuplicates=!!je,Ye(),ne.sortDetached=es(function(Ue){return 1&Ue.compareDocumentPosition(mt.createElement("fieldset"))}),es(function(Ue){return Ue.innerHTML="<a href='#'></a>","#"===Ue.firstChild.getAttribute("href")})||Xa("type|href|height|width",function(Ue,gt,Ut){if(!Ut)return Ue.getAttribute(gt,"type"===gt.toLowerCase()?1:2)}),(!ne.attributes||!es(function(Ue){return Ue.innerHTML="<input/>",Ue.firstChild.setAttribute("value",""),""===Ue.firstChild.getAttribute("value")}))&&Xa("value",function(Ue,gt,Ut){if(!Ut&&"input"===Ue.nodeName.toLowerCase())return Ue.defaultValue}),es(function(Ue){return null==Ue.getAttribute("disabled")})||Xa(Hn,function(Ue,gt,Ut){var vn;if(!Ut)return!0===Ue[gt]?gt.toLowerCase():(vn=Ue.getAttributeNode(gt))&&vn.specified?vn.value:null}),io}(N);se.find=ii,se.expr=ii.selectors,se.expr[":"]=se.expr.pseudos,se.uniqueSort=se.unique=ii.uniqueSort,se.text=ii.getText,se.isXMLDoc=ii.isXML,se.contains=ii.contains,se.escapeSelector=ii.escape;var kn=function(I,V,ne){for(var ce=[],Ee=void 0!==ne;(I=I[V])&&9!==I.nodeType;)if(1===I.nodeType){if(Ee&&se(I).is(ne))break;ce.push(I)}return ce},Ci=function(I,V){for(var ne=[];I;I=I.nextSibling)1===I.nodeType&&I!==V&&ne.push(I);return ne},Jt=se.expr.match.needsContext;function $t(I,V){return I.nodeName&&I.nodeName.toLowerCase()===V.toLowerCase()}var en=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function an(I,V,ne){return ft(V)?se.grep(I,function(ce,Ee){return!!V.call(ce,Ee,ce)!==ne}):V.nodeType?se.grep(I,function(ce){return ce===V!==ne}):"string"!=typeof V?se.grep(I,function(ce){return ct.call(V,ce)>-1!==ne}):se.filter(V,I,ne)}se.filter=function(I,V,ne){var ce=V[0];return ne&&(I=":not("+I+")"),1===V.length&&1===ce.nodeType?se.find.matchesSelector(ce,I)?[ce]:[]:se.find.matches(I,se.grep(V,function(Ee){return 1===Ee.nodeType}))},se.fn.extend({find:function(I){var V,ne,ce=this.length,Ee=this;if("string"!=typeof I)return this.pushStack(se(I).filter(function(){for(V=0;V<ce;V++)if(se.contains(Ee[V],this))return!0}));for(ne=this.pushStack([]),V=0;V<ce;V++)se.find(I,Ee[V],ne);return ce>1?se.uniqueSort(ne):ne},filter:function(I){return this.pushStack(an(this,I||[],!1))},not:function(I){return this.pushStack(an(this,I||[],!0))},is:function(I){return!!an(this,"string"==typeof I&&Jt.test(I)?se(I):I||[],!1).length}});var Yt,An=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,Sn=se.fn.init=function(I,V,ne){var ce,Ee;if(!I)return this;if(ne=ne||Yt,"string"==typeof I){if(!(ce="<"===I[0]&&">"===I[I.length-1]&&I.length>=3?[null,I,null]:An.exec(I))||!ce[1]&&V)return!V||V.jquery?(V||ne).find(I):this.constructor(V).find(I);if(ce[1]){if(se.merge(this,se.parseHTML(ce[1],(V=V instanceof se?V[0]:V)&&V.nodeType?V.ownerDocument||V:kt,!0)),en.test(ce[1])&&se.isPlainObject(V))for(ce in V)ft(this[ce])?this[ce](V[ce]):this.attr(ce,V[ce]);return this}return(Ee=kt.getElementById(ce[2]))&&(this[0]=Ee,this.length=1),this}return I.nodeType?(this[0]=I,this.length=1,this):ft(I)?void 0!==ne.ready?ne.ready(I):I(se):se.makeArray(I,this)};Sn.prototype=se.fn,Yt=se(kt);var Mi=/^(?:parents|prev(?:Until|All))/,mr={children:!0,contents:!0,next:!0,prev:!0};function wi(I,V){for(;(I=I[V])&&1!==I.nodeType;);return I}se.fn.extend({has:function(I){var V=se(I,this),ne=V.length;return this.filter(function(){for(var ce=0;ce<ne;ce++)if(se.contains(this,V[ce]))return!0})},closest:function(I,V){var ne,ce=0,Ee=this.length,Ae=[],Le="string"!=typeof I&&se(I);if(!Jt.test(I))for(;ce<Ee;ce++)for(ne=this[ce];ne&&ne!==V;ne=ne.parentNode)if(ne.nodeType<11&&(Le?Le.index(ne)>-1:1===ne.nodeType&&se.find.matchesSelector(ne,I))){Ae.push(ne);break}return this.pushStack(Ae.length>1?se.uniqueSort(Ae):Ae)},index:function(I){return I?"string"==typeof I?ct.call(se(I),this[0]):ct.call(this,I.jquery?I[0]:I):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(I,V){return this.pushStack(se.uniqueSort(se.merge(this.get(),se(I,V))))},addBack:function(I){return this.add(null==I?this.prevObject:this.prevObject.filter(I))}}),se.each({parent:function(I){var V=I.parentNode;return V&&11!==V.nodeType?V:null},parents:function(I){return kn(I,"parentNode")},parentsUntil:function(I,V,ne){return kn(I,"parentNode",ne)},next:function(I){return wi(I,"nextSibling")},prev:function(I){return wi(I,"previousSibling")},nextAll:function(I){return kn(I,"nextSibling")},prevAll:function(I){return kn(I,"previousSibling")},nextUntil:function(I,V,ne){return kn(I,"nextSibling",ne)},prevUntil:function(I,V,ne){return kn(I,"previousSibling",ne)},siblings:function(I){return Ci((I.parentNode||{}).firstChild,I)},children:function(I){return Ci(I.firstChild)},contents:function(I){return null!=I.contentDocument&&oe(I.contentDocument)?I.contentDocument:($t(I,"template")&&(I=I.content||I),se.merge([],I.childNodes))}},function(I,V){se.fn[I]=function(ne,ce){var Ee=se.map(this,V,ne);return"Until"!==I.slice(-5)&&(ce=ne),ce&&"string"==typeof ce&&(Ee=se.filter(ce,Ee)),this.length>1&&(mr[I]||se.uniqueSort(Ee),Mi.test(I)&&Ee.reverse()),this.pushStack(Ee)}});var _i=/[^\x20\t\r\n\f]+/g;function ui(I){return I}function Ti(I){throw I}function Br(I,V,ne,ce){var Ee;try{I&&ft(Ee=I.promise)?Ee.call(I).done(V).fail(ne):I&&ft(Ee=I.then)?Ee.call(I,V,ne):V.apply(void 0,[I].slice(ce))}catch(Ae){ne.apply(void 0,[Ae])}}se.Callbacks=function(I){I="string"==typeof I?function Ki(I){var V={};return se.each(I.match(_i)||[],function(ne,ce){V[ce]=!0}),V}(I):se.extend({},I);var V,ne,ce,Ee,Ae=[],Le=[],Y=-1,le=function(){for(Ee=Ee||I.once,ce=V=!0;Le.length;Y=-1)for(ne=Le.shift();++Y<Ae.length;)!1===Ae[Y].apply(ne[0],ne[1])&&I.stopOnFalse&&(Y=Ae.length,ne=!1);I.memory||(ne=!1),V=!1,Ee&&(Ae=ne?[]:"")},ee={add:function(){return Ae&&(ne&&!V&&(Y=Ae.length-1,Le.push(ne)),function be(je){se.each(je,function(Ye,mt){ft(mt)?(!I.unique||!ee.has(mt))&&Ae.push(mt):mt&&mt.length&&"string"!==on(mt)&&be(mt)})}(arguments),ne&&!V&&le()),this},remove:function(){return se.each(arguments,function(be,je){for(var Ye;(Ye=se.inArray(je,Ae,Ye))>-1;)Ae.splice(Ye,1),Ye<=Y&&Y--}),this},has:function(be){return be?se.inArray(be,Ae)>-1:Ae.length>0},empty:function(){return Ae&&(Ae=[]),this},disable:function(){return Ee=Le=[],Ae=ne="",this},disabled:function(){return!Ae},lock:function(){return Ee=Le=[],!ne&&!V&&(Ae=ne=""),this},locked:function(){return!!Ee},fireWith:function(be,je){return Ee||(je=[be,(je=je||[]).slice?je.slice():je],Le.push(je),V||le()),this},fire:function(){return ee.fireWith(this,arguments),this},fired:function(){return!!ce}};return ee},se.extend({Deferred:function(I){var V=[["notify","progress",se.Callbacks("memory"),se.Callbacks("memory"),2],["resolve","done",se.Callbacks("once memory"),se.Callbacks("once memory"),0,"resolved"],["reject","fail",se.Callbacks("once memory"),se.Callbacks("once memory"),1,"rejected"]],ne="pending",ce={state:function(){return ne},always:function(){return Ee.done(arguments).fail(arguments),this},catch:function(Ae){return ce.then(null,Ae)},pipe:function(){var Ae=arguments;return se.Deferred(function(Le){se.each(V,function(Y,le){var ee=ft(Ae[le[4]])&&Ae[le[4]];Ee[le[1]](function(){var be=ee&&ee.apply(this,arguments);be&&ft(be.promise)?be.promise().progress(Le.notify).done(Le.resolve).fail(Le.reject):Le[le[0]+"With"](this,ee?[be]:arguments)})}),Ae=null}).promise()},then:function(Ae,Le,Y){var le=0;function ee(be,je,Ye,mt){return function(){var On=this,Ui=arguments,wn=function(){var ji,Lr;if(!(be<le)){if((ji=Ye.apply(On,Ui))===je.promise())throw new TypeError("Thenable self-resolution");ft(Lr=ji&&("object"==typeof ji||"function"==typeof ji)&&ji.then)?mt?Lr.call(ji,ee(le,je,ui,mt),ee(le,je,Ti,mt)):(le++,Lr.call(ji,ee(le,je,ui,mt),ee(le,je,Ti,mt),ee(le,je,ui,je.notifyWith))):(Ye!==ui&&(On=void 0,Ui=[ji]),(mt||je.resolveWith)(On,Ui))}},er=mt?wn:function(){try{wn()}catch(ji){se.Deferred.exceptionHook&&se.Deferred.exceptionHook(ji,er.stackTrace),be+1>=le&&(Ye!==Ti&&(On=void 0,Ui=[ji]),je.rejectWith(On,Ui))}};be?er():(se.Deferred.getStackHook&&(er.stackTrace=se.Deferred.getStackHook()),N.setTimeout(er))}}return se.Deferred(function(be){V[0][3].add(ee(0,be,ft(Y)?Y:ui,be.notifyWith)),V[1][3].add(ee(0,be,ft(Ae)?Ae:ui)),V[2][3].add(ee(0,be,ft(Le)?Le:Ti))}).promise()},promise:function(Ae){return null!=Ae?se.extend(Ae,ce):ce}},Ee={};return se.each(V,function(Ae,Le){var Y=Le[2],le=Le[5];ce[Le[1]]=Y.add,le&&Y.add(function(){ne=le},V[3-Ae][2].disable,V[3-Ae][3].disable,V[0][2].lock,V[0][3].lock),Y.add(Le[3].fire),Ee[Le[0]]=function(){return Ee[Le[0]+"With"](this===Ee?void 0:this,arguments),this},Ee[Le[0]+"With"]=Y.fireWith}),ce.promise(Ee),I&&I.call(Ee,Ee),Ee},when:function(I){var V=arguments.length,ne=V,ce=Array(ne),Ee=lt.call(arguments),Ae=se.Deferred(),Le=function(Y){return function(le){ce[Y]=this,Ee[Y]=arguments.length>1?lt.call(arguments):le,--V||Ae.resolveWith(ce,Ee)}};if(V<=1&&(Br(I,Ae.done(Le(ne)).resolve,Ae.reject,!V),"pending"===Ae.state()||ft(Ee[ne]&&Ee[ne].then)))return Ae.then();for(;ne--;)Br(Ee[ne],Le(ne),Ae.reject);return Ae.promise()}});var yn=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;se.Deferred.exceptionHook=function(I,V){N.console&&N.console.warn&&I&&yn.test(I.name)&&N.console.warn("jQuery.Deferred exception: "+I.message,I.stack,V)},se.readyException=function(I){N.setTimeout(function(){throw I})};var oi=se.Deferred();function Tt(){kt.removeEventListener("DOMContentLoaded",Tt),N.removeEventListener("load",Tt),se.ready()}se.fn.ready=function(I){return oi.then(I).catch(function(V){se.readyException(V)}),this},se.extend({isReady:!1,readyWait:1,ready:function(I){(!0===I?--se.readyWait:se.isReady)||(se.isReady=!0,!(!0!==I&&--se.readyWait>0)&&oi.resolveWith(kt,[se]))}}),se.ready.then=oi.then,"complete"===kt.readyState||"loading"!==kt.readyState&&!kt.documentElement.doScroll?N.setTimeout(se.ready):(kt.addEventListener("DOMContentLoaded",Tt),N.addEventListener("load",Tt));var En=function(I,V,ne,ce,Ee,Ae,Le){var Y=0,le=I.length,ee=null==ne;if("object"===on(ne))for(Y in Ee=!0,ne)En(I,V,Y,ne[Y],!0,Ae,Le);else if(void 0!==ce&&(Ee=!0,ft(ce)||(Le=!0),ee&&(Le?(V.call(I,ce),V=null):(ee=V,V=function(be,je,Ye){return ee.call(se(be),Ye)})),V))for(;Y<le;Y++)V(I[Y],ne,Le?ce:ce.call(I[Y],Y,V(I[Y],ne)));return Ee?I:ee?V.call(I):le?V(I[0],ne):Ae},si=/^-ms-/,fi=/-([a-z])/g;function nr(I,V){return V.toUpperCase()}function Tr(I){return I.replace(si,"ms-").replace(fi,nr)}var Zr=function(I){return 1===I.nodeType||9===I.nodeType||!+I.nodeType};function Ur(){this.expando=se.expando+Ur.uid++}Ur.uid=1,Ur.prototype={cache:function(I){var V=I[this.expando];return V||(V={},Zr(I)&&(I.nodeType?I[this.expando]=V:Object.defineProperty(I,this.expando,{value:V,configurable:!0}))),V},set:function(I,V,ne){var ce,Ee=this.cache(I);if("string"==typeof V)Ee[Tr(V)]=ne;else for(ce in V)Ee[Tr(ce)]=V[ce];return Ee},get:function(I,V){return void 0===V?this.cache(I):I[this.expando]&&I[this.expando][Tr(V)]},access:function(I,V,ne){return void 0===V||V&&"string"==typeof V&&void 0===ne?this.get(I,V):(this.set(I,V,ne),void 0!==ne?ne:V)},remove:function(I,V){var ne,ce=I[this.expando];if(void 0!==ce){if(void 0!==V)for((ne=(V=Array.isArray(V)?V.map(Tr):(V=Tr(V))in ce?[V]:V.match(_i)||[]).length);ne--;)delete ce[V[ne]];(void 0===V||se.isEmptyObject(ce))&&(I.nodeType?I[this.expando]=void 0:delete I[this.expando])}},hasData:function(I){var V=I[this.expando];return void 0!==V&&!se.isEmptyObject(V)}};var Mn=new Ur,yo=new Ur,qr=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,no=/[A-Z]/g;function cs(I,V,ne){var ce;if(void 0===ne&&1===I.nodeType)if(ce="data-"+V.replace(no,"-$&").toLowerCase(),"string"==typeof(ne=I.getAttribute(ce))){try{ne=function dr(I){return"true"===I||"false"!==I&&("null"===I?null:I===+I+""?+I:qr.test(I)?JSON.parse(I):I)}(ne)}catch(Ee){}yo.set(I,V,ne)}else ne=void 0;return ne}se.extend({hasData:function(I){return yo.hasData(I)||Mn.hasData(I)},data:function(I,V,ne){return yo.access(I,V,ne)},removeData:function(I,V){yo.remove(I,V)},_data:function(I,V,ne){return Mn.access(I,V,ne)},_removeData:function(I,V){Mn.remove(I,V)}}),se.fn.extend({data:function(I,V){var ne,ce,Ee,Ae=this[0],Le=Ae&&Ae.attributes;if(void 0===I){if(this.length&&(Ee=yo.get(Ae),1===Ae.nodeType&&!Mn.get(Ae,"hasDataAttrs"))){for(ne=Le.length;ne--;)Le[ne]&&0===(ce=Le[ne].name).indexOf("data-")&&(ce=Tr(ce.slice(5)),cs(Ae,ce,Ee[ce]));Mn.set(Ae,"hasDataAttrs",!0)}return Ee}return"object"==typeof I?this.each(function(){yo.set(this,I)}):En(this,function(Y){var le;if(Ae&&void 0===Y)return void 0!==(le=yo.get(Ae,I))||void 0!==(le=cs(Ae,I))?le:void 0;this.each(function(){yo.set(this,I,Y)})},null,V,arguments.length>1,null,!0)},removeData:function(I){return this.each(function(){yo.remove(this,I)})}}),se.extend({queue:function(I,V,ne){var ce;if(I)return ce=Mn.get(I,V=(V||"fx")+"queue"),ne&&(!ce||Array.isArray(ne)?ce=Mn.access(I,V,se.makeArray(ne)):ce.push(ne)),ce||[]},dequeue:function(I,V){var ne=se.queue(I,V=V||"fx"),ce=ne.length,Ee=ne.shift(),Ae=se._queueHooks(I,V);"inprogress"===Ee&&(Ee=ne.shift(),ce--),Ee&&("fx"===V&&ne.unshift("inprogress"),delete Ae.stop,Ee.call(I,function(){se.dequeue(I,V)},Ae)),!ce&&Ae&&Ae.empty.fire()},_queueHooks:function(I,V){var ne=V+"queueHooks";return Mn.get(I,ne)||Mn.access(I,ne,{empty:se.Callbacks("once memory").add(function(){Mn.remove(I,[V+"queue",ne])})})}}),se.fn.extend({queue:function(I,V){var ne=2;return"string"!=typeof I&&(V=I,I="fx",ne--),arguments.length<ne?se.queue(this[0],I):void 0===V?this:this.each(function(){var ce=se.queue(this,I,V);se._queueHooks(this,I),"fx"===I&&"inprogress"!==ce[0]&&se.dequeue(this,I)})},dequeue:function(I){return this.each(function(){se.dequeue(this,I)})},clearQueue:function(I){return this.queue(I||"fx",[])},promise:function(I,V){var ne,ce=1,Ee=se.Deferred(),Ae=this,Le=this.length,Y=function(){--ce||Ee.resolveWith(Ae,[Ae])};for("string"!=typeof I&&(V=I,I=void 0),I=I||"fx";Le--;)(ne=Mn.get(Ae[Le],I+"queueHooks"))&&ne.empty&&(ce++,ne.empty.add(Y));return Y(),Ee.promise(V)}});var cn=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Ot=new RegExp("^(?:([+-])=|)("+cn+")([a-z%]*)$","i"),Dt=["Top","Right","Bottom","Left"],Nn=kt.documentElement,nn=function(I){return se.contains(I.ownerDocument,I)},jn={composed:!0};Nn.getRootNode&&(nn=function(I){return se.contains(I.ownerDocument,I)||I.getRootNode(jn)===I.ownerDocument});var pi=function(I,V){return"none"===(I=V||I).style.display||""===I.style.display&&nn(I)&&"none"===se.css(I,"display")};function to(I,V,ne,ce){var Ee,Ae,Le=20,Y=ce?function(){return ce.cur()}:function(){return se.css(I,V,"")},le=Y(),ee=ne&&ne[3]||(se.cssNumber[V]?"":"px"),be=I.nodeType&&(se.cssNumber[V]||"px"!==ee&&+le)&&Ot.exec(se.css(I,V));if(be&&be[3]!==ee){for(ee=ee||be[3],be=+(le/=2)||1;Le--;)se.style(I,V,be+ee),(1-Ae)*(1-(Ae=Y()/le||.5))<=0&&(Le=0),be/=Ae;se.style(I,V,(be*=2)+ee),ne=ne||[]}return ne&&(be=+be||+le||0,Ee=ne[1]?be+(ne[1]+1)*ne[2]:+ne[2],ce&&(ce.unit=ee,ce.start=be,ce.end=Ee)),Ee}var Li={};function $r(I){var V,ne=I.ownerDocument,ce=I.nodeName,Ee=Li[ce];return Ee||(V=ne.body.appendChild(ne.createElement(ce)),Ee=se.css(V,"display"),V.parentNode.removeChild(V),"none"===Ee&&(Ee="block"),Li[ce]=Ee,Ee)}function Vr(I,V){for(var ne,ce,Ee=[],Ae=0,Le=I.length;Ae<Le;Ae++)(ce=I[Ae]).style&&(ne=ce.style.display,V?("none"===ne&&(Ee[Ae]=Mn.get(ce,"display")||null,Ee[Ae]||(ce.style.display="")),""===ce.style.display&&pi(ce)&&(Ee[Ae]=$r(ce))):"none"!==ne&&(Ee[Ae]="none",Mn.set(ce,"display",ne)));for(Ae=0;Ae<Le;Ae++)null!=Ee[Ae]&&(I[Ae].style.display=Ee[Ae]);return I}se.fn.extend({show:function(){return Vr(this,!0)},hide:function(){return Vr(this)},toggle:function(I){return"boolean"==typeof I?I?this.show():this.hide():this.each(function(){pi(this)?se(this).show():se(this).hide()})}});var V,ne,fo=/^(?:checkbox|radio)$/i,vo=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,ei=/^$|^module$|\/(?:java|ecma)script/i;V=kt.createDocumentFragment().appendChild(kt.createElement("div")),(ne=kt.createElement("input")).setAttribute("type","radio"),ne.setAttribute("checked","checked"),ne.setAttribute("name","t"),V.appendChild(ne),at.checkClone=V.cloneNode(!0).cloneNode(!0).lastChild.checked,V.innerHTML="<textarea>x</textarea>",at.noCloneChecked=!!V.cloneNode(!0).lastChild.defaultValue,V.innerHTML="<option></option>",at.option=!!V.lastChild;var fr={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function sr(I,V){var ne;return ne=void 0!==I.getElementsByTagName?I.getElementsByTagName(V||"*"):void 0!==I.querySelectorAll?I.querySelectorAll(V||"*"):[],void 0===V||V&&$t(I,V)?se.merge([I],ne):ne}function Io(I,V){for(var ne=0,ce=I.length;ne<ce;ne++)Mn.set(I[ne],"globalEval",!V||Mn.get(V[ne],"globalEval"))}fr.tbody=fr.tfoot=fr.colgroup=fr.caption=fr.thead,fr.th=fr.td,at.option||(fr.optgroup=fr.option=[1,"<select multiple='multiple'>","</select>"]);var ir=/<|&#?\w+;/;function Ao(I,V,ne,ce,Ee){for(var Ae,Le,Y,le,ee,be,je=V.createDocumentFragment(),Ye=[],mt=0,On=I.length;mt<On;mt++)if((Ae=I[mt])||0===Ae)if("object"===on(Ae))se.merge(Ye,Ae.nodeType?[Ae]:Ae);else if(ir.test(Ae)){for(Le=Le||je.appendChild(V.createElement("div")),Y=(vo.exec(Ae)||["",""])[1].toLowerCase(),Le.innerHTML=(le=fr[Y]||fr._default)[1]+se.htmlPrefilter(Ae)+le[2],be=le[0];be--;)Le=Le.lastChild;se.merge(Ye,Le.childNodes),(Le=je.firstChild).textContent=""}else Ye.push(V.createTextNode(Ae));for(je.textContent="",mt=0;Ae=Ye[mt++];)if(ce&&se.inArray(Ae,ce)>-1)Ee&&Ee.push(Ae);else if(ee=nn(Ae),Le=sr(je.appendChild(Ae),"script"),ee&&Io(Le),ne)for(be=0;Ae=Le[be++];)ei.test(Ae.type||"")&&ne.push(Ae);return je}var Zo=/^([^.]*)(?:\.(.+)|)/;function To(){return!0}function Ds(){return!1}function qe(I,V){return I===function Te(){try{return kt.activeElement}catch(I){}}()==("focus"===V)}function Me(I,V,ne,ce,Ee,Ae){var Le,Y;if("object"==typeof V){for(Y in"string"!=typeof ne&&(ce=ce||ne,ne=void 0),V)Me(I,Y,ne,ce,V[Y],Ae);return I}if(null==ce&&null==Ee?(Ee=ne,ce=ne=void 0):null==Ee&&("string"==typeof ne?(Ee=ce,ce=void 0):(Ee=ce,ce=ne,ne=void 0)),!1===Ee)Ee=Ds;else if(!Ee)return I;return 1===Ae&&(Le=Ee,Ee=function(le){return se().off(le),Le.apply(this,arguments)},Ee.guid=Le.guid||(Le.guid=se.guid++)),I.each(function(){se.event.add(this,V,Ee,ce,ne)})}function We(I,V,ne){ne?(Mn.set(I,V,!1),se.event.add(I,V,{namespace:!1,handler:function(ce){var Ee,Ae,Le=Mn.get(this,V);if(1&ce.isTrigger&&this[V]){if(Le.length)(se.event.special[V]||{}).delegateType&&ce.stopPropagation();else if(Le=lt.call(arguments),Mn.set(this,V,Le),Ee=ne(this,V),this[V](),Le!==(Ae=Mn.get(this,V))||Ee?Mn.set(this,V,!1):Ae={},Le!==Ae)return ce.stopImmediatePropagation(),ce.preventDefault(),Ae&&Ae.value}else Le.length&&(Mn.set(this,V,{value:se.event.trigger(se.extend(Le[0],se.Event.prototype),Le.slice(1),this)}),ce.stopImmediatePropagation())}})):void 0===Mn.get(I,V)&&se.event.add(I,V,To)}se.event={global:{},add:function(I,V,ne,ce,Ee){var Ae,Le,Y,le,ee,be,je,Ye,mt,On,Ui,wn=Mn.get(I);if(Zr(I))for(ne.handler&&(ne=(Ae=ne).handler,Ee=Ae.selector),Ee&&se.find.matchesSelector(Nn,Ee),ne.guid||(ne.guid=se.guid++),(le=wn.events)||(le=wn.events=Object.create(null)),(Le=wn.handle)||(Le=wn.handle=function(er){return void 0!==se&&se.event.triggered!==er.type?se.event.dispatch.apply(I,arguments):void 0}),ee=(V=(V||"").match(_i)||[""]).length;ee--;)mt=Ui=(Y=Zo.exec(V[ee])||[])[1],On=(Y[2]||"").split(".").sort(),mt&&(je=se.event.special[mt]||{},je=se.event.special[mt=(Ee?je.delegateType:je.bindType)||mt]||{},be=se.extend({type:mt,origType:Ui,data:ce,handler:ne,guid:ne.guid,selector:Ee,needsContext:Ee&&se.expr.match.needsContext.test(Ee),namespace:On.join(".")},Ae),(Ye=le[mt])||((Ye=le[mt]=[]).delegateCount=0,(!je.setup||!1===je.setup.call(I,ce,On,Le))&&I.addEventListener&&I.addEventListener(mt,Le)),je.add&&(je.add.call(I,be),be.handler.guid||(be.handler.guid=ne.guid)),Ee?Ye.splice(Ye.delegateCount++,0,be):Ye.push(be),se.event.global[mt]=!0)},remove:function(I,V,ne,ce,Ee){var Ae,Le,Y,le,ee,be,je,Ye,mt,On,Ui,wn=Mn.hasData(I)&&Mn.get(I);if(wn&&(le=wn.events)){for(ee=(V=(V||"").match(_i)||[""]).length;ee--;)if(mt=Ui=(Y=Zo.exec(V[ee])||[])[1],On=(Y[2]||"").split(".").sort(),mt){for(je=se.event.special[mt]||{},Ye=le[mt=(ce?je.delegateType:je.bindType)||mt]||[],Y=Y[2]&&new RegExp("(^|\\.)"+On.join("\\.(?:.*\\.|)")+"(\\.|$)"),Le=Ae=Ye.length;Ae--;)be=Ye[Ae],(Ee||Ui===be.origType)&&(!ne||ne.guid===be.guid)&&(!Y||Y.test(be.namespace))&&(!ce||ce===be.selector||"**"===ce&&be.selector)&&(Ye.splice(Ae,1),be.selector&&Ye.delegateCount--,je.remove&&je.remove.call(I,be));Le&&!Ye.length&&((!je.teardown||!1===je.teardown.call(I,On,wn.handle))&&se.removeEvent(I,mt,wn.handle),delete le[mt])}else for(mt in le)se.event.remove(I,mt+V[ee],ne,ce,!0);se.isEmptyObject(le)&&Mn.remove(I,"handle events")}},dispatch:function(I){var V,ne,ce,Ee,Ae,Le,Y=new Array(arguments.length),le=se.event.fix(I),ee=(Mn.get(this,"events")||Object.create(null))[le.type]||[],be=se.event.special[le.type]||{};for(Y[0]=le,V=1;V<arguments.length;V++)Y[V]=arguments[V];if(le.delegateTarget=this,!be.preDispatch||!1!==be.preDispatch.call(this,le)){for(Le=se.event.handlers.call(this,le,ee),V=0;(Ee=Le[V++])&&!le.isPropagationStopped();)for(le.currentTarget=Ee.elem,ne=0;(Ae=Ee.handlers[ne++])&&!le.isImmediatePropagationStopped();)(!le.rnamespace||!1===Ae.namespace||le.rnamespace.test(Ae.namespace))&&(le.handleObj=Ae,le.data=Ae.data,void 0!==(ce=((se.event.special[Ae.origType]||{}).handle||Ae.handler).apply(Ee.elem,Y))&&!1===(le.result=ce)&&(le.preventDefault(),le.stopPropagation()));return be.postDispatch&&be.postDispatch.call(this,le),le.result}},handlers:function(I,V){var ne,ce,Ee,Ae,Le,Y=[],le=V.delegateCount,ee=I.target;if(le&&ee.nodeType&&!("click"===I.type&&I.button>=1))for(;ee!==this;ee=ee.parentNode||this)if(1===ee.nodeType&&("click"!==I.type||!0!==ee.disabled)){for(Ae=[],Le={},ne=0;ne<le;ne++)void 0===Le[Ee=(ce=V[ne]).selector+" "]&&(Le[Ee]=ce.needsContext?se(Ee,this).index(ee)>-1:se.find(Ee,this,null,[ee]).length),Le[Ee]&&Ae.push(ce);Ae.length&&Y.push({elem:ee,handlers:Ae})}return ee=this,le<V.length&&Y.push({elem:ee,handlers:V.slice(le)}),Y},addProp:function(I,V){Object.defineProperty(se.Event.prototype,I,{enumerable:!0,configurable:!0,get:ft(V)?function(){if(this.originalEvent)return V(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[I]},set:function(ne){Object.defineProperty(this,I,{enumerable:!0,configurable:!0,writable:!0,value:ne})}})},fix:function(I){return I[se.expando]?I:new se.Event(I)},special:{load:{noBubble:!0},click:{setup:function(I){var V=this||I;return fo.test(V.type)&&V.click&&$t(V,"input")&&We(V,"click",To),!1},trigger:function(I){var V=this||I;return fo.test(V.type)&&V.click&&$t(V,"input")&&We(V,"click"),!0},_default:function(I){var V=I.target;return fo.test(V.type)&&V.click&&$t(V,"input")&&Mn.get(V,"click")||$t(V,"a")}},beforeunload:{postDispatch:function(I){void 0!==I.result&&I.originalEvent&&(I.originalEvent.returnValue=I.result)}}}},se.removeEvent=function(I,V,ne){I.removeEventListener&&I.removeEventListener(V,ne)},se.Event=function(I,V){if(!(this instanceof se.Event))return new se.Event(I,V);I&&I.type?(this.originalEvent=I,this.type=I.type,this.isDefaultPrevented=I.defaultPrevented||void 0===I.defaultPrevented&&!1===I.returnValue?To:Ds,this.target=I.target&&3===I.target.nodeType?I.target.parentNode:I.target,this.currentTarget=I.currentTarget,this.relatedTarget=I.relatedTarget):this.type=I,V&&se.extend(this,V),this.timeStamp=I&&I.timeStamp||Date.now(),this[se.expando]=!0},se.Event.prototype={constructor:se.Event,isDefaultPrevented:Ds,isPropagationStopped:Ds,isImmediatePropagationStopped:Ds,isSimulated:!1,preventDefault:function(){var I=this.originalEvent;this.isDefaultPrevented=To,I&&!this.isSimulated&&I.preventDefault()},stopPropagation:function(){var I=this.originalEvent;this.isPropagationStopped=To,I&&!this.isSimulated&&I.stopPropagation()},stopImmediatePropagation:function(){var I=this.originalEvent;this.isImmediatePropagationStopped=To,I&&!this.isSimulated&&I.stopImmediatePropagation(),this.stopPropagation()}},se.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},se.event.addProp),se.each({focus:"focusin",blur:"focusout"},function(I,V){se.event.special[I]={setup:function(){return We(this,I,qe),!1},trigger:function(){return We(this,I),!0},_default:function(ne){return Mn.get(ne.target,I)},delegateType:V}}),se.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(I,V){se.event.special[I]={delegateType:V,bindType:V,handle:function(ne){var ce,Ee=this,Ae=ne.relatedTarget,Le=ne.handleObj;return(!Ae||Ae!==Ee&&!se.contains(Ee,Ae))&&(ne.type=Le.origType,ce=Le.handler.apply(this,arguments),ne.type=V),ce}}}),se.fn.extend({on:function(I,V,ne,ce){return Me(this,I,V,ne,ce)},one:function(I,V,ne,ce){return Me(this,I,V,ne,ce,1)},off:function(I,V,ne){var ce,Ee;if(I&&I.preventDefault&&I.handleObj)return ce=I.handleObj,se(I.delegateTarget).off(ce.namespace?ce.origType+"."+ce.namespace:ce.origType,ce.selector,ce.handler),this;if("object"==typeof I){for(Ee in I)this.off(Ee,V,I[Ee]);return this}return(!1===V||"function"==typeof V)&&(ne=V,V=void 0),!1===ne&&(ne=Ds),this.each(function(){se.event.remove(this,I,ne,V)})}});var Xe=/<script|<style|<link/i,xt=/checked\s*(?:[^=]|=\s*.checked.)/i,Gt=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function Rt(I,V){return $t(I,"table")&&$t(11!==V.nodeType?V:V.firstChild,"tr")&&se(I).children("tbody")[0]||I}function nt(I){return I.type=(null!==I.getAttribute("type"))+"/"+I.type,I}function Kt(I){return"true/"===(I.type||"").slice(0,5)?I.type=I.type.slice(5):I.removeAttribute("type"),I}function Dn(I,V){var ne,ce,Ee,Le,Y,le;if(1===V.nodeType){if(Mn.hasData(I)&&(le=Mn.get(I).events))for(Ee in Mn.remove(V,"handle events"),le)for(ne=0,ce=le[Ee].length;ne<ce;ne++)se.event.add(V,Ee,le[Ee][ne]);yo.hasData(I)&&(Le=yo.access(I),Y=se.extend({},Le),yo.set(V,Y))}}function xe(I,V){var ne=V.nodeName.toLowerCase();"input"===ne&&fo.test(I.type)?V.checked=I.checked:("input"===ne||"textarea"===ne)&&(V.defaultValue=I.defaultValue)}function Se(I,V,ne,ce){V=At(V);var Ee,Ae,Le,Y,le,ee,be=0,je=I.length,Ye=je-1,mt=V[0],On=ft(mt);if(On||je>1&&"string"==typeof mt&&!at.checkClone&&xt.test(mt))return I.each(function(Ui){var wn=I.eq(Ui);On&&(V[0]=mt.call(this,Ui,wn.html())),Se(wn,V,ne,ce)});if(je&&(Ae=(Ee=Ao(V,I[0].ownerDocument,!1,I,ce)).firstChild,1===Ee.childNodes.length&&(Ee=Ae),Ae||ce)){for(Y=(Le=se.map(sr(Ee,"script"),nt)).length;be<je;be++)le=Ee,be!==Ye&&(le=se.clone(le,!0,!0),Y&&se.merge(Le,sr(le,"script"))),ne.call(I[be],le,be);if(Y)for(ee=Le[Le.length-1].ownerDocument,se.map(Le,Kt),be=0;be<Y;be++)ei.test((le=Le[be]).type||"")&&!Mn.access(le,"globalEval")&&se.contains(ee,le)&&(le.src&&"module"!==(le.type||"").toLowerCase()?se._evalUrl&&!le.noModule&&se._evalUrl(le.src,{nonce:le.nonce||le.getAttribute("nonce")},ee):Qn(le.textContent.replace(Gt,""),le,ee))}return I}function Be(I,V,ne){for(var ce,Ee=V?se.filter(V,I):I,Ae=0;null!=(ce=Ee[Ae]);Ae++)!ne&&1===ce.nodeType&&se.cleanData(sr(ce)),ce.parentNode&&(ne&&nn(ce)&&Io(sr(ce,"script")),ce.parentNode.removeChild(ce));return I}se.extend({htmlPrefilter:function(I){return I},clone:function(I,V,ne){var ce,Ee,Ae,Le,Y=I.cloneNode(!0),le=nn(I);if(!(at.noCloneChecked||1!==I.nodeType&&11!==I.nodeType||se.isXMLDoc(I)))for(Le=sr(Y),ce=0,Ee=(Ae=sr(I)).length;ce<Ee;ce++)xe(Ae[ce],Le[ce]);if(V)if(ne)for(Ae=Ae||sr(I),Le=Le||sr(Y),ce=0,Ee=Ae.length;ce<Ee;ce++)Dn(Ae[ce],Le[ce]);else Dn(I,Y);return(Le=sr(Y,"script")).length>0&&Io(Le,!le&&sr(I,"script")),Y},cleanData:function(I){for(var V,ne,ce,Ee=se.event.special,Ae=0;void 0!==(ne=I[Ae]);Ae++)if(Zr(ne)){if(V=ne[Mn.expando]){if(V.events)for(ce in V.events)Ee[ce]?se.event.remove(ne,ce):se.removeEvent(ne,ce,V.handle);ne[Mn.expando]=void 0}ne[yo.expando]&&(ne[yo.expando]=void 0)}}}),se.fn.extend({detach:function(I){return Be(this,I,!0)},remove:function(I){return Be(this,I)},text:function(I){return En(this,function(V){return void 0===V?se.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=V)})},null,I,arguments.length)},append:function(){return Se(this,arguments,function(I){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Rt(this,I).appendChild(I)})},prepend:function(){return Se(this,arguments,function(I){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var V=Rt(this,I);V.insertBefore(I,V.firstChild)}})},before:function(){return Se(this,arguments,function(I){this.parentNode&&this.parentNode.insertBefore(I,this)})},after:function(){return Se(this,arguments,function(I){this.parentNode&&this.parentNode.insertBefore(I,this.nextSibling)})},empty:function(){for(var I,V=0;null!=(I=this[V]);V++)1===I.nodeType&&(se.cleanData(sr(I,!1)),I.textContent="");return this},clone:function(I,V){return I=null!=I&&I,V=null==V?I:V,this.map(function(){return se.clone(this,I,V)})},html:function(I){return En(this,function(V){var ne=this[0]||{},ce=0,Ee=this.length;if(void 0===V&&1===ne.nodeType)return ne.innerHTML;if("string"==typeof V&&!Xe.test(V)&&!fr[(vo.exec(V)||["",""])[1].toLowerCase()]){V=se.htmlPrefilter(V);try{for(;ce<Ee;ce++)1===(ne=this[ce]||{}).nodeType&&(se.cleanData(sr(ne,!1)),ne.innerHTML=V);ne=0}catch(Ae){}}ne&&this.empty().append(V)},null,I,arguments.length)},replaceWith:function(){var I=[];return Se(this,arguments,function(V){var ne=this.parentNode;se.inArray(this,I)<0&&(se.cleanData(sr(this)),ne&&ne.replaceChild(V,this))},I)}}),se.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(I,V){se.fn[I]=function(ne){for(var ce,Ee=[],Ae=se(ne),Le=Ae.length-1,Y=0;Y<=Le;Y++)ce=Y===Le?this:this.clone(!0),se(Ae[Y])[V](ce),Ke.apply(Ee,ce.get());return this.pushStack(Ee)}});var dt=new RegExp("^("+cn+")(?!px)[a-z%]+$","i"),Pt=/^--/,rn=function(I){var V=I.ownerDocument.defaultView;return(!V||!V.opener)&&(V=N),V.getComputedStyle(I)},un=function(I,V,ne){var ce,Ee,Ae={};for(Ee in V)Ae[Ee]=I.style[Ee],I.style[Ee]=V[Ee];for(Ee in ce=ne.call(I),V)I.style[Ee]=Ae[Ee];return ce},In=new RegExp(Dt.join("|"),"i"),Pn="[\\x20\\t\\r\\n\\f]",mi=new RegExp("^"+Pn+"+|((?:^|[^\\\\])(?:\\\\.)*)"+Pn+"+$","g");function Xn(I,V,ne){var ce,Ee,Ae,Le,Y=Pt.test(V),le=I.style;return(ne=ne||rn(I))&&(Le=ne.getPropertyValue(V)||ne[V],Y&&(Le=Le.replace(mi,"$1")),""===Le&&!nn(I)&&(Le=se.style(I,V)),!at.pixelBoxStyles()&&dt.test(Le)&&In.test(V)&&(ce=le.width,Ee=le.minWidth,Ae=le.maxWidth,le.minWidth=le.maxWidth=le.width=Le,Le=ne.width,le.width=ce,le.minWidth=Ee,le.maxWidth=Ae)),void 0!==Le?Le+"":Le}function qt(I,V){return{get:function(){if(!I())return(this.get=V).apply(this,arguments);delete this.get}}}!function(){function I(){if(ee){le.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",ee.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",Nn.appendChild(le).appendChild(ee);var be=N.getComputedStyle(ee);ne="1%"!==be.top,Y=12===V(be.marginLeft),ee.style.right="60%",Ae=36===V(be.right),ce=36===V(be.width),ee.style.position="absolute",Ee=12===V(ee.offsetWidth/3),Nn.removeChild(le),ee=null}}function V(be){return Math.round(parseFloat(be))}var ne,ce,Ee,Ae,Le,Y,le=kt.createElement("div"),ee=kt.createElement("div");!ee.style||(ee.style.backgroundClip="content-box",ee.cloneNode(!0).style.backgroundClip="",at.clearCloneStyle="content-box"===ee.style.backgroundClip,se.extend(at,{boxSizingReliable:function(){return I(),ce},pixelBoxStyles:function(){return I(),Ae},pixelPosition:function(){return I(),ne},reliableMarginLeft:function(){return I(),Y},scrollboxSize:function(){return I(),Ee},reliableTrDimensions:function(){var be,je,Ye,mt;return null==Le&&(be=kt.createElement("table"),je=kt.createElement("tr"),Ye=kt.createElement("div"),be.style.cssText="position:absolute;left:-11111px;border-collapse:separate",je.style.cssText="border:1px solid",je.style.height="1px",Ye.style.height="9px",Ye.style.display="block",Nn.appendChild(be).appendChild(je).appendChild(Ye),mt=N.getComputedStyle(je),Le=parseInt(mt.height,10)+parseInt(mt.borderTopWidth,10)+parseInt(mt.borderBottomWidth,10)===je.offsetHeight,Nn.removeChild(be)),Le}}))}();var Gr=["Webkit","Moz","ms"],gr=kt.createElement("div").style,Rn={};function hr(I){return se.cssProps[I]||Rn[I]||(I in gr?I:Rn[I]=function ti(I){for(var V=I[0].toUpperCase()+I.slice(1),ne=Gr.length;ne--;)if((I=Gr[ne]+V)in gr)return I}(I)||I)}var Er=/^(none|table(?!-c[ea]).+)/,Mr={position:"absolute",visibility:"hidden",display:"block"},Nr={letterSpacing:"0",fontWeight:"400"};function Wn(I,V,ne){var ce=Ot.exec(V);return ce?Math.max(0,ce[2]-(ne||0))+(ce[3]||"px"):V}function Fi(I,V,ne,ce,Ee,Ae){var Le="width"===V?1:0,Y=0,le=0;if(ne===(ce?"border":"content"))return 0;for(;Le<4;Le+=2)"margin"===ne&&(le+=se.css(I,ne+Dt[Le],!0,Ee)),ce?("content"===ne&&(le-=se.css(I,"padding"+Dt[Le],!0,Ee)),"margin"!==ne&&(le-=se.css(I,"border"+Dt[Le]+"Width",!0,Ee))):(le+=se.css(I,"padding"+Dt[Le],!0,Ee),"padding"!==ne?le+=se.css(I,"border"+Dt[Le]+"Width",!0,Ee):Y+=se.css(I,"border"+Dt[Le]+"Width",!0,Ee));return!ce&&Ae>=0&&(le+=Math.max(0,Math.ceil(I["offset"+V[0].toUpperCase()+V.slice(1)]-Ae-le-Y-.5))||0),le}function Xi(I,V,ne){var ce=rn(I),Ae=(!at.boxSizingReliable()||ne)&&"border-box"===se.css(I,"boxSizing",!1,ce),Le=Ae,Y=Xn(I,V,ce),le="offset"+V[0].toUpperCase()+V.slice(1);if(dt.test(Y)){if(!ne)return Y;Y="auto"}return(!at.boxSizingReliable()&&Ae||!at.reliableTrDimensions()&&$t(I,"tr")||"auto"===Y||!parseFloat(Y)&&"inline"===se.css(I,"display",!1,ce))&&I.getClientRects().length&&(Ae="border-box"===se.css(I,"boxSizing",!1,ce),(Le=le in I)&&(Y=I[le])),(Y=parseFloat(Y)||0)+Fi(I,V,ne||(Ae?"border":"content"),Le,ce,Y)+"px"}function Gi(I,V,ne,ce,Ee){return new Gi.prototype.init(I,V,ne,ce,Ee)}se.extend({cssHooks:{opacity:{get:function(I,V){if(V){var ne=Xn(I,"opacity");return""===ne?"1":ne}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(I,V,ne,ce){if(I&&3!==I.nodeType&&8!==I.nodeType&&I.style){var Ee,Ae,Le,Y=Tr(V),le=Pt.test(V),ee=I.style;if(le||(V=hr(Y)),Le=se.cssHooks[V]||se.cssHooks[Y],void 0===ne)return Le&&"get"in Le&&void 0!==(Ee=Le.get(I,!1,ce))?Ee:ee[V];if("string"==(Ae=typeof ne)&&(Ee=Ot.exec(ne))&&Ee[1]&&(ne=to(I,V,Ee),Ae="number"),null==ne||ne!=ne)return;"number"===Ae&&!le&&(ne+=Ee&&Ee[3]||(se.cssNumber[Y]?"":"px")),!at.clearCloneStyle&&""===ne&&0===V.indexOf("background")&&(ee[V]="inherit"),(!Le||!("set"in Le)||void 0!==(ne=Le.set(I,ne,ce)))&&(le?ee.setProperty(V,ne):ee[V]=ne)}},css:function(I,V,ne,ce){var Ee,Ae,Le,Y=Tr(V);return Pt.test(V)||(V=hr(Y)),(Le=se.cssHooks[V]||se.cssHooks[Y])&&"get"in Le&&(Ee=Le.get(I,!0,ne)),void 0===Ee&&(Ee=Xn(I,V,ce)),"normal"===Ee&&V in Nr&&(Ee=Nr[V]),""===ne||ne?(Ae=parseFloat(Ee),!0===ne||isFinite(Ae)?Ae||0:Ee):Ee}}),se.each(["height","width"],function(I,V){se.cssHooks[V]={get:function(ne,ce,Ee){if(ce)return!Er.test(se.css(ne,"display"))||ne.getClientRects().length&&ne.getBoundingClientRect().width?Xi(ne,V,Ee):un(ne,Mr,function(){return Xi(ne,V,Ee)})},set:function(ne,ce,Ee){var Ae,Le=rn(ne),Y=!at.scrollboxSize()&&"absolute"===Le.position,ee=(Y||Ee)&&"border-box"===se.css(ne,"boxSizing",!1,Le),be=Ee?Fi(ne,V,Ee,ee,Le):0;return ee&&Y&&(be-=Math.ceil(ne["offset"+V[0].toUpperCase()+V.slice(1)]-parseFloat(Le[V])-Fi(ne,V,"border",!1,Le)-.5)),be&&(Ae=Ot.exec(ce))&&"px"!==(Ae[3]||"px")&&(ne.style[V]=ce,ce=se.css(ne,V)),Wn(0,ce,be)}}}),se.cssHooks.marginLeft=qt(at.reliableMarginLeft,function(I,V){if(V)return(parseFloat(Xn(I,"marginLeft"))||I.getBoundingClientRect().left-un(I,{marginLeft:0},function(){return I.getBoundingClientRect().left}))+"px"}),se.each({margin:"",padding:"",border:"Width"},function(I,V){se.cssHooks[I+V]={expand:function(ne){for(var ce=0,Ee={},Ae="string"==typeof ne?ne.split(" "):[ne];ce<4;ce++)Ee[I+Dt[ce]+V]=Ae[ce]||Ae[ce-2]||Ae[0];return Ee}},"margin"!==I&&(se.cssHooks[I+V].set=Wn)}),se.fn.extend({css:function(I,V){return En(this,function(ne,ce,Ee){var Ae,Le,Y={},le=0;if(Array.isArray(ce)){for(Ae=rn(ne),Le=ce.length;le<Le;le++)Y[ce[le]]=se.css(ne,ce[le],!1,Ae);return Y}return void 0!==Ee?se.style(ne,ce,Ee):se.css(ne,ce)},I,V,arguments.length>1)}}),se.Tween=Gi,(Gi.prototype={constructor:Gi,init:function(I,V,ne,ce,Ee,Ae){this.elem=I,this.prop=ne,this.easing=Ee||se.easing._default,this.options=V,this.start=this.now=this.cur(),this.end=ce,this.unit=Ae||(se.cssNumber[ne]?"":"px")},cur:function(){var I=Gi.propHooks[this.prop];return I&&I.get?I.get(this):Gi.propHooks._default.get(this)},run:function(I){var V,ne=Gi.propHooks[this.prop];return this.pos=V=this.options.duration?se.easing[this.easing](I,this.options.duration*I,0,1,this.options.duration):I,this.now=(this.end-this.start)*V+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),ne&&ne.set?ne.set(this):Gi.propHooks._default.set(this),this}}).init.prototype=Gi.prototype,(Gi.propHooks={_default:{get:function(I){var V;return 1!==I.elem.nodeType||null!=I.elem[I.prop]&&null==I.elem.style[I.prop]?I.elem[I.prop]:(V=se.css(I.elem,I.prop,""))&&"auto"!==V?V:0},set:function(I){se.fx.step[I.prop]?se.fx.step[I.prop](I):1!==I.elem.nodeType||!se.cssHooks[I.prop]&&null==I.elem.style[hr(I.prop)]?I.elem[I.prop]=I.now:se.style(I.elem,I.prop,I.now+I.unit)}}}).scrollTop=Gi.propHooks.scrollLeft={set:function(I){I.elem.nodeType&&I.elem.parentNode&&(I.elem[I.prop]=I.now)}},se.easing={linear:function(I){return I},swing:function(I){return.5-Math.cos(I*Math.PI)/2},_default:"swing"},se.fx=Gi.prototype.init,se.fx.step={};var yi,Ji,Ko=/^(?:toggle|show|hide)$/,us=/queueHooks$/;function Ss(){Ji&&(!1===kt.hidden&&N.requestAnimationFrame?N.requestAnimationFrame(Ss):N.setTimeout(Ss,se.fx.interval),se.fx.tick())}function Hi(){return N.setTimeout(function(){yi=void 0}),yi=Date.now()}function lr(I,V){var ne,ce=0,Ee={height:I};for(V=V?1:0;ce<4;ce+=2-V)Ee["margin"+(ne=Dt[ce])]=Ee["padding"+ne]=I;return V&&(Ee.opacity=Ee.width=I),Ee}function ks(I,V,ne){for(var ce,Ee=(Uo.tweeners[V]||[]).concat(Uo.tweeners["*"]),Ae=0,Le=Ee.length;Ae<Le;Ae++)if(ce=Ee[Ae].call(ne,V,I))return ce}function Uo(I,V,ne){var ce,Ee,Ae=0,Le=Uo.prefilters.length,Y=se.Deferred().always(function(){delete le.elem}),le=function(){if(Ee)return!1;for(var je=yi||Hi(),Ye=Math.max(0,ee.startTime+ee.duration-je),On=1-(Ye/ee.duration||0),Ui=0,wn=ee.tweens.length;Ui<wn;Ui++)ee.tweens[Ui].run(On);return Y.notifyWith(I,[ee,On,Ye]),On<1&&wn?Ye:(wn||Y.notifyWith(I,[ee,1,0]),Y.resolveWith(I,[ee]),!1)},ee=Y.promise({elem:I,props:se.extend({},V),opts:se.extend(!0,{specialEasing:{},easing:se.easing._default},ne),originalProperties:V,originalOptions:ne,startTime:yi||Hi(),duration:ne.duration,tweens:[],createTween:function(je,Ye){var mt=se.Tween(I,ee.opts,je,Ye,ee.opts.specialEasing[je]||ee.opts.easing);return ee.tweens.push(mt),mt},stop:function(je){var Ye=0,mt=je?ee.tweens.length:0;if(Ee)return this;for(Ee=!0;Ye<mt;Ye++)ee.tweens[Ye].run(1);return je?(Y.notifyWith(I,[ee,1,0]),Y.resolveWith(I,[ee,je])):Y.rejectWith(I,[ee,je]),this}}),be=ee.props;for(function Dr(I,V){var ne,ce,Ee,Ae,Le;for(ne in I)if(Ee=V[ce=Tr(ne)],Ae=I[ne],Array.isArray(Ae)&&(Ee=Ae[1],Ae=I[ne]=Ae[0]),ne!==ce&&(I[ce]=Ae,delete I[ne]),(Le=se.cssHooks[ce])&&"expand"in Le)for(ne in Ae=Le.expand(Ae),delete I[ce],Ae)ne in I||(I[ne]=Ae[ne],V[ne]=Ee);else V[ce]=Ee}(be,ee.opts.specialEasing);Ae<Le;Ae++)if(ce=Uo.prefilters[Ae].call(ee,I,be,ee.opts))return ft(ce.stop)&&(se._queueHooks(ee.elem,ee.opts.queue).stop=ce.stop.bind(ce)),ce;return se.map(be,ks,ee),ft(ee.opts.start)&&ee.opts.start.call(I,ee),ee.progress(ee.opts.progress).done(ee.opts.done,ee.opts.complete).fail(ee.opts.fail).always(ee.opts.always),se.fx.timer(se.extend(le,{elem:I,anim:ee,queue:ee.opts.queue})),ee}se.Animation=se.extend(Uo,{tweeners:{"*":[function(I,V){var ne=this.createTween(I,V);return to(ne.elem,I,Ot.exec(V),ne),ne}]},tweener:function(I,V){ft(I)?(V=I,I=["*"]):I=I.match(_i);for(var ne,ce=0,Ee=I.length;ce<Ee;ce++)(Uo.tweeners[ne=I[ce]]=Uo.tweeners[ne]||[]).unshift(V)},prefilters:[function Po(I,V,ne){var ce,Ee,Ae,Le,Y,le,ee,be,je="width"in V||"height"in V,Ye=this,mt={},On=I.style,Ui=I.nodeType&&pi(I),wn=Mn.get(I,"fxshow");for(ce in ne.queue||(null==(Le=se._queueHooks(I,"fx")).unqueued&&(Le.unqueued=0,Y=Le.empty.fire,Le.empty.fire=function(){Le.unqueued||Y()}),Le.unqueued++,Ye.always(function(){Ye.always(function(){Le.unqueued--,se.queue(I,"fx").length||Le.empty.fire()})})),V)if(Ko.test(Ee=V[ce])){if(delete V[ce],Ae=Ae||"toggle"===Ee,Ee===(Ui?"hide":"show")){if("show"!==Ee||!wn||void 0===wn[ce])continue;Ui=!0}mt[ce]=wn&&wn[ce]||se.style(I,ce)}if((le=!se.isEmptyObject(V))||!se.isEmptyObject(mt))for(ce in je&&1===I.nodeType&&(ne.overflow=[On.overflow,On.overflowX,On.overflowY],null==(ee=wn&&wn.display)&&(ee=Mn.get(I,"display")),"none"===(be=se.css(I,"display"))&&(ee?be=ee:(Vr([I],!0),ee=I.style.display||ee,be=se.css(I,"display"),Vr([I]))),("inline"===be||"inline-block"===be&&null!=ee)&&"none"===se.css(I,"float")&&(le||(Ye.done(function(){On.display=ee}),null==ee&&(ee="none"===(be=On.display)?"":be)),On.display="inline-block")),ne.overflow&&(On.overflow="hidden",Ye.always(function(){On.overflow=ne.overflow[0],On.overflowX=ne.overflow[1],On.overflowY=ne.overflow[2]})),le=!1,mt)le||(wn?"hidden"in wn&&(Ui=wn.hidden):wn=Mn.access(I,"fxshow",{display:ee}),Ae&&(wn.hidden=!Ui),Ui&&Vr([I],!0),Ye.done(function(){for(ce in Ui||Vr([I]),Mn.remove(I,"fxshow"),mt)se.style(I,ce,mt[ce])})),le=ks(Ui?wn[ce]:0,ce,Ye),ce in wn||(wn[ce]=le.start,Ui&&(le.end=le.start,le.start=0))}],prefilter:function(I,V){V?Uo.prefilters.unshift(I):Uo.prefilters.push(I)}}),se.speed=function(I,V,ne){var ce=I&&"object"==typeof I?se.extend({},I):{complete:ne||!ne&&V||ft(I)&&I,duration:I,easing:ne&&V||V&&!ft(V)&&V};return se.fx.off?ce.duration=0:"number"!=typeof ce.duration&&(ce.duration=ce.duration in se.fx.speeds?se.fx.speeds[ce.duration]:se.fx.speeds._default),(null==ce.queue||!0===ce.queue)&&(ce.queue="fx"),ce.old=ce.complete,ce.complete=function(){ft(ce.old)&&ce.old.call(this),ce.queue&&se.dequeue(this,ce.queue)},ce},se.fn.extend({fadeTo:function(I,V,ne,ce){return this.filter(pi).css("opacity",0).show().end().animate({opacity:V},I,ne,ce)},animate:function(I,V,ne,ce){var Ee=se.isEmptyObject(I),Ae=se.speed(V,ne,ce),Le=function(){var Y=Uo(this,se.extend({},I),Ae);(Ee||Mn.get(this,"finish"))&&Y.stop(!0)};return Le.finish=Le,Ee||!1===Ae.queue?this.each(Le):this.queue(Ae.queue,Le)},stop:function(I,V,ne){var ce=function(Ee){var Ae=Ee.stop;delete Ee.stop,Ae(ne)};return"string"!=typeof I&&(ne=V,V=I,I=void 0),V&&this.queue(I||"fx",[]),this.each(function(){var Ee=!0,Ae=null!=I&&I+"queueHooks",Le=se.timers,Y=Mn.get(this);if(Ae)Y[Ae]&&Y[Ae].stop&&ce(Y[Ae]);else for(Ae in Y)Y[Ae]&&Y[Ae].stop&&us.test(Ae)&&ce(Y[Ae]);for(Ae=Le.length;Ae--;)Le[Ae].elem===this&&(null==I||Le[Ae].queue===I)&&(Le[Ae].anim.stop(ne),Ee=!1,Le.splice(Ae,1));(Ee||!ne)&&se.dequeue(this,I)})},finish:function(I){return!1!==I&&(I=I||"fx"),this.each(function(){var V,ne=Mn.get(this),ce=ne[I+"queue"],Ee=ne[I+"queueHooks"],Ae=se.timers,Le=ce?ce.length:0;for(ne.finish=!0,se.queue(this,I,[]),Ee&&Ee.stop&&Ee.stop.call(this,!0),V=Ae.length;V--;)Ae[V].elem===this&&Ae[V].queue===I&&(Ae[V].anim.stop(!0),Ae.splice(V,1));for(V=0;V<Le;V++)ce[V]&&ce[V].finish&&ce[V].finish.call(this);delete ne.finish})}}),se.each(["toggle","show","hide"],function(I,V){var ne=se.fn[V];se.fn[V]=function(ce,Ee,Ae){return null==ce||"boolean"==typeof ce?ne.apply(this,arguments):this.animate(lr(V,!0),ce,Ee,Ae)}}),se.each({slideDown:lr("show"),slideUp:lr("hide"),slideToggle:lr("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(I,V){se.fn[I]=function(ne,ce,Ee){return this.animate(V,ne,ce,Ee)}}),se.timers=[],se.fx.tick=function(){var I,V=0,ne=se.timers;for(yi=Date.now();V<ne.length;V++)!(I=ne[V])()&&ne[V]===I&&ne.splice(V--,1);ne.length||se.fx.stop(),yi=void 0},se.fx.timer=function(I){se.timers.push(I),se.fx.start()},se.fx.interval=13,se.fx.start=function(){Ji||(Ji=!0,Ss())},se.fx.stop=function(){Ji=null},se.fx.speeds={slow:600,fast:200,_default:400},se.fn.delay=function(I,V){return I=se.fx&&se.fx.speeds[I]||I,this.queue(V=V||"fx",function(ne,ce){var Ee=N.setTimeout(ne,I);ce.stop=function(){N.clearTimeout(Ee)}})},function(){var I=kt.createElement("input"),ne=kt.createElement("select").appendChild(kt.createElement("option"));I.type="checkbox",at.checkOn=""!==I.value,at.optSelected=ne.selected,(I=kt.createElement("input")).value="t",I.type="radio",at.radioValue="t"===I.value}();var ca,po=se.expr.attrHandle;se.fn.extend({attr:function(I,V){return En(this,se.attr,I,V,arguments.length>1)},removeAttr:function(I){return this.each(function(){se.removeAttr(this,I)})}}),se.extend({attr:function(I,V,ne){var ce,Ee,Ae=I.nodeType;if(3!==Ae&&8!==Ae&&2!==Ae)return void 0===I.getAttribute?se.prop(I,V,ne):((1!==Ae||!se.isXMLDoc(I))&&(Ee=se.attrHooks[V.toLowerCase()]||(se.expr.match.bool.test(V)?ca:void 0)),void 0!==ne?null===ne?void se.removeAttr(I,V):Ee&&"set"in Ee&&void 0!==(ce=Ee.set(I,ne,V))?ce:(I.setAttribute(V,ne+""),ne):Ee&&"get"in Ee&&null!==(ce=Ee.get(I,V))?ce:null==(ce=se.find.attr(I,V))?void 0:ce)},attrHooks:{type:{set:function(I,V){if(!at.radioValue&&"radio"===V&&$t(I,"input")){var ne=I.value;return I.setAttribute("type",V),ne&&(I.value=ne),V}}}},removeAttr:function(I,V){var ne,ce=0,Ee=V&&V.match(_i);if(Ee&&1===I.nodeType)for(;ne=Ee[ce++];)I.removeAttribute(ne)}}),ca={set:function(I,V,ne){return!1===V?se.removeAttr(I,ne):I.setAttribute(ne,ne),ne}},se.each(se.expr.match.bool.source.match(/\w+/g),function(I,V){var ne=po[V]||se.find.attr;po[V]=function(ce,Ee,Ae){var Le,Y,le=Ee.toLowerCase();return Ae||(Y=po[le],po[le]=Le,Le=null!=ne(ce,Ee,Ae)?le:null,po[le]=Y),Le}});var xr=/^(?:input|select|textarea|button)$/i,zr=/^(?:a|area)$/i;function rs(I){return(I.match(_i)||[]).join(" ")}function vs(I){return I.getAttribute&&I.getAttribute("class")||""}function Ir(I){return Array.isArray(I)?I:"string"==typeof I&&I.match(_i)||[]}se.fn.extend({prop:function(I,V){return En(this,se.prop,I,V,arguments.length>1)},removeProp:function(I){return this.each(function(){delete this[se.propFix[I]||I]})}}),se.extend({prop:function(I,V,ne){var ce,Ee,Ae=I.nodeType;if(3!==Ae&&8!==Ae&&2!==Ae)return(1!==Ae||!se.isXMLDoc(I))&&(Ee=se.propHooks[V=se.propFix[V]||V]),void 0!==ne?Ee&&"set"in Ee&&void 0!==(ce=Ee.set(I,ne,V))?ce:I[V]=ne:Ee&&"get"in Ee&&null!==(ce=Ee.get(I,V))?ce:I[V]},propHooks:{tabIndex:{get:function(I){var V=se.find.attr(I,"tabindex");return V?parseInt(V,10):xr.test(I.nodeName)||zr.test(I.nodeName)&&I.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),at.optSelected||(se.propHooks.selected={get:function(I){return null},set:function(I){}}),se.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){se.propFix[this.toLowerCase()]=this}),se.fn.extend({addClass:function(I){var V,ne,ce,Ee,Ae,Le;return ft(I)?this.each(function(Y){se(this).addClass(I.call(this,Y,vs(this)))}):(V=Ir(I)).length?this.each(function(){if(ce=vs(this),ne=1===this.nodeType&&" "+rs(ce)+" "){for(Ae=0;Ae<V.length;Ae++)ne.indexOf(" "+(Ee=V[Ae])+" ")<0&&(ne+=Ee+" ");Le=rs(ne),ce!==Le&&this.setAttribute("class",Le)}}):this},removeClass:function(I){var V,ne,ce,Ee,Ae,Le;return ft(I)?this.each(function(Y){se(this).removeClass(I.call(this,Y,vs(this)))}):arguments.length?(V=Ir(I)).length?this.each(function(){if(ce=vs(this),ne=1===this.nodeType&&" "+rs(ce)+" "){for(Ae=0;Ae<V.length;Ae++)for(Ee=V[Ae];ne.indexOf(" "+Ee+" ")>-1;)ne=ne.replace(" "+Ee+" "," ");Le=rs(ne),ce!==Le&&this.setAttribute("class",Le)}}):this:this.attr("class","")},toggleClass:function(I,V){var ne,ce,Ee,Ae,Le=typeof I,Y="string"===Le||Array.isArray(I);return ft(I)?this.each(function(le){se(this).toggleClass(I.call(this,le,vs(this),V),V)}):"boolean"==typeof V&&Y?V?this.addClass(I):this.removeClass(I):(ne=Ir(I),this.each(function(){if(Y)for(Ae=se(this),Ee=0;Ee<ne.length;Ee++)Ae.hasClass(ce=ne[Ee])?Ae.removeClass(ce):Ae.addClass(ce);else(void 0===I||"boolean"===Le)&&((ce=vs(this))&&Mn.set(this,"__className__",ce),this.setAttribute&&this.setAttribute("class",ce||!1===I?"":Mn.get(this,"__className__")||""))}))},hasClass:function(I){var V,ne,ce=0;for(V=" "+I+" ";ne=this[ce++];)if(1===ne.nodeType&&(" "+rs(vs(ne))+" ").indexOf(V)>-1)return!0;return!1}});var Vo=/\r/g;se.fn.extend({val:function(I){var V,ne,ce,Ee=this[0];return arguments.length?(ce=ft(I),this.each(function(Ae){var Le;1===this.nodeType&&(null==(Le=ce?I.call(this,Ae,se(this).val()):I)?Le="":"number"==typeof Le?Le+="":Array.isArray(Le)&&(Le=se.map(Le,function(Y){return null==Y?"":Y+""})),(!(V=se.valHooks[this.type]||se.valHooks[this.nodeName.toLowerCase()])||!("set"in V)||void 0===V.set(this,Le,"value"))&&(this.value=Le))})):Ee?(V=se.valHooks[Ee.type]||se.valHooks[Ee.nodeName.toLowerCase()])&&"get"in V&&void 0!==(ne=V.get(Ee,"value"))?ne:"string"==typeof(ne=Ee.value)?ne.replace(Vo,""):null==ne?"":ne:void 0}}),se.extend({valHooks:{option:{get:function(I){var V=se.find.attr(I,"value");return null!=V?V:rs(se.text(I))}},select:{get:function(I){var V,ne,ce,Ee=I.options,Ae=I.selectedIndex,Le="select-one"===I.type,Y=Le?null:[],le=Le?Ae+1:Ee.length;for(ce=Ae<0?le:Le?Ae:0;ce<le;ce++)if(((ne=Ee[ce]).selected||ce===Ae)&&!ne.disabled&&(!ne.parentNode.disabled||!$t(ne.parentNode,"optgroup"))){if(V=se(ne).val(),Le)return V;Y.push(V)}return Y},set:function(I,V){for(var ne,ce,Ee=I.options,Ae=se.makeArray(V),Le=Ee.length;Le--;)((ce=Ee[Le]).selected=se.inArray(se.valHooks.option.get(ce),Ae)>-1)&&(ne=!0);return ne||(I.selectedIndex=-1),Ae}}}}),se.each(["radio","checkbox"],function(){se.valHooks[this]={set:function(I,V){if(Array.isArray(V))return I.checked=se.inArray(se(I).val(),V)>-1}},at.checkOn||(se.valHooks[this].get=function(I){return null===I.getAttribute("value")?"on":I.value})}),at.focusin="onfocusin"in N;var ya=/^(?:focusinfocus|focusoutblur)$/,hs=function(I){I.stopPropagation()};se.extend(se.event,{trigger:function(I,V,ne,ce){var Ee,Ae,Le,Y,le,ee,be,je,Ye=[ne||kt],mt=wt.call(I,"type")?I.type:I,On=wt.call(I,"namespace")?I.namespace.split("."):[];if(Ae=je=Le=ne=ne||kt,3!==ne.nodeType&&8!==ne.nodeType&&!ya.test(mt+se.event.triggered)&&(mt.indexOf(".")>-1&&(On=mt.split("."),mt=On.shift(),On.sort()),le=mt.indexOf(":")<0&&"on"+mt,(I=I[se.expando]?I:new se.Event(mt,"object"==typeof I&&I)).isTrigger=ce?2:3,I.namespace=On.join("."),I.rnamespace=I.namespace?new RegExp("(^|\\.)"+On.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,I.result=void 0,I.target||(I.target=ne),V=null==V?[I]:se.makeArray(V,[I]),be=se.event.special[mt]||{},ce||!be.trigger||!1!==be.trigger.apply(ne,V))){if(!ce&&!be.noBubble&&!tn(ne)){for(ya.test((Y=be.delegateType||mt)+mt)||(Ae=Ae.parentNode);Ae;Ae=Ae.parentNode)Ye.push(Ae),Le=Ae;Le===(ne.ownerDocument||kt)&&Ye.push(Le.defaultView||Le.parentWindow||N)}for(Ee=0;(Ae=Ye[Ee++])&&!I.isPropagationStopped();)je=Ae,I.type=Ee>1?Y:be.bindType||mt,(ee=(Mn.get(Ae,"events")||Object.create(null))[I.type]&&Mn.get(Ae,"handle"))&&ee.apply(Ae,V),(ee=le&&Ae[le])&&ee.apply&&Zr(Ae)&&(I.result=ee.apply(Ae,V),!1===I.result&&I.preventDefault());return I.type=mt,!ce&&!I.isDefaultPrevented()&&(!be._default||!1===be._default.apply(Ye.pop(),V))&&Zr(ne)&&le&&ft(ne[mt])&&!tn(ne)&&((Le=ne[le])&&(ne[le]=null),se.event.triggered=mt,I.isPropagationStopped()&&je.addEventListener(mt,hs),ne[mt](),I.isPropagationStopped()&&je.removeEventListener(mt,hs),se.event.triggered=void 0,Le&&(ne[le]=Le)),I.result}},simulate:function(I,V,ne){var ce=se.extend(new se.Event,ne,{type:I,isSimulated:!0});se.event.trigger(ce,null,V)}}),se.fn.extend({trigger:function(I,V){return this.each(function(){se.event.trigger(I,V,this)})},triggerHandler:function(I,V){var ne=this[0];if(ne)return se.event.trigger(I,V,ne,!0)}}),at.focusin||se.each({focus:"focusin",blur:"focusout"},function(I,V){var ne=function(ce){se.event.simulate(V,ce.target,se.event.fix(ce))};se.event.special[V]={setup:function(){var ce=this.ownerDocument||this.document||this,Ee=Mn.access(ce,V);Ee||ce.addEventListener(I,ne,!0),Mn.access(ce,V,(Ee||0)+1)},teardown:function(){var ce=this.ownerDocument||this.document||this,Ee=Mn.access(ce,V)-1;Ee?Mn.access(ce,V,Ee):(ce.removeEventListener(I,ne,!0),Mn.remove(ce,V))}}});var lo=N.location,Qs={guid:Date.now()},va=/\?/;se.parseXML=function(I){var V,ne;if(!I||"string"!=typeof I)return null;try{V=(new N.DOMParser).parseFromString(I,"text/xml")}catch(ce){}return ne=V&&V.getElementsByTagName("parsererror")[0],(!V||ne)&&se.error("Invalid XML: "+(ne?se.map(ne.childNodes,function(ce){return ce.textContent}).join("\n"):I)),V};var ua=/\[\]$/,$o=/\r?\n/g,ha=/^(?:submit|button|image|reset|file)$/i,ul=/^(?:input|select|textarea|keygen)/i;function Qi(I,V,ne,ce){var Ee;if(Array.isArray(V))se.each(V,function(Ae,Le){ne||ua.test(I)?ce(I,Le):Qi(I+"["+("object"==typeof Le&&null!=Le?Ae:"")+"]",Le,ne,ce)});else if(ne||"object"!==on(V))ce(I,V);else for(Ee in V)Qi(I+"["+Ee+"]",V[Ee],ne,ce)}se.param=function(I,V){var ne,ce=[],Ee=function(Ae,Le){var Y=ft(Le)?Le():Le;ce[ce.length]=encodeURIComponent(Ae)+"="+encodeURIComponent(null==Y?"":Y)};if(null==I)return"";if(Array.isArray(I)||I.jquery&&!se.isPlainObject(I))se.each(I,function(){Ee(this.name,this.value)});else for(ne in I)Qi(ne,I[ne],V,Ee);return ce.join("&")},se.fn.extend({serialize:function(){return se.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var I=se.prop(this,"elements");return I?se.makeArray(I):this}).filter(function(){var I=this.type;return this.name&&!se(this).is(":disabled")&&ul.test(this.nodeName)&&!ha.test(I)&&(this.checked||!fo.test(I))}).map(function(I,V){var ne=se(this).val();return null==ne?null:Array.isArray(ne)?se.map(ne,function(ce){return{name:V.name,value:ce.replace($o,"\r\n")}}):{name:V.name,value:ne.replace($o,"\r\n")}}).get()}});var zs=/%20/g,Qr=/#.*$/,da=/([?&])_=[^&]*/,Da=/^(.*?):[ \t]*([^\r\n]*)$/gm,Sa=/^(?:GET|HEAD)$/,qs=/^\/\//,Oo={},Mo={},eo="*/".concat("*"),Xo=kt.createElement("a");function As(I){return function(V,ne){"string"!=typeof V&&(ne=V,V="*");var ce,Ee=0,Ae=V.toLowerCase().match(_i)||[];if(ft(ne))for(;ce=Ae[Ee++];)"+"===ce[0]?(ce=ce.slice(1)||"*",(I[ce]=I[ce]||[]).unshift(ne)):(I[ce]=I[ce]||[]).push(ne)}}function Ms(I,V,ne,ce){var Ee={},Ae=I===Mo;function Le(Y){var le;return Ee[Y]=!0,se.each(I[Y]||[],function(ee,be){var je=be(V,ne,ce);return"string"!=typeof je||Ae||Ee[je]?Ae?!(le=je):void 0:(V.dataTypes.unshift(je),Le(je),!1)}),le}return Le(V.dataTypes[0])||!Ee["*"]&&Le("*")}function Pl(I,V){var ne,ce,Ee=se.ajaxSettings.flatOptions||{};for(ne in V)void 0!==V[ne]&&((Ee[ne]?I:ce||(ce={}))[ne]=V[ne]);return ce&&se.extend(!0,I,ce),I}Xo.href=lo.href,se.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:lo.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(lo.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":eo,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":se.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(I,V){return V?Pl(Pl(I,se.ajaxSettings),V):Pl(se.ajaxSettings,I)},ajaxPrefilter:As(Oo),ajaxTransport:As(Mo),ajax:function(I,V){"object"==typeof I&&(V=I,I=void 0);var ne,ce,Ee,Ae,Le,Y,le,ee,be,je,Ye=se.ajaxSetup({},V=V||{}),mt=Ye.context||Ye,On=Ye.context&&(mt.nodeType||mt.jquery)?se(mt):se.event,Ui=se.Deferred(),wn=se.Callbacks("once memory"),er=Ye.statusCode||{},ji={},Lr={},Zi="canceled",bi={readyState:0,getResponseHeader:function(he){var ae;if(le){if(!Ae)for(Ae={};ae=Da.exec(Ee);)Ae[ae[1].toLowerCase()+" "]=(Ae[ae[1].toLowerCase()+" "]||[]).concat(ae[2]);ae=Ae[he.toLowerCase()+" "]}return null==ae?null:ae.join(", ")},getAllResponseHeaders:function(){return le?Ee:null},setRequestHeader:function(he,ae){return null==le&&(he=Lr[he.toLowerCase()]=Lr[he.toLowerCase()]||he,ji[he]=ae),this},overrideMimeType:function(he){return null==le&&(Ye.mimeType=he),this},statusCode:function(he){var ae;if(he)if(le)bi.always(he[bi.status]);else for(ae in he)er[ae]=[er[ae],he[ae]];return this},abort:function(he){var ae=he||Zi;return ne&&ne.abort(ae),ge(0,ae),this}};if(Ui.promise(bi),Ye.url=((I||Ye.url||lo.href)+"").replace(qs,lo.protocol+"//"),Ye.type=V.method||V.type||Ye.method||Ye.type,Ye.dataTypes=(Ye.dataType||"*").toLowerCase().match(_i)||[""],null==Ye.crossDomain){Y=kt.createElement("a");try{Y.href=Ye.url,Y.href=Y.href,Ye.crossDomain=Xo.protocol+"//"+Xo.host!=Y.protocol+"//"+Y.host}catch(he){Ye.crossDomain=!0}}if(Ye.data&&Ye.processData&&"string"!=typeof Ye.data&&(Ye.data=se.param(Ye.data,Ye.traditional)),Ms(Oo,Ye,V,bi),le)return bi;for(be in(ee=se.event&&Ye.global)&&0==se.active++&&se.event.trigger("ajaxStart"),Ye.type=Ye.type.toUpperCase(),Ye.hasContent=!Sa.test(Ye.type),ce=Ye.url.replace(Qr,""),Ye.hasContent?Ye.data&&Ye.processData&&0===(Ye.contentType||"").indexOf("application/x-www-form-urlencoded")&&(Ye.data=Ye.data.replace(zs,"+")):(je=Ye.url.slice(ce.length),Ye.data&&(Ye.processData||"string"==typeof Ye.data)&&(ce+=(va.test(ce)?"&":"?")+Ye.data,delete Ye.data),!1===Ye.cache&&(ce=ce.replace(da,"$1"),je=(va.test(ce)?"&":"?")+"_="+Qs.guid+++je),Ye.url=ce+je),Ye.ifModified&&(se.lastModified[ce]&&bi.setRequestHeader("If-Modified-Since",se.lastModified[ce]),se.etag[ce]&&bi.setRequestHeader("If-None-Match",se.etag[ce])),(Ye.data&&Ye.hasContent&&!1!==Ye.contentType||V.contentType)&&bi.setRequestHeader("Content-Type",Ye.contentType),bi.setRequestHeader("Accept",Ye.dataTypes[0]&&Ye.accepts[Ye.dataTypes[0]]?Ye.accepts[Ye.dataTypes[0]]+("*"!==Ye.dataTypes[0]?", "+eo+"; q=0.01":""):Ye.accepts["*"]),Ye.headers)bi.setRequestHeader(be,Ye.headers[be]);if(Ye.beforeSend&&(!1===Ye.beforeSend.call(mt,bi,Ye)||le))return bi.abort();if(Zi="abort",wn.add(Ye.complete),bi.done(Ye.success),bi.fail(Ye.error),ne=Ms(Mo,Ye,V,bi)){if(bi.readyState=1,ee&&On.trigger("ajaxSend",[bi,Ye]),le)return bi;Ye.async&&Ye.timeout>0&&(Le=N.setTimeout(function(){bi.abort("timeout")},Ye.timeout));try{le=!1,ne.send(ji,ge)}catch(he){if(le)throw he;ge(-1,he)}}else ge(-1,"No Transport");function ge(he,ae,Re,gn){var xi,vi,Jo,ms,bs,No=ae;le||(le=!0,Le&&N.clearTimeout(Le),ne=void 0,Ee=gn||"",bi.readyState=he>0?4:0,xi=he>=200&&he<300||304===he,Re&&(ms=function Aa(I,V,ne){for(var ce,Ee,Ae,Le,Y=I.contents,le=I.dataTypes;"*"===le[0];)le.shift(),void 0===ce&&(ce=I.mimeType||V.getResponseHeader("Content-Type"));if(ce)for(Ee in Y)if(Y[Ee]&&Y[Ee].test(ce)){le.unshift(Ee);break}if(le[0]in ne)Ae=le[0];else{for(Ee in ne){if(!le[0]||I.converters[Ee+" "+le[0]]){Ae=Ee;break}Le||(Le=Ee)}Ae=Ae||Le}if(Ae)return Ae!==le[0]&&le.unshift(Ae),ne[Ae]}(Ye,bi,Re)),!xi&&se.inArray("script",Ye.dataTypes)>-1&&se.inArray("json",Ye.dataTypes)<0&&(Ye.converters["text script"]=function(){}),ms=function ds(I,V,ne,ce){var Ee,Ae,Le,Y,le,ee={},be=I.dataTypes.slice();if(be[1])for(Le in I.converters)ee[Le.toLowerCase()]=I.converters[Le];for(Ae=be.shift();Ae;)if(I.responseFields[Ae]&&(ne[I.responseFields[Ae]]=V),!le&&ce&&I.dataFilter&&(V=I.dataFilter(V,I.dataType)),le=Ae,Ae=be.shift())if("*"===Ae)Ae=le;else if("*"!==le&&le!==Ae){if(!(Le=ee[le+" "+Ae]||ee["* "+Ae]))for(Ee in ee)if((Y=Ee.split(" "))[1]===Ae&&(Le=ee[le+" "+Y[0]]||ee["* "+Y[0]])){!0===Le?Le=ee[Ee]:!0!==ee[Ee]&&(Ae=Y[0],be.unshift(Y[1]));break}if(!0!==Le)if(Le&&I.throws)V=Le(V);else try{V=Le(V)}catch(je){return{state:"parsererror",error:Le?je:"No conversion from "+le+" to "+Ae}}}return{state:"success",data:V}}(Ye,ms,bi,xi),xi?(Ye.ifModified&&((bs=bi.getResponseHeader("Last-Modified"))&&(se.lastModified[ce]=bs),(bs=bi.getResponseHeader("etag"))&&(se.etag[ce]=bs)),204===he||"HEAD"===Ye.type?No="nocontent":304===he?No="notmodified":(No=ms.state,vi=ms.data,xi=!(Jo=ms.error))):(Jo=No,(he||!No)&&(No="error",he<0&&(he=0))),bi.status=he,bi.statusText=(ae||No)+"",xi?Ui.resolveWith(mt,[vi,No,bi]):Ui.rejectWith(mt,[bi,No,Jo]),bi.statusCode(er),er=void 0,ee&&On.trigger(xi?"ajaxSuccess":"ajaxError",[bi,Ye,xi?vi:Jo]),wn.fireWith(mt,[bi,No]),ee&&(On.trigger("ajaxComplete",[bi,Ye]),--se.active||se.event.trigger("ajaxStop")))}return bi},getJSON:function(I,V,ne){return se.get(I,V,ne,"json")},getScript:function(I,V){return se.get(I,void 0,V,"script")}}),se.each(["get","post"],function(I,V){se[V]=function(ne,ce,Ee,Ae){return ft(ce)&&(Ae=Ae||Ee,Ee=ce,ce=void 0),se.ajax(se.extend({url:ne,type:V,dataType:Ae,data:ce,success:Ee},se.isPlainObject(ne)&&ne))}}),se.ajaxPrefilter(function(I){var V;for(V in I.headers)"content-type"===V.toLowerCase()&&(I.contentType=I.headers[V]||"")}),se._evalUrl=function(I,V,ne){return se.ajax({url:I,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(ce){se.globalEval(ce,V,ne)}})},se.fn.extend({wrapAll:function(I){var V;return this[0]&&(ft(I)&&(I=I.call(this[0])),V=se(I,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&V.insertBefore(this[0]),V.map(function(){for(var ne=this;ne.firstElementChild;)ne=ne.firstElementChild;return ne}).append(this)),this},wrapInner:function(I){return ft(I)?this.each(function(V){se(this).wrapInner(I.call(this,V))}):this.each(function(){var V=se(this),ne=V.contents();ne.length?ne.wrapAll(I):V.append(I)})},wrap:function(I){var V=ft(I);return this.each(function(ne){se(this).wrapAll(V?I.call(this,ne):I)})},unwrap:function(I){return this.parent(I).not("body").each(function(){se(this).replaceWith(this.childNodes)}),this}}),se.expr.pseudos.hidden=function(I){return!se.expr.pseudos.visible(I)},se.expr.pseudos.visible=function(I){return!!(I.offsetWidth||I.offsetHeight||I.getClientRects().length)},se.ajaxSettings.xhr=function(){try{return new N.XMLHttpRequest}catch(I){}};var ea={0:200,1223:204},Vs=se.ajaxSettings.xhr();at.cors=!!Vs&&"withCredentials"in Vs,at.ajax=Vs=!!Vs,se.ajaxTransport(function(I){var V,ne;if(at.cors||Vs&&!I.crossDomain)return{send:function(ce,Ee){var Ae,Le=I.xhr();if(Le.open(I.type,I.url,I.async,I.username,I.password),I.xhrFields)for(Ae in I.xhrFields)Le[Ae]=I.xhrFields[Ae];for(Ae in I.mimeType&&Le.overrideMimeType&&Le.overrideMimeType(I.mimeType),!I.crossDomain&&!ce["X-Requested-With"]&&(ce["X-Requested-With"]="XMLHttpRequest"),ce)Le.setRequestHeader(Ae,ce[Ae]);V=function(Y){return function(){V&&(V=ne=Le.onload=Le.onerror=Le.onabort=Le.ontimeout=Le.onreadystatechange=null,"abort"===Y?Le.abort():"error"===Y?"number"!=typeof Le.status?Ee(0,"error"):Ee(Le.status,Le.statusText):Ee(ea[Le.status]||Le.status,Le.statusText,"text"!==(Le.responseType||"text")||"string"!=typeof Le.responseText?{binary:Le.response}:{text:Le.responseText},Le.getAllResponseHeaders()))}},Le.onload=V(),ne=Le.onerror=Le.ontimeout=V("error"),void 0!==Le.onabort?Le.onabort=ne:Le.onreadystatechange=function(){4===Le.readyState&&N.setTimeout(function(){V&&ne()})},V=V("abort");try{Le.send(I.hasContent&&I.data||null)}catch(Y){if(V)throw Y}},abort:function(){V&&V()}}}),se.ajaxPrefilter(function(I){I.crossDomain&&(I.contents.script=!1)}),se.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(I){return se.globalEval(I),I}}}),se.ajaxPrefilter("script",function(I){void 0===I.cache&&(I.cache=!1),I.crossDomain&&(I.type="GET")}),se.ajaxTransport("script",function(I){var V,ne;if(I.crossDomain||I.scriptAttrs)return{send:function(ce,Ee){V=se("<script>").attr(I.scriptAttrs||{}).prop({charset:I.scriptCharset,src:I.url}).on("load error",ne=function(Ae){V.remove(),ne=null,Ae&&Ee("error"===Ae.type?404:200,Ae.type)}),kt.head.appendChild(V[0])},abort:function(){ne&&ne()}}});var I,Wr=[],fs=/(=)\?(?=&|$)|\?\?/;se.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var I=Wr.pop()||se.expando+"_"+Qs.guid++;return this[I]=!0,I}}),se.ajaxPrefilter("json jsonp",function(I,V,ne){var ce,Ee,Ae,Le=!1!==I.jsonp&&(fs.test(I.url)?"url":"string"==typeof I.data&&0===(I.contentType||"").indexOf("application/x-www-form-urlencoded")&&fs.test(I.data)&&"data");if(Le||"jsonp"===I.dataTypes[0])return ce=I.jsonpCallback=ft(I.jsonpCallback)?I.jsonpCallback():I.jsonpCallback,Le?I[Le]=I[Le].replace(fs,"$1"+ce):!1!==I.jsonp&&(I.url+=(va.test(I.url)?"&":"?")+I.jsonp+"="+ce),I.converters["script json"]=function(){return Ae||se.error(ce+" was not called"),Ae[0]},I.dataTypes[0]="json",Ee=N[ce],N[ce]=function(){Ae=arguments},ne.always(function(){void 0===Ee?se(N).removeProp(ce):N[ce]=Ee,I[ce]&&(I.jsonpCallback=V.jsonpCallback,Wr.push(ce)),Ae&&ft(Ee)&&Ee(Ae[0]),Ae=Ee=void 0}),"script"}),at.createHTMLDocument=((I=kt.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===I.childNodes.length),se.parseHTML=function(I,V,ne){return"string"!=typeof I?[]:("boolean"==typeof V&&(ne=V,V=!1),V||(at.createHTMLDocument?((ce=(V=kt.implementation.createHTMLDocument("")).createElement("base")).href=kt.location.href,V.head.appendChild(ce)):V=kt),Ae=!ne&&[],(Ee=en.exec(I))?[V.createElement(Ee[1])]:(Ee=Ao([I],V,Ae),Ae&&Ae.length&&se(Ae).remove(),se.merge([],Ee.childNodes)));var ce,Ee,Ae},se.fn.load=function(I,V,ne){var ce,Ee,Ae,Le=this,Y=I.indexOf(" ");return Y>-1&&(ce=rs(I.slice(Y)),I=I.slice(0,Y)),ft(V)?(ne=V,V=void 0):V&&"object"==typeof V&&(Ee="POST"),Le.length>0&&se.ajax({url:I,type:Ee||"GET",dataType:"html",data:V}).done(function(le){Ae=arguments,Le.html(ce?se("<div>").append(se.parseHTML(le)).find(ce):le)}).always(ne&&function(le,ee){Le.each(function(){ne.apply(this,Ae||[le.responseText,ee,le])})}),this},se.expr.pseudos.animated=function(I){return se.grep(se.timers,function(V){return I===V.elem}).length},se.offset={setOffset:function(I,V,ne){var ce,Ee,Ae,Le,Y,le,be=se.css(I,"position"),je=se(I),Ye={};"static"===be&&(I.style.position="relative"),Y=je.offset(),Ae=se.css(I,"top"),le=se.css(I,"left"),("absolute"===be||"fixed"===be)&&(Ae+le).indexOf("auto")>-1?(Le=(ce=je.position()).top,Ee=ce.left):(Le=parseFloat(Ae)||0,Ee=parseFloat(le)||0),ft(V)&&(V=V.call(I,ne,se.extend({},Y))),null!=V.top&&(Ye.top=V.top-Y.top+Le),null!=V.left&&(Ye.left=V.left-Y.left+Ee),"using"in V?V.using.call(I,Ye):je.css(Ye)}},se.fn.extend({offset:function(I){if(arguments.length)return void 0===I?this:this.each(function(Ee){se.offset.setOffset(this,I,Ee)});var V,ne,ce=this[0];return ce?ce.getClientRects().length?{top:(V=ce.getBoundingClientRect()).top+(ne=ce.ownerDocument.defaultView).pageYOffset,left:V.left+ne.pageXOffset}:{top:0,left:0}:void 0},position:function(){if(this[0]){var I,V,ne,ce=this[0],Ee={top:0,left:0};if("fixed"===se.css(ce,"position"))V=ce.getBoundingClientRect();else{for(V=this.offset(),ne=ce.ownerDocument,I=ce.offsetParent||ne.documentElement;I&&(I===ne.body||I===ne.documentElement)&&"static"===se.css(I,"position");)I=I.parentNode;I&&I!==ce&&1===I.nodeType&&((Ee=se(I).offset()).top+=se.css(I,"borderTopWidth",!0),Ee.left+=se.css(I,"borderLeftWidth",!0))}return{top:V.top-Ee.top-se.css(ce,"marginTop",!0),left:V.left-Ee.left-se.css(ce,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var I=this.offsetParent;I&&"static"===se.css(I,"position");)I=I.offsetParent;return I||Nn})}}),se.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(I,V){var ne="pageYOffset"===V;se.fn[I]=function(ce){return En(this,function(Ee,Ae,Le){var Y;if(tn(Ee)?Y=Ee:9===Ee.nodeType&&(Y=Ee.defaultView),void 0===Le)return Y?Y[V]:Ee[Ae];Y?Y.scrollTo(ne?Y.pageXOffset:Le,ne?Le:Y.pageYOffset):Ee[Ae]=Le},I,ce,arguments.length)}}),se.each(["top","left"],function(I,V){se.cssHooks[V]=qt(at.pixelPosition,function(ne,ce){if(ce)return ce=Xn(ne,V),dt.test(ce)?se(ne).position()[V]+"px":ce})}),se.each({Height:"height",Width:"width"},function(I,V){se.each({padding:"inner"+I,content:V,"":"outer"+I},function(ne,ce){se.fn[ce]=function(Ee,Ae){var Le=arguments.length&&(ne||"boolean"!=typeof Ee),Y=ne||(!0===Ee||!0===Ae?"margin":"border");return En(this,function(le,ee,be){var je;return tn(le)?0===ce.indexOf("outer")?le["inner"+I]:le.document.documentElement["client"+I]:9===le.nodeType?(je=le.documentElement,Math.max(le.body["scroll"+I],je["scroll"+I],le.body["offset"+I],je["offset"+I],je["client"+I])):void 0===be?se.css(le,ee,Y):se.style(le,ee,be,Y)},V,Le?Ee:void 0,Le)}})}),se.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(I,V){se.fn[V]=function(ne){return this.on(V,ne)}}),se.fn.extend({bind:function(I,V,ne){return this.on(I,null,V,ne)},unbind:function(I,V){return this.off(I,null,V)},delegate:function(I,V,ne,ce){return this.on(V,I,ne,ce)},undelegate:function(I,V,ne){return 1===arguments.length?this.off(I,"**"):this.off(V,I||"**",ne)},hover:function(I,V){return this.mouseenter(I).mouseleave(V||I)}}),se.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(I,V){se.fn[V]=function(ne,ce){return arguments.length>0?this.on(V,null,ne,ce):this.trigger(V)}});var js=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;se.proxy=function(I,V){var ne,ce,Ee;if("string"==typeof V&&(ne=I[V],V=I,I=ne),ft(I))return ce=lt.call(arguments,2),Ee=function(){return I.apply(V||this,ce.concat(lt.call(arguments)))},Ee.guid=I.guid=I.guid||se.guid++,Ee},se.holdReady=function(I){I?se.readyWait++:se.ready(!0)},se.isArray=Array.isArray,se.parseJSON=JSON.parse,se.nodeName=$t,se.isFunction=ft,se.isWindow=tn,se.camelCase=Tr,se.type=on,se.now=Date.now,se.isNumeric=function(I){var V=se.type(I);return("number"===V||"string"===V)&&!isNaN(I-parseFloat(I))},se.trim=function(I){return null==I?"":(I+"").replace(js,"$1")},void 0!==(D=function(){return se}.apply(Zt,[]))&&(Bi.exports=D);var ps=N.jQuery,Wa=N.$;return se.noConflict=function(I){return N.$===se&&(N.$=Wa),I&&N.jQuery===se&&(N.jQuery=ps),se},void 0===A&&(N.jQuery=N.$=se),se})},8407:function(Bi,Zt){!function(fe){"use strict";function N(c){var v,g,x,C;for(g=1,x=arguments.length;g<x;g++)for(v in C=arguments[g])c[v]=C[v];return c}var A=Object.create||function(){function c(){}return function(v){return c.prototype=v,new c}}();function l(c,v){var g=Array.prototype.slice;if(c.bind)return c.bind.apply(c,g.call(arguments,1));var x=g.call(arguments,2);return function(){return c.apply(v,x.length?x.concat(g.call(arguments)):arguments)}}var oe=0;function lt(c){return"_leaflet_id"in c||(c._leaflet_id=++oe),c._leaflet_id}function At(c,v,g){var x,C,U,Q;return Q=function(){x=!1,C&&(U.apply(g,C),C=!1)},U=function(){x?C=arguments:(c.apply(g,arguments),setTimeout(Q,v),x=!0)},U}function Ke(c,v,g){var x=v[1],C=v[0],U=x-C;return c===x&&g?c:((c-C)%U+U)%U+C}function ct(){return!1}function _t(c,v){if(!1===v)return c;var g=Math.pow(10,void 0===v?6:v);return Math.round(c*g)/g}function Nt(c){return c.trim?c.trim():c.replace(/^\s+|\s+$/g,"")}function wt(c){return Nt(c).split(/\s+/)}function Bt(c,v){for(var g in Object.prototype.hasOwnProperty.call(c,"options")||(c.options=c.options?A(c.options):{}),v)c.options[g]=v[g];return c.options}function st(c,v,g){var x=[];for(var C in c)x.push(encodeURIComponent(g?C.toUpperCase():C)+"="+encodeURIComponent(c[C]));return(v&&-1!==v.indexOf("?")?"&":"?")+x.join("&")}var at=/\{ *([\w_ -]+) *\}/g;function ft(c,v){return c.replace(at,function(g,x){var C=v[x];if(void 0===C)throw new Error("No value provided for variable "+g);return"function"==typeof C&&(C=C(v)),C})}var tn=Array.isArray||function(c){return"[object Array]"===Object.prototype.toString.call(c)};function kt(c,v){for(var g=0;g<c.length;g++)if(c[g]===v)return g;return-1}var dn="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function Qn(c){return window["webkit"+c]||window["moz"+c]||window["ms"+c]}var on=0;function Cn(c){var v=+new Date,g=Math.max(0,16-(v-on));return on=v+g,window.setTimeout(c,g)}var se=window.requestAnimationFrame||Qn("RequestAnimationFrame")||Cn,Wi=window.cancelAnimationFrame||Qn("CancelAnimationFrame")||Qn("CancelRequestAnimationFrame")||function(c){window.clearTimeout(c)};function ii(c,v,g){if(!g||se!==Cn)return se.call(window,l(c,v));c.call(v)}function kn(c){c&&Wi.call(window,c)}var Ci={__proto__:null,extend:N,create:A,bind:l,get lastId(){return oe},stamp:lt,throttle:At,wrapNum:Ke,falseFn:ct,formatNum:_t,trim:Nt,splitWords:wt,setOptions:Bt,getParamString:st,template:ft,isArray:tn,indexOf:kt,emptyImageUrl:dn,requestFn:se,cancelFn:Wi,requestAnimFrame:ii,cancelAnimFrame:kn};function Jt(){}Jt.extend=function(c){var v=function(){Bt(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},g=v.__super__=this.prototype,x=A(g);for(var C in x.constructor=v,v.prototype=x,this)Object.prototype.hasOwnProperty.call(this,C)&&"prototype"!==C&&"__super__"!==C&&(v[C]=this[C]);return c.statics&&N(v,c.statics),c.includes&&(function $t(c){if("undefined"!=typeof L&&L&&L.Mixin){c=tn(c)?c:[c];for(var v=0;v<c.length;v++)c[v]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",(new Error).stack)}}(c.includes),N.apply(null,[x].concat(c.includes))),N(x,c),delete x.statics,delete x.includes,x.options&&(x.options=g.options?A(g.options):{},N(x.options,c.options)),x._initHooks=[],x.callInitHooks=function(){if(!this._initHooksCalled){g.callInitHooks&&g.callInitHooks.call(this),this._initHooksCalled=!0;for(var U=0,Q=x._initHooks.length;U<Q;U++)x._initHooks[U].call(this)}},v},Jt.include=function(c){var v=this.prototype.options;return N(this.prototype,c),c.options&&(this.prototype.options=v,this.mergeOptions(c.options)),this},Jt.mergeOptions=function(c){return N(this.prototype.options,c),this},Jt.addInitHook=function(c){var v=Array.prototype.slice.call(arguments,1),g="function"==typeof c?c:function(){this[c].apply(this,v)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(g),this};var en={on:function(c,v,g){if("object"==typeof c)for(var x in c)this._on(x,c[x],v);else for(var C=0,U=(c=wt(c)).length;C<U;C++)this._on(c[C],v,g);return this},off:function(c,v,g){if(arguments.length)if("object"==typeof c)for(var x in c)this._off(x,c[x],v);else{c=wt(c);for(var C=1===arguments.length,U=0,Q=c.length;U<Q;U++)C?this._off(c[U]):this._off(c[U],v,g)}else delete this._events;return this},_on:function(c,v,g,x){if("function"==typeof v){if(!1===this._listens(c,v,g)){g===this&&(g=void 0);var C={fn:v,ctx:g};x&&(C.once=!0),this._events=this._events||{},this._events[c]=this._events[c]||[],this._events[c].push(C)}}else console.warn("wrong listener type: "+typeof v)},_off:function(c,v,g){var x,C,U;if(this._events&&(x=this._events[c])){if(1===arguments.length){if(this._firingCount)for(C=0,U=x.length;C<U;C++)x[C].fn=ct;return void delete this._events[c]}if("function"!=typeof v)return void console.warn("wrong listener type: "+typeof v);var Q=this._listens(c,v,g);!1!==Q&&(this._firingCount&&(x[Q].fn=ct,this._events[c]=x=x.slice()),x.splice(Q,1))}},fire:function(c,v,g){if(!this.listens(c,g))return this;var x=N({},v,{type:c,target:this,sourceTarget:v&&v.sourceTarget||this});if(this._events){var C=this._events[c];if(C){this._firingCount=this._firingCount+1||1;for(var U=0,Q=C.length;U<Q;U++){var ye=C[U],Pe=ye.fn;ye.once&&this.off(c,Pe,ye.ctx),Pe.call(ye.ctx||this,x)}this._firingCount--}}return g&&this._propagateEvent(x),this},listens:function(c,v,g,x){"string"!=typeof c&&console.warn('"string" type argument expected');var C=v;"function"!=typeof v&&(x=!!v,C=void 0,g=void 0);var U=this._events&&this._events[c];if(U&&U.length&&!1!==this._listens(c,C,g))return!0;if(x)for(var Q in this._eventParents)if(this._eventParents[Q].listens(c,v,g,x))return!0;return!1},_listens:function(c,v,g){if(!this._events)return!1;var x=this._events[c]||[];if(!v)return!!x.length;g===this&&(g=void 0);for(var C=0,U=x.length;C<U;C++)if(x[C].fn===v&&x[C].ctx===g)return C;return!1},once:function(c,v,g){if("object"==typeof c)for(var x in c)this._on(x,c[x],v,!0);else for(var C=0,U=(c=wt(c)).length;C<U;C++)this._on(c[C],v,g,!0);return this},addEventParent:function(c){return this._eventParents=this._eventParents||{},this._eventParents[lt(c)]=c,this},removeEventParent:function(c){return this._eventParents&&delete this._eventParents[lt(c)],this},_propagateEvent:function(c){for(var v in this._eventParents)this._eventParents[v].fire(c.type,N({layer:c.target,propagatedFrom:c.target},c),!0)}};en.addEventListener=en.on,en.removeEventListener=en.clearAllEventListeners=en.off,en.addOneTimeEventListener=en.once,en.fireEvent=en.fire,en.hasEventListeners=en.listens;var an=Jt.extend(en);function Yt(c,v,g){this.x=g?Math.round(c):c,this.y=g?Math.round(v):v}var An=Math.trunc||function(c){return c>0?Math.floor(c):Math.ceil(c)};function Sn(c,v,g){return c instanceof Yt?c:tn(c)?new Yt(c[0],c[1]):null==c?c:"object"==typeof c&&"x"in c&&"y"in c?new Yt(c.x,c.y):new Yt(c,v,g)}function Mi(c,v){if(c)for(var g=v?[c,v]:c,x=0,C=g.length;x<C;x++)this.extend(g[x])}function mr(c,v){return!c||c instanceof Mi?c:new Mi(c,v)}function wi(c,v){if(c)for(var g=v?[c,v]:c,x=0,C=g.length;x<C;x++)this.extend(g[x])}function _i(c,v){return c instanceof wi?c:new wi(c,v)}function Ki(c,v,g){if(isNaN(c)||isNaN(v))throw new Error("Invalid LatLng object: ("+c+", "+v+")");this.lat=+c,this.lng=+v,void 0!==g&&(this.alt=+g)}function ui(c,v,g){return c instanceof Ki?c:tn(c)&&"object"!=typeof c[0]?3===c.length?new Ki(c[0],c[1],c[2]):2===c.length?new Ki(c[0],c[1]):null:null==c?c:"object"==typeof c&&"lat"in c?new Ki(c.lat,"lng"in c?c.lng:c.lon,c.alt):void 0===v?null:new Ki(c,v,g)}Yt.prototype={clone:function(){return new Yt(this.x,this.y)},add:function(c){return this.clone()._add(Sn(c))},_add:function(c){return this.x+=c.x,this.y+=c.y,this},subtract:function(c){return this.clone()._subtract(Sn(c))},_subtract:function(c){return this.x-=c.x,this.y-=c.y,this},divideBy:function(c){return this.clone()._divideBy(c)},_divideBy:function(c){return this.x/=c,this.y/=c,this},multiplyBy:function(c){return this.clone()._multiplyBy(c)},_multiplyBy:function(c){return this.x*=c,this.y*=c,this},scaleBy:function(c){return new Yt(this.x*c.x,this.y*c.y)},unscaleBy:function(c){return new Yt(this.x/c.x,this.y/c.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=An(this.x),this.y=An(this.y),this},distanceTo:function(c){var v=(c=Sn(c)).x-this.x,g=c.y-this.y;return Math.sqrt(v*v+g*g)},equals:function(c){return(c=Sn(c)).x===this.x&&c.y===this.y},contains:function(c){return c=Sn(c),Math.abs(c.x)<=Math.abs(this.x)&&Math.abs(c.y)<=Math.abs(this.y)},toString:function(){return"Point("+_t(this.x)+", "+_t(this.y)+")"}},Mi.prototype={extend:function(c){var v,g;if(!c)return this;if(c instanceof Yt||"number"==typeof c[0]||"x"in c)v=g=Sn(c);else if(g=(c=mr(c)).max,!(v=c.min)||!g)return this;return this.min||this.max?(this.min.x=Math.min(v.x,this.min.x),this.max.x=Math.max(g.x,this.max.x),this.min.y=Math.min(v.y,this.min.y),this.max.y=Math.max(g.y,this.max.y)):(this.min=v.clone(),this.max=g.clone()),this},getCenter:function(c){return Sn((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,c)},getBottomLeft:function(){return Sn(this.min.x,this.max.y)},getTopRight:function(){return Sn(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(c){var v,g;return(c="number"==typeof c[0]||c instanceof Yt?Sn(c):mr(c))instanceof Mi?(v=c.min,g=c.max):v=g=c,v.x>=this.min.x&&g.x<=this.max.x&&v.y>=this.min.y&&g.y<=this.max.y},intersects:function(c){c=mr(c);var v=this.min,g=this.max,x=c.min,C=c.max;return C.x>=v.x&&x.x<=g.x&&C.y>=v.y&&x.y<=g.y},overlaps:function(c){c=mr(c);var v=this.min,g=this.max,x=c.min,C=c.max;return C.x>v.x&&x.x<g.x&&C.y>v.y&&x.y<g.y},isValid:function(){return!(!this.min||!this.max)},pad:function(c){var v=this.min,g=this.max,x=Math.abs(v.x-g.x)*c,C=Math.abs(v.y-g.y)*c;return mr(Sn(v.x-x,v.y-C),Sn(g.x+x,g.y+C))},equals:function(c){return!!c&&(c=mr(c),this.min.equals(c.getTopLeft())&&this.max.equals(c.getBottomRight()))}},wi.prototype={extend:function(c){var x,C,v=this._southWest,g=this._northEast;if(c instanceof Ki)x=c,C=c;else{if(!(c instanceof wi))return c?this.extend(ui(c)||_i(c)):this;if(C=c._northEast,!(x=c._southWest)||!C)return this}return v||g?(v.lat=Math.min(x.lat,v.lat),v.lng=Math.min(x.lng,v.lng),g.lat=Math.max(C.lat,g.lat),g.lng=Math.max(C.lng,g.lng)):(this._southWest=new Ki(x.lat,x.lng),this._northEast=new Ki(C.lat,C.lng)),this},pad:function(c){var v=this._southWest,g=this._northEast,x=Math.abs(v.lat-g.lat)*c,C=Math.abs(v.lng-g.lng)*c;return new wi(new Ki(v.lat-x,v.lng-C),new Ki(g.lat+x,g.lng+C))},getCenter:function(){return new Ki((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Ki(this.getNorth(),this.getWest())},getSouthEast:function(){return new Ki(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(c){c="number"==typeof c[0]||c instanceof Ki||"lat"in c?ui(c):_i(c);var x,C,v=this._southWest,g=this._northEast;return c instanceof wi?(x=c.getSouthWest(),C=c.getNorthEast()):x=C=c,x.lat>=v.lat&&C.lat<=g.lat&&x.lng>=v.lng&&C.lng<=g.lng},intersects:function(c){c=_i(c);var v=this._southWest,g=this._northEast,x=c.getSouthWest(),C=c.getNorthEast();return C.lat>=v.lat&&x.lat<=g.lat&&C.lng>=v.lng&&x.lng<=g.lng},overlaps:function(c){c=_i(c);var v=this._southWest,g=this._northEast,x=c.getSouthWest(),C=c.getNorthEast();return C.lat>v.lat&&x.lat<g.lat&&C.lng>v.lng&&x.lng<g.lng},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(c,v){return!!c&&(c=_i(c),this._southWest.equals(c.getSouthWest(),v)&&this._northEast.equals(c.getNorthEast(),v))},isValid:function(){return!(!this._southWest||!this._northEast)}},Ki.prototype={equals:function(c,v){return!!c&&(c=ui(c),Math.max(Math.abs(this.lat-c.lat),Math.abs(this.lng-c.lng))<=(void 0===v?1e-9:v))},toString:function(c){return"LatLng("+_t(this.lat,c)+", "+_t(this.lng,c)+")"},distanceTo:function(c){return Br.distance(this,ui(c))},wrap:function(){return Br.wrapLatLng(this)},toBounds:function(c){var v=180*c/40075017,g=v/Math.cos(Math.PI/180*this.lat);return _i([this.lat-v,this.lng-g],[this.lat+v,this.lng+g])},clone:function(){return new Ki(this.lat,this.lng,this.alt)}};var c,Ti={latLngToPoint:function(c,v){var g=this.projection.project(c),x=this.scale(v);return this.transformation._transform(g,x)},pointToLatLng:function(c,v){var g=this.scale(v),x=this.transformation.untransform(c,g);return this.projection.unproject(x)},project:function(c){return this.projection.project(c)},unproject:function(c){return this.projection.unproject(c)},scale:function(c){return 256*Math.pow(2,c)},zoom:function(c){return Math.log(c/256)/Math.LN2},getProjectedBounds:function(c){if(this.infinite)return null;var v=this.projection.bounds,g=this.scale(c);return new Mi(this.transformation.transform(v.min,g),this.transformation.transform(v.max,g))},infinite:!1,wrapLatLng:function(c){var v=this.wrapLng?Ke(c.lng,this.wrapLng,!0):c.lng;return new Ki(this.wrapLat?Ke(c.lat,this.wrapLat,!0):c.lat,v,c.alt)},wrapLatLngBounds:function(c){var v=c.getCenter(),g=this.wrapLatLng(v),x=v.lat-g.lat,C=v.lng-g.lng;if(0===x&&0===C)return c;var U=c.getSouthWest(),Q=c.getNorthEast();return new wi(new Ki(U.lat-x,U.lng-C),new Ki(Q.lat-x,Q.lng-C))}},Br=N({},Ti,{wrapLng:[-180,180],R:6371e3,distance:function(c,v){var g=Math.PI/180,x=c.lat*g,C=v.lat*g,U=Math.sin((v.lat-c.lat)*g/2),Q=Math.sin((v.lng-c.lng)*g/2),ye=U*U+Math.cos(x)*Math.cos(C)*Q*Q,Pe=2*Math.atan2(Math.sqrt(ye),Math.sqrt(1-ye));return this.R*Pe}}),oi={R:6378137,MAX_LATITUDE:85.0511287798,project:function(c){var v=Math.PI/180,g=this.MAX_LATITUDE,x=Math.max(Math.min(g,c.lat),-g),C=Math.sin(x*v);return new Yt(this.R*c.lng*v,this.R*Math.log((1+C)/(1-C))/2)},unproject:function(c){var v=180/Math.PI;return new Ki((2*Math.atan(Math.exp(c.y/this.R))-Math.PI/2)*v,c.x*v/this.R)},bounds:(c=6378137*Math.PI,new Mi([-c,-c],[c,c]))};function Tt(c,v,g,x){if(tn(c))return this._a=c[0],this._b=c[1],this._c=c[2],void(this._d=c[3]);this._a=c,this._b=v,this._c=g,this._d=x}function En(c,v,g,x){return new Tt(c,v,g,x)}Tt.prototype={transform:function(c,v){return this._transform(c.clone(),v)},_transform:function(c,v){return c.x=(v=v||1)*(this._a*c.x+this._b),c.y=v*(this._c*c.y+this._d),c},untransform:function(c,v){return new Yt((c.x/(v=v||1)-this._b)/this._a,(c.y/v-this._d)/this._c)}};var si=N({},Br,{code:"EPSG:3857",projection:oi,transformation:function(){var c=.5/(Math.PI*oi.R);return En(c,.5,-c,.5)}()}),fi=N({},si,{code:"EPSG:900913"});function nr(c){return document.createElementNS("http://www.w3.org/2000/svg",c)}function Tr(c,v){var x,C,U,Q,ye,Pe,g="";for(x=0,U=c.length;x<U;x++){for(C=0,Q=(ye=c[x]).length;C<Q;C++)g+=(C?"L":"M")+(Pe=ye[C]).x+" "+Pe.y;g+=v?nt.svg?"z":"x":""}return g||"M0 0"}var Zr=document.documentElement.style,Ur="ActiveXObject"in window,Mn=Ur&&!document.addEventListener,yo="msLaunchUri"in navigator&&!("documentMode"in document),qr=Rt("webkit"),no=Rt("android"),dr=Rt("android 2")||Rt("android 3"),cs=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),cn=no&&Rt("Google")&&cs<537&&!("AudioNode"in window),Ot=!!window.opera,Dt=!yo&&Rt("chrome"),Nn=Rt("gecko")&&!qr&&!Ot&&!Ur,nn=!Dt&&Rt("safari"),jn=Rt("phantom"),pi="OTransition"in Zr,to=0===navigator.platform.indexOf("Win"),Li=Ur&&"transition"in Zr,$r="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!dr,Vr="MozPerspective"in Zr,fo=!window.L_DISABLE_3D&&(Li||$r||Vr)&&!pi&&!jn,vo="undefined"!=typeof orientation||Rt("mobile"),ei=vo&&qr,fr=vo&&$r,sr=!window.PointerEvent&&window.MSPointerEvent,Io=!(!window.PointerEvent&&!sr),ir="ontouchstart"in window||!!window.TouchEvent,Ao=!window.L_NO_TOUCH&&(ir||Io),Zo=vo&&Ot,To=vo&&Nn,Ds=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,qe=function(){var c=!1;try{var v=Object.defineProperty({},"passive",{get:function(){c=!0}});window.addEventListener("testPassiveEventSupport",ct,v),window.removeEventListener("testPassiveEventSupport",ct,v)}catch(g){}return c}(),Te=!!document.createElement("canvas").getContext,Me=!(!document.createElementNS||!nr("svg").createSVGRect),We=!!Me&&function(){var c=document.createElement("div");return c.innerHTML="<svg/>","http://www.w3.org/2000/svg"===(c.firstChild&&c.firstChild.namespaceURI)}(),Xe=!Me&&function(){try{var c=document.createElement("div");c.innerHTML='<v:shape adj="1"/>';var v=c.firstChild;return v.style.behavior="url(#default#VML)",v&&"object"==typeof v.adj}catch(g){return!1}}();function Rt(c){return navigator.userAgent.toLowerCase().indexOf(c)>=0}var nt={ie:Ur,ielt9:Mn,edge:yo,webkit:qr,android:no,android23:dr,androidStock:cn,opera:Ot,chrome:Dt,gecko:Nn,safari:nn,phantom:jn,opera12:pi,win:to,ie3d:Li,webkit3d:$r,gecko3d:Vr,any3d:fo,mobile:vo,mobileWebkit:ei,mobileWebkit3d:fr,msPointer:sr,pointer:Io,touch:Ao,touchNative:ir,mobileOpera:Zo,mobileGecko:To,retina:Ds,passiveEvents:qe,canvas:Te,svg:Me,vml:Xe,inlineSvg:We,mac:0===navigator.platform.indexOf("Mac"),linux:0===navigator.platform.indexOf("Linux")},Kt=nt.msPointer?"MSPointerDown":"pointerdown",Dn=nt.msPointer?"MSPointerMove":"pointermove",xe=nt.msPointer?"MSPointerUp":"pointerup",Se=nt.msPointer?"MSPointerCancel":"pointercancel",Be={touchstart:Kt,touchmove:Dn,touchend:xe,touchcancel:Se},dt={touchstart:function gr(c,v){v.MSPOINTER_TYPE_TOUCH&&v.pointerType===v.MSPOINTER_TYPE_TOUCH&&eo(v),Gr(c,v)},touchmove:Gr,touchend:Gr,touchcancel:Gr},Pt={},rn=!1;function un(c,v,g){return"touchstart"===v&&function qt(){rn||(document.addEventListener(Kt,Pn,!0),document.addEventListener(Dn,mi,!0),document.addEventListener(xe,Xn,!0),document.addEventListener(Se,Xn,!0),rn=!0)}(),dt[v]?(g=dt[v].bind(this,g),c.addEventListener(Be[v],g,!1),g):(console.warn("wrong event specified:",v),L.Util.falseFn)}function Pn(c){Pt[c.pointerId]=c}function mi(c){Pt[c.pointerId]&&(Pt[c.pointerId]=c)}function Xn(c){delete Pt[c.pointerId]}function Gr(c,v){if(v.pointerType!==(v.MSPOINTER_TYPE_MOUSE||"mouse")){for(var g in v.touches=[],Pt)v.touches.push(Pt[g]);v.changedTouches=[v],c(v)}}var rs,vs,Ir,lo,Qs,Mr=ca(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Nr=ca(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Wn="webkitTransition"===Nr||"OTransition"===Nr?Nr+"End":"transitionend";function Fi(c){return"string"==typeof c?document.getElementById(c):c}function Xi(c,v){var g=c.style[v]||c.currentStyle&&c.currentStyle[v];if((!g||"auto"===g)&&document.defaultView){var x=document.defaultView.getComputedStyle(c,null);g=x?x[v]:null}return"auto"===g?null:g}function Gi(c,v,g){var x=document.createElement(c);return x.className=v||"",g&&g.appendChild(x),x}function yi(c){var v=c.parentNode;v&&v.removeChild(c)}function Ji(c){for(;c.firstChild;)c.removeChild(c.firstChild)}function Ko(c){var v=c.parentNode;v&&v.lastChild!==c&&v.appendChild(c)}function us(c){var v=c.parentNode;v&&v.firstChild!==c&&v.insertBefore(c,v.firstChild)}function Ss(c,v){if(void 0!==c.classList)return c.classList.contains(v);var g=Po(c);return g.length>0&&new RegExp("(^|\\s)"+v+"(\\s|$)").test(g)}function Hi(c,v){if(void 0!==c.classList)for(var g=wt(v),x=0,C=g.length;x<C;x++)c.classList.add(g[x]);else if(!Ss(c,v)){var U=Po(c);ks(c,(U?U+" ":"")+v)}}function lr(c,v){void 0!==c.classList?c.classList.remove(v):ks(c,Nt((" "+Po(c)+" ").replace(" "+v+" "," ")))}function ks(c,v){void 0===c.className.baseVal?c.className=v:c.className.baseVal=v}function Po(c){return c.correspondingElement&&(c=c.correspondingElement),void 0===c.className.baseVal?c.className:c.className.baseVal}function Dr(c,v){"opacity"in c.style?c.style.opacity=v:"filter"in c.style&&function Uo(c,v){var g=!1,x="DXImageTransform.Microsoft.Alpha";try{g=c.filters.item(x)}catch(C){if(1===v)return}v=Math.round(100*v),g?(g.Enabled=100!==v,g.Opacity=v):c.style.filter+=" progid:"+x+"(opacity="+v+")"}(c,v)}function ca(c){for(var v=document.documentElement.style,g=0;g<c.length;g++)if(c[g]in v)return c[g];return!1}function po(c,v,g){var x=v||new Yt(0,0);c.style[Mr]=(nt.ie3d?"translate("+x.x+"px,"+x.y+"px)":"translate3d("+x.x+"px,"+x.y+"px,0)")+(g?" scale("+g+")":"")}function xr(c,v){c._leaflet_pos=v,nt.any3d?po(c,v):(c.style.left=v.x+"px",c.style.top=v.y+"px")}function zr(c){return c._leaflet_pos||new Yt(0,0)}if("onselectstart"in document)rs=function(){Qi(window,"selectstart",eo)},vs=function(){Qr(window,"selectstart",eo)};else{var Vo=ca(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);rs=function(){if(Vo){var c=document.documentElement.style;Ir=c[Vo],c[Vo]="none"}},vs=function(){Vo&&(document.documentElement.style[Vo]=Ir,Ir=void 0)}}function ya(){Qi(window,"dragstart",eo)}function hs(){Qr(window,"dragstart",eo)}function va(c){for(;-1===c.tabIndex;)c=c.parentNode;!c.style||(ua(),lo=c,Qs=c.style.outline,c.style.outline="none",Qi(window,"keydown",ua))}function ua(){!lo||(lo.style.outline=Qs,lo=void 0,Qs=void 0,Qr(window,"keydown",ua))}function $o(c){do{c=c.parentNode}while(!(c.offsetWidth&&c.offsetHeight||c===document.body));return c}function ha(c){var v=c.getBoundingClientRect();return{x:v.width/c.offsetWidth||1,y:v.height/c.offsetHeight||1,boundingClientRect:v}}var ul={__proto__:null,TRANSFORM:Mr,TRANSITION:Nr,TRANSITION_END:Wn,get:Fi,getStyle:Xi,create:Gi,remove:yi,empty:Ji,toFront:Ko,toBack:us,hasClass:Ss,addClass:Hi,removeClass:lr,setClass:ks,getClass:Po,setOpacity:Dr,testProp:ca,setTransform:po,setPosition:xr,getPosition:zr,get disableTextSelection(){return rs},get enableTextSelection(){return vs},disableImageDrag:ya,enableImageDrag:hs,preventOutline:va,restoreOutline:ua,getSizedParentNode:$o,getScale:ha};function Qi(c,v,g,x){if(v&&"object"==typeof v)for(var C in v)Us(c,C,v[C],g);else for(var U=0,Q=(v=wt(v)).length;U<Q;U++)Us(c,v[U],g,x);return this}var zs="_leaflet_events";function Qr(c,v,g,x){if(1===arguments.length)da(c),delete c[zs];else if(v&&"object"==typeof v)for(var C in v)Sa(c,C,v[C],g);else if(v=wt(v),2===arguments.length)da(c,function(ye){return-1!==kt(v,ye)});else for(var U=0,Q=v.length;U<Q;U++)Sa(c,v[U],g,x);return this}function da(c,v){for(var g in c[zs]){var x=g.split(/\d/)[0];(!v||v(x))&&Sa(c,x,null,null,g)}}var Da={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Us(c,v,g,x){var C=v+lt(g)+(x?"_"+lt(x):"");if(c[zs]&&c[zs][C])return this;var U=function(ye){return g.call(x||c,ye||window.event)},Q=U;!nt.touchNative&&nt.pointer&&0===v.indexOf("touch")?U=un(c,v,U):nt.touch&&"dblclick"===v?U=function hr(c,v){c.addEventListener("dblclick",v);var x,g=0;function C(U){if(1===U.detail){if("mouse"!==U.pointerType&&(!U.sourceCapabilities||U.sourceCapabilities.firesTouchEvents)){var Q=As(U);if(!Q.some(function(Pe){return Pe instanceof HTMLLabelElement&&Pe.attributes.for})||Q.some(function(Pe){return Pe instanceof HTMLInputElement||Pe instanceof HTMLSelectElement})){var ye=Date.now();ye-g<=200?2==++x&&v(function Rn(c){var g,x,v={};for(x in c)v[x]=(g=c[x])&&g.bind?g.bind(c):g;return c=v,v.type="dblclick",v.detail=2,v.isTrusted=!1,v._simulated=!0,v}(U)):x=1,g=ye}}}else x=U.detail}return c.addEventListener("click",C),{dblclick:v,simDblclick:C}}(c,U):"addEventListener"in c?"touchstart"===v||"touchmove"===v||"wheel"===v||"mousewheel"===v?c.addEventListener(Da[v]||v,U,!!nt.passiveEvents&&{passive:!1}):"mouseenter"===v||"mouseleave"===v?c.addEventListener(Da[v],U=function(ye){ye=ye||window.event,ds(c,ye)&&Q(ye)},!1):c.addEventListener(v,Q,!1):c.attachEvent("on"+v,U),c[zs]=c[zs]||{},c[zs][C]=U}function Sa(c,v,g,x,C){C=C||v+lt(g)+(x?"_"+lt(x):"");var U=c[zs]&&c[zs][C];if(!U)return this;!nt.touchNative&&nt.pointer&&0===v.indexOf("touch")?function In(c,v,g){Be[v]?c.removeEventListener(Be[v],g,!1):console.warn("wrong event specified:",v)}(c,v,U):nt.touch&&"dblclick"===v?function Er(c,v){c.removeEventListener("dblclick",v.dblclick),c.removeEventListener("click",v.simDblclick)}(c,U):"removeEventListener"in c?c.removeEventListener(Da[v]||v,U,!1):c.detachEvent("on"+v,U),c[zs][C]=null}function qs(c){return c.stopPropagation?c.stopPropagation():c.originalEvent?c.originalEvent._stopped=!0:c.cancelBubble=!0,this}function Oo(c){return Us(c,"wheel",qs),this}function Mo(c){return Qi(c,"mousedown touchstart dblclick contextmenu",qs),c._leaflet_disable_click=!0,this}function eo(c){return c.preventDefault?c.preventDefault():c.returnValue=!1,this}function Xo(c){return eo(c),qs(c),this}function As(c){if(c.composedPath)return c.composedPath();for(var v=[],g=c.target;g;)v.push(g),g=g.parentNode;return v}function Ms(c,v){if(!v)return new Yt(c.clientX,c.clientY);var g=ha(v),x=g.boundingClientRect;return new Yt((c.clientX-x.left)/g.x-v.clientLeft,(c.clientY-x.top)/g.y-v.clientTop)}var Pl=nt.linux&&nt.chrome?window.devicePixelRatio:nt.mac?3*window.devicePixelRatio:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Aa(c){return nt.edge?c.wheelDeltaY/2:c.deltaY&&0===c.deltaMode?-c.deltaY/Pl:c.deltaY&&1===c.deltaMode?20*-c.deltaY:c.deltaY&&2===c.deltaMode?60*-c.deltaY:c.deltaX||c.deltaZ?0:c.wheelDelta?(c.wheelDeltaY||c.wheelDelta)/2:c.detail&&Math.abs(c.detail)<32765?20*-c.detail:c.detail?c.detail/-32765*60:0}function ds(c,v){var g=v.relatedTarget;if(!g)return!0;try{for(;g&&g!==c;)g=g.parentNode}catch(x){return!1}return g!==c}var ea={__proto__:null,on:Qi,off:Qr,stopPropagation:qs,disableScrollPropagation:Oo,disableClickPropagation:Mo,preventDefault:eo,stop:Xo,getPropagationPath:As,getMousePosition:Ms,getWheelDelta:Aa,isExternalTarget:ds,addListener:Qi,removeListener:Qr},Vs=an.extend({run:function(c,v,g,x){this.stop(),this._el=c,this._inProgress=!0,this._duration=g||.25,this._easeOutPower=1/Math.max(x||.5,.2),this._startPos=zr(c),this._offset=v.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){!this._inProgress||(this._step(!0),this._complete())},_animate:function(){this._animId=ii(this._animate,this),this._step()},_step:function(c){var v=+new Date-this._startTime,g=1e3*this._duration;v<g?this._runFrame(this._easeOut(v/g),c):(this._runFrame(1),this._complete())},_runFrame:function(c,v){var g=this._startPos.add(this._offset.multiplyBy(c));v&&g._round(),xr(this._el,g),this.fire("step")},_complete:function(){kn(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(c){return 1-Math.pow(1-c,this._easeOutPower)}}),Wr=an.extend({options:{crs:si,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(c,v){v=Bt(this,v),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(c),this._initLayout(),this._onResize=l(this._onResize,this),this._initEvents(),v.maxBounds&&this.setMaxBounds(v.maxBounds),void 0!==v.zoom&&(this._zoom=this._limitZoom(v.zoom)),v.center&&void 0!==v.zoom&&this.setView(ui(v.center),v.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Nr&&nt.any3d&&!nt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Qi(this._proxy,Wn,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(c,v,g){return v=void 0===v?this._zoom:this._limitZoom(v),c=this._limitCenter(ui(c),v,this.options.maxBounds),g=g||{},this._stop(),this._loaded&&!g.reset&&!0!==g&&(void 0!==g.animate&&(g.zoom=N({animate:g.animate},g.zoom),g.pan=N({animate:g.animate,duration:g.duration},g.pan)),this._zoom!==v?this._tryAnimatedZoom&&this._tryAnimatedZoom(c,v,g.zoom):this._tryAnimatedPan(c,g.pan))?(clearTimeout(this._sizeTimer),this):(this._resetView(c,v,g.pan&&g.pan.noMoveStart),this)},setZoom:function(c,v){return this._loaded?this.setView(this.getCenter(),c,{zoom:v}):(this._zoom=c,this)},zoomIn:function(c,v){return this.setZoom(this._zoom+(c=c||(nt.any3d?this.options.zoomDelta:1)),v)},zoomOut:function(c,v){return this.setZoom(this._zoom-(c=c||(nt.any3d?this.options.zoomDelta:1)),v)},setZoomAround:function(c,v,g){var x=this.getZoomScale(v),C=this.getSize().divideBy(2),Q=(c instanceof Yt?c:this.latLngToContainerPoint(c)).subtract(C).multiplyBy(1-1/x),ye=this.containerPointToLatLng(C.add(Q));return this.setView(ye,v,{zoom:g})},_getBoundsCenterZoom:function(c,v){v=v||{},c=c.getBounds?c.getBounds():_i(c);var g=Sn(v.paddingTopLeft||v.padding||[0,0]),x=Sn(v.paddingBottomRight||v.padding||[0,0]),C=this.getBoundsZoom(c,!1,g.add(x));if((C="number"==typeof v.maxZoom?Math.min(v.maxZoom,C):C)===1/0)return{center:c.getCenter(),zoom:C};var U=x.subtract(g).divideBy(2),Q=this.project(c.getSouthWest(),C),ye=this.project(c.getNorthEast(),C);return{center:this.unproject(Q.add(ye).divideBy(2).add(U),C),zoom:C}},fitBounds:function(c,v){if(!(c=_i(c)).isValid())throw new Error("Bounds are not valid.");var g=this._getBoundsCenterZoom(c,v);return this.setView(g.center,g.zoom,v)},fitWorld:function(c){return this.fitBounds([[-90,-180],[90,180]],c)},panTo:function(c,v){return this.setView(c,this._zoom,{pan:v})},panBy:function(c,v){if(v=v||{},!(c=Sn(c).round()).x&&!c.y)return this.fire("moveend");if(!0!==v.animate&&!this.getSize().contains(c))return this._resetView(this.unproject(this.project(this.getCenter()).add(c)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Vs,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),v.noMoveStart||this.fire("movestart"),!1!==v.animate){Hi(this._mapPane,"leaflet-pan-anim");var g=this._getMapPanePos().subtract(c).round();this._panAnim.run(this._mapPane,g,v.duration||.25,v.easeLinearity)}else this._rawPanBy(c),this.fire("move").fire("moveend");return this},flyTo:function(c,v,g){if(!1===(g=g||{}).animate||!nt.any3d)return this.setView(c,v,g);this._stop();var x=this.project(this.getCenter()),C=this.project(c),U=this.getSize(),Q=this._zoom;c=ui(c),v=void 0===v?Q:v;var ye=Math.max(U.x,U.y),Pe=ye*this.getZoomScale(Q,v),Ze=C.distanceTo(x)||1,zt=1.42,qn=zt*zt;function Pi(Ls){var Fs=(Pe*Pe-ye*ye+(Ls?-1:1)*qn*qn*Ze*Ze)/(2*(Ls?Pe:ye)*qn*Ze),Nl=Math.sqrt(Fs*Fs+1)-Fs;return Nl<1e-9?-18:Math.log(Nl)}function Vi(Ls){return(Math.exp(Ls)-Math.exp(-Ls))/2}function ro(Ls){return(Math.exp(Ls)+Math.exp(-Ls))/2}var Zs=Pi(0);function kl(Ls){return ye*(ro(Zs)*function co(Ls){return Vi(Ls)/ro(Ls)}(Zs+zt*Ls)-Vi(Zs))/qn}var El=Date.now(),Gs=(Pi(1)-Zs)/zt,lu=g.duration?1e3*g.duration:1e3*Gs*.8;return this._moveStart(!0,g.noMoveStart),function Cl(){var Ls=(Date.now()-El)/lu,uc=function dl(Ls){return 1-Math.pow(1-Ls,1.5)}(Ls)*Gs;Ls<=1?(this._flyToFrame=ii(Cl,this),this._move(this.unproject(x.add(C.subtract(x).multiplyBy(kl(uc)/Ze)),Q),this.getScaleZoom(ye/function Tl(Ls){return ye*(ro(Zs)/ro(Zs+zt*Ls))}(uc),Q),{flyTo:!0})):this._move(c,v)._moveEnd(!0)}.call(this),this},flyToBounds:function(c,v){var g=this._getBoundsCenterZoom(c,v);return this.flyTo(g.center,g.zoom,v)},setMaxBounds:function(c){return c=_i(c),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),c.isValid()?(this.options.maxBounds=c,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(c){var v=this.options.minZoom;return this.options.minZoom=c,this._loaded&&v!==c&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(c):this},setMaxZoom:function(c){var v=this.options.maxZoom;return this.options.maxZoom=c,this._loaded&&v!==c&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(c):this},panInsideBounds:function(c,v){this._enforcingBounds=!0;var g=this.getCenter(),x=this._limitCenter(g,this._zoom,_i(c));return g.equals(x)||this.panTo(x,v),this._enforcingBounds=!1,this},panInside:function(c,v){var g=Sn((v=v||{}).paddingTopLeft||v.padding||[0,0]),x=Sn(v.paddingBottomRight||v.padding||[0,0]),C=this.project(this.getCenter()),U=this.project(c),Q=this.getPixelBounds(),ye=mr([Q.min.add(g),Q.max.subtract(x)]),Pe=ye.getSize();if(!ye.contains(U)){this._enforcingBounds=!0;var Ze=U.subtract(ye.getCenter()),zt=ye.extend(U).getSize().subtract(Pe);C.x+=Ze.x<0?-zt.x:zt.x,C.y+=Ze.y<0?-zt.y:zt.y,this.panTo(this.unproject(C),v),this._enforcingBounds=!1}return this},invalidateSize:function(c){if(!this._loaded)return this;c=N({animate:!1,pan:!0},!0===c?{animate:!0}:c);var v=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var g=this.getSize(),x=v.divideBy(2).round(),C=g.divideBy(2).round(),U=x.subtract(C);return U.x||U.y?(c.animate&&c.pan?this.panBy(U):(c.pan&&this._rawPanBy(U),this.fire("move"),c.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(l(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:v,newSize:g})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(c){if(c=this._locateOptions=N({timeout:1e4,watch:!1},c),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var v=l(this._handleGeolocationResponse,this),g=l(this._handleGeolocationError,this);return c.watch?this._locationWatchId=navigator.geolocation.watchPosition(v,g,c):navigator.geolocation.getCurrentPosition(v,g,c),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(c){if(this._container._leaflet_id){var v=c.code,g=c.message||(1===v?"permission denied":2===v?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:v,message:"Geolocation error: "+g+"."})}},_handleGeolocationResponse:function(c){if(this._container._leaflet_id){var x=new Ki(c.coords.latitude,c.coords.longitude),C=x.toBounds(2*c.coords.accuracy),U=this._locateOptions;if(U.setView){var Q=this.getBoundsZoom(C);this.setView(x,U.maxZoom?Math.min(Q,U.maxZoom):Q)}var ye={latlng:x,bounds:C,timestamp:c.timestamp};for(var Pe in c.coords)"number"==typeof c.coords[Pe]&&(ye[Pe]=c.coords[Pe]);this.fire("locationfound",ye)}},addHandler:function(c,v){if(!v)return this;var g=this[c]=new v(this);return this._handlers.push(g),this.options[c]&&g.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(v){this._container._leaflet_id=void 0,this._containerId=void 0}var c;for(c in void 0!==this._locationWatchId&&this.stopLocate(),this._stop(),yi(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(kn(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload"),this._layers)this._layers[c].remove();for(c in this._panes)yi(this._panes[c]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(c,v){var x=Gi("div","leaflet-pane"+(c?" leaflet-"+c.replace("Pane","")+"-pane":""),v||this._mapPane);return c&&(this._panes[c]=x),x},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var c=this.getPixelBounds();return new wi(this.unproject(c.getBottomLeft()),this.unproject(c.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(c,v,g){c=_i(c),g=Sn(g||[0,0]);var x=this.getZoom()||0,C=this.getMinZoom(),U=this.getMaxZoom(),Q=c.getNorthWest(),ye=c.getSouthEast(),Pe=this.getSize().subtract(g),Ze=mr(this.project(ye,x),this.project(Q,x)).getSize(),zt=nt.any3d?this.options.zoomSnap:1,qn=Pe.x/Ze.x,Pi=Pe.y/Ze.y,Vi=v?Math.max(qn,Pi):Math.min(qn,Pi);return x=this.getScaleZoom(Vi,x),zt&&(x=Math.round(x/(zt/100))*(zt/100),x=v?Math.ceil(x/zt)*zt:Math.floor(x/zt)*zt),Math.max(C,Math.min(U,x))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new Yt(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(c,v){var g=this._getTopLeftPoint(c,v);return new Mi(g,g.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(c){return this.options.crs.getProjectedBounds(void 0===c?this.getZoom():c)},getPane:function(c){return"string"==typeof c?this._panes[c]:c},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(c,v){var g=this.options.crs;return v=void 0===v?this._zoom:v,g.scale(c)/g.scale(v)},getScaleZoom:function(c,v){var g=this.options.crs,x=g.zoom(c*g.scale(v=void 0===v?this._zoom:v));return isNaN(x)?1/0:x},project:function(c,v){return v=void 0===v?this._zoom:v,this.options.crs.latLngToPoint(ui(c),v)},unproject:function(c,v){return v=void 0===v?this._zoom:v,this.options.crs.pointToLatLng(Sn(c),v)},layerPointToLatLng:function(c){var v=Sn(c).add(this.getPixelOrigin());return this.unproject(v)},latLngToLayerPoint:function(c){return this.project(ui(c))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(c){return this.options.crs.wrapLatLng(ui(c))},wrapLatLngBounds:function(c){return this.options.crs.wrapLatLngBounds(_i(c))},distance:function(c,v){return this.options.crs.distance(ui(c),ui(v))},containerPointToLayerPoint:function(c){return Sn(c).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(c){return Sn(c).add(this._getMapPanePos())},containerPointToLatLng:function(c){var v=this.containerPointToLayerPoint(Sn(c));return this.layerPointToLatLng(v)},latLngToContainerPoint:function(c){return this.layerPointToContainerPoint(this.latLngToLayerPoint(ui(c)))},mouseEventToContainerPoint:function(c){return Ms(c,this._container)},mouseEventToLayerPoint:function(c){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(c))},mouseEventToLatLng:function(c){return this.layerPointToLatLng(this.mouseEventToLayerPoint(c))},_initContainer:function(c){var v=this._container=Fi(c);if(!v)throw new Error("Map container not found.");if(v._leaflet_id)throw new Error("Map container is already initialized.");Qi(v,"scroll",this._onScroll,this),this._containerId=lt(v)},_initLayout:function(){var c=this._container;this._fadeAnimated=this.options.fadeAnimation&&nt.any3d,Hi(c,"leaflet-container"+(nt.touch?" leaflet-touch":"")+(nt.retina?" leaflet-retina":"")+(nt.ielt9?" leaflet-oldie":"")+(nt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var v=Xi(c,"position");"absolute"!==v&&"relative"!==v&&"fixed"!==v&&(c.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var c=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),xr(this._mapPane,new Yt(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Hi(c.markerPane,"leaflet-zoom-hide"),Hi(c.shadowPane,"leaflet-zoom-hide"))},_resetView:function(c,v,g){xr(this._mapPane,new Yt(0,0));var x=!this._loaded;this._loaded=!0,v=this._limitZoom(v),this.fire("viewprereset");var C=this._zoom!==v;this._moveStart(C,g)._move(c,v)._moveEnd(C),this.fire("viewreset"),x&&this.fire("load")},_moveStart:function(c,v){return c&&this.fire("zoomstart"),v||this.fire("movestart"),this},_move:function(c,v,g,x){void 0===v&&(v=this._zoom);var C=this._zoom!==v;return this._zoom=v,this._lastCenter=c,this._pixelOrigin=this._getNewPixelOrigin(c),x?g&&g.pinch&&this.fire("zoom",g):((C||g&&g.pinch)&&this.fire("zoom",g),this.fire("move",g)),this},_moveEnd:function(c){return c&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return kn(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(c){xr(this._mapPane,this._getMapPanePos().subtract(c))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(c){this._targets={},this._targets[lt(this._container)]=this;var v=c?Qr:Qi;v(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&v(window,"resize",this._onResize,this),nt.any3d&&this.options.transform3DLimit&&(c?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){kn(this._resizeRequest),this._resizeRequest=ii(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var c=this._getMapPanePos();Math.max(Math.abs(c.x),Math.abs(c.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(c,v){for(var x,g=[],C="mouseout"===v||"mouseover"===v,U=c.target||c.srcElement,Q=!1;U;){if((x=this._targets[lt(U)])&&("click"===v||"preclick"===v)&&this._draggableMoved(x)){Q=!0;break}if(x&&x.listens(v,!0)&&(C&&!ds(U,c)||(g.push(x),C))||U===this._container)break;U=U.parentNode}return!g.length&&!Q&&!C&&this.listens(v,!0)&&(g=[this]),g},_isClickDisabled:function(c){for(;c&&c!==this._container;){if(c._leaflet_disable_click)return!0;c=c.parentNode}},_handleDOMEvent:function(c){var v=c.target||c.srcElement;if(!(!this._loaded||v._leaflet_disable_events||"click"===c.type&&this._isClickDisabled(v))){var g=c.type;"mousedown"===g&&va(v),this._fireDOMEvent(c,g)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(c,v,g){if("click"===c.type){var x=N({},c);x.type="preclick",this._fireDOMEvent(x,x.type,g)}var C=this._findEventTargets(c,v);if(g){for(var U=[],Q=0;Q<g.length;Q++)g[Q].listens(v,!0)&&U.push(g[Q]);C=U.concat(C)}if(C.length){"contextmenu"===v&&eo(c);var ye=C[0],Pe={originalEvent:c};if("keypress"!==c.type&&"keydown"!==c.type&&"keyup"!==c.type){var Ze=ye.getLatLng&&(!ye._radius||ye._radius<=10);Pe.containerPoint=Ze?this.latLngToContainerPoint(ye.getLatLng()):this.mouseEventToContainerPoint(c),Pe.layerPoint=this.containerPointToLayerPoint(Pe.containerPoint),Pe.latlng=Ze?ye.getLatLng():this.layerPointToLatLng(Pe.layerPoint)}for(Q=0;Q<C.length;Q++)if(C[Q].fire(v,Pe,!0),Pe.originalEvent._stopped||!1===C[Q].options.bubblingMouseEvents&&-1!==kt(this._mouseEvents,v))return}},_draggableMoved:function(c){return(c=c.dragging&&c.dragging.enabled()?c:this).dragging&&c.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var c=0,v=this._handlers.length;c<v;c++)this._handlers[c].disable()},whenReady:function(c,v){return this._loaded?c.call(v||this,{target:this}):this.on("load",c,v),this},_getMapPanePos:function(){return zr(this._mapPane)||new Yt(0,0)},_moved:function(){var c=this._getMapPanePos();return c&&!c.equals([0,0])},_getTopLeftPoint:function(c,v){return(c&&void 0!==v?this._getNewPixelOrigin(c,v):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(c,v){var g=this.getSize()._divideBy(2);return this.project(c,v)._subtract(g)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(c,v,g){var x=this._getNewPixelOrigin(g,v);return this.project(c,v)._subtract(x)},_latLngBoundsToNewLayerBounds:function(c,v,g){var x=this._getNewPixelOrigin(g,v);return mr([this.project(c.getSouthWest(),v)._subtract(x),this.project(c.getNorthWest(),v)._subtract(x),this.project(c.getSouthEast(),v)._subtract(x),this.project(c.getNorthEast(),v)._subtract(x)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(c){return this.latLngToLayerPoint(c).subtract(this._getCenterLayerPoint())},_limitCenter:function(c,v,g){if(!g)return c;var x=this.project(c,v),C=this.getSize().divideBy(2),U=new Mi(x.subtract(C),x.add(C)),Q=this._getBoundsOffset(U,g,v);return Q.round().equals([0,0])?c:this.unproject(x.add(Q),v)},_limitOffset:function(c,v){if(!v)return c;var g=this.getPixelBounds(),x=new Mi(g.min.add(c),g.max.add(c));return c.add(this._getBoundsOffset(x,v))},_getBoundsOffset:function(c,v,g){var x=mr(this.project(v.getNorthEast(),g),this.project(v.getSouthWest(),g)),C=x.min.subtract(c.min),U=x.max.subtract(c.max);return new Yt(this._rebound(C.x,-U.x),this._rebound(C.y,-U.y))},_rebound:function(c,v){return c+v>0?Math.round(c-v)/2:Math.max(0,Math.ceil(c))-Math.max(0,Math.floor(v))},_limitZoom:function(c){var v=this.getMinZoom(),g=this.getMaxZoom(),x=nt.any3d?this.options.zoomSnap:1;return x&&(c=Math.round(c/x)*x),Math.max(v,Math.min(g,c))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){lr(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(c,v){var g=this._getCenterOffset(c)._trunc();return!(!0!==(v&&v.animate)&&!this.getSize().contains(g)||(this.panBy(g,v),0))},_createAnimProxy:function(){var c=this._proxy=Gi("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(c),this.on("zoomanim",function(v){var g=Mr,x=this._proxy.style[g];po(this._proxy,this.project(v.center,v.zoom),this.getZoomScale(v.zoom,1)),x===this._proxy.style[g]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){yi(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var c=this.getCenter(),v=this.getZoom();po(this._proxy,this.project(c,v),this.getZoomScale(v,1))},_catchTransitionEnd:function(c){this._animatingZoom&&c.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(c,v,g){if(this._animatingZoom)return!0;if(g=g||{},!this._zoomAnimated||!1===g.animate||this._nothingToAnimate()||Math.abs(v-this._zoom)>this.options.zoomAnimationThreshold)return!1;var x=this.getZoomScale(v),C=this._getCenterOffset(c)._divideBy(1-1/x);return!(!0!==g.animate&&!this.getSize().contains(C)||(ii(function(){this._moveStart(!0,!1)._animateZoom(c,v,!0)},this),0))},_animateZoom:function(c,v,g,x){!this._mapPane||(g&&(this._animatingZoom=!0,this._animateToCenter=c,this._animateToZoom=v,Hi(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:c,zoom:v,noUpdate:x}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(l(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){!this._animatingZoom||(this._mapPane&&lr(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});var js=Jt.extend({options:{position:"topright"},initialize:function(c){Bt(this,c)},getPosition:function(){return this.options.position},setPosition:function(c){var v=this._map;return v&&v.removeControl(this),this.options.position=c,v&&v.addControl(this),this},getContainer:function(){return this._container},addTo:function(c){this.remove(),this._map=c;var v=this._container=this.onAdd(c),g=this.getPosition(),x=c._controlCorners[g];return Hi(v,"leaflet-control"),-1!==g.indexOf("bottom")?x.insertBefore(v,x.firstChild):x.appendChild(v),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(yi(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(c){this._map&&c&&c.screenX>0&&c.screenY>0&&this._map.getContainer().focus()}}),ps=function(c){return new js(c)};Wr.include({addControl:function(c){return c.addTo(this),this},removeControl:function(c){return c.remove(),this},_initControlPos:function(){var c=this._controlCorners={},v="leaflet-",g=this._controlContainer=Gi("div",v+"control-container",this._container);function x(C,U){c[C+U]=Gi("div",v+C+" "+v+U,g)}x("top","left"),x("top","right"),x("bottom","left"),x("bottom","right")},_clearControlPos:function(){for(var c in this._controlCorners)yi(this._controlCorners[c]);yi(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Wa=js.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(c,v,g,x){return g<x?-1:x<g?1:0}},initialize:function(c,v,g){for(var x in Bt(this,g),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,c)this._addLayer(c[x],x);for(x in v)this._addLayer(v[x],x,!0)},onAdd:function(c){this._initLayout(),this._update(),this._map=c,c.on("zoomend",this._checkDisabledLayers,this);for(var v=0;v<this._layers.length;v++)this._layers[v].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(c){return js.prototype.addTo.call(this,c),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var c=0;c<this._layers.length;c++)this._layers[c].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(c,v){return this._addLayer(c,v),this._map?this._update():this},addOverlay:function(c,v){return this._addLayer(c,v,!0),this._map?this._update():this},removeLayer:function(c){c.off("add remove",this._onLayerChange,this);var v=this._getLayer(lt(c));return v&&this._layers.splice(this._layers.indexOf(v),1),this._map?this._update():this},expand:function(){Hi(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var c=this._map.getSize().y-(this._container.offsetTop+50);return c<this._section.clientHeight?(Hi(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=c+"px"):lr(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return lr(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var c="leaflet-control-layers",v=this._container=Gi("div",c),g=this.options.collapsed;v.setAttribute("aria-haspopup",!0),Mo(v),Oo(v);var x=this._section=Gi("section",c+"-list");g&&(this._map.on("click",this.collapse,this),Qi(v,{mouseenter:function(){Qi(x,"click",eo),this.expand(),setTimeout(function(){Qr(x,"click",eo)})},mouseleave:this.collapse},this));var C=this._layersLink=Gi("a",c+"-toggle",v);C.href="#",C.title="Layers",C.setAttribute("role","button"),Qi(C,"click",eo),Qi(C,"focus",this.expand,this),g||this.expand(),this._baseLayersList=Gi("div",c+"-base",x),this._separator=Gi("div",c+"-separator",x),this._overlaysList=Gi("div",c+"-overlays",x),v.appendChild(x)},_getLayer:function(c){for(var v=0;v<this._layers.length;v++)if(this._layers[v]&&lt(this._layers[v].layer)===c)return this._layers[v]},_addLayer:function(c,v,g){this._map&&c.on("add remove",this._onLayerChange,this),this._layers.push({layer:c,name:v,overlay:g}),this.options.sortLayers&&this._layers.sort(l(function(x,C){return this.options.sortFunction(x.layer,C.layer,x.name,C.name)},this)),this.options.autoZIndex&&c.setZIndex&&(this._lastZIndex++,c.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Ji(this._baseLayersList),Ji(this._overlaysList),this._layerControlInputs=[];var c,v,g,x,C=0;for(g=0;g<this._layers.length;g++)this._addItem(x=this._layers[g]),v=v||x.overlay,c=c||!x.overlay,C+=x.overlay?0:1;return this.options.hideSingleBase&&(this._baseLayersList.style.display=(c=c&&C>1)?"":"none"),this._separator.style.display=v&&c?"":"none",this},_onLayerChange:function(c){this._handlingClick||this._update();var v=this._getLayer(lt(c.target)),g=v.overlay?"add"===c.type?"overlayadd":"overlayremove":"add"===c.type?"baselayerchange":null;g&&this._map.fire(g,v)},_createRadioElement:function(c,v){var g='<input type="radio" class="leaflet-control-layers-selector" name="'+c+'"'+(v?' checked="checked"':"")+"/>",x=document.createElement("div");return x.innerHTML=g,x.firstChild},_addItem:function(c){var x,v=document.createElement("label"),g=this._map.hasLayer(c.layer);c.overlay?((x=document.createElement("input")).type="checkbox",x.className="leaflet-control-layers-selector",x.defaultChecked=g):x=this._createRadioElement("leaflet-base-layers_"+lt(this),g),this._layerControlInputs.push(x),x.layerId=lt(c.layer),Qi(x,"click",this._onInputClick,this);var C=document.createElement("span");C.innerHTML=" "+c.name;var U=document.createElement("span");return v.appendChild(U),U.appendChild(x),U.appendChild(C),(c.overlay?this._overlaysList:this._baseLayersList).appendChild(v),this._checkDisabledLayers(),v},_onInputClick:function(){var v,g,c=this._layerControlInputs,x=[],C=[];this._handlingClick=!0;for(var U=c.length-1;U>=0;U--)g=this._getLayer((v=c[U]).layerId).layer,v.checked?x.push(g):v.checked||C.push(g);for(U=0;U<C.length;U++)this._map.hasLayer(C[U])&&this._map.removeLayer(C[U]);for(U=0;U<x.length;U++)this._map.hasLayer(x[U])||this._map.addLayer(x[U]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var v,g,c=this._layerControlInputs,x=this._map.getZoom(),C=c.length-1;C>=0;C--)g=this._getLayer((v=c[C]).layerId).layer,v.disabled=void 0!==g.options.minZoom&&x<g.options.minZoom||void 0!==g.options.maxZoom&&x>g.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this}}),V=js.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(c){var v="leaflet-control-zoom",g=Gi("div",v+" leaflet-bar"),x=this.options;return this._zoomInButton=this._createButton(x.zoomInText,x.zoomInTitle,v+"-in",g,this._zoomIn),this._zoomOutButton=this._createButton(x.zoomOutText,x.zoomOutTitle,v+"-out",g,this._zoomOut),this._updateDisabled(),c.on("zoomend zoomlevelschange",this._updateDisabled,this),g},onRemove:function(c){c.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(c){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(c.shiftKey?3:1))},_zoomOut:function(c){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(c.shiftKey?3:1))},_createButton:function(c,v,g,x,C){var U=Gi("a",g,x);return U.innerHTML=c,U.href="#",U.title=v,U.setAttribute("role","button"),U.setAttribute("aria-label",v),Mo(U),Qi(U,"click",Xo),Qi(U,"click",C,this),Qi(U,"click",this._refocusOnMap,this),U},_updateDisabled:function(){var c=this._map,v="leaflet-disabled";lr(this._zoomInButton,v),lr(this._zoomOutButton,v),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||c._zoom===c.getMinZoom())&&(Hi(this._zoomOutButton,v),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||c._zoom===c.getMaxZoom())&&(Hi(this._zoomInButton,v),this._zoomInButton.setAttribute("aria-disabled","true"))}});Wr.mergeOptions({zoomControl:!0}),Wr.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new V,this.addControl(this.zoomControl))});var ce=js.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(c){var v="leaflet-control-scale",g=Gi("div",v),x=this.options;return this._addScales(x,v+"-line",g),c.on(x.updateWhenIdle?"moveend":"move",this._update,this),c.whenReady(this._update,this),g},onRemove:function(c){c.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(c,v,g){c.metric&&(this._mScale=Gi("div",v,g)),c.imperial&&(this._iScale=Gi("div",v,g))},_update:function(){var c=this._map,v=c.getSize().y/2,g=c.distance(c.containerPointToLatLng([0,v]),c.containerPointToLatLng([this.options.maxWidth,v]));this._updateScales(g)},_updateScales:function(c){this.options.metric&&c&&this._updateMetric(c),this.options.imperial&&c&&this._updateImperial(c)},_updateMetric:function(c){var v=this._getRoundNum(c);this._updateScale(this._mScale,v<1e3?v+" m":v/1e3+" km",v/c)},_updateImperial:function(c){var g,x,C,v=3.2808399*c;v>5280?(x=this._getRoundNum(g=v/5280),this._updateScale(this._iScale,x+" mi",x/g)):(C=this._getRoundNum(v),this._updateScale(this._iScale,C+" ft",C/v))},_updateScale:function(c,v,g){c.style.width=Math.round(this.options.maxWidth*g)+"px",c.innerHTML=v},_getRoundNum:function(c){var v=Math.pow(10,(Math.floor(c)+"").length-1),g=c/v;return v*(g>=10?10:g>=5?5:g>=3?3:g>=2?2:1)}}),Le=js.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(nt.inlineSvg?'<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg> ':"")+"Leaflet</a>"},initialize:function(c){Bt(this,c),this._attributions={}},onAdd:function(c){for(var v in c.attributionControl=this,this._container=Gi("div","leaflet-control-attribution"),Mo(this._container),c._layers)c._layers[v].getAttribution&&this.addAttribution(c._layers[v].getAttribution());return this._update(),c.on("layeradd",this._addAttribution,this),this._container},onRemove:function(c){c.off("layeradd",this._addAttribution,this)},_addAttribution:function(c){c.layer.getAttribution&&(this.addAttribution(c.layer.getAttribution()),c.layer.once("remove",function(){this.removeAttribution(c.layer.getAttribution())},this))},setPrefix:function(c){return this.options.prefix=c,this._update(),this},addAttribution:function(c){return c?(this._attributions[c]||(this._attributions[c]=0),this._attributions[c]++,this._update(),this):this},removeAttribution:function(c){return c?(this._attributions[c]&&(this._attributions[c]--,this._update()),this):this},_update:function(){if(this._map){var c=[];for(var v in this._attributions)this._attributions[v]&&c.push(v);var g=[];this.options.prefix&&g.push(this.options.prefix),c.length&&g.push(c.join(", ")),this._container.innerHTML=g.join(' <span aria-hidden="true">|</span> ')}}});Wr.mergeOptions({attributionControl:!0}),Wr.addInitHook(function(){this.options.attributionControl&&(new Le).addTo(this)});js.Layers=Wa,js.Zoom=V,js.Scale=ce,js.Attribution=Le,ps.layers=function(c,v,g){return new Wa(c,v,g)},ps.zoom=function(c){return new V(c)},ps.scale=function(c){return new ce(c)},ps.attribution=function(c){return new Le(c)};var le=Jt.extend({initialize:function(c){this._map=c},enable:function(){return this._enabled||(this._enabled=!0,this.addHooks()),this},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});le.addTo=function(c,v){return c.addHandler(v,this),this};var ji,ee={Events:en},be=nt.touch?"touchstart mousedown":"mousedown",je=an.extend({options:{clickTolerance:3},initialize:function(c,v,g,x){Bt(this,x),this._element=c,this._dragStartTarget=v||c,this._preventOutline=g},enable:function(){this._enabled||(Qi(this._dragStartTarget,be,this._onDown,this),this._enabled=!0)},disable:function(){!this._enabled||(je._dragging===this&&this.finishDrag(!0),Qr(this._dragStartTarget,be,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(c){if(this._enabled&&(this._moved=!1,!Ss(this._element,"leaflet-zoom-anim"))){if(c.touches&&1!==c.touches.length)return void(je._dragging===this&&this.finishDrag());if(!(je._dragging||c.shiftKey||1!==c.which&&1!==c.button&&!c.touches||(je._dragging=this,this._preventOutline&&va(this._element),ya(),rs(),this._moving))){this.fire("down");var v=c.touches?c.touches[0]:c,g=$o(this._element);this._startPoint=new Yt(v.clientX,v.clientY),this._startPos=zr(this._element),this._parentScale=ha(g);var x="mousedown"===c.type;Qi(document,x?"mousemove":"touchmove",this._onMove,this),Qi(document,x?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(c){if(this._enabled){if(c.touches&&c.touches.length>1)return void(this._moved=!0);var v=c.touches&&1===c.touches.length?c.touches[0]:c,g=new Yt(v.clientX,v.clientY)._subtract(this._startPoint);!g.x&&!g.y||Math.abs(g.x)+Math.abs(g.y)<this.options.clickTolerance||(g.x/=this._parentScale.x,g.y/=this._parentScale.y,eo(c),this._moved||(this.fire("dragstart"),this._moved=!0,Hi(document.body,"leaflet-dragging"),this._lastTarget=c.target||c.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Hi(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(g),this._moving=!0,this._lastEvent=c,this._updatePosition())}},_updatePosition:function(){var c={originalEvent:this._lastEvent};this.fire("predrag",c),xr(this._element,this._newPos),this.fire("drag",c)},_onUp:function(){!this._enabled||this.finishDrag()},finishDrag:function(c){lr(document.body,"leaflet-dragging"),this._lastTarget&&(lr(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Qr(document,"mousemove touchmove",this._onMove,this),Qr(document,"mouseup touchend touchcancel",this._onUp,this),hs(),vs(),this._moved&&this._moving&&this.fire("dragend",{noInertia:c,distance:this._newPos.distanceTo(this._startPos)}),this._moving=!1,je._dragging=!1}});function Ye(c,v){if(!v||!c.length)return c.slice();var g=v*v;return function Ui(c,v){var g=c.length,C=new(typeof Uint8Array!=void 0+""?Uint8Array:Array)(g);C[0]=C[g-1]=1,wn(c,C,v,0,g-1);var U,Q=[];for(U=0;U<g;U++)C[U]&&Q.push(c[U]);return Q}(c=function er(c,v){for(var g=[c[0]],x=1,C=0,U=c.length;x<U;x++)ge(c[x],c[C])>v&&(g.push(c[x]),C=x);return C<U-1&&g.push(c[U-1]),g}(c,g),g)}function mt(c,v,g){return Math.sqrt(he(c,v,g,!0))}function wn(c,v,g,x,C){var Q,ye,Pe,U=0;for(ye=x+1;ye<=C-1;ye++)(Pe=he(c[ye],c[x],c[C],!0))>U&&(Q=ye,U=Pe);U>g&&(v[Q]=1,wn(c,v,g,x,Q),wn(c,v,g,Q,C))}function Lr(c,v,g,x,C){var ye,Pe,Ze,U=x?ji:bi(c,g),Q=bi(v,g);for(ji=Q;;){if(!(U|Q))return[c,v];if(U&Q)return!1;Ze=bi(Pe=Zi(c,v,ye=U||Q,g,C),g),ye===U?(c=Pe,U=Ze):(v=Pe,Q=Ze)}}function Zi(c,v,g,x,C){var Ze,zt,U=v.x-c.x,Q=v.y-c.y,ye=x.min,Pe=x.max;return 8&g?(Ze=c.x+U*(Pe.y-c.y)/Q,zt=Pe.y):4&g?(Ze=c.x+U*(ye.y-c.y)/Q,zt=ye.y):2&g?(Ze=Pe.x,zt=c.y+Q*(Pe.x-c.x)/U):1&g&&(Ze=ye.x,zt=c.y+Q*(ye.x-c.x)/U),new Yt(Ze,zt,C)}function bi(c,v){var g=0;return c.x<v.min.x?g|=1:c.x>v.max.x&&(g|=2),c.y<v.min.y?g|=4:c.y>v.max.y&&(g|=8),g}function ge(c,v){var g=v.x-c.x,x=v.y-c.y;return g*g+x*x}function he(c,v,g,x){var Ze,C=v.x,U=v.y,Q=g.x-C,ye=g.y-U,Pe=Q*Q+ye*ye;return Pe>0&&((Ze=((c.x-C)*Q+(c.y-U)*ye)/Pe)>1?(C=g.x,U=g.y):Ze>0&&(C+=Q*Ze,U+=ye*Ze)),Q=c.x-C,ye=c.y-U,x?Q*Q+ye*ye:new Yt(C,U)}function ae(c){return!tn(c[0])||"object"!=typeof c[0][0]&&void 0!==c[0][0]}function Re(c){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),ae(c)}function gn(c,v){var g,x,C,U,Q,ye,Pe,Ze;if(!c||0===c.length)throw new Error("latlngs not passed");ae(c)||(console.warn("latlngs are not flat! Only the first ring will be used"),c=c[0]);var zt=[];for(var qn in c)zt.push(v.project(ui(c[qn])));var Pi=zt.length;for(g=0,x=0;g<Pi-1;g++)x+=zt[g].distanceTo(zt[g+1])/2;if(0===x)Ze=zt[0];else for(g=0,U=0;g<Pi-1;g++)if((U+=C=(Q=zt[g]).distanceTo(ye=zt[g+1]))>x){Ze=[ye.x-(Pe=(U-x)/C)*(ye.x-Q.x),ye.y-Pe*(ye.y-Q.y)];break}return v.unproject(Sn(Ze))}var xi={__proto__:null,simplify:Ye,pointToSegmentDistance:mt,closestPointOnSegment:function On(c,v,g){return he(c,v,g)},clipSegment:Lr,_getEdgeIntersection:Zi,_getBitCode:bi,_sqClosestPointOnSegment:he,isFlat:ae,_flat:Re,polylineCenter:gn};function vi(c,v,g){var x,U,Q,ye,Pe,Ze,zt,qn,Pi,C=[1,4,2,8];for(U=0,zt=c.length;U<zt;U++)c[U]._code=bi(c[U],v);for(ye=0;ye<4;ye++){for(qn=C[ye],x=[],U=0,Q=(zt=c.length)-1;U<zt;Q=U++)Ze=c[Q],(Pe=c[U])._code&qn?Ze._code&qn||((Pi=Zi(Ze,Pe,qn,v,g))._code=bi(Pi,v),x.push(Pi)):(Ze._code&qn&&((Pi=Zi(Ze,Pe,qn,v,g))._code=bi(Pi,v),x.push(Pi)),x.push(Pe));c=x}return c}function Jo(c,v){var g,x,C,U,Q,ye,Pe,Ze;if(!c||0===c.length)throw new Error("latlngs not passed");ae(c)||(console.warn("latlngs are not flat! Only the first ring will be used"),c=c[0]);var qn=[];for(var Pi in c)qn.push(v.project(ui(c[Pi])));var Vi=qn.length;for(ye=Pe=Ze=0,g=0,x=Vi-1;g<Vi;x=g++)Pe+=((C=qn[g]).x+(U=qn[x]).x)*(Q=C.y*U.x-U.y*C.x),Ze+=(C.y+U.y)*Q,ye+=3*Q;return v.unproject(Sn(0===ye?qn[0]:[Pe/ye,Ze/ye]))}var ms={__proto__:null,clipPolygon:vi,polygonCenter:Jo},bs={project:function(c){return new Yt(c.lng,c.lat)},unproject:function(c){return new Ki(c.y,c.x)},bounds:new Mi([-180,-90],[180,90])},No={R:6378137,R_MINOR:6356752.314245179,bounds:new Mi([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(c){var v=Math.PI/180,g=this.R,x=c.lat*v,C=this.R_MINOR/g,U=Math.sqrt(1-C*C),Q=U*Math.sin(x),ye=Math.tan(Math.PI/4-x/2)/Math.pow((1-Q)/(1+Q),U/2);return x=-g*Math.log(Math.max(ye,1e-10)),new Yt(c.lng*v*g,x)},unproject:function(c){for(var Ze,v=180/Math.PI,g=this.R,x=this.R_MINOR/g,C=Math.sqrt(1-x*x),U=Math.exp(-c.y/g),Q=Math.PI/2-2*Math.atan(U),ye=0,Pe=.1;ye<15&&Math.abs(Pe)>1e-7;ye++)Ze=C*Math.sin(Q),Ze=Math.pow((1-Ze)/(1+Ze),C/2),Q+=Pe=Math.PI/2-2*Math.atan(U*Ze)-Q;return new Ki(Q*v,c.x*v/g)}},xs={__proto__:null,LonLat:bs,Mercator:No,SphericalMercator:oi},ka=N({},Br,{code:"EPSG:3395",projection:No,transformation:function(){var c=.5/(Math.PI*No.R);return En(c,.5,-c,.5)}()}),ta=N({},Br,{code:"EPSG:4326",projection:bs,transformation:En(1/180,1,-1/180,.5)}),Hn=N({},Ti,{projection:bs,transformation:En(1,0,-1,0),scale:function(c){return Math.pow(2,c)},zoom:function(c){return Math.log(c)/Math.LN2},distance:function(c,v){var g=v.lng-c.lng,x=v.lat-c.lat;return Math.sqrt(g*g+x*x)},infinite:!0});Ti.Earth=Br,Ti.EPSG3395=ka,Ti.EPSG3857=si,Ti.EPSG900913=fi,Ti.EPSG4326=ta,Ti.Simple=Hn;var ki=an.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(c){return c.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(c){return c&&c.removeLayer(this),this},getPane:function(c){return this._map.getPane(c?this.options[c]||c:this.options.pane)},addInteractiveTarget:function(c){return this._map._targets[lt(c)]=this,this},removeInteractiveTarget:function(c){return delete this._map._targets[lt(c)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(c){var v=c.target;if(v.hasLayer(this)){if(this._map=v,this._zoomAnimated=v._zoomAnimated,this.getEvents){var g=this.getEvents();v.on(g,this),this.once("remove",function(){v.off(g,this)},this)}this.onAdd(v),this.fire("add"),v.fire("layeradd",{layer:this})}}});Wr.include({addLayer:function(c){if(!c._layerAdd)throw new Error("The provided object is not a Layer.");var v=lt(c);return this._layers[v]||(this._layers[v]=c,c._mapToAdd=this,c.beforeAdd&&c.beforeAdd(this),this.whenReady(c._layerAdd,c)),this},removeLayer:function(c){var v=lt(c);return this._layers[v]?(this._loaded&&c.onRemove(this),delete this._layers[v],this._loaded&&(this.fire("layerremove",{layer:c}),c.fire("remove")),c._map=c._mapToAdd=null,this):this},hasLayer:function(c){return lt(c)in this._layers},eachLayer:function(c,v){for(var g in this._layers)c.call(v,this._layers[g]);return this},_addLayers:function(c){for(var v=0,g=(c=c?tn(c)?c:[c]:[]).length;v<g;v++)this.addLayer(c[v])},_addZoomLimit:function(c){(!isNaN(c.options.maxZoom)||!isNaN(c.options.minZoom))&&(this._zoomBoundLayers[lt(c)]=c,this._updateZoomLevels())},_removeZoomLimit:function(c){var v=lt(c);this._zoomBoundLayers[v]&&(delete this._zoomBoundLayers[v],this._updateZoomLevels())},_updateZoomLevels:function(){var c=1/0,v=-1/0,g=this._getZoomSpan();for(var x in this._zoomBoundLayers){var C=this._zoomBoundLayers[x].options;c=void 0===C.minZoom?c:Math.min(c,C.minZoom),v=void 0===C.maxZoom?v:Math.max(v,C.maxZoom)}this._layersMaxZoom=v===-1/0?void 0:v,this._layersMinZoom=c===1/0?void 0:c,g!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Go=ki.extend({initialize:function(c,v){var g,x;if(Bt(this,v),this._layers={},c)for(g=0,x=c.length;g<x;g++)this.addLayer(c[g])},addLayer:function(c){var v=this.getLayerId(c);return this._layers[v]=c,this._map&&this._map.addLayer(c),this},removeLayer:function(c){var v=c in this._layers?c:this.getLayerId(c);return this._map&&this._layers[v]&&this._map.removeLayer(this._layers[v]),delete this._layers[v],this},hasLayer:function(c){return("number"==typeof c?c:this.getLayerId(c))in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(c){var g,x,v=Array.prototype.slice.call(arguments,1);for(g in this._layers)(x=this._layers[g])[c]&&x[c].apply(x,v);return this},onAdd:function(c){this.eachLayer(c.addLayer,c)},onRemove:function(c){this.eachLayer(c.removeLayer,c)},eachLayer:function(c,v){for(var g in this._layers)c.call(v,this._layers[g]);return this},getLayer:function(c){return this._layers[c]},getLayers:function(){var c=[];return this.eachLayer(c.push,c),c},setZIndex:function(c){return this.invoke("setZIndex",c)},getLayerId:function(c){return lt(c)}}),Na=Go.extend({addLayer:function(c){return this.hasLayer(c)?this:(c.addEventParent(this),Go.prototype.addLayer.call(this,c),this.fire("layeradd",{layer:c}))},removeLayer:function(c){return this.hasLayer(c)?(c in this._layers&&(c=this._layers[c]),c.removeEventParent(this),Go.prototype.removeLayer.call(this,c),this.fire("layerremove",{layer:c})):this},setStyle:function(c){return this.invoke("setStyle",c)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var c=new wi;for(var v in this._layers){var g=this._layers[v];c.extend(g.getBounds?g.getBounds():g.getLatLng())}return c}}),Qo=Jt.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(c){Bt(this,c)},createIcon:function(c){return this._createIcon("icon",c)},createShadow:function(c){return this._createIcon("shadow",c)},_createIcon:function(c,v){var g=this._getIconUrl(c);if(!g){if("icon"===c)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var x=this._createImg(g,v&&"IMG"===v.tagName?v:null);return this._setIconStyles(x,c),(this.options.crossOrigin||""===this.options.crossOrigin)&&(x.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),x},_setIconStyles:function(c,v){var g=this.options,x=g[v+"Size"];"number"==typeof x&&(x=[x,x]);var C=Sn(x),U=Sn("shadow"===v&&g.shadowAnchor||g.iconAnchor||C&&C.divideBy(2,!0));c.className="leaflet-marker-"+v+" "+(g.className||""),U&&(c.style.marginLeft=-U.x+"px",c.style.marginTop=-U.y+"px"),C&&(c.style.width=C.x+"px",c.style.height=C.y+"px")},_createImg:function(c,v){return(v=v||document.createElement("img")).src=c,v},_getIconUrl:function(c){return nt.retina&&this.options[c+"RetinaUrl"]||this.options[c+"Url"]}});var Ua=Qo.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(c){return"string"!=typeof Ua.imagePath&&(Ua.imagePath=this._detectIconPath()),(this.options.imagePath||Ua.imagePath)+Qo.prototype._getIconUrl.call(this,c)},_stripUrl:function(c){var v=function(g,x,C){var U=x.exec(g);return U&&U[C]};return(c=v(c,/^url\((['"])?(.+)\1\)$/,2))&&v(c,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var c=Gi("div","leaflet-default-icon-path",document.body),v=Xi(c,"background-image")||Xi(c,"backgroundImage");if(document.body.removeChild(c),v=this._stripUrl(v))return v;var g=document.querySelector('link[href$="leaflet.css"]');return g?g.href.substring(0,g.href.length-11-1):""}}),hl=le.extend({initialize:function(c){this._marker=c},addHooks:function(){var c=this._marker._icon;this._draggable||(this._draggable=new je(c,c,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Hi(c,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&lr(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(c){var v=this._marker,g=v._map,x=this._marker.options.autoPanSpeed,C=this._marker.options.autoPanPadding,U=zr(v._icon),Q=g.getPixelBounds(),ye=g.getPixelOrigin(),Pe=mr(Q.min._subtract(ye).add(C),Q.max._subtract(ye).subtract(C));if(!Pe.contains(U)){var Ze=Sn((Math.max(Pe.max.x,U.x)-Pe.max.x)/(Q.max.x-Pe.max.x)-(Math.min(Pe.min.x,U.x)-Pe.min.x)/(Q.min.x-Pe.min.x),(Math.max(Pe.max.y,U.y)-Pe.max.y)/(Q.max.y-Pe.max.y)-(Math.min(Pe.min.y,U.y)-Pe.min.y)/(Q.min.y-Pe.min.y)).multiplyBy(x);g.panBy(Ze,{animate:!1}),this._draggable._newPos._add(Ze),this._draggable._startPos._add(Ze),xr(v._icon,this._draggable._newPos),this._onDrag(c),this._panRequest=ii(this._adjustPan.bind(this,c))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(c){this._marker.options.autoPan&&(kn(this._panRequest),this._panRequest=ii(this._adjustPan.bind(this,c)))},_onDrag:function(c){var v=this._marker,g=v._shadow,x=zr(v._icon),C=v._map.layerPointToLatLng(x);g&&xr(g,x),v._latlng=C,c.latlng=C,c.oldLatLng=this._oldLatLng,v.fire("move",c).fire("drag",c)},_onDragEnd:function(c){kn(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",c)}}),Ya=ki.extend({options:{icon:new Ua,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(c,v){Bt(this,v),this._latlng=ui(c)},onAdd:function(c){this._zoomAnimated=this._zoomAnimated&&c.options.markerZoomAnimation,this._zoomAnimated&&c.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(c){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&c.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(c){var v=this._latlng;return this._latlng=ui(c),this.update(),this.fire("move",{oldLatLng:v,latlng:this._latlng})},setZIndexOffset:function(c){return this.options.zIndexOffset=c,this.update()},getIcon:function(){return this.options.icon},setIcon:function(c){return this.options.icon=c,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var c=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(c)}return this},_initIcon:function(){var c=this.options,v="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),g=c.icon.createIcon(this._icon),x=!1;g!==this._icon&&(this._icon&&this._removeIcon(),x=!0,c.title&&(g.title=c.title),"IMG"===g.tagName&&(g.alt=c.alt||"")),Hi(g,v),c.keyboard&&(g.tabIndex="0",g.setAttribute("role","button")),this._icon=g,c.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Qi(g,"focus",this._panOnFocus,this);var C=c.icon.createShadow(this._shadow),U=!1;C!==this._shadow&&(this._removeShadow(),U=!0),C&&(Hi(C,v),C.alt=""),this._shadow=C,c.opacity<1&&this._updateOpacity(),x&&this.getPane().appendChild(this._icon),this._initInteraction(),C&&U&&this.getPane(c.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Qr(this._icon,"focus",this._panOnFocus,this),yi(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&yi(this._shadow),this._shadow=null},_setPos:function(c){this._icon&&xr(this._icon,c),this._shadow&&xr(this._shadow,c),this._zIndex=c.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(c){this._icon&&(this._icon.style.zIndex=this._zIndex+c)},_animateZoom:function(c){var v=this._map._latLngToNewLayerPoint(this._latlng,c.zoom,c.center).round();this._setPos(v)},_initInteraction:function(){if(this.options.interactive&&(Hi(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),hl)){var c=this.options.draggable;this.dragging&&(c=this.dragging.enabled(),this.dragging.disable()),this.dragging=new hl(this),c&&this.dragging.enable()}},setOpacity:function(c){return this.options.opacity=c,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var c=this.options.opacity;this._icon&&Dr(this._icon,c),this._shadow&&Dr(this._shadow,c)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var c=this._map;if(c){var v=this.options.icon.options,g=v.iconSize?Sn(v.iconSize):Sn(0,0),x=v.iconAnchor?Sn(v.iconAnchor):Sn(0,0);c.panInside(this._latlng,{paddingTopLeft:x,paddingBottomRight:g.subtract(x)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});var Ws=ki.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(c){this._renderer=c.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(c){return Bt(this,c),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&c&&Object.prototype.hasOwnProperty.call(c,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),ss=Ws.extend({options:{fill:!0,radius:10},initialize:function(c,v){Bt(this,v),this._latlng=ui(c),this._radius=this.options.radius},setLatLng:function(c){var v=this._latlng;return this._latlng=ui(c),this.redraw(),this.fire("move",{oldLatLng:v,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(c){return this.options.radius=this._radius=c,this.redraw()},getRadius:function(){return this._radius},setStyle:function(c){var v=c&&c.radius||this._radius;return Ws.prototype.setStyle.call(this,c),this.setRadius(v),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var c=this._radius,v=this._radiusY||c,g=this._clickTolerance(),x=[c+g,v+g];this._pxBounds=new Mi(this._point.subtract(x),this._point.add(x))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(c){return c.distanceTo(this._point)<=this._radius+this._clickTolerance()}});var Ka=ss.extend({initialize:function(c,v,g){if("number"==typeof v&&(v=N({},g,{radius:v})),Bt(this,v),this._latlng=ui(c),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(c){return this._mRadius=c,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var c=[this._radius,this._radiusY||this._radius];return new wi(this._map.layerPointToLatLng(this._point.subtract(c)),this._map.layerPointToLatLng(this._point.add(c)))},setStyle:Ws.prototype.setStyle,_project:function(){var c=this._latlng.lng,v=this._latlng.lat,g=this._map,x=g.options.crs;if(x.distance===Br.distance){var C=Math.PI/180,U=this._mRadius/Br.R/C,Q=g.project([v+U,c]),ye=g.project([v-U,c]),Pe=Q.add(ye).divideBy(2),Ze=g.unproject(Pe).lat,zt=Math.acos((Math.cos(U*C)-Math.sin(v*C)*Math.sin(Ze*C))/(Math.cos(v*C)*Math.cos(Ze*C)))/C;(isNaN(zt)||0===zt)&&(zt=U/Math.cos(Math.PI/180*v)),this._point=Pe.subtract(g.getPixelOrigin()),this._radius=isNaN(zt)?0:Pe.x-g.project([Ze,c-zt]).x,this._radiusY=Pe.y-Q.y}else{var qn=x.unproject(x.project(this._latlng).subtract([this._mRadius,0]));this._point=g.latLngToLayerPoint(this._latlng),this._radius=this._point.x-g.latLngToLayerPoint(qn).x}this._updateBounds()}});var gs=Ws.extend({options:{smoothFactor:1,noClip:!1},initialize:function(c,v){Bt(this,v),this._setLatLngs(c)},getLatLngs:function(){return this._latlngs},setLatLngs:function(c){return this._setLatLngs(c),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(c){for(var C,U,v=1/0,g=null,x=he,Q=0,ye=this._parts.length;Q<ye;Q++)for(var Pe=this._parts[Q],Ze=1,zt=Pe.length;Ze<zt;Ze++){var qn=x(c,C=Pe[Ze-1],U=Pe[Ze],!0);qn<v&&(v=qn,g=x(c,C,U))}return g&&(g.distance=Math.sqrt(v)),g},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return gn(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(c,v){return v=v||this._defaultShape(),c=ui(c),v.push(c),this._bounds.extend(c),this.redraw()},_setLatLngs:function(c){this._bounds=new wi,this._latlngs=this._convertLatLngs(c)},_defaultShape:function(){return ae(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(c){for(var v=[],g=ae(c),x=0,C=c.length;x<C;x++)g?(v[x]=ui(c[x]),this._bounds.extend(v[x])):v[x]=this._convertLatLngs(c[x]);return v},_project:function(){var c=new Mi;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,c),this._bounds.isValid()&&c.isValid()&&(this._rawPxBounds=c,this._updateBounds())},_updateBounds:function(){var c=this._clickTolerance(),v=new Yt(c,c);!this._rawPxBounds||(this._pxBounds=new Mi([this._rawPxBounds.min.subtract(v),this._rawPxBounds.max.add(v)]))},_projectLatlngs:function(c,v,g){var U,Q,C=c.length;if(c[0]instanceof Ki){for(Q=[],U=0;U<C;U++)Q[U]=this._map.latLngToLayerPoint(c[U]),g.extend(Q[U]);v.push(Q)}else for(U=0;U<C;U++)this._projectLatlngs(c[U],v,g)},_clipPoints:function(){var c=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(c)){if(this.options.noClip)return void(this._parts=this._rings);var g,x,C,U,Q,ye,Pe,v=this._parts;for(g=0,C=0,U=this._rings.length;g<U;g++)for(x=0,Q=(Pe=this._rings[g]).length;x<Q-1;x++)(ye=Lr(Pe[x],Pe[x+1],c,x,!0))&&(v[C]=v[C]||[],v[C].push(ye[0]),(ye[1]!==Pe[x+1]||x===Q-2)&&(v[C].push(ye[1]),C++))}},_simplifyPoints:function(){for(var c=this._parts,v=this.options.smoothFactor,g=0,x=c.length;g<x;g++)c[g]=Ye(c[g],v)},_update:function(){!this._map||(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(c,v){var g,x,C,U,Q,ye,Pe=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(c))return!1;for(g=0,U=this._parts.length;g<U;g++)for(x=0,C=(Q=(ye=this._parts[g]).length)-1;x<Q;C=x++)if((v||0!==x)&&mt(c,ye[C],ye[x])<=Pe)return!0;return!1}});gs._flat=Re;var Is=gs.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Jo(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(c){var v=gs.prototype._convertLatLngs.call(this,c),g=v.length;return g>=2&&v[0]instanceof Ki&&v[0].equals(v[g-1])&&v.pop(),v},_setLatLngs:function(c){gs.prototype._setLatLngs.call(this,c),ae(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return ae(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var c=this._renderer._bounds,v=this.options.weight,g=new Yt(v,v);if(c=new Mi(c.min.subtract(g),c.max.add(g)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(c)){if(this.options.noClip)return void(this._parts=this._rings);for(var U,x=0,C=this._rings.length;x<C;x++)(U=vi(this._rings[x],c,!0)).length&&this._parts.push(U)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(c){var g,x,C,U,Q,ye,Pe,Ze,v=!1;if(!this._pxBounds||!this._pxBounds.contains(c))return!1;for(U=0,Pe=this._parts.length;U<Pe;U++)for(Q=0,ye=(Ze=(g=this._parts[U]).length)-1;Q<Ze;ye=Q++)(x=g[Q]).y>c.y!=(C=g[ye]).y>c.y&&c.x<(C.x-x.x)*(c.y-x.y)/(C.y-x.y)+x.x&&(v=!v);return v||gs.prototype._containsPoint.call(this,c,!0)}});var _s=Na.extend({initialize:function(c,v){Bt(this,v),this._layers={},c&&this.addData(c)},addData:function(c){var g,x,C,v=tn(c)?c:c.features;if(v){for(g=0,x=v.length;g<x;g++)((C=v[g]).geometries||C.geometry||C.features||C.coordinates)&&this.addData(C);return this}var U=this.options;if(U.filter&&!U.filter(c))return this;var Q=Va(c,U);return Q?(Q.feature=Xa(c),Q.defaultOptions=Q.options,this.resetStyle(Q),U.onEachFeature&&U.onEachFeature(c,Q),this.addLayer(Q)):this},resetStyle:function(c){return void 0===c?this.eachLayer(this.resetStyle,this):(c.options=N({},c.defaultOptions),this._setLayerStyle(c,this.options.style),this)},setStyle:function(c){return this.eachLayer(function(v){this._setLayerStyle(v,c)},this)},_setLayerStyle:function(c,v){c.setStyle&&("function"==typeof v&&(v=v(c.feature)),c.setStyle(v))}});function Va(c,v){var ye,Pe,Ze,zt,g="Feature"===c.type?c.geometry:c,x=g?g.coordinates:null,C=[],U=v&&v.pointToLayer,Q=v&&v.coordsToLatLng||bl;if(!x&&!g)return null;switch(g.type){case"Point":return Ia(U,c,ye=Q(x),v);case"MultiPoint":for(Ze=0,zt=x.length;Ze<zt;Ze++)ye=Q(x[Ze]),C.push(Ia(U,c,ye,v));return new Na(C);case"LineString":case"MultiLineString":return Pe=io(x,"LineString"===g.type?0:1,Q),new gs(Pe,v);case"Polygon":case"MultiPolygon":return Pe=io(x,"Polygon"===g.type?1:2,Q),new Is(Pe,v);case"GeometryCollection":for(Ze=0,zt=g.geometries.length;Ze<zt;Ze++){var qn=Va({geometry:g.geometries[Ze],type:"Feature",properties:c.properties},v);qn&&C.push(qn)}return new Na(C);case"FeatureCollection":for(Ze=0,zt=g.features.length;Ze<zt;Ze++){var Pi=Va(g.features[Ze],v);Pi&&C.push(Pi)}return new Na(C);default:throw new Error("Invalid GeoJSON object.")}}function Ia(c,v,g,x){return c?c(v,g):new Ya(g,x&&x.markersInheritOptions&&x)}function bl(c){return new Ki(c[1],c[0],c[2])}function io(c,v,g){for(var Q,x=[],C=0,U=c.length;C<U;C++)Q=v?io(c[C],v-1,g):(g||bl)(c[C]),x.push(Q);return x}function Fa(c,v){return void 0!==(c=ui(c)).alt?[_t(c.lng,v),_t(c.lat,v),_t(c.alt,v)]:[_t(c.lng,v),_t(c.lat,v)]}function Ns(c,v,g,x){for(var C=[],U=0,Q=c.length;U<Q;U++)C.push(v?Ns(c[U],ae(c[U])?0:v-1,g,x):Fa(c[U],x));return!v&&g&&C.push(C[0]),C}function es(c,v){return c.feature?N({},c.feature,{geometry:v}):Xa(v)}function Xa(c){return"Feature"===c.type||"FeatureCollection"===c.type?c:{type:"Feature",properties:{},geometry:c}}var xl={toGeoJSON:function(c){return es(this,{type:"Point",coordinates:Fa(this.getLatLng(),c)})}};function Ol(c,v){return new _s(c,v)}Ya.include(xl),Ka.include(xl),ss.include(xl),gs.include({toGeoJSON:function(c){var v=!ae(this._latlngs);return es(this,{type:(v?"Multi":"")+"LineString",coordinates:Ns(this._latlngs,v?1:0,!1,c)})}}),Is.include({toGeoJSON:function(c){var v=!ae(this._latlngs),g=v&&!ae(this._latlngs[0]),x=Ns(this._latlngs,g?2:v?1:0,!0,c);return v||(x=[x]),es(this,{type:(g?"Multi":"")+"Polygon",coordinates:x})}}),Go.include({toMultiPoint:function(c){var v=[];return this.eachLayer(function(g){v.push(g.toGeoJSON(c).geometry.coordinates)}),es(this,{type:"MultiPoint",coordinates:v})},toGeoJSON:function(c){var v=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===v)return this.toMultiPoint(c);var g="GeometryCollection"===v,x=[];return this.eachLayer(function(C){if(C.toGeoJSON){var U=C.toGeoJSON(c);if(g)x.push(U.geometry);else{var Q=Xa(U);"FeatureCollection"===Q.type?x.push.apply(x,Q.features):x.push(Q)}}}),g?es(this,{geometries:x,type:"GeometryCollection"}):{type:"FeatureCollection",features:x}}});var nl=Ol,Pa=ki.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(c,v,g){this._url=c,this._bounds=_i(v),Bt(this,g)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Hi(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){yi(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(c){return this.options.opacity=c,this._image&&this._updateOpacity(),this},setStyle:function(c){return c.opacity&&this.setOpacity(c.opacity),this},bringToFront:function(){return this._map&&Ko(this._image),this},bringToBack:function(){return this._map&&us(this._image),this},setUrl:function(c){return this._url=c,this._image&&(this._image.src=c),this},setBounds:function(c){return this._bounds=_i(c),this._map&&this._reset(),this},getEvents:function(){var c={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(c.zoomanim=this._animateZoom),c},setZIndex:function(c){return this.options.zIndex=c,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var c="IMG"===this._url.tagName,v=this._image=c?this._url:Gi("img");Hi(v,"leaflet-image-layer"),this._zoomAnimated&&Hi(v,"leaflet-zoom-animated"),this.options.className&&Hi(v,this.options.className),v.onselectstart=ct,v.onmousemove=ct,v.onload=l(this.fire,this,"load"),v.onerror=l(this._overlayOnError,this,"error"),(this.options.crossOrigin||""===this.options.crossOrigin)&&(v.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),c?this._url=v.src:(v.src=this._url,v.alt=this.options.alt)},_animateZoom:function(c){var v=this._map.getZoomScale(c.zoom),g=this._map._latLngBoundsToNewLayerBounds(this._bounds,c.zoom,c.center).min;po(this._image,g,v)},_reset:function(){var c=this._image,v=new Mi(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),g=v.getSize();xr(c,v.min),c.style.width=g.x+"px",c.style.height=g.y+"px"},_updateOpacity:function(){Dr(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&null!=this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var c=this.options.errorOverlayUrl;c&&this._url!==c&&(this._url=c,this._image.src=c)},getCenter:function(){return this._bounds.getCenter()}}),Ba=Pa.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var c="VIDEO"===this._url.tagName,v=this._image=c?this._url:Gi("video");if(Hi(v,"leaflet-image-layer"),this._zoomAnimated&&Hi(v,"leaflet-zoom-animated"),this.options.className&&Hi(v,this.options.className),v.onselectstart=ct,v.onmousemove=ct,v.onloadeddata=l(this.fire,this,"load"),c){for(var g=v.getElementsByTagName("source"),x=[],C=0;C<g.length;C++)x.push(g[C].src);this._url=g.length>0?x:[v.src]}else{tn(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(v.style,"objectFit")&&(v.style.objectFit="fill"),v.autoplay=!!this.options.autoplay,v.loop=!!this.options.loop,v.muted=!!this.options.muted,v.playsInline=!!this.options.playsInline;for(var U=0;U<this._url.length;U++){var Q=Gi("source");Q.src=this._url[U],v.appendChild(Q)}}}});var ts=Pa.extend({_initImage:function(){var c=this._image=this._url;Hi(c,"leaflet-image-layer"),this._zoomAnimated&&Hi(c,"leaflet-zoom-animated"),this.options.className&&Hi(c,this.options.className),c.onselectstart=ct,c.onmousemove=ct}});var fa=ki.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(c,v){c&&(c instanceof L.LatLng||tn(c))?(this._latlng=ui(c),Bt(this,v)):(Bt(this,c),this._source=v),this.options.content&&(this._content=this.options.content)},openOn:function(c){return(c=arguments.length?c:this._source._map).hasLayer(this)||c.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(c){return this._map?this.close():(arguments.length?this._source=c:c=this._source,this._prepareOpen(),this.openOn(c._map)),this},onAdd:function(c){this._zoomAnimated=c._zoomAnimated,this._container||this._initLayout(),c._fadeAnimated&&Dr(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),c._fadeAnimated&&Dr(this._container,1),this.bringToFront(),this.options.interactive&&(Hi(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(c){c._fadeAnimated?(Dr(this._container,0),this._removeTimeout=setTimeout(l(yi,void 0,this._container),200)):yi(this._container),this.options.interactive&&(lr(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(c){return this._latlng=ui(c),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(c){return this._content=c,this.update(),this},getElement:function(){return this._container},update:function(){!this._map||(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var c={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(c.zoomanim=this._animateZoom),c},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Ko(this._container),this},bringToBack:function(){return this._map&&us(this._container),this},_prepareOpen:function(c){var v=this._source;if(!v._map)return!1;if(v instanceof Na){v=null;var g=this._source._layers;for(var x in g)if(g[x]._map){v=g[x];break}if(!v)return!1;this._source=v}if(!c)if(v.getCenter)c=v.getCenter();else if(v.getLatLng)c=v.getLatLng();else{if(!v.getBounds)throw new Error("Unable to get source layer LatLng.");c=v.getBounds().getCenter()}return this.setLatLng(c),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var c=this._contentNode,v="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof v)c.innerHTML=v;else{for(;c.hasChildNodes();)c.removeChild(c.firstChild);c.appendChild(v)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var c=this._map.latLngToLayerPoint(this._latlng),v=Sn(this.options.offset),g=this._getAnchor();this._zoomAnimated?xr(this._container,c.add(g)):v=v.add(c).add(g);var x=this._containerBottom=-v.y,C=this._containerLeft=-Math.round(this._containerWidth/2)+v.x;this._container.style.bottom=x+"px",this._container.style.left=C+"px"}},_getAnchor:function(){return[0,0]}});Wr.include({_initOverlay:function(c,v,g,x){var C=v;return C instanceof c||(C=new c(x).setContent(v)),g&&C.setLatLng(g),C}}),ki.include({_initOverlay:function(c,v,g,x){var C=g;return C instanceof c?(Bt(C,x),C._source=this):(C=v&&!x?v:new c(x,this)).setContent(g),C}});var wl=fa.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(c){return!(c=arguments.length?c:this._source._map).hasLayer(this)&&c._popup&&c._popup.options.autoClose&&c.removeLayer(c._popup),c._popup=this,fa.prototype.openOn.call(this,c)},onAdd:function(c){fa.prototype.onAdd.call(this,c),c.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Ws||this._source.on("preclick",qs))},onRemove:function(c){fa.prototype.onRemove.call(this,c),c.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Ws||this._source.off("preclick",qs))},getEvents:function(){var c=fa.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(c.preclick=this.close),this.options.keepInView&&(c.moveend=this._adjustPan),c},_initLayout:function(){var c="leaflet-popup",v=this._container=Gi("div",c+" "+(this.options.className||"")+" leaflet-zoom-animated"),g=this._wrapper=Gi("div",c+"-content-wrapper",v);if(this._contentNode=Gi("div",c+"-content",g),Mo(v),Oo(this._contentNode),Qi(v,"contextmenu",qs),this._tipContainer=Gi("div",c+"-tip-container",v),this._tip=Gi("div",c+"-tip",this._tipContainer),this.options.closeButton){var x=this._closeButton=Gi("a",c+"-close-button",v);x.setAttribute("role","button"),x.setAttribute("aria-label","Close popup"),x.href="#close",x.innerHTML='<span aria-hidden="true">&#215;</span>',Qi(x,"click",function(C){eo(C),this.close()},this)}},_updateLayout:function(){var c=this._contentNode,v=c.style;v.width="",v.whiteSpace="nowrap";var g=c.offsetWidth;g=Math.min(g,this.options.maxWidth),g=Math.max(g,this.options.minWidth),v.width=g+1+"px",v.whiteSpace="",v.height="";var C=this.options.maxHeight,U="leaflet-popup-scrolled";C&&c.offsetHeight>C?(v.height=C+"px",Hi(c,U)):lr(c,U),this._containerWidth=this._container.offsetWidth},_animateZoom:function(c){var v=this._map._latLngToNewLayerPoint(this._latlng,c.zoom,c.center),g=this._getAnchor();xr(this._container,v.add(g))},_adjustPan:function(c){if(this.options.autoPan){this._map._panAnim&&this._map._panAnim.stop();var v=this._map,g=parseInt(Xi(this._container,"marginBottom"),10)||0,x=this._container.offsetHeight+g,C=this._containerWidth,U=new Yt(this._containerLeft,-x-this._containerBottom);U._add(zr(this._container));var Q=v.layerPointToContainerPoint(U),ye=Sn(this.options.autoPanPadding),Pe=Sn(this.options.autoPanPaddingTopLeft||ye),Ze=Sn(this.options.autoPanPaddingBottomRight||ye),zt=v.getSize(),qn=0,Pi=0;Q.x+C+Ze.x>zt.x&&(qn=Q.x+C-zt.x+Ze.x),Q.x-qn-Pe.x<0&&(qn=Q.x-Pe.x),Q.y+x+Ze.y>zt.y&&(Pi=Q.y+x-zt.y+Ze.y),Q.y-Pi-Pe.y<0&&(Pi=Q.y-Pe.y),(qn||Pi)&&v.fire("autopanstart").panBy([qn,Pi],{animate:c&&"moveend"===c.type})}},_getAnchor:function(){return Sn(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}});Wr.mergeOptions({closePopupOnClick:!0}),Wr.include({openPopup:function(c,v,g){return this._initOverlay(wl,c,v,g).openOn(this),this},closePopup:function(c){return(c=arguments.length?c:this._popup)&&c.close(),this}}),ki.include({bindPopup:function(c,v){return this._popup=this._initOverlay(wl,this._popup,c,v),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(c){return this._popup&&this._popup._prepareOpen(c||this._latlng)&&this._popup.openOn(this._map),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(c){return this._popup&&this._popup.setContent(c),this},getPopup:function(){return this._popup},_openPopup:function(c){if(this._popup&&this._map){Xo(c);var v=c.layer||c.target;if(this._popup._source===v&&!(v instanceof Ws))return void(this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(c.latlng));this._popup._source=v,this.openPopup(c.latlng)}},_movePopup:function(c){this._popup.setLatLng(c.latlng)},_onKeyPress:function(c){13===c.originalEvent.keyCode&&this._openPopup(c)}});var ja=fa.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(c){fa.prototype.onAdd.call(this,c),this.setOpacity(this.options.opacity),c.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(c){fa.prototype.onRemove.call(this,c),c.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var c=fa.prototype.getEvents.call(this);return this.options.permanent||(c.preclick=this.close),c},_initLayout:function(){this._contentNode=this._container=Gi("div","leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide")),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+lt(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(c){var v,g,x=this._map,C=this._container,U=x.latLngToContainerPoint(x.getCenter()),Q=x.layerPointToContainerPoint(c),ye=this.options.direction,Pe=C.offsetWidth,Ze=C.offsetHeight,zt=Sn(this.options.offset),qn=this._getAnchor();"top"===ye?(v=Pe/2,g=Ze):"bottom"===ye?(v=Pe/2,g=0):"center"===ye?(v=Pe/2,g=Ze/2):"right"===ye?(v=0,g=Ze/2):"left"===ye?(v=Pe,g=Ze/2):Q.x<U.x?(ye="right",v=0,g=Ze/2):(ye="left",v=Pe+2*(zt.x+qn.x),g=Ze/2),c=c.subtract(Sn(v,g,!0)).add(zt).add(qn),lr(C,"leaflet-tooltip-right"),lr(C,"leaflet-tooltip-left"),lr(C,"leaflet-tooltip-top"),lr(C,"leaflet-tooltip-bottom"),Hi(C,"leaflet-tooltip-"+ye),xr(C,c)},_updatePosition:function(){var c=this._map.latLngToLayerPoint(this._latlng);this._setPosition(c)},setOpacity:function(c){this.options.opacity=c,this._container&&Dr(this._container,c)},_animateZoom:function(c){var v=this._map._latLngToNewLayerPoint(this._latlng,c.zoom,c.center);this._setPosition(v)},_getAnchor:function(){return Sn(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}});Wr.include({openTooltip:function(c,v,g){return this._initOverlay(ja,c,v,g).openOn(this),this},closeTooltip:function(c){return c.close(),this}}),ki.include({bindTooltip:function(c,v){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(ja,this._tooltip,c,v),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(c){if(c||!this._tooltipHandlersAdded){var v=c?"off":"on",g={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?g.add=this._openTooltip:(g.mouseover=this._openTooltip,g.mouseout=this.closeTooltip,g.click=this._openTooltip,this._map?this._addFocusListeners():g.add=this._addFocusListeners),this._tooltip.options.sticky&&(g.mousemove=this._moveTooltip),this[v](g),this._tooltipHandlersAdded=!c}},openTooltip:function(c){return this._tooltip&&this._tooltip._prepareOpen(c)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this)),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(c){return this._tooltip&&this._tooltip.setContent(c),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(c){var v=c.getElement();v&&(Qi(v,"focus",function(){this._tooltip._source=c,this.openTooltip()},this),Qi(v,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(c){var v=c.getElement();v&&v.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(c){!this._tooltip||!this._map||this._map.dragging&&this._map.dragging.moving()||(this._tooltip._source=c.layer||c.target,this.openTooltip(this._tooltip.options.sticky?c.latlng:void 0))},_moveTooltip:function(c){var g,x,v=c.latlng;this._tooltip.options.sticky&&c.originalEvent&&(g=this._map.mouseEventToContainerPoint(c.originalEvent),x=this._map.containerPointToLayerPoint(g),v=this._map.layerPointToLatLng(x)),this._tooltip.setLatLng(v)}});var Za=Qo.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(c){var v=c&&"DIV"===c.tagName?c:document.createElement("div"),g=this.options;if(g.html instanceof Element?(Ji(v),v.appendChild(g.html)):v.innerHTML=!1!==g.html?g.html:"",g.bgPos){var x=Sn(g.bgPos);v.style.backgroundPosition=-x.x+"px "+-x.y+"px"}return this._setIconStyles(v,"icon"),v},createShadow:function(){return null}});Qo.Default=Ua;var gt=ki.extend({options:{tileSize:256,opacity:1,updateWhenIdle:nt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(c){Bt(this,c)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(c){c._addZoomLimit(this)},onRemove:function(c){this._removeAllTiles(),yi(this._container),c._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Ko(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(us(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(c){return this.options.opacity=c,this._updateOpacity(),this},setZIndex:function(c){return this.options.zIndex=c,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var c=this._clampZoom(this._map.getZoom());c!==this._tileZoom&&(this._tileZoom=c,this._updateLevels()),this._update()}return this},getEvents:function(){var c={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=At(this._onMoveEnd,this.options.updateInterval,this)),c.move=this._onMove),this._zoomAnimated&&(c.zoomanim=this._animateZoom),c},createTile:function(){return document.createElement("div")},getTileSize:function(){var c=this.options.tileSize;return c instanceof Yt?c:new Yt(c,c)},_updateZIndex:function(){this._container&&null!=this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(c){for(var U,v=this.getPane().children,g=-c(-1/0,1/0),x=0,C=v.length;x<C;x++)U=v[x].style.zIndex,v[x]!==this._container&&U&&(g=c(g,+U));isFinite(g)&&(this.options.zIndex=g+c(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!nt.ielt9){Dr(this._container,this.options.opacity);var c=+new Date,v=!1,g=!1;for(var x in this._tiles){var C=this._tiles[x];if(C.current&&C.loaded){var U=Math.min(1,(c-C.loaded)/200);Dr(C.el,U),U<1?v=!0:(C.active?g=!0:this._onOpaqueTile(C),C.active=!0)}}g&&!this._noPrune&&this._pruneTiles(),v&&(kn(this._fadeFrame),this._fadeFrame=ii(this._updateOpacity,this))}},_onOpaqueTile:ct,_initContainer:function(){this._container||(this._container=Gi("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var c=this._tileZoom,v=this.options.maxZoom;if(void 0!==c){for(var g in this._levels)g=Number(g),this._levels[g].el.children.length||g===c?(this._levels[g].el.style.zIndex=v-Math.abs(c-g),this._onUpdateLevel(g)):(yi(this._levels[g].el),this._removeTilesAtZoom(g),this._onRemoveLevel(g),delete this._levels[g]);var x=this._levels[c],C=this._map;return x||((x=this._levels[c]={}).el=Gi("div","leaflet-tile-container leaflet-zoom-animated",this._container),x.el.style.zIndex=v,x.origin=C.project(C.unproject(C.getPixelOrigin()),c).round(),x.zoom=c,this._setZoomTransform(x,C.getCenter(),C.getZoom()),this._onCreateLevel(x)),this._level=x,x}},_onUpdateLevel:ct,_onRemoveLevel:ct,_onCreateLevel:ct,_pruneTiles:function(){if(this._map){var c,v,g=this._map.getZoom();if(g>this.options.maxZoom||g<this.options.minZoom)return void this._removeAllTiles();for(c in this._tiles)(v=this._tiles[c]).retain=v.current;for(c in this._tiles)if((v=this._tiles[c]).current&&!v.active){var x=v.coords;this._retainParent(x.x,x.y,x.z,x.z-5)||this._retainChildren(x.x,x.y,x.z,x.z+2)}for(c in this._tiles)this._tiles[c].retain||this._removeTile(c)}},_removeTilesAtZoom:function(c){for(var v in this._tiles)this._tiles[v].coords.z===c&&this._removeTile(v)},_removeAllTiles:function(){for(var c in this._tiles)this._removeTile(c)},_invalidateAll:function(){for(var c in this._levels)yi(this._levels[c].el),this._onRemoveLevel(Number(c)),delete this._levels[c];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(c,v,g,x){var C=Math.floor(c/2),U=Math.floor(v/2),Q=g-1,ye=new Yt(+C,+U);ye.z=+Q;var Pe=this._tileCoordsToKey(ye),Ze=this._tiles[Pe];return Ze&&Ze.active?(Ze.retain=!0,!0):(Ze&&Ze.loaded&&(Ze.retain=!0),Q>x&&this._retainParent(C,U,Q,x))},_retainChildren:function(c,v,g,x){for(var C=2*c;C<2*c+2;C++)for(var U=2*v;U<2*v+2;U++){var Q=new Yt(C,U);Q.z=g+1;var ye=this._tileCoordsToKey(Q),Pe=this._tiles[ye];Pe&&Pe.active?Pe.retain=!0:(Pe&&Pe.loaded&&(Pe.retain=!0),g+1<x&&this._retainChildren(C,U,g+1,x))}},_resetView:function(c){var v=c&&(c.pinch||c.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),v,v)},_animateZoom:function(c){this._setView(c.center,c.zoom,!0,c.noUpdate)},_clampZoom:function(c){var v=this.options;return void 0!==v.minNativeZoom&&c<v.minNativeZoom?v.minNativeZoom:void 0!==v.maxNativeZoom&&v.maxNativeZoom<c?v.maxNativeZoom:c},_setView:function(c,v,g,x){var C=Math.round(v);C=void 0!==this.options.maxZoom&&C>this.options.maxZoom||void 0!==this.options.minZoom&&C<this.options.minZoom?void 0:this._clampZoom(C),(!x||this.options.updateWhenZooming&&C!==this._tileZoom)&&(this._tileZoom=C,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==C&&this._update(c),g||this._pruneTiles(),this._noPrune=!!g),this._setZoomTransforms(c,v)},_setZoomTransforms:function(c,v){for(var g in this._levels)this._setZoomTransform(this._levels[g],c,v)},_setZoomTransform:function(c,v,g){var x=this._map.getZoomScale(g,c.zoom),C=c.origin.multiplyBy(x).subtract(this._map._getNewPixelOrigin(v,g)).round();nt.any3d?po(c.el,C,x):xr(c.el,C)},_resetGrid:function(){var c=this._map,v=c.options.crs,g=this._tileSize=this.getTileSize(),x=this._tileZoom,C=this._map.getPixelWorldBounds(this._tileZoom);C&&(this._globalTileRange=this._pxBoundsToTileRange(C)),this._wrapX=v.wrapLng&&!this.options.noWrap&&[Math.floor(c.project([0,v.wrapLng[0]],x).x/g.x),Math.ceil(c.project([0,v.wrapLng[1]],x).x/g.y)],this._wrapY=v.wrapLat&&!this.options.noWrap&&[Math.floor(c.project([v.wrapLat[0],0],x).y/g.x),Math.ceil(c.project([v.wrapLat[1],0],x).y/g.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(c){var v=this._map,g=v._animatingZoom?Math.max(v._animateToZoom,v.getZoom()):v.getZoom(),x=v.getZoomScale(g,this._tileZoom),C=v.project(c,this._tileZoom).floor(),U=v.getSize().divideBy(2*x);return new Mi(C.subtract(U),C.add(U))},_update:function(c){var v=this._map;if(v){var g=this._clampZoom(v.getZoom());if(void 0===c&&(c=v.getCenter()),void 0!==this._tileZoom){var x=this._getTiledPixelBounds(c),C=this._pxBoundsToTileRange(x),U=C.getCenter(),Q=[],ye=this.options.keepBuffer,Pe=new Mi(C.getBottomLeft().subtract([ye,-ye]),C.getTopRight().add([ye,-ye]));if(!(isFinite(C.min.x)&&isFinite(C.min.y)&&isFinite(C.max.x)&&isFinite(C.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Ze in this._tiles){var zt=this._tiles[Ze].coords;(zt.z!==this._tileZoom||!Pe.contains(new Yt(zt.x,zt.y)))&&(this._tiles[Ze].current=!1)}if(Math.abs(g-this._tileZoom)>1)return void this._setView(c,g);for(var qn=C.min.y;qn<=C.max.y;qn++)for(var Pi=C.min.x;Pi<=C.max.x;Pi++){var Vi=new Yt(Pi,qn);if(Vi.z=this._tileZoom,this._isValidTile(Vi)){var ro=this._tiles[this._tileCoordsToKey(Vi)];ro?ro.current=!0:Q.push(Vi)}}if(Q.sort(function(Zs,Tl){return Zs.distanceTo(U)-Tl.distanceTo(U)}),0!==Q.length){this._loading||(this._loading=!0,this.fire("loading"));var co=document.createDocumentFragment();for(Pi=0;Pi<Q.length;Pi++)this._addTile(Q[Pi],co);this._level.el.appendChild(co)}}}},_isValidTile:function(c){var v=this._map.options.crs;if(!v.infinite){var g=this._globalTileRange;if(!v.wrapLng&&(c.x<g.min.x||c.x>g.max.x)||!v.wrapLat&&(c.y<g.min.y||c.y>g.max.y))return!1}if(!this.options.bounds)return!0;var x=this._tileCoordsToBounds(c);return _i(this.options.bounds).overlaps(x)},_keyToBounds:function(c){return this._tileCoordsToBounds(this._keyToTileCoords(c))},_tileCoordsToNwSe:function(c){var v=this._map,g=this.getTileSize(),x=c.scaleBy(g),C=x.add(g);return[v.unproject(x,c.z),v.unproject(C,c.z)]},_tileCoordsToBounds:function(c){var v=this._tileCoordsToNwSe(c),g=new wi(v[0],v[1]);return this.options.noWrap||(g=this._map.wrapLatLngBounds(g)),g},_tileCoordsToKey:function(c){return c.x+":"+c.y+":"+c.z},_keyToTileCoords:function(c){var v=c.split(":"),g=new Yt(+v[0],+v[1]);return g.z=+v[2],g},_removeTile:function(c){var v=this._tiles[c];!v||(yi(v.el),delete this._tiles[c],this.fire("tileunload",{tile:v.el,coords:this._keyToTileCoords(c)}))},_initTile:function(c){Hi(c,"leaflet-tile");var v=this.getTileSize();c.style.width=v.x+"px",c.style.height=v.y+"px",c.onselectstart=ct,c.onmousemove=ct,nt.ielt9&&this.options.opacity<1&&Dr(c,this.options.opacity)},_addTile:function(c,v){var g=this._getTilePos(c),x=this._tileCoordsToKey(c),C=this.createTile(this._wrapCoords(c),l(this._tileReady,this,c));this._initTile(C),this.createTile.length<2&&ii(l(this._tileReady,this,c,null,C)),xr(C,g),this._tiles[x]={el:C,coords:c,current:!0},v.appendChild(C),this.fire("tileloadstart",{tile:C,coords:c})},_tileReady:function(c,v,g){v&&this.fire("tileerror",{error:v,tile:g,coords:c});var x=this._tileCoordsToKey(c);(g=this._tiles[x])&&(g.loaded=+new Date,this._map._fadeAnimated?(Dr(g.el,0),kn(this._fadeFrame),this._fadeFrame=ii(this._updateOpacity,this)):(g.active=!0,this._pruneTiles()),v||(Hi(g.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:g.el,coords:c})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),nt.ielt9||!this._map._fadeAnimated?ii(this._pruneTiles,this):setTimeout(l(this._pruneTiles,this),250)))},_getTilePos:function(c){return c.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(c){var v=new Yt(this._wrapX?Ke(c.x,this._wrapX):c.x,this._wrapY?Ke(c.y,this._wrapY):c.y);return v.z=c.z,v},_pxBoundsToTileRange:function(c){var v=this.getTileSize();return new Mi(c.min.unscaleBy(v).floor(),c.max.unscaleBy(v).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var c in this._tiles)if(!this._tiles[c].loaded)return!1;return!0}});var vn=gt.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(c,v){this._url=c,(v=Bt(this,v)).detectRetina&&nt.retina&&v.maxZoom>0?(v.tileSize=Math.floor(v.tileSize/2),v.zoomReverse?(v.zoomOffset--,v.minZoom=Math.min(v.maxZoom,v.minZoom+1)):(v.zoomOffset++,v.maxZoom=Math.max(v.minZoom,v.maxZoom-1)),v.minZoom=Math.max(0,v.minZoom)):v.zoomReverse?v.minZoom=Math.min(v.maxZoom,v.minZoom):v.maxZoom=Math.max(v.minZoom,v.maxZoom),"string"==typeof v.subdomains&&(v.subdomains=v.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(c,v){return this._url===c&&void 0===v&&(v=!0),this._url=c,v||this.redraw(),this},createTile:function(c,v){var g=document.createElement("img");return Qi(g,"load",l(this._tileOnLoad,this,v,g)),Qi(g,"error",l(this._tileOnError,this,v,g)),(this.options.crossOrigin||""===this.options.crossOrigin)&&(g.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),"string"==typeof this.options.referrerPolicy&&(g.referrerPolicy=this.options.referrerPolicy),g.alt="",g.src=this.getTileUrl(c),g},getTileUrl:function(c){var v={r:nt.retina?"@2x":"",s:this._getSubdomain(c),x:c.x,y:c.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var g=this._globalTileRange.max.y-c.y;this.options.tms&&(v.y=g),v["-y"]=g}return ft(this._url,N(v,this.options))},_tileOnLoad:function(c,v){nt.ielt9?setTimeout(l(c,this,null,v),0):c(null,v)},_tileOnError:function(c,v,g){var x=this.options.errorTileUrl;x&&v.getAttribute("src")!==x&&(v.src=x),c(g,v)},_onTileRemove:function(c){c.tile.onload=null},_getZoomForUrl:function(){var c=this._tileZoom;return this.options.zoomReverse&&(c=this.options.maxZoom-c),c+this.options.zoomOffset},_getSubdomain:function(c){var v=Math.abs(c.x+c.y)%this.options.subdomains.length;return this.options.subdomains[v]},_abortLoading:function(){var c,v;for(c in this._tiles)if(this._tiles[c].coords.z!==this._tileZoom&&((v=this._tiles[c].el).onload=ct,v.onerror=ct,!v.complete)){v.src=dn;var g=this._tiles[c].coords;yi(v),delete this._tiles[c],this.fire("tileabort",{tile:v,coords:g})}},_removeTile:function(c){var v=this._tiles[c];if(v)return v.el.setAttribute("src",dn),gt.prototype._removeTile.call(this,c)},_tileReady:function(c,v,g){if(this._map&&(!g||g.getAttribute("src")!==dn))return gt.prototype._tileReady.call(this,c,v,g)}});function Wt(c,v){return new vn(c,v)}var Bn=vn.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(c,v){this._url=c;var g=N({},this.defaultWmsParams);for(var x in v)x in this.options||(g[x]=v[x]);var C=(v=Bt(this,v)).detectRetina&&nt.retina?2:1,U=this.getTileSize();g.width=U.x*C,g.height=U.y*C,this.wmsParams=g},onAdd:function(c){this._crs=this.options.crs||c.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version),this.wmsParams[this._wmsVersion>=1.3?"crs":"srs"]=this._crs.code,vn.prototype.onAdd.call(this,c)},getTileUrl:function(c){var v=this._tileCoordsToNwSe(c),g=this._crs,x=mr(g.project(v[0]),g.project(v[1])),C=x.min,U=x.max,Q=(this._wmsVersion>=1.3&&this._crs===ta?[C.y,C.x,U.y,U.x]:[C.x,C.y,U.x,U.y]).join(","),ye=vn.prototype.getTileUrl.call(this,c);return ye+st(this.wmsParams,ye,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+Q},setParams:function(c,v){return N(this.wmsParams,c),v||this.redraw(),this}});vn.WMS=Bn,Wt.wms=function Vn(c,v){return new Bn(c,v)};var ai=ki.extend({options:{padding:.1},initialize:function(c){Bt(this,c),lt(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&Hi(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var c={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(c.zoomanim=this._onAnimZoom),c},_onAnimZoom:function(c){this._updateTransform(c.center,c.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(c,v){var g=this._map.getZoomScale(v,this._zoom),x=this._map.getSize().multiplyBy(.5+this.options.padding),C=this._map.project(this._center,v),U=x.multiplyBy(-g).add(C).subtract(this._map._getNewPixelOrigin(c,v));nt.any3d?po(this._container,U,g):xr(this._container,U)},_reset:function(){for(var c in this._update(),this._updateTransform(this._center,this._zoom),this._layers)this._layers[c]._reset()},_onZoomEnd:function(){for(var c in this._layers)this._layers[c]._project()},_updatePaths:function(){for(var c in this._layers)this._layers[c]._update()},_update:function(){var c=this.options.padding,v=this._map.getSize(),g=this._map.containerPointToLayerPoint(v.multiplyBy(-c)).round();this._bounds=new Mi(g,g.add(v.multiplyBy(1+2*c)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Ii=ai.extend({options:{tolerance:0},getEvents:function(){var c=ai.prototype.getEvents.call(this);return c.viewprereset=this._onViewPreReset,c},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){ai.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var c=this._container=document.createElement("canvas");Qi(c,"mousemove",this._onMouseMove,this),Qi(c,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Qi(c,"mouseout",this._handleMouseOut,this),c._leaflet_disable_events=!0,this._ctx=c.getContext("2d")},_destroyContainer:function(){kn(this._redrawRequest),delete this._ctx,yi(this._container),Qr(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){for(var v in this._redrawBounds=null,this._layers)this._layers[v]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){ai.prototype._update.call(this);var c=this._bounds,v=this._container,g=c.getSize(),x=nt.retina?2:1;xr(v,c.min),v.width=x*g.x,v.height=x*g.y,v.style.width=g.x+"px",v.style.height=g.y+"px",nt.retina&&this._ctx.scale(2,2),this._ctx.translate(-c.min.x,-c.min.y),this.fire("update")}},_reset:function(){ai.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(c){this._updateDashArray(c),this._layers[lt(c)]=c;var v=c._order={layer:c,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=v),this._drawLast=v,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(c){this._requestRedraw(c)},_removePath:function(c){var v=c._order,g=v.next,x=v.prev;g?g.prev=x:this._drawLast=x,x?x.next=g:this._drawFirst=g,delete c._order,delete this._layers[lt(c)],this._requestRedraw(c)},_updatePath:function(c){this._extendRedrawBounds(c),c._project(),c._update(),this._requestRedraw(c)},_updateStyle:function(c){this._updateDashArray(c),this._requestRedraw(c)},_updateDashArray:function(c){if("string"==typeof c.options.dashArray){var x,C,v=c.options.dashArray.split(/[, ]+/),g=[];for(C=0;C<v.length;C++){if(x=Number(v[C]),isNaN(x))return;g.push(x)}c.options._dashArray=g}else c.options._dashArray=c.options.dashArray},_requestRedraw:function(c){!this._map||(this._extendRedrawBounds(c),this._redrawRequest=this._redrawRequest||ii(this._redraw,this))},_extendRedrawBounds:function(c){if(c._pxBounds){var v=(c.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new Mi,this._redrawBounds.extend(c._pxBounds.min.subtract([v,v])),this._redrawBounds.extend(c._pxBounds.max.add([v,v]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var c=this._redrawBounds;if(c){var v=c.getSize();this._ctx.clearRect(c.min.x,c.min.y,v.x,v.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var c,v=this._redrawBounds;if(this._ctx.save(),v){var g=v.getSize();this._ctx.beginPath(),this._ctx.rect(v.min.x,v.min.y,g.x,g.y),this._ctx.clip()}this._drawing=!0;for(var x=this._drawFirst;x;x=x.next)c=x.layer,(!v||c._pxBounds&&c._pxBounds.intersects(v))&&c._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(c,v){if(this._drawing){var g,x,C,U,Q=c._parts,ye=Q.length,Pe=this._ctx;if(ye){for(Pe.beginPath(),g=0;g<ye;g++){for(x=0,C=Q[g].length;x<C;x++)Pe[x?"lineTo":"moveTo"]((U=Q[g][x]).x,U.y);v&&Pe.closePath()}this._fillStroke(Pe,c)}}},_updateCircle:function(c){if(this._drawing&&!c._empty()){var v=c._point,g=this._ctx,x=Math.max(Math.round(c._radius),1),C=(Math.max(Math.round(c._radiusY),1)||x)/x;1!==C&&(g.save(),g.scale(1,C)),g.beginPath(),g.arc(v.x,v.y/C,x,0,2*Math.PI,!1),1!==C&&g.restore(),this._fillStroke(g,c)}},_fillStroke:function(c,v){var g=v.options;g.fill&&(c.globalAlpha=g.fillOpacity,c.fillStyle=g.fillColor||g.color,c.fill(g.fillRule||"evenodd")),g.stroke&&0!==g.weight&&(c.setLineDash&&c.setLineDash(v.options&&v.options._dashArray||[]),c.globalAlpha=g.opacity,c.lineWidth=g.weight,c.strokeStyle=g.color,c.lineCap=g.lineCap,c.lineJoin=g.lineJoin,c.stroke())},_onClick:function(c){for(var g,x,v=this._map.mouseEventToLayerPoint(c),C=this._drawFirst;C;C=C.next)(g=C.layer).options.interactive&&g._containsPoint(v)&&("click"!==c.type&&"preclick"!==c.type||!this._map._draggableMoved(g))&&(x=g);this._fireEvent(!!x&&[x],c)},_onMouseMove:function(c){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var v=this._map.mouseEventToLayerPoint(c);this._handleMouseHover(c,v)}},_handleMouseOut:function(c){var v=this._hoveredLayer;v&&(lr(this._container,"leaflet-interactive"),this._fireEvent([v],c,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(c,v){if(!this._mouseHoverThrottled){for(var g,x,C=this._drawFirst;C;C=C.next)(g=C.layer).options.interactive&&g._containsPoint(v)&&(x=g);x!==this._hoveredLayer&&(this._handleMouseOut(c),x&&(Hi(this._container,"leaflet-interactive"),this._fireEvent([x],c,"mouseover"),this._hoveredLayer=x)),this._fireEvent(!!this._hoveredLayer&&[this._hoveredLayer],c),this._mouseHoverThrottled=!0,setTimeout(l(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(c,v,g){this._map._fireDOMEvent(v,g||v.type,c)},_bringToFront:function(c){var v=c._order;if(v){var g=v.next,x=v.prev;if(!g)return;g.prev=x,x?x.next=g:g&&(this._drawFirst=g),v.prev=this._drawLast,this._drawLast.next=v,v.next=null,this._drawLast=v,this._requestRedraw(c)}},_bringToBack:function(c){var v=c._order;if(v){var g=v.next,x=v.prev;if(!x)return;x.next=g,g?g.prev=x:x&&(this._drawLast=x),v.prev=null,v.next=this._drawFirst,this._drawFirst.prev=v,this._drawFirst=v,this._requestRedraw(c)}}});function pr(c){return nt.canvas?new Ii(c):null}var Ni=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(c){return document.createElement("<lvml:"+c+' class="lvml">')}}catch(c){}return function(c){return document.createElement("<"+c+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),cr={_initContainer:function(){this._container=Gi("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(ai.prototype._update.call(this),this.fire("update"))},_initPath:function(c){var v=c._container=Ni("shape");Hi(v,"leaflet-vml-shape "+(this.options.className||"")),v.coordsize="1 1",c._path=Ni("path"),v.appendChild(c._path),this._updateStyle(c),this._layers[lt(c)]=c},_addPath:function(c){var v=c._container;this._container.appendChild(v),c.options.interactive&&c.addInteractiveTarget(v)},_removePath:function(c){var v=c._container;yi(v),c.removeInteractiveTarget(v),delete this._layers[lt(c)]},_updateStyle:function(c){var v=c._stroke,g=c._fill,x=c.options,C=c._container;C.stroked=!!x.stroke,C.filled=!!x.fill,x.stroke?(v||(v=c._stroke=Ni("stroke")),C.appendChild(v),v.weight=x.weight+"px",v.color=x.color,v.opacity=x.opacity,v.dashStyle=x.dashArray?tn(x.dashArray)?x.dashArray.join(" "):x.dashArray.replace(/( *, *)/g," "):"",v.endcap=x.lineCap.replace("butt","flat"),v.joinstyle=x.lineJoin):v&&(C.removeChild(v),c._stroke=null),x.fill?(g||(g=c._fill=Ni("fill")),C.appendChild(g),g.color=x.fillColor||x.color,g.opacity=x.fillOpacity):g&&(C.removeChild(g),c._fill=null)},_updateCircle:function(c){var v=c._point.round(),g=Math.round(c._radius),x=Math.round(c._radiusY||g);this._setPath(c,c._empty()?"M0 0":"AL "+v.x+","+v.y+" "+g+","+x+" 0,23592600")},_setPath:function(c,v){c._path.v=v},_bringToFront:function(c){Ko(c._container)},_bringToBack:function(c){us(c._container)}},yr=nt.vml?Ni:nr,q=ai.extend({_initContainer:function(){this._container=yr("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=yr("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){yi(this._container),Qr(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!this._map._animatingZoom||!this._bounds){ai.prototype._update.call(this);var c=this._bounds,v=c.getSize(),g=this._container;(!this._svgSize||!this._svgSize.equals(v))&&(this._svgSize=v,g.setAttribute("width",v.x),g.setAttribute("height",v.y)),xr(g,c.min),g.setAttribute("viewBox",[c.min.x,c.min.y,v.x,v.y].join(" ")),this.fire("update")}},_initPath:function(c){var v=c._path=yr("path");c.options.className&&Hi(v,c.options.className),c.options.interactive&&Hi(v,"leaflet-interactive"),this._updateStyle(c),this._layers[lt(c)]=c},_addPath:function(c){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(c._path),c.addInteractiveTarget(c._path)},_removePath:function(c){yi(c._path),c.removeInteractiveTarget(c._path),delete this._layers[lt(c)]},_updatePath:function(c){c._project(),c._update()},_updateStyle:function(c){var v=c._path,g=c.options;!v||(g.stroke?(v.setAttribute("stroke",g.color),v.setAttribute("stroke-opacity",g.opacity),v.setAttribute("stroke-width",g.weight),v.setAttribute("stroke-linecap",g.lineCap),v.setAttribute("stroke-linejoin",g.lineJoin),g.dashArray?v.setAttribute("stroke-dasharray",g.dashArray):v.removeAttribute("stroke-dasharray"),g.dashOffset?v.setAttribute("stroke-dashoffset",g.dashOffset):v.removeAttribute("stroke-dashoffset")):v.setAttribute("stroke","none"),g.fill?(v.setAttribute("fill",g.fillColor||g.color),v.setAttribute("fill-opacity",g.fillOpacity),v.setAttribute("fill-rule",g.fillRule||"evenodd")):v.setAttribute("fill","none"))},_updatePoly:function(c,v){this._setPath(c,Tr(c._parts,v))},_updateCircle:function(c){var v=c._point,g=Math.max(Math.round(c._radius),1),C="a"+g+","+(Math.max(Math.round(c._radiusY),1)||g)+" 0 1,0 ",U=c._empty()?"M0 0":"M"+(v.x-g)+","+v.y+C+2*g+",0 "+C+2*-g+",0 ";this._setPath(c,U)},_setPath:function(c,v){c._path.setAttribute("d",v)},_bringToFront:function(c){Ko(c._path)},_bringToBack:function(c){us(c._path)}});function J(c){return nt.svg||nt.vml?new q(c):null}nt.vml&&q.include(cr),Wr.include({getRenderer:function(c){var v=c.options.renderer||this._getPaneRenderer(c.options.pane)||this.options.renderer||this._renderer;return v||(v=this._renderer=this._createRenderer()),this.hasLayer(v)||this.addLayer(v),v},_getPaneRenderer:function(c){if("overlayPane"===c||void 0===c)return!1;var v=this._paneRenderers[c];return void 0===v&&(v=this._createRenderer({pane:c}),this._paneRenderers[c]=v),v},_createRenderer:function(c){return this.options.preferCanvas&&pr(c)||J(c)}});var Ie=Is.extend({initialize:function(c,v){Is.prototype.initialize.call(this,this._boundsToLatLngs(c),v)},setBounds:function(c){return this.setLatLngs(this._boundsToLatLngs(c))},_boundsToLatLngs:function(c){return[(c=_i(c)).getSouthWest(),c.getNorthWest(),c.getNorthEast(),c.getSouthEast()]}});q.create=yr,q.pointsToPath=Tr,_s.geometryToLayer=Va,_s.coordsToLatLng=bl,_s.coordsToLatLngs=io,_s.latLngToCoords=Fa,_s.latLngsToCoords=Ns,_s.getFeature=es,_s.asFeature=Xa,Wr.mergeOptions({boxZoom:!0});var pn=le.extend({initialize:function(c){this._map=c,this._container=c._container,this._pane=c._panes.overlayPane,this._resetStateTimeout=0,c.on("unload",this._destroy,this)},addHooks:function(){Qi(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Qr(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){yi(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(c){if(!c.shiftKey||1!==c.which&&1!==c.button)return!1;this._clearDeferredResetState(),this._resetState(),rs(),ya(),this._startPoint=this._map.mouseEventToContainerPoint(c),Qi(document,{contextmenu:Xo,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(c){this._moved||(this._moved=!0,this._box=Gi("div","leaflet-zoom-box",this._container),Hi(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(c);var v=new Mi(this._point,this._startPoint),g=v.getSize();xr(this._box,v.min),this._box.style.width=g.x+"px",this._box.style.height=g.y+"px"},_finish:function(){this._moved&&(yi(this._box),lr(this._container,"leaflet-crosshair")),vs(),hs(),Qr(document,{contextmenu:Xo,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(c){if((1===c.which||1===c.button)&&(this._finish(),this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(l(this._resetState,this),0);var v=new wi(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(v).fire("boxzoomend",{boxZoomBounds:v})}},_onKeyDown:function(c){27===c.keyCode&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Wr.addInitHook("addHandler","boxZoom",pn),Wr.mergeOptions({doubleClickZoom:!0});var Jn=le.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(c){var v=this._map,g=v.getZoom(),x=v.options.zoomDelta,C=c.originalEvent.shiftKey?g-x:g+x;"center"===v.options.doubleClickZoom?v.setZoom(C):v.setZoomAround(c.containerPoint,C)}});Wr.addInitHook("addHandler","doubleClickZoom",Jn),Wr.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var xo=le.extend({addHooks:function(){if(!this._draggable){var c=this._map;this._draggable=new je(c._mapPane,c._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),c.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),c.on("zoomend",this._onZoomEnd,this),c.whenReady(this._onZoomEnd,this))}Hi(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){lr(this._map._container,"leaflet-grab"),lr(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var c=this._map;if(c._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var v=_i(this._map.options.maxBounds);this._offsetLimit=mr(this._map.latLngToContainerPoint(v.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(v.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;c.fire("movestart").fire("dragstart"),c.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(c){if(this._map.options.inertia){var v=this._lastTime=+new Date,g=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(g),this._times.push(v),this._prunePositions(v)}this._map.fire("move",c).fire("drag",c)},_prunePositions:function(c){for(;this._positions.length>1&&c-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var c=this._map.getSize().divideBy(2),v=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=v.subtract(c).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(c,v){return c-(c-v)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var c=this._draggable._newPos.subtract(this._draggable._startPos),v=this._offsetLimit;c.x<v.min.x&&(c.x=this._viscousLimit(c.x,v.min.x)),c.y<v.min.y&&(c.y=this._viscousLimit(c.y,v.min.y)),c.x>v.max.x&&(c.x=this._viscousLimit(c.x,v.max.x)),c.y>v.max.y&&(c.y=this._viscousLimit(c.y,v.max.y)),this._draggable._newPos=this._draggable._startPos.add(c)}},_onPreDragWrap:function(){var c=this._worldWidth,v=Math.round(c/2),g=this._initialWorldOffset,x=this._draggable._newPos.x,C=(x-v+g)%c+v-g,U=(x+v+g)%c-v-g,Q=Math.abs(C+g)<Math.abs(U+g)?C:U;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=Q},_onDragEnd:function(c){var v=this._map,g=v.options,x=!g.inertia||c.noInertia||this._times.length<2;if(v.fire("dragend",c),x)v.fire("moveend");else{this._prunePositions(+new Date);var C=this._lastPos.subtract(this._positions[0]),Q=g.easeLinearity,ye=C.multiplyBy(Q/((this._lastTime-this._times[0])/1e3)),Pe=ye.distanceTo([0,0]),Ze=Math.min(g.inertiaMaxSpeed,Pe),zt=ye.multiplyBy(Ze/Pe),qn=Ze/(g.inertiaDeceleration*Q),Pi=zt.multiplyBy(-qn/2).round();Pi.x||Pi.y?(Pi=v._limitOffset(Pi,v.options.maxBounds),ii(function(){v.panBy(Pi,{duration:qn,easeLinearity:Q,noMoveStart:!0,animate:!0})})):v.fire("moveend")}}});Wr.addInitHook("addHandler","dragging",xo),Wr.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Ts=le.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(c){this._map=c,this._setPanDelta(c.options.keyboardPanDelta),this._setZoomDelta(c.options.zoomDelta)},addHooks:function(){var c=this._map._container;c.tabIndex<=0&&(c.tabIndex="0"),Qi(c,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Qr(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var c=document.body,v=document.documentElement,g=c.scrollTop||v.scrollTop,x=c.scrollLeft||v.scrollLeft;this._map._container.focus(),window.scrollTo(x,g)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(c){var x,C,v=this._panKeys={},g=this.keyCodes;for(x=0,C=g.left.length;x<C;x++)v[g.left[x]]=[-1*c,0];for(x=0,C=g.right.length;x<C;x++)v[g.right[x]]=[c,0];for(x=0,C=g.down.length;x<C;x++)v[g.down[x]]=[0,c];for(x=0,C=g.up.length;x<C;x++)v[g.up[x]]=[0,-1*c]},_setZoomDelta:function(c){var x,C,v=this._zoomKeys={},g=this.keyCodes;for(x=0,C=g.zoomIn.length;x<C;x++)v[g.zoomIn[x]]=c;for(x=0,C=g.zoomOut.length;x<C;x++)v[g.zoomOut[x]]=-c},_addHooks:function(){Qi(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Qr(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(c){if(!(c.altKey||c.ctrlKey||c.metaKey)){var x,v=c.keyCode,g=this._map;if(v in this._panKeys)(!g._panAnim||!g._panAnim._inProgress)&&(x=this._panKeys[v],c.shiftKey&&(x=Sn(x).multiplyBy(3)),g.panBy(x),g.options.maxBounds&&g.panInsideBounds(g.options.maxBounds));else if(v in this._zoomKeys)g.setZoom(g.getZoom()+(c.shiftKey?3:1)*this._zoomKeys[v]);else{if(27!==v||!g._popup||!g._popup.options.closeOnEscapeKey)return;g.closePopup()}Xo(c)}}});Wr.addInitHook("addHandler","keyboard",Ts),Wr.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Hr=le.extend({addHooks:function(){Qi(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Qr(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(c){var v=Aa(c),g=this._map.options.wheelDebounceTime;this._delta+=v,this._lastMousePos=this._map.mouseEventToContainerPoint(c),this._startTime||(this._startTime=+new Date);var x=Math.max(g-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(l(this._performZoom,this),x),Xo(c)},_performZoom:function(){var c=this._map,v=c.getZoom(),g=this._map.options.zoomSnap||0;c._stop();var C=4*Math.log(2/(1+Math.exp(-Math.abs(this._delta/(4*this._map.options.wheelPxPerZoomLevel)))))/Math.LN2,U=g?Math.ceil(C/g)*g:C,Q=c._limitZoom(v+(this._delta>0?U:-U))-v;this._delta=0,this._startTime=null,Q&&("center"===c.options.scrollWheelZoom?c.setZoom(v+Q):c.setZoomAround(this._lastMousePos,v+Q))}});Wr.addInitHook("addHandler","scrollWheelZoom",Hr);Wr.mergeOptions({tapHold:nt.touchNative&&nt.safari&&nt.mobile,tapTolerance:15});var il=le.extend({addHooks:function(){Qi(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Qr(this._map._container,"touchstart",this._onDown,this)},_onDown:function(c){if(clearTimeout(this._holdTimeout),1===c.touches.length){var v=c.touches[0];this._startPos=this._newPos=new Yt(v.clientX,v.clientY),this._holdTimeout=setTimeout(l(function(){this._cancel(),this._isTapValid()&&(Qi(document,"touchend",eo),Qi(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",v))},this),600),Qi(document,"touchend touchcancel contextmenu",this._cancel,this),Qi(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function c(){Qr(document,"touchend",eo),Qr(document,"touchend touchcancel",c)},_cancel:function(){clearTimeout(this._holdTimeout),Qr(document,"touchend touchcancel contextmenu",this._cancel,this),Qr(document,"touchmove",this._onMove,this)},_onMove:function(c){var v=c.touches[0];this._newPos=new Yt(v.clientX,v.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(c,v){var g=new MouseEvent(c,{bubbles:!0,cancelable:!0,view:window,screenX:v.screenX,screenY:v.screenY,clientX:v.clientX,clientY:v.clientY});g._simulated=!0,v.target.dispatchEvent(g)}});Wr.addInitHook("addHandler","tapHold",il),Wr.mergeOptions({touchZoom:nt.touch,bounceAtZoomLimits:!0});var rl=le.extend({addHooks:function(){Hi(this._map._container,"leaflet-touch-zoom"),Qi(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){lr(this._map._container,"leaflet-touch-zoom"),Qr(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(c){var v=this._map;if(c.touches&&2===c.touches.length&&!v._animatingZoom&&!this._zooming){var g=v.mouseEventToContainerPoint(c.touches[0]),x=v.mouseEventToContainerPoint(c.touches[1]);this._centerPoint=v.getSize()._divideBy(2),this._startLatLng=v.containerPointToLatLng(this._centerPoint),"center"!==v.options.touchZoom&&(this._pinchStartLatLng=v.containerPointToLatLng(g.add(x)._divideBy(2))),this._startDist=g.distanceTo(x),this._startZoom=v.getZoom(),this._moved=!1,this._zooming=!0,v._stop(),Qi(document,"touchmove",this._onTouchMove,this),Qi(document,"touchend touchcancel",this._onTouchEnd,this),eo(c)}},_onTouchMove:function(c){if(c.touches&&2===c.touches.length&&this._zooming){var v=this._map,g=v.mouseEventToContainerPoint(c.touches[0]),x=v.mouseEventToContainerPoint(c.touches[1]),C=g.distanceTo(x)/this._startDist;if(this._zoom=v.getScaleZoom(C,this._startZoom),!v.options.bounceAtZoomLimits&&(this._zoom<v.getMinZoom()&&C<1||this._zoom>v.getMaxZoom()&&C>1)&&(this._zoom=v._limitZoom(this._zoom)),"center"===v.options.touchZoom){if(this._center=this._startLatLng,1===C)return}else{var U=g._add(x)._divideBy(2)._subtract(this._centerPoint);if(1===C&&0===U.x&&0===U.y)return;this._center=v.unproject(v.project(this._pinchStartLatLng,this._zoom).subtract(U),this._zoom)}this._moved||(v._moveStart(!0,!1),this._moved=!0),kn(this._animRequest);var Q=l(v._move,v,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=ii(Q,this,!0),eo(c)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,kn(this._animRequest),Qr(document,"touchmove",this._onTouchMove,this),Qr(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});Wr.addInitHook("addHandler","touchZoom",rl),Wr.BoxZoom=pn,Wr.DoubleClickZoom=Jn,Wr.Drag=xo,Wr.Keyboard=Ts,Wr.ScrollWheelZoom=Hr,Wr.TapHold=il,Wr.TouchZoom=rl,fe.Bounds=Mi,fe.Browser=nt,fe.CRS=Ti,fe.Canvas=Ii,fe.Circle=Ka,fe.CircleMarker=ss,fe.Class=Jt,fe.Control=js,fe.DivIcon=Za,fe.DivOverlay=fa,fe.DomEvent=ea,fe.DomUtil=ul,fe.Draggable=je,fe.Evented=an,fe.FeatureGroup=Na,fe.GeoJSON=_s,fe.GridLayer=gt,fe.Handler=le,fe.Icon=Qo,fe.ImageOverlay=Pa,fe.LatLng=Ki,fe.LatLngBounds=wi,fe.Layer=ki,fe.LayerGroup=Go,fe.LineUtil=xi,fe.Map=Wr,fe.Marker=Ya,fe.Mixin=ee,fe.Path=Ws,fe.Point=Yt,fe.PolyUtil=ms,fe.Polygon=Is,fe.Polyline=gs,fe.Popup=wl,fe.PosAnimation=Vs,fe.Projection=xs,fe.Rectangle=Ie,fe.Renderer=ai,fe.SVG=q,fe.SVGOverlay=ts,fe.TileLayer=vn,fe.Tooltip=ja,fe.Transformation=Tt,fe.Util=Ci,fe.VideoOverlay=Ba,fe.bind=l,fe.bounds=mr,fe.canvas=pr,fe.circle=function xa(c,v,g){return new Ka(c,v,g)},fe.circleMarker=function ba(c,v){return new ss(c,v)},fe.control=ps,fe.divIcon=function Ue(c){return new Za(c)},fe.extend=N,fe.featureGroup=function(c,v){return new Na(c,v)},fe.geoJSON=Ol,fe.geoJson=nl,fe.gridLayer=function Ut(c){return new gt(c)},fe.icon=function yl(c){return new Qo(c)},fe.imageOverlay=function(c,v,g){return new Pa(c,v,g)},fe.latLng=ui,fe.latLngBounds=_i,fe.layerGroup=function(c,v){return new Go(c,v)},fe.map=function fs(c,v){return new Wr(c,v)},fe.marker=function Ma(c,v){return new Ya(c,v)},fe.point=Sn,fe.polygon=function wa(c,v){return new Is(c,v)},fe.polyline=function vl(c,v){return new gs(c,v)},fe.popup=function(c,v){return new wl(c,v)},fe.rectangle=function ut(c,v){return new Ie(c,v)},fe.setOptions=Bt,fe.stamp=lt,fe.svg=J,fe.svgOverlay=function bo(c,v,g){return new ts(c,v,g)},fe.tileLayer=Wt,fe.tooltip=function(c,v){return new ja(c,v)},fe.transformation=En,fe.version="1.9.2",fe.videoOverlay=function ws(c,v,g){return new Ba(c,v,g)};var Ta=window.L;fe.noConflict=function(){return window.L=Ta,this},window.L=fe}(Zt)},8483:function(Bi,Zt,fe){var N,A;N=[fe(8407),fe(9898)],void 0!==(A=function(l,oe){l.MapboxGL=l.Layer.extend({options:{updateInterval:32,padding:.1,interactive:!1,pane:"tilePane"},initialize:function(lt){l.setOptions(this,lt),lt.accessToken&&(oe.accessToken=lt.accessToken),this._throttledUpdate=l.Util.throttle(this._update,this.options.updateInterval,this)},onAdd:function(lt){this._container||this._initContainer();var At=this.getPaneName();lt.getPane(At).appendChild(this._container),this._initGL(),this._offset=this._map.containerPointToLayerPoint([0,0]),lt.options.zoomAnimation&&l.DomEvent.on(lt._proxy,l.DomUtil.TRANSITION_END,this._transitionEnd,this)},onRemove:function(lt){this._map._proxy&&this._map.options.zoomAnimation&&l.DomEvent.off(this._map._proxy,l.DomUtil.TRANSITION_END,this._transitionEnd,this);var At=this.getPaneName();lt.getPane(At).removeChild(this._container)},getEvents:function(){return{move:this._throttledUpdate,zoomanim:this._animateZoom,zoom:this._pinchZoom,zoomstart:this._zoomStart,zoomend:this._zoomEnd,resize:this._resize}},getMapboxMap:function(){return this._glMap},getCanvas:function(){return this._glMap.getCanvas()},getSize:function(){return this._map.getSize().multiplyBy(1+2*this.options.padding)},getBounds:function(){var lt=this.getSize().multiplyBy(.5),At=this._map.latLngToContainerPoint(this._map.getCenter());return l.latLngBounds(this._map.containerPointToLatLng(At.subtract(lt)),this._map.containerPointToLatLng(At.add(lt)))},getContainer:function(){return this._container},getPaneName:function(){return this._map.getPane(this.options.pane)?this.options.pane:"tilePane"},_initContainer:function(){var lt=this._container=l.DomUtil.create("div","leaflet-gl-layer"),At=this.getSize(),Ke=this._map.getSize().multiplyBy(this.options.padding);lt.style.width=At.x+"px",lt.style.height=At.y+"px";var ct=this._map.containerPointToLayerPoint([0,0]).subtract(Ke);l.DomUtil.setPosition(lt,ct)},_initGL:function(){var lt=this._map.getCenter(),At=l.extend({},this.options,{container:this._container,center:[lt.lng,lt.lat],zoom:this._map.getZoom()-1,attributionControl:!1});this._glMap?(this._glMap.setCenter(At.center),this._glMap.setZoom(At.zoom)):this._glMap=new oe.Map(At),this._glMap.transform.latRange=null,this._transformGL(this._glMap),this._glMap._actualCanvas=this._glMap._canvas.canvas?this._glMap._canvas.canvas:this._glMap._canvas;var Ke=this._glMap._actualCanvas;l.DomUtil.addClass(Ke,"leaflet-image-layer"),l.DomUtil.addClass(Ke,"leaflet-zoom-animated"),this.options.interactive&&l.DomUtil.addClass(Ke,"leaflet-interactive"),this.options.className&&l.DomUtil.addClass(Ke,this.options.className)},_update:function(lt){if(this._offset=this._map.containerPointToLayerPoint([0,0]),!this._zooming){var At=this.getSize(),Ke=this._container,ct=this._glMap,_t=this._map.getSize().multiplyBy(this.options.padding),Nt=this._map.containerPointToLayerPoint([0,0]).subtract(_t);l.DomUtil.setPosition(Ke,Nt),this._transformGL(ct),ct.transform.width!==At.x||ct.transform.height!==At.y?(Ke.style.width=At.x+"px",Ke.style.height=At.y+"px",null!=ct._resize?ct._resize():ct.resize()):null!=ct._update?ct._update():ct.update()}},_transformGL:function(lt){var At=this._map.getCenter(),Ke=lt.transform;Ke.center=oe.LngLat.convert([At.lng,At.lat]),Ke.zoom=this._map.getZoom()-1},_pinchZoom:function(lt){this._glMap.jumpTo({zoom:this._map.getZoom()-1,center:this._map.getCenter()})},_animateZoom:function(lt){var At=this._map.getZoomScale(lt.zoom),Ke=this._map.getSize().multiplyBy(this.options.padding*At),ct=this.getSize()._divideBy(2),_t=this._map.project(lt.center,lt.zoom)._subtract(ct)._add(this._map._getMapPanePos().add(Ke))._round(),Nt=this._map.project(this._map.getBounds().getNorthWest(),lt.zoom)._subtract(_t);l.DomUtil.setTransform(this._glMap._actualCanvas,Nt.subtract(this._offset),At)},_zoomStart:function(lt){this._zooming=!0},_zoomEnd:function(){var lt=this._map.getZoomScale(this._map.getZoom());l.DomUtil.setTransform(this._glMap._actualCanvas,null,lt),this._zooming=!1,this._update()},_transitionEnd:function(lt){l.Util.requestAnimFrame(function(){var At=this._map.getZoom(),Ke=this._map.getCenter(),ct=this._map.latLngToContainerPoint(this._map.getBounds().getNorthWest());l.DomUtil.setTransform(this._glMap._actualCanvas,ct,1),this._glMap.once("moveend",l.Util.bind(function(){this._zoomEnd()},this)),this._glMap.jumpTo({center:Ke,zoom:At-1})},this)},_resize:function(lt){this._transitionEnd(lt)}}),l.mapboxGL=function(lt){return new l.MapboxGL(lt)}}.apply(Zt,N))&&(Bi.exports=A)},9898:function(Bi){Bi.exports=function(){"use strict";var Zt,fe,D;function N(l,oe){if(Zt)if(fe){var lt="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+Zt+")(sharedChunk); ("+fe+")(sharedChunk); self.onerror = null;",At={};Zt(At),D=oe(At),"undefined"!=typeof window&&window&&window.URL&&window.URL.createObjectURL&&(D.workerUrl=window.URL.createObjectURL(new Blob([lt],{type:"text/javascript"})))}else fe=oe;else Zt=oe}return N(0,function(l){var oe="undefined"!=typeof self?self:{},lt=At;function At(t,e,n,s){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(s-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=s,this.p2x=n,this.p2y=s}At.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},At.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},At.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},At.prototype.solveCurveX=function(t,e){var n,s,h,p,y;for(void 0===e&&(e=1e-6),h=t,y=0;y<8;y++){if(p=this.sampleCurveX(h)-t,Math.abs(p)<e)return h;var T=this.sampleCurveDerivativeX(h);if(Math.abs(T)<1e-6)break;h-=p/T}if((h=t)<(n=0))return n;if(h>(s=1))return s;for(;n<s;){if(p=this.sampleCurveX(h),Math.abs(p-t)<e)return h;t>p?n=h:s=h,h=.5*(s-n)+n}return h},At.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))};var Ke=ct;function ct(t,e){this.x=t,this.y=e}ct.prototype={clone:function(){return new ct(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),s=n*this.x+e*this.y;return this.x=e*this.x-n*this.y,this.y=s,this},_rotateAround:function(t,e){var n=Math.cos(t),s=Math.sin(t),h=e.y+s*(this.x-e.x)+n*(this.y-e.y);return this.x=e.x+n*(this.x-e.x)-s*(this.y-e.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},ct.convert=function(t){return t instanceof ct?t:Array.isArray(t)?new ct(t[0],t[1]):t};const _t=Math.PI/180,Nt=180/Math.PI;function wt(t){return t*_t}function Bt(t){return t*Nt}const st=[[0,0],[1,0],[1,1],[0,1]];function at(t){if(t<=0)return 0;if(t>=1)return 1;const e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)}function ft(t,e,n,s){const h=new lt(t,e,n,s);return function(p){return h.solve(p)}}const tn=ft(.25,.1,.25,1);function kt(t,e,n){return Math.min(n,Math.max(e,t))}function dn(t,e,n){return(n=kt((n-t)/(e-t),0,1))*n*(3-2*n)}function Qn(t,e,n){const s=n-e,h=((t-e)%s+s)%s+e;return h===e?n:h}function on(t,e,n){if(!t.length)return n(null,[]);let s=t.length;const h=new Array(t.length);let p=null;t.forEach((y,T)=>{e(y,(R,F)=>{R&&(p=R),h[T]=F,0==--s&&n(p,h)})})}function Cn(t){const e=[];for(const n in t)e.push(t[n]);return e}function se(t,...e){for(const n of e)for(const s in n)t[s]=n[s];return t}let Wi=1;function ii(){return Wi++}function kn(){return function t(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function Ci(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function Jt(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function $t(t,e){t.forEach(n=>{e[n]&&(e[n]=e[n].bind(e))})}function en(t,e){return-1!==t.indexOf(e,t.length-e.length)}function an(t,e,n){const s={};for(const h in t)s[h]=e.call(n||this,t[h],h,t);return s}function Yt(t,e,n){const s={};for(const h in t)e.call(n||this,t[h],h,t)&&(s[h]=t[h]);return s}function An(t){return Array.isArray(t)?t.map(An):"object"==typeof t&&t?an(t,An):t}const Sn={};function Mi(t){Sn[t]||("undefined"!=typeof console&&console.warn(t),Sn[t]=!0)}function mr(t,e,n){return(n.y-t.y)*(e.x-t.x)>(e.y-t.y)*(n.x-t.x)}function wi(t){let e=0;for(let n,s,h=0,p=t.length,y=p-1;h<p;y=h++)n=t[h],s=t[y],e+=(s.x-n.x)*(n.y+s.y);return e}function _i(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function Ki(t){const e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(n,s,h,p)=>{const y=h||p;return e[s]=!y||y.toLowerCase(),""}),e["max-age"]){const n=parseInt(e["max-age"],10);isNaN(n)?delete e["max-age"]:e["max-age"]=n}return e}let ui=null;function Ti(t){if(null==ui){const e=t.navigator?t.navigator.userAgent:null;ui=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return ui}function Br(t){try{const e=oe[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch(e){return!1}}function yn(t,e){return[t[4*e],t[4*e+1],t[4*e+2],t[4*e+3]]}const oi=oe.performance;function Tt(t){const e=t?t.url.toString():void 0;return oi.getEntriesByName(e)}let si,fi,nr,Tr;const Zr={now:()=>void 0!==nr?nr:oe.performance.now(),setNow(t){nr=t},restoreNow(){nr=void 0},frame(t){const e=oe.requestAnimationFrame(t);return{cancel:()=>oe.cancelAnimationFrame(e)}},getImageData(t,e=0){const{width:n,height:s}=t;Tr||(Tr=oe.document.createElement("canvas"));const h=Tr.getContext("2d");if(!h)throw new Error("failed to create canvas 2d context");return(n>Tr.width||s>Tr.height)&&(Tr.width=n,Tr.height=s),h.clearRect(-e,-e,n+2*e,s+2*e),h.drawImage(t,0,0,n,s),h.getImageData(-e,-e,n+2*e,s+2*e)},resolveURL:t=>(si||(si=oe.document.createElement("a")),si.href=t,si.href),get devicePixelRatio(){return oe.devicePixelRatio},get prefersReducedMotion(){return!!oe.matchMedia&&(null==fi&&(fi=oe.matchMedia("(prefers-reduced-motion: reduce)")),fi.matches)}};let Ur;const Mn={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==Ur){const t=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{Ur=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):t}catch(e){Ur=t}}return Ur},get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},yo={supported:!1,testSupport:function(t){!dr&&no&&(cs?cn(t):qr=t)}};let qr,no,dr=!1,cs=!1;function cn(t){const e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,no),t.isContextLost())return;yo.supported=!0}catch(n){}t.deleteTexture(e),dr=!0}oe.document&&(no=oe.document.createElement("img"),no.onload=function(){qr&&cn(qr),qr=null,cs=!0},no.onerror=function(){dr=!0,qr=null},no.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Ot="01",Dt="NO_ACCESS_TOKEN";function Nn(t){return 0===t.indexOf("mapbox:")}function nn(t){return Mn.API_URL_REGEX.test(t)}const jn=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function pi(t){const e=t.match(jn);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function to(t){const e=t.params.length?`?${t.params.join("&")}`:"";return`${t.protocol}://${t.authority}${t.path}${e}`}function Li(t){if(!t)return null;const e=t.split(".");if(!e||3!==e.length)return null;try{return JSON.parse(decodeURIComponent(oe.atob(e[1]).split("").map(n=>"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch(n){return null}}class $r{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const n=Li(Mn.ACCESS_TOKEN);let s="";return s=n&&n.u?oe.btoa(encodeURIComponent(n.u).replace(/%([0-9A-F]{2})/g,(h,p)=>String.fromCharCode(Number("0x"+p)))):Mn.ACCESS_TOKEN||"",e?`mapbox.eventData.${e}:${s}`:`mapbox.eventData:${s}`}fetchEventData(){const e=Br("localStorage"),n=this.getStorageKey(),s=this.getStorageKey("uuid");if(e)try{const h=oe.localStorage.getItem(n);h&&(this.eventData=JSON.parse(h));const p=oe.localStorage.getItem(s);p&&(this.anonId=p)}catch(h){Mi("Unable to read from LocalStorage")}}saveEventData(){const e=Br("localStorage"),n=this.getStorageKey(),s=this.getStorageKey("uuid");if(e)try{oe.localStorage.setItem(s,this.anonId),Object.keys(this.eventData).length>=1&&oe.localStorage.setItem(n,JSON.stringify(this.eventData))}catch(h){Mi("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,n,s,h){if(!Mn.EVENTS_URL)return;const p=pi(Mn.EVENTS_URL);p.params.push(`access_token=${h||Mn.ACCESS_TOKEN||""}`);const y={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"2.10.0",skuId:Ot,userId:this.anonId},T=n?se(y,n):y,R={url:to(p),headers:{"Content-Type":"text/plain"},body:JSON.stringify([T])};this.pendingRequest=Dn(R,F=>{this.pendingRequest=null,s(F),this.saveEventData(),this.processRequests(h)})}queueRequest(e,n){this.queue.push(e),this.processRequests(n)}}const Vr=new class extends $r{constructor(t){super("appUserTurnstile"),this._customAccessToken=t}postTurnstileEvent(t,e){Mn.EVENTS_URL&&Mn.ACCESS_TOKEN&&Array.isArray(t)&&t.some(n=>Nn(n)||nn(n))&&this.queueRequest(Date.now(),e)}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=Li(Mn.ACCESS_TOKEN),n=e?e.u:Mn.ACCESS_TOKEN;let s=n!==this.eventData.tokenU;Jt(this.anonId)||(this.anonId=kn(),s=!0);const h=this.queue.shift();if(this.eventData.lastSuccess){const p=new Date(this.eventData.lastSuccess),y=new Date(h),T=(h-this.eventData.lastSuccess)/864e5;s=s||T>=1||T<-1||p.getDate()!==y.getDate()}else s=!0;s?this.postEvent(h,{"enabled.telemetry":!1},p=>{p||(this.eventData.lastSuccess=h,this.eventData.tokenU=n)},t):this.processRequests()}},fo=Vr.postTurnstileEvent.bind(Vr),vo=new class extends $r{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(t,e,n,s){this.skuToken=e,this.errorCb=s,Mn.EVENTS_URL&&(n||Mn.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},n):this.errorCb(new Error(Dt)))}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:n}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),Jt(this.anonId)||(this.anonId=kn()),this.postEvent(n,{skuToken:this.skuToken},s=>{s?this.errorCb(s):e&&(this.success[e]=!0)},t))}},ei=vo.postMapLoadEvent.bind(vo),fr=new class extends $r{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(t,e,n,s){if(!Mn.API_URL||!Mn.SESSION_PATH)return;const h=pi(Mn.API_URL+Mn.SESSION_PATH);h.params.push(`sku=${e||""}`),h.params.push(`access_token=${s||Mn.ACCESS_TOKEN||""}`);const p={url:to(h),headers:{"Content-Type":"text/plain"}};this.pendingRequest=xe(p,y=>{this.pendingRequest=null,n(y),this.saveEventData(),this.processRequests(s)})}getSessionAPI(t,e,n,s){this.skuToken=e,this.errorCb=s,Mn.SESSION_PATH&&Mn.API_URL&&(n||Mn.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},n):this.errorCb(new Error(Dt)))}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:n}=this.queue.shift();e&&this.success[e]||this.getSession(n,this.skuToken,s=>{s?this.errorCb(s):e&&(this.success[e]=!0)},t)}},sr=fr.getSessionAPI.bind(fr),Io=new Set;let ir,Ao=500,Zo=50,To={};function Ds(t){const e=Me(t);let n,s;e&&e.forEach(p=>{const y=p.split("=");"language"===y[0]?n=y[1]:"worldview"===y[0]&&(s=y[1])});let h="mapbox-tiles";return n&&(h+=`-${n}`),s&&(h+=`-${s}`),h}function qe(){try{return oe.caches}catch(t){}}function Te(t){const e=qe();e&&!To[t]&&(To[t]=e.open(t))}function Me(t){const e=t.indexOf("?");return e>0?t.slice(e+1).split("&"):[]}function We(t){const e=t.indexOf("?");if(e<0)return t;const n=Me(t).filter(s=>{const h=s.split("=");return"language"===h[0]||"worldview"===h[0]});return n.length?`${t.slice(0,e)}?${n.join("&")}`:t.slice(0,e)}let Xe=1/0;const xt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(xt);class Gt extends Error{constructor(e,n,s){401===n&&nn(s)&&(e+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),super(e),this.status=n,this.url=s}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Rt=_i()?()=>self.worker&&self.worker.referrer:()=>("blob:"===oe.location.protocol?oe.parent:oe).location.href,nt=function(t,e){if(!(/^file:/.test(n=t.url)||/^file:/.test(Rt())&&!/^\w+:/.test(n))){if(oe.fetch&&oe.Request&&oe.AbortController&&oe.Request.prototype.hasOwnProperty("signal"))return function(s,h){const p=new oe.AbortController,y=new oe.Request(s.url,{method:s.method||"GET",body:s.body,credentials:s.credentials,headers:s.headers,referrer:Rt(),signal:p.signal});let T=!1,R=!1;const F=(W=y.url).indexOf("sku=")>0&&nn(W);var W;"json"===s.type&&y.headers.set("Accept","application/json");const te=(_e,we,Oe)=>{if(R)return;if(_e&&"SecurityError"!==_e.message&&Mi(_e),we&&Oe)return re(we);const Ve=Date.now();oe.fetch(y).then(it=>{if(it.ok){const bt=F?it.clone():null;return re(it,bt,Ve)}return h(new Gt(it.statusText,it.status,s.url))}).catch(it=>{20!==it.code&&h(new Error(it.message))})},re=(_e,we,Oe)=>{("arrayBuffer"===s.type?_e.arrayBuffer():"json"===s.type?_e.json():_e.text()).then(Ve=>{R||(we&&Oe&&function(it,bt,rt){const vt=Ds(it.url);if(Te(vt),!To[vt])return;const Lt={status:bt.status,statusText:bt.statusText,headers:new oe.Headers};bt.headers.forEach((hn,bn)=>Lt.headers.set(bn,hn));const St=Ki(bt.headers.get("Cache-Control")||"");if(St["no-store"])return;St["max-age"]&&Lt.headers.set("Expires",new Date(rt+1e3*St["max-age"]).toUTCString());const fn=Lt.headers.get("Expires");fn&&(new Date(fn).getTime()-rt<42e4||function(hn,bn){if(void 0===ir)try{new Response(new ReadableStream),ir=!0}catch(hi){ir=!1}ir?bn(hn.body):hn.blob().then(bn)}(bt,hn=>{const bn=new oe.Response(hn,Lt);Te(vt),To[vt]&&To[vt].then(hi=>hi.put(We(it.url),bn)).catch(hi=>Mi(hi.message))}))}(y,we,Oe),T=!0,h(null,Ve,_e.headers.get("Cache-Control"),_e.headers.get("Expires")))}).catch(Ve=>{R||h(new Error(Ve.message))})};return F?function(_e,we){const Oe=Ds(_e.url);if(Te(Oe),!To[Oe])return we(null);const Ve=We(_e.url);To[Oe].then(it=>{it.match(Ve).then(bt=>{const rt=function(vt){if(!vt)return!1;const Lt=new Date(vt.headers.get("Expires")||0),St=Ki(vt.headers.get("Cache-Control")||"");return Lt>Date.now()&&!St["no-cache"]}(bt);it.delete(Ve),rt&&it.put(Ve,bt.clone()),we(null,bt,rt)}).catch(we)}).catch(we)}(y,te):te(null,null),{cancel:()=>{R=!0,T||p.abort()}}}(t,e);if(_i()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var n;return function(s,h){const p=new oe.XMLHttpRequest;p.open(s.method||"GET",s.url,!0),"arrayBuffer"===s.type&&(p.responseType="arraybuffer");for(const y in s.headers)p.setRequestHeader(y,s.headers[y]);return"json"===s.type&&(p.responseType="text",p.setRequestHeader("Accept","application/json")),p.withCredentials="include"===s.credentials,p.onerror=()=>{h(new Error(p.statusText))},p.onload=()=>{if((p.status>=200&&p.status<300||0===p.status)&&null!==p.response){let y=p.response;if("json"===s.type)try{y=JSON.parse(p.response)}catch(T){return h(T)}h(null,y,p.getResponseHeader("Cache-Control"),p.getResponseHeader("Expires"))}else h(new Gt(p.statusText,p.status,s.url))},p.send(s.body),{cancel:()=>p.abort()}}(t,e)},Kt=function(t,e){return nt(se(t,{type:"arrayBuffer"}),e)},Dn=function(t,e){return nt(se(t,{method:"POST"}),e)},xe=function(t,e){return nt(se(t,{method:"GET"}),e)};function Se(t){const e=oe.document.createElement("a");return e.href=t,e.protocol===oe.document.location.protocol&&e.host===oe.document.location.host}const Be="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let dt,Pt;dt=[],Pt=0;const rn=function(t,e){if(yo.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),Pt>=Mn.MAX_PARALLEL_IMAGE_REQUESTS){const p={requestParameters:t,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return dt.push(p),p}Pt++;let n=!1;const s=()=>{if(!n)for(n=!0,Pt--;dt.length&&Pt<Mn.MAX_PARALLEL_IMAGE_REQUESTS;){const p=dt.shift(),{requestParameters:y,callback:T,cancelled:R}=p;R||(p.cancel=rn(y,T).cancel)}},h=Kt(t,(p,y,T,R)=>{s(),p?e(p):y&&(oe.createImageBitmap?function(F,W){const te=new oe.Blob([new Uint8Array(F)],{type:"image/png"});oe.createImageBitmap(te).then(re=>{W(null,re)}).catch(re=>{W(new Error(`Could not load image because of ${re.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(y,(F,W)=>e(F,W,T,R)):function(F,W){const te=new oe.Image,re=oe.URL;te.onload=()=>{W(null,te),re.revokeObjectURL(te.src),te.onload=null,oe.requestAnimationFrame(()=>{te.src=Be})},te.onerror=()=>W(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const _e=new oe.Blob([new Uint8Array(F)],{type:"image/png"});te.src=F.byteLength?re.createObjectURL(_e):Be}(y,(F,W)=>e(F,W,T,R)))});return{cancel:()=>{h.cancel(),s()}}};function un(t,e,n){n[t]&&-1!==n[t].indexOf(e)||(n[t]=n[t]||[],n[t].push(e))}function In(t,e,n){if(n&&n[t]){const s=n[t].indexOf(e);-1!==s&&n[t].splice(s,1)}}class Pn{constructor(e,n={}){se(this,n),this.type=e}}class mi extends Pn{constructor(e,n={}){super("error",se({error:e},n))}}class Xn{on(e,n){return this._listeners=this._listeners||{},un(e,n,this._listeners),this}off(e,n){return In(e,n,this._listeners),In(e,n,this._oneTimeListeners),this}once(e,n){return n?(this._oneTimeListeners=this._oneTimeListeners||{},un(e,n,this._oneTimeListeners),this):new Promise(s=>this.once(e,s))}fire(e,n){"string"==typeof e&&(e=new Pn(e,n||{}));const s=e.type;if(this.listens(s)){e.target=this;const h=this._listeners&&this._listeners[s]?this._listeners[s].slice():[];for(const T of h)T.call(this,e);const p=this._oneTimeListeners&&this._oneTimeListeners[s]?this._oneTimeListeners[s].slice():[];for(const T of p)In(s,T,this._oneTimeListeners),T.call(this,e);const y=this._eventedParent;y&&(se(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),y.fire(e))}else e instanceof mi&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,n){return this._eventedParent=e,this._eventedParentData=n,this}}var qt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":true,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"cross-faded"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"cross-faded":{"type":"property-type"},"cross-faded-data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Gr(t,...e){for(const n of e)for(const s in n)t[s]=n[s];return t}function gr(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function Rn(t){if(Array.isArray(t))return t.map(Rn);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){const e={};for(const n in t)e[n]=Rn(t[n]);return e}return gr(t)}class ti extends Error{constructor(e,n){super(n),this.message=n,this.key=e}}var hr=ti;class Er{constructor(e,n=[]){this.parent=e,this.bindings={};for(const[s,h]of n)this.bindings[s]=h}concat(e){return new Er(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}var Mr=Er;const Nr={kind:"null"},Wn={kind:"number"},Fi={kind:"string"},Xi={kind:"boolean"},Gi={kind:"color"},yi={kind:"object"},Ji={kind:"value"},Ko={kind:"collator"},us={kind:"formatted"},Ss={kind:"resolvedImage"};function Hi(t,e){return{kind:"array",itemType:t,N:e}}function lr(t){if("array"===t.kind){const e=lr(t.itemType);return"number"==typeof t.N?`array<${e}, ${t.N}>`:"value"===t.itemType.kind?"array":`array<${e}>`}return t.kind}const ks=[Nr,Wn,Fi,Xi,Gi,us,yi,Hi(Ji),Ss];function Po(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!Po(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(const n of ks)if(!Po(n,e))return null}return`Expected ${lr(t)} but found ${lr(e)} instead.`}function Dr(t,e){return e.some(n=>n.kind===t.kind)}function Uo(t,e){return e.some(n=>"null"===n?null===t:"array"===n?Array.isArray(t):"object"===n?t&&!Array.isArray(t)&&"object"==typeof t:n===typeof t)}function ca(t){var e={exports:{}};return t(e,e.exports),e.exports}var po=ca(function(t,e){var n={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function s(T){return(T=Math.round(T))<0?0:T>255?255:T}function h(T){return s("%"===T[T.length-1]?parseFloat(T)/100*255:parseInt(T))}function p(T){return(R="%"===T[T.length-1]?parseFloat(T)/100:parseFloat(T))<0?0:R>1?1:R;var R}function y(T,R,F){return F<0?F+=1:F>1&&(F-=1),6*F<1?T+(R-T)*F*6:2*F<1?R:3*F<2?T+(R-T)*(2/3-F)*6:T}try{e.parseCSSColor=function(T){var R,F=T.replace(/ /g,"").toLowerCase();if(F in n)return n[F].slice();if("#"===F[0])return 4===F.length?(R=parseInt(F.substr(1),16))>=0&&R<=4095?[(3840&R)>>4|(3840&R)>>8,240&R|(240&R)>>4,15&R|(15&R)<<4,1]:null:7===F.length&&(R=parseInt(F.substr(1),16))>=0&&R<=16777215?[(16711680&R)>>16,(65280&R)>>8,255&R,1]:null;var W=F.indexOf("("),te=F.indexOf(")");if(-1!==W&&te+1===F.length){var re=F.substr(0,W),_e=F.substr(W+1,te-(W+1)).split(","),we=1;switch(re){case"rgba":if(4!==_e.length)return null;we=p(_e.pop());case"rgb":return 3!==_e.length?null:[h(_e[0]),h(_e[1]),h(_e[2]),we];case"hsla":if(4!==_e.length)return null;we=p(_e.pop());case"hsl":if(3!==_e.length)return null;var Oe=(parseFloat(_e[0])%360+360)%360/360,Ve=p(_e[1]),it=p(_e[2]),bt=it<=.5?it*(Ve+1):it+Ve-it*Ve,rt=2*it-bt;return[s(255*y(rt,bt,Oe+1/3)),s(255*y(rt,bt,Oe)),s(255*y(rt,bt,Oe-1/3)),we];default:return null}}return null}}catch(T){}});class xr{constructor(e,n,s,h=1){this.r=e,this.g=n,this.b=s,this.a=h}static parse(e){if(!e)return;if(e instanceof xr)return e;if("string"!=typeof e)return;const n=po.parseCSSColor(e);return n?new xr(n[0]/255*n[3],n[1]/255*n[3],n[2]/255*n[3],n[3]):void 0}toString(){const[e,n,s,h]=this.toArray();return`rgba(${Math.round(e)},${Math.round(n)},${Math.round(s)},${h})`}toArray(){const{r:e,g:n,b:s,a:h}=this;return 0===h?[0,0,0,0]:[255*e/h,255*n/h,255*s/h,h]}toArray01(){const{r:e,g:n,b:s,a:h}=this;return 0===h?[0,0,0,0]:[e/h,n/h,s/h,h]}toArray01PremultipliedAlpha(){const{r:e,g:n,b:s,a:h}=this;return[e,n,s,h]}}xr.black=new xr(0,0,0,1),xr.white=new xr(1,1,1,1),xr.transparent=new xr(0,0,0,0),xr.red=new xr(1,0,0,1),xr.blue=new xr(0,0,1,1);var zr=xr;class rs{constructor(e,n,s){this.sensitivity=e?n?"variant":"case":n?"accent":"base",this.locale=s,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,n){return this.collator.compare(e,n)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class vs{constructor(e,n,s,h,p){this.text=e.normalize?e.normalize():e,this.image=n,this.scale=s,this.fontStack=h,this.textColor=p}}class Ir{constructor(e){this.sections=e}static fromString(e){return new Ir([new vs(e,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(e=>0!==e.text.length||e.image&&0!==e.image.name.length)}static factory(e){return e instanceof Ir?e:Ir.fromString(e)}toString(){return 0===this.sections.length?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const n of this.sections){if(n.image){e.push(["image",n.image.name]);continue}e.push(n.text);const s={};n.fontStack&&(s["text-font"]=["literal",n.fontStack.split(",")]),n.scale&&(s["font-scale"]=n.scale),n.textColor&&(s["text-color"]=["rgba"].concat(n.textColor.toArray())),e.push(s)}return e}}class Vo{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Vo({name:e,available:!1}):null}serialize(){return["image",this.name]}}function ya(t,e,n,s){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof n&&n>=0&&n<=255?void 0===s||"number"==typeof s&&s>=0&&s<=1?null:`Invalid rgba value [${[t,e,n,s].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof s?[t,e,n,s]:[t,e,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function hs(t){if(null===t||"string"==typeof t||"boolean"==typeof t||"number"==typeof t||t instanceof zr||t instanceof rs||t instanceof Ir||t instanceof Vo)return!0;if(Array.isArray(t)){for(const e of t)if(!hs(e))return!1;return!0}if("object"==typeof t){for(const e in t)if(!hs(t[e]))return!1;return!0}return!1}function lo(t){if(null===t)return Nr;if("string"==typeof t)return Fi;if("boolean"==typeof t)return Xi;if("number"==typeof t)return Wn;if(t instanceof zr)return Gi;if(t instanceof rs)return Ko;if(t instanceof Ir)return us;if(t instanceof Vo)return Ss;if(Array.isArray(t)){const e=t.length;let n;for(const s of t){const h=lo(s);if(n){if(n===h)continue;n=Ji;break}n=h}return Hi(n||Ji,e)}return yi}function Qs(t){const e=typeof t;return null===t?"":"string"===e||"number"===e||"boolean"===e?String(t):t instanceof zr||t instanceof Ir||t instanceof Vo?t.toString():JSON.stringify(t)}class va{constructor(e,n){this.type=e,this.value=n}static parse(e,n){if(2!==e.length)return n.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!hs(e[1]))return n.error("invalid value");const s=e[1];let h=lo(s);const p=n.expectedType;return"array"!==h.kind||0!==h.N||!p||"array"!==p.kind||"number"==typeof p.N&&0!==p.N||(h=p),new va(h,s)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof zr?["rgba"].concat(this.value.toArray()):this.value instanceof Ir?this.value.serialize():this.value}}var ua=va,$o=class{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}};const ha={string:Fi,number:Wn,boolean:Xi,object:yi};class ul{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");let s,h=1;const p=e[0];if("array"===p){let T,R;if(e.length>2){const F=e[1];if("string"!=typeof F||!(F in ha)||"object"===F)return n.error('The item type argument of "array" must be one of string, number, boolean',1);T=ha[F],h++}else T=Ji;if(e.length>3){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return n.error('The length argument to "array" must be a positive integer literal',2);R=e[2],h++}s=Hi(T,R)}else s=ha[p];const y=[];for(;h<e.length;h++){const T=n.parse(e[h],h,Ji);if(!T)return null;y.push(T)}return new ul(s,y)}evaluate(e){for(let n=0;n<this.args.length;n++){const s=this.args[n].evaluate(e);if(!Po(this.type,lo(s)))return s;if(n===this.args.length-1)throw new $o(`Expected value to be of type ${lr(this.type)}, but found ${lr(lo(s))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,n=[e.kind];if("array"===e.kind){const s=e.itemType;if("string"===s.kind||"number"===s.kind||"boolean"===s.kind){n.push(s.kind);const h=e.N;("number"==typeof h||this.args.length>1)&&n.push(h)}}return n.concat(this.args.map(s=>s.serialize()))}}var Qi=ul;class zs{constructor(e){this.type=us,this.sections=e}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const s=e[1];if(!Array.isArray(s)&&"object"==typeof s)return n.error("First argument must be an image or text section.");const h=[];let p=!1;for(let y=1;y<=e.length-1;++y){const T=e[y];if(p&&"object"==typeof T&&!Array.isArray(T)){p=!1;let R=null;if(T["font-scale"]&&(R=n.parse(T["font-scale"],1,Wn),!R))return null;let F=null;if(T["text-font"]&&(F=n.parse(T["text-font"],1,Hi(Fi)),!F))return null;let W=null;if(T["text-color"]&&(W=n.parse(T["text-color"],1,Gi),!W))return null;const te=h[h.length-1];te.scale=R,te.font=F,te.textColor=W}else{const R=n.parse(e[y],1,Ji);if(!R)return null;const F=R.type.kind;if("string"!==F&&"value"!==F&&"null"!==F&&"resolvedImage"!==F)return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");p=!0,h.push({content:R,scale:null,font:null,textColor:null})}}return new zs(h)}evaluate(e){return new Ir(this.sections.map(n=>{const s=n.content.evaluate(e);return lo(s)===Ss?new vs("",s,null,null,null):new vs(Qs(s),null,n.scale?n.scale.evaluate(e):null,n.font?n.font.evaluate(e).join(","):null,n.textColor?n.textColor.evaluate(e):null)}))}eachChild(e){for(const n of this.sections)e(n.content),n.scale&&e(n.scale),n.font&&e(n.font),n.textColor&&e(n.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const n of this.sections){e.push(n.content.serialize());const s={};n.scale&&(s["font-scale"]=n.scale.serialize()),n.font&&(s["text-font"]=n.font.serialize()),n.textColor&&(s["text-color"]=n.textColor.serialize()),e.push(s)}return e}}class Qr{constructor(e){this.type=Ss,this.input=e}static parse(e,n){if(2!==e.length)return n.error("Expected two arguments.");const s=n.parse(e[1],1,Fi);return s?new Qr(s):n.error("No image name provided.")}evaluate(e){const n=this.input.evaluate(e),s=Vo.fromString(n);return s&&e.availableImages&&(s.available=e.availableImages.indexOf(n)>-1),s}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const da={"to-boolean":Xi,"to-color":Gi,"to-number":Wn,"to-string":Fi};class Da{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const s=e[0];if(("to-boolean"===s||"to-string"===s)&&2!==e.length)return n.error("Expected one argument.");const h=da[s],p=[];for(let y=1;y<e.length;y++){const T=n.parse(e[y],y,Ji);if(!T)return null;p.push(T)}return new Da(h,p)}evaluate(e){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(e));if("color"===this.type.kind){let n,s;for(const h of this.args){if(n=h.evaluate(e),s=null,n instanceof zr)return n;if("string"==typeof n){const p=e.parseColor(n);if(p)return p}else if(Array.isArray(n)&&(s=n.length<3||n.length>4?`Invalid rbga value ${JSON.stringify(n)}: expected an array containing either three or four numeric values.`:ya(n[0],n[1],n[2],n[3]),!s))return new zr(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new $o(s||`Could not parse color from value '${"string"==typeof n?n:String(JSON.stringify(n))}'`)}if("number"===this.type.kind){let n=null;for(const s of this.args){if(n=s.evaluate(e),null===n)return 0;const h=Number(n);if(!isNaN(h))return h}throw new $o(`Could not convert ${JSON.stringify(n)} to number.`)}return"formatted"===this.type.kind?Ir.fromString(Qs(this.args[0].evaluate(e))):"resolvedImage"===this.type.kind?Vo.fromString(Qs(this.args[0].evaluate(e))):Qs(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if("formatted"===this.type.kind)return new zs([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Qr(this.args[0]).serialize();const e=[`to-${this.type.kind}`];return this.eachChild(n=>{e.push(n.serialize())}),e}}var Us=Da;const Sa=["Unknown","Point","LineString","Polygon"];var qs=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Sa[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const t=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:n,y:s}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(n*e-t[0])+this.featureDistanceData.bearing[1]*(s*e-t[1])}return 0}parseColor(t){let e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=zr.parse(t)),e}};class Oo{constructor(e,n,s,h){this.name=e,this.type=n,this._evaluate=s,this.args=h}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,n){const s=e[0],h=Oo.definitions[s];if(!h)return n.error(`Unknown expression "${s}". If you wanted a literal array, use ["literal", [...]].`,0);const p=Array.isArray(h)?h[0]:h.type,y=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,T=y.filter(([F])=>!Array.isArray(F)||F.length===e.length-1);let R=null;for(const[F,W]of T){R=new je(n.registry,n.path,null,n.scope);const te=[];let re=!1;for(let _e=1;_e<e.length;_e++){const we=e[_e],Oe=Array.isArray(F)?F[_e-1]:F.type,Ve=R.parse(we,1+te.length,Oe);if(!Ve){re=!0;break}te.push(Ve)}if(!re)if(Array.isArray(F)&&F.length!==te.length)R.error(`Expected ${F.length} arguments, but found ${te.length} instead.`);else{for(let _e=0;_e<te.length;_e++){const we=Array.isArray(F)?F[_e]:F.type,Oe=te[_e];R.concat(_e+1).checkSubtype(we,Oe.type)}if(0===R.errors.length)return new Oo(s,p,W,te)}}if(1===T.length)n.errors.push(...R.errors);else{const F=(T.length?T:y).map(([te])=>{return re=te,Array.isArray(re)?`(${re.map(lr).join(", ")})`:`(${lr(re.type)}...)`;var re}).join(" | "),W=[];for(let te=1;te<e.length;te++){const re=n.parse(e[te],1+W.length);if(!re)return null;W.push(lr(re.type))}n.error(`Expected arguments of type ${F}, but found (${W.join(", ")}) instead.`)}return null}static register(e,n){Oo.definitions=n;for(const s in n)e[s]=Oo}}var Mo=Oo;class eo{constructor(e,n,s){this.type=Ko,this.locale=s,this.caseSensitive=e,this.diacriticSensitive=n}static parse(e,n){if(2!==e.length)return n.error("Expected one argument.");const s=e[1];if("object"!=typeof s||Array.isArray(s))return n.error("Collator options argument must be an object.");const h=n.parse(void 0!==s["case-sensitive"]&&s["case-sensitive"],1,Xi);if(!h)return null;const p=n.parse(void 0!==s["diacritic-sensitive"]&&s["diacritic-sensitive"],1,Xi);if(!p)return null;let y=null;return s.locale&&(y=n.parse(s.locale,1,Fi),!y)?null:new eo(h,p,y)}evaluate(e){return new rs(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const Xo=8192;function As(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function Ms(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function Pl(t,e){const n=(180+t[0])/360,s=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,h=Math.pow(2,e.z);return[Math.round(n*h*Xo),Math.round(s*h*Xo)]}function Aa(t,e,n){const s=t[0]-e[0],h=t[1]-e[1],p=t[0]-n[0],y=t[1]-n[1];return s*y-p*h==0&&s*p<=0&&h*y<=0}function ds(t,e){let n=!1;for(let y=0,T=e.length;y<T;y++){const R=e[y];for(let F=0,W=R.length;F<W-1;F++){if(Aa(t,R[F],R[F+1]))return!1;(h=R[F])[1]>(s=t)[1]!=(p=R[F+1])[1]>s[1]&&s[0]<(p[0]-h[0])*(s[1]-h[1])/(p[1]-h[1])+h[0]&&(n=!n)}}var s,h,p;return n}function ea(t,e){for(let n=0;n<e.length;n++)if(ds(t,e[n]))return!0;return!1}function Vs(t,e,n,s){const h=s[0]-n[0],p=s[1]-n[1],y=(t[0]-n[0])*p-h*(t[1]-n[1]),T=(e[0]-n[0])*p-h*(e[1]-n[1]);return y>0&&T<0||y<0&&T>0}function Wr(t,e,n){for(const F of n)for(let W=0;W<F.length-1;++W)if((T=[(y=F[W+1])[0]-(p=F[W])[0],y[1]-p[1]])[0]*(R=[(h=e)[0]-(s=t)[0],h[1]-s[1]])[1]-T[1]*R[0]!=0&&Vs(s,h,p,y)&&Vs(p,y,s,h))return!0;var s,h,p,y,T,R;return!1}function fs(t,e){for(let n=0;n<t.length;++n)if(!ds(t[n],e))return!1;for(let n=0;n<t.length-1;++n)if(Wr(t[n],t[n+1],e))return!1;return!0}function js(t,e){for(let n=0;n<e.length;n++)if(fs(t,e[n]))return!0;return!1}function ps(t,e,n){const s=[];for(let h=0;h<t.length;h++){const p=[];for(let y=0;y<t[h].length;y++){const T=Pl(t[h][y],n);As(e,T),p.push(T)}s.push(p)}return s}function Wa(t,e,n){const s=[];for(let h=0;h<t.length;h++){const p=ps(t[h],e,n);s.push(p)}return s}function I(t,e,n,s){if(t[0]<n[0]||t[0]>n[2]){const h=.5*s;let p=t[0]-n[0]>h?-s:n[0]-t[0]>h?s:0;0===p&&(p=t[0]-n[2]>h?-s:n[2]-t[0]>h?s:0),t[0]+=p}As(e,t)}function V(t,e,n,s){const h=Math.pow(2,s.z)*Xo,p=[s.x*Xo,s.y*Xo],y=[];if(!t)return y;for(const T of t)for(const R of T){const F=[R.x+p[0],R.y+p[1]];I(F,e,n,h),y.push(F)}return y}function ne(t,e,n,s){const h=Math.pow(2,s.z)*Xo,p=[s.x*Xo,s.y*Xo],y=[];if(!t)return y;for(const R of t){const F=[];for(const W of R){const te=[W.x+p[0],W.y+p[1]];As(e,te),F.push(te)}y.push(F)}if(e[2]-e[0]<=h/2){(T=e)[0]=T[1]=1/0,T[2]=T[3]=-1/0;for(const R of y)for(const F of R)I(F,e,n,h)}var T;return y}class ce{constructor(e,n){this.type=Xi,this.geojson=e,this.geometries=n}static parse(e,n){if(2!==e.length)return n.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(hs(e[1])){const s=e[1];if("FeatureCollection"===s.type)for(let h=0;h<s.features.length;++h){const p=s.features[h].geometry.type;if("Polygon"===p||"MultiPolygon"===p)return new ce(s,s.features[h].geometry)}else if("Feature"===s.type){const h=s.geometry.type;if("Polygon"===h||"MultiPolygon"===h)return new ce(s,s.geometry)}else if("Polygon"===s.type||"MultiPolygon"===s.type)return new ce(s,s)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(n,s){const h=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],y=n.canonicalID();if(!y)return!1;if("Polygon"===s.type){const T=ps(s.coordinates,p,y),R=V(n.geometry(),h,p,y);if(!Ms(h,p))return!1;for(const F of R)if(!ds(F,T))return!1}if("MultiPolygon"===s.type){const T=Wa(s.coordinates,p,y),R=V(n.geometry(),h,p,y);if(!Ms(h,p))return!1;for(const F of R)if(!ea(F,T))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(n,s){const h=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],y=n.canonicalID();if(!y)return!1;if("Polygon"===s.type){const T=ps(s.coordinates,p,y),R=ne(n.geometry(),h,p,y);if(!Ms(h,p))return!1;for(const F of R)if(!fs(F,T))return!1}if("MultiPolygon"===s.type){const T=Wa(s.coordinates,p,y),R=ne(n.geometry(),h,p,y);if(!Ms(h,p))return!1;for(const F of R)if(!js(F,T))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Ee=ce;function Ae(t){if(t instanceof Mo&&("get"===t.name&&1===t.args.length||"feature-state"===t.name||"has"===t.name&&1===t.args.length||"properties"===t.name||"geometry-type"===t.name||"id"===t.name||/^filter-/.test(t.name))||t instanceof Ee)return!1;let e=!0;return t.eachChild(n=>{e&&!Ae(n)&&(e=!1)}),e}function Le(t){if(t instanceof Mo&&"feature-state"===t.name)return!1;let e=!0;return t.eachChild(n=>{e&&!Le(n)&&(e=!1)}),e}function Y(t,e){if(t instanceof Mo&&e.indexOf(t.name)>=0)return!1;let n=!0;return t.eachChild(s=>{n&&!Y(s,e)&&(n=!1)}),n}class le{constructor(e,n){this.type=n.type,this.name=e,this.boundExpression=n}static parse(e,n){if(2!==e.length||"string"!=typeof e[1])return n.error("'var' expression requires exactly one string literal argument.");const s=e[1];return n.scope.has(s)?new le(s,n.scope.get(s)):n.error(`Unknown variable "${s}". Make sure "${s}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var ee=le;class be{constructor(e,n=[],s,h=new Mr,p=[]){this.registry=e,this.path=n,this.key=n.map(y=>`[${y}]`).join(""),this.scope=h,this.errors=p,this.expectedType=s}parse(e,n,s,h,p={}){return n?this.concat(n,s,h)._parse(e,p):this._parse(e,p)}_parse(e,n){function s(h,p,y){return"assert"===y?new Qi(p,[h]):"coerce"===y?new Us(p,[h]):h}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const h=e[0];if("string"!=typeof h)return this.error(`Expression name must be a string, but found ${typeof h} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const p=this.registry[h];if(p){let y=p.parse(e,this);if(!y)return null;if(this.expectedType){const T=this.expectedType,R=y.type;if("string"!==T.kind&&"number"!==T.kind&&"boolean"!==T.kind&&"object"!==T.kind&&"array"!==T.kind||"value"!==R.kind)if("color"!==T.kind&&"formatted"!==T.kind&&"resolvedImage"!==T.kind||"value"!==R.kind&&"string"!==R.kind){if(this.checkSubtype(T,R))return null}else y=s(y,T,n.typeAnnotation||"coerce");else y=s(y,T,n.typeAnnotation||"assert")}if(!(y instanceof ua)&&"resolvedImage"!==y.type.kind&&Ye(y)){const T=new qs;try{y=new ua(y.type,y.evaluate(T))}catch(R){return this.error(R.message),null}}return y}return this.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===e?"'undefined' value invalid. Use null instead.":"object"==typeof e?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,n,s){const h="number"==typeof e?this.path.concat(e):this.path,p=s?this.scope.concat(s):this.scope;return new be(this.registry,h,n||null,p,this.errors)}error(e,...n){const s=`${this.key}${n.map(h=>`[${h}]`).join("")}`;this.errors.push(new hr(s,e))}checkSubtype(e,n){const s=Po(e,n);return s&&this.error(s),s}}var je=be;function Ye(t){if(t instanceof ee)return Ye(t.boundExpression);if(t instanceof Mo&&"error"===t.name||t instanceof eo||t instanceof Ee)return!1;const e=t instanceof Us||t instanceof Qi;let n=!0;return t.eachChild(s=>{n=e?n&&Ye(s):n&&s instanceof ua}),!!n&&Ae(t)&&Y(t,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function mt(t,e){const n=t.length-1;let s,h,p=0,y=n,T=0;for(;p<=y;)if(T=Math.floor((p+y)/2),s=t[T],h=t[T+1],s<=e){if(T===n||e<h)return T;p=T+1}else{if(!(s>e))throw new $o("Input is not a number.");y=T-1}return 0}class On{constructor(e,n,s){this.type=e,this.input=n,this.labels=[],this.outputs=[];for(const[h,p]of s)this.labels.push(h),this.outputs.push(p)}static parse(e,n){if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");const s=n.parse(e[1],1,Wn);if(!s)return null;const h=[];let p=null;n.expectedType&&"value"!==n.expectedType.kind&&(p=n.expectedType);for(let y=1;y<e.length;y+=2){const T=1===y?-1/0:e[y],R=e[y+1],F=y,W=y+1;if("number"!=typeof T)return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',F);if(h.length&&h[h.length-1][0]>=T)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',F);const te=n.parse(R,W,p);if(!te)return null;p=p||te.type,h.push([T,te])}return new On(p,s,h)}evaluate(e){const n=this.labels,s=this.outputs;if(1===n.length)return s[0].evaluate(e);const h=this.input.evaluate(e);if(h<=n[0])return s[0].evaluate(e);const p=n.length;return h>=n[p-1]?s[p-1].evaluate(e):s[mt(n,h)].evaluate(e)}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let n=0;n<this.labels.length;n++)n>0&&e.push(this.labels[n]),e.push(this.outputs[n].serialize());return e}}var Ui=On;function wn(t,e,n){return t*(1-n)+e*n}function er(t,e,n){return t.map((s,h)=>wn(s,e[h],n))}var ji=Object.freeze({__proto__:null,number:wn,color:function(t,e,n){return new zr(wn(t.r,e.r,n),wn(t.g,e.g,n),wn(t.b,e.b,n),wn(t.a,e.a,n))},array:er});const bi=4/29,ge=6/29,he=3*ge*ge,ae=Math.PI/180,Re=180/Math.PI;function gn(t){return t>.008856451679035631?Math.pow(t,1/3):t/he+bi}function xi(t){return t>ge?t*t*t:he*(t-bi)}function vi(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Jo(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function ms(t){const e=Jo(t.r),n=Jo(t.g),s=Jo(t.b),h=gn((.4124564*e+.3575761*n+.1804375*s)/.95047),p=gn((.2126729*e+.7151522*n+.072175*s)/1);return{l:116*p-16,a:500*(h-p),b:200*(p-gn((.0193339*e+.119192*n+.9503041*s)/1.08883)),alpha:t.a}}function bs(t){let e=(t.l+16)/116,n=isNaN(t.a)?e:e+t.a/500,s=isNaN(t.b)?e:e-t.b/200;return e=1*xi(e),n=.95047*xi(n),s=1.08883*xi(s),new zr(vi(3.2404542*n-1.5371385*e-.4985314*s),vi(-.969266*n+1.8760108*e+.041556*s),vi(.0556434*n-.2040259*e+1.0572252*s),t.alpha)}function No(t,e,n){const s=e-t;return t+n*(s>180||s<-180?s-360*Math.round(s/360):s)}const xs={forward:ms,reverse:bs,interpolate:function(t,e,n){return{l:wn(t.l,e.l,n),a:wn(t.a,e.a,n),b:wn(t.b,e.b,n),alpha:wn(t.alpha,e.alpha,n)}}},ka={forward:function(t){const{l:e,a:n,b:s}=ms(t),h=Math.atan2(s,n)*Re;return{h:h<0?h+360:h,c:Math.sqrt(n*n+s*s),l:e,alpha:t.a}},reverse:function(t){const e=t.h*ae,n=t.c;return bs({l:t.l,a:Math.cos(e)*n,b:Math.sin(e)*n,alpha:t.alpha})},interpolate:function(t,e,n){return{h:No(t.h,e.h,n),c:wn(t.c,e.c,n),l:wn(t.l,e.l,n),alpha:wn(t.alpha,e.alpha,n)}}};var ta=Object.freeze({__proto__:null,lab:xs,hcl:ka});class Hn{constructor(e,n,s,h,p){this.type=e,this.operator=n,this.interpolation=s,this.input=h,this.labels=[],this.outputs=[];for(const[y,T]of p)this.labels.push(y),this.outputs.push(T)}static interpolationFactor(e,n,s,h){let p=0;if("exponential"===e.name)p=ki(n,e.base,s,h);else if("linear"===e.name)p=ki(n,1,s,h);else if("cubic-bezier"===e.name){const y=e.controlPoints;p=new lt(y[0],y[1],y[2],y[3]).solve(ki(n,1,s,h))}return p}static parse(e,n){let[s,h,p,...y]=e;if(!Array.isArray(h)||0===h.length)return n.error("Expected an interpolation type expression.",1);if("linear"===h[0])h={name:"linear"};else if("exponential"===h[0]){const F=h[1];if("number"!=typeof F)return n.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:F}}else{if("cubic-bezier"!==h[0])return n.error(`Unknown interpolation type ${String(h[0])}`,1,0);{const F=h.slice(1);if(4!==F.length||F.some(W=>"number"!=typeof W||W<0||W>1))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:F}}}if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(p=n.parse(p,2,Wn),!p)return null;const T=[];let R=null;"interpolate-hcl"===s||"interpolate-lab"===s?R=Gi:n.expectedType&&"value"!==n.expectedType.kind&&(R=n.expectedType);for(let F=0;F<y.length;F+=2){const W=y[F],te=y[F+1],re=F+3,_e=F+4;if("number"!=typeof W)return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',re);if(T.length&&T[T.length-1][0]>=W)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',re);const we=n.parse(te,_e,R);if(!we)return null;R=R||we.type,T.push([W,we])}return"number"===R.kind||"color"===R.kind||"array"===R.kind&&"number"===R.itemType.kind&&"number"==typeof R.N?new Hn(R,s,h,p,T):n.error(`Type ${lr(R)} is not interpolatable.`)}evaluate(e){const n=this.labels,s=this.outputs;if(1===n.length)return s[0].evaluate(e);const h=this.input.evaluate(e);if(h<=n[0])return s[0].evaluate(e);const p=n.length;if(h>=n[p-1])return s[p-1].evaluate(e);const y=mt(n,h),T=Hn.interpolationFactor(this.interpolation,h,n[y],n[y+1]),R=s[y].evaluate(e),F=s[y+1].evaluate(e);return"interpolate"===this.operator?ji[this.type.kind.toLowerCase()](R,F,T):"interpolate-hcl"===this.operator?ka.reverse(ka.interpolate(ka.forward(R),ka.forward(F),T)):xs.reverse(xs.interpolate(xs.forward(R),xs.forward(F),T))}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const n=[this.operator,e,this.input.serialize()];for(let s=0;s<this.labels.length;s++)n.push(this.labels[s],this.outputs[s].serialize());return n}}function ki(t,e,n,s){const h=s-n,p=t-n;return 0===h?0:1===e?p/h:(Math.pow(e,p)-1)/(Math.pow(e,h)-1)}var Go=Hn;class os{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expectected at least one argument.");let s=null;const h=n.expectedType;h&&"value"!==h.kind&&(s=h);const p=[];for(const T of e.slice(1)){const R=n.parse(T,1+p.length,s,void 0,{typeAnnotation:"omit"});if(!R)return null;s=s||R.type,p.push(R)}const y=h&&p.some(T=>Po(h,T.type));return new os(y?Ji:s,p)}evaluate(e){let n,s=null,h=0;for(const p of this.args){if(h++,s=p.evaluate(e),s&&s instanceof Vo&&!s.available&&(n||(n=s),s=null,h===this.args.length))return n;if(null!==s)break}return s}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(n=>{e.push(n.serialize())}),e}}var Na=os;class La{constructor(e,n){this.type=n.type,this.bindings=[].concat(e),this.result=n}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const n of this.bindings)e(n[1]);e(this.result)}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const s=[];for(let p=1;p<e.length-1;p+=2){const y=e[p];if("string"!=typeof y)return n.error(`Expected string, but found ${typeof y} instead.`,p);if(/[^a-zA-Z0-9_]/.test(y))return n.error("Variable names must contain only alphanumeric characters or '_'.",p);const T=n.parse(e[p+1],p+1);if(!T)return null;s.push([y,T])}const h=n.parse(e[e.length-1],e.length-1,n.expectedType,s);return h?new La(s,h):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[n,s]of this.bindings)e.push(n,s.serialize());return e.push(this.result.serialize()),e}}var Qo=La;class yl{constructor(e,n,s){this.type=e,this.index=n,this.input=s}static parse(e,n){if(3!==e.length)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const s=n.parse(e[1],1,Wn),h=n.parse(e[2],2,Hi(n.expectedType||Ji));return s&&h?new yl(h.type.itemType,s,h):null}evaluate(e){const n=this.index.evaluate(e),s=this.input.evaluate(e);if(n<0)throw new $o(`Array index out of bounds: ${n} < 0.`);if(n>=s.length)throw new $o(`Array index out of bounds: ${n} > ${s.length-1}.`);if(n!==Math.floor(n))throw new $o(`Array index must be an integer, but found ${n} instead.`);return s[n]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var Ua=yl;class hl{constructor(e,n){this.type=Xi,this.needle=e,this.haystack=n}static parse(e,n){if(3!==e.length)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const s=n.parse(e[1],1,Ji),h=n.parse(e[2],2,Ji);return s&&h?Dr(s.type,[Xi,Fi,Wn,Nr,Ji])?new hl(s,h):n.error(`Expected first argument to be of type boolean, string, number or null, but found ${lr(s.type)} instead`):null}evaluate(e){const n=this.needle.evaluate(e),s=this.haystack.evaluate(e);if(null==s)return!1;if(!Uo(n,["boolean","string","number","null"]))throw new $o(`Expected first argument to be of type boolean, string, number or null, but found ${lr(lo(n))} instead.`);if(!Uo(s,["string","array"]))throw new $o(`Expected second argument to be of type array or string, but found ${lr(lo(s))} instead.`);return s.indexOf(n)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Ya=hl;class Ma{constructor(e,n,s){this.type=Wn,this.needle=e,this.haystack=n,this.fromIndex=s}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const s=n.parse(e[1],1,Ji),h=n.parse(e[2],2,Ji);if(!s||!h)return null;if(!Dr(s.type,[Xi,Fi,Wn,Nr,Ji]))return n.error(`Expected first argument to be of type boolean, string, number or null, but found ${lr(s.type)} instead`);if(4===e.length){const p=n.parse(e[3],3,Wn);return p?new Ma(s,h,p):null}return new Ma(s,h)}evaluate(e){const n=this.needle.evaluate(e),s=this.haystack.evaluate(e);if(!Uo(n,["boolean","string","number","null"]))throw new $o(`Expected first argument to be of type boolean, string, number or null, but found ${lr(lo(n))} instead.`);if(!Uo(s,["string","array"]))throw new $o(`Expected second argument to be of type array or string, but found ${lr(lo(s))} instead.`);if(this.fromIndex){const h=this.fromIndex.evaluate(e);return s.indexOf(n,h)}return s.indexOf(n)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var Ws=Ma;class ss{constructor(e,n,s,h,p,y){this.inputType=e,this.type=n,this.input=s,this.cases=h,this.outputs=p,this.otherwise=y}static parse(e,n){if(e.length<5)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return n.error("Expected an even number of arguments.");let s,h;n.expectedType&&"value"!==n.expectedType.kind&&(h=n.expectedType);const p={},y=[];for(let F=2;F<e.length-1;F+=2){let W=e[F];const te=e[F+1];Array.isArray(W)||(W=[W]);const re=n.concat(F);if(0===W.length)return re.error("Expected at least one branch label.");for(const we of W){if("number"!=typeof we&&"string"!=typeof we)return re.error("Branch labels must be numbers or strings.");if("number"==typeof we&&Math.abs(we)>Number.MAX_SAFE_INTEGER)return re.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof we&&Math.floor(we)!==we)return re.error("Numeric branch labels must be integer values.");if(s){if(re.checkSubtype(s,lo(we)))return null}else s=lo(we);if(void 0!==p[String(we)])return re.error("Branch labels must be unique.");p[String(we)]=y.length}const _e=n.parse(te,F,h);if(!_e)return null;h=h||_e.type,y.push(_e)}const T=n.parse(e[1],1,Ji);if(!T)return null;const R=n.parse(e[e.length-1],e.length-1,h);return R?"value"!==T.type.kind&&n.concat(1).checkSubtype(s,T.type)?null:new ss(s,h,T,p,y,R):null}evaluate(e){const n=this.input.evaluate(e);return(lo(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],n=Object.keys(this.cases).sort(),s=[],h={};for(const y of n){const T=h[this.cases[y]];void 0===T?(h[this.cases[y]]=s.length,s.push([this.cases[y],[y]])):s[T][1].push(y)}const p=y=>"number"===this.inputType.kind?Number(y):y;for(const[y,T]of s)e.push(1===T.length?p(T[0]):T.map(p)),e.push(this.outputs[y].serialize());return e.push(this.otherwise.serialize()),e}}var ba=ss;class Ka{constructor(e,n,s){this.type=e,this.branches=n,this.otherwise=s}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return n.error("Expected an odd number of arguments.");let s;n.expectedType&&"value"!==n.expectedType.kind&&(s=n.expectedType);const h=[];for(let y=1;y<e.length-1;y+=2){const T=n.parse(e[y],y,Xi);if(!T)return null;const R=n.parse(e[y+1],y+1,s);if(!R)return null;h.push([T,R]),s=s||R.type}const p=n.parse(e[e.length-1],e.length-1,s);return p?new Ka(s,h,p):null}evaluate(e){for(const[n,s]of this.branches)if(n.evaluate(e))return s.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[n,s]of this.branches)e(n),e(s);e(this.otherwise)}outputDefined(){return this.branches.every(([e,n])=>n.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(n=>{e.push(n.serialize())}),e}}var xa=Ka;class gs{constructor(e,n,s,h){this.type=e,this.input=n,this.beginIndex=s,this.endIndex=h}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const s=n.parse(e[1],1,Ji),h=n.parse(e[2],2,Wn);if(!s||!h)return null;if(!Dr(s.type,[Hi(Ji),Fi,Ji]))return n.error(`Expected first argument to be of type array or string, but found ${lr(s.type)} instead`);if(4===e.length){const p=n.parse(e[3],3,Wn);return p?new gs(s.type,s,h,p):null}return new gs(s.type,s,h)}evaluate(e){const n=this.input.evaluate(e),s=this.beginIndex.evaluate(e);if(!Uo(n,["string","array"]))throw new $o(`Expected first argument to be of type array or string, but found ${lr(lo(n))} instead.`);if(this.endIndex){const h=this.endIndex.evaluate(e);return n.slice(s,h)}return n.slice(s)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var vl=gs;function Is(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function wa(t,e,n,s){return 0===s.compare(e,n)}function _s(t,e,n){const s="=="!==t&&"!="!==t;return class c1{constructor(p,y,T){this.type=Xi,this.lhs=p,this.rhs=y,this.collator=T,this.hasUntypedArgument="value"===p.type.kind||"value"===y.type.kind}static parse(p,y){if(3!==p.length&&4!==p.length)return y.error("Expected two or three arguments.");const T=p[0];let R=y.parse(p[1],1,Ji);if(!R)return null;if(!Is(T,R.type))return y.concat(1).error(`"${T}" comparisons are not supported for type '${lr(R.type)}'.`);let F=y.parse(p[2],2,Ji);if(!F)return null;if(!Is(T,F.type))return y.concat(2).error(`"${T}" comparisons are not supported for type '${lr(F.type)}'.`);if(R.type.kind!==F.type.kind&&"value"!==R.type.kind&&"value"!==F.type.kind)return y.error(`Cannot compare types '${lr(R.type)}' and '${lr(F.type)}'.`);s&&("value"===R.type.kind&&"value"!==F.type.kind?R=new Qi(F.type,[R]):"value"!==R.type.kind&&"value"===F.type.kind&&(F=new Qi(R.type,[F])));let W=null;if(4===p.length){if("string"!==R.type.kind&&"string"!==F.type.kind&&"value"!==R.type.kind&&"value"!==F.type.kind)return y.error("Cannot use collator to compare non-string types.");if(W=y.parse(p[3],3,Ko),!W)return null}return new c1(R,F,W)}evaluate(p){const y=this.lhs.evaluate(p),T=this.rhs.evaluate(p);if(s&&this.hasUntypedArgument){const R=lo(y),F=lo(T);if(R.kind!==F.kind||"string"!==R.kind&&"number"!==R.kind)throw new $o(`Expected arguments for "${t}" to be (string, string) or (number, number), but found (${R.kind}, ${F.kind}) instead.`)}if(this.collator&&!s&&this.hasUntypedArgument){const R=lo(y),F=lo(T);if("string"!==R.kind||"string"!==F.kind)return e(p,y,T)}return this.collator?n(p,y,T,this.collator.evaluate(p)):e(p,y,T)}eachChild(p){p(this.lhs),p(this.rhs),this.collator&&p(this.collator)}outputDefined(){return!0}serialize(){const p=[t];return this.eachChild(y=>{p.push(y.serialize())}),p}}}const Va=_s("==",function(t,e,n){return e===n},wa),Ia=_s("!=",function(t,e,n){return e!==n},function(t,e,n,s){return!wa(0,e,n,s)}),bl=_s("<",function(t,e,n){return e<n},function(t,e,n,s){return s.compare(e,n)<0}),io=_s(">",function(t,e,n){return e>n},function(t,e,n,s){return s.compare(e,n)>0}),Fa=_s("<=",function(t,e,n){return e<=n},function(t,e,n,s){return s.compare(e,n)<=0}),Ns=_s(">=",function(t,e,n){return e>=n},function(t,e,n,s){return s.compare(e,n)>=0});class es{constructor(e,n,s,h,p,y){this.type=Fi,this.number=e,this.locale=n,this.currency=s,this.unit=h,this.minFractionDigits=p,this.maxFractionDigits=y}static parse(e,n){if(3!==e.length)return n.error("Expected two arguments.");const s=n.parse(e[1],1,Wn);if(!s)return null;const h=e[2];if("object"!=typeof h||Array.isArray(h))return n.error("NumberFormat options argument must be an object.");let p=null;if(h.locale&&(p=n.parse(h.locale,1,Fi),!p))return null;let y=null;if(h.currency&&(y=n.parse(h.currency,1,Fi),!y))return null;let T=null;if(h.unit&&(T=n.parse(h.unit,1,Fi),!T))return null;let R=null;if(h["min-fraction-digits"]&&(R=n.parse(h["min-fraction-digits"],1,Wn),!R))return null;let F=null;return h["max-fraction-digits"]&&(F=n.parse(h["max-fraction-digits"],1,Wn),!F)?null:new es(s,p,y,T,R,F)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class Xa{constructor(e){this.type=Wn,this.input=e}static parse(e,n){if(2!==e.length)return n.error(`Expected 1 argument, but found ${e.length-1} instead.`);const s=n.parse(e[1],1);return s?"array"!==s.type.kind&&"string"!==s.type.kind&&"value"!==s.type.kind?n.error(`Expected argument of type string or array, but found ${lr(s.type)} instead.`):new Xa(s):null}evaluate(e){const n=this.input.evaluate(e);if("string"==typeof n||Array.isArray(n))return n.length;throw new $o(`Expected value to be of type string or array, but found ${lr(lo(n))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(n=>{e.push(n.serialize())}),e}}const xl={"==":Va,"!=":Ia,">":io,"<":bl,">=":Ns,"<=":Fa,array:Qi,at:Ua,boolean:Qi,case:xa,coalesce:Na,collator:eo,format:zs,image:Qr,in:Ya,"index-of":Ws,interpolate:Go,"interpolate-hcl":Go,"interpolate-lab":Go,length:Xa,let:Qo,literal:ua,match:ba,number:Qi,"number-format":es,object:Qi,slice:vl,step:Ui,string:Qi,"to-boolean":Us,"to-color":Us,"to-number":Us,"to-string":Us,var:ee,within:Ee};function Ol(t,[e,n,s,h]){e=e.evaluate(t),n=n.evaluate(t),s=s.evaluate(t);const p=h?h.evaluate(t):1,y=ya(e,n,s,p);if(y)throw new $o(y);return new zr(e/255*p,n/255*p,s/255*p,p)}function nl(t,e){return t in e}function Pa(t,e){const n=e[t];return void 0===n?null:n}function Ps(t){return{type:t}}Mo.register(xl,{error:[{kind:"error"},[Fi],(t,[e])=>{throw new $o(e.evaluate(t))}],typeof:[Fi,[Ji],(t,[e])=>lr(lo(e.evaluate(t)))],"to-rgba":[Hi(Wn,4),[Gi],(t,[e])=>e.evaluate(t).toArray()],rgb:[Gi,[Wn,Wn,Wn],Ol],rgba:[Gi,[Wn,Wn,Wn,Wn],Ol],has:{type:Xi,overloads:[[[Fi],(t,[e])=>nl(e.evaluate(t),t.properties())],[[Fi,yi],(t,[e,n])=>nl(e.evaluate(t),n.evaluate(t))]]},get:{type:Ji,overloads:[[[Fi],(t,[e])=>Pa(e.evaluate(t),t.properties())],[[Fi,yi],(t,[e,n])=>Pa(e.evaluate(t),n.evaluate(t))]]},"feature-state":[Ji,[Fi],(t,[e])=>Pa(e.evaluate(t),t.featureState||{})],properties:[yi,[],t=>t.properties()],"geometry-type":[Fi,[],t=>t.geometryType()],id:[Ji,[],t=>t.id()],zoom:[Wn,[],t=>t.globals.zoom],pitch:[Wn,[],t=>t.globals.pitch||0],"distance-from-center":[Wn,[],t=>t.distanceFromCenter()],"heatmap-density":[Wn,[],t=>t.globals.heatmapDensity||0],"line-progress":[Wn,[],t=>t.globals.lineProgress||0],"sky-radial-progress":[Wn,[],t=>t.globals.skyRadialProgress||0],accumulated:[Ji,[],t=>void 0===t.globals.accumulated?null:t.globals.accumulated],"+":[Wn,Ps(Wn),(t,e)=>{let n=0;for(const s of e)n+=s.evaluate(t);return n}],"*":[Wn,Ps(Wn),(t,e)=>{let n=1;for(const s of e)n*=s.evaluate(t);return n}],"-":{type:Wn,overloads:[[[Wn,Wn],(t,[e,n])=>e.evaluate(t)-n.evaluate(t)],[[Wn],(t,[e])=>-e.evaluate(t)]]},"/":[Wn,[Wn,Wn],(t,[e,n])=>e.evaluate(t)/n.evaluate(t)],"%":[Wn,[Wn,Wn],(t,[e,n])=>e.evaluate(t)%n.evaluate(t)],ln2:[Wn,[],()=>Math.LN2],pi:[Wn,[],()=>Math.PI],e:[Wn,[],()=>Math.E],"^":[Wn,[Wn,Wn],(t,[e,n])=>Math.pow(e.evaluate(t),n.evaluate(t))],sqrt:[Wn,[Wn],(t,[e])=>Math.sqrt(e.evaluate(t))],log10:[Wn,[Wn],(t,[e])=>Math.log(e.evaluate(t))/Math.LN10],ln:[Wn,[Wn],(t,[e])=>Math.log(e.evaluate(t))],log2:[Wn,[Wn],(t,[e])=>Math.log(e.evaluate(t))/Math.LN2],sin:[Wn,[Wn],(t,[e])=>Math.sin(e.evaluate(t))],cos:[Wn,[Wn],(t,[e])=>Math.cos(e.evaluate(t))],tan:[Wn,[Wn],(t,[e])=>Math.tan(e.evaluate(t))],asin:[Wn,[Wn],(t,[e])=>Math.asin(e.evaluate(t))],acos:[Wn,[Wn],(t,[e])=>Math.acos(e.evaluate(t))],atan:[Wn,[Wn],(t,[e])=>Math.atan(e.evaluate(t))],min:[Wn,Ps(Wn),(t,e)=>Math.min(...e.map(n=>n.evaluate(t)))],max:[Wn,Ps(Wn),(t,e)=>Math.max(...e.map(n=>n.evaluate(t)))],abs:[Wn,[Wn],(t,[e])=>Math.abs(e.evaluate(t))],round:[Wn,[Wn],(t,[e])=>{const n=e.evaluate(t);return n<0?-Math.round(-n):Math.round(n)}],floor:[Wn,[Wn],(t,[e])=>Math.floor(e.evaluate(t))],ceil:[Wn,[Wn],(t,[e])=>Math.ceil(e.evaluate(t))],"filter-==":[Xi,[Fi,Ji],(t,[e,n])=>t.properties()[e.value]===n.value],"filter-id-==":[Xi,[Ji],(t,[e])=>t.id()===e.value],"filter-type-==":[Xi,[Fi],(t,[e])=>t.geometryType()===e.value],"filter-<":[Xi,[Fi,Ji],(t,[e,n])=>{const s=t.properties()[e.value],h=n.value;return typeof s==typeof h&&s<h}],"filter-id-<":[Xi,[Ji],(t,[e])=>{const n=t.id(),s=e.value;return typeof n==typeof s&&n<s}],"filter->":[Xi,[Fi,Ji],(t,[e,n])=>{const s=t.properties()[e.value],h=n.value;return typeof s==typeof h&&s>h}],"filter-id->":[Xi,[Ji],(t,[e])=>{const n=t.id(),s=e.value;return typeof n==typeof s&&n>s}],"filter-<=":[Xi,[Fi,Ji],(t,[e,n])=>{const s=t.properties()[e.value],h=n.value;return typeof s==typeof h&&s<=h}],"filter-id-<=":[Xi,[Ji],(t,[e])=>{const n=t.id(),s=e.value;return typeof n==typeof s&&n<=s}],"filter->=":[Xi,[Fi,Ji],(t,[e,n])=>{const s=t.properties()[e.value],h=n.value;return typeof s==typeof h&&s>=h}],"filter-id->=":[Xi,[Ji],(t,[e])=>{const n=t.id(),s=e.value;return typeof n==typeof s&&n>=s}],"filter-has":[Xi,[Ji],(t,[e])=>e.value in t.properties()],"filter-has-id":[Xi,[],t=>null!==t.id()&&void 0!==t.id()],"filter-type-in":[Xi,[Hi(Fi)],(t,[e])=>e.value.indexOf(t.geometryType())>=0],"filter-id-in":[Xi,[Hi(Ji)],(t,[e])=>e.value.indexOf(t.id())>=0],"filter-in-small":[Xi,[Fi,Hi(Ji)],(t,[e,n])=>n.value.indexOf(t.properties()[e.value])>=0],"filter-in-large":[Xi,[Fi,Hi(Ji)],(t,[e,n])=>function(s,h,p,y){for(;p<=y;){const T=p+y>>1;if(h[T]===s)return!0;h[T]>s?y=T-1:p=T+1}return!1}(t.properties()[e.value],n.value,0,n.value.length-1)],all:{type:Xi,overloads:[[[Xi,Xi],(t,[e,n])=>e.evaluate(t)&&n.evaluate(t)],[Ps(Xi),(t,e)=>{for(const n of e)if(!n.evaluate(t))return!1;return!0}]]},any:{type:Xi,overloads:[[[Xi,Xi],(t,[e,n])=>e.evaluate(t)||n.evaluate(t)],[Ps(Xi),(t,e)=>{for(const n of e)if(n.evaluate(t))return!0;return!1}]]},"!":[Xi,[Xi],(t,[e])=>!e.evaluate(t)],"is-supported-script":[Xi,[Fi],(t,[e])=>{const n=t.globals&&t.globals.isSupportedScript;return!n||n(e.evaluate(t))}],upcase:[Fi,[Fi],(t,[e])=>e.evaluate(t).toUpperCase()],downcase:[Fi,[Fi],(t,[e])=>e.evaluate(t).toLowerCase()],concat:[Fi,Ps(Ji),(t,e)=>e.map(n=>Qs(n.evaluate(t))).join("")],"resolved-locale":[Fi,[Ko],(t,[e])=>e.evaluate(t).resolvedLocale()]});var Ba=xl;function ws(t){return{result:"success",value:t}}function ts(t){return{result:"error",value:t}}function bo(t){return"data-driven"===t["property-type"]||"cross-faded-data-driven"===t["property-type"]}function fa(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function wl(t){return!!t.expression&&t.expression.interpolated}function Cr(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function ja(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function Rl(t){return t}function Za(t,e){const n="color"===e.type,s=t.stops&&"object"==typeof t.stops[0][0],h=s||!(s||void 0!==t.property),p=t.type||(wl(e)?"exponential":"interval");if(n&&((t=Gr({},t)).stops&&(t.stops=t.stops.map(F=>[F[0],zr.parse(F[1])])),t.default=zr.parse(t.default?t.default:e.default)),t.colorSpace&&"rgb"!==t.colorSpace&&!ta[t.colorSpace])throw new Error(`Unknown color space: ${t.colorSpace}`);let y,T,R;if("exponential"===p)y=vn;else if("interval"===p)y=Ut;else if("categorical"===p){y=gt,T=Object.create(null);for(const F of t.stops)T[F[0]]=F[1];R=typeof t.stops[0][0]}else{if("identity"!==p)throw new Error(`Unknown function type "${p}"`);y=Wt}if(s){const F={},W=[];for(let _e=0;_e<t.stops.length;_e++){const we=t.stops[_e],Oe=we[0].zoom;void 0===F[Oe]&&(F[Oe]={zoom:Oe,type:t.type,property:t.property,default:t.default,stops:[]},W.push(Oe)),F[Oe].stops.push([we[0].value,we[1]])}const te=[];for(const _e of W)te.push([F[_e].zoom,Za(F[_e],e)]);const re={name:"linear"};return{kind:"composite",interpolationType:re,interpolationFactor:Go.interpolationFactor.bind(void 0,re),zoomStops:te.map(_e=>_e[0]),evaluate:({zoom:_e},we)=>vn({stops:te,base:t.base},e,_e).evaluate(_e,we)}}if(h){const F="exponential"===p?{name:"exponential",base:void 0!==t.base?t.base:1}:null;return{kind:"camera",interpolationType:F,interpolationFactor:Go.interpolationFactor.bind(void 0,F),zoomStops:t.stops.map(W=>W[0]),evaluate:({zoom:W})=>y(t,e,W,T,R)}}return{kind:"source",evaluate(F,W){const te=W&&W.properties?W.properties[t.property]:void 0;return void 0===te?Ue(t.default,e.default):y(t,e,te,T,R)}}}function Ue(t,e,n){return void 0!==t?t:void 0!==e?e:void 0!==n?n:void 0}function gt(t,e,n,s,h){return Ue(typeof n===h?s[n]:void 0,t.default,e.default)}function Ut(t,e,n){if("number"!==Cr(n))return Ue(t.default,e.default);const s=t.stops.length;if(1===s||n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[s-1][0])return t.stops[s-1][1];const h=mt(t.stops.map(p=>p[0]),n);return t.stops[h][1]}function vn(t,e,n){const s=void 0!==t.base?t.base:1;if("number"!==Cr(n))return Ue(t.default,e.default);const h=t.stops.length;if(1===h||n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[h-1][0])return t.stops[h-1][1];const p=mt(t.stops.map(W=>W[0]),n),y=function(W,te,re,_e){const we=_e-re,Oe=W-re;return 0===we?0:1===te?Oe/we:(Math.pow(te,Oe)-1)/(Math.pow(te,we)-1)}(n,s,t.stops[p][0],t.stops[p+1][0]),T=t.stops[p][1],R=t.stops[p+1][1];let F=ji[e.type]||Rl;if(t.colorSpace&&"rgb"!==t.colorSpace){const W=ta[t.colorSpace];F=(te,re)=>W.reverse(W.interpolate(W.forward(te),W.forward(re),y))}return"function"==typeof T.evaluate?{evaluate(...W){const te=T.evaluate.apply(void 0,W),re=R.evaluate.apply(void 0,W);if(void 0!==te&&void 0!==re)return F(te,re,y)}}:F(T,R,y)}function Wt(t,e,n){return"color"===e.type?n=zr.parse(n):"formatted"===e.type?n=Ir.fromString(n.toString()):"resolvedImage"===e.type?n=Vo.fromString(n.toString()):Cr(n)===e.type||"enum"===e.type&&e.values[n]||(n=void 0),Ue(n,t.default,e.default)}class Bn{constructor(e,n){var s;this.expression=e,this._warningHistory={},this._evaluator=new qs,this._defaultValue=n?"color"===(s=n).type&&(ja(s.default)||Array.isArray(s.default))?new zr(0,0,0,0):"color"===s.type?zr.parse(s.default)||null:void 0===s.default?null:s.default:null,this._enumValues=n&&"enum"===n.type?n.values:null}evaluateWithoutErrorHandling(e,n,s,h,p,y,T,R){return this._evaluator.globals=e,this._evaluator.feature=n,this._evaluator.featureState=s,this._evaluator.canonical=h||null,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=y,this._evaluator.featureTileCoord=T||null,this._evaluator.featureDistanceData=R||null,this.expression.evaluate(this._evaluator)}evaluate(e,n,s,h,p,y,T,R){this._evaluator.globals=e,this._evaluator.feature=n||null,this._evaluator.featureState=s||null,this._evaluator.canonical=h||null,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=y||null,this._evaluator.featureTileCoord=T||null,this._evaluator.featureDistanceData=R||null;try{const F=this.expression.evaluate(this._evaluator);if(null==F||"number"==typeof F&&F!=F)return this._defaultValue;if(this._enumValues&&!(F in this._enumValues))throw new $o(`Expected value to be one of ${Object.keys(this._enumValues).map(W=>JSON.stringify(W)).join(", ")}, but found ${JSON.stringify(F)} instead.`);return F}catch(F){return this._warningHistory[F.message]||(this._warningHistory[F.message]=!0,"undefined"!=typeof console&&console.warn(F.message)),this._defaultValue}}}function Vn(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in Ba}function ai(t,e){const n=new je(Ba,[],e?function(h){const p={color:Gi,string:Fi,number:Wn,enum:Fi,boolean:Xi,formatted:us,resolvedImage:Ss};return"array"===h.type?Hi(p[h.value]||Ji,h.length):p[h.type]}(e):void 0),s=n.parse(t,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return s?ws(new Bn(s,e)):ts(n.errors)}class Ii{constructor(e,n){this.kind=e,this._styleExpression=n,this.isStateDependent="constant"!==e&&!Le(n.expression)}evaluateWithoutErrorHandling(e,n,s,h,p,y){return this._styleExpression.evaluateWithoutErrorHandling(e,n,s,h,p,y)}evaluate(e,n,s,h,p,y){return this._styleExpression.evaluate(e,n,s,h,p,y)}}class pr{constructor(e,n,s,h){this.kind=e,this.zoomStops=s,this._styleExpression=n,this.isStateDependent="camera"!==e&&!Le(n.expression),this.interpolationType=h}evaluateWithoutErrorHandling(e,n,s,h,p,y){return this._styleExpression.evaluateWithoutErrorHandling(e,n,s,h,p,y)}evaluate(e,n,s,h,p,y){return this._styleExpression.evaluate(e,n,s,h,p,y)}interpolationFactor(e,n,s){return this.interpolationType?Go.interpolationFactor(this.interpolationType,e,n,s):0}}function Ni(t,e){if("error"===(t=ai(t,e)).result)return t;const n=t.value.expression,s=Ae(n);if(!s&&!bo(e))return ts([new hr("","data expressions not supported")]);const h=Y(n,["zoom","pitch","distance-from-center"]);if(!h&&!fa(e))return ts([new hr("","zoom expressions not supported")]);const p=yr(n);return p||h?p instanceof hr?ts([p]):p instanceof Go&&!wl(e)?ts([new hr("",'"interpolate" expressions cannot be used with this property')]):ws(p?new pr(s?"camera":"composite",t.value,p.labels,p instanceof Go?p.interpolation:void 0):new Ii(s?"constant":"source",t.value)):ts([new hr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class cr{constructor(e,n){this._parameters=e,this._specification=n,Gr(this,Za(this._parameters,this._specification))}static deserialize(e){return new cr(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function yr(t){let e=null;if(t instanceof Qo)e=yr(t.result);else if(t instanceof Na){for(const n of t.args)if(e=yr(n),e)break}else(t instanceof Ui||t instanceof Go)&&t.input instanceof Mo&&"zoom"===t.input.name&&(e=t);return e instanceof hr||t.eachChild(n=>{const s=yr(n);s instanceof hr?e=s:!e&&s?e=new hr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&s&&e!==s&&(e=new hr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}class q{constructor(e,n,s,h){this.message=(e?`${e}: `:"")+s,h&&(this.identifier=h),null!=n&&n.__line__&&(this.line=n.__line__)}}function J(t){const e=t.key,n=t.value,s=t.valueSpec||{},h=t.objectElementValidators||{},p=t.style,y=t.styleSpec;let T=[];const R=Cr(n);if("object"!==R)return[new q(e,n,`object expected, ${R} found`)];for(const F in n){const W=F.split(".")[0],te=s[W]||s["*"];let re;h[W]?re=h[W]:s[W]?re=Gs:h["*"]?re=h["*"]:s["*"]&&(re=Gs),re?T=T.concat(re({key:(e&&`${e}.`)+F,value:n[F],valueSpec:te,style:p,styleSpec:y,object:n,objectKey:F},n)):T.push(new q(e,n[F],`unknown property "${F}"`))}for(const F in s)h[F]||s[F].required&&void 0===s[F].default&&void 0===n[F]&&T.push(new q(e,n,`missing required property "${F}"`));return T}function Ie(t){const e=t.value,n=t.valueSpec,s=t.style,h=t.styleSpec,p=t.key,y=t.arrayElementValidator||Gs;if("array"!==Cr(e))return[new q(p,e,`array expected, ${Cr(e)} found`)];if(n.length&&e.length!==n.length)return[new q(p,e,`array length ${n.length} expected, length ${e.length} found`)];if(n["min-length"]&&e.length<n["min-length"])return[new q(p,e,`array length at least ${n["min-length"]} expected, length ${e.length} found`)];let T={type:n.value,values:n.values,minimum:n.minimum,maximum:n.maximum,function:void 0};h.$version<7&&(T.function=n.function),"object"===Cr(n.value)&&(T=n.value);let R=[];for(let F=0;F<e.length;F++)R=R.concat(y({array:e,arrayIndex:F,value:e[F],valueSpec:T,style:s,styleSpec:h,key:`${p}[${F}]`}));return R}function ut(t){const e=t.key,n=t.value,s=t.valueSpec;let h=Cr(n);if("number"===h&&n!=n&&(h="NaN"),"number"!==h)return[new q(e,n,`number expected, ${h} found`)];if("minimum"in s){let p=s.minimum;if("array"===Cr(s.minimum)&&(p=s.minimum[t.arrayIndex]),n<p)return[new q(e,n,`${n} is less than the minimum value ${p}`)]}if("maximum"in s){let p=s.maximum;if("array"===Cr(s.maximum)&&(p=s.maximum[t.arrayIndex]),n>p)return[new q(e,n,`${n} is greater than the maximum value ${p}`)]}return[]}function pn(t){const e=t.valueSpec,n=gr(t.value.type);let s,h,p,y={};const T="categorical"!==n&&void 0===t.value.property,R=!T,F="array"===Cr(t.value.stops)&&"array"===Cr(t.value.stops[0])&&"object"===Cr(t.value.stops[0][0]),W=J({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(_e){if("identity"===n)return[new q(_e.key,_e.value,'identity function may not have a "stops" property')];let we=[];const Oe=_e.value;return we=we.concat(Ie({key:_e.key,value:Oe,valueSpec:_e.valueSpec,style:_e.style,styleSpec:_e.styleSpec,arrayElementValidator:te})),"array"===Cr(Oe)&&0===Oe.length&&we.push(new q(_e.key,Oe,"array must have at least one stop")),we},default:function(_e){return Gs({key:_e.key,value:_e.value,valueSpec:e,style:_e.style,styleSpec:_e.styleSpec})}}});return"identity"===n&&T&&W.push(new q(t.key,t.value,'missing required property "property"')),"identity"===n||t.value.stops||W.push(new q(t.key,t.value,'missing required property "stops"')),"exponential"===n&&t.valueSpec.expression&&!wl(t.valueSpec)&&W.push(new q(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(R&&!bo(t.valueSpec)?W.push(new q(t.key,t.value,"property functions not supported")):T&&!fa(t.valueSpec)&&W.push(new q(t.key,t.value,"zoom functions not supported"))),"categorical"!==n&&!F||void 0!==t.value.property||W.push(new q(t.key,t.value,'"property" property is required')),W;function te(_e){let we=[];const Oe=_e.value,Ve=_e.key;if("array"!==Cr(Oe))return[new q(Ve,Oe,`array expected, ${Cr(Oe)} found`)];if(2!==Oe.length)return[new q(Ve,Oe,`array length 2 expected, length ${Oe.length} found`)];if(F){if("object"!==Cr(Oe[0]))return[new q(Ve,Oe,`object expected, ${Cr(Oe[0])} found`)];if(void 0===Oe[0].zoom)return[new q(Ve,Oe,"object stop key must have zoom")];if(void 0===Oe[0].value)return[new q(Ve,Oe,"object stop key must have value")];const it=gr(Oe[0].zoom);if("number"!=typeof it)return[new q(Ve,Oe[0].zoom,"stop zoom values must be numbers")];if(p&&p>it)return[new q(Ve,Oe[0].zoom,"stop zoom values must appear in ascending order")];it!==p&&(p=it,h=void 0,y={}),we=we.concat(J({key:`${Ve}[0]`,value:Oe[0],valueSpec:{zoom:{}},style:_e.style,styleSpec:_e.styleSpec,objectElementValidators:{zoom:ut,value:re}}))}else we=we.concat(re({key:`${Ve}[0]`,value:Oe[0],valueSpec:{},style:_e.style,styleSpec:_e.styleSpec},Oe));return Vn(Rn(Oe[1]))?we.concat([new q(`${Ve}[1]`,Oe[1],"expressions are not allowed in function stops.")]):we.concat(Gs({key:`${Ve}[1]`,value:Oe[1],valueSpec:e,style:_e.style,styleSpec:_e.styleSpec}))}function re(_e,we){const Oe=Cr(_e.value),Ve=gr(_e.value),it=null!==_e.value?_e.value:we;if(s){if(Oe!==s)return[new q(_e.key,it,`${Oe} stop domain type must match previous stop domain type ${s}`)]}else s=Oe;if("number"!==Oe&&"string"!==Oe&&"boolean"!==Oe&&"number"!=typeof Ve&&"string"!=typeof Ve&&"boolean"!=typeof Ve)return[new q(_e.key,it,"stop domain value must be a number, string, or boolean")];if("number"!==Oe&&"categorical"!==n){let bt=`number expected, ${Oe} found`;return bo(e)&&void 0===n&&(bt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new q(_e.key,it,bt)]}return"categorical"!==n||"number"!==Oe||"number"==typeof Ve&&isFinite(Ve)&&Math.floor(Ve)===Ve?"categorical"!==n&&"number"===Oe&&"number"==typeof Ve&&"number"==typeof h&&void 0!==h&&Ve<h?[new q(_e.key,it,"stop domain values must appear in ascending order")]:(h=Ve,"categorical"===n&&Ve in y?[new q(_e.key,it,"stop domain values must be unique")]:(y[Ve]=!0,[])):[new q(_e.key,it,`integer expected, found ${String(Ve)}`)]}}function Jn(t){const e=("property"===t.expressionContext?Ni:ai)(Rn(t.value),t.valueSpec);if("error"===e.result)return e.value.map(s=>new q(`${t.key}${s.key}`,t.value,s.message));const n=e.value.expression||e.value._styleExpression.expression;if("property"===t.expressionContext&&"text-font"===t.propertyKey&&!n.outputDefined())return[new q(t.key,t.value,`Invalid data expression for "${t.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===t.expressionContext&&"layout"===t.propertyType&&!Le(n))return[new q(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===t.expressionContext)return xo(n,t);if(t.expressionContext&&0===t.expressionContext.indexOf("cluster")){if(!Y(n,["zoom","feature-state"]))return[new q(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===t.expressionContext&&!Ae(n))return[new q(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function xo(t,e){const n=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(e.valueSpec&&e.valueSpec.expression)for(const h of e.valueSpec.expression.parameters)n.delete(h);if(0===n.size)return[];const s=[];return t instanceof Mo&&n.has(t.name)?[new q(e.key,e.value,`["${t.name}"] expression is not supported in a filter for a ${e.object.type} layer with id: ${e.object.id}`)]:(t.eachChild(h=>{s.push(...xo(h,e))}),s)}function Ts(t){const e=t.key,n=t.value,s=t.valueSpec,h=[];return Array.isArray(s.values)?-1===s.values.indexOf(gr(n))&&h.push(new q(e,n,`expected one of [${s.values.join(", ")}], ${JSON.stringify(n)} found`)):-1===Object.keys(s.values).indexOf(gr(n))&&h.push(new q(e,n,`expected one of [${Object.keys(s.values).join(", ")}], ${JSON.stringify(n)} found`)),h}function Hr(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(const e of t.slice(1))if(!Hr(e)&&"boolean"!=typeof e)return!1;return!0;default:return!0}}function Os(t,e="fill"){if(null==t)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Hr(t)||(t=x(t));const n=t;let s=!0;try{s=function(F){if(!Ta(F))return F;let W=Rn(F);return rl(W),W=il(W),W}(n)}catch(F){console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(n,null,2)}\n        `)}const h=qt[`filter_${e}`],p=ai(s,h);let y=null;if("error"===p.result)throw new Error(p.value.map(F=>`${F.key}: ${F.message}`).join(", "));y=(F,W,te)=>p.value.evaluate(F,W,{},te);let T=null,R=null;if(s!==n){const F=ai(n,h);if("error"===F.result)throw new Error(F.value.map(W=>`${W.key}: ${W.message}`).join(", "));T=(W,te,re,_e,we)=>F.value.evaluate(W,te,{},re,void 0,void 0,_e,we),R=!Ae(F.value.expression)}return y=y,{filter:y,dynamicFilter:T||void 0,needGeometry:g(s),needFeature:!!R}}function il(t){if(!Array.isArray(t))return t;const e=function(n){if(c.has(n[0]))for(let s=1;s<n.length;s++)if(Ta(n[s]))return!0;return n}(t);return!0===e?e:e.map(n=>il(n))}function rl(t){let e=!1;const n=[];if("case"===t[0]){for(let s=1;s<t.length-1;s+=2)e=e||Ta(t[s]),n.push(t[s+1]);n.push(t[t.length-1])}else if("match"===t[0]){e=e||Ta(t[1]);for(let s=2;s<t.length-1;s+=2)n.push(t[s+1]);n.push(t[t.length-1])}else if("step"===t[0]){e=e||Ta(t[1]);for(let s=1;s<t.length-1;s+=2)n.push(t[s+1])}e&&(t.length=0,t.push("any",...n));for(let s=1;s<t.length;s++)rl(t[s])}function Ta(t){if(!Array.isArray(t))return!1;if("pitch"===(e=t[0])||"distance-from-center"===e)return!0;var e;for(let n=1;n<t.length;n++)if(Ta(t[n]))return!0;return!1}const c=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function v(t,e){return t<e?-1:t>e?1:0}function g(t){if(!Array.isArray(t))return!1;if("within"===t[0])return!0;for(let e=1;e<t.length;e++)if(g(t[e]))return!0;return!1}function x(t){if(!t)return!0;const e=t[0];return t.length<=1?"any"!==e:"=="===e?C(t[1],t[2],"=="):"!="===e?ye(C(t[1],t[2],"==")):"<"===e||">"===e||"<="===e||">="===e?C(t[1],t[2],e):"any"===e?(n=t.slice(1),["any"].concat(n.map(x))):"all"===e?["all"].concat(t.slice(1).map(x)):"none"===e?["all"].concat(t.slice(1).map(x).map(ye)):"in"===e?U(t[1],t.slice(2)):"!in"===e?ye(U(t[1],t.slice(2))):"has"===e?Q(t[1]):"!has"===e?ye(Q(t[1])):"within"!==e||t;var n}function C(t,e,n){switch(t){case"$type":return[`filter-type-${n}`,e];case"$id":return[`filter-id-${n}`,e];default:return[`filter-${n}`,t,e]}}function U(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(n=>typeof n!=typeof e[0])?["filter-in-large",t,["literal",e.sort(v)]]:["filter-in-small",t,["literal",e]]}}function Q(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function ye(t){return["!",t]}function Pe(t){return Hr(Rn(t.value))?Jn(Gr({},t,{expressionContext:"filter",valueSpec:t.styleSpec[`filter_${t.layerType||"fill"}`]})):Ze(t)}function Ze(t){const e=t.value,n=t.key;if("array"!==Cr(e))return[new q(n,e,`array expected, ${Cr(e)} found`)];const s=t.styleSpec;let h,p=[];if(e.length<1)return[new q(n,e,"filter array must have at least 1 element")];switch(p=p.concat(Ts({key:`${n}[0]`,value:e[0],valueSpec:s.filter_operator,style:t.style,styleSpec:t.styleSpec})),gr(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&"$type"===gr(e[1])&&p.push(new q(n,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":3!==e.length&&p.push(new q(n,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(h=Cr(e[1]),"string"!==h&&p.push(new q(`${n}[1]`,e[1],`string expected, ${h} found`)));for(let y=2;y<e.length;y++)h=Cr(e[y]),"$type"===gr(e[1])?p=p.concat(Ts({key:`${n}[${y}]`,value:e[y],valueSpec:s.geometry_type,style:t.style,styleSpec:t.styleSpec})):"string"!==h&&"number"!==h&&"boolean"!==h&&p.push(new q(`${n}[${y}]`,e[y],`string, number, or boolean expected, ${h} found`));break;case"any":case"all":case"none":for(let y=1;y<e.length;y++)p=p.concat(Ze({key:`${n}[${y}]`,value:e[y],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":h=Cr(e[1]),2!==e.length?p.push(new q(n,e,`filter array for "${e[0]}" operator must have 2 elements`)):"string"!==h&&p.push(new q(`${n}[1]`,e[1],`string expected, ${h} found`));break;case"within":h=Cr(e[1]),2!==e.length?p.push(new q(n,e,`filter array for "${e[0]}" operator must have 2 elements`)):"object"!==h&&p.push(new q(`${n}[1]`,e[1],`object expected, ${h} found`))}return p}function zt(t,e){const n=t.key,s=t.style,h=t.styleSpec,p=t.value,y=t.objectKey,T=h[`${e}_${t.layerType}`];if(!T)return[];const R=y.match(/^(.*)-transition$/);if("paint"===e&&R&&T[R[1]]&&T[R[1]].transition)return Gs({key:n,value:p,valueSpec:h.transition,style:s,styleSpec:h});const F=t.valueSpec||T[y];if(!F)return[new q(n,p,`unknown property "${y}"`)];let W;if("string"===Cr(p)&&bo(F)&&!F.tokens&&(W=/^{([^}]+)}$/.exec(p)))return[new q(n,p,`"${y}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(W[1])} }\`.`)];const te=[];return"symbol"===t.layerType&&("text-field"===y&&s&&!s.glyphs&&te.push(new q(n,p,'use of "text-field" requires a style "glyphs" property')),"text-font"===y&&ja(Rn(p))&&"identity"===gr(p.type)&&te.push(new q(n,p,'"text-font" does not support identity functions'))),te.concat(Gs({key:t.key,value:p,valueSpec:F,style:s,styleSpec:h,expressionContext:"property",propertyType:e,propertyKey:y}))}function qn(t){return zt(t,"paint")}function Pi(t){return zt(t,"layout")}function Vi(t){let e=[];const n=t.value,s=t.key,h=t.style,p=t.styleSpec;n.type||n.ref||e.push(new q(s,n,'either "type" or "ref" is required'));let y=gr(n.type);const T=gr(n.ref);if(n.id){const R=gr(n.id);for(let F=0;F<t.arrayIndex;F++){const W=h.layers[F];gr(W.id)===R&&e.push(new q(s,n.id,`duplicate layer id "${n.id}", previously used at line ${W.id.__line__}`))}}if("ref"in n){let R;["type","source","source-layer","filter","layout"].forEach(F=>{F in n&&e.push(new q(s,n[F],`"${F}" is prohibited for ref layers`))}),h.layers.forEach(F=>{gr(F.id)===T&&(R=F)}),R?R.ref?e.push(new q(s,n.ref,"ref cannot reference another ref layer")):y=gr(R.type):"string"==typeof T&&e.push(new q(s,n.ref,`ref layer "${T}" not found`))}else if("background"!==y&&"sky"!==y)if(n.source){const R=h.sources&&h.sources[n.source],F=R&&gr(R.type);R?"vector"===F&&"raster"===y?e.push(new q(s,n.source,`layer "${n.id}" requires a raster source`)):"raster"===F&&"raster"!==y?e.push(new q(s,n.source,`layer "${n.id}" requires a vector source`)):"vector"!==F||n["source-layer"]?"raster-dem"===F&&"hillshade"!==y?e.push(new q(s,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==y||!n.paint||!n.paint["line-gradient"]&&!n.paint["line-trim-offset"]||"geojson"===F&&R.lineMetrics||e.push(new q(s,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new q(s,n,`layer "${n.id}" must specify a "source-layer"`)):e.push(new q(s,n.source,`source "${n.source}" not found`))}else e.push(new q(s,n,'missing required property "source"'));return e=e.concat(J({key:s,value:n,valueSpec:p.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Gs({key:`${s}.type`,value:n.type,valueSpec:p.layer.type,style:t.style,styleSpec:t.styleSpec,object:n,objectKey:"type"}),filter:R=>Pe(Gr({layerType:y},R)),layout:R=>J({layer:n,key:R.key,value:R.value,valueSpec:{},style:R.style,styleSpec:R.styleSpec,objectElementValidators:{"*":F=>Pi(Gr({layerType:y},F))}}),paint:R=>J({layer:n,key:R.key,value:R.value,valueSpec:{},style:R.style,styleSpec:R.styleSpec,objectElementValidators:{"*":F=>qn(Gr({layerType:y},F))}})}})),e}function ro(t){const e=t.value,n=t.key,s=Cr(e);return"string"!==s?[new q(n,e,`string expected, ${s} found`)]:[]}const co={promoteId:function({key:t,value:e}){if("string"===Cr(e))return ro({key:t,value:e});{const n=[];for(const s in e)n.push(...ro({key:`${t}.${s}`,value:e[s]}));return n}}};function Zs(t){const e=t.value,n=t.key,s=t.styleSpec,h=t.style;if(!e.type)return[new q(n,e,'"type" is required')];const p=gr(e.type);let y;switch(p){case"vector":case"raster":case"raster-dem":return y=J({key:n,value:e,valueSpec:s[`source_${p.replace("-","_")}`],style:t.style,styleSpec:s,objectElementValidators:co}),y;case"geojson":if(y=J({key:n,value:e,valueSpec:s.source_geojson,style:h,styleSpec:s,objectElementValidators:co}),e.cluster)for(const T in e.clusterProperties){const[R,F]=e.clusterProperties[T],W="string"==typeof R?[R,["accumulated"],["get",T]]:R;y.push(...Jn({key:`${n}.${T}.map`,value:F,expressionContext:"cluster-map"})),y.push(...Jn({key:`${n}.${T}.reduce`,value:W,expressionContext:"cluster-reduce"}))}return y;case"video":return J({key:n,value:e,valueSpec:s.source_video,style:h,styleSpec:s});case"image":return J({key:n,value:e,valueSpec:s.source_image,style:h,styleSpec:s});case"canvas":return[new q(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ts({key:`${n}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:h,styleSpec:s})}}function Tl(t){const e=t.value,n=t.styleSpec,s=n.light,h=t.style;let p=[];const y=Cr(e);if(void 0===e)return p;if("object"!==y)return p=p.concat([new q("light",e,`object expected, ${y} found`)]),p;for(const T in e){const R=T.match(/^(.*)-transition$/);p=p.concat(R&&s[R[1]]&&s[R[1]].transition?Gs({key:T,value:e[T],valueSpec:n.transition,style:h,styleSpec:n}):s[T]?Gs({key:T,value:e[T],valueSpec:s[T],style:h,styleSpec:n}):[new q(T,e[T],`unknown property "${T}"`)])}return p}function kl(t){const e=t.value,n=t.key,s=t.style,h=t.styleSpec,p=h.terrain;let y=[];const T=Cr(e);if(void 0===e)return y;if("object"!==T)return y=y.concat([new q("terrain",e,`object expected, ${T} found`)]),y;for(const R in e){const F=R.match(/^(.*)-transition$/);y=y.concat(F&&p[F[1]]&&p[F[1]].transition?Gs({key:R,value:e[R],valueSpec:h.transition,style:s,styleSpec:h}):p[R]?Gs({key:R,value:e[R],valueSpec:p[R],style:s,styleSpec:h}):[new q(R,e[R],`unknown property "${R}"`)])}if(e.source){const R=s.sources&&s.sources[e.source],F=R&&gr(R.type);R?"raster-dem"!==F&&y.push(new q(n,e.source,`terrain cannot be used with a source of type ${String(F)}, it only be used with a "raster-dem" source type`)):y.push(new q(n,e.source,`source "${e.source}" not found`))}else y.push(new q(n,e,'terrain is missing required property "source"'));return y}function dl(t){const e=t.value,n=t.style,s=t.styleSpec,h=s.fog;let p=[];const y=Cr(e);if(void 0===e)return p;if("object"!==y)return p=p.concat([new q("fog",e,`object expected, ${y} found`)]),p;for(const T in e){const R=T.match(/^(.*)-transition$/);p=p.concat(R&&h[R[1]]&&h[R[1]].transition?Gs({key:T,value:e[T],valueSpec:s.transition,style:n,styleSpec:s}):h[T]?Gs({key:T,value:e[T],valueSpec:h[T],style:n,styleSpec:s}):[new q(T,e[T],`unknown property "${T}"`)])}return p}const El={"*":()=>[],array:Ie,boolean:function(t){const e=t.value,n=t.key,s=Cr(e);return"boolean"!==s?[new q(n,e,`boolean expected, ${s} found`)]:[]},number:ut,color:function(t){const e=t.key,n=t.value,s=Cr(n);return"string"!==s?[new q(e,n,`color expected, ${s} found`)]:null===po.parseCSSColor(n)?[new q(e,n,`color expected, "${n}" found`)]:[]},enum:Ts,filter:Pe,function:pn,layer:Vi,object:J,source:Zs,light:Tl,terrain:kl,fog:dl,string:ro,formatted:function(t){return 0===ro(t).length?[]:Jn(t)},resolvedImage:function(t){return 0===ro(t).length?[]:Jn(t)},projection:function(t){const e=t.value,n=t.styleSpec,s=n.projection,h=t.style;let p=[];const y=Cr(e);if("object"===y)for(const T in e)p=p.concat(Gs({key:T,value:e[T],valueSpec:s[T],style:h,styleSpec:n}));else"string"!==y&&(p=p.concat([new q("projection",e,`object or string expected, ${y} found`)]));return p}};function Gs(t){const e=t.value,n=t.valueSpec,s=t.styleSpec;return n.expression&&ja(gr(e))?pn(t):n.expression&&Vn(Rn(e))?Jn(t):n.type&&El[n.type]?El[n.type](t):J(Gr({},t,{valueSpec:n.type?s[n.type]:n}))}function lu(t){const e=t.value,n=t.key,s=ro(t);return s.length||(-1===e.indexOf("{fontstack}")&&s.push(new q(n,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&s.push(new q(n,e,'"glyphs" url must include a "{range}" token'))),s}function Cl(t,e=qt){return ol(Gs({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:lu,"*":()=>[]}}))}const Ls=t=>ol(qn(t)),uc=t=>ol(Pi(t));function ol(t){return t.slice().sort((e,n)=>e.line&&n.line?e.line-n.line:0)}function Ea(t,e){let n=!1;if(e&&e.length)for(const s of e)t.fire(new mi(new Error(s.message))),n=!0;return n}var sl=Fs;function Fs(t,e,n){var s=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var h=new Int32Array(this.arrayBuffer);t=h[0],this.d=(e=h[1])+2*(n=h[2]);for(var p=0;p<this.d*this.d;p++){var y=h[3+p],T=h[3+p+1];s.push(y===T?null:h.subarray(y,T))}var R=h[3+s.length+1];this.keys=h.subarray(h[3+s.length],R),this.bboxes=h.subarray(R),this.insert=this._insertReadonly}else{this.d=e+2*n;for(var F=0;F<this.d*this.d;F++)s.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=n,this.scale=e/t,this.uid=0;var W=n/e*t;this.min=-W,this.max=t+W}Fs.prototype.insert=function(t,e,n,s,h){this._forEachCell(e,n,s,h,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(s),this.bboxes.push(h)},Fs.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Fs.prototype._insertCell=function(t,e,n,s,h,p){this.cells[h].push(p)},Fs.prototype.query=function(t,e,n,s,h){var p=this.min,y=this.max;if(t<=p&&e<=p&&y<=n&&y<=s&&!h)return Array.prototype.slice.call(this.keys);var T=[];return this._forEachCell(t,e,n,s,this._queryCell,T,{},h),T},Fs.prototype._queryCell=function(t,e,n,s,h,p,y,T){var R=this.cells[h];if(null!==R)for(var F=this.keys,W=this.bboxes,te=0;te<R.length;te++){var re=R[te];if(void 0===y[re]){var _e=4*re;(T?T(W[_e+0],W[_e+1],W[_e+2],W[_e+3]):t<=W[_e+2]&&e<=W[_e+3]&&n>=W[_e+0]&&s>=W[_e+1])?(y[re]=!0,p.push(F[re])):y[re]=!1}}},Fs.prototype._forEachCell=function(t,e,n,s,h,p,y,T){for(var R=this._convertToCellCoord(t),F=this._convertToCellCoord(e),W=this._convertToCellCoord(n),te=this._convertToCellCoord(s),re=R;re<=W;re++)for(var _e=F;_e<=te;_e++){var we=this.d*_e+re;if((!T||T(this._convertFromCellCoord(re),this._convertFromCellCoord(_e),this._convertFromCellCoord(re+1),this._convertFromCellCoord(_e+1)))&&h.call(this,t,e,n,s,we,p,y,T))return}},Fs.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},Fs.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},Fs.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=3+this.cells.length+1+1,n=0,s=0;s<this.cells.length;s++)n+=this.cells[s].length;var h=new Int32Array(e+n+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;for(var p=e,y=0;y<t.length;y++){var T=t[y];h[3+y]=p,h.set(T,p),p+=T.length}return h[3+t.length]=p,h.set(this.keys,p),h[3+t.length+1]=p+=this.keys.length,h.set(this.bboxes,p),p+=this.bboxes.length,h.buffer};const Nl={};function Oi(t,e,n={}){Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),Nl[e]={klass:t,omit:n.omit||[]}}Oi(Object,"Object"),sl.serialize=function(t,e){const n=t.toArrayBuffer();return e&&e.push(n),{buffer:n}},sl.deserialize=function(t){return new sl(t.buffer)},Object.defineProperty(sl,"name",{value:"Grid"}),Oi(sl,"Grid"),Oi(zr,"Color"),Oi(Error,"Error"),Oi(Gt,"AJAXError"),Oi(Vo,"ResolvedImage"),Oi(cr,"StylePropertyFunction"),Oi(Bn,"StyleExpression",{omit:["_evaluator"]}),Oi(pr,"ZoomDependentExpression"),Oi(Ii,"ZoomConstantExpression"),Oi(Mo,"CompoundExpression",{omit:["_evaluate"]});for(const t in Ba)Nl[Ba[t]._classRegistryKey]||Oi(Ba[t],`Expression${t}`);function yc(t){return t&&"undefined"!=typeof ArrayBuffer&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function gh(t){return oe.ImageBitmap&&t instanceof oe.ImageBitmap}function Ic(t,e){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(yc(t)||gh(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){const n=t;return e&&e.push(n.buffer),n}if(t instanceof oe.ImageData)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){const n=[];for(const s of t)n.push(Ic(s,e));return n}if("object"==typeof t){const n=t.constructor,s=n._classRegistryKey;if(!s)throw new Error(`can't serialize object of unregistered class ${s}`);const h=n.serialize?n.serialize(t,e):{};if(!n.serialize){for(const p in t)t.hasOwnProperty(p)&&(Nl[s].omit.indexOf(p)>=0||(h[p]=Ic(t[p],e)));t instanceof Error&&(h.message=t.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==s&&(h.$name=s),h}throw new Error("can't serialize object of type "+typeof t)}function Rs(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||yc(t)||gh(t)||ArrayBuffer.isView(t)||t instanceof oe.ImageData)return t;if(Array.isArray(t))return t.map(Rs);if("object"==typeof t){const e=t.$name||"Object",{klass:n}=Nl[e];if(!n)throw new Error(`can't deserialize unregistered class ${e}`);if(n.deserialize)return n.deserialize(t);const s=Object.create(n.prototype);for(const h of Object.keys(t))"$name"!==h&&(s[h]=Rs(t[h]));return s}throw new Error("can't deserialize object of type "+typeof t)}class Yu{constructor(){this.first=!0}update(e,n){const s=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=s,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=s,!0):(this.lastFloorZoom>s?(this.lastIntegerZoom=s+1,this.lastIntegerZoomTime=n):this.lastFloorZoom<s&&(this.lastIntegerZoom=s,this.lastIntegerZoomTime=n),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=s,!0))}}const hc=t=>t>=1536&&t<=1791,_h=t=>t>=1872&&t<=1919,Du=t=>t>=2208&&t<=2303,Jh=t=>t>=11904&&t<=12031,Qh=t=>t>=12032&&t<=12255,cu=t=>t>=12272&&t<=12287,Ga=t=>t>=12288&&t<=12351,vc=t=>t>=12352&&t<=12447,Hs=t=>t>=12448&&t<=12543,Ys=t=>t>=12544&&t<=12591,ec=t=>t>=12704&&t<=12735,Ku=t=>t>=12736&&t<=12783,Xu=t=>t>=12784&&t<=12799,Dl=t=>t>=12800&&t<=13055,Zl=t=>t>=13056&&t<=13311,Gl=t=>t>=13312&&t<=19903,Ll=t=>t>=19968&&t<=40959,tc=t=>t>=40960&&t<=42127,Su=t=>t>=42128&&t<=42191,na=t=>t>=44032&&t<=55215,yh=t=>t>=63744&&t<=64255,Au=t=>t>=64336&&t<=65023,ed=t=>t>=65040&&t<=65055,Mu=t=>t>=65072&&t<=65103,fl=t=>t>=65104&&t<=65135,uu=t=>t>=65136&&t<=65279,bc=t=>t>=65280&&t<=65519;function Iu(t){for(const e of t)if(Pu(e.charCodeAt(0)))return!0;return!1}function vh(t){for(const e of t)if(!td(e.charCodeAt(0)))return!1;return!0}function td(t){return!(hc(t)||_h(t)||Du(t)||Au(t)||uu(t))}function Pu(t){return!(746!==t&&747!==t&&(t<4352||!(ec(t)||Ys(t)||Mu(t)&&!(t>=65097&&t<=65103)||yh(t)||Zl(t)||Jh(t)||Ku(t)||!(!Ga(t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||Gl(t)||Ll(t)||Dl(t)||(e=t,e>=12592&&e<=12687)||(e=>e>=43360&&e<=43391)(t)||(e=>e>=55216&&e<=55295)(t)||(e=>e>=4352&&e<=4607)(t)||na(t)||vc(t)||cu(t)||(e=>e>=12688&&e<=12703)(t)||Qh(t)||Xu(t)||Hs(t)&&12540!==t||!(!bc(t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!fl(t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||(e=>e>=5120&&e<=5759)(t)||(e=>e>=6320&&e<=6399)(t)||ed(t)||(e=>e>=19904&&e<=19967)(t)||tc(t)||Su(t))));var e}function hu(t){return!(Pu(t)||(e=t,(n=e)>=128&&n<=255&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||(n=>n>=8192&&n<=8303)(e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||(n=>n>=8448&&n<=8527)(e)||(n=>n>=8528&&n<=8591)(e)||(n=>n>=8960&&n<=9215)(e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||9003===e||e>=9085&&e<=9114||e>=9150&&e<=9165||9167===e||e>=9169&&e<=9179||e>=9186&&e<=9215)||(n=>n>=9216&&n<=9279)(e)&&9251!==e||(n=>n>=9280&&n<=9311)(e)||(n=>n>=9312&&n<=9471)(e)||(n=>n>=9632&&n<=9727)(e)||(n=>n>=9728&&n<=9983)(e)&&!(e>=9754&&e<=9759)||(n=>n>=11008&&n<=11263)(e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Ga(e)||Hs(e)||(n=>n>=57344&&n<=63743)(e)||Mu(e)||fl(e)||bc(e)||8734===e||8756===e||8757===e||e>=9984&&e<=10087||e>=10102&&e<=10131||65532===e||65533===e));var e,n}function d(t){return t>=1424&&t<=2303||Au(t)||uu(t)}function i(t,e){return!(!e&&d(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||(n=t,n>=6016&&n<=6143));var n}function u(t){for(const e of t)if(d(e.charCodeAt(0)))return!0;return!1}const m="deferred",E="loading",M="loaded";let z=null,Z="unavailable",K=null;const de=function(t){t&&"string"==typeof t&&t.indexOf("NetworkError")>-1&&(Z="error"),z&&z(t)};function pe(){De.fire(new Pn("pluginStateChange",{pluginStatus:Z,pluginURL:K}))}const De=new Xn,Fe=function(){return Z},Je=function(){if(Z!==m||!K)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Z=E,pe(),K&&Kt({url:K},t=>{t?de(t):(Z=M,pe())})},Ge={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Z===M||null!=Ge.applyArabicShaping,isLoading:()=>Z===E,setState(t){Z=t.pluginStatus,K=t.pluginURL},isParsed:()=>null!=Ge.applyArabicShaping&&null!=Ge.processBidirectionalText&&null!=Ge.processStyledBidirectionalText,getPluginURL:()=>K};class He{constructor(e,n){this.zoom=e,n?(this.now=n.now,this.fadeDuration=n.fadeDuration,this.zoomHistory=n.zoomHistory,this.transition=n.transition,this.pitch=n.pitch):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Yu,this.transition={},this.pitch=0)}isSupportedScript(e){return function(n,s){for(const h of n)if(!i(h.charCodeAt(0),s))return!1;return!0}(e,Ge.isLoaded())}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,n=e-Math.floor(e),s=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:n+(1-n)*s}:{fromScale:.5,toScale:1,t:1-(1-s)*n}}}class $e{constructor(e,n){this.property=e,this.value=n,this.expression=function(s,h){if(ja(s))return new cr(s,h);if(Vn(s)){const p=Ni(s,h);if("error"===p.result)throw new Error(p.value.map(y=>`${y.key}: ${y.message}`).join(", "));return p.value}{let p=s;return"string"==typeof s&&"color"===h.type&&(p=zr.parse(s)),{kind:"constant",evaluate:()=>p}}}(void 0===n?e.specification.default:n,e.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(e,n,s){return this.property.possiblyEvaluate(this,e,n,s)}}class ze{constructor(e){this.property=e,this.value=new $e(e,void 0)}transitioned(e,n){return new et(this.property,this.value,n,se({},e.transition,this.transition),e.now)}untransitioned(){return new et(this.property,this.value,null,{},0)}}class tt{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return An(this._values[e].value.value)}setValue(e,n){this._values.hasOwnProperty(e)||(this._values[e]=new ze(this._values[e].property)),this._values[e].value=new $e(this._values[e].property,null===n?void 0:An(n))}getTransition(e){return An(this._values[e].transition)}setTransition(e,n){this._values.hasOwnProperty(e)||(this._values[e]=new ze(this._values[e].property)),this._values[e].transition=An(n)||void 0}serialize(){const e={};for(const n of Object.keys(this._values)){const s=this.getValue(n);void 0!==s&&(e[n]=s);const h=this.getTransition(n);void 0!==h&&(e[`${n}-transition`]=h)}return e}transitioned(e,n){const s=new Mt(this._properties);for(const h of Object.keys(this._values))s._values[h]=this._values[h].transitioned(e,n._values[h]);return s}untransitioned(){const e=new Mt(this._properties);for(const n of Object.keys(this._values))e._values[n]=this._values[n].untransitioned();return e}}class et{constructor(e,n,s,h,p){const y=h.delay||0,T=h.duration||0;p=p||0,this.property=e,this.value=n,this.begin=p+y,this.end=this.begin+T,e.specification.transition&&(h.delay||h.duration)&&(this.prior=s)}possiblyEvaluate(e,n,s){const h=e.now||0,p=this.value.possiblyEvaluate(e,n,s),y=this.prior;if(y){if(h>this.end)return this.prior=null,p;if(this.value.isDataDriven())return this.prior=null,p;if(h<this.begin)return y.possiblyEvaluate(e,n,s);{const T=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(y.possiblyEvaluate(e,n,s),p,at(T))}}return p}}class Mt{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,n,s){const h=new It(this._properties);for(const p of Object.keys(this._values))h._values[p]=this._values[p].possiblyEvaluate(e,n,s);return h}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Et{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return An(this._values[e].value)}setValue(e,n){this._values[e]=new $e(this._values[e].property,null===n?void 0:An(n))}serialize(){const e={};for(const n of Object.keys(this._values)){const s=this.getValue(n);void 0!==s&&(e[n]=s)}return e}possiblyEvaluate(e,n,s){const h=new It(this._properties);for(const p of Object.keys(this._values))h._values[p]=this._values[p].possiblyEvaluate(e,n,s);return h}}class yt{constructor(e,n,s){this.property=e,this.value=n,this.parameters=s}isConstant(){return"constant"===this.value.kind}constantOr(e){return"constant"===this.value.kind?this.value.value:e}evaluate(e,n,s,h){return this.property.evaluate(this.value,this.parameters,e,n,s,h)}}class It{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class Ct{constructor(e){this.specification=e}possiblyEvaluate(e,n){return e.expression.evaluate(n)}interpolate(e,n,s){const h=ji[this.specification.type];return h?h(e,n,s):e}}class Vt{constructor(e,n){this.specification=e,this.overrides=n}possiblyEvaluate(e,n,s,h){return new yt(this,"constant"===e.expression.kind||"camera"===e.expression.kind?{kind:"constant",value:e.expression.evaluate(n,null,{},s,h)}:e.expression,n)}interpolate(e,n,s){if("constant"!==e.value.kind||"constant"!==n.value.kind)return e;if(void 0===e.value.value||void 0===n.value.value)return new yt(this,{kind:"constant",value:void 0},e.parameters);const h=ji[this.specification.type];return h?new yt(this,{kind:"constant",value:h(e.value.value,n.value.value,s)},e.parameters):e}evaluate(e,n,s,h,p,y){return"constant"===e.kind?e.value:e.evaluate(n,s,h,p,y)}}class sn extends Vt{possiblyEvaluate(e,n,s,h){if(void 0===e.value)return new yt(this,{kind:"constant",value:void 0},n);if("constant"===e.expression.kind){const p=e.expression.evaluate(n,null,{},s,h),y="resolvedImage"===e.property.specification.type&&"string"!=typeof p?p.name:p,T=this._calculate(y,y,y,n);return new yt(this,{kind:"constant",value:T},n)}if("camera"===e.expression.kind){const p=this._calculate(e.expression.evaluate({zoom:n.zoom-1}),e.expression.evaluate({zoom:n.zoom}),e.expression.evaluate({zoom:n.zoom+1}),n);return new yt(this,{kind:"constant",value:p},n)}return new yt(this,e.expression,n)}evaluate(e,n,s,h,p,y){if("source"===e.kind){const T=e.evaluate(n,s,h,p,y);return this._calculate(T,T,T,n)}return"composite"===e.kind?this._calculate(e.evaluate({zoom:Math.floor(n.zoom)-1},s,h),e.evaluate({zoom:Math.floor(n.zoom)},s,h),e.evaluate({zoom:Math.floor(n.zoom)+1},s,h),n):e.value}_calculate(e,n,s,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:e,to:n,other:s}:{from:s,to:n,other:e}}interpolate(e){return e}}class ni{constructor(e){this.specification=e}possiblyEvaluate(e,n,s,h){if(void 0!==e.value){if("constant"===e.expression.kind){const p=e.expression.evaluate(n,null,{},s,h);return this._calculate(p,p,p,n)}return this._calculate(e.expression.evaluate(new He(Math.floor(n.zoom-1),n)),e.expression.evaluate(new He(Math.floor(n.zoom),n)),e.expression.evaluate(new He(Math.floor(n.zoom+1),n)),n)}}_calculate(e,n,s,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:e,to:n}:{from:s,to:n}}interpolate(e){return e}}class Xt{constructor(e){this.specification=e}possiblyEvaluate(e,n,s,h){return!!e.expression.evaluate(n,null,{},s,h)}interpolate(){return!1}}class Ln{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const n=new He(0,{});for(const s in e){const h=e[s];h.specification.overridable&&this.overridableProperties.push(s);const p=this.defaultPropertyValues[s]=new $e(h,void 0),y=this.defaultTransitionablePropertyValues[s]=new ze(h);this.defaultTransitioningPropertyValues[s]=y.untransitioned(),this.defaultPossiblyEvaluatedValues[s]=p.possiblyEvaluate(n)}}}function zn(t,e){return 256*(t=kt(Math.floor(t),0,255))+kt(Math.floor(e),0,255)}Oi(Vt,"DataDrivenProperty"),Oi(Ct,"DataConstantProperty"),Oi(sn,"CrossFadedDataDrivenProperty"),Oi(ni,"CrossFadedProperty"),Oi(Xt,"ColorRampProperty");const di={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class _n{constructor(e,n){this._structArray=e,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class li{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,n){return e._trim(),n&&(e.isTransferred=!0,n.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const n=Object.create(this.prototype);return n.arrayBuffer=e.arrayBuffer,n.length=e.length,n.capacity=e.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Un(t,e=1){let n=0,s=0;return{members:t.map(h=>{const p=di[h.type].BYTES_PER_ELEMENT,y=n=Ai(n,Math.max(e,p)),T=h.components||1;return s=Math.max(s,p),n+=p*T,{name:h.name,type:h.type,components:T,offset:y}}),size:Ai(n,Math.max(s,e)),alignment:e}}function Ai(t,e){return Math.ceil(t/e)*e}class gi extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n){const s=this.length;return this.resize(s+1),this.emplace(s,e,n)}emplace(e,n,s){const h=2*e;return this.int16[h+0]=n,this.int16[h+1]=s,e}}gi.prototype.bytesPerElement=4,Oi(gi,"StructArrayLayout2i4");class $i extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,s){const h=this.length;return this.resize(h+1),this.emplace(h,e,n,s)}emplace(e,n,s,h){const p=3*e;return this.int16[p+0]=n,this.int16[p+1]=s,this.int16[p+2]=h,e}}$i.prototype.bytesPerElement=6,Oi($i,"StructArrayLayout3i6");class vr extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,s,h){const p=this.length;return this.resize(p+1),this.emplace(p,e,n,s,h)}emplace(e,n,s,h,p){const y=4*e;return this.int16[y+0]=n,this.int16[y+1]=s,this.int16[y+2]=h,this.int16[y+3]=p,e}}vr.prototype.bytesPerElement=8,Oi(vr,"StructArrayLayout4i8");class jr extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,s,h,p,y,T){const R=this.length;return this.resize(R+1),this.emplace(R,e,n,s,h,p,y,T)}emplace(e,n,s,h,p,y,T,R){const F=6*e,W=12*e,te=3*e;return this.int16[F+0]=n,this.int16[F+1]=s,this.uint8[W+4]=h,this.uint8[W+5]=p,this.uint8[W+6]=y,this.uint8[W+7]=T,this.float32[te+2]=R,e}}jr.prototype.bytesPerElement=12,Oi(jr,"StructArrayLayout2i4ub1f12");class mo extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,s,h){const p=this.length;return this.resize(p+1),this.emplace(p,e,n,s,h)}emplace(e,n,s,h,p){const y=4*e;return this.float32[y+0]=n,this.float32[y+1]=s,this.float32[y+2]=h,this.float32[y+3]=p,e}}mo.prototype.bytesPerElement=16,Oi(mo,"StructArrayLayout4f16");class tr extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,s,h,p,y,T,R,F,W){const te=this.length;return this.resize(te+1),this.emplace(te,e,n,s,h,p,y,T,R,F,W)}emplace(e,n,s,h,p,y,T,R,F,W,te){const re=10*e;return this.uint16[re+0]=n,this.uint16[re+1]=s,this.uint16[re+2]=h,this.uint16[re+3]=p,this.uint16[re+4]=y,this.uint16[re+5]=T,this.uint16[re+6]=R,this.uint16[re+7]=F,this.uint16[re+8]=W,this.uint16[re+9]=te,e}}tr.prototype.bytesPerElement=20,Oi(tr,"StructArrayLayout10ui20");class Kr extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,s,h,p,y,T,R){const F=this.length;return this.resize(F+1),this.emplace(F,e,n,s,h,p,y,T,R)}emplace(e,n,s,h,p,y,T,R,F){const W=8*e;return this.uint16[W+0]=n,this.uint16[W+1]=s,this.uint16[W+2]=h,this.uint16[W+3]=p,this.uint16[W+4]=y,this.uint16[W+5]=T,this.uint16[W+6]=R,this.uint16[W+7]=F,e}}Kr.prototype.bytesPerElement=16,Oi(Kr,"StructArrayLayout8ui16");class Ro extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,s,h,p,y){const T=this.length;return this.resize(T+1),this.emplace(T,e,n,s,h,p,y)}emplace(e,n,s,h,p,y,T){const R=6*e;return this.int16[R+0]=n,this.int16[R+1]=s,this.int16[R+2]=h,this.int16[R+3]=p,this.int16[R+4]=y,this.int16[R+5]=T,e}}Ro.prototype.bytesPerElement=12,Oi(Ro,"StructArrayLayout6i12");class Es extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,s,h,p,y,T,R,F,W,te,re){const _e=this.length;return this.resize(_e+1),this.emplace(_e,e,n,s,h,p,y,T,R,F,W,te,re)}emplace(e,n,s,h,p,y,T,R,F,W,te,re,_e){const we=12*e;return this.int16[we+0]=n,this.int16[we+1]=s,this.int16[we+2]=h,this.int16[we+3]=p,this.uint16[we+4]=y,this.uint16[we+5]=T,this.uint16[we+6]=R,this.uint16[we+7]=F,this.int16[we+8]=W,this.int16[we+9]=te,this.int16[we+10]=re,this.int16[we+11]=_e,e}}Es.prototype.bytesPerElement=24,Oi(Es,"StructArrayLayout4i4ui4i24");class Ks extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,s,h,p,y){const T=this.length;return this.resize(T+1),this.emplace(T,e,n,s,h,p,y)}emplace(e,n,s,h,p,y,T){const R=10*e,F=5*e;return this.int16[R+0]=n,this.int16[R+1]=s,this.int16[R+2]=h,this.float32[F+2]=p,this.float32[F+3]=y,this.float32[F+4]=T,e}}Ks.prototype.bytesPerElement=20,Oi(Ks,"StructArrayLayout3i3f20");class G extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint32[1*e+0]=n,e}}G.prototype.bytesPerElement=4,Oi(G,"StructArrayLayout1ul4");class P extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,s,h,p,y,T,R,F,W,te,re,_e){const we=this.length;return this.resize(we+1),this.emplace(we,e,n,s,h,p,y,T,R,F,W,te,re,_e)}emplace(e,n,s,h,p,y,T,R,F,W,te,re,_e,we){const Oe=20*e,Ve=10*e;return this.int16[Oe+0]=n,this.int16[Oe+1]=s,this.int16[Oe+2]=h,this.int16[Oe+3]=p,this.int16[Oe+4]=y,this.float32[Ve+3]=T,this.float32[Ve+4]=R,this.float32[Ve+5]=F,this.float32[Ve+6]=W,this.int16[Oe+14]=te,this.uint32[Ve+8]=re,this.uint16[Oe+18]=_e,this.uint16[Oe+19]=we,e}}P.prototype.bytesPerElement=40,Oi(P,"StructArrayLayout5i4f1i1ul2ui40");class S extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,s,h,p,y,T){const R=this.length;return this.resize(R+1),this.emplace(R,e,n,s,h,p,y,T)}emplace(e,n,s,h,p,y,T,R){const F=8*e;return this.int16[F+0]=n,this.int16[F+1]=s,this.int16[F+2]=h,this.int16[F+4]=p,this.int16[F+5]=y,this.int16[F+6]=T,this.int16[F+7]=R,e}}S.prototype.bytesPerElement=16,Oi(S,"StructArrayLayout3i2i2i16");class H extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,s,h,p){const y=this.length;return this.resize(y+1),this.emplace(y,e,n,s,h,p)}emplace(e,n,s,h,p,y){const T=4*e,R=8*e;return this.float32[T+0]=n,this.float32[T+1]=s,this.float32[T+2]=h,this.int16[R+6]=p,this.int16[R+7]=y,e}}H.prototype.bytesPerElement=16,Oi(H,"StructArrayLayout2f1f2i16");class me extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,s,h){const p=this.length;return this.resize(p+1),this.emplace(p,e,n,s,h)}emplace(e,n,s,h,p){const y=12*e,T=3*e;return this.uint8[y+0]=n,this.uint8[y+1]=s,this.float32[T+1]=h,this.float32[T+2]=p,e}}me.prototype.bytesPerElement=12,Oi(me,"StructArrayLayout2ub2f12");class Ne extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,s){const h=this.length;return this.resize(h+1),this.emplace(h,e,n,s)}emplace(e,n,s,h){const p=3*e;return this.float32[p+0]=n,this.float32[p+1]=s,this.float32[p+2]=h,e}}Ne.prototype.bytesPerElement=12,Oi(Ne,"StructArrayLayout3f12");class Qe extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,s){const h=this.length;return this.resize(h+1),this.emplace(h,e,n,s)}emplace(e,n,s,h){const p=3*e;return this.uint16[p+0]=n,this.uint16[p+1]=s,this.uint16[p+2]=h,e}}Qe.prototype.bytesPerElement=6,Oi(Qe,"StructArrayLayout3ui6");class pt extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,n,s,h,p,y,T,R,F,W,te,re,_e,we,Oe,Ve,it,bt,rt,vt,Lt){const St=this.length;return this.resize(St+1),this.emplace(St,e,n,s,h,p,y,T,R,F,W,te,re,_e,we,Oe,Ve,it,bt,rt,vt,Lt)}emplace(e,n,s,h,p,y,T,R,F,W,te,re,_e,we,Oe,Ve,it,bt,rt,vt,Lt,St){const fn=30*e,hn=15*e,bn=60*e;return this.int16[fn+0]=n,this.int16[fn+1]=s,this.int16[fn+2]=h,this.float32[hn+2]=p,this.float32[hn+3]=y,this.uint16[fn+8]=T,this.uint16[fn+9]=R,this.uint32[hn+5]=F,this.uint32[hn+6]=W,this.uint32[hn+7]=te,this.uint16[fn+16]=re,this.uint16[fn+17]=_e,this.uint16[fn+18]=we,this.float32[hn+10]=Oe,this.float32[hn+11]=Ve,this.uint8[bn+48]=it,this.uint8[bn+49]=bt,this.uint8[bn+50]=rt,this.uint32[hn+13]=vt,this.int16[fn+28]=Lt,this.uint8[bn+58]=St,e}}pt.prototype.bytesPerElement=60,Oi(pt,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Qt extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,n,s,h,p,y,T,R,F,W,te,re,_e,we,Oe,Ve,it,bt,rt,vt,Lt,St,fn,hn,bn,hi,Tn,Zn,Yn,Gn){const ci=this.length;return this.resize(ci+1),this.emplace(ci,e,n,s,h,p,y,T,R,F,W,te,re,_e,we,Oe,Ve,it,bt,rt,vt,Lt,St,fn,hn,bn,hi,Tn,Zn,Yn,Gn)}emplace(e,n,s,h,p,y,T,R,F,W,te,re,_e,we,Oe,Ve,it,bt,rt,vt,Lt,St,fn,hn,bn,hi,Tn,Zn,Yn,Gn,ci){const Kn=38*e,Di=19*e;return this.int16[Kn+0]=n,this.int16[Kn+1]=s,this.int16[Kn+2]=h,this.float32[Di+2]=p,this.float32[Di+3]=y,this.int16[Kn+8]=T,this.int16[Kn+9]=R,this.int16[Kn+10]=F,this.int16[Kn+11]=W,this.int16[Kn+12]=te,this.int16[Kn+13]=re,this.uint16[Kn+14]=_e,this.uint16[Kn+15]=we,this.uint16[Kn+16]=Oe,this.uint16[Kn+17]=Ve,this.uint16[Kn+18]=it,this.uint16[Kn+19]=bt,this.uint16[Kn+20]=rt,this.uint16[Kn+21]=vt,this.uint16[Kn+22]=Lt,this.uint16[Kn+23]=St,this.uint16[Kn+24]=fn,this.uint16[Kn+25]=hn,this.uint16[Kn+26]=bn,this.uint16[Kn+27]=hi,this.uint16[Kn+28]=Tn,this.uint32[Di+15]=Zn,this.float32[Di+16]=Yn,this.float32[Di+17]=Gn,this.float32[Di+18]=ci,e}}Qt.prototype.bytesPerElement=76,Oi(Qt,"StructArrayLayout3i2f6i15ui1ul3f76");class mn extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.float32[1*e+0]=n,e}}mn.prototype.bytesPerElement=4,Oi(mn,"StructArrayLayout1f4");class Ri extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,s,h,p){const y=this.length;return this.resize(y+1),this.emplace(y,e,n,s,h,p)}emplace(e,n,s,h,p,y){const T=5*e;return this.float32[T+0]=n,this.float32[T+1]=s,this.float32[T+2]=h,this.float32[T+3]=p,this.float32[T+4]=y,e}}Ri.prototype.bytesPerElement=20,Oi(Ri,"StructArrayLayout5f20");class ar extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,s,h){const p=this.length;return this.resize(p+1),this.emplace(p,e,n,s,h)}emplace(e,n,s,h,p){const y=6*e;return this.uint32[3*e+0]=n,this.uint16[y+2]=s,this.uint16[y+3]=h,this.uint16[y+4]=p,e}}ar.prototype.bytesPerElement=12,Oi(ar,"StructArrayLayout1ul3ui12");class Pr extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n){const s=this.length;return this.resize(s+1),this.emplace(s,e,n)}emplace(e,n,s){const h=2*e;return this.uint16[h+0]=n,this.uint16[h+1]=s,e}}Pr.prototype.bytesPerElement=4,Oi(Pr,"StructArrayLayout2ui4");class oo extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint16[1*e+0]=n,e}}oo.prototype.bytesPerElement=2,Oi(oo,"StructArrayLayout1ui2");class kr extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n){const s=this.length;return this.resize(s+1),this.emplace(s,e,n)}emplace(e,n,s){const h=2*e;return this.float32[h+0]=n,this.float32[h+1]=s,e}}kr.prototype.bytesPerElement=8,Oi(kr,"StructArrayLayout2f8");class Or extends _n{get a_pos_30(){return this._structArray.int16[this._pos2+0]}get a_pos_31(){return this._structArray.int16[this._pos2+1]}get a_pos_32(){return this._structArray.int16[this._pos2+2]}get a_pos_normal_30(){return this._structArray.int16[this._pos2+3]}get a_pos_normal_31(){return this._structArray.int16[this._pos2+4]}get a_pos_normal_32(){return this._structArray.int16[this._pos2+5]}}Or.prototype.size=12;class _r extends Ro{get(e){return new Or(this,e)}}Oi(_r,"FillExtrusionExtArray");class Lo extends _n{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Lo.prototype.size=40;class qo extends P{get(e){return new Lo(this,e)}}Oi(qo,"CollisionBoxArray");class ia extends _n{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}ia.prototype.size=60;class Ja extends pt{get(e){return new ia(this,e)}}Oi(Ja,"PlacedSymbolArray");class Yc extends _n{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Yc.prototype.size=76;class Hl extends Qt{get(e){return new Yc(this,e)}}Oi(Hl,"SymbolInstanceArray");class Sl extends mn{getoffsetX(e){return this.float32[1*e+0]}}Oi(Sl,"GlyphOffsetArray");class Fl extends $i{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}Oi(Fl,"SymbolLineVertexArray");class Bl extends _n{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Bl.prototype.size=12;class nc extends ar{get(e){return new Bl(this,e)}}Oi(nc,"FeatureIndexArray");class bh extends _n{get a_centroid_pos0(){return this._structArray.uint16[this._pos2+0]}get a_centroid_pos1(){return this._structArray.uint16[this._pos2+1]}}bh.prototype.size=4;class du extends Pr{get(e){return new bh(this,e)}}Oi(du,"FillExtrusionCentroidArray");class Pc extends _n{get a_pos_30(){return this._structArray.int16[this._pos2+0]}get a_pos_31(){return this._structArray.int16[this._pos2+1]}get a_pos_32(){return this._structArray.int16[this._pos2+2]}get a_pos_normal_30(){return this._structArray.int16[this._pos2+3]}get a_pos_normal_31(){return this._structArray.int16[this._pos2+4]}get a_pos_normal_32(){return this._structArray.int16[this._pos2+5]}}Pc.prototype.size=12;class nd extends Ro{get(e){return new Pc(this,e)}}Oi(nd,"CircleGlobeExtArray");const Kc=Un([{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"}]),rr=Un([{name:"a_dash_to",components:4,type:"Uint16"},{name:"a_dash_from",components:4,type:"Uint16"}]);var Rr=ca(function(t){t.exports=function(e,n){var s,h,p,y,T,R,F,W;for(h=e.length-(s=3&e.length),p=n,T=3432918353,R=461845907,W=0;W<h;)F=255&e.charCodeAt(W)|(255&e.charCodeAt(++W))<<8|(255&e.charCodeAt(++W))<<16|(255&e.charCodeAt(++W))<<24,++W,p=27492+(65535&(y=5*(65535&(p=(p^=F=(65535&(F=(F=(65535&F)*T+(((F>>>16)*T&65535)<<16)&4294967295)<<15|F>>>17))*R+(((F>>>16)*R&65535)<<16)&4294967295)<<13|p>>>19))+((5*(p>>>16)&65535)<<16)&4294967295))+((58964+(y>>>16)&65535)<<16);switch(F=0,s){case 3:F^=(255&e.charCodeAt(W+2))<<16;case 2:F^=(255&e.charCodeAt(W+1))<<8;case 1:p^=F=(65535&(F=(F=(65535&(F^=255&e.charCodeAt(W)))*T+(((F>>>16)*T&65535)<<16)&4294967295)<<15|F>>>17))*R+(((F>>>16)*R&65535)<<16)&4294967295}return p^=e.length,p=2246822507*(65535&(p^=p>>>16))+((2246822507*(p>>>16)&65535)<<16)&4294967295,p=3266489909*(65535&(p^=p>>>13))+((3266489909*(p>>>16)&65535)<<16)&4294967295,(p^=p>>>16)>>>0}}),Sr=ca(function(t){t.exports=function(e,n){for(var s,h=e.length,p=n^h,y=0;h>=4;)s=1540483477*(65535&(s=255&e.charCodeAt(y)|(255&e.charCodeAt(++y))<<8|(255&e.charCodeAt(++y))<<16|(255&e.charCodeAt(++y))<<24))+((1540483477*(s>>>16)&65535)<<16),p=1540483477*(65535&p)+((1540483477*(p>>>16)&65535)<<16)^(s=1540483477*(65535&(s^=s>>>24))+((1540483477*(s>>>16)&65535)<<16)),h-=4,++y;switch(h){case 3:p^=(255&e.charCodeAt(y+2))<<16;case 2:p^=(255&e.charCodeAt(y+1))<<8;case 1:p=1540483477*(65535&(p^=255&e.charCodeAt(y)))+((1540483477*(p>>>16)&65535)<<16)}return p=1540483477*(65535&(p^=p>>>13))+((1540483477*(p>>>16)&65535)<<16),(p^=p>>>15)>>>0}}),wo=Rr,Ca=Sr;wo.murmur3=Rr,wo.murmur2=Ca;class za{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,n,s,h){this.ids.push(pl(e)),this.positions.push(n,s,h)}getPositions(e){const n=pl(e);let s=0,h=this.ids.length-1;for(;s<h;){const y=s+h>>1;this.ids[y]>=n?h=y:s=y+1}const p=[];for(;this.ids[s]===n;)p.push({index:this.positions[3*s],start:this.positions[3*s+1],end:this.positions[3*s+2]}),s++;return p}static serialize(e,n){const s=new Float64Array(e.ids),h=new Uint32Array(e.positions);return Oc(s,h,0,s.length-1),n&&n.push(s.buffer,h.buffer),{ids:s,positions:h}}static deserialize(e){const n=new za;return n.ids=e.ids,n.positions=e.positions,n.indexed=!0,n}}function pl(t){const e=+t;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:wo(String(t))}function Oc(t,e,n,s){for(;n<s;){const h=t[n+s>>1];let p=n-1,y=s+1;for(;;){do{p++}while(t[p]<h);do{y--}while(t[y]>h);if(p>=y)break;ra(t,p,y),ra(e,3*p,3*y),ra(e,3*p+1,3*y+1),ra(e,3*p+2,3*y+2)}y-n<s-y?(Oc(t,e,n,y),n=y+1):(Oc(t,e,y+1,s),s=y)}}function ra(t,e,n){const s=t[e];t[e]=t[n],t[n]=s}Oi(za,"FeaturePositionMap");class Rc{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,n){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,n),this.initialized=!0),!!this.location}}class Ou extends Rc{constructor(e){super(e),this.current=0}set(e,n,s){this.fetchUniformLocation(e,n)&&this.current!==s&&(this.current=s,this.gl.uniform1f(this.location,s))}}class al extends Rc{constructor(e){super(e),this.current=[0,0,0,0]}set(e,n,s){this.fetchUniformLocation(e,n)&&(s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]&&s[3]===this.current[3]||(this.current=s,this.gl.uniform4f(this.location,s[0],s[1],s[2],s[3])))}}class xc extends Rc{constructor(e){super(e),this.current=zr.transparent}set(e,n,s){this.fetchUniformLocation(e,n)&&(s.r===this.current.r&&s.g===this.current.g&&s.b===this.current.b&&s.a===this.current.a||(this.current=s,this.gl.uniform4f(this.location,s.r,s.g,s.b,s.a)))}}const fu=new Float32Array(16),Ru=new Float32Array(9),xh=new Float32Array(4);function Bf(t){return[zn(255*t.r,255*t.g),zn(255*t.b,255*t.a)]}class id{constructor(e,n,s){this.value=e,this.uniformNames=n.map(h=>`u_${h}`),this.type=s}setUniform(e,n,s,h,p){n.set(e,p,h.constantOr(this.value))}getBinding(e,n){return"color"===this.type?new xc(e):new Ou(e)}}class wh{constructor(e,n){this.uniformNames=n.map(s=>`u_${s}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,n){this.pixelRatioFrom=n.pixelRatio||1,this.pixelRatioTo=e.pixelRatio||1,this.patternFrom=n.tl.concat(n.br),this.patternTo=e.tl.concat(e.br)}setUniform(e,n,s,h,p){const y="u_pattern_to"===p||"u_dash_to"===p?this.patternTo:"u_pattern_from"===p||"u_dash_from"===p?this.patternFrom:"u_pixel_ratio_to"===p?this.pixelRatioTo:"u_pixel_ratio_from"===p?this.pixelRatioFrom:null;y&&n.set(e,p,y)}getBinding(e,n){return"u_pattern_from"===n||"u_pattern_to"===n||"u_dash_from"===n||"u_dash_to"===n?new al(e):new Ou(e)}}class pu{constructor(e,n,s,h){this.expression=e,this.type=s,this.maxValue=0,this.paintVertexAttributes=n.map(p=>({name:`a_${p}`,type:"Float32",components:"color"===s?2:1,offset:0})),this.paintVertexArray=new h}populatePaintArray(e,n,s,h,p,y){const T=this.paintVertexArray.length,R=this.expression.evaluate(new He(0),n,{},p,h,y);this.paintVertexArray.resize(e),this._setPaintValue(T,e,R)}updatePaintArray(e,n,s,h,p){const y=this.expression.evaluate({zoom:0},s,h,void 0,p);this._setPaintValue(e,n,y)}_setPaintValue(e,n,s){if("color"===this.type){const h=Bf(s);for(let p=e;p<n;p++)this.paintVertexArray.emplace(p,h[0],h[1])}else{for(let h=e;h<n;h++)this.paintVertexArray.emplace(h,s);this.maxValue=Math.max(this.maxValue,Math.abs(s))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class wc{constructor(e,n,s,h,p,y){this.expression=e,this.uniformNames=n.map(T=>`u_${T}_t`),this.type=s,this.useIntegerZoom=h,this.zoom=p,this.maxValue=0,this.paintVertexAttributes=n.map(T=>({name:`a_${T}`,type:"Float32",components:"color"===s?4:2,offset:0})),this.paintVertexArray=new y}populatePaintArray(e,n,s,h,p,y){const T=this.expression.evaluate(new He(this.zoom),n,{},p,h,y),R=this.expression.evaluate(new He(this.zoom+1),n,{},p,h,y),F=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(F,e,T,R)}updatePaintArray(e,n,s,h,p){const y=this.expression.evaluate({zoom:this.zoom},s,h,void 0,p),T=this.expression.evaluate({zoom:this.zoom+1},s,h,void 0,p);this._setPaintValue(e,n,y,T)}_setPaintValue(e,n,s,h){if("color"===this.type){const p=Bf(s),y=Bf(h);for(let T=e;T<n;T++)this.paintVertexArray.emplace(T,p[0],p[1],y[0],y[1])}else{for(let p=e;p<n;p++)this.paintVertexArray.emplace(p,s,h);this.maxValue=Math.max(this.maxValue,Math.abs(s),Math.abs(h))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,n,s,h,p){const y=this.useIntegerZoom?Math.floor(s.zoom):s.zoom,T=kt(this.expression.interpolationFactor(y,this.zoom,this.zoom+1),0,1);n.set(e,p,T)}getBinding(e,n){return new Ou(e)}}class kc{constructor(e,n,s,h,p,y,T){this.expression=e,this.type=s,this.useIntegerZoom=h,this.zoom=p,this.layerId=T,this.paintVertexAttributes=("array"===s?rr:Kc).members;for(let R=0;R<n.length;++R);this.zoomInPaintVertexArray=new y,this.zoomOutPaintVertexArray=new y}populatePaintArray(e,n,s){const h=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(h,e,n.patterns&&n.patterns[this.layerId],s)}updatePaintArray(e,n,s,h,p,y){this._setPaintValues(e,n,s.patterns&&s.patterns[this.layerId],y)}_setPaintValues(e,n,s,h){if(!h||!s)return;const{min:p,mid:y,max:T}=s,R=h[p],F=h[y],W=h[T];if(R&&F&&W)for(let te=e;te<n;te++)this._setPaintValue(this.zoomInPaintVertexArray,te,F,R),this._setPaintValue(this.zoomOutPaintVertexArray,te,F,W)}_setPaintValue(e,n,s,h){e.emplace(n,s.tl[0],s.tl[1],s.br[0],s.br[1],h.tl[0],h.tl[1],h.br[0],h.br[1],s.pixelRatio,h.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Nc{constructor(e,n,s=(()=>!0)){this.binders={},this._buffers=[];const h=[];for(const p in e.paint._values){if(!s(p))continue;const y=e.paint.get(p);if(!(y instanceof yt&&bo(y.property.specification)))continue;const T=Oa(p,e.type),R=y.value,F=y.property.specification.type,W=y.property.useIntegerZoom,te=y.property.specification["property-type"],re="cross-faded"===te||"cross-faded-data-driven"===te,_e="line-dasharray"===String(p)&&"constant"!==e.layout.get("line-cap").value.kind;if("constant"!==R.kind||_e)if("source"===R.kind||_e||re){const we=Th(p,F,"source");this.binders[p]=re?new kc(R,T,F,W,n,we,e.id):new pu(R,T,F,we),h.push(`/a_${p}`)}else{const we=Th(p,F,"composite");this.binders[p]=new wc(R,T,F,W,n,we),h.push(`/z_${p}`)}else this.binders[p]=re?new wh(R.value,T):new id(R.value,T,F),h.push(`/u_${p}`)}this.cacheKey=h.sort().join("")}getMaxValue(e){const n=this.binders[e];return n instanceof pu||n instanceof wc?n.maxValue:0}populatePaintArrays(e,n,s,h,p,y){for(const T in this.binders){const R=this.binders[T];(R instanceof pu||R instanceof wc||R instanceof kc)&&R.populatePaintArray(e,n,s,h,p,y)}}setConstantPatternPositions(e,n){for(const s in this.binders){const h=this.binders[s];h instanceof wh&&h.setConstantPatternPositions(e,n)}}updatePaintArrays(e,n,s,h,p,y){let T=!1;for(const R in e){const F=n.getPositions(R);for(const W of F){const te=s.feature(W.index);for(const re in this.binders){const _e=this.binders[re];if((_e instanceof pu||_e instanceof wc||_e instanceof kc)&&!0===_e.expression.isStateDependent){const we=h.paint.get(re);_e.expression=we.value,_e.updatePaintArray(W.start,W.end,te,e[R],p,y),T=!0}}}}return T}defines(){const e=[];for(const n in this.binders){const s=this.binders[n];(s instanceof id||s instanceof wh)&&e.push(...s.uniformNames.map(h=>`#define HAS_UNIFORM_${h}`))}return e}getBinderAttributes(){const e=[];for(const n in this.binders){const s=this.binders[n];if(s instanceof pu||s instanceof wc||s instanceof kc)for(let h=0;h<s.paintVertexAttributes.length;h++)e.push(s.paintVertexAttributes[h].name)}return e}getBinderUniforms(){const e=[];for(const n in this.binders){const s=this.binders[n];if(s instanceof id||s instanceof wh||s instanceof wc)for(const h of s.uniformNames)e.push(h)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){const n=[];for(const s in this.binders){const h=this.binders[s];if(h instanceof id||h instanceof wh||h instanceof wc)for(const p of h.uniformNames)n.push({name:p,property:s,binding:h.getBinding(e,p)})}return n}setUniforms(e,n,s,h,p){for(const{name:y,property:T,binding:R}of s)this.binders[T].setUniform(e,R,p,h.get(T),y)}updatePaintBuffers(e){this._buffers=[];for(const n in this.binders){const s=this.binders[n];if(e&&s instanceof kc){const h=2===e.fromScale?s.zoomInPaintVertexBuffer:s.zoomOutPaintVertexBuffer;h&&this._buffers.push(h)}else(s instanceof pu||s instanceof wc)&&s.paintVertexBuffer&&this._buffers.push(s.paintVertexBuffer)}}upload(e){for(const n in this.binders){const s=this.binders[n];(s instanceof pu||s instanceof wc||s instanceof kc)&&s.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const n=this.binders[e];(n instanceof pu||n instanceof wc||n instanceof kc)&&n.destroy()}}}class Xc{constructor(e,n,s=(()=>!0)){this.programConfigurations={};for(const h of e)this.programConfigurations[h.id]=new Nc(h,n,s);this.needsUpload=!1,this._featureMap=new za,this._bufferOffset=0}populatePaintArrays(e,n,s,h,p,y,T){for(const R in this.programConfigurations)this.programConfigurations[R].populatePaintArrays(e,n,h,p,y,T);void 0!==n.id&&this._featureMap.add(n.id,s,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,n,s,h,p){for(const y of s)this.needsUpload=this.programConfigurations[y.id].updatePaintArrays(e,this._featureMap,n,y,h,p)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const n in this.programConfigurations)this.programConfigurations[n].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const Vd={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"line-dasharray":["dash_to","dash_from"]};function Oa(t,e){return Vd[t]||[t.replace(`${e}-`,"").replace(/-/g,"_")]}const jd={"line-pattern":{source:tr,composite:tr},"fill-pattern":{source:tr,composite:tr},"fill-extrusion-pattern":{source:tr,composite:tr},"line-dasharray":{source:Kr,composite:Kr}},rd={color:{source:kr,composite:mo},number:{source:mn,composite:kr}};function Th(t,e,n){const s=jd[t];return s&&s[n]||rd[e][n]}Oi(id,"ConstantBinder"),Oi(wh,"CrossFadedConstantBinder"),Oi(pu,"SourceExpressionBinder"),Oi(kc,"CrossFadedCompositeBinder"),Oi(wc,"CompositeExpressionBinder"),Oi(Nc,"ProgramConfiguration",{omit:["_buffers"]}),Oi(Xc,"ProgramConfigurationSet");const Jc="-transition";class Lc extends Xn{constructor(e,n){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,"custom"!==e.type&&(this.metadata=(e=e).metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&"sky"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),n.layout&&(this._unevaluatedLayout=new Et(n.layout)),n.paint)){this._transitionablePaint=new tt(n.paint);for(const s in e.paint)this.setPaintProperty(s,e.paint[s],{validate:!1});for(const s in e.layout)this.setLayoutProperty(s,e.layout[s],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new It(n.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,n,s={}){null!=n&&this._validate(uc,`layers.${this.id}.layout.${e}`,e,n,s)||("visibility"!==e?this._unevaluatedLayout.setValue(e,n):this.visibility=n)}getPaintProperty(e){return en(e,Jc)?this._transitionablePaint.getTransition(e.slice(0,-Jc.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,n,s={}){if(null!=n&&this._validate(Ls,`layers.${this.id}.paint.${e}`,e,n,s))return!1;if(en(e,Jc))return this._transitionablePaint.setTransition(e.slice(0,-Jc.length),n||void 0),!1;{const h=this._transitionablePaint._values[e],p="cross-faded-data-driven"===h.property.specification["property-type"],y=h.value.isDataDriven(),T=h.value;this._transitionablePaint.setValue(e,n),this._handleSpecialPaintPropertyUpdate(e);const R=this._transitionablePaint._values[e].value;return R.isDataDriven()||y||p||this._handleOverridablePaintPropertyUpdate(e,T,R)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,n,s){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,n){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,n)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,n)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),Yt(e,(n,s)=>!(void 0===n||"layout"===s&&!Object.keys(n).length||"paint"===s&&!Object.keys(n).length))}_validate(e,n,s,h,p={}){return(!p||!1!==p.validate)&&Ea(this,e.call(Cl,{key:n,layerType:this.type,objectKey:s,value:h,styleSpec:qt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const n=this.paint.get(e);if(n instanceof yt&&bo(n.property.specification)&&("source"===n.value.kind||"composite"===n.value.kind)&&n.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=Os(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const zf=Un([{name:"a_pos",components:2,type:"Int16"}],4),ku=Un([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Ha{constructor(e=[]){this.segments=e}prepareSegment(e,n,s,h){let p=this.segments[this.segments.length-1];return e>Ha.MAX_VERTEX_ARRAY_LENGTH&&Mi(`Max vertices per segment is ${Ha.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!p||p.vertexLength+e>Ha.MAX_VERTEX_ARRAY_LENGTH||p.sortKey!==h)&&(p={vertexOffset:n.length,primitiveOffset:s.length,vertexLength:0,primitiveLength:0},void 0!==h&&(p.sortKey=h),this.segments.push(p)),p}get(){return this.segments}destroy(){for(const e of this.segments)for(const n in e.vaos)e.vaos[n].destroy()}static simpleSegment(e,n,s,h){return new Ha([{vertexOffset:e,primitiveOffset:n,vertexLength:s,primitiveLength:h,vaos:{},sortKey:0}])}}Ha.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Oi(Ha,"SegmentVector");var Fr=8192;class mu{constructor(e,n){e&&(n?this.setSouthWest(e).setNorthEast(n):4===e.length?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof Eo?new Eo(e.lng,e.lat):Eo.convert(e),this}setSouthWest(e){return this._sw=e instanceof Eo?new Eo(e.lng,e.lat):Eo.convert(e),this}extend(e){const n=this._sw,s=this._ne;let h,p;if(e instanceof Eo)h=e,p=e;else{if(!(e instanceof mu))return Array.isArray(e)?4===e.length||e.every(Array.isArray)?this.extend(mu.convert(e)):this.extend(Eo.convert(e)):this;if(h=e._sw,p=e._ne,!h||!p)return this}return n||s?(n.lng=Math.min(h.lng,n.lng),n.lat=Math.min(h.lat,n.lat),s.lng=Math.max(p.lng,s.lng),s.lat=Math.max(p.lat,s.lat)):(this._sw=new Eo(h.lng,h.lat),this._ne=new Eo(p.lng,p.lat)),this}getCenter(){return new Eo((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Eo(this.getWest(),this.getNorth())}getSouthEast(){return new Eo(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:n,lat:s}=Eo.convert(e);let h=this._sw.lng<=n&&n<=this._ne.lng;return this._sw.lng>this._ne.lng&&(h=this._sw.lng>=n&&n>=this._ne.lng),this._sw.lat<=s&&s<=this._ne.lat&&h}static convert(e){return!e||e instanceof mu?e:new mu(e)}}const Uf=6371008.8;class Eo{constructor(e,n){if(isNaN(e)||isNaN(n))throw new Error(`Invalid LngLat object: (${e}, ${n})`);if(this.lng=+e,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Eo(Qn(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const n=Math.PI/180,s=this.lat*n,h=e.lat*n,p=Math.sin(s)*Math.sin(h)+Math.cos(s)*Math.cos(h)*Math.cos((e.lng-this.lng)*n);return Uf*Math.acos(Math.min(p,1))}toBounds(e=0){const n=360*e/40075017,s=n/Math.cos(Math.PI/180*this.lat);return new mu(new Eo(this.lng-s,this.lat-n),new Eo(this.lng+s,this.lat+n))}static convert(e){if(e instanceof Eo)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new Eo(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new Eo(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const zl=2*Math.PI*Uf;function Eh(t){return zl*Math.cos(t*Math.PI/180)}function Tc(t){return(180+t)/360}function Fc(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function Xs(t,e){return t/Eh(e)}function Al(t){return 360*t-180}function Qa(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}function Zd(t,e){return t*Eh(Qa(e))}const Bc=85.051129;function od(t){return 1/Math.cos(t*Math.PI/180)}class gu{constructor(e,n,s=0){this.x=+e,this.y=+n,this.z=+s}static fromLngLat(e,n=0){const s=Eo.convert(e);return new gu(Tc(s.lng),Fc(s.lat),Xs(n,s.lat))}toLngLat(){return new Eo(Al(this.x),Qa(this.y))}toAltitude(){return Zd(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/zl*od(Qa(this.y))}}function Ju(t,e,n,s,h,p,y,T,R){const F=(e+s)/2,W=(n+h)/2,te=new Ke(F,W);T(te),function(re,_e,we,Oe,Ve,it){const bt=we-Ve,rt=Oe-it;return Math.abs((Oe-_e)*bt-(we-re)*rt)/Math.hypot(bt,rt)}(te.x,te.y,p.x,p.y,y.x,y.y)>=R?(Ju(t,e,n,F,W,p,te,T,R),Ju(t,F,W,s,h,te,y,T,R)):t.push(y)}function Gd(t,e,n){let s=t[0],h=s.x,p=s.y;e(s);const y=[s];for(let T=1;T<t.length;T++){const R=t[T],{x:F,y:W}=R;e(R),Ju(y,h,p,F,W,s,R,e,n),h=F,p=W,s=R}return y}function sd(t,e,n,s,h){if(h(e,n)){const p=e.add(n).mult(.5);s(p),sd(t,e,p,s,h),sd(t,p,n,s,h)}else t.push(n)}function zp(t,e,n){let s=t[0];e(s);const h=[s];for(let p=1;p<t.length;p++){const y=t[p];e(y),sd(h,s,y,e,n),s=y}return h}const Ch=Math.pow(2,14)-1,Hd=-Ch-1;function eg(t,e){const n=Math.round(t.x*e),s=Math.round(t.y*e);return t.x=kt(n,Hd,Ch),t.y=kt(s,Hd,Ch),(n<t.x||n>t.x+1||s<t.y||s>t.y+1)&&Mi("Geometry exceeds allowed extent, reduce your vector tile buffer size"),t}function zc(t,e,n){const s=t.loadGeometry(),h=t.extent,p=Fr/h;if(e&&n&&n.projection.isReprojectedInTileSpace){const y=1<<e.z,{scale:T,x:R,y:F,projection:W}=n,te=re=>{const _e=Al((e.x+re.x/h)/y),we=Qa((e.y+re.y/h)/y),Oe=W.project(_e,we);re.x=(Oe.x*T-R)*h,re.y=(Oe.y*T-F)*h};for(let re=0;re<s.length;re++)if(1!==t.type)s[re]=Gd(s[re],te,1);else{const _e=[];for(const we of s[re])we.x<0||we.x>=h||we.y<0||we.y>=h||(te(we),_e.push(we));s[re]=_e}}for(const y of s)for(const T of y)eg(T,p);return s}function Qc(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?zc(t):[]}}function Dh(t,e,n,s,h){t.emplaceBack(2*e+(s+1)/2,2*n+(h+1)/2)}function Sh(t,e,n){t.emplaceBack(e.x,e.y,e.z,16384*n[0],16384*n[1],16384*n[2])}class Nu{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new gi,this.indexArray=new Qe,this.segments=new Ha,this.programConfigurations=new Xc(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,s,h){const p=this.layers[0],y=[];let T=null;"circle"===p.type&&(T=p.layout.get("circle-sort-key"));for(const{feature:F,id:W,index:te,sourceLayerIndex:re}of e){const _e=this.layers[0]._featureFilter.needGeometry,we=Qc(F,_e);if(!this.layers[0]._featureFilter.filter(new He(this.zoom),we,s))continue;const Oe=T?T.evaluate(we,{},s):void 0,Ve={id:W,properties:F.properties,type:F.type,sourceLayerIndex:re,index:te,geometry:_e?we.geometry:zc(F,s,h),patterns:{},sortKey:Oe};y.push(Ve)}T&&y.sort((F,W)=>F.sortKey-W.sortKey);let R=null;"globe"===h.projection.name&&(this.globeExtVertexArray=new nd,R=h.projection);for(const F of y){const{geometry:W,index:te,sourceLayerIndex:re}=F,_e=e[te].feature;this.addFeature(F,W,te,n.availableImages,s,R),n.featureIndex.insert(_e,W,te,re,this.index)}}update(e,n,s,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,s,h)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,zf.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,ku.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,n,s,h,p,y){for(const T of n)for(const R of T){const F=R.x,W=R.y;if(F<0||F>=Fr||W<0||W>=Fr)continue;if(y){const _e=y.projectTilePoint(F,W,p),we=y.upVector(p,F,W),Oe=this.globeExtVertexArray;Sh(Oe,_e,we),Sh(Oe,_e,we),Sh(Oe,_e,we),Sh(Oe,_e,we)}const te=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),re=te.vertexLength;Dh(this.layoutVertexArray,F,W,-1,-1),Dh(this.layoutVertexArray,F,W,1,-1),Dh(this.layoutVertexArray,F,W,1,1),Dh(this.layoutVertexArray,F,W,-1,1),this.indexArray.emplaceBack(re,re+1,re+2),this.indexArray.emplaceBack(re,re+2,re+3),te.vertexLength+=4,te.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,{},h,p)}}function $d(t,e){for(let n=0;n<t.length;n++)if(Lu(e,t[n]))return!0;for(let n=0;n<e.length;n++)if(Lu(t,e[n]))return!0;return!!Zf(t,e)}function Vf(t,e,n){return!!Lu(t,e)||!!ad(e,t,n)}function qd(t,e){if(1===t.length)return Hf(e,t[0]);for(let n=0;n<e.length;n++){const s=e[n];for(let h=0;h<s.length;h++)if(Lu(t,s[h]))return!0}for(let n=0;n<t.length;n++)if(Hf(e,t[n]))return!0;for(let n=0;n<e.length;n++)if(Zf(t,e[n]))return!0;return!1}function jf(t,e,n){if(t.length>1){if(Zf(t,e))return!0;for(let s=0;s<e.length;s++)if(ad(e[s],t,n))return!0}for(let s=0;s<t.length;s++)if(ad(t[s],e,n))return!0;return!1}function Zf(t,e){if(0===t.length||0===e.length)return!1;for(let n=0;n<t.length-1;n++){const s=t[n],h=t[n+1];for(let p=0;p<e.length-1;p++)if(Up(s,h,e[p],e[p+1]))return!0}return!1}function Up(t,e,n,s){return mr(t,n,s)!==mr(e,n,s)&&mr(t,e,n)!==mr(t,e,s)}function ad(t,e,n){const s=n*n;if(1===e.length)return t.distSqr(e[0])<s;for(let h=1;h<e.length;h++)if(Gf(t,e[h-1],e[h])<s)return!0;return!1}function Gf(t,e,n){const s=e.distSqr(n);if(0===s)return t.distSqr(e);const h=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/s;return t.distSqr(h<0?e:h>1?n:n.sub(e)._mult(h)._add(e))}function Hf(t,e){let n,s,h,p=!1;for(let y=0;y<t.length;y++){n=t[y];for(let T=0,R=n.length-1;T<n.length;R=T++)s=n[T],h=n[R],s.y>e.y!=h.y>e.y&&e.x<(h.x-s.x)*(e.y-s.y)/(h.y-s.y)+s.x&&(p=!p)}return p}function Lu(t,e){let n=!1;for(let s=0,h=t.length-1;s<t.length;h=s++){const p=t[s],y=t[h];p.y>e.y!=y.y>e.y&&e.x<(y.x-p.x)*(e.y-p.y)/(y.y-p.y)+p.x&&(n=!n)}return n}function $f(t,e,n,s,h){for(const y of t)if(e<=y.x&&n<=y.y&&s>=y.x&&h>=y.y)return!0;const p=[new Ke(e,n),new Ke(e,h),new Ke(s,h),new Ke(s,n)];if(t.length>2)for(const y of p)if(Lu(t,y))return!0;for(let y=0;y<t.length-1;y++)if(qf(t[y],t[y+1],p))return!0;return!1}function qf(t,e,n){const s=n[0],h=n[2];if(t.x<s.x&&e.x<s.x||t.x>h.x&&e.x>h.x||t.y<s.y&&e.y<s.y||t.y>h.y&&e.y>h.y)return!1;const p=mr(t,e,n[0]);return p!==mr(t,e,n[1])||p!==mr(t,e,n[2])||p!==mr(t,e,n[3])}function Qu(t,e,n){const s=e.paint.get(t).value;return"constant"===s.kind?s.value:n.programConfigurations.get(e.id).getMaxValue(t)}function Wd(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function eh(t,e,n,s,h){if(!e[0]&&!e[1])return t;const p=Ke.convert(e)._mult(h);"viewport"===n&&p._rotate(-s);const y=[];for(let T=0;T<t.length;T++)y.push(t[T].sub(p));return y}function Uc(t,e,n,s){const h=Ke.convert(t)._mult(s);return"viewport"===e&&h._rotate(-n),h}Oi(Nu,"CircleBucket",{omit:["layers"]});const g_=new Ln({"circle-sort-key":new Vt(qt.layout_circle["circle-sort-key"])});var __={paint:new Ln({"circle-radius":new Vt(qt.paint_circle["circle-radius"]),"circle-color":new Vt(qt.paint_circle["circle-color"]),"circle-blur":new Vt(qt.paint_circle["circle-blur"]),"circle-opacity":new Vt(qt.paint_circle["circle-opacity"]),"circle-translate":new Ct(qt.paint_circle["circle-translate"]),"circle-translate-anchor":new Ct(qt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ct(qt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ct(qt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Vt(qt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Vt(qt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Vt(qt.paint_circle["circle-stroke-opacity"])}),layout:g_},th=1e-6,dc="undefined"!=typeof Float32Array?Float32Array:Array;function Vc(){var t=new dc(9);return dc!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function ic(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ld(t,e){var n=e[0],s=e[1],h=e[2],p=e[3],y=e[4],T=e[5],R=e[6],F=e[7],W=e[8],te=e[9],re=e[10],_e=e[11],we=e[12],Oe=e[13],Ve=e[14],it=e[15],bt=n*T-s*y,rt=n*R-h*y,vt=n*F-p*y,Lt=s*R-h*T,St=s*F-p*T,fn=h*F-p*R,hn=W*Oe-te*we,bn=W*Ve-re*we,hi=W*it-_e*we,Tn=te*Ve-re*Oe,Zn=te*it-_e*Oe,Yn=re*it-_e*Ve,Gn=bt*Yn-rt*Zn+vt*Tn+Lt*hi-St*bn+fn*hn;return Gn?(t[0]=(T*Yn-R*Zn+F*Tn)*(Gn=1/Gn),t[1]=(h*Zn-s*Yn-p*Tn)*Gn,t[2]=(Oe*fn-Ve*St+it*Lt)*Gn,t[3]=(re*St-te*fn-_e*Lt)*Gn,t[4]=(R*hi-y*Yn-F*bn)*Gn,t[5]=(n*Yn-h*hi+p*bn)*Gn,t[6]=(Ve*vt-we*fn-it*rt)*Gn,t[7]=(W*fn-re*vt+_e*rt)*Gn,t[8]=(y*Zn-T*hi+F*hn)*Gn,t[9]=(s*hi-n*Zn-p*hn)*Gn,t[10]=(we*St-Oe*vt+it*bt)*Gn,t[11]=(te*vt-W*St-_e*bt)*Gn,t[12]=(T*bn-y*Tn-R*hn)*Gn,t[13]=(n*Tn-s*bn+h*hn)*Gn,t[14]=(Oe*rt-we*Lt-Ve*bt)*Gn,t[15]=(W*Lt-te*rt+re*bt)*Gn,t):null}function Ah(t,e,n){var s=e[0],h=e[1],p=e[2],y=e[3],T=e[4],R=e[5],F=e[6],W=e[7],te=e[8],re=e[9],_e=e[10],we=e[11],Oe=e[12],Ve=e[13],it=e[14],bt=e[15],rt=n[0],vt=n[1],Lt=n[2],St=n[3];return t[0]=rt*s+vt*T+Lt*te+St*Oe,t[1]=rt*h+vt*R+Lt*re+St*Ve,t[2]=rt*p+vt*F+Lt*_e+St*it,t[3]=rt*y+vt*W+Lt*we+St*bt,t[4]=(rt=n[4])*s+(vt=n[5])*T+(Lt=n[6])*te+(St=n[7])*Oe,t[5]=rt*h+vt*R+Lt*re+St*Ve,t[6]=rt*p+vt*F+Lt*_e+St*it,t[7]=rt*y+vt*W+Lt*we+St*bt,t[8]=(rt=n[8])*s+(vt=n[9])*T+(Lt=n[10])*te+(St=n[11])*Oe,t[9]=rt*h+vt*R+Lt*re+St*Ve,t[10]=rt*p+vt*F+Lt*_e+St*it,t[11]=rt*y+vt*W+Lt*we+St*bt,t[12]=(rt=n[12])*s+(vt=n[13])*T+(Lt=n[14])*te+(St=n[15])*Oe,t[13]=rt*h+vt*R+Lt*re+St*Ve,t[14]=rt*p+vt*F+Lt*_e+St*it,t[15]=rt*y+vt*W+Lt*we+St*bt,t}function Fu(t,e,n){var s,h,p,y,T,R,F,W,te,re,_e,we,Oe=n[0],Ve=n[1],it=n[2];return e===t?(t[12]=e[0]*Oe+e[4]*Ve+e[8]*it+e[12],t[13]=e[1]*Oe+e[5]*Ve+e[9]*it+e[13],t[14]=e[2]*Oe+e[6]*Ve+e[10]*it+e[14],t[15]=e[3]*Oe+e[7]*Ve+e[11]*it+e[15]):(h=e[1],p=e[2],y=e[3],T=e[4],R=e[5],F=e[6],W=e[7],te=e[8],re=e[9],_e=e[10],we=e[11],t[0]=s=e[0],t[1]=h,t[2]=p,t[3]=y,t[4]=T,t[5]=R,t[6]=F,t[7]=W,t[8]=te,t[9]=re,t[10]=_e,t[11]=we,t[12]=s*Oe+T*Ve+te*it+e[12],t[13]=h*Oe+R*Ve+re*it+e[13],t[14]=p*Oe+F*Ve+_e*it+e[14],t[15]=y*Oe+W*Ve+we*it+e[15]),t}function jc(t,e,n){var s=n[0],h=n[1],p=n[2];return t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t[3]=e[3]*s,t[4]=e[4]*h,t[5]=e[5]*h,t[6]=e[6]*h,t[7]=e[7]*h,t[8]=e[8]*p,t[9]=e[9]*p,t[10]=e[10]*p,t[11]=e[11]*p,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Yd(t,e,n){var s=Math.sin(n),h=Math.cos(n),p=e[4],y=e[5],T=e[6],R=e[7],F=e[8],W=e[9],te=e[10],re=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=p*h+F*s,t[5]=y*h+W*s,t[6]=T*h+te*s,t[7]=R*h+re*s,t[8]=F*h-p*s,t[9]=W*h-y*s,t[10]=te*h-T*s,t[11]=re*h-R*s,t}function cd(t,e,n){var s=Math.sin(n),h=Math.cos(n),p=e[0],y=e[1],T=e[2],R=e[3],F=e[8],W=e[9],te=e[10],re=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=p*h-F*s,t[1]=y*h-W*s,t[2]=T*h-te*s,t[3]=R*h-re*s,t[8]=p*s+F*h,t[9]=y*s+W*h,t[10]=T*s+te*h,t[11]=R*s+re*h,t}function Kd(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ud(t,e,n){var s,h,p,y=n[0],T=n[1],R=n[2],F=Math.hypot(y,T,R);return F<th?null:(y*=F=1/F,T*=F,R*=F,s=Math.sin(e),h=Math.cos(e),t[0]=y*y*(p=1-h)+h,t[1]=T*y*p+R*s,t[2]=R*y*p-T*s,t[3]=0,t[4]=y*T*p-R*s,t[5]=T*T*p+h,t[6]=R*T*p+y*s,t[7]=0,t[8]=y*R*p+T*s,t[9]=T*R*p-y*s,t[10]=R*R*p+h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var Vp=Ah;function jp(){var t=new dc(3);return dc!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Bu(t){var e=new dc(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function nh(t){return Math.hypot(t[0],t[1],t[2])}function ih(t,e,n){var s=new dc(3);return s[0]=t,s[1]=e,s[2]=n,s}function eu(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function hd(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Zp(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function Wf(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function Yf(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function Zc(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function Mh(t,e,n,s){return t[0]=e[0]+n[0]*s,t[1]=e[1]+n[1]*s,t[2]=e[2]+n[2]*s,t}function $l(t,e){var n=e[0],s=e[1],h=e[2],p=n*n+s*s+h*h;return p>0&&(p=1/Math.sqrt(p)),t[0]=e[0]*p,t[1]=e[1]*p,t[2]=e[2]*p,t}function fc(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function dd(t,e,n){var s=e[0],h=e[1],p=e[2],y=n[0],T=n[1],R=n[2];return t[0]=h*R-p*T,t[1]=p*y-s*R,t[2]=s*T-h*y,t}function $a(t,e,n){var s=e[0],h=e[1],p=e[2],y=n[3]*s+n[7]*h+n[11]*p+n[15];return t[0]=(n[0]*s+n[4]*h+n[8]*p+n[12])/(y=y||1),t[1]=(n[1]*s+n[5]*h+n[9]*p+n[13])/y,t[2]=(n[2]*s+n[6]*h+n[10]*p+n[14])/y,t}function Ih(t,e,n){var s=n[0],h=n[1],p=n[2],y=e[0],T=e[1],R=e[2],F=h*R-p*T,W=p*y-s*R,te=s*T-h*y,re=h*te-p*W,_e=p*F-s*te,we=s*W-h*F,Oe=2*n[3];return W*=Oe,te*=Oe,_e*=2,we*=2,t[0]=y+(F*=Oe)+(re*=2),t[1]=T+W+_e,t[2]=R+te+we,t}var fd,Gc=hd,Gp=Zp,Hp=nh;function _u(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function zu(t,e,n){var s=e[0],h=e[1],p=e[2],y=e[3];return t[0]=n[0]*s+n[4]*h+n[8]*p+n[12]*y,t[1]=n[1]*s+n[5]*h+n[9]*p+n[13]*y,t[2]=n[2]*s+n[6]*h+n[10]*p+n[14]*y,t[3]=n[3]*s+n[7]*h+n[11]*p+n[15]*y,t}function Kf(){var t=new dc(4);return dc!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function $p(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function pd(t,e,n){n*=.5;var s=e[0],h=e[1],p=e[2],y=e[3],T=Math.sin(n),R=Math.cos(n);return t[0]=s*R+y*T,t[1]=h*R+p*T,t[2]=p*R-h*T,t[3]=y*R-s*T,t}function Xd(t,e,n){n*=.5;var s=e[0],h=e[1],p=e[2],y=e[3],T=Math.sin(n),R=Math.cos(n);return t[0]=s*R-p*T,t[1]=h*R+y*T,t[2]=p*R+s*T,t[3]=y*R-h*T,t}jp(),fd=new dc(4),dc!=Float32Array&&(fd[0]=0,fd[1]=0,fd[2]=0,fd[3]=0),jp(),ih(1,0,0),ih(0,1,0),Kf(),Kf(),Vc();class Jd{constructor(e,n){this.pos=e,this.dir=n}intersectsPlane(e,n,s){const h=fc(n,this.dir);if(Math.abs(h)<1e-6)return!1;const p=((e[0]-this.pos[0])*n[0]+(e[1]-this.pos[1])*n[1]+(e[2]-this.pos[2])*n[2])/h;return s[0]=this.pos[0]+this.dir[0]*p,s[1]=this.pos[1]+this.dir[1]*p,s[2]=this.pos[2]+this.dir[2]*p,!0}closestPointOnSphere(e,n,s){if(Oe=(_e=this.pos)[0],Ve=_e[1],it=_e[2],bt=(we=e)[0],rt=we[1],vt=we[2],Math.abs(Oe-bt)<=th*Math.max(1,Math.abs(Oe),Math.abs(bt))&&Math.abs(Ve-rt)<=th*Math.max(1,Math.abs(Ve),Math.abs(rt))&&Math.abs(it-vt)<=th*Math.max(1,Math.abs(it),Math.abs(vt))||0===n)return s[0]=s[1]=s[2]=0,!1;var _e,we,Oe,Ve,it,bt,rt,vt;const[h,p,y]=this.dir,T=this.pos[0]-e[0],R=this.pos[1]-e[1],F=this.pos[2]-e[2],W=h*h+p*p+y*y,te=2*(T*h+R*p+F*y),re=te*te-4*W*(T*T+R*R+F*F-n*n);if(re<0){const _e=Math.max(-te/2,0),we=T+h*_e,Oe=R+p*_e,Ve=F+y*_e,it=Math.hypot(we,Oe,Ve);return s[0]=we*n/it,s[1]=Oe*n/it,s[2]=Ve*n/it,!1}{const _e=(-te-Math.sqrt(re))/(2*W);if(_e<0){const we=Math.hypot(T,R,F);return s[0]=T*n/we,s[1]=R*n/we,s[2]=F*n/we,!1}return s[0]=T+h*_e,s[1]=R+p*_e,s[2]=F+y*_e,!0}}}class Qd{constructor(e,n,s,h,p){this.TL=e,this.TR=n,this.BR=s,this.BL=h,this.horizon=p}static fromInvProjectionMatrix(e,n,s){const h=[-1,1,1],p=[1,1,1],y=[1,-1,1],T=[-1,-1,1],R=$a(h,h,e),F=$a(p,p,e),W=$a(y,y,e),te=$a(T,T,e);return new Qd(R,F,W,te,n/s)}}class ef{constructor(e,n){this.points=e,this.planes=n}static fromInvProjectionMatrix(e,n,s,h){const p=Math.pow(2,s),y=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(R=>{const F=zu([],R,e),W=1/F[3]/n*p;return(te=F)[0]=(re=F)[0]*(_e=[W,W,h?1/F[3]:W,W])[0],te[1]=re[1]*_e[1],te[2]=re[2]*_e[2],te[3]=re[3]*_e[3],te;var te,re,_e}),T=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(R=>{const F=$l([],dd([],Gc([],y[R[0]],y[R[1]]),Gc([],y[R[2]],y[R[1]]))),W=-fc(F,y[R[1]]);return F.concat(W)});return new ef(y,T)}}class Ul{static fromPoints(e){const n=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],s=[Number.MIN_VALUE,Number.MIN_VALUE,Number.MIN_VALUE];for(const h of e)n[0]=Math.min(n[0],h[0]),n[1]=Math.min(n[1],h[1]),n[2]=Math.min(n[2],h[2]),s[0]=Math.max(s[0],h[0]),s[1]=Math.max(s[1],h[1]),s[2]=Math.max(s[2],h[2]);return new Ul(n,s)}constructor(e,n){this.min=e,this.max=n,this.center=Zc([],eu([],this.min,this.max),.5)}quadrant(e){const n=[e%2==0,e<2],s=Bu(this.min),h=Bu(this.max);for(let p=0;p<n.length;p++)s[p]=n[p]?this.min[p]:this.center[p],h[p]=n[p]?this.center[p]:this.max[p];return h[2]=this.max[2],new Ul(s,h)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,n=this.max;return[[e[0],e[1],e[2]],[n[0],e[1],e[2]],[n[0],n[1],e[2]],[e[0],n[1],e[2]],[e[0],e[1],n[2]],[n[0],e[1],n[2]],[n[0],n[1],n[2]],[e[0],n[1],n[2]]]}intersects(e){const n=this.getCorners();let s=!0;for(let h=0;h<e.planes.length;h++){const p=e.planes[h];let y=0;for(let T=0;T<n.length;T++)y+=fc(p,n[T])+p[3]>=0;if(0===y)return 0;y!==n.length&&(s=!1)}if(s)return 2;for(let h=0;h<3;h++){let p=Number.MAX_VALUE,y=-Number.MAX_VALUE;for(let T=0;T<e.points.length;T++){const R=e.points[T][h]-this.min[h];p=Math.min(p,R),y=Math.max(y,R)}if(y<0||p>this.max[h]-this.min[h])return 0}return 1}}function Xf(t,e,n,s,h,p,y,T,R){if(p&&t.queryGeometry.isAboveHorizon)return!1;p&&(R*=t.pixelToTileUnitsFactor);const F=t.tileID.canonical,W=n.projection.upVectorScale(F,n.center.lat,n.worldSize).metersToTile;for(const te of e)for(const re of te){const _e=re.add(T),we=h&&n.elevation?n.elevation.exaggeration()*h.getElevationAt(_e.x,_e.y,!0):0,Oe=n.projection.projectTilePoint(_e.x,_e.y,F);if(we>0){const rt=n.projection.upVector(F,_e.x,_e.y);Oe.x+=rt[0]*W*we,Oe.y+=rt[1]*W*we,Oe.z+=rt[2]*W*we}const Ve=p?_e:tf(Oe.x,Oe.y,Oe.z,s),it=p?t.tilespaceRays.map(rt=>gd(rt,we)):t.queryGeometry.screenGeometry,bt=zu([],[Oe.x,Oe.y,Oe.z,1],s);if(!y&&p?R*=bt[3]/n.cameraToCenterDistance:y&&!p&&(R*=n.cameraToCenterDistance/bt[3]),p){const rt=Qa((re.y/Fr+F.y)/(1<<F.z));R/=n.projection.pixelsPerMeter(rt,1)/Xs(1,rt)}if(Vf(it,Ve,R))return!0}return!1}function tf(t,e,n,s){const h=zu([],[t,e,n,1],s);return new Ke(h[0]/h[3],h[1]/h[3])}const md=ih(0,0,0),qp=ih(0,0,1);function gd(t,e){const n=jp();return md[2]=e,t.intersectsPlane(md,qp,n),new Ke(n[0],n[1])}class nf extends Nu{}function _d(t,{width:e,height:n},s,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==e*n*s)throw new RangeError("mismatched image size")}else h=new Uint8Array(e*n*s);return t.width=e,t.height=n,t.data=h,t}function w(t,e,n){const{width:s,height:h}=e;s===t.width&&h===t.height||(k(t,e,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,s),height:Math.min(t.height,h)},n),t.width=s,t.height=h,t.data=e.data)}function k(t,e,n,s,h,p){if(0===h.width||0===h.height)return e;if(h.width>t.width||h.height>t.height||n.x>t.width-h.width||n.y>t.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>e.width||h.height>e.height||s.x>e.width-h.width||s.y>e.height-h.height)throw new RangeError("out of range destination coordinates for image copy");const y=t.data,T=e.data;for(let R=0;R<h.height;R++){const F=((n.y+R)*t.width+n.x)*p,W=((s.y+R)*e.width+s.x)*p;for(let te=0;te<h.width*p;te++)T[W+te]=y[F+te]}return e}Oi(nf,"HeatmapBucket",{omit:["layers"]});class _{constructor(e,n){_d(this,e,1,n)}resize(e){w(this,new _(e),1)}clone(){return new _({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,s,h,p){k(e,n,s,h,p,1)}}class B{constructor(e,n){_d(this,e,4,n)}resize(e){w(this,new B(e),4)}replace(e,n){n?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new B({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,s,h,p){k(e,n,s,h,p,4)}}Oi(_,"AlphaImage"),Oi(B,"RGBAImage");var ie={paint:new Ln({"heatmap-radius":new Vt(qt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Vt(qt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ct(qt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Xt(qt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ct(qt.paint_heatmap["heatmap-opacity"])})};function ve(t){const e={},n=t.resolution||256,s=t.clips?t.clips.length:1,h=t.image||new B({width:n,height:s}),p=(y,T,R)=>{e[t.evaluationKey]=R;const F=t.expression.evaluate(e);h.data[y+T+0]=Math.floor(255*F.r/F.a),h.data[y+T+1]=Math.floor(255*F.g/F.a),h.data[y+T+2]=Math.floor(255*F.b/F.a),h.data[y+T+3]=Math.floor(255*F.a)};if(t.clips)for(let y=0,T=0;y<s;++y,T+=4*n)for(let R=0,F=0;R<n;R++,F+=4){const W=R/(n-1),{start:te,end:re}=t.clips[y];p(T,F,te*(1-W)+re*W)}else for(let y=0,T=0;y<n;y++,T+=4)p(0,T,y/(n-1));return h}var ht={paint:new Ln({"hillshade-illumination-direction":new Ct(qt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ct(qt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ct(qt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ct(qt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ct(qt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ct(qt.paint_hillshade["hillshade-accent-color"])})};const Ht=Un([{name:"a_pos",components:2,type:"Int16"}],4),{members:jt}=Ht;var xn=or,Fn=or;function or(t,e,n){n=n||2;var s,h,p,y,T,R,F,W=e&&e.length,te=W?e[0]*n:t.length,re=qi(t,0,te,n,!0),_e=[];if(!re||re.next===re.prev)return _e;if(W&&(re=function(Oe,Ve,it,bt){var rt,vt,Lt,St=[];for(rt=0,vt=Ve.length;rt<vt;rt++)(Lt=qi(Oe,Ve[rt]*bt,rt<vt-1?Ve[rt+1]*bt:Oe.length,bt,!1))===Lt.next&&(Lt.steiner=!0),St.push(oa(Lt));for(St.sort(pa),rt=0;rt<St.length;rt++)it=ns(St[rt],it);return it}(t,e,re,n)),t.length>80*n){s=p=t[0],h=y=t[1];for(var we=n;we<te;we+=n)(T=t[we])<s&&(s=T),(R=t[we+1])<h&&(h=R),T>p&&(p=T),R>y&&(y=R);F=0!==(F=Math.max(p-s,y-h))?32767/F:0}return uo(re,_e,n,s,h,F,0),_e}function qi(t,e,n,s,h){var p,y;if(h===Uu(t,e,n,s)>0)for(p=e;p<n;p+=s)y=Kl(p,t[p],t[p+1],y);else for(p=n-s;p>=e;p-=s)y=Kl(p,t[p],t[p+1],y);return y&&ma(y,y.next)&&(Vl(y),y=y.next),y}function ur(t,e){if(!t)return t;e||(e=t);var n,s=t;do{if(n=!1,s.steiner||!ma(s,s.next)&&0!==So(s.prev,s,s.next))s=s.next;else{if(Vl(s),(s=e=s.prev)===s.next)break;n=!0}}while(n||s!==e);return e}function uo(t,e,n,s,h,p,y){if(t){!y&&p&&function(W,te,re,_e){var we=W;do{0===we.z&&(we.z=Yo(we.x,we.y,te,re,_e)),we.prevZ=we.prev,we.nextZ=we.next,we=we.next}while(we!==W);we.prevZ.nextZ=null,we.prevZ=null,function(Oe){var Ve,it,bt,rt,vt,Lt,St,fn,hn=1;do{for(it=Oe,Oe=null,vt=null,Lt=0;it;){for(Lt++,bt=it,St=0,Ve=0;Ve<hn&&(St++,bt=bt.nextZ);Ve++);for(fn=hn;St>0||fn>0&&bt;)0!==St&&(0===fn||!bt||it.z<=bt.z)?(rt=it,it=it.nextZ,St--):(rt=bt,bt=bt.nextZ,fn--),vt?vt.nextZ=rt:Oe=rt,rt.prevZ=vt,vt=rt;it=bt}vt.nextZ=null,hn*=2}while(Lt>1)}(we)}(t,s,h,p);for(var T,R,F=t;t.prev!==t.next;)if(T=t.prev,R=t.next,p?Do(t,s,h,p):Yr(t))e.push(T.i/n|0),e.push(t.i/n|0),e.push(R.i/n|0),Vl(t),t=R.next,F=R.next;else if((t=R)===F){y?1===y?uo(t=Wo(ur(t),e,n),e,n,s,h,p,2):2===y&&jo(t,e,n,s,h,p):uo(ur(t),e,n,s,h,p,1);break}}}function Yr(t){var e=t.prev,n=t,s=t.next;if(So(e,n,s)>=0)return!1;for(var h=e.x,p=n.x,y=s.x,T=e.y,R=n.y,F=s.y,W=h<p?h<y?h:y:p<y?p:y,te=T<R?T<F?T:F:R<F?R:F,re=h>p?h>y?h:y:p>y?p:y,_e=T>R?T>F?T:F:R>F?R:F,we=s.next;we!==e;){if(we.x>=W&&we.x<=re&&we.y>=te&&we.y<=_e&&as(h,T,p,R,y,F,we.x,we.y)&&So(we.prev,we,we.next)>=0)return!1;we=we.next}return!0}function Do(t,e,n,s){var h=t.prev,p=t,y=t.next;if(So(h,p,y)>=0)return!1;for(var T=h.x,R=p.x,F=y.x,W=h.y,te=p.y,re=y.y,_e=T<R?T<F?T:F:R<F?R:F,we=W<te?W<re?W:re:te<re?te:re,Oe=T>R?T>F?T:F:R>F?R:F,Ve=W>te?W>re?W:re:te>re?te:re,it=Yo(_e,we,e,n,s),bt=Yo(Oe,Ve,e,n,s),rt=t.prevZ,vt=t.nextZ;rt&&rt.z>=it&&vt&&vt.z<=bt;){if(rt.x>=_e&&rt.x<=Oe&&rt.y>=we&&rt.y<=Ve&&rt!==h&&rt!==y&&as(T,W,R,te,F,re,rt.x,rt.y)&&So(rt.prev,rt,rt.next)>=0||(rt=rt.prevZ,vt.x>=_e&&vt.x<=Oe&&vt.y>=we&&vt.y<=Ve&&vt!==h&&vt!==y&&as(T,W,R,te,F,re,vt.x,vt.y)&&So(vt.prev,vt,vt.next)>=0))return!1;vt=vt.nextZ}for(;rt&&rt.z>=it;){if(rt.x>=_e&&rt.x<=Oe&&rt.y>=we&&rt.y<=Ve&&rt!==h&&rt!==y&&as(T,W,R,te,F,re,rt.x,rt.y)&&So(rt.prev,rt,rt.next)>=0)return!1;rt=rt.prevZ}for(;vt&&vt.z<=bt;){if(vt.x>=_e&&vt.x<=Oe&&vt.y>=we&&vt.y<=Ve&&vt!==h&&vt!==y&&as(T,W,R,te,F,re,vt.x,vt.y)&&So(vt.prev,vt,vt.next)>=0)return!1;vt=vt.nextZ}return!0}function Wo(t,e,n){var s=t;do{var h=s.prev,p=s.next.next;!ma(h,p)&&rc(h,s,s.next,p)&&pc(h,p)&&pc(p,h)&&(e.push(h.i/n|0),e.push(s.i/n|0),e.push(p.i/n|0),Vl(s),Vl(s.next),s=t=p),s=s.next}while(s!==t);return ur(s)}function jo(t,e,n,s,h,p){var y=t;do{for(var T=y.next.next;T!==y.prev;){if(y.i!==T.i&&Ar(y,T)){var R=Yl(y,T);return y=ur(y,y.next),R=ur(R,R.next),uo(y,e,n,s,h,p,0),void uo(R,e,n,s,h,p,0)}T=T.next}y=y.next}while(y!==t)}function pa(t,e){return t.x-e.x}function ns(t,e){var n=function(h,p){var y,T=p,R=h.x,F=h.y,W=-1/0;do{if(F<=T.y&&F>=T.next.y&&T.next.y!==T.y){var te=T.x+(F-T.y)*(T.next.x-T.x)/(T.next.y-T.y);if(te<=R&&te>W&&(W=te,y=T.x<T.next.x?T:T.next,te===R))return y}T=T.next}while(T!==p);if(!y)return null;var re,_e=y,we=y.x,Oe=y.y,Ve=1/0;T=y;do{R>=T.x&&T.x>=we&&R!==T.x&&as(F<Oe?R:W,F,we,Oe,F<Oe?W:R,F,T.x,T.y)&&(re=Math.abs(F-T.y)/(R-T.x),pc(T,h)&&(re<Ve||re===Ve&&(T.x>y.x||T.x===y.x&&Ho(y,T)))&&(y=T,Ve=re)),T=T.next}while(T!==_e);return y}(t,e);if(!n)return e;var s=Yl(n,t);return ur(s,s.next),ur(n,n.next)}function Ho(t,e){return So(t.prev,t,e.prev)<0&&So(e.next,t,t.next)<0}function Yo(t,e,n,s,h){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*h|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-s)*h|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function oa(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function as(t,e,n,s,h,p,y,T){return(h-y)*(e-T)>=(t-y)*(p-T)&&(t-y)*(s-T)>=(n-y)*(e-T)&&(n-y)*(p-T)>=(h-y)*(s-T)}function Ar(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(n,s){var h=n;do{if(h.i!==n.i&&h.next.i!==n.i&&h.i!==s.i&&h.next.i!==s.i&&rc(h,h.next,n,s))return!0;h=h.next}while(h!==n);return!1}(t,e)&&(pc(t,e)&&pc(e,t)&&function(n,s){var h=n,p=!1,y=(n.x+s.x)/2,T=(n.y+s.y)/2;do{h.y>T!=h.next.y>T&&h.next.y!==h.y&&y<(h.next.x-h.x)*(T-h.y)/(h.next.y-h.y)+h.x&&(p=!p),h=h.next}while(h!==n);return p}(t,e)&&(So(t.prev,t,e.prev)||So(t,e.prev,e))||ma(t,e)&&So(t.prev,t,t.next)>0&&So(e.prev,e,e.next)>0)}function So(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function ma(t,e){return t.x===e.x&&t.y===e.y}function rc(t,e,n,s){var h=el(So(t,e,n)),p=el(So(t,e,s)),y=el(So(n,s,t)),T=el(So(n,s,e));return h!==p&&y!==T||!(0!==h||!qa(t,n,e))||!(0!==p||!qa(t,s,e))||!(0!==y||!qa(n,t,s))||!(0!==T||!qa(n,e,s))}function qa(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function el(t){return t>0?1:t<0?-1:0}function pc(t,e){return So(t.prev,t,t.next)<0?So(t,e,t.next)>=0&&So(t,t.prev,e)>=0:So(t,e,t.prev)<0||So(t,t.next,e)<0}function Yl(t,e){var n=new Ec(t.i,t.x,t.y),s=new Ec(e.i,e.x,e.y),h=t.next,p=e.prev;return t.next=e,e.prev=t,n.next=h,h.prev=n,s.next=n,n.prev=s,p.next=s,s.prev=p,s}function Kl(t,e,n,s){var h=new Ec(t,e,n);return s?(h.next=s.next,h.prev=s,s.next.prev=h,s.next=h):(h.prev=h,h.next=h),h}function Vl(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Ec(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Uu(t,e,n,s){for(var h=0,p=e,y=n-s;p<n;p+=s)h+=(t[y]-t[p])*(t[p+1]+t[y+1]),y=p;return h}function Ph(t,e,n,s,h){Oh(t,e,n||0,s||t.length-1,h||Rh)}function Oh(t,e,n,s,h){for(;s>n;){if(s-n>600){var p=s-n+1,y=e-n+1,T=Math.log(p),R=.5*Math.exp(2*T/3),F=.5*Math.sqrt(T*R*(p-R)/p)*(y-p/2<0?-1:1);Oh(t,e,Math.max(n,Math.floor(e-y*R/p+F)),Math.min(s,Math.floor(e+(p-y)*R/p+F)),h)}var W=t[e],te=n,re=s;for(tu(t,n,e),h(t[s],W)>0&&tu(t,n,s);te<re;){for(tu(t,te,re),te++,re--;h(t[te],W)<0;)te++;for(;h(t[re],W)>0;)re--}0===h(t[n],W)?tu(t,n,re):tu(t,++re,s),re<=e&&(n=re+1),e<=re&&(s=re-1)}}function tu(t,e,n){var s=t[e];t[e]=t[n],t[n]=s}function Rh(t,e){return t<e?-1:t>e?1:0}function oc(t,e){const n=t.length;if(n<=1)return[t];const s=[];let h,p;for(let y=0;y<n;y++){const T=wi(t[y]);0!==T&&(t[y].area=Math.abs(T),void 0===p&&(p=T<0),p===T<0?(h&&s.push(h),h=[t[y]]):h.push(t[y]))}if(h&&s.push(h),e>1)for(let y=0;y<s.length;y++)s[y].length<=e||(Ph(s[y],e,1,s[y].length-1,yu),s[y]=s[y].slice(0,e));return s}function yu(t,e){return e.area-t.area}function vu(t,e,n){const s=n.patternDependencies;let h=!1;for(const p of e){const y=p.paint.get(`${t}-pattern`);y.isConstant()||(h=!0);const T=y.constantOr(null);T&&(h=!0,s[T.to]=!0,s[T.from]=!0)}return h}function Cc(t,e,n,s,h){const p=h.patternDependencies;for(const y of e){const T=y.paint.get(`${t}-pattern`).value;if("constant"!==T.kind){let R=T.evaluate({zoom:s-1},n,{},h.availableImages),F=T.evaluate({zoom:s},n,{},h.availableImages),W=T.evaluate({zoom:s+1},n,{},h.availableImages);R=R&&R.name?R.name:R,F=F&&F.name?F.name:F,W=W&&W.name?W.name:W,p[R]=!0,p[F]=!0,p[W]=!0,n.patterns[y.id]={min:R,mid:F,max:W}}}return n}or.deviation=function(t,e,n,s){var h=e&&e.length,p=Math.abs(Uu(t,0,h?e[0]*n:t.length,n));if(h)for(var y=0,T=e.length;y<T;y++)p-=Math.abs(Uu(t,e[y]*n,y<T-1?e[y+1]*n:t.length,n));var R=0;for(y=0;y<s.length;y+=3){var F=s[y]*n,W=s[y+1]*n,te=s[y+2]*n;R+=Math.abs((t[F]-t[te])*(t[W+1]-t[F+1])-(t[F]-t[W])*(t[te+1]-t[F+1]))}return 0===p&&0===R?0:Math.abs((R-p)/p)},or.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},s=0,h=0;h<t.length;h++){for(var p=0;p<t[h].length;p++)for(var y=0;y<e;y++)n.vertices.push(t[h][p][y]);h>0&&n.holes.push(s+=t[h-1].length)}return n},xn.default=Fn;class bu{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new gi,this.indexArray=new Qe,this.indexArray2=new Pr,this.programConfigurations=new Xc(e.layers,e.zoom),this.segments=new Ha,this.segments2=new Ha,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id),this.projection=e.projection}populate(e,n,s,h){this.hasPattern=vu("fill",this.layers,n);const p=this.layers[0].layout.get("fill-sort-key"),y=[];for(const{feature:T,id:R,index:F,sourceLayerIndex:W}of e){const te=this.layers[0]._featureFilter.needGeometry,re=Qc(T,te);if(!this.layers[0]._featureFilter.filter(new He(this.zoom),re,s))continue;const _e=p?p.evaluate(re,{},s,n.availableImages):void 0,we={id:R,properties:T.properties,type:T.type,sourceLayerIndex:W,index:F,geometry:te?re.geometry:zc(T,s,h),patterns:{},sortKey:_e};y.push(we)}p&&y.sort((T,R)=>T.sortKey-R.sortKey);for(const T of y){const{geometry:R,index:F,sourceLayerIndex:W}=T;if(this.hasPattern){const te=Cc("fill",this.layers,T,this.zoom,n);this.patternFeatures.push(te)}else this.addFeature(T,R,F,s,{},n.availableImages);n.featureIndex.insert(e[F].feature,R,F,W,this.index)}}update(e,n,s,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,s,h)}addFeatures(e,n,s,h,p){for(const y of this.patternFeatures)this.addFeature(y,y.geometry,y.index,n,s,h)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,jt),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,n,s,h,p,y=[]){for(const T of oc(n,500)){let R=0;for(const we of T)R+=we.length;const F=this.segments.prepareSegment(R,this.layoutVertexArray,this.indexArray),W=F.vertexLength,te=[],re=[];for(const we of T){if(0===we.length)continue;we!==T[0]&&re.push(te.length/2);const Oe=this.segments2.prepareSegment(we.length,this.layoutVertexArray,this.indexArray2),Ve=Oe.vertexLength;this.layoutVertexArray.emplaceBack(we[0].x,we[0].y),this.indexArray2.emplaceBack(Ve+we.length-1,Ve),te.push(we[0].x),te.push(we[0].y);for(let it=1;it<we.length;it++)this.layoutVertexArray.emplaceBack(we[it].x,we[it].y),this.indexArray2.emplaceBack(Ve+it-1,Ve+it),te.push(we[it].x),te.push(we[it].y);Oe.vertexLength+=we.length,Oe.primitiveLength+=we.length}const _e=xn(te,re);for(let we=0;we<_e.length;we+=3)this.indexArray.emplaceBack(W+_e[we],W+_e[we+1],W+_e[we+2]);F.vertexLength+=R,F.primitiveLength+=_e.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,p,y,h)}}Oi(bu,"FillBucket",{omit:["layers","patternFeatures"]});const tg=new Ln({"fill-sort-key":new Vt(qt.layout_fill["fill-sort-key"])});var rf={paint:new Ln({"fill-antialias":new Ct(qt.paint_fill["fill-antialias"]),"fill-opacity":new Vt(qt.paint_fill["fill-opacity"]),"fill-color":new Vt(qt.paint_fill["fill-color"]),"fill-outline-color":new Vt(qt.paint_fill["fill-outline-color"]),"fill-translate":new Ct(qt.paint_fill["fill-translate"]),"fill-translate-anchor":new Ct(qt.paint_fill["fill-translate-anchor"]),"fill-pattern":new sn(qt.paint_fill["fill-pattern"])}),layout:tg};const Wp=Un([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),Jf=Un([{name:"a_centroid_pos",components:2,type:"Uint16"}]),Yp=Un([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Qf}=Wp;var ep=Vu;function Vu(t,e,n,s,h){this.properties={},this.extent=n,this.type=0,this._pbf=t,this._geometry=-1,this._keys=s,this._values=h,t.readFields(ng,this,e)}function ng(t,e,n){1==t?e.id=n.readVarint():2==t?function(s,h){for(var p=s.readVarint()+s.pos;s.pos<p;){var y=h._keys[s.readVarint()],T=h._values[s.readVarint()];h.properties[y]=T}}(n,e):3==t?e.type=n.readVarint():4==t&&(e._geometry=n.pos)}function tp(t){for(var e,n,s=0,h=0,p=t.length,y=p-1;h<p;y=h++)s+=((n=t[y]).x-(e=t[h]).x)*(e.y+n.y);return s}Vu.types=["Unknown","Point","LineString","Polygon"],Vu.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,n=t.readVarint()+t.pos,s=1,h=0,p=0,y=0,T=[];t.pos<n;){if(h<=0){var R=t.readVarint();s=7&R,h=R>>3}if(h--,1===s||2===s)p+=t.readSVarint(),y+=t.readSVarint(),1===s&&(e&&T.push(e),e=[]),e.push(new Ke(p,y));else{if(7!==s)throw new Error("unknown command "+s);e&&e.push(e[0].clone())}}return e&&T.push(e),T},Vu.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,n=1,s=0,h=0,p=0,y=1/0,T=-1/0,R=1/0,F=-1/0;t.pos<e;){if(s<=0){var W=t.readVarint();n=7&W,s=W>>3}if(s--,1===n||2===n)(h+=t.readSVarint())<y&&(y=h),h>T&&(T=h),(p+=t.readSVarint())<R&&(R=p),p>F&&(F=p);else if(7!==n)throw new Error("unknown command "+n)}return[y,R,T,F]},Vu.prototype.toGeoJSON=function(t,e,n){var s,h,p=this.extent*Math.pow(2,n),y=this.extent*t,T=this.extent*e,R=this.loadGeometry(),F=Vu.types[this.type];function W(_e){for(var we=0;we<_e.length;we++){var Oe=_e[we];_e[we]=[360*(Oe.x+y)/p-180,360/Math.PI*Math.atan(Math.exp((180-360*(Oe.y+T)/p)*Math.PI/180))-90]}}switch(this.type){case 1:var te=[];for(s=0;s<R.length;s++)te[s]=R[s][0];W(R=te);break;case 2:for(s=0;s<R.length;s++)W(R[s]);break;case 3:for(R=function(_e){var we=_e.length;if(we<=1)return[_e];for(var Oe,Ve,it=[],bt=0;bt<we;bt++){var rt=tp(_e[bt]);0!==rt&&(void 0===Ve&&(Ve=rt<0),Ve===rt<0?(Oe&&it.push(Oe),Oe=[_e[bt]]):Oe.push(_e[bt]))}return Oe&&it.push(Oe),it}(R),s=0;s<R.length;s++)for(h=0;h<R[s].length;h++)W(R[s][h])}1===R.length?R=R[0]:F="Multi"+F;var re={type:"Feature",geometry:{type:F,coordinates:R},properties:this.properties};return"id"in this&&(re.id=this.id),re};var nu=kh;function kh(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(yd,this,e),this.length=this._features.length}function yd(t,e,n){15===t?e.version=n.readVarint():1===t?e.name=n.readString():5===t?e.extent=n.readVarint():2===t?e._features.push(n.pos):3===t?e._keys.push(n.readString()):4===t&&e._values.push(function(s){for(var h=null,p=s.readVarint()+s.pos;s.pos<p;){var y=s.readVarint()>>3;h=1===y?s.readString():2===y?s.readFloat():3===y?s.readDouble():4===y?s.readVarint64():5===y?s.readVarint():6===y?s.readSVarint():7===y?s.readBoolean():null}return h}(n))}function Kp(t,e,n){if(3===t){var s=new nu(n,n.readVarint()+n.pos);s.length&&(e[s.name]=s)}}kh.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new ep(this._pbf,e,this.extent,this._keys,this._values)};var xu={VectorTile:function(t,e){this.layers=t.readFields(Kp,{},e)},VectorTileFeature:ep,VectorTileLayer:nu};function vd(t,e,n,s){const h=[],p=0===s?(y,T,R,F,W,te)=>{y.push(new Ke(te,R+(te-T)/(F-T)*(W-R)))}:(y,T,R,F,W,te)=>{y.push(new Ke(T+(te-R)/(W-R)*(F-T),te))};for(const y of t){const T=[];for(const R of y){if(R.length<=2)continue;const F=[];for(let re=0;re<R.length-1;re++){const _e=R[re].x,we=R[re].y,Oe=R[re+1].x,Ve=R[re+1].y,it=0===s?_e:we,bt=0===s?Oe:Ve;it<e?bt>e&&p(F,_e,we,Oe,Ve,e):it>n?bt<n&&p(F,_e,we,Oe,Ve,n):F.push(R[re]),bt<e&&it>=e&&p(F,_e,we,Oe,Ve,e),bt>n&&it<=n&&p(F,_e,we,Oe,Ve,n)}let W=R[R.length-1];const te=0===s?W.x:W.y;te>=e&&te<=n&&F.push(W),F.length&&(W=F[F.length-1],F[0].x===W.x&&F[0].y===W.y||F.push(F[0]),T.push(F))}T.length&&h.push(T)}return h}const Xp=xu.VectorTileFeature.types,Jp=Math.pow(2,13);function Nh(t,e,n,s,h,p,y,T){t.emplaceBack((e<<1)+y,(n<<1)+p,(Math.floor(s*Jp)<<1)+h,Math.round(T))}function np(t,e,n){t.emplaceBack(e.x,e.y,e.z,16384*n[0],16384*n[1],16384*n[2])}class y_{constructor(){this.acc=new Ke(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new Ke(e.x,e.y),this.max=new Ke(e.x,e.y))}append(e,n){this.currentPolyCount.edges++,this.acc._add(e);const s=this.min,h=this.max;e.x<s.x?s.x=e.x:e.x>h.x&&(h.x=e.x),e.y<s.y?s.y=e.y:e.y>h.y&&(h.y=e.y),((0===e.x||e.x===Fr)&&e.x===n.x)!=((0===e.y||e.y===Fr)&&e.y===n.y)&&this.processBorderOverlap(e,n),n.x<0!=e.x<0&&this.addBorderIntersection(0,wn(n.y,e.y,(0-n.x)/(e.x-n.x))),n.x>Fr!=e.x>Fr&&this.addBorderIntersection(1,wn(n.y,e.y,(Fr-n.x)/(e.x-n.x))),n.y<0!=e.y<0&&this.addBorderIntersection(2,wn(n.x,e.x,(0-n.y)/(e.y-n.y))),n.y>Fr!=e.y>Fr&&this.addBorderIntersection(3,wn(n.x,e.x,(Fr-n.y)/(e.y-n.y)))}addBorderIntersection(e,n){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const s=this.borders[e];n<s[0]&&(s[0]=n),n>s[1]&&(s[1]=n)}processBorderOverlap(e,n){if(e.x===n.x){if(e.y===n.y)return;const s=0===e.x?0:1;this.addBorderIntersection(s,n.y),this.addBorderIntersection(s,e.y)}else{const s=0===e.y?2:3;this.addBorderIntersection(s,n.x),this.addBorderIntersection(s,e.x)}}centroid(){const e=this.polyCount.reduce((n,s)=>n+s.edges,0);return 0!==e?this.acc.div(e)._round():new Ke(0,0)}span(){return new Ke(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((e,n)=>e+ +(n[0]!==Number.MAX_VALUE),0)}}class ip{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.layoutVertexArray=new vr,this.centroidVertexArray=new du,this.indexArray=new Qe,this.programConfigurations=new Xc(e.layers,e.zoom),this.segments=new Ha,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id),this.enableTerrain=e.enableTerrain}populate(e,n,s,h){this.features=[],this.hasPattern=vu("fill-extrusion",this.layers,n),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(p){const y=Math.exp(Math.PI*(1-p.y/(1<<p.z)*2));return 80150034*y/(y*y+1)/Fr/(1<<p.z)}(s),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:p,id:y,index:T,sourceLayerIndex:R}of e){const F=this.layers[0]._featureFilter.needGeometry,W=Qc(p,F);if(!this.layers[0]._featureFilter.filter(new He(this.zoom),W,s))continue;const te={id:y,sourceLayerIndex:R,index:T,geometry:F?W.geometry:zc(p,s,h),properties:p.properties,type:p.type,patterns:{}},re=this.layoutVertexArray.length;this.hasPattern?this.features.push(Cc("fill-extrusion",this.layers,te,this.zoom,n)):this.addFeature(te,te.geometry,T,s,{},n.availableImages,h),n.featureIndex.insert(p,te.geometry,T,R,this.index,re)}this.sortBorders()}addFeatures(e,n,s,h,p){for(const y of this.features){const{geometry:T}=y;this.addFeature(y,T,y.index,n,s,h,p)}this.sortBorders()}update(e,n,s,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,s,h)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Qf),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,Yp.members,!0))),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,Jf.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,n,s,h,p,y,T){const R=[new Ke(0,0),new Ke(Fr,Fr)],F=T.projection,W="globe"===F.name,te=this.enableTerrain&&!W?new y_:null,re="Polygon"===Xp[e.type];W&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new _r);const _e=oc(n,500);for(let it=_e.length-1;it>=0;it--){const bt=_e[it];(0===bt.length||(we=bt[0]).every(rt=>rt.x<=0)||we.every(rt=>rt.x>=Fr)||we.every(rt=>rt.y<=0)||we.every(rt=>rt.y>=Fr))&&_e.splice(it,1)}var we;let Oe;if(W)Oe=sp(_e,R,h);else{Oe=[];for(const it of _e)Oe.push({polygon:it,bounds:R})}const Ve=re?this.edgeRadius:0;for(const{polygon:it,bounds:bt}of Oe){let rt=0,vt=0;for(const St of it)re&&!St[0].equals(St[St.length-1])&&St.push(St[0]),vt+=re?St.length-1:St.length;const Lt=this.segments.prepareSegment((re?5:4)*vt,this.layoutVertexArray,this.indexArray);if(re){const St=[],fn=[];rt=Lt.vertexLength;for(const bn of it){let hi,Tn;bn.length&&bn!==it[0]&&fn.push(St.length/2),hi=bn[1].sub(bn[0])._perp()._unit();for(let Zn=1;Zn<bn.length;Zn++){const Yn=bn[Zn],Gn=bn[Zn===bn.length-1?1:Zn+1];let{x:ci,y:Kn}=Yn;if(Ve){Tn=Gn.sub(Yn)._perp()._unit();const Di=hi.add(Tn)._unit(),so=Ve*Math.min(4,1/(hi.x*Di.x+hi.y*Di.y));ci+=so*Di.x,Kn+=so*Di.y,hi=Tn}Nh(this.layoutVertexArray,ci,Kn,0,0,1,1,0),Lt.vertexLength++,St.push(Yn.x,Yn.y),W&&np(this.layoutVertexExtArray,F.projectTilePoint(ci,Kn,h),F.upVector(h,ci,Kn))}}const hn=xn(St,fn);for(let bn=0;bn<hn.length;bn+=3)this.indexArray.emplaceBack(rt+hn[bn],rt+hn[bn+2],rt+hn[bn+1]),Lt.primitiveLength++}for(const St of it){te&&St.length&&te.startRing(St[0]);let fn,hn,bn,hi=St.length>4&&Qp(St[St.length-2],St[0],St[1]),Tn=Ve?rh(St[St.length-2],St[0],St[1],Ve):0;hn=St[1].sub(St[0])._perp()._unit();for(let Zn=1,Yn=0;Zn<St.length;Zn++){let Gn=St[Zn-1],ci=St[Zn];const Kn=St[Zn===St.length-1?1:Zn+1];if(te&&re&&te.currentPolyCount.top++,ig(ci,Gn,bt)){Ve&&(hn=Kn.sub(ci)._perp()._unit());continue}te&&te.append(ci,Gn);const Di=ci.sub(Gn)._perp(),so=Di.x/(Math.abs(Di.x)+Math.abs(Di.y)),ho=Di.y>0?1:0,wr=Gn.dist(ci);if(Yn+wr>32768&&(Yn=0),Ve){bn=Kn.sub(ci)._perp()._unit();let zi=rp(Gn,ci,Kn,v_(hn,bn),Ve);isNaN(zi)&&(zi=0);const Cs=ci.sub(Gn)._unit();Gn=Gn.add(Cs.mult(Tn))._round(),ci=ci.add(Cs.mult(-zi))._round(),Tn=zi,hn=bn}const Ei=Lt.vertexLength,Co=St.length>4&&Qp(Gn,ci,Kn);let Xr=op(Yn,hi,!0);if(Nh(this.layoutVertexArray,Gn.x,Gn.y,so,ho,0,0,Xr),Nh(this.layoutVertexArray,Gn.x,Gn.y,so,ho,0,1,Xr),Yn+=wr,Xr=op(Yn,Co,!1),hi=Co,Nh(this.layoutVertexArray,ci.x,ci.y,so,ho,0,0,Xr),Nh(this.layoutVertexArray,ci.x,ci.y,so,ho,0,1,Xr),Lt.vertexLength+=4,this.indexArray.emplaceBack(Ei+0,Ei+1,Ei+2),this.indexArray.emplaceBack(Ei+1,Ei+3,Ei+2),Lt.primitiveLength+=2,Ve){const zi=rt+(1===Zn?St.length-2:Zn-2),Cs=1===Zn?rt:zi+1;if(this.indexArray.emplaceBack(Ei+1,zi,Ei+3),this.indexArray.emplaceBack(zi,Cs,Ei+3),Lt.primitiveLength+=2,void 0===fn&&(fn=Ei),!ig(Kn,St[Zn],bt)){const Fo=Zn===St.length-1?fn:Lt.vertexLength;this.indexArray.emplaceBack(Ei+2,Ei+3,Fo),this.indexArray.emplaceBack(Ei+3,Fo+1,Fo),this.indexArray.emplaceBack(Ei+3,Cs,Fo+1),Lt.primitiveLength+=3}}if(W){const zi=this.layoutVertexExtArray,Cs=F.projectTilePoint(Gn.x,Gn.y,h),Fo=F.projectTilePoint(ci.x,ci.y,h),sa=F.upVector(h,Gn.x,Gn.y),go=F.upVector(h,ci.x,ci.y);np(zi,Cs,sa),np(zi,Cs,sa),np(zi,Fo,go),np(zi,Fo,go)}}re&&(rt+=St.length-1)}}if(te&&te.polyCount.length>0){if(te.borders){te.vertexArrayOffset=this.centroidVertexArray.length;const it=te.borders,bt=this.featuresOnBorder.push(te)-1;for(let rt=0;rt<4;rt++)it[rt][0]!==Number.MAX_VALUE&&this.borders[rt].push(bt)}this.encodeCentroid(te.borders?void 0:te.centroid(),te)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,p,y,h)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort((n,s)=>this.featuresOnBorder[n].borders[e][0]-this.featuresOnBorder[s].borders[e][0])}encodeCentroid(e,n,s=!0){let h,p;if(e)if(0!==e.y){const T=n.span()._mult(this.tileToMeter);h=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(T.x/10)),p=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(T.y/10))}else h=Math.ceil(7*(e.x+450)),p=0;else h=0,p=+s;let y=s?this.centroidVertexArray.length:n.vertexArrayOffset;for(const T of n.polyCount){s&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*T.edges+T.top);for(let R=0;R<T.top;R++)this.centroidVertexArray.emplace(y++,h,p);for(let R=0;R<2*T.edges;R++)this.centroidVertexArray.emplace(y++,0,p),this.centroidVertexArray.emplace(y++,h,p)}}}function v_(t,e){const n=t.add(e)._unit();return t.x*n.x+t.y*n.y}function rh(t,e,n,s){const h=e.sub(t)._perp()._unit(),p=n.sub(e)._perp()._unit();return rp(t,e,n,v_(h,p),s)}function rp(t,e,n,s,h){const p=Math.sqrt(1-s*s);return Math.min(t.dist(e)/3,e.dist(n)/3,h*p/s)}function ig(t,e,n){return t.x<n[0].x&&e.x<n[0].x||t.x>n[1].x&&e.x>n[1].x||t.y<n[0].y&&e.y<n[0].y||t.y>n[1].y&&e.y>n[1].y}function Qp(t,e,n){if(t.x<0||t.x>=Fr||e.x<0||e.x>=Fr||n.x<0||n.x>=Fr)return!1;const s=n.sub(e),h=s.perp(),p=t.sub(e);return(s.x*p.x+s.y*p.y)/Math.sqrt((s.x*s.x+s.y*s.y)*(p.x*p.x+p.y*p.y))>-.866&&h.x*p.x+h.y*p.y<0}function op(t,e,n){const s=e?2|t:-3&t;return n?1|s:-2&s}function em(){const t=Math.PI/32,e=Math.tan(t),n=Uf;return n*Math.sqrt(1+2*e*e)-n}function sp(t,e,n){const s=1<<n.z,h=Al(n.x/s),p=Al((n.x+1)/s),y=Qa(n.y/s),T=Qa((n.y+1)/s);return function(R,F,W,te,re=0,_e){const we=[];if(!R.length||!W||!te)return we;const Oe=(St,fn)=>{for(const hn of St)we.push({polygon:hn,bounds:fn})},Ve=Math.ceil(Math.log2(W)),it=Math.ceil(Math.log2(te)),bt=Ve-it,rt=[];for(let St=0;St<Math.abs(bt);St++)rt.push(bt>0?0:1);for(let St=0;St<Math.min(Ve,it);St++)rt.push(0),rt.push(1);let vt=R;if(vt=vd(vt,F[0].y-re,F[1].y+re,1),vt=vd(vt,F[0].x-re,F[1].x+re,0),!vt.length)return we;const Lt=[];for(rt.length?Lt.push({polygons:vt,bounds:F,depth:0}):Oe(vt,F);Lt.length;){const St=Lt.pop(),fn=St.depth,hn=rt[fn],bn=St.bounds[0],hi=St.bounds[1],Tn=0===hn?bn.x:bn.y,Zn=0===hn?hi.x:hi.y,Yn=_e?_e(hn,Tn,Zn):.5*(Tn+Zn),Gn=vd(St.polygons,Tn-re,Yn+re,hn),ci=vd(St.polygons,Yn-re,Zn+re,hn);if(Gn.length){const Kn=[bn,new Ke(0===hn?Yn:hi.x,1===hn?Yn:hi.y)];rt.length>fn+1?Lt.push({polygons:Gn,bounds:Kn,depth:fn+1}):Oe(Gn,Kn)}if(ci.length){const Kn=[new Ke(0===hn?Yn:bn.x,1===hn?Yn:bn.y),hi];rt.length>fn+1?Lt.push({polygons:ci,bounds:Kn,depth:fn+1}):Oe(ci,Kn)}}return we}(t,e,Math.ceil((p-h)/11.25),Math.ceil((y-T)/11.25),1,(R,F,W)=>{if(0===R)return.5*(F+W);{const te=Qa((n.y+F/Fr)/s);return(Fc(.5*(Qa((n.y+W/Fr)/s)+te))*s-n.y)*Fr}})}Oi(ip,"FillExtrusionBucket",{omit:["layers","features"]}),Oi(y_,"PartMetadata");const b_=new Ln({"fill-extrusion-edge-radius":new Ct(qt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var oh={paint:new Ln({"fill-extrusion-opacity":new Ct(qt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Vt(qt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ct(qt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ct(qt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new sn(qt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Vt(qt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Vt(qt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ct(qt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Ct(qt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Ct(qt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"])}),layout:b_};function tm(t,e,n){var s=2*Math.PI*6378137/256/Math.pow(2,n);return[t*s-2*Math.PI*6378137/2,e*s-2*Math.PI*6378137/2]}class ap{constructor(e,n,s){this.z=e,this.x=n,this.y=s,this.key=bd(0,e,e,n,s)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,n){const s=(y=this.y,T=this.z,R=tm(256*(p=this.x),256*(y=Math.pow(2,T)-y-1),T),F=tm(256*(p+1),256*(y+1),T),R[0]+","+R[1]+","+F[0]+","+F[1]),h=function(p,y,T){let R,F="";for(let W=p;W>0;W--)R=1<<W-1,F+=(y&R?1:0)+(T&R?2:0);return F}(this.z,this.x,this.y);var p,y,T,R,F;return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===n?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",h).replace("{bbox-epsg-3857}",s)}toString(){return`${this.z}/${this.x}/${this.y}`}}class lp{constructor(e,n){this.wrap=e,this.canonical=n,this.key=bd(e,n.z,n.z,n.x,n.y)}}class Xl{constructor(e,n,s,h,p){this.overscaledZ=e,this.wrap=n,this.canonical=new ap(s,+h,+p),this.key=0===n&&e===s?this.canonical.key:bd(n,e,s,h,p)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const n=this.canonical.z-e;return e>this.canonical.z?new Xl(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Xl(e,this.wrap,e,this.canonical.x>>n,this.canonical.y>>n)}calculateScaledKey(e,n=!0){if(this.overscaledZ===e&&n)return this.key;if(e>this.canonical.z)return bd(this.wrap*+n,e,this.canonical.z,this.canonical.x,this.canonical.y);{const s=this.canonical.z-e;return bd(this.wrap*+n,e,e,this.canonical.x>>s,this.canonical.y>>s)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const n=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>n&&e.canonical.y===this.canonical.y>>n}children(e){if(this.overscaledZ>=e)return[new Xl(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const n=this.canonical.z+1,s=2*this.canonical.x,h=2*this.canonical.y;return[new Xl(n,this.wrap,n,s,h),new Xl(n,this.wrap,n,s+1,h),new Xl(n,this.wrap,n,s,h+1),new Xl(n,this.wrap,n,s+1,h+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new Xl(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new Xl(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new lp(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function bd(t,e,n,s,h){const p=1<<Math.min(n,22);let y=p*(h%p)+s%p;return t&&n<22&&(y+=p*p*((t<0?-2*t-1:2*t)%(1<<2*(22-n)))),16*(32*y+n)+(e-n)}function sf(t,e){return t.x*e.x+t.y*e.y}function rg(t,e){if(1===t.length){let n=0;const s=e[n++];let h;for(;!h||s.equals(h);)if(h=e[n++],!h)return 1/0;for(;n<e.length;n++){const p=e[n],y=t[0],T=h.sub(s),R=p.sub(s),F=y.sub(s),W=sf(T,T),te=sf(T,R),re=sf(R,R),_e=sf(F,T),we=sf(F,R),Oe=W*re-te*te,Ve=(re*_e-te*we)/Oe,it=(W*we-te*_e)/Oe,bt=s.z*(1-Ve-it)+h.z*Ve+p.z*it;if(isFinite(bt))return bt}return 1/0}{let n=1/0;for(const s of e)n=Math.min(n,s.z);return n}}function sh(t){const e=new Ke(t[0],t[1]);return e.z=t[2],e}function Lh(t,e,n,s,h,p,y,T){const R=y*h.getElevationAt(t,e,!0,!0),F=0!==p[0],W=F?0===p[1]?y*(p[0]/7-450):y*function(te,re,_e){const we=Math.floor(re[0]/8),Oe=Math.floor(re[1]/8),Ve=10*(re[0]-8*we),it=10*(re[1]-8*Oe),bt=te.getElevationAt(we,Oe,!0,!0),rt=te.getMeterToDEM(_e),vt=Math.floor(.5*(Ve*rt-1)),Lt=Math.floor(.5*(it*rt-1)),St=te.tileCoordToPixel(we,Oe),fn=2*vt+1,hn=2*Lt+1,bn=(so=fn,ho=hn,[(ci=te).getElevationAtPixel(Kn=St.x-vt,Di=St.y-Lt,!0),ci.getElevationAtPixel(Kn+ho,Di,!0),ci.getElevationAtPixel(Kn,Di+ho,!0),ci.getElevationAtPixel(Kn+so,Di+ho,!0)]),hi=Math.abs(bn[0]-bn[1]),Tn=Math.abs(bn[2]-bn[3]),Zn=Math.abs(bn[0]-bn[2])+Math.abs(bn[1]-bn[3]),Yn=Math.min(.25,.5*rt*(hi+Tn)/fn),Gn=Math.min(.25,.5*rt*Zn/hn);var ci,Kn,Di,so,ho;return bt+Math.max(Yn*Ve,Gn*it)}(h,p,T):R;return{base:R+(0===n)?-1:n,top:F?Math.max(W+s,R+n+2):R+s}}Oi(ap,"CanonicalTileID"),Oi(Xl,"OverscaledTileID",{omit:["projMatrix"]});const nm=Un([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:xd}=nm,af=Un([{name:"a_packed",components:4,type:"Float32"}]),{members:wd}=af,x_=xu.VectorTileFeature.types,og=Math.cos(Math.PI/180*37.5);class lf{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(n=>{this.gradients[n.id]={}}),this.layoutVertexArray=new jr,this.layoutVertexArray2=new mo,this.indexArray=new Qe,this.programConfigurations=new Xc(e.layers,e.zoom),this.segments=new Ha,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,s,h){this.hasPattern=vu("line",this.layers,n);const p=this.layers[0].layout.get("line-sort-key"),y=[];for(const{feature:W,id:te,index:re,sourceLayerIndex:_e}of e){const we=this.layers[0]._featureFilter.needGeometry,Oe=Qc(W,we);if(!this.layers[0]._featureFilter.filter(new He(this.zoom),Oe,s))continue;const Ve=p?p.evaluate(Oe,{},s):void 0,it={id:te,properties:W.properties,type:W.type,sourceLayerIndex:_e,index:re,geometry:we?Oe.geometry:zc(W,s,h),patterns:{},sortKey:Ve};y.push(it)}p&&y.sort((W,te)=>W.sortKey-te.sortKey);const{lineAtlas:T,featureIndex:R}=n,F=this.addConstantDashes(T);for(const W of y){const{geometry:te,index:re,sourceLayerIndex:_e}=W;if(F&&this.addFeatureDashes(W,T),this.hasPattern){const we=Cc("line",this.layers,W,this.zoom,n);this.patternFeatures.push(we)}else this.addFeature(W,te,re,s,T.positions,n.availableImages);R.insert(e[re].feature,te,re,_e,this.index)}}addConstantDashes(e){let n=!1;for(const s of this.layers){const h=s.paint.get("line-dasharray").value,p=s.layout.get("line-cap").value;if("constant"!==h.kind||"constant"!==p.kind)n=!0;else{const y=p.value,T=h.value;if(!T)continue;e.addDash(T.from,y),e.addDash(T.to,y),T.other&&e.addDash(T.other,y)}}return n}addFeatureDashes(e,n){const s=this.zoom;for(const h of this.layers){const p=h.paint.get("line-dasharray").value,y=h.layout.get("line-cap").value;if("constant"===p.kind&&"constant"===y.kind)continue;let T,R,F,W,te,re;if("constant"===p.kind){const Ve=p.value;if(!Ve)continue;T=Ve.other||Ve.to,R=Ve.to,F=Ve.from}else T=p.evaluate({zoom:s-1},e),R=p.evaluate({zoom:s},e),F=p.evaluate({zoom:s+1},e);"constant"===y.kind?W=te=re=y.value:(W=y.evaluate({zoom:s-1},e),te=y.evaluate({zoom:s},e),re=y.evaluate({zoom:s+1},e)),n.addDash(T,W),n.addDash(R,te),n.addDash(F,re);const _e=n.getKey(T,W),we=n.getKey(R,te),Oe=n.getKey(F,re);e.patterns[h.id]={min:_e,mid:we,max:Oe}}}update(e,n,s,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,s,h)}addFeatures(e,n,s,h,p){for(const y of this.patternFeatures)this.addFeature(y,y.geometry,y.index,n,s,h)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,wd)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,xd),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,n,s,h,p,y){const T=this.layers[0].layout,R=T.get("line-join").evaluate(e,{}),F=T.get("line-cap").evaluate(e,{}),W=T.get("line-miter-limit"),te=T.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const re of n)this.addLine(re,e,R,F,W,te);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,p,y,h)}addLine(e,n,s,h,p,y){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let it=0;it<e.length-1;it++)this.totalDistance+=e[it].dist(e[it+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const T="Polygon"===x_[n.type];let R=e.length;for(;R>=2&&e[R-1].equals(e[R-2]);)R--;let F=0;for(;F<R-1&&e[F].equals(e[F+1]);)F++;if(R<(T?3:2))return;"bevel"===s&&(p=1.05);const W=this.overscaling<=16?122880/(512*this.overscaling):0,te=this.segments.prepareSegment(10*R,this.layoutVertexArray,this.indexArray);let re,_e,we,Oe,Ve;this.e1=this.e2=-1,T&&(re=e[R-2],Ve=e[F].sub(re)._unit()._perp());for(let it=F;it<R;it++){if(we=it===R-1?T?e[F+1]:void 0:e[it+1],we&&e[it].equals(we))continue;Ve&&(Oe=Ve),re&&(_e=re),re=e[it],Ve=we?we.sub(re)._unit()._perp():Oe,Oe=Oe||Ve;let bt=Oe.add(Ve);0===bt.x&&0===bt.y||bt._unit();const rt=Oe.x*Ve.x+Oe.y*Ve.y,vt=bt.x*Ve.x+bt.y*Ve.y,Lt=0!==vt?1/vt:1/0,St=2*Math.sqrt(2-2*vt),fn=vt<og&&_e&&we,hn=Oe.x*Ve.y-Oe.y*Ve.x>0;if(fn&&it>F){const Tn=re.dist(_e);if(Tn>2*W){const Zn=re.sub(re.sub(_e)._mult(W/Tn)._round());this.updateDistance(_e,Zn),this.addCurrentVertex(Zn,Oe,0,0,te),_e=Zn}}const bn=_e&&we;let hi=bn?s:T?"butt":h;if(bn&&"round"===hi&&(Lt<y?hi="miter":Lt<=2&&(hi="fakeround")),"miter"===hi&&Lt>p&&(hi="bevel"),"bevel"===hi&&(Lt>2&&(hi="flipbevel"),Lt<p&&(hi="miter")),_e&&this.updateDistance(_e,re),"miter"===hi)bt._mult(Lt),this.addCurrentVertex(re,bt,0,0,te);else if("flipbevel"===hi){if(Lt>100)bt=Ve.mult(-1);else{const Tn=Lt*Oe.add(Ve).mag()/Oe.sub(Ve).mag();bt._perp()._mult(Tn*(hn?-1:1))}this.addCurrentVertex(re,bt,0,0,te),this.addCurrentVertex(re,bt.mult(-1),0,0,te)}else if("bevel"===hi||"fakeround"===hi){const Tn=-Math.sqrt(Lt*Lt-1),Zn=hn?Tn:0,Yn=hn?0:Tn;if(_e&&this.addCurrentVertex(re,Oe,Zn,Yn,te),"fakeround"===hi){const Gn=Math.round(180*St/Math.PI/20);for(let ci=1;ci<Gn;ci++){let Kn=ci/Gn;if(.5!==Kn){const so=Kn-.5;Kn+=Kn*so*(Kn-1)*((1.0904+rt*(rt*(3.55645-1.43519*rt)-3.2452))*so*so+(.848013+rt*(.215638*rt-1.06021)))}const Di=Ve.sub(Oe)._mult(Kn)._add(Oe)._unit()._mult(hn?-1:1);this.addHalfVertex(re,Di.x,Di.y,!1,hn,0,te)}}we&&this.addCurrentVertex(re,Ve,-Zn,-Yn,te)}else if("butt"===hi)this.addCurrentVertex(re,bt,0,0,te);else if("square"===hi){const Tn=_e?1:-1;_e||this.addCurrentVertex(re,bt,Tn,Tn,te),this.addCurrentVertex(re,bt,0,0,te),_e&&this.addCurrentVertex(re,bt,Tn,Tn,te)}else"round"===hi&&(_e&&(this.addCurrentVertex(re,Oe,0,0,te),this.addCurrentVertex(re,Oe,1,1,te,!0)),we&&(this.addCurrentVertex(re,Ve,-1,-1,te,!0),this.addCurrentVertex(re,Ve,0,0,te)));if(fn&&it<R-1){const Tn=re.dist(we);if(Tn>2*W){const Zn=re.add(we.sub(re)._mult(W/Tn)._round());this.updateDistance(re,Zn),this.addCurrentVertex(Zn,Ve,0,0,te),re=Zn}}}}addCurrentVertex(e,n,s,h,p,y=!1){const T=n.y*h-n.x,R=-n.y-n.x*h;this.addHalfVertex(e,n.x+n.y*s,n.y-n.x*s,y,!1,s,p),this.addHalfVertex(e,T,R,y,!0,-h,p)}addHalfVertex({x:e,y:n},s,h,p,y,T,R){this.layoutVertexArray.emplaceBack((e<<1)+(p?1:0),(n<<1)+(y?1:0),Math.round(63*s)+128,Math.round(63*h)+128,1+(0===T?0:T<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const F=R.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,F),R.primitiveLength++),y?this.e2=F:this.e1=F}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,n){this.distance+=e.dist(n),this.updateScaledDistance()}}Oi(lf,"LineBucket",{omit:["layers","patternFeatures"]});const im=new Ln({"line-cap":new Vt(qt.layout_line["line-cap"]),"line-join":new Vt(qt.layout_line["line-join"]),"line-miter-limit":new Ct(qt.layout_line["line-miter-limit"]),"line-round-limit":new Ct(qt.layout_line["line-round-limit"]),"line-sort-key":new Vt(qt.layout_line["line-sort-key"])});var cp={paint:new Ln({"line-opacity":new Vt(qt.paint_line["line-opacity"]),"line-color":new Vt(qt.paint_line["line-color"]),"line-translate":new Ct(qt.paint_line["line-translate"]),"line-translate-anchor":new Ct(qt.paint_line["line-translate-anchor"]),"line-width":new Vt(qt.paint_line["line-width"]),"line-gap-width":new Vt(qt.paint_line["line-gap-width"]),"line-offset":new Vt(qt.paint_line["line-offset"]),"line-blur":new Vt(qt.paint_line["line-blur"]),"line-dasharray":new sn(qt.paint_line["line-dasharray"]),"line-pattern":new sn(qt.paint_line["line-pattern"]),"line-gradient":new Xt(qt.paint_line["line-gradient"]),"line-trim-offset":new Ct(qt.paint_line["line-trim-offset"])}),layout:im};const rm=new class extends Vt{possiblyEvaluate(t,e){return e=new He(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),super.possiblyEvaluate(t,e)}evaluate(t,e,n,s){return e=se({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(t,e,n,s)}}(cp.paint.properties["line-width"].specification);function cf(t,e){return e>0?e+2*t:t}rm.useIntegerZoom=!0;const w_=Un([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),sg=Un([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Vy=Un([{name:"a_projected_pos",components:4,type:"Float32"}],4);Un([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const ag=Un([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),lg=Un([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Un([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const cg=Un([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),ug=Un([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Un([{name:"triangle",components:3,type:"Uint16"}]),Un([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Un([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Un([{type:"Float32",name:"offsetX"}]),Un([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const wu=128;function sc(t,e){const{expression:n}=e;if("constant"===n.kind)return{kind:"constant",layoutSize:n.evaluate(new He(t+1))};if("source"===n.kind)return{kind:"source"};{const{zoomStops:s,interpolationType:h}=n;let p=0;for(;p<s.length&&s[p]<=t;)p++;p=Math.max(0,p-1);let y=p;for(;y<s.length&&s[y]<t+1;)y++;y=Math.min(s.length-1,y);const T=s[p],R=s[y];return"composite"===n.kind?{kind:"composite",minZoom:T,maxZoom:R,interpolationType:h}:{kind:"camera",minZoom:T,maxZoom:R,minSize:n.evaluate(new He(T)),maxSize:n.evaluate(new He(R)),interpolationType:h}}}function up(t,{uSize:e,uSizeT:n},{lowerSize:s,upperSize:h}){return"source"===t.kind?s/wu:"composite"===t.kind?wn(s/wu,h/wu,n):e}function Td(t,e){let n=0,s=0;if("constant"===t.kind)s=t.layoutSize;else if("source"!==t.kind){const{interpolationType:h,minZoom:p,maxZoom:y}=t,T=h?kt(Go.interpolationFactor(h,e,p,y),0,1):0;"camera"===t.kind?s=wn(t.minSize,t.maxSize,T):n=T}return{uSizeT:n,uSize:s}}var jy=Object.freeze({__proto__:null,getSizeData:sc,evaluateSizeForFeature:up,evaluateSizeForZoom:Td,SIZE_PACK_FACTOR:wu});function Zy(t,e,n){return t.sections.forEach(s=>{s.text=function(h,p,y){const T=p.layout.get("text-transform").evaluate(y,{});return"uppercase"===T?h=h.toLocaleUpperCase():"lowercase"===T&&(h=h.toLocaleLowerCase()),Ge.applyArabicShaping&&(h=Ge.applyArabicShaping(h)),h}(s.text,e,n)}),t}const Ed={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};function Gy(t){return"\ufe36"===t||"\ufe48"===t||"\ufe38"===t||"\ufe44"===t||"\ufe42"===t||"\ufe3e"===t||"\ufe3c"===t||"\ufe3a"===t||"\ufe18"===t||"\ufe40"===t||"\ufe10"===t||"\ufe13"===t||"\ufe14"===t||"\uff40"===t||"\uffe3"===t||"\ufe11"===t||"\ufe12"===t}function T_(t){return"\ufe35"===t||"\ufe47"===t||"\ufe37"===t||"\ufe43"===t||"\ufe41"===t||"\ufe3d"===t||"\ufe3b"===t||"\ufe39"===t||"\ufe17"===t||"\ufe3f"===t}var hp=function(t,e,n,s,h){var p,y,T=8*h-s-1,R=(1<<T)-1,F=R>>1,W=-7,te=n?h-1:0,re=n?-1:1,_e=t[e+te];for(te+=re,p=_e&(1<<-W)-1,_e>>=-W,W+=T;W>0;p=256*p+t[e+te],te+=re,W-=8);for(y=p&(1<<-W)-1,p>>=-W,W+=s;W>0;y=256*y+t[e+te],te+=re,W-=8);if(0===p)p=1-F;else{if(p===R)return y?NaN:1/0*(_e?-1:1);y+=Math.pow(2,s),p-=F}return(_e?-1:1)*y*Math.pow(2,p-s)},om=function(t,e,n,s,h,p){var y,T,R,F=8*p-h-1,W=(1<<F)-1,te=W>>1,re=23===h?Math.pow(2,-24)-Math.pow(2,-77):0,_e=s?0:p-1,we=s?1:-1,Oe=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(T=isNaN(e)?1:0,y=W):(y=Math.floor(Math.log(e)/Math.LN2),e*(R=Math.pow(2,-y))<1&&(y--,R*=2),(e+=y+te>=1?re/R:re*Math.pow(2,1-te))*R>=2&&(y++,R/=2),y+te>=W?(T=0,y=W):y+te>=1?(T=(e*R-1)*Math.pow(2,h),y+=te):(T=e*Math.pow(2,te-1)*Math.pow(2,h),y=0));h>=8;t[n+_e]=255&T,_e+=we,T/=256,h-=8);for(y=y<<h|T,F+=h;F>0;t[n+_e]=255&y,_e+=we,y/=256,F-=8);t[n+_e-we]|=128*Oe},uf=Bs;function Bs(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}Bs.Varint=0,Bs.Fixed64=1,Bs.Bytes=2,Bs.Fixed32=5;var sm=4294967296,am=1/sm,hg="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function Tu(t){return t.type===Bs.Bytes?t.readVarint()+t.pos:t.pos+1}function dg(t,e,n){var s=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(s);for(var h=n.pos-1;h>=t;h--)n.buf[h+s]=n.buf[h]}function fg(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function pg(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function E_(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function Eu(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function lm(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function C_(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function D_(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function Hy(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function mg(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function dp(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function Dd(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function gg(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function cm(t,e,n){e.glyphs=[],1===t&&n.readMessage(S_,e)}function S_(t,e,n){if(3===t){const{id:s,bitmap:h,width:p,height:y,left:T,top:R,advance:F}=n.readMessage(A_,{});e.glyphs.push({id:s,bitmap:new _({width:p+6,height:y+6},h),metrics:{width:p,height:y,left:T,top:R,advance:F}})}else 4===t?e.ascender=n.readSVarint():5===t&&(e.descender=n.readSVarint())}function A_(t,e,n){1===t?e.id=n.readVarint():2===t?e.bitmap=n.readBytes():3===t?e.width=n.readVarint():4===t?e.height=n.readVarint():5===t?e.left=n.readSVarint():6===t?e.top=n.readSVarint():7===t&&(e.advance=n.readVarint())}function Sd(t){let e=0,n=0;for(const y of t)e+=y.w*y.h,n=Math.max(n,y.w);t.sort((y,T)=>T.h-y.h);const s=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),n),h:1/0}];let h=0,p=0;for(const y of t)for(let T=s.length-1;T>=0;T--){const R=s[T];if(!(y.w>R.w||y.h>R.h)){if(y.x=R.x,y.y=R.y,p=Math.max(p,y.y+y.h),h=Math.max(h,y.x+y.w),y.w===R.w&&y.h===R.h){const F=s.pop();T<s.length&&(s[T]=F)}else y.h===R.h?(R.x+=y.w,R.w-=y.w):y.w===R.w?(R.y+=y.h,R.h-=y.h):(s.push({x:R.x+y.w,y:R.y,w:R.w-y.w,h:y.h}),R.y+=y.h,R.h-=y.h);break}}return{w:h,h:p,fill:e/(h*p)||0}}Bs.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var s=this.readVarint(),h=s>>3,p=this.pos;this.type=7&s,t(h,e,this),this.pos===p&&this.skip(s)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=dp(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=gg(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=dp(this.buf,this.pos)+dp(this.buf,this.pos+4)*sm;return this.pos+=8,t},readSFixed64:function(){var t=dp(this.buf,this.pos)+gg(this.buf,this.pos+4)*sm;return this.pos+=8,t},readFloat:function(){var t=hp(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=hp(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,s=this.buf;return e=127&(n=s[this.pos++]),n<128?e:(e|=(127&(n=s[this.pos++]))<<7,n<128?e:(e|=(127&(n=s[this.pos++]))<<14,n<128?e:(e|=(127&(n=s[this.pos++]))<<21,n<128?e:function(h,p,y){var T,R,F=y.buf;if(T=(112&(R=F[y.pos++]))>>4,R<128||(T|=(127&(R=F[y.pos++]))<<3,R<128)||(T|=(127&(R=F[y.pos++]))<<10,R<128)||(T|=(127&(R=F[y.pos++]))<<17,R<128)||(T|=(127&(R=F[y.pos++]))<<24,R<128)||(T|=(1&(R=F[y.pos++]))<<31,R<128))return function Cd(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}(h,T,p);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=s[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&hg?hg.decode(this.buf.subarray(e,t)):function(n,s,h){for(var p="",y=s;y<h;){var T,R,F,W=n[y],te=null,re=W>239?4:W>223?3:W>191?2:1;if(y+re>h)break;1===re?W<128&&(te=W):2===re?128==(192&(T=n[y+1]))&&(te=(31&W)<<6|63&T)<=127&&(te=null):3===re?(R=n[y+2],128==(192&(T=n[y+1]))&&128==(192&R)&&((te=(15&W)<<12|(63&T)<<6|63&R)<=2047||te>=55296&&te<=57343)&&(te=null)):4===re&&(R=n[y+2],F=n[y+3],128==(192&(T=n[y+1]))&&128==(192&R)&&128==(192&F)&&((te=(15&W)<<18|(63&T)<<12|(63&R)<<6|63&F)<=65535||te>=1114112)&&(te=null)),null===te?(te=65533,re=1):te>65535&&(te-=65536,p+=String.fromCharCode(te>>>10&1023|55296),te=56320|1023&te),p+=String.fromCharCode(te),y+=re}return p}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==Bs.Bytes)return t.push(this.readVarint(e));var n=Tu(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==Bs.Bytes)return t.push(this.readSVarint());var e=Tu(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Bs.Bytes)return t.push(this.readBoolean());var e=Tu(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Bs.Bytes)return t.push(this.readFloat());var e=Tu(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Bs.Bytes)return t.push(this.readDouble());var e=Tu(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Bs.Bytes)return t.push(this.readFixed32());var e=Tu(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Bs.Bytes)return t.push(this.readSFixed32());var e=Tu(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Bs.Bytes)return t.push(this.readFixed64());var e=Tu(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Bs.Bytes)return t.push(this.readSFixed64());var e=Tu(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===Bs.Varint)for(;this.buf[this.pos++]>127;);else if(e===Bs.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Bs.Fixed32)this.pos+=4;else{if(e!==Bs.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Dd(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Dd(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Dd(this.buf,-1&t,this.pos),Dd(this.buf,Math.floor(t*am),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Dd(this.buf,-1&t,this.pos),Dd(this.buf,Math.floor(t*am),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(e,n){var s,h,p,T;if(e>=0?(s=e%4294967296|0,h=e/4294967296|0):(h=~(-e/4294967296),4294967295^(s=~(-e%4294967296))?s=s+1|0:(s=0,h=h+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");n.realloc(10),p=s,(T=n).buf[T.pos++]=127&p|128,p>>>=7,T.buf[T.pos++]=127&p|128,p>>>=7,T.buf[T.pos++]=127&p|128,p>>>=7,T.buf[T.pos++]=127&p|128,T.buf[T.pos]=127&(p>>>=7),function(p,y){var T=(7&p)<<4;y.buf[y.pos++]|=T|((p>>>=3)?128:0),p&&(y.buf[y.pos++]=127&p|((p>>>=7)?128:0),p&&(y.buf[y.pos++]=127&p|((p>>>=7)?128:0),p&&(y.buf[y.pos++]=127&p|((p>>>=7)?128:0),p&&(y.buf[y.pos++]=127&p|((p>>>=7)?128:0),p&&(y.buf[y.pos++]=127&p)))))}(h,n)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(s,h,p){for(var y,T,R=0;R<h.length;R++){if((y=h.charCodeAt(R))>55295&&y<57344){if(!T){y>56319||R+1===h.length?(s[p++]=239,s[p++]=191,s[p++]=189):T=y;continue}if(y<56320){s[p++]=239,s[p++]=191,s[p++]=189,T=y;continue}y=T-55296<<10|y-56320|65536,T=null}else T&&(s[p++]=239,s[p++]=191,s[p++]=189,T=null);y<128?s[p++]=y:(y<2048?s[p++]=y>>6|192:(y<65536?s[p++]=y>>12|224:(s[p++]=y>>18|240,s[p++]=y>>12&63|128),s[p++]=y>>6&63|128),s[p++]=63&y|128)}return p}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&dg(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),om(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),om(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var s=this.pos-n;s>=128&&dg(n,s,this),this.pos=n-1,this.writeVarint(s),this.pos+=s},writeMessage:function(t,e,n){this.writeTag(t,Bs.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,fg,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,pg,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,lm,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,E_,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,Eu,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,C_,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,D_,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,Hy,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,mg,e)},writeBytesField:function(t,e){this.writeTag(t,Bs.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,Bs.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,Bs.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,Bs.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,Bs.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,Bs.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,Bs.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,Bs.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,Bs.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,Bs.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};class hf{constructor(e,{pixelRatio:n,version:s,stretchX:h,stretchY:p,content:y}){this.paddedRect=e,this.pixelRatio=n,this.stretchX=h,this.stretchY=p,this.content=y,this.version=s}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class _g{constructor(e,n){const s={},h={};this.haveRenderCallbacks=[];const p=[];this.addImages(e,s,p),this.addImages(n,h,p);const{w:y,h:T}=Sd(p),R=new B({width:y||1,height:T||1});for(const F in e){const W=e[F],te=s[F].paddedRect;B.copy(W.data,R,{x:0,y:0},{x:te.x+1,y:te.y+1},W.data)}for(const F in n){const W=n[F],te=h[F].paddedRect,re=te.x+1,_e=te.y+1,we=W.data.width,Oe=W.data.height;B.copy(W.data,R,{x:0,y:0},{x:re,y:_e},W.data),B.copy(W.data,R,{x:0,y:Oe-1},{x:re,y:_e-1},{width:we,height:1}),B.copy(W.data,R,{x:0,y:0},{x:re,y:_e+Oe},{width:we,height:1}),B.copy(W.data,R,{x:we-1,y:0},{x:re-1,y:_e},{width:1,height:Oe}),B.copy(W.data,R,{x:0,y:0},{x:re+we,y:_e},{width:1,height:Oe})}this.image=R,this.iconPositions=s,this.patternPositions=h}addImages(e,n,s){for(const h in e){const p=e[h],y={x:0,y:0,w:p.data.width+2,h:p.data.height+2};s.push(y),n[h]=new hf(y,p),p.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(e,n){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(s=>e.hasImage(s)),e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const s in e.updatedImages)this.patchUpdatedImage(this.iconPositions[s],e.getImage(s),n),this.patchUpdatedImage(this.patternPositions[s],e.getImage(s),n)}patchUpdatedImage(e,n,s){if(!e||!n||e.version===n.version)return;e.version=n.version;const[h,p]=e.tl;s.update(n.data,void 0,{x:h,y:p})}}Oi(hf,"ImagePosition"),Oi(_g,"ImageAtlas");const ac={horizontal:1,vertical:2,horizontalOnly:3};class Fh{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,n){const s=new Fh;return s.scale=e||1,s.fontStack=n,s}static forImage(e){const n=new Fh;return n.imageName=e,n}}class Bh{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,n){const s=new Bh;for(let h=0;h<e.sections.length;h++){const p=e.sections[h];p.image?s.addImageSection(p):s.addTextSection(p,n)}return s}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=function(n,s){let h="";for(let p=0;p<n.length;p++){const y=n.charCodeAt(p+1)||null,T=n.charCodeAt(p-1)||null;h+=!s&&(y&&hu(y)&&!Ed[n[p+1]]||T&&hu(T)&&!Ed[n[p-1]])||!Ed[n[p]]?n[p]:Ed[n[p]]}return h}(this.text,e)}trim(){let e=0;for(let s=0;s<this.text.length&&fp[this.text.charCodeAt(s)];s++)e++;let n=this.text.length;for(let s=this.text.length-1;s>=0&&s>=e&&fp[this.text.charCodeAt(s)];s--)n--;this.text=this.text.substring(e,n),this.sectionIndex=this.sectionIndex.slice(e,n)}substring(e,n){const s=new Bh;return s.text=this.text.substring(e,n),s.sectionIndex=this.sectionIndex.slice(e,n),s.sections=this.sections,s}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,n)=>Math.max(e,this.sections[n].scale),0)}addTextSection(e,n){this.text+=e.text,this.sections.push(Fh.forText(e.scale,e.fontStack||n));const s=this.sections.length-1;for(let h=0;h<e.text.length;++h)this.sectionIndex.push(s)}addImageSection(e){const n=e.image?e.image.name:"";if(0===n.length)return void Mi("Can't add FormattedSection with an empty image.");const s=this.getNextImageSectionCharCode();s?(this.text+=String.fromCharCode(s),this.sections.push(Fh.forImage(n)),this.sectionIndex.push(this.sections.length-1)):Mi("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function um(t,e,n,s,h,p,y,T,R,F,W,te,re,_e,we,Oe){const Ve=Bh.fromFeature(t,h);let it;te===ac.vertical&&Ve.verticalizePunctuation(re);const{processBidirectionalText:bt,processStyledBidirectionalText:rt}=Ge;if(bt&&1===Ve.sections.length){it=[];const St=bt(Ve.toString(),pp(Ve,F,p,e,s,_e,we));for(const fn of St){const hn=new Bh;hn.text=fn,hn.sections=Ve.sections;for(let bn=0;bn<fn.length;bn++)hn.sectionIndex.push(0);it.push(hn)}}else if(rt){it=[];const St=rt(Ve.text,Ve.sectionIndex,pp(Ve,F,p,e,s,_e,we));for(const fn of St){const hn=new Bh;hn.text=fn[0],hn.sectionIndex=fn[1],hn.sections=Ve.sections,it.push(hn)}}else it=function(St,fn){const hn=[],bn=St.text;let hi=0;for(const Tn of fn)hn.push(St.substring(hi,Tn)),hi=Tn;return hi<bn.length&&hn.push(St.substring(hi,bn.length)),hn}(Ve,pp(Ve,F,p,e,s,_e,we));const vt=[],Lt={positionedLines:vt,text:Ve.toString(),top:W[1],bottom:W[1],left:W[0],right:W[0],writingMode:te,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(St,fn,hn,bn,hi,Tn,Zn,Yn,Gn,ci,Kn,Di){let so=0,ho=0,wr=0;const Ei="right"===Yn?1:"left"===Yn?0:.5;let Co=!1;for(const go of hi){const _o=go.getSections();for(const Bo of _o){if(Bo.imageName)continue;const ko=fn[Bo.fontStack];if(ko&&(Co=void 0!==ko.ascender&&void 0!==ko.descender,!Co))break}if(!Co)break}let Xr=0;for(const go of hi){go.trim();const _o=go.getMaxScale(),Bo=24*(_o-1),ko={positionedGlyphs:[],lineOffset:0};St.positionedLines[Xr]=ko;const ys=ko.positionedGlyphs;let $s=0;if(!go.length()){ho+=Tn,++Xr;continue}let ga=0,Ml=0;for(let zo=0;zo<go.length();zo++){const _a=go.getSection(zo),ll=go.getSectionIndex(zo),is=go.getCharCode(zo);let aa=_a.scale,Ql=null,Js=null,Ra=null,tl=24,gl=0;const Il=!(Gn===ac.horizontal||!Kn&&!Pu(is)||Kn&&(fp[is]||(zi=is,hc(zi)||_h(zi)||Du(zi)||Au(zi)||uu(zi))));if(_a.imageName){const Wl=bn[_a.imageName];if(!Wl)continue;Ra=_a.imageName,St.iconsInText=St.iconsInText||!0,Js=Wl.paddedRect;const cl=Wl.displaySize;aa=24*aa/Di,Ql={width:cl[0],height:cl[1],left:1,top:-3,advance:Il?cl[1]:cl[0],localGlyph:!1},gl=Co?-Ql.height*aa:24*_o-17-cl[1]*aa,tl=Ql.advance;const Wc=(Il?cl[0]:cl[1])*aa-24*_o;Wc>0&&Wc>$s&&($s=Wc)}else{const Wl=hn[_a.fontStack];if(!Wl)continue;Wl[is]&&(Js=Wl[is]);const cl=fn[_a.fontStack];if(!cl)continue;const Wc=cl.glyphs[is];if(!Wc)continue;if(Ql=Wc.metrics,tl=8203!==is?24:0,Co){const Yh=void 0!==cl.ascender?Math.abs(cl.ascender):0,zd=void 0!==cl.descender?Math.abs(cl.descender):0,Ud=(Yh+zd)*aa;ga<Ud&&(ga=Ud,Ml=(Yh-zd)/2*aa),gl=-Yh*aa}else gl=24*(_o-aa)-17}Il?(St.verticalizable=!0,ys.push({glyph:is,imageName:Ra,x:so,y:ho+gl,vertical:Il,scale:aa,localGlyph:Ql.localGlyph,fontStack:_a.fontStack,sectionIndex:ll,metrics:Ql,rect:Js}),so+=tl*aa+ci):(ys.push({glyph:is,imageName:Ra,x:so,y:ho+gl,vertical:Il,scale:aa,localGlyph:Ql.localGlyph,fontStack:_a.fontStack,sectionIndex:ll,metrics:Ql,rect:Js}),so+=Ql.advance*aa+ci)}0!==ys.length&&(wr=Math.max(so-ci,wr),Co?Cu(ys,Ei,$s,Ml,Tn*_o/2):Cu(ys,Ei,$s,0,Tn/2)),so=0;const cc=Tn*_o+$s;ko.lineOffset=Math.max($s,Bo),ho+=cc,++Xr}var zi;const Cs=ho,{horizontalAlign:Fo,verticalAlign:sa}=mp(Zn);(function(go,_o,Bo,ko,ys,$s){const ga=(_o-Bo)*ys,Ml=-$s*ko;for(const cc of go)for(const zo of cc.positionedGlyphs)zo.x+=ga,zo.y+=Ml})(St.positionedLines,Ei,Fo,sa,wr,Cs),St.top+=-sa*Cs,St.bottom=St.top+Cs,St.left+=-Fo*wr,St.right=St.left+wr,St.hasBaseline=Co}(Lt,e,n,s,it,y,T,R,te,F,re,Oe),!function(St){for(const fn of St)if(0!==fn.positionedGlyphs.length)return!1;return!0}(vt)&&Lt}const fp={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},hm={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function M_(t,e,n,s,h,p){if(e.imageName){const y=s[e.imageName];return y?y.displaySize[0]*e.scale*24/p+h:0}{const y=n[e.fontStack],T=y&&y.glyphs[t];return T?T.metrics.advance*e.scale+h:0}}function yg(t,e,n,s){const h=Math.pow(t-e,2);return s?t<e?h/2:2*h:h+Math.abs(n)*n}function vg(t,e,n){let s=0;return 10===t&&(s-=1e4),n&&(s+=150),40!==t&&65288!==t||(s+=50),41!==e&&65289!==e||(s+=50),s}function dm(t,e,n,s,h,p){let y=null,T=yg(e,n,h,p);for(const R of s){const F=yg(e-R.x,n,h,p)+R.badness;F<=T&&(y=R,T=F)}return{index:t,x:e,priorBreak:y,badness:T}}function fm(t){return t?fm(t.priorBreak).concat(t.index):[]}function pp(t,e,n,s,h,p,y){if("point"!==p)return[];if(!t)return[];const T=[],R=function(re,_e,we,Oe,Ve,it){let bt=0;for(let rt=0;rt<re.length();rt++){const vt=re.getSection(rt);bt+=M_(re.getCharCode(rt),vt,Oe,Ve,_e,it)}return bt/Math.max(1,Math.ceil(bt/we))}(t,e,n,s,h,y),F=t.text.indexOf("\u200b")>=0;let W=0;for(let re=0;re<t.length();re++){const _e=t.getSection(re),we=t.getCharCode(re);if(fp[we]||(W+=M_(we,_e,s,h,e,y)),re<t.length()-1){const Oe=!((te=we)<11904||!(ec(te)||Ys(te)||Mu(te)||yh(te)||Zl(te)||Jh(te)||Ku(te)||Ga(te)||Gl(te)||Ll(te)||Dl(te)||bc(te)||vc(te)||cu(te)||Qh(te)||Xu(te)||Hs(te)||ed(te)||Su(te)||tc(te)));(hm[we]||Oe||_e.imageName)&&T.push(dm(re+1,W,R,T,vg(we,t.getCharCode(re+1),Oe&&F),!1))}}var te;return fm(dm(t.length(),W,R,T,0,!0))}function mp(t){let e=.5,n=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function Cu(t,e,n,s,h){if(!(e||n||s||h))return;const p=t.length-1,y=t[p],T=(y.x+y.metrics.advance*y.scale)*e;for(let R=0;R<=p;R++)t[R].x-=T,t[R].y+=n+s+h}function gp(t,e,n){const{horizontalAlign:s,verticalAlign:h}=mp(n),p=e[0]-t.displaySize[0]*s,y=e[1]-t.displaySize[1]*h;return{image:t,top:y,bottom:y+t.displaySize[1],left:p,right:p+t.displaySize[0]}}function bg(t,e,n,s,h,p){const y=t.image;let T;if(y.content){const Ve=y.content,it=y.pixelRatio||1;T=[Ve[0]/it,Ve[1]/it,y.displaySize[0]-Ve[2]/it,y.displaySize[1]-Ve[3]/it]}const R=e.left*p,F=e.right*p;let W,te,re,_e;"width"===n||"both"===n?(_e=h[0]+R-s[3],te=h[0]+F+s[1]):(_e=h[0]+(R+F-y.displaySize[0])/2,te=_e+y.displaySize[0]);const we=e.top*p,Oe=e.bottom*p;return"height"===n||"both"===n?(W=h[1]+we-s[0],re=h[1]+Oe+s[2]):(W=h[1]+(we+Oe-y.displaySize[1])/2,re=W+y.displaySize[1]),{image:y,top:W,right:te,bottom:re,left:_e,collisionPadding:T}}class ju extends Ke{constructor(e,n,s,h,p){super(e,n),this.angle=h,this.z=s,void 0!==p&&(this.segment=p)}clone(){return new ju(this.x,this.y,this.z,this.angle,this.segment)}}function I_(t,e,n,s,h){if(void 0===e.segment)return!0;let p=e,y=e.segment+1,T=0;for(;T>-n/2;){if(y--,y<0)return!1;T-=t[y].dist(p),p=t[y]}T+=t[y].dist(t[y+1]),y++;const R=[];let F=0;for(;T<n/2;){const W=t[y],te=t[y+1];if(!te)return!1;let re=t[y-1].angleTo(W)-W.angleTo(te);for(re=Math.abs((re+3*Math.PI)%(2*Math.PI)-Math.PI),R.push({distance:T,angleDelta:re}),F+=re;T-R[0].distance>s;)F-=R.shift().angleDelta;if(F>h)return!1;y++,T+=W.dist(te)}return!0}function _p(t){let e=0;for(let n=0;n<t.length-1;n++)e+=t[n].dist(t[n+1]);return e}function pm(t,e,n){return t?.6*e*n:0}function yp(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function df(t,e,n,s,h,p){const y=pm(n,h,p),T=yp(n,s)*p;let R=0;const F=_p(t)/2;for(let W=0;W<t.length-1;W++){const te=t[W],re=t[W+1],_e=te.dist(re);if(R+_e>F){const we=(F-R)/_e,Oe=wn(te.x,re.x,we),Ve=wn(te.y,re.y,we),it=new ju(Oe,Ve,0,re.angleTo(te),W);return!y||I_(t,it,T,y,e)?it:void 0}R+=_e}}function P_(t,e,n,s,h,p,y,T,R){const F=pm(s,p,y),W=yp(s,h),te=W*y,re=0===t[0].x||t[0].x===R||0===t[0].y||t[0].y===R;return e-te<e/4&&(e=te+e/4),vp(t,re?e/2*T%e:(W/2+2*p)*y*T%e,e,F,n,te,re,!1,R)}function vp(t,e,n,s,h,p,y,T,R){const F=p/2,W=_p(t);let te=0,re=e-n,_e=[];for(let we=0;we<t.length-1;we++){const Oe=t[we],Ve=t[we+1],it=Oe.dist(Ve),bt=Ve.angleTo(Oe);for(;re+n<te+it;){re+=n;const rt=(re-te)/it,vt=wn(Oe.x,Ve.x,rt),Lt=wn(Oe.y,Ve.y,rt);if(vt>=0&&vt<R&&Lt>=0&&Lt<R&&re-F>=0&&re+F<=W){const St=new ju(vt,Lt,0,bt,we);St._round(),s&&!I_(t,St,p,s,h)||_e.push(St)}}te+=it}return T||_e.length||y||(_e=vp(t,te/2,n,s,h,p,y,!0,R)),_e}function mm(t,e,n,s,h){const p=[];for(let y=0;y<t.length;y++){const T=t[y];let R;for(let F=0;F<T.length-1;F++){let W=T[F],te=T[F+1];W.x<e&&te.x<e||(W.x<e?W=new Ke(e,W.y+(e-W.x)/(te.x-W.x)*(te.y-W.y))._round():te.x<e&&(te=new Ke(e,W.y+(e-W.x)/(te.x-W.x)*(te.y-W.y))._round()),W.y<n&&te.y<n||(W.y<n?W=new Ke(W.x+(n-W.y)/(te.y-W.y)*(te.x-W.x),n)._round():te.y<n&&(te=new Ke(W.x+(n-W.y)/(te.y-W.y)*(te.x-W.x),n)._round()),W.x>=s&&te.x>=s||(W.x>=s?W=new Ke(s,W.y+(s-W.x)/(te.x-W.x)*(te.y-W.y))._round():te.x>=s&&(te=new Ke(s,W.y+(s-W.x)/(te.x-W.x)*(te.y-W.y))._round()),W.y>=h&&te.y>=h||(W.y>=h?W=new Ke(W.x+(h-W.y)/(te.y-W.y)*(te.x-W.x),h)._round():te.y>=h&&(te=new Ke(W.x+(h-W.y)/(te.y-W.y)*(te.x-W.x),h)._round()),R&&W.equals(R[R.length-1])||(R=[W],p.push(R)),R.push(te)))))}}return p}Oi(ju,"Anchor");const Ad=1e20;function gm(t,e,n,s,h,p,y,T,R){for(let F=e;F<e+s;F++)xg(t,n*p+F,p,h,y,T,R);for(let F=n;F<n+h;F++)xg(t,F*p+e,1,s,y,T,R)}function xg(t,e,n,s,h,p,y){p[0]=0,y[0]=-Ad,y[1]=Ad,h[0]=t[e];for(let T=1,R=0,F=0;T<s;T++){h[T]=t[e+T*n];const W=T*T;do{const te=p[R];F=(h[T]-h[te]+W-te*te)/(T-te)/2}while(F<=y[R]&&--R>-1);R++,p[R]=T,y[R]=F,y[R+1]=Ad}for(let T=0,R=0;T<s;T++){for(;y[R+1]<T;)R++;const F=p[R],W=T-F;t[e+T*n]=h[F]+W*W}}const ff={none:0,ideographs:1,all:2};class Md{constructor(e,n,s){this.requestManager=e,this.localGlyphMode=n,this.localFontFamily=s,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,n){const s=[];for(const h in e)for(const p of e[h])s.push({stack:h,id:p});on(s,({stack:h,id:p},y)=>{let T=this.entries[h];T||(T=this.entries[h]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let R=T.glyphs[p];if(void 0!==R)return void y(null,{stack:h,id:p,glyph:R});if(R=this._tinySDF(T,h,p),R)return T.glyphs[p]=R,void y(null,{stack:h,id:p,glyph:R});const F=Math.floor(p/256);if(256*F>65535)return void y(new Error("glyphs > 65535 not supported"));if(T.ranges[F])return void y(null,{stack:h,id:p,glyph:R});let W=T.requests[F];W||(W=T.requests[F]=[],Md.loadGlyphRange(h,F,this.url,this.requestManager,(te,re)=>{if(re){T.ascender=re.ascender,T.descender=re.descender;for(const _e in re.glyphs)this._doesCharSupportLocalGlyph(+_e)||(T.glyphs[+_e]=re.glyphs[+_e]);T.ranges[F]=!0}for(const _e of W)_e(te,re);delete T.requests[F]})),W.push((te,re)=>{te?y(te):re&&y(null,{stack:h,id:p,glyph:re.glyphs[p]||null})})},(h,p)=>{if(h)n(h);else if(p){const y={};for(const{stack:T,id:R,glyph:F}of p)void 0===y[T]&&(y[T]={}),void 0===y[T].glyphs&&(y[T].glyphs={}),y[T].glyphs[R]=F&&{id:F.id,bitmap:F.bitmap.clone(),metrics:F.metrics},y[T].ascender=this.entries[T].ascender,y[T].descender=this.entries[T].descender;n(null,y)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==ff.none&&(this.localGlyphMode===ff.all?!!this.localFontFamily:!!this.localFontFamily&&(Ll(e)||na(e)||vc(e)||Hs(e)||Ga(e)))}_tinySDF(e,n,s){const h=this.localFontFamily;if(!h||!this._doesCharSupportLocalGlyph(s))return;let p=e.tinySDF;if(!p){let Oe="400";/bold/i.test(n)?Oe="900":/medium/i.test(n)?Oe="500":/light/i.test(n)&&(Oe="200"),p=e.tinySDF=new Md.TinySDF({fontFamily:h,fontWeight:Oe,fontSize:48,buffer:6,radius:16}),p.fontWeight=Oe}if(this.localGlyphs[p.fontWeight][s])return this.localGlyphs[p.fontWeight][s];const y=String.fromCharCode(s),{data:T,width:R,height:F,glyphWidth:W,glyphHeight:te,glyphLeft:re,glyphTop:_e,glyphAdvance:we}=p.draw(y);return this.localGlyphs[p.fontWeight][s]={id:s,bitmap:new _({width:R,height:F},T),metrics:{width:W/2,height:te/2,left:re/2,top:_e/2-27,advance:we/2,localGlyph:!0}}}}function wg(t,e,n,s){const h=[],p=t.image,y=p.pixelRatio,T=p.paddedRect.w-2,R=p.paddedRect.h-2,F=t.right-t.left,W=t.bottom-t.top,te=p.stretchX||[[0,T]],re=p.stretchY||[[0,R]],_e=(Tn,Zn)=>Tn+Zn[1]-Zn[0],we=te.reduce(_e,0),Oe=re.reduce(_e,0),Ve=T-we,it=R-Oe;let bt=0,rt=we,vt=0,Lt=Oe,St=0,fn=Ve,hn=0,bn=it;if(p.content&&s){const Tn=p.content;bt=pf(te,0,Tn[0]),vt=pf(re,0,Tn[1]),rt=pf(te,Tn[0],Tn[2]),Lt=pf(re,Tn[1],Tn[3]),St=Tn[0]-bt,hn=Tn[1]-vt,fn=Tn[2]-Tn[0]-rt,bn=Tn[3]-Tn[1]-Lt}const hi=(Tn,Zn,Yn,Gn)=>{const ci=mf(Tn.stretch-bt,rt,F,t.left),Kn=bp(Tn.fixed-St,fn,Tn.stretch,we),Di=mf(Zn.stretch-vt,Lt,W,t.top),so=bp(Zn.fixed-hn,bn,Zn.stretch,Oe),ho=mf(Yn.stretch-bt,rt,F,t.left),wr=bp(Yn.fixed-St,fn,Yn.stretch,we),Ei=mf(Gn.stretch-vt,Lt,W,t.top),Co=bp(Gn.fixed-hn,bn,Gn.stretch,Oe),Xr=new Ke(ci,Di),zi=new Ke(ho,Di),Cs=new Ke(ho,Ei),Fo=new Ke(ci,Ei),sa=new Ke(Kn/y,so/y),go=new Ke(wr/y,Co/y),_o=e*Math.PI/180;if(_o){const ys=Math.sin(_o),$s=Math.cos(_o),ga=[$s,-ys,ys,$s];Xr._matMult(ga),zi._matMult(ga),Fo._matMult(ga),Cs._matMult(ga)}const Bo=Tn.stretch+Tn.fixed,ko=Zn.stretch+Zn.fixed;return{tl:Xr,tr:zi,bl:Fo,br:Cs,tex:{x:p.paddedRect.x+1+Bo,y:p.paddedRect.y+1+ko,w:Yn.stretch+Yn.fixed-Bo,h:Gn.stretch+Gn.fixed-ko},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:sa,pixelOffsetBR:go,minFontScaleX:fn/y/F,minFontScaleY:bn/y/W,isSDF:n}};if(s&&(p.stretchX||p.stretchY)){const Tn=zh(te,Ve,we),Zn=zh(re,it,Oe);for(let Yn=0;Yn<Tn.length-1;Yn++){const Gn=Tn[Yn],ci=Tn[Yn+1];for(let Kn=0;Kn<Zn.length-1;Kn++)h.push(hi(Gn,Zn[Kn],ci,Zn[Kn+1]))}}else h.push(hi({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:T+1},{fixed:0,stretch:R+1}));return h}function pf(t,e,n){let s=0;for(const h of t)s+=Math.max(e,Math.min(n,h[1]))-Math.max(e,Math.min(n,h[0]));return s}function zh(t,e,n){const s=[{fixed:-1,stretch:0}];for(const[h,p]of t){const y=s[s.length-1];s.push({fixed:h-y.stretch,stretch:y.stretch}),s.push({fixed:h-y.stretch,stretch:y.stretch+(p-h)})}return s.push({fixed:e+1,stretch:n}),s}function mf(t,e,n,s){return t/e*n+s}function bp(t,e,n,s){return t-e*n/s}function O_(t,e,n,s){const h=e+t.positionedLines[s].lineOffset;return 0===s?n+h/2:n+(h+(e+t.positionedLines[s-1].lineOffset))/2}Md.loadGlyphRange=function(t,e,n,s,h){const p=256*e,y=p+255,T=s.transformRequest(s.normalizeGlyphsURL(n).replace("{fontstack}",t).replace("{range}",`${p}-${y}`),xt.Glyphs);Kt(T,(R,F)=>{if(R)h(R);else if(F){const W={},te=new uf(F).readFields(cm,{});for(const re of te.glyphs)W[re.id]=re;h(null,{glyphs:W,ascender:te.ascender,descender:te.descender})}})},Md.TinySDF=class{constructor({fontSize:t=24,buffer:e=3,radius:n=8,cutoff:s=.25,fontFamily:h="sans-serif",fontWeight:p="normal",fontStyle:y="normal"}={}){this.buffer=e,this.cutoff=s,this.radius=n;const T=this.size=t+4*e,R=this._createCanvas(T),F=this.ctx=R.getContext("2d",{willReadFrequently:!0});F.font=`${y} ${p} ${t}px ${h}`,F.textBaseline="alphabetic",F.textAlign="left",F.fillStyle="black",this.gridOuter=new Float64Array(T*T),this.gridInner=new Float64Array(T*T),this.f=new Float64Array(T),this.z=new Float64Array(T+1),this.v=new Uint16Array(T)}_createCanvas(t){const e=document.createElement("canvas");return e.width=e.height=t,e}draw(t){const{width:e,actualBoundingBoxAscent:n,actualBoundingBoxDescent:s,actualBoundingBoxLeft:h,actualBoundingBoxRight:p}=this.ctx.measureText(t),y=Math.ceil(n),T=Math.min(this.size-this.buffer,Math.ceil(p-h)),R=Math.min(this.size-this.buffer,y+Math.ceil(s)),F=T+2*this.buffer,W=R+2*this.buffer,te=Math.max(F*W,0),re=new Uint8ClampedArray(te),_e={data:re,width:F,height:W,glyphWidth:T,glyphHeight:R,glyphTop:y,glyphLeft:0,glyphAdvance:e};if(0===T||0===R)return _e;const{ctx:we,buffer:Oe,gridInner:Ve,gridOuter:it}=this;we.clearRect(Oe,Oe,T,R),we.fillText(t,Oe,Oe+y);const bt=we.getImageData(Oe,Oe,T,R);it.fill(Ad,0,te),Ve.fill(0,0,te);for(let rt=0;rt<R;rt++)for(let vt=0;vt<T;vt++){const Lt=bt.data[4*(rt*T+vt)+3]/255;if(0===Lt)continue;const St=(rt+Oe)*F+vt+Oe;if(1===Lt)it[St]=0,Ve[St]=Ad;else{const fn=.5-Lt;it[St]=fn>0?fn*fn:0,Ve[St]=fn<0?fn*fn:0}}gm(it,0,0,F,W,F,this.f,this.v,this.z),gm(Ve,Oe,Oe,T,R,F,this.f,this.v,this.z);for(let rt=0;rt<te;rt++){const vt=Math.sqrt(it[rt])-Math.sqrt(Ve[rt]);re[rt]=Math.round(255-255*(vt/this.radius+this.cutoff))}return _e}};class Id{constructor(e=[],n=R_){if(this.data=e,this.length=this.data.length,this.compare=n,this.length>0)for(let s=(this.length>>1)-1;s>=0;s--)this._down(s)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const e=this.data[0],n=this.data.pop();return this.length--,this.length>0&&(this.data[0]=n,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:n,compare:s}=this,h=n[e];for(;e>0;){const p=e-1>>1,y=n[p];if(s(h,y)>=0)break;n[e]=y,e=p}n[e]=h}_down(e){const{data:n,compare:s}=this,h=this.length>>1,p=n[e];for(;e<h;){let y=1+(e<<1),T=n[y];const R=y+1;if(R<this.length&&s(n[R],T)<0&&(y=R,T=n[R]),s(T,p)>=0)break;n[e]=T,e=y}n[e]=p}}function R_(t,e){return t<e?-1:t>e?1:0}function k_(t,e=1,n=!1){let s=1/0,h=1/0,p=-1/0,y=-1/0;const T=t[0];for(let _e=0;_e<T.length;_e++){const we=T[_e];(!_e||we.x<s)&&(s=we.x),(!_e||we.y<h)&&(h=we.y),(!_e||we.x>p)&&(p=we.x),(!_e||we.y>y)&&(y=we.y)}const R=Math.min(p-s,y-h);let F=R/2;const W=new Id([],N_);if(0===R)return new Ke(s,h);for(let _e=s;_e<p;_e+=R)for(let we=h;we<y;we+=R)W.push(new Pd(_e+F,we+F,F,t));let te=function(_e){let we=0,Oe=0,Ve=0;const it=_e[0];for(let bt=0,rt=it.length,vt=rt-1;bt<rt;vt=bt++){const Lt=it[bt],St=it[vt],fn=Lt.x*St.y-St.x*Lt.y;Oe+=(Lt.x+St.x)*fn,Ve+=(Lt.y+St.y)*fn,we+=3*fn}return new Pd(Oe/we,Ve/we,0,_e)}(t),re=W.length;for(;W.length;){const _e=W.pop();(_e.d>te.d||!te.d)&&(te=_e,n&&console.log("found best %d after %d probes",Math.round(1e4*_e.d)/1e4,re)),_e.max-te.d<=e||(F=_e.h/2,W.push(new Pd(_e.p.x-F,_e.p.y-F,F,t)),W.push(new Pd(_e.p.x+F,_e.p.y-F,F,t)),W.push(new Pd(_e.p.x-F,_e.p.y+F,F,t)),W.push(new Pd(_e.p.x+F,_e.p.y+F,F,t)),re+=4)}return n&&(console.log(`num probes: ${re}`),console.log(`best distance: ${te.d}`)),te.p}function N_(t,e){return e.max-t.max}function Pd(t,e,n,s){this.p=new Ke(t,e),this.h=n,this.d=function(h,p){let y=!1,T=1/0;for(let R=0;R<p.length;R++){const F=p[R];for(let W=0,te=F.length,re=te-1;W<te;re=W++){const _e=F[W],we=F[re];_e.y>h.y!=we.y>h.y&&h.x<(we.x-_e.x)*(h.y-_e.y)/(we.y-_e.y)+_e.x&&(y=!y),T=Math.min(T,Gf(h,_e,we))}}return(y?1:-1)*Math.sqrt(T)}(this.p,s),this.max=this.d+this.h*Math.SQRT2}const Dc=Number.POSITIVE_INFINITY,_m=Math.sqrt(2);function ym(t,e){return e[1]!==Dc?function(n,s,h){let p=0,y=0;switch(s=Math.abs(s),h=Math.abs(h),n){case"top-right":case"top-left":case"top":y=h-7;break;case"bottom-right":case"bottom-left":case"bottom":y=7-h}switch(n){case"top-right":case"bottom-right":case"right":p=-s;break;case"top-left":case"bottom-left":case"left":p=s}return[p,y]}(t,e[0],e[1]):function(n,s){let h=0,p=0;s<0&&(s=0);const y=s/_m;switch(n){case"top-right":case"top-left":p=y-7;break;case"bottom-right":case"bottom-left":p=7-y;break;case"bottom":p=7-s;break;case"top":p=s-7}switch(n){case"top-right":case"bottom-right":h=-y;break;case"top-left":case"bottom-left":h=y;break;case"left":h=s;break;case"right":h=-s}return[h,p]}(t,e[0])}function Tg(t,e,n,s,h,p,y,T,R,F){t.createArrays(),t.tilePixelRatio=Fr/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;const W=t.layers[0].layout,te=t.layers[0]._unevaluatedLayout._values,re={};if("composite"===t.textSizeData.kind){const{minZoom:Oe,maxZoom:Ve}=t.textSizeData;re.compositeTextSizes=[te["text-size"].possiblyEvaluate(new He(Oe),T),te["text-size"].possiblyEvaluate(new He(Ve),T)]}if("composite"===t.iconSizeData.kind){const{minZoom:Oe,maxZoom:Ve}=t.iconSizeData;re.compositeIconSizes=[te["icon-size"].possiblyEvaluate(new He(Oe),T),te["icon-size"].possiblyEvaluate(new He(Ve),T)]}re.layoutTextSize=te["text-size"].possiblyEvaluate(new He(R+1),T),re.layoutIconSize=te["icon-size"].possiblyEvaluate(new He(R+1),T),re.textMaxSize=te["text-size"].possiblyEvaluate(new He(18),T);const _e="map"===W.get("text-rotation-alignment")&&"point"!==W.get("symbol-placement"),we=W.get("text-size");for(const Oe of t.features){const Ve=W.get("text-font").evaluate(Oe,{},T).join(","),it=we.evaluate(Oe,{},T),bt=re.layoutTextSize.evaluate(Oe,{},T),rt=(re.layoutIconSize.evaluate(Oe,{},T),{horizontal:{},vertical:void 0}),vt=Oe.text;let Lt,St=[0,0];if(vt){const bn=vt.toString(),hi=24*W.get("text-letter-spacing").evaluate(Oe,{},T),Tn=24*W.get("text-line-height").evaluate(Oe,{},T),Zn=vh(bn)?hi:0,Yn=W.get("text-anchor").evaluate(Oe,{},T),Gn=W.get("text-variable-anchor");if(!Gn){const wr=W.get("text-radial-offset").evaluate(Oe,{},T);St=wr?ym(Yn,[24*wr,Dc]):W.get("text-offset").evaluate(Oe,{},T).map(Ei=>24*Ei)}let ci=_e?"center":W.get("text-justify").evaluate(Oe,{},T);const Kn=W.get("symbol-placement"),Di="point"===Kn,so="point"===Kn?24*W.get("text-max-width").evaluate(Oe,{},T):0,ho=wr=>{t.allowVerticalPlacement&&Iu(bn)&&(rt.vertical=um(vt,e,n,h,Ve,so,Tn,Yn,wr,Zn,St,ac.vertical,!0,Kn,bt,it))};if(!_e&&Gn){const wr="auto"===ci?Gn.map(Co=>xp(Co)):[ci];let Ei=!1;for(let Co=0;Co<wr.length;Co++){const Xr=wr[Co];if(!rt.horizontal[Xr])if(Ei)rt.horizontal[Xr]=rt.horizontal[0];else{const zi=um(vt,e,n,h,Ve,so,Tn,"center",Xr,Zn,St,ac.horizontal,!1,Kn,bt,it);zi&&(rt.horizontal[Xr]=zi,Ei=1===zi.positionedLines.length)}}ho("left")}else{if("auto"===ci&&(ci=xp(Yn)),Di||W.get("text-writing-mode").indexOf("horizontal")>=0||!Iu(bn)){const wr=um(vt,e,n,h,Ve,so,Tn,Yn,ci,Zn,St,ac.horizontal,!1,Kn,bt,it);wr&&(rt.horizontal[ci]=wr)}ho("point"===Kn?"left":ci)}}let fn=!1;if(Oe.icon&&Oe.icon.name){const bn=s[Oe.icon.name];bn&&(Lt=gp(h[Oe.icon.name],W.get("icon-offset").evaluate(Oe,{},T),W.get("icon-anchor").evaluate(Oe,{},T)),fn=bn.sdf,void 0===t.sdfIcons?t.sdfIcons=bn.sdf:t.sdfIcons!==bn.sdf&&Mi("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(bn.pixelRatio!==t.pixelRatio||0!==W.get("icon-rotate").constantOr(1))&&(t.iconsNeedLinear=!0))}const hn=Dg(rt.horizontal)||rt.vertical;t.iconsInText||(t.iconsInText=!!hn&&hn.iconsInText),(hn||Lt)&&Eg(t,Oe,rt,Lt,s,re,bt,0,St,fn,y,T,F)}p&&t.generateCollisionDebugBuffers(R,t.collisionBoxArray)}function xp(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Eg(t,e,n,s,h,p,y,T,R,F,W,te,re){let _e=p.textMaxSize.evaluate(e,{},te);void 0===_e&&(_e=y);const we=t.layers[0].layout,Oe=we.get("icon-offset").evaluate(e,{},te),Ve=Dg(n.horizontal)||n.vertical,it="globe"===re.name,bt=y/24,rt=t.tilePixelRatio*_e/24,vt=(Zn=t.overscaling,t.zoom>18&&Zn>2&&(Zn>>=1),Math.max(Fr/(512*Zn),1)*we.get("symbol-spacing")),Lt=we.get("text-padding")*t.tilePixelRatio,St=we.get("icon-padding")*t.tilePixelRatio,fn=wt(we.get("text-max-angle")),hn="map"===we.get("text-rotation-alignment")&&"point"!==we.get("symbol-placement"),bn="map"===we.get("icon-rotation-alignment")&&"point"!==we.get("symbol-placement"),hi=we.get("symbol-placement"),Tn=vt/2;var Zn;const Yn=we.get("icon-text-fit");let Gn;s&&"none"!==Yn&&(t.allowVerticalPlacement&&n.vertical&&(Gn=bg(s,n.vertical,Yn,we.get("icon-text-fit-padding"),Oe,bt)),Ve&&(s=bg(s,Ve,Yn,we.get("icon-text-fit-padding"),Oe,bt)));const ci=(Kn,Di,so)=>{if(Di.x<0||Di.x>=Fr||Di.y<0||Di.y>=Fr)return;let ho=null;if(it){const{x:wr,y:Ei,z:Co}=re.projectTilePoint(Di.x,Di.y,so);ho={anchor:new ju(wr,Ei,Co,0,void 0),up:re.upVector(so,Di.x,Di.y)}}!function(wr,Ei,Co,Xr,zi,Cs,Fo,sa,go,_o,Bo,ko,ys,$s,ga,Ml,cc,zo,_a,ll,is,aa,Ql,Js,Ra){const tl=wr.addToLineVertexArray(Ei,Xr);let gl,Il,Wl,cl,Wc,Yh,zd,Ud=0,Fm=0,Bm=0,zm=0,Pp=-1,Op=-1;const su={};let e_=wo("");const Kh=Co?Co.anchor:Ei;let Um=0,Vm=0;if(void 0===go._unevaluatedLayout.getValue("text-radial-offset")?[Um,Vm]=go.layout.get("text-offset").evaluate(is,{},Ra).map(gc=>24*gc):(Um=24*go.layout.get("text-radial-offset").evaluate(is,{},Ra),Vm=Dc),wr.allowVerticalPlacement&&zi.vertical){const gc=zi.vertical;if(ga)Yh=Tp(gc),sa&&(zd=Tp(sa));else{const _c=go.layout.get("text-rotate").evaluate(is,{},Ra)+90;Wl=wp(_o,Kh,Ei,Bo,ko,ys,gc,$s,_c,Ml),sa&&(cl=wp(_o,Kh,Ei,Bo,ko,ys,sa,zo,_c))}}if(Cs){const gc=go.layout.get("icon-rotate").evaluate(is,{},Ra),_c="none"!==go.layout.get("icon-text-fit"),kf=wg(Cs,gc,Ql,_c),Zm=sa?wg(sa,gc,Ql,_c):void 0;Il=wp(_o,Kh,Ei,Bo,ko,ys,Cs,zo,gc),Ud=4*kf.length;const t_=wr.iconSizeData;let Xh=null;"source"===t_.kind?(Xh=[wu*go.layout.get("icon-size").evaluate(is,{},Ra)],Xh[0]>ah&&Mi(`${wr.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):"composite"===t_.kind&&(Xh=[wu*aa.compositeIconSizes[0].evaluate(is,{},Ra),wu*aa.compositeIconSizes[1].evaluate(is,{},Ra)],(Xh[0]>ah||Xh[1]>ah)&&Mi(`${wr.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),wr.addSymbols(wr.icon,kf,Xh,ll,_a,is,!1,Co,Ei,tl.lineStartIndex,tl.lineLength,-1,Js,Ra),Pp=wr.icon.placedSymbolArray.length-1,Zm&&(Fm=4*Zm.length,wr.addSymbols(wr.icon,Zm,Xh,ll,_a,is,ac.vertical,Co,Ei,tl.lineStartIndex,tl.lineLength,-1,Js,Ra),Op=wr.icon.placedSymbolArray.length-1)}for(const gc in zi.horizontal){const _c=zi.horizontal[gc];gl||(e_=wo(_c.text),ga?Wc=Tp(_c):gl=wp(_o,Kh,Ei,Bo,ko,ys,_c,$s,go.layout.get("text-rotate").evaluate(is,{},Ra),Ml));const kf=1===_c.positionedLines.length;if(Bm+=Cg(wr,Co,Ei,_c,Fo,go,ga,is,Ml,tl,zi.vertical?ac.horizontal:ac.horizontalOnly,kf?Object.keys(zi.horizontal):[gc],su,Pp,aa,Js,Ra),kf)break}zi.vertical&&(zm+=Cg(wr,Co,Ei,zi.vertical,Fo,go,ga,is,Ml,tl,ac.vertical,["vertical"],su,Op,aa,Js,Ra));let ph=-1;const jm=(gc,_c)=>gc?Math.max(gc,_c):_c;ph=jm(Wc,ph),ph=jm(Yh,ph),ph=jm(zd,ph);const H_=ph>-1?1:0;wr.glyphOffsetArray.length>=Gu.MAX_GLYPHS&&Mi("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==is.sortKey&&wr.addToSortKeyRanges(wr.symbolInstances.length,is.sortKey),wr.symbolInstances.emplaceBack(Kh.x,Kh.y,Kh.z,Ei.x,Ei.y,su.right>=0?su.right:-1,su.center>=0?su.center:-1,su.left>=0?su.left:-1,su.vertical>=0?su.vertical:-1,Pp,Op,e_,void 0!==gl?gl:wr.collisionBoxArray.length,void 0!==gl?gl+1:wr.collisionBoxArray.length,void 0!==Wl?Wl:wr.collisionBoxArray.length,void 0!==Wl?Wl+1:wr.collisionBoxArray.length,void 0!==Il?Il:wr.collisionBoxArray.length,void 0!==Il?Il+1:wr.collisionBoxArray.length,cl||wr.collisionBoxArray.length,cl?cl+1:wr.collisionBoxArray.length,Bo,Bm,zm,Ud,Fm,H_,0,Um,Vm,ph)}(t,Di,ho,Kn,n,s,h,Gn,t.layers[0],t.collisionBoxArray,e.index,e.sourceLayerIndex,t.index,Lt,hn,R,0,St,bn,Oe,e,p,F,W,te)};if("line"===hi)for(const Kn of mm(e.geometry,0,0,Fr,Fr)){const Di=P_(Kn,vt,fn,n.vertical||Ve,s,24,rt,t.overscaling,Fr);for(const so of Di){const ho=Ve;ho&&$y(t,ho.text,Tn,so)||ci(Kn,so,te)}}else if("line-center"===hi){for(const Kn of e.geometry)if(Kn.length>1){const Di=df(Kn,fn,n.vertical||Ve,s,24,rt);Di&&ci(Kn,Di,te)}}else if("Polygon"===e.type)for(const Kn of oc(e.geometry,0)){const Di=k_(Kn,16);ci(Kn[0],new ju(Di.x,Di.y,0,0,void 0),te)}else if("LineString"===e.type)for(const Kn of e.geometry)ci(Kn,new ju(Kn[0].x,Kn[0].y,0,0,void 0),te);else if("Point"===e.type)for(const Kn of e.geometry)for(const Di of Kn)ci([Di],new ju(Di.x,Di.y,0,0,void 0),te)}const ah=32640;function Cg(t,e,n,s,h,p,y,T,R,F,W,te,re,_e,we,Oe,Ve){const it=function(vt,Lt,St,fn,hn,bn,hi,Tn){const Zn=[];if(0===Lt.positionedLines.length)return Zn;const Yn=fn.layout.get("text-rotate").evaluate(bn,{})*Math.PI/180,Gn=function(ho){const wr=ho[0],Ei=ho[1],Co=wr*Ei;return Co>0?[wr,-Ei]:Co<0?[-wr,Ei]:0===wr?[Ei,wr]:[Ei,-wr]}(St);let ci=Math.abs(Lt.top-Lt.bottom);for(const ho of Lt.positionedLines)ci-=ho.lineOffset;const Kn=Lt.positionedLines.length,Di=ci/Kn;let so=Lt.top-St[1];for(let ho=0;ho<Kn;++ho){const wr=Lt.positionedLines[ho];so=O_(Lt,Di,so,ho);for(const Ei of wr.positionedGlyphs){if(!Ei.rect)continue;const Co=Ei.rect||{};let Xr=4,zi=!0,Cs=1,Fo=0;if(Ei.imageName){const Js=hi[Ei.imageName];if(!Js)continue;if(Js.sdf){Mi("SDF images are not supported in formatted text and will be ignored.");continue}zi=!1,Cs=Js.pixelRatio,Xr=1/Cs}const sa=(hn||Tn)&&Ei.vertical,go=Ei.metrics.advance*Ei.scale/2,_o=Ei.metrics,Bo=Ei.rect;if(null===Bo)continue;Tn&&Lt.verticalizable&&(Fo=Ei.imageName?go-Ei.metrics.width*Ei.scale/2:0);const ko=hn?[Ei.x+go,Ei.y]:[0,0];let ys=[0,0],$s=[0,0],ga=!1;hn||(sa?($s=[Ei.x+go+Gn[0],Ei.y+Gn[1]-Fo],ga=!0):ys=[Ei.x+go+St[0],Ei.y+St[1]-Fo]);const Ml=Bo.w*Ei.scale/(Cs*(Ei.localGlyph?2:1)),cc=Bo.h*Ei.scale/(Cs*(Ei.localGlyph?2:1));let zo,_a,ll,is;if(sa){const Js=Ei.y-so,Ra=new Ke(-go,go-Js),tl=-Math.PI/2,gl=new Ke(...$s);zo=new Ke(-go+ys[0],ys[1]),zo._rotateAround(tl,Ra)._add(gl),zo.x+=-Js+go,zo.y-=(_o.left-Xr)*Ei.scale;const Il=Ei.imageName?_o.advance*Ei.scale:24*Ei.scale,Wl=String.fromCharCode(Ei.glyph);Gy(Wl)?zo.x+=(1-Xr)*Ei.scale:T_(Wl)?zo.x+=Il-_o.height*Ei.scale+(-Xr-1)*Ei.scale:zo.x+=Ei.imageName||_o.width+2*Xr===Bo.w&&_o.height+2*Xr===Bo.h?(Il-cc)/2:(Il-(_o.height+2*Xr)*Ei.scale)/2,_a=new Ke(zo.x,zo.y-Ml),ll=new Ke(zo.x+cc,zo.y),is=new Ke(zo.x+cc,zo.y-Ml)}else{const Js=(_o.left-Xr)*Ei.scale-go+ys[0],Ra=(-_o.top-Xr)*Ei.scale+ys[1],tl=Js+Ml,gl=Ra+cc;zo=new Ke(Js,Ra),_a=new Ke(tl,Ra),ll=new Ke(Js,gl),is=new Ke(tl,gl)}if(Yn){let Js;Js=hn?new Ke(0,0):ga?new Ke(Gn[0],Gn[1]):new Ke(St[0],St[1]),zo._rotateAround(Yn,Js),_a._rotateAround(Yn,Js),ll._rotateAround(Yn,Js),is._rotateAround(Yn,Js)}const aa=new Ke(0,0),Ql=new Ke(0,0);Zn.push({tl:zo,tr:_a,bl:ll,br:is,tex:Co,writingMode:Lt.writingMode,glyphOffset:ko,sectionIndex:Ei.sectionIndex,isSDF:zi,pixelOffsetTL:aa,pixelOffsetBR:Ql,minFontScaleX:0,minFontScaleY:0})}}return Zn}(0,s,R,p,y,T,h,t.allowVerticalPlacement),bt=t.textSizeData;let rt=null;"source"===bt.kind?(rt=[wu*p.layout.get("text-size").evaluate(T,{},Ve)],rt[0]>ah&&Mi(`${t.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):"composite"===bt.kind&&(rt=[wu*we.compositeTextSizes[0].evaluate(T,{},Ve),wu*we.compositeTextSizes[1].evaluate(T,{},Ve)],(rt[0]>ah||rt[1]>ah)&&Mi(`${t.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),t.addSymbols(t.text,it,rt,R,y,T,W,e,n,F.lineStartIndex,F.lineLength,_e,Oe,Ve);for(const vt of te)re[vt]=t.text.placedSymbolArray.length-1;return 4*it.length}function Dg(t){for(const e in t)return t[e];return null}function wp(t,e,n,s,h,p,y,T,R,F){let W=y.top,te=y.bottom,re=y.left,_e=y.right;const we=y.collisionPadding;if(we&&(re-=we[0],W-=we[1],_e+=we[2],te+=we[3]),R){const Oe=new Ke(re,W),Ve=new Ke(_e,W),it=new Ke(re,te),bt=new Ke(_e,te),rt=wt(R);let vt=new Ke(0,0);F&&(vt=new Ke(F[0],F[1])),Oe._rotateAround(rt,vt),Ve._rotateAround(rt,vt),it._rotateAround(rt,vt),bt._rotateAround(rt,vt),re=Math.min(Oe.x,Ve.x,it.x,bt.x),_e=Math.max(Oe.x,Ve.x,it.x,bt.x),W=Math.min(Oe.y,Ve.y,it.y,bt.y),te=Math.max(Oe.y,Ve.y,it.y,bt.y)}return t.emplaceBack(e.x,e.y,e.z,n.x,n.y,re,W,_e,te,T,s,h,p),t.length-1}function Tp(t){t.collisionPadding&&(t.top-=t.collisionPadding[1],t.bottom+=t.collisionPadding[3]);const e=t.bottom-t.top;return e>0?Math.max(10,e):null}function $y(t,e,n,s){const h=t.compareText;if(e in h){const p=h[e];for(let y=p.length-1;y>=0;y--)if(s.dist(p[y])<n)return!0}else h[e]=[];return h[e].push(s),!1}const Sg=Un([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Ag}=Sg,Mg=Un([{name:"a_pos_3",components:3,type:"Int16"}]);var Ep=Un([{name:"a_pos",type:"Int16",components:2}]);const lh=Fr/Math.PI/2,gf=2*Xs(1,0)*lh*Math.PI,Od=[64,32,16],Hc=-lh,$c=lh,qy=[new Ul([Hc,Hc,Hc],[$c,$c,$c]),new Ul([Hc,Hc,Hc],[0,0,$c]),new Ul([0,Hc,Hc],[$c,0,$c]),new Ul([Hc,0,Hc],[0,$c,$c]),new Ul([0,0,Hc],[$c,$c,$c])];function qc(t,e,n,s=!0){const h=Zc([],t._camera.position,t.worldSize),p=[e,n,1,1];zu(p,p,t.pixelMatrixInverse),_u(p,p,1/p[3]);const y=$l([],Gc([],p,h)),T=t.globeMatrix,R=[T[12],T[13],T[14]],F=Gc([],R,h),W=nh(F),te=$l([],F),re=t.worldSize/(2*Math.PI),_e=fc(te,y),we=Math.asin(re/W);if(we<Math.acos(_e)){if(!s)return null;const hi=[],Tn=[];Zc(hi,y,W/_e),$l(Tn,Gc(Tn,hi,F)),$l(y,eu(y,F,Zc(y,Tn,Math.tan(we)*W)))}const Oe=[];new Jd(h,y).closestPointOnSphere(R,re,Oe);const Ve=$l([],yn(T,0)),it=$l([],yn(T,1)),bt=$l([],yn(T,2)),rt=fc(Ve,Oe),vt=fc(it,Oe),Lt=fc(bt,Oe),St=Bt(Math.asin(-vt/re));let fn=Bt(Math.atan2(rt,Lt));fn=t.center.lng+function(hi,Tn){const Zn=(Tn-hi+180)%360-180;return Zn<-180?Zn+360:Zn}(t.center.lng,fn);const hn=Tc(fn),bn=kt(Fc(St),0,1);return new gu(hn,bn)}class Wy{constructor(e,n,s){this.a=Gc([],e,s),this.b=Gc([],n,s),this.center=s;const h=$l([],this.a),p=$l([],this.b);this.angle=Math.acos(fc(h,p))}}function Ig(t,e){if(0===t.angle)return null;let n;return n=0===t.a[e]?1/t.angle*.5*Math.PI:1/t.angle*Math.atan(t.b[e]/t.a[e]/Math.sin(t.angle)-1/Math.tan(t.angle)),n<0||n>1?null:function(s,h,p,y){const T=Math.sin(p);return s*(Math.sin((1-y)*p)/T)+h*(Math.sin(y*p)/T)}(t.a[e],t.b[e],t.angle,kt(n,0,1))+t.center[e]}function iu(t){if(t.z<=1)return qy[t.z+2*t.y+t.x];const e=Cp(xm(t));return Ul.fromPoints(e)}function vm(t,e){const n=yf(e.zoom);if(0===n)return iu(t);const s=xm(t),h=Cp(s),p=Tc(s.getWest())*e.worldSize,y=Tc(s.getEast())*e.worldSize,T=Fc(s.getNorth())*e.worldSize,R=Fc(s.getSouth())*e.worldSize,F=[p,T,0],W=[y,T,0],te=[p,R,0],re=[y,R,0],_e=ld([],e.globeMatrix);return $a(F,F,_e),$a(W,W,_e),$a(te,te,_e),$a(re,re,_e),h[0]=er(h[0],te,n),h[1]=er(h[1],re,n),h[2]=er(h[2],W,n),h[3]=er(h[3],F,n),Ul.fromPoints(h)}function bm(t,e,n,s,h){for(const p of n)$a(p,p,s),Zc(p,p,h),Wf(t,t,p),Yf(e,e,p)}function xm({x:t,y:e,z:n}){const s=1/(1<<n),h=new Eo(Al(t*s),Qa((e+1)*s)),p=new Eo(Al((t+1)*s),Qa(e*s));return new mu(h,p)}function Cp(t){const e=wt(t.getNorth()),n=wt(t.getSouth()),s=Math.cos(e),h=Math.cos(n),p=Math.sin(e),y=Math.sin(n),T=t.getWest(),R=t.getEast();return[ch(h,y,T),ch(h,y,R),ch(s,p,R),ch(s,p,T)]}function ch(t,e,n,s=lh){return n=wt(n),[t*Math.sin(n)*s,-e*s,t*Math.cos(n)*s]}function Dp(t,e,n){return ch(Math.cos(wt(t)),Math.sin(wt(t)),e,n)}function Uh(t,e,n,s){const h=1<<n.z,p=(t/Fr+n.x)/h;return Dp(Qa((e/Fr+n.y)/h),Al(p),s)}function Sp({min:t,max:e}){return 16383/Math.max(e[0]-t[0],e[1]-t[1],e[2]-t[2])}const Pg=new Float64Array(16);function _f(t){const e=Sp(t),n=Kd(Pg,[e,e,e]);return Fu(n,n,((s=[])[0]=-(h=t.min)[0],s[1]=-h[1],s[2]=-h[2],s));var s,h}function wm(t){const e=(s=t.min,(n=Pg)[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=s[0],n[13]=s[1],n[14]=s[2],n[15]=1,n);var n,s;const h=1/Sp(t);return jc(e,e,[h,h,h])}function Og(t,e,n,s,h){const p=function(R){const F=Fr/(2*Math.PI);return R/(2*Math.PI)/F}(n),y=[t,e,-n/(2*Math.PI)],T=ic(new Float64Array(16));return Fu(T,T,y),jc(T,T,[p,p,p]),Yd(T,T,wt(-h)),cd(T,T,wt(-s)),T}function yf(t){return dn(5,6,t)}function vf(t,e){const n=Dp(e.lat,e.lng);return p=(s=hd([],function(_e){const we=Dp(_e._center.lat,_e._center.lng);let Oe=dd([],ih(0,1,0),we);const Ve=ud([],-_e.angle,we);Oe=$a(Oe,Oe,Ve),ud(Ve,-_e._pitch,Oe);const it=$l([],we);return Zc(it,it,_e.cameraToCenterDistance/_e.pixelsPerMeter*gf),$a(it,it,Ve),eu([],we,it)}(t),n))[0],y=s[1],T=s[2],R=(h=n)[0],F=h[1],W=h[2],re=(te=Math.sqrt(p*p+y*y+T*T)*Math.sqrt(R*R+F*F+W*W))&&fc(s,h)/te,Math.acos(Math.min(Math.max(re,-1),1));var s,h,p,y,T,R,F,W,te,re}const Vh=wt(85),F_=Math.cos(Vh),bf=Math.sin(Vh);function Rg(t,e){const n=t.fovAboveCenter,s=t.elevation?t.elevation.getMinElevationBelowMSL()*e:0,h=(t._camera.position[2]*t.worldSize-s)/Math.cos(t._pitch),p=Math.sin(n)*h/Math.sin(Math.max(Math.PI/2-t._pitch-n,.01)),y=Math.sin(t._pitch)*p+h;return Math.min(1.01*y,h*(1/t._horizonShift))}function jh(t,e){if(!e.isReprojectedInTileSpace)return{scale:1<<t.z,x:t.x,y:t.y,x2:t.x+1,y2:t.y+1,projection:e};const n=Math.pow(2,-t.z),s=t.x*n,h=(t.x+1)*n,p=t.y*n,y=(t.y+1)*n,T=Al(s),R=Al(h),F=Qa(p),W=Qa(y),te=e.project(T,F),re=e.project(R,F),_e=e.project(R,W),we=e.project(T,W);let Oe=Math.min(te.x,re.x,_e.x,we.x),Ve=Math.min(te.y,re.y,_e.y,we.y),it=Math.max(te.x,re.x,_e.x,we.x),bt=Math.max(te.y,re.y,_e.y,we.y);const rt=n/16;function vt(St,fn,hn,bn,hi,Tn){const Zn=(hn+hi)/2,Yn=(bn+Tn)/2,Gn=e.project(Al(Zn),Qa(Yn)),ci=Math.max(0,Oe-Gn.x,Ve-Gn.y,Gn.x-it,Gn.y-bt);Oe=Math.min(Oe,Gn.x),it=Math.max(it,Gn.x),Ve=Math.min(Ve,Gn.y),bt=Math.max(bt,Gn.y),ci>rt&&(vt(St,Gn,hn,bn,Zn,Yn),vt(Gn,fn,Zn,Yn,hi,Tn))}vt(te,re,s,p,h,p),vt(re,_e,h,p,h,y),vt(_e,we,h,y,s,y),vt(we,te,s,y,s,p),Oe-=rt,Ve-=rt,it+=rt,bt+=rt;const Lt=1/Math.max(it-Oe,bt-Ve);return{scale:Lt,x:Oe*Lt,y:Ve*Lt,x2:it*Lt,y2:bt*Lt,projection:e}}const Tm=ic(new Float32Array(16));class ql{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,n){return{x:0,y:0,z:0}}unproject(e,n){return new Eo(0,0)}projectTilePoint(e,n,s){return{x:e,y:n,z:0}}locationPoint(e,n,s=!0){return e._coordinatePoint(e.locationCoordinate(n),s)}pixelsPerMeter(e,n){return Xs(1,e)*n}pixelSpaceConversion(e,n,s){return 1}farthestPixelDistance(e){return Rg(e,e.pixelsPerMeter)}pointCoordinate(e,n,s,h){const p=e.horizonLineFromTop(!1),y=new Ke(n,Math.max(p,s));return e.rayIntersectionCoordinate(e.pointRayIntersection(y,h))}pointCoordinate3D(e,n,s){const h=new Ke(n,s);if(e.elevation)return e.elevation.pointCoordinate(h);{const p=this.pointCoordinate(e,h.x,h.y,0);return[p.x,p.y,p.z]}}isPointAboveHorizon(e,n){if(e.elevation)return!this.pointCoordinate3D(e,n.x,n.y);const s=e.horizonLineFromTop();return n.y<s}createInversionMatrix(e,n){return Tm}createTileMatrix(e,n,s){let h,p,y;const T=s.canonical,R=ic(new Float64Array(16));if(this.isReprojectedInTileSpace){const F=jh(T,this);h=1,p=F.x+s.wrap*F.scale,y=F.y,jc(R,R,[h/F.scale,h/F.scale,e.pixelsPerMeter/n])}else h=n/e.zoomScale(T.z),p=(T.x+Math.pow(2,T.z)*s.wrap)*h,y=T.y*h;return Fu(R,R,[p,y,0]),jc(R,R,[h/Fr,h/Fr,1]),R}upVector(e,n,s){return[0,0,1]}upVectorScale(e,n,s){return{metersToTile:1}}}class xf extends ql{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[n,s]=this.parallels=e.parallels||[29.5,45.5],h=Math.sin(wt(n));this.n=(h+Math.sin(wt(s)))/2,this.c=1+h*(2*this.n-h),this.r0=Math.sqrt(this.c)/this.n}project(e,n){const{n:s,c:h,r0:p}=this,y=wt(e-this.center[0]),T=wt(n),R=Math.sqrt(h-2*s*Math.sin(T))/s;return{x:R*Math.sin(y*s),y:R*Math.cos(y*s)-p,z:0}}unproject(e,n){const{n:s,c:h,r0:p}=this,y=p+n;let T=Math.atan2(e,Math.abs(y))*Math.sign(y);y*s<0&&(T-=Math.PI*Math.sign(e)*Math.sign(y));const R=wt(this.center[0])*s;T=Qn(T,-Math.PI-R,Math.PI-R);const F=Bt(T/s)+this.center[0],W=Math.asin(kt((h-(e*e+y*y)*s*s)/(2*s),-1,1)),te=kt(Bt(W),-85.051129,Bc);return new Eo(F,te)}}const ml=1.340264,ru=-.081106,uh=893e-6,Jl=.003796,Rd=Math.sqrt(3)/2;class kd extends ql{project(e,n){n=n/180*Math.PI,e=e/180*Math.PI;const s=Math.asin(Rd*Math.sin(n)),h=s*s,p=h*h*h;return{x:.5*(e*Math.cos(s)/(Rd*(ml+3*ru*h+p*(7*uh+9*Jl*h)))/Math.PI+.5),y:1-.5*(s*(ml+ru*h+p*(uh+Jl*h))/Math.PI+1),z:0}}unproject(e,n){e=(2*e-.5)*Math.PI;let s=n=(2*(1-n)-1)*Math.PI,h=s*s,p=h*h*h;for(let W,te,re,_e=0;_e<12&&(te=s*(ml+ru*h+p*(uh+Jl*h))-n,re=ml+3*ru*h+p*(7*uh+9*Jl*h),W=te/re,s=kt(s-W,-Math.PI/3,Math.PI/3),h=s*s,p=h*h*h,!(Math.abs(W)<1e-12));++_e);const y=Rd*e*(ml+3*ru*h+p*(7*uh+9*Jl*h))/Math.cos(s),T=Math.asin(Math.sin(s)/Rd),R=kt(180*y/Math.PI,-180,180),F=kt(180*T/Math.PI,-85.051129,Bc);return new Eo(R,F)}}class Nd extends ql{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,n){return{x:.5+e/360,y:.5-n/360,z:0}}unproject(e,n){const s=360*(e-.5),h=kt(360*(.5-n),-85.051129,Bc);return new Eo(s,h)}}const ou=Math.PI/2;function Zu(t){return Math.tan((ou+t)/2)}class Ld extends ql{constructor(e){super(e),this.center=e.center||[0,30];const[n,s]=this.parallels=e.parallels||[30,30],h=wt(n),p=wt(s),y=Math.cos(h);this.n=h===p?Math.sin(h):Math.log(y/Math.cos(p))/Math.log(Zu(p)/Zu(h)),this.f=y*Math.pow(Zu(h),this.n)/this.n}project(e,n){n=wt(n),e=wt(e-this.center[0]);const s=1e-6,{n:h,f:p}=this;p>0?n<-ou+s&&(n=-ou+s):n>ou-s&&(n=ou-s);const y=p/Math.pow(Zu(n),h),T=y*Math.sin(h*e),R=p-y*Math.cos(h*e);return{x:.5*(T/Math.PI+.5),y:1-.5*(R/Math.PI+.5),z:0}}unproject(e,n){e=(2*e-.5)*Math.PI,n=(2*(1-n)-.5)*Math.PI;const{n:s,f:h}=this,p=h-n,y=Math.sign(p),T=Math.sign(s)*Math.sqrt(e*e+p*p);let R=Math.atan2(e,Math.abs(p))*y;p*s<0&&(R-=Math.PI*Math.sign(e)*y);const F=kt(Bt(R/s)+this.center[0],-180,180),W=kt(Bt(2*Math.atan(Math.pow(h/T,1/s))-ou),-85.051129,Bc);return new Eo(F,W)}}class Zh extends ql{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,n){return{x:Tc(e),y:Fc(n),z:0}}unproject(e,n){const s=Al(e),h=Qa(n);return new Eo(s,h)}}const Gh=wt(Bc);class Fd extends ql{project(e,n){const s=(n=wt(n))*n,h=s*s;return{x:.5*((e=wt(e))*(.8707-.131979*s+h*(h*(.003971*s-.001529*h)-.013791))/Math.PI+.5),y:1-.5*(n*(1.007226+s*(.015085+h*(.028874*s-.044475-.005916*h)))/Math.PI+1),z:0}}unproject(e,n){e=(2*e-.5)*Math.PI;let s=n=(2*(1-n)-1)*Math.PI,h=25,p=0,y=s*s;do{y=s*s;const F=y*y;p=(s*(1.007226+y*(.015085+F*(.028874*y-.044475-.005916*F)))-n)/(1.007226+y*(.045255+F*(.259866*y-.311325-.005916*11*F))),s=kt(s-p,-Gh,Gh)}while(Math.abs(p)>1e-6&&--h>0);y=s*s;const T=kt(Bt(e/(.8707+y*(y*(y*y*y*(.003971-.001529*y)-.013791)-.131979))),-180,180),R=Bt(s);return new Eo(T,R)}}const Hh=wt(Bc);class kg extends ql{project(e,n){n=wt(n),e=wt(e);const s=Math.cos(n),h=2/Math.PI,p=Math.acos(s*Math.cos(e/2)),y=Math.sin(p)/p,T=.5*(e*h+2*s*Math.sin(e/2)/y)||0,R=.5*(n+Math.sin(n)/y)||0;return{x:.5*(T/Math.PI+.5),y:1-.5*(R/Math.PI+1),z:0}}unproject(e,n){let s=e=(2*e-.5)*Math.PI,h=n=(2*(1-n)-1)*Math.PI,p=25;const y=1e-6;let T=0,R=0;do{const F=Math.cos(h),W=Math.sin(h),te=2*W*F,re=W*W,_e=F*F,we=Math.cos(s/2),Oe=Math.sin(s/2),Ve=2*we*Oe,it=Oe*Oe,bt=1-_e*we*we,rt=bt?1/bt:0,vt=bt?Math.acos(F*we)*Math.sqrt(1/bt):0,Lt=.5*(2*vt*F*Oe+2*s/Math.PI)-e,St=.5*(vt*W+h)-n,fn=.5*rt*(_e*it+vt*F*we*re)+1/Math.PI,hn=rt*(Ve*te/4-vt*W*Oe),bn=.125*rt*(te*Oe-vt*W*_e*Ve),hi=.5*rt*(re*we+vt*it*F)+.5,Tn=hn*bn-hi*fn;T=(St*hn-Lt*hi)/Tn,R=(Lt*bn-St*fn)/Tn,s=kt(s-T,-Math.PI,Math.PI),h=kt(h-R,-Hh,Hh)}while((Math.abs(T)>y||Math.abs(R)>y)&&--p>0);return new Eo(Bt(s),Bt(h))}}class Em extends ql{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(wt(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,n){const{scale:s,cosPhi:h}=this;return{x:wt(e)*h*s+.5,y:-Math.sin(wt(n))/h*s+.5,z:0}}unproject(e,n){const{scale:s,cosPhi:h}=this,p=-(n-.5)/s,y=kt(Bt((e-.5)/s)/h,-180,180),T=Math.asin(kt(p*h,-1,1)),R=kt(Bt(T),-85.051129,Bc);return new Eo(y,R)}}class Ng extends Zh{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug","custom"],this.range=[3,5]}projectTilePoint(e,n,s){const h=Uh(e,n,s);return $a(h,h,_f(iu(s))),{x:h[0],y:h[1],z:h[2]}}locationPoint(e,n){const s=Dp(n.lat,n.lng),h=$l([],s),p=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(n),e._centerAltitude):e._centerAltitude;Mh(s,s,h,Xs(1,0)*Fr*p);const y=ic(new Float64Array(16));return Ah(y,e.pixelMatrix,e.globeMatrix),$a(s,s,y),new Ke(s[0],s[1])}pixelsPerMeter(e,n){return Xs(1,0)*n}pixelSpaceConversion(e,n,s){const h=wn(Xs(1,45)*n,Xs(1,e)*n,s);return this.pixelsPerMeter(e,n)/h}createTileMatrix(e,n,s){const h=wm(iu(s.canonical));return Ah(new Float64Array(16),e.globeMatrix,h)}createInversionMatrix(e,n){const{center:s}=e,h=_f(iu(n));return cd(h,h,wt(s.lng)),Yd(h,h,wt(s.lat)),jc(h,h,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(h)}pointCoordinate(e,n,s,h){return qc(e,n,s,!0)||new gu(0,0)}pointCoordinate3D(e,n,s){const h=this.pointCoordinate(e,n,s,0);return[h.x,h.y,h.z]}isPointAboveHorizon(e,n){return!qc(e,n.x,n.y,!1)}farthestPixelDistance(e){const n=function(h,p){const y=h.cameraToCenterDistance,T=h._centerAltitude*p,R=h._camera,F=h._camera.forward(),W=eu([],Zc([],F,-y),[0,0,T]),te=h.worldSize/(2*Math.PI),re=[0,0,-te],_e=h.width/h.height,we=Math.tan(h.fovAboveCenter),Oe=Zc([],R.up(),we),Ve=Zc([],R.right(),we*_e),it=$l([],eu([],eu([],F,Oe),Ve)),bt=[];let rt;if(new Jd(W,it).closestPointOnSphere(re,te,bt)){const vt=eu([],bt,re),Lt=Gc([],vt,W);rt=Math.cos(h.fovAboveCenter)*nh(Lt)}else{const vt=Gc([],W,re),Lt=Gc([],re,W);$l(Lt,Lt);const St=nh(vt)-te;rt=Math.sqrt(St*(St+2*te));const fn=Math.acos(rt/(te+St))-Math.acos(fc(F,Lt));rt*=Math.cos(fn)}return 1.01*rt}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),s=yf(e.zoom);if(s>0){const h=Rg(e,Xs(1,e.center.lat)*e.worldSize),p=e.worldSize/(2*Math.PI),y=Math.max(e.width,e.height)/e.worldSize*Math.PI;return wn(n,h+p*(1-Math.cos(y)),Math.pow(s,10))}return n}upVector(e,n,s){return Uh(n,s,e,1)}upVectorScale(e){return{metersToTile:gf*Sp(iu(e))}}}function Cm(t){const e=t.parallels,n=!!e&&Math.abs(e[0]+e[1])<.01;switch(t.name){case"mercator":return new Zh(t);case"equirectangular":return new Nd(t);case"naturalEarth":return new Fd(t);case"equalEarth":return new kd(t);case"winkelTripel":return new kg(t);case"albers":return n?new Em(t):new xf(t);case"lambertConformalConic":return n?new Em(t):new Ld(t);case"globe":return new Ng(t)}throw new Error(`Invalid projection name: ${t.name}`)}const Lg=xu.VectorTileFeature.types,Fg=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function wf(t,e,n,s,h,p,y,T,R,F,W,te,re){const _e=T?Math.min(ah,Math.round(T[0])):0,we=T?Math.min(ah,Math.round(T[1])):0;t.emplaceBack(e,n,Math.round(32*s),Math.round(32*h),p,y,(_e<<1)+(R?1:0),we,16*F,16*W,256*te,256*re)}function Tf(t,e,n,s,h,p,y){t.emplaceBack(e,n,s,h,p,y)}function Ef(t,e,n,s,h){t.emplaceBack(e,n,s,h),t.emplaceBack(e,n,s,h),t.emplaceBack(e,n,s,h),t.emplaceBack(e,n,s,h)}function B_(t){for(const e of t.sections)if(u(e.text))return!0;return!1}class Ap{constructor(e){this.layoutVertexArray=new Es,this.indexArray=new Qe,this.programConfigurations=e,this.segments=new Ha,this.dynamicLayoutVertexArray=new mo,this.opacityVertexArray=new G,this.placedSymbolArray=new Ja,this.globeExtVertexArray=new Ks}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(e,n,s,h){this.isEmpty()||(s&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,w_.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Vy.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Fg,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,sg.members,!0)),this.opacityVertexBuffer.itemSize=1),(s||h)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}Oi(Ap,"SymbolBuffers");class Dm{constructor(e,n,s){this.layoutVertexArray=new e,this.layoutAttributes=n,this.indexArray=new s,this.segments=new Ha,this.collisionVertexArray=new me,this.collisionVertexArrayExt=new Ne}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,ag.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,lg.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Oi(Dm,"CollisionBuffers");class Gu{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(y=>y.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=ic([]),this.placementViewportMatrix=ic([]);const n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=sc(this.zoom,n["text-size"]),this.iconSizeData=sc(this.zoom,n["icon-size"]);const s=this.layers[0].layout,h=s.get("symbol-sort-key"),p=s.get("symbol-z-order");this.canOverlap=s.get("text-allow-overlap")||s.get("icon-allow-overlap")||s.get("text-ignore-placement")||s.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==p&&void 0!==h.constantOr(1),this.sortFeaturesByY=("viewport-y"===p||"auto"===p&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=s.get("text-writing-mode").map(y=>ac[y]),this.stateDependentLayerIds=this.layers.filter(y=>y.isStateDependent()).map(y=>y.id),this.sourceID=e.sourceID,this.projection=e.projection}createArrays(){this.text=new Ap(new Xc(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new Ap(new Xc(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new Sl,this.lineVertexArray=new Fl,this.symbolInstances=new Hl}calculateGlyphDependencies(e,n,s,h,p){for(let y=0;y<e.length;y++)if(n[e.charCodeAt(y)]=!0,h&&p){const T=Ed[e.charAt(y)];T&&(n[T.charCodeAt(0)]=!0)}}populate(e,n,s,h){const p=this.layers[0],y=p.layout,T="globe"===this.projection.name,R=y.get("text-font"),F=y.get("text-field"),W=y.get("icon-image"),te=("constant"!==F.value.kind||F.value.value instanceof Ir&&!F.value.value.isEmpty()||F.value.value.toString().length>0)&&("constant"!==R.value.kind||R.value.value.length>0),re="constant"!==W.value.kind||!!W.value.value||Object.keys(W.parameters).length>0,_e=y.get("symbol-sort-key");if(this.features=[],!te&&!re)return;const we=n.iconDependencies,Oe=n.glyphDependencies,Ve=n.availableImages,it=new He(this.zoom);for(const{feature:bt,id:rt,index:vt,sourceLayerIndex:Lt}of e){const St=p._featureFilter.needGeometry,fn=Qc(bt,St);if(!p._featureFilter.filter(it,fn,s))continue;if(St||(fn.geometry=zc(bt,s,h)),T&&1!==bt.type&&s.z<=5){const Tn=fn.geometry,Zn=.98078528056;for(let Yn=0;Yn<Tn.length;Yn++)Tn[Yn]=zp(Tn[Yn],Gn=>Gn,(Gn,ci)=>fc(Uh(Gn.x,Gn.y,s,1),Uh(ci.x,ci.y,s,1))<Zn)}let hn,bn;if(te){const Tn=p.getValueAndResolveTokens("text-field",fn,s,Ve),Zn=Ir.factory(Tn);B_(Zn)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===Fe()||this.hasRTLText&&Ge.isParsed())&&(hn=Zy(Zn,p,fn))}if(re){const Tn=p.getValueAndResolveTokens("icon-image",fn,s,Ve);bn=Tn instanceof Vo?Tn:Vo.fromString(Tn)}if(!hn&&!bn)continue;const hi=this.sortFeaturesByKey?_e.evaluate(fn,{},s):void 0;if(this.features.push({id:rt,text:hn,icon:bn,index:vt,sourceLayerIndex:Lt,geometry:fn.geometry,properties:bt.properties,type:Lg[bt.type],sortKey:hi}),bn&&(we[bn.name]=!0),hn){const Tn=R.evaluate(fn,{},s).join(","),Zn="map"===y.get("text-rotation-alignment")&&"point"!==y.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ac.vertical)>=0;for(const Yn of hn.sections)if(Yn.image)we[Yn.image.name]=!0;else{const Gn=Iu(hn.toString()),ci=Yn.fontStack||Tn,Kn=Oe[ci]=Oe[ci]||{};this.calculateGlyphDependencies(Yn.text,Kn,Zn,this.allowVerticalPlacement,Gn)}}}"line"===y.get("symbol-placement")&&(this.features=function(bt){const rt={},vt={},Lt=[];let St=0;function fn(Tn){Lt.push(bt[Tn]),St++}function hn(Tn,Zn,Yn){const Gn=vt[Tn];return delete vt[Tn],vt[Zn]=Gn,Lt[Gn].geometry[0].pop(),Lt[Gn].geometry[0]=Lt[Gn].geometry[0].concat(Yn[0]),Gn}function bn(Tn,Zn,Yn){const Gn=rt[Zn];return delete rt[Zn],rt[Tn]=Gn,Lt[Gn].geometry[0].shift(),Lt[Gn].geometry[0]=Yn[0].concat(Lt[Gn].geometry[0]),Gn}function hi(Tn,Zn,Yn){const Gn=Yn?Zn[0][Zn[0].length-1]:Zn[0][0];return`${Tn}:${Gn.x}:${Gn.y}`}for(let Tn=0;Tn<bt.length;Tn++){const Zn=bt[Tn],Yn=Zn.geometry,Gn=Zn.text?Zn.text.toString():null;if(!Gn){fn(Tn);continue}const ci=hi(Gn,Yn),Kn=hi(Gn,Yn,!0);if(ci in vt&&Kn in rt&&vt[ci]!==rt[Kn]){const Di=bn(ci,Kn,Yn),so=hn(ci,Kn,Lt[Di].geometry);delete rt[ci],delete vt[Kn],vt[hi(Gn,Lt[so].geometry,!0)]=so,Lt[Di].geometry=null}else ci in vt?hn(ci,Kn,Yn):Kn in rt?bn(ci,Kn,Yn):(fn(Tn),rt[ci]=St-1,vt[Kn]=St-1)}return Lt.filter(Tn=>Tn.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((bt,rt)=>bt.sortKey-rt.sortKey)}update(e,n,s,h){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,n,this.layers,s,h),this.icon.programConfigurations.updatePaintArrays(e,n,this.layers,s,h))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=Cm(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,n){const s=this.lineVertexArray.length,h=e.segment;if(void 0!==h){let p=e.dist(n[h+1]),y=e.dist(n[h]);const T={};for(let R=h+1;R<n.length;R++)T[R]={x:n[R].x,y:n[R].y,tileUnitDistanceFromAnchor:p},R<n.length-1&&(p+=n[R+1].dist(n[R]));for(let R=h||0;R>=0;R--)T[R]={x:n[R].x,y:n[R].y,tileUnitDistanceFromAnchor:y},R>0&&(y+=n[R-1].dist(n[R]));for(let R=0;R<n.length;R++){const F=T[R];this.lineVertexArray.emplaceBack(F.x,F.y,F.tileUnitDistanceFromAnchor)}}return{lineStartIndex:s,lineLength:this.lineVertexArray.length-s}}addSymbols(e,n,s,h,p,y,T,R,F,W,te,re,_e,we){const Oe=e.indexArray,Ve=e.layoutVertexArray,it=e.globeExtVertexArray,bt=e.segments.prepareSegment(4*n.length,Ve,Oe,this.canOverlap?y.sortKey:void 0),rt=this.glyphOffsetArray.length,vt=bt.vertexLength,Lt=this.allowVerticalPlacement&&T===ac.vertical?Math.PI/2:0,St=y.text&&y.text.sections;for(let hn=0;hn<n.length;hn++){const{tl:bn,tr:hi,bl:Tn,br:Zn,tex:Yn,pixelOffsetTL:Gn,pixelOffsetBR:ci,minFontScaleX:Kn,minFontScaleY:Di,glyphOffset:so,isSDF:ho,sectionIndex:wr}=n[hn],Ei=bt.vertexLength,Co=so[1];if(wf(Ve,F.x,F.y,bn.x,Co+bn.y,Yn.x,Yn.y,s,ho,Gn.x,Gn.y,Kn,Di),wf(Ve,F.x,F.y,hi.x,Co+hi.y,Yn.x+Yn.w,Yn.y,s,ho,ci.x,Gn.y,Kn,Di),wf(Ve,F.x,F.y,Tn.x,Co+Tn.y,Yn.x,Yn.y+Yn.h,s,ho,Gn.x,ci.y,Kn,Di),wf(Ve,F.x,F.y,Zn.x,Co+Zn.y,Yn.x+Yn.w,Yn.y+Yn.h,s,ho,ci.x,ci.y,Kn,Di),R){const Xr=R.anchor,zi=R.up;Tf(it,Xr.x,Xr.y,Xr.z,zi[0],zi[1],zi[2]),Tf(it,Xr.x,Xr.y,Xr.z,zi[0],zi[1],zi[2]),Tf(it,Xr.x,Xr.y,Xr.z,zi[0],zi[1],zi[2]),Tf(it,Xr.x,Xr.y,Xr.z,zi[0],zi[1],zi[2]),Ef(e.dynamicLayoutVertexArray,Xr.x,Xr.y,Xr.z,Lt)}else Ef(e.dynamicLayoutVertexArray,F.x,F.y,F.z,Lt);Oe.emplaceBack(Ei,Ei+1,Ei+2),Oe.emplaceBack(Ei+1,Ei+2,Ei+3),bt.vertexLength+=4,bt.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(so[0]),hn!==n.length-1&&wr===n[hn+1].sectionIndex||e.programConfigurations.populatePaintArrays(Ve.length,y,y.index,{},_e,we,St&&St[wr])}const fn=R?R.anchor:F;e.placedSymbolArray.emplaceBack(fn.x,fn.y,fn.z,F.x,F.y,rt,this.glyphOffsetArray.length-rt,vt,W,te,F.segment,s?s[0]:0,s?s[1]:0,h[0],h[1],T,0,!1,0,re,0)}_commitLayoutVertex(e,n,s,h,p,y,T){e.emplaceBack(n,s,h,p,y,Math.round(T.x),Math.round(T.y))}_addCollisionDebugVertices(e,n,s,h,p,y,T){const R=s.segments.prepareSegment(4,s.layoutVertexArray,s.indexArray),F=R.vertexLength,W=T.tileAnchorX,te=T.tileAnchorY;for(let _e=0;_e<4;_e++)s.collisionVertexArray.emplaceBack(0,0,0,0);s.collisionVertexArrayExt.emplaceBack(n,-e.padding,-e.padding),s.collisionVertexArrayExt.emplaceBack(n,e.padding,-e.padding),s.collisionVertexArrayExt.emplaceBack(n,e.padding,e.padding),s.collisionVertexArrayExt.emplaceBack(n,-e.padding,e.padding),this._commitLayoutVertex(s.layoutVertexArray,h,p,y,W,te,new Ke(e.x1,e.y1)),this._commitLayoutVertex(s.layoutVertexArray,h,p,y,W,te,new Ke(e.x2,e.y1)),this._commitLayoutVertex(s.layoutVertexArray,h,p,y,W,te,new Ke(e.x2,e.y2)),this._commitLayoutVertex(s.layoutVertexArray,h,p,y,W,te,new Ke(e.x1,e.y2)),R.vertexLength+=4;const re=s.indexArray;re.emplaceBack(F,F+1),re.emplaceBack(F+1,F+2),re.emplaceBack(F+2,F+3),re.emplaceBack(F+3,F),R.primitiveLength+=4}_addTextDebugCollisionBoxes(e,n,s,h,p,y){for(let T=h;T<p;T++){const R=s.get(T),F=this.getSymbolInstanceTextSize(e,y,n,T);this._addCollisionDebugVertices(R,F,this.textCollisionBox,R.projectedAnchorX,R.projectedAnchorY,R.projectedAnchorZ,y)}}_addIconDebugCollisionBoxes(e,n,s,h,p,y){for(let T=h;T<p;T++){const R=s.get(T),F=this.getSymbolInstanceIconSize(e,n,T);this._addCollisionDebugVertices(R,F,this.iconCollisionBox,R.projectedAnchorX,R.projectedAnchorY,R.projectedAnchorZ,y)}}generateCollisionDebugBuffers(e,n){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Dm(S,cg.members,Pr),this.iconCollisionBox=new Dm(S,cg.members,Pr);const s=Td(this.iconSizeData,e),h=Td(this.textSizeData,e);for(let p=0;p<this.symbolInstances.length;p++){const y=this.symbolInstances.get(p);this._addTextDebugCollisionBoxes(h,e,n,y.textBoxStartIndex,y.textBoxEndIndex,y),this._addTextDebugCollisionBoxes(h,e,n,y.verticalTextBoxStartIndex,y.verticalTextBoxEndIndex,y),this._addIconDebugCollisionBoxes(s,e,n,y.iconBoxStartIndex,y.iconBoxEndIndex,y),this._addIconDebugCollisionBoxes(s,e,n,y.verticalIconBoxStartIndex,y.verticalIconBoxEndIndex,y)}}getSymbolInstanceTextSize(e,n,s,h){const p=this.text.placedSymbolArray.get(n.rightJustifiedTextSymbolIndex>=0?n.rightJustifiedTextSymbolIndex:n.centerJustifiedTextSymbolIndex>=0?n.centerJustifiedTextSymbolIndex:n.leftJustifiedTextSymbolIndex>=0?n.leftJustifiedTextSymbolIndex:n.verticalPlacedTextSymbolIndex>=0?n.verticalPlacedTextSymbolIndex:h),y=up(this.textSizeData,e,p)/24;return this.tilePixelRatio*y}getSymbolInstanceIconSize(e,n,s){const h=this.icon.placedSymbolArray.get(s),p=up(this.iconSizeData,e,h);return this.tilePixelRatio*p}_commitDebugCollisionVertexUpdate(e,n,s){e.emplaceBack(n,-s,-s),e.emplaceBack(n,s,-s),e.emplaceBack(n,s,s),e.emplaceBack(n,-s,s)}_updateTextDebugCollisionBoxes(e,n,s,h,p,y){for(let T=h;T<p;T++){const R=s.get(T),F=this.getSymbolInstanceTextSize(e,y,n,T);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,F,R.padding)}}_updateIconDebugCollisionBoxes(e,n,s,h,p){for(let y=h;y<p;y++){const T=s.get(y),R=this.getSymbolInstanceIconSize(e,n,y);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,R,T.padding)}}updateCollisionDebugBuffers(e,n){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const s=Td(this.iconSizeData,e),h=Td(this.textSizeData,e);for(let p=0;p<this.symbolInstances.length;p++){const y=this.symbolInstances.get(p);this._updateTextDebugCollisionBoxes(h,e,n,y.textBoxStartIndex,y.textBoxEndIndex,y),this._updateTextDebugCollisionBoxes(h,e,n,y.verticalTextBoxStartIndex,y.verticalTextBoxEndIndex,y),this._updateIconDebugCollisionBoxes(s,e,n,y.iconBoxStartIndex,y.iconBoxEndIndex),this._updateIconDebugCollisionBoxes(s,e,n,y.verticalIconBoxStartIndex,y.verticalIconBoxEndIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,n,s,h,p,y,T,R,F){const W={};for(let te=n;te<s;te++){const re=e.get(te);W.textBox={x1:re.x1,y1:re.y1,x2:re.x2,y2:re.y2,padding:re.padding,projectedAnchorX:re.projectedAnchorX,projectedAnchorY:re.projectedAnchorY,projectedAnchorZ:re.projectedAnchorZ,tileAnchorX:re.tileAnchorX,tileAnchorY:re.tileAnchorY},W.textFeatureIndex=re.featureIndex;break}for(let te=h;te<p;te++){const re=e.get(te);W.verticalTextBox={x1:re.x1,y1:re.y1,x2:re.x2,y2:re.y2,padding:re.padding,projectedAnchorX:re.projectedAnchorX,projectedAnchorY:re.projectedAnchorY,projectedAnchorZ:re.projectedAnchorZ,tileAnchorX:re.tileAnchorX,tileAnchorY:re.tileAnchorY},W.verticalTextFeatureIndex=re.featureIndex;break}for(let te=y;te<T;te++){const re=e.get(te);W.iconBox={x1:re.x1,y1:re.y1,x2:re.x2,y2:re.y2,padding:re.padding,projectedAnchorX:re.projectedAnchorX,projectedAnchorY:re.projectedAnchorY,projectedAnchorZ:re.projectedAnchorZ,tileAnchorX:re.tileAnchorX,tileAnchorY:re.tileAnchorY},W.iconFeatureIndex=re.featureIndex;break}for(let te=R;te<F;te++){const re=e.get(te);W.verticalIconBox={x1:re.x1,y1:re.y1,x2:re.x2,y2:re.y2,padding:re.padding,projectedAnchorX:re.projectedAnchorX,projectedAnchorY:re.projectedAnchorY,projectedAnchorZ:re.projectedAnchorZ,tileAnchorX:re.tileAnchorX,tileAnchorY:re.tileAnchorY},W.verticalIconFeatureIndex=re.featureIndex;break}return W}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let n=0;n<this.symbolInstances.length;n++){const s=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,s.textBoxStartIndex,s.textBoxEndIndex,s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s.iconBoxStartIndex,s.iconBoxEndIndex,s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,n){const s=e.placedSymbolArray.get(n),h=s.vertexStartIndex+4*s.numGlyphs;for(let p=s.vertexStartIndex;p<h;p+=4)e.indexArray.emplaceBack(p,p+1,p+2),e.indexArray.emplaceBack(p+1,p+2,p+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const n=Math.sin(e),s=Math.cos(e),h=[],p=[],y=[];for(let T=0;T<this.symbolInstances.length;++T){y.push(T);const R=this.symbolInstances.get(T);h.push(0|Math.round(n*R.tileAnchorX+s*R.tileAnchorY)),p.push(R.featureIndex)}return y.sort((T,R)=>h[T]-h[R]||p[R]-p[T]),y}addToSortKeyRanges(e,n){const s=this.sortKeyRanges[this.sortKeyRanges.length-1];s&&s.sortKey===n?s.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const n of this.symbolInstanceIndexes){const s=this.symbolInstances.get(n);this.featureSortOrder.push(s.featureIndex),[s.rightJustifiedTextSymbolIndex,s.centerJustifiedTextSymbolIndex,s.leftJustifiedTextSymbolIndex].forEach((h,p,y)=>{h>=0&&y.indexOf(h)===p&&this.addIndicesForPlacedSymbol(this.text,h)}),s.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,s.verticalPlacedTextSymbolIndex),s.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,s.placedIconSymbolIndex),s.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,s.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Oi(Gu,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Gu.MAX_GLYPHS=65535,Gu.addDynamicAttributes=Ef;const Bg=new Ln({"symbol-placement":new Ct(qt.layout_symbol["symbol-placement"]),"symbol-spacing":new Ct(qt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ct(qt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Vt(qt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ct(qt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ct(qt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Ct(qt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ct(qt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ct(qt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Vt(qt.layout_symbol["icon-size"]),"icon-text-fit":new Ct(qt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ct(qt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Vt(qt.layout_symbol["icon-image"]),"icon-rotate":new Vt(qt.layout_symbol["icon-rotate"]),"icon-padding":new Ct(qt.layout_symbol["icon-padding"]),"icon-keep-upright":new Ct(qt.layout_symbol["icon-keep-upright"]),"icon-offset":new Vt(qt.layout_symbol["icon-offset"]),"icon-anchor":new Vt(qt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ct(qt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ct(qt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ct(qt.layout_symbol["text-rotation-alignment"]),"text-field":new Vt(qt.layout_symbol["text-field"]),"text-font":new Vt(qt.layout_symbol["text-font"]),"text-size":new Vt(qt.layout_symbol["text-size"]),"text-max-width":new Vt(qt.layout_symbol["text-max-width"]),"text-line-height":new Vt(qt.layout_symbol["text-line-height"]),"text-letter-spacing":new Vt(qt.layout_symbol["text-letter-spacing"]),"text-justify":new Vt(qt.layout_symbol["text-justify"]),"text-radial-offset":new Vt(qt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ct(qt.layout_symbol["text-variable-anchor"]),"text-anchor":new Vt(qt.layout_symbol["text-anchor"]),"text-max-angle":new Ct(qt.layout_symbol["text-max-angle"]),"text-writing-mode":new Ct(qt.layout_symbol["text-writing-mode"]),"text-rotate":new Vt(qt.layout_symbol["text-rotate"]),"text-padding":new Ct(qt.layout_symbol["text-padding"]),"text-keep-upright":new Ct(qt.layout_symbol["text-keep-upright"]),"text-transform":new Vt(qt.layout_symbol["text-transform"]),"text-offset":new Vt(qt.layout_symbol["text-offset"]),"text-allow-overlap":new Ct(qt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Ct(qt.layout_symbol["text-ignore-placement"]),"text-optional":new Ct(qt.layout_symbol["text-optional"])});var Sm={paint:new Ln({"icon-opacity":new Vt(qt.paint_symbol["icon-opacity"]),"icon-color":new Vt(qt.paint_symbol["icon-color"]),"icon-halo-color":new Vt(qt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Vt(qt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Vt(qt.paint_symbol["icon-halo-blur"]),"icon-translate":new Ct(qt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ct(qt.paint_symbol["icon-translate-anchor"]),"text-opacity":new Vt(qt.paint_symbol["text-opacity"]),"text-color":new Vt(qt.paint_symbol["text-color"],{runtimeType:Gi,getOverride:t=>t.textColor,hasOverride:t=>!!t.textColor}),"text-halo-color":new Vt(qt.paint_symbol["text-halo-color"]),"text-halo-width":new Vt(qt.paint_symbol["text-halo-width"]),"text-halo-blur":new Vt(qt.paint_symbol["text-halo-blur"]),"text-translate":new Ct(qt.paint_symbol["text-translate"]),"text-translate-anchor":new Ct(qt.paint_symbol["text-translate-anchor"])}),layout:Bg};class zg{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:Nr,this.defaultValue=e}evaluate(e){if(e.formattedSection){const n=this.defaultValue.property.overrides;if(n&&n.hasOverride(e.formattedSection))return n.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Oi(zg,"FormatSectionOverride",{omit:["defaultValue"]});class Cf extends Lc{constructor(e){super(e,Sm)}recalculate(e,n){super.recalculate(e,n),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const s=this.layout.get("text-writing-mode");if(s){const h=[];for(const p of s)h.indexOf(p)<0&&h.push(p);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,n,s,h){const p=this.layout.get(e).evaluate(n,{},s,h),y=this._unevaluatedLayout._values[e];return y.isDataDriven()||Vn(y.value)||!p?p:(T=n.properties,p.replace(/{([^{}]+)}/g,(F,W)=>W in T?String(T[W]):""));var T}createBucket(e){return new Gu(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of Sm.paint.overridableProperties){if(!Cf.hasPaintOverride(this.layout,e))continue;const n=this.paint.get(e),s=new zg(n),h=new Bn(s,n.property.specification);let p=null;p="constant"===n.value.kind||"source"===n.value.kind?new Ii("source",h):new pr("composite",h,n.value.zoomStops,n.value._interpolationType),this.paint._values[e]=new yt(n.property,p,n.parameters)}}_handleOverridablePaintPropertyUpdate(e,n,s){return!(!this.layout||n.isDataDriven()||s.isDataDriven())&&Cf.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,n){const s=e.get("text-field"),h=Sm.paint.properties[n];let p=!1;const y=T=>{for(const R of T)if(h.overrides&&h.overrides.hasOverride(R))return void(p=!0)};if("constant"===s.value.kind&&s.value.value instanceof Ir)y(s.value.value.sections);else if("source"===s.value.kind){const T=F=>{p||(F instanceof ua&&lo(F.value)===us?y(F.value.sections):F instanceof zs?y(F.sections):F.eachChild(T))},R=s.value;R._styleExpression&&T(R._styleExpression.expression)}return p}getProgramConfiguration(e){return new Nc(this,e)}}var z_={paint:new Ln({"background-color":new Ct(qt.paint_background["background-color"]),"background-pattern":new ni(qt.paint_background["background-pattern"]),"background-opacity":new Ct(qt.paint_background["background-opacity"])})},Ug={paint:new Ln({"raster-opacity":new Ct(qt.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ct(qt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ct(qt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ct(qt.paint_raster["raster-brightness-max"]),"raster-saturation":new Ct(qt.paint_raster["raster-saturation"]),"raster-contrast":new Ct(qt.paint_raster["raster-contrast"]),"raster-resampling":new Ct(qt.paint_raster["raster-resampling"]),"raster-fade-duration":new Ct(qt.paint_raster["raster-fade-duration"])})};class U_ extends Lc{constructor(e){super(e,{}),this.implementation=e}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}var V_={paint:new Ln({"sky-type":new Ct(qt.paint_sky["sky-type"]),"sky-atmosphere-sun":new Ct(qt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Ct(qt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Ct(qt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Ct(qt.paint_sky["sky-gradient-radius"]),"sky-gradient":new Xt(qt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Ct(qt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Ct(qt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Ct(qt.paint_sky["sky-opacity"])})};function Vg(t,e,n){const s=[0,0,1],h=$p([]);return Xd(h,h,n?-wt(t)+Math.PI:wt(t)),pd(h,h,-wt(e)),Ih(s,s,h),$l(s,s)}const j_={circle:class extends Lc{constructor(t){super(t,__)}createBucket(t){return new Nu(t)}queryRadius(t){const e=t;return Qu("circle-radius",this,e)+Qu("circle-stroke-width",this,e)+Wd(this.paint.get("circle-translate"))}queryIntersectsFeature(t,e,n,s,h,p,y,T){const R=Uc(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),p.angle,t.pixelToTileUnitsFactor),F=this.paint.get("circle-radius").evaluate(e,n)+this.paint.get("circle-stroke-width").evaluate(e,n);return Xf(t,s,p,y,T,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),R,F)}getProgramIds(){return["circle"]}getProgramConfiguration(t){return new Nc(this,t)}},heatmap:class extends Lc{createBucket(t){return new nf(t)}constructor(t){super(t,ie),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){"heatmap-color"===t&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=ve({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(t){return Qu("heatmap-radius",this,t)}queryIntersectsFeature(t,e,n,s,h,p,y,T){const R=this.paint.get("heatmap-radius").evaluate(e,n);return Xf(t,s,p,y,T,!0,!0,new Ke(0,0),R)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(t){return new Nc(this,t)}},hillshade:class extends Lc{constructor(t){super(t,ht)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Lc{constructor(t){super(t,rf)}getProgramIds(){const t=this.paint.get("fill-pattern"),e=t&&t.constantOr(1),n=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&n.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),n}getProgramConfiguration(t){return new Nc(this,t)}recalculate(t,e){super.recalculate(t,e);const n=this.paint._values["fill-outline-color"];"constant"===n.value.kind&&void 0===n.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new bu(t)}queryRadius(){return Wd(this.paint.get("fill-translate"))}queryIntersectsFeature(t,e,n,s,h,p){return!t.queryGeometry.isAboveHorizon&&qd(eh(t.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),p.angle,t.pixelToTileUnitsFactor),s)}isTileClipped(){return!0}},"fill-extrusion":class extends Lc{constructor(t){super(t,oh)}createBucket(t){return new ip(t)}queryRadius(){return Wd(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(t){return new Nc(this,t)}queryIntersectsFeature(t,e,n,s,h,p,y,T,R){const F=Uc(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),p.angle,t.pixelToTileUnitsFactor),W=this.paint.get("fill-extrusion-height").evaluate(e,n),te=this.paint.get("fill-extrusion-base").evaluate(e,n),re=[0,0],_e=T&&p.elevation,we=p.elevation?p.elevation.exaggeration():1,Oe=t.tile.getBucket(this);if(_e&&Oe instanceof ip){const bt=Oe.centroidVertexArray,rt=R+1;if(rt<bt.length){const vt=bt.get(rt);re[0]=vt.a_centroid_pos0,re[1]=vt.a_centroid_pos1}}if(0===re[0]&&1===re[1])return!1;"globe"===p.projection.name&&(s=sp([s],[new Ke(0,0),new Ke(Fr,Fr)],t.tileID.canonical).map(bt=>bt.polygon).flat());const Ve=(rt=s,vt=te,Lt=W,St=F,fn=y,hn=_e?T:null,bn=re,hi=we,Tn=p.center.lat,"globe"===(bt=p).projection.name?function(Yn,Gn,ci,Kn,Di,so,ho,wr,Ei,Co,Xr){const zi=[],Cs=[],Fo=Yn.projection.upVectorScale(Xr,Yn.center.lat,Yn.worldSize).metersToTile,sa=[0,0,0,1],go=[0,0,0,1],_o=(ko,ys,$s,ga)=>{ko[0]=ys,ko[1]=$s,ko[2]=ga,ko[3]=1},Bo=em();ci>0&&(ci+=Bo),Kn+=Bo;for(const ko of Gn){const ys=[],$s=[];for(const ga of ko){const Ml=ga.x+Di.x,cc=ga.y+Di.y,zo=Yn.projection.projectTilePoint(Ml,cc,Xr),_a=Yn.projection.upVector(Xr,ga.x,ga.y);let ll=ci,is=Kn;if(ho){const aa=Lh(Ml,cc,ci,Kn,ho,wr,Ei,Co);ll+=aa.base,is+=aa.top}0!==ci?_o(sa,zo.x+_a[0]*Fo*ll,zo.y+_a[1]*Fo*ll,zo.z+_a[2]*Fo*ll):_o(sa,zo.x,zo.y,zo.z),_o(go,zo.x+_a[0]*Fo*is,zo.y+_a[1]*Fo*is,zo.z+_a[2]*Fo*is),$a(sa,sa,so),$a(go,go,so),ys.push(sh(sa)),$s.push(sh(go))}zi.push(ys),Cs.push($s)}return[zi,Cs]}(bt,rt,vt,Lt,St,fn,hn,bn,hi,Tn,t.tileID.canonical):hn?function(Yn,Gn,ci,Kn,Di,so,ho,wr,Ei){const Co=[],Xr=[],zi=[0,0,0,1];for(const Cs of Yn){const Fo=[],sa=[];for(const go of Cs){const _o=go.x+Kn.x,Bo=go.y+Kn.y,ko=Lh(_o,Bo,Gn,ci,so,ho,wr,Ei);zi[0]=_o,zi[1]=Bo,zi[2]=ko.base,zi[3]=1,zu(zi,zi,Di),zi[3]=Math.max(zi[3],1e-5);const ys=sh([zi[0]/zi[3],zi[1]/zi[3],zi[2]/zi[3]]);zi[0]=_o,zi[1]=Bo,zi[2]=ko.top,zi[3]=1,zu(zi,zi,Di),zi[3]=Math.max(zi[3],1e-5);const $s=sh([zi[0]/zi[3],zi[1]/zi[3],zi[2]/zi[3]]);Fo.push(ys),sa.push($s)}Co.push(Fo),Xr.push(sa)}return[Co,Xr]}(rt,vt,Lt,St,fn,hn,bn,hi,Tn):function(Yn,Gn,ci,Kn,Di){const so=[],ho=[],wr=Di[8]*Gn,Ei=Di[9]*Gn,Co=Di[10]*Gn,Xr=Di[11]*Gn,zi=Di[8]*ci,Cs=Di[9]*ci,Fo=Di[10]*ci,sa=Di[11]*ci;for(const go of Yn){const _o=[],Bo=[];for(const ko of go){const ys=ko.x+Kn.x,$s=ko.y+Kn.y,ga=Di[0]*ys+Di[4]*$s+Di[12],Ml=Di[1]*ys+Di[5]*$s+Di[13],cc=Di[2]*ys+Di[6]*$s+Di[14],zo=Di[3]*ys+Di[7]*$s+Di[15],_a=ga+wr,ll=Ml+Ei,is=cc+Co,aa=Math.max(zo+Xr,1e-5),Ql=ga+zi,Js=Ml+Cs,Ra=cc+Fo,tl=Math.max(zo+sa,1e-5),gl=new Ke(_a/aa,ll/aa);gl.z=is/aa,_o.push(gl);const Il=new Ke(Ql/tl,Js/tl);Il.z=Ra/tl,Bo.push(Il)}so.push(_o),ho.push(Bo)}return[so,ho]}(rt,vt,Lt,St,fn)),it=t.queryGeometry;var bt,rt,vt,Lt,St,fn,hn,bn,hi,Tn;return function(bt,rt,vt){let Lt=1/0;qd(vt,rt)&&(Lt=rg(vt,rt[0]));for(let St=0;St<rt.length;St++){const fn=rt[St],hn=bt[St];for(let bn=0;bn<fn.length-1;bn++){const hi=fn[bn],Tn=[hi,fn[bn+1],hn[bn+1],hn[bn],hi];$d(vt,Tn)&&(Lt=Math.min(Lt,rg(vt,Tn)))}}return Lt!==1/0&&Lt}(Ve[0],Ve[1],it.isPointQuery()?it.screenBounds:it.screenGeometry)}},line:class extends Lc{constructor(t){super(t,cp),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(t){if("line-gradient"===t){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof Ui,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,e){super.recalculate(t,e),this.paint._values["line-floorwidth"]=rm.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new lf(t)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(t){return new Nc(this,t)}queryRadius(t){const e=t,n=cf(Qu("line-width",this,e),Qu("line-gap-width",this,e)),s=Qu("line-offset",this,e);return n/2+Math.abs(s)+Wd(this.paint.get("line-translate"))}queryIntersectsFeature(t,e,n,s,h,p){if(t.queryGeometry.isAboveHorizon)return!1;const y=eh(t.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),p.angle,t.pixelToTileUnitsFactor),T=t.pixelToTileUnitsFactor/2*cf(this.paint.get("line-width").evaluate(e,n),this.paint.get("line-gap-width").evaluate(e,n)),R=this.paint.get("line-offset").evaluate(e,n);return R&&(s=function(F,W){const te=[],re=new Ke(0,0);for(let _e=0;_e<F.length;_e++){const we=F[_e],Oe=[];for(let Ve=0;Ve<we.length;Ve++){const it=we[Ve-1],bt=we[Ve],rt=we[Ve+1],vt=0===Ve?re:bt.sub(it)._unit()._perp(),Lt=Ve===we.length-1?re:rt.sub(bt)._unit()._perp(),St=vt._add(Lt)._unit();St._mult(1/(St.x*Lt.x+St.y*Lt.y)),Oe.push(St._mult(W)._add(bt))}te.push(Oe)}return te}(s,R*t.pixelToTileUnitsFactor)),function(F,W,te){for(let re=0;re<W.length;re++){const _e=W[re];if(F.length>=3)for(let we=0;we<_e.length;we++)if(Lu(F,_e[we]))return!0;if(jf(F,_e,te))return!0}return!1}(y,s,T)}isTileClipped(){return!0}},symbol:Cf,background:class extends Lc{constructor(t){super(t,z_)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Lc{constructor(t){super(t,Ug)}getProgramIds(){return["raster"]}},sky:class extends Lc{constructor(t){super(t,V_),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){"sky-gradient"===t?this._updateColorRamp():"sky-atmosphere-sun"!==t&&"sky-atmosphere-halo-color"!==t&&"sky-atmosphere-color"!==t&&"sky-atmosphere-sun-intensity"!==t||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=ve({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(t){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=t.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(t,e){if("atmosphere"===this.paint.get("sky-type")){const s=this.paint.get("sky-atmosphere-sun"),h=!s,p=t.style.light,y=p.properties.get("position");return h&&"viewport"===p.properties.get("anchor")&&Mi("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),h?Vg(y.azimuthal,90-y.polar,e):Vg(s[0],90-s[1],e)}const n=this.paint.get("sky-gradient-center");return Vg(n[0],90-n[1],e)}is3D(){return!1}isSky(){return!0}markSkyboxValid(t){this._skyboxInvalidated=!1,this._lightPosition=t.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const t=this.paint.get("sky-type");return"atmosphere"===t?["skyboxCapture","skybox"]:"gradient"===t?["skyboxGradient"]:null}}};class $h{constructor(e,n,s,h){this.context=e,this.format=s,this.texture=e.gl.createTexture(),this.update(n,h)}update(e,n,s){const{width:h,height:p}=e,{context:y}=this,{gl:T}=y,{HTMLImageElement:R,HTMLCanvasElement:F,HTMLVideoElement:W,ImageData:te,ImageBitmap:re}=oe;if(T.bindTexture(T.TEXTURE_2D,this.texture),y.pixelStoreUnpackFlipY.set(!1),y.pixelStoreUnpack.set(1),y.pixelStoreUnpackPremultiplyAlpha.set(this.format===T.RGBA&&(!n||!1!==n.premultiply)),s||this.size&&this.size[0]===h&&this.size[1]===p){const{x:_e,y:we}=s||{x:0,y:0};e instanceof R||e instanceof F||e instanceof W||e instanceof te||re&&e instanceof re?T.texSubImage2D(T.TEXTURE_2D,0,_e,we,T.RGBA,T.UNSIGNED_BYTE,e):T.texSubImage2D(T.TEXTURE_2D,0,_e,we,h,p,T.RGBA,T.UNSIGNED_BYTE,e.data)}else this.size=[h,p],e instanceof R||e instanceof F||e instanceof W||e instanceof te||re&&e instanceof re?T.texImage2D(T.TEXTURE_2D,0,this.format,this.format,T.UNSIGNED_BYTE,e):T.texImage2D(T.TEXTURE_2D,0,this.format,h,p,0,this.format,T.UNSIGNED_BYTE,e.data);this.useMipmap=Boolean(n&&n.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&T.generateMipmap(T.TEXTURE_2D)}bind(e,n){const{context:s}=this,{gl:h}=s;h.bindTexture(h.TEXTURE_2D,this.texture),e!==this.filter&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,e),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,this.useMipmap?e===h.NEAREST?h.NEAREST_MIPMAP_NEAREST:h.LINEAR_MIPMAP_NEAREST:e),this.filter=e),n!==this.wrap&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,n),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,n),this.wrap=n)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class Df{constructor(e,n){this.width=e,this.height=n,this.nextRow=0,this.image=new _({width:e,height:n}),this.positions={},this.uploaded=!1}getDash(e,n){const s=this.getKey(e,n);return this.positions[s]}trim(){const e=this.width,n=this.height=Ci(this.nextRow);this.image.resize({width:e,height:n})}getKey(e,n){return e.join(",")+n}getDashRanges(e,n,s){const h=[];let p=e.length%2==1?-e[e.length-1]*s:0,y=e[0]*s,T=!0;h.push({left:p,right:y,isDash:T,zeroLength:0===e[0]});let R=e[0];for(let F=1;F<e.length;F++){T=!T;const W=e[F];p=R*s,R+=W,y=R*s,h.push({left:p,right:y,isDash:T,zeroLength:0===W})}return h}addRoundDash(e,n,s){const h=n/2;for(let p=-s;p<=s;p++){const y=this.width*(this.nextRow+s+p);let T=0,R=e[T];for(let F=0;F<this.width;F++){F/R.right>1&&(R=e[++T]);const W=Math.abs(F-R.left),te=Math.abs(F-R.right),re=Math.min(W,te);let _e;const we=p/s*(h+1);if(R.isDash){const Oe=h-Math.abs(we);_e=Math.sqrt(re*re+Oe*Oe)}else _e=h-Math.sqrt(re*re+we*we);this.image.data[y+F]=Math.max(0,Math.min(255,_e+128))}}}addRegularDash(e,n){for(let R=e.length-1;R>=0;--R){const F=e[R],W=e[R+1];F.zeroLength?e.splice(R,1):W&&W.isDash===F.isDash&&(W.left=F.left,e.splice(R,1))}const s=e[0],h=e[e.length-1];s.isDash===h.isDash&&(s.left=h.left-this.width,h.right=s.right+this.width);const p=this.width*this.nextRow;let y=0,T=e[y];for(let R=0;R<this.width;R++){R/T.right>1&&(T=e[++y]);const F=Math.abs(R-T.left),W=Math.abs(R-T.right),te=Math.min(F,W);this.image.data[p+R]=Math.max(0,Math.min(255,(T.isDash?te:-te)+n+128))}}addDash(e,n){const s=this.getKey(e,n);if(this.positions[s])return this.positions[s];const h="round"===n,p=h?7:0,y=2*p+1;if(this.nextRow+y>this.height)return Mi("LineAtlas out of space"),null;0===e.length&&e.push(1);let T=0;for(let W=0;W<e.length;W++)e[W]<0&&(Mi("Negative value is found in line dasharray, replacing values with 0"),e[W]=0),T+=e[W];if(0!==T){const W=this.width/T,te=this.getDashRanges(e,this.width,W);h?this.addRoundDash(te,W,p):this.addRegularDash(te,"square"===n?.5*W:0)}const R=this.nextRow+p;this.nextRow+=y;const F={tl:[R,p],br:[T,0]};return this.positions[s]=F,F}}Oi(Df,"LineAtlas");class Z_{constructor(e){this._callback=e,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class Yy{constructor(){this.tasks={},this.taskQueue=[],$t(["process"],this),this.invoker=new Z_(this.process),this.nextId=0}add(e,n){const s=this.nextId++,h=function({type:p,isSymbolTile:y,zoom:T}){return T=T||0,"message"===p?0:"maybePrepare"!==p||y?"parseTile"!==p||y?"parseTile"===p&&y?300-T:"maybePrepare"===p&&y?400-T:500:200-T:100-T}(n);if(0===h){_i();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[s]={fn:e,metadata:n,priority:h,id:s},this.taskQueue.push(s),this.invoker.trigger(),{cancel:()=>{delete this.tasks[s]}}}process(){_i();try{if(this.taskQueue=this.taskQueue.filter(s=>!!this.tasks[s]),!this.taskQueue.length)return;const e=this.pick();if(null===e)return;const n=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!n)return;n.fn()}finally{}}pick(){let e=null,n=1/0;for(let h=0;h<this.taskQueue.length;h++){const p=this.tasks[this.taskQueue[h]];p.priority<n&&(n=p.priority,e=h)}if(null===e)return null;const s=this.taskQueue[e];return this.taskQueue.splice(e,1),s}remove(){this.invoker.remove()}}class G_{constructor(e){this._stringToNumber={},this._numberToString=[];for(let n=0;n<e.length;n++){const s=e[n];this._stringToNumber[s]=n,this._numberToString[n]=s}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}const Ky=["tile","layer","source","sourceLayer","state"];class jg{constructor(e,n,s,h,p){this.type="Feature",this._vectorTileFeature=e,this._z=n,this._x=s,this._y=h,this.properties=e.properties,this.id=p}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",geometry:this.geometry,properties:this.properties};void 0!==this.id&&(e.id=this.id);for(const n of Ky)void 0!==this[n]&&(e[n]=this[n]);return e}}const hh=new Uint16Array(8184);for(let t=0;t<2046;t++){let e=t+2,n=0,s=0,h=0,p=0,y=0,T=0;for(1&e?h=p=y=32:n=s=T=32;(e>>=1)>1;){const F=n+h>>1,W=s+p>>1;1&e?(h=n,p=s,n=y,s=T):(n=h,s=p,h=y,p=T),y=F,T=W}const R=4*t;hh[R+0]=n,hh[R+1]=s,hh[R+2]=h,hh[R+3]=p}const lc=new Uint16Array(2178),dh=new Uint8Array(1089),Sf=new Uint16Array(1089);function Zg(t){return 0===t?-.03125:32===t?.03125:0}var Am=Un([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const Af={type:2,extent:Fr,loadGeometry:()=>[[new Ke(0,0),new Ke(8193,0),new Ke(8193,8193),new Ke(0,8193),new Ke(0,0)]]};class Mm{constructor(e,n,s,h,p){this.tileID=e,this.uid=ii(),this.uses=0,this.tileSize=n,this.tileZoom=s,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=p,this.expiredRequestCount=0,this.state="loading",h&&h.transform&&(this.projection=h.transform.projection)}registerFadeDuration(e){const n=e+this.timeAdded;n<Zr.now()||this.fadeEndTime&&n<this.fadeEndTime||(this.fadeEndTime=n)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=jh(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,n,s){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(h,p){const y={};if(!p)return y;for(const T of h){const R=T.layerIds.map(F=>p.getLayer(F)).filter(Boolean);if(0!==R.length){T.layers=R,T.stateDependentLayerIds&&(T.stateDependentLayers=T.stateDependentLayerIds.map(F=>R.filter(W=>W.id===F)[0]));for(const F of R)y[F.id]=T}}return y}(e.buckets,n.style),this.hasSymbolBuckets=!1;for(const h in this.buckets){const p=this.buckets[h];if(p instanceof Gu){if(this.hasSymbolBuckets=!0,!s)break;p.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const h in this.buckets){const p=this.buckets[h];if(p instanceof Gu&&p.hasRTLText){this.hasRTLText=!0,Ge.isLoading()||Ge.isLoaded()||"deferred"!==Fe()||Je();break}}this.queryPadding=0;for(const h in this.buckets){const p=this.buckets[h];this.queryPadding=Math.max(this.queryPadding,n.style.getLayer(h).queryRadius(p))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new qo}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.id]}upload(e){for(const s in this.buckets){const h=this.buckets[s];h.uploadPending()&&h.upload(e)}const n=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new $h(e,this.imageAtlas.image,n.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new $h(e,this.glyphAtlasImage,n.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new $h(e,this.lineAtlas.image,n.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,n,s,h,p,y,T,R){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:h,pixelPosMatrix:T,transform:y,params:p,tileTransform:this.tileTransform},e,n,s):{}}querySourceFeatures(e,n){const s=this.latestFeatureIndex;if(!s||!s.rawTileData)return;const h=s.loadVTLayers(),p=n?n.sourceLayer:"",y=h._geojsonTileLayer||h[p];if(!y)return;const T=Os(n&&n.filter),{z:R,x:F,y:W}=this.tileID.canonical,te={z:R,x:F,y:W};for(let re=0;re<y.length;re++){const _e=y.feature(re);if(T.needGeometry){const Ve=Qc(_e,!0);if(!T.filter(new He(this.tileID.overscaledZ),Ve,this.tileID.canonical))continue}else if(!T.filter(new He(this.tileID.overscaledZ),_e))continue;const we=s.getId(_e,p),Oe=new jg(_e,R,F,W,we);Oe.tile=te,e.push(Oe)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const n=this.expirationTime;if(e.cacheControl){const s=Ki(e.cacheControl);s["max-age"]&&(this.expirationTime=Date.now()+1e3*s["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const s=Date.now();let h=!1;if(this.expirationTime>s)h=!1;else if(n)if(this.expirationTime<n)h=!0;else{const p=this.expirationTime-n;p?this.expirationTime=s+Math.max(p,3e4):h=!0}else h=!0;h?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(e,n){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(e).length||!n)return;const s=this.latestFeatureIndex.loadVTLayers(),h=n.style.listImages();for(const p in this.buckets){if(!n.style.hasLayer(p))continue;const y=this.buckets[p],T=y.layers[0].sourceLayer||"_geojsonTileLayer",R=s[T],F=e[T];if(!R||!F||0===Object.keys(F).length)continue;if(y.update(F,R,h,this.imageAtlas&&this.imageAtlas.patternPositions||{}),y instanceof lf||y instanceof bu){const te=n.style._getSourceCache(y.layers[0].source);n._terrain&&n._terrain.enabled&&te&&y.programConfigurations.needsUpload&&n._terrain._clearRenderCacheForTile(te.id,this.tileID)}const W=n&&n.style&&n.style.getLayer(p);W&&(this.queryPadding=Math.max(this.queryPadding,W.queryRadius(y)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Zr.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=Zr.now()+e}setTexture(e,n){const s=n.context,h=s.gl;this.texture=n.getTileTexture(e.width),this.texture?this.texture.update(e,{useMipmap:!0}):(this.texture=new $h(s,e,h.RGBA,{useMipmap:!0}),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE),s.extTextureFilterAnisotropic&&h.texParameterf(h.TEXTURE_2D,s.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,s.extTextureFilterAnisotropicMax))}setDependencies(e,n){const s={};for(const h of n)s[h]=!0;this.dependencies[e]=s}hasDependency(e,n){for(const s of e){const h=this.dependencies[s];if(h)for(const p of n)if(h[p])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,n){if(!n||"mercator"===n.name||this._tileDebugBuffer)return;const s=zc(Af,this.tileID.canonical,this.tileTransform)[0],h=new gi,p=new oo;for(let y=0;y<s.length;y++){const{x:T,y:R}=s[y];h.emplaceBack(T,R),p.emplaceBack(y)}p.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(p),this._tileDebugBuffer=e.createVertexBuffer(h,Ep.members),this._tileDebugSegments=Ha.simpleSegment(0,0,h.length,p.length)}_makeTileBoundsBuffers(e,n){if(this._tileBoundsBuffer||!n||"mercator"===n.name)return;const s=zc(Af,this.tileID.canonical,this.tileTransform)[0];let h,p;if(this.isRaster){const y=function(T,R){const F=jh(T,R),W=Math.pow(2,T.z);for(let Ve=0;Ve<33;Ve++)for(let it=0;it<33;it++){const bt=Al((T.x+(it+Zg(it))/32)/W),rt=Qa((T.y+(Ve+Zg(Ve))/32)/W),vt=R.project(bt,rt),Lt=33*Ve+it;lc[2*Lt+0]=Math.round((vt.x*F.scale-F.x)*Fr),lc[2*Lt+1]=Math.round((vt.y*F.scale-F.y)*Fr)}dh.fill(0),Sf.fill(0);for(let Ve=2045;Ve>=0;Ve--){const it=4*Ve,bt=hh[it+0],rt=hh[it+1],vt=hh[it+2],Lt=hh[it+3],St=bt+vt>>1,fn=rt+Lt>>1,hn=St+fn-rt,bn=fn+bt-St,hi=33*rt+bt,Tn=33*Lt+vt,Zn=33*fn+St,Yn=Math.hypot((lc[2*hi+0]+lc[2*Tn+0])/2-lc[2*Zn+0],(lc[2*hi+1]+lc[2*Tn+1])/2-lc[2*Zn+1])>=16;if(dh[Zn]=dh[Zn]||(Yn?1:0),Ve<1022){const Gn=33*(rt+bn>>1)+(bt+hn>>1),ci=33*(Lt+bn>>1)+(vt+hn>>1);dh[Zn]=dh[Zn]||dh[Gn]||dh[ci]}}const te=new vr,re=new Qe;let _e=0;function we(Ve,it){const bt=33*it+Ve;return 0===Sf[bt]&&(te.emplaceBack(lc[2*bt+0],lc[2*bt+1],Ve*Fr/32,it*Fr/32),Sf[bt]=++_e),Sf[bt]-1}function Oe(Ve,it,bt,rt,vt,Lt){const St=Ve+bt>>1,fn=it+rt>>1;if(Math.abs(Ve-vt)+Math.abs(it-Lt)>1&&dh[33*fn+St])Oe(vt,Lt,Ve,it,St,fn),Oe(bt,rt,vt,Lt,St,fn);else{const hn=we(Ve,it),bn=we(bt,rt),hi=we(vt,Lt);re.emplaceBack(hn,bn,hi)}}return Oe(0,0,32,32,32,0),Oe(32,32,0,0,0,32),{vertices:te,indices:re}}(this.tileID.canonical,n);h=y.vertices,p=y.indices}else{h=new vr,p=new Qe;for(const{x:T,y:R}of s)h.emplaceBack(T,R,0,0);const y=xn(h.int16,void 0,4);for(let T=0;T<y.length;T+=3)p.emplaceBack(y[T],y[T+1],y[T+2])}this._tileBoundsBuffer=e.createVertexBuffer(h,Am.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(p),this._tileBoundsSegments=Ha.simpleSegment(0,0,h.length,p.length)}_makeGlobeTileDebugBuffers(e,n){const s=n.projection;if(!s||"globe"!==s.name||n.freezeTileCoverage)return;const h=this.tileID.canonical,p=_f(vm(h,n)),y=yf(n.zoom);let T;y>0&&(T=ld(new Float64Array(16),n.globeMatrix));const R=(h.x+.5)/(1<<h.z)-Tc(n.center.lng);let F=0;R>.5?F=-1:R<-.5&&(F=1),this._makeGlobeTileDebugBorderBuffer(e,h,n,p,T,y,F),this._makeGlobeTileDebugTextBuffer(e,h,n,p,T,y,F)}_globePoint(e,n,s,h,p,y,T,R){let F=Uh(e,n,s);if(y){const W=1<<s.z,te=[((e/Fr+s.x)/W+R)*h,(n/Fr+s.y)/W*h,0];$a(te,te,y),F=er(F,te,T)}return $a(F,F,p)}_makeGlobeTileDebugBorderBuffer(e,n,s,h,p,y,T){const R=new gi,F=new oo,W=new $i,te=(_e,we,Oe,Ve,it)=>{const bt=(Oe-_e)/(it-1),rt=(Ve-we)/(it-1),vt=R.length;for(let Lt=0;Lt<it;Lt++){const St=_e+Lt*bt,fn=we+Lt*rt;R.emplaceBack(St,fn);const hn=this._globePoint(St,fn,n,s.worldSize,h,p,y,T);W.emplaceBack(hn[0],hn[1],hn[2]),F.emplaceBack(vt+Lt)}},re=Fr;te(0,0,re,0,16),te(re,0,re,re,16),te(re,re,0,re,16),te(0,re,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(F),this._tileDebugBuffer=e.createVertexBuffer(R,Ep.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(W,Mg.members),this._tileDebugSegments=Ha.simpleSegment(0,0,R.length,F.length)}_makeGlobeTileDebugTextBuffer(e,n,s,h,p,y,T){const R=new gi,F=new Qe,W=new $i;F.reserve(32),R.reserve(25),W.reserve(25);const re=(_e,we)=>25*_e+we;for(let _e=0;_e<25;_e++){const we=2048*_e;for(let Oe=0;Oe<25;Oe++){const Ve=2048*Oe;R.emplaceBack(Ve,we);const it=this._globePoint(Ve,we,n,s.worldSize,h,p,y,T);W.emplaceBack(it[0],it[1],it[2])}}for(let _e=0;_e<4;_e++)for(let we=0;we<4;we++){const Oe=re(_e,we),Ve=re(_e,we+1),it=re(_e+1,we),bt=re(_e+1,we+1);F.emplaceBack(Oe,Ve,it),F.emplaceBack(it,Ve,bt)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(F),this._tileDebugTextBuffer=e.createVertexBuffer(R,Ep.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(W,Mg.members),this._tileDebugTextSegments=Ha.simpleSegment(0,0,25,32)}}class Gg{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,n,s){const h=String(n);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][h]=this.stateChanges[e][h]||{},se(this.stateChanges[e][h],s),null===this.deletedStates[e]){this.deletedStates[e]={};for(const p in this.state[e])p!==h&&(this.deletedStates[e][p]=null)}else if(this.deletedStates[e]&&null===this.deletedStates[e][h]){this.deletedStates[e][h]={};for(const p in this.state[e][h])s[p]||(this.deletedStates[e][h][p]=null)}else for(const p in s)this.deletedStates[e]&&this.deletedStates[e][h]&&null===this.deletedStates[e][h][p]&&delete this.deletedStates[e][h][p]}removeFeatureState(e,n,s){if(null===this.deletedStates[e])return;const h=String(n);if(this.deletedStates[e]=this.deletedStates[e]||{},s&&void 0!==n)null!==this.deletedStates[e][h]&&(this.deletedStates[e][h]=this.deletedStates[e][h]||{},this.deletedStates[e][h][s]=null);else if(void 0!==n)if(this.stateChanges[e]&&this.stateChanges[e][h])for(s in this.deletedStates[e][h]={},this.stateChanges[e][h])this.deletedStates[e][h][s]=null;else this.deletedStates[e][h]=null;else this.deletedStates[e]=null}getState(e,n){const s=String(n),h=se({},(this.state[e]||{})[s],(this.stateChanges[e]||{})[s]);if(null===this.deletedStates[e])return{};if(this.deletedStates[e]){const p=this.deletedStates[e][n];if(null===p)return{};for(const y in p)delete h[y]}return h}initializeTileState(e,n){e.setFeatureState(this.state,n)}coalesceChanges(e,n){const s={};for(const h in this.stateChanges){this.state[h]=this.state[h]||{};const p={};for(const y in this.stateChanges[h])this.state[h][y]||(this.state[h][y]={}),se(this.state[h][y],this.stateChanges[h][y]),p[y]=this.state[h][y];s[h]=p}for(const h in this.deletedStates){this.state[h]=this.state[h]||{};const p={};if(null===this.deletedStates[h])for(const y in this.state[h])p[y]={},this.state[h][y]={};else for(const y in this.deletedStates[h]){if(null===this.deletedStates[h][y])this.state[h][y]={};else for(const T of Object.keys(this.deletedStates[h][y]))delete this.state[h][y][T];p[y]=this.state[h][y]}s[h]=s[h]||{},se(s[h],p)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(s).length)for(const h in e)e[h].setFeatureState(s,n)}}class Hg{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,n){const s=this.toIdx(e,n);return{min:this.minimums[s],max:this.maximums[s]}}isLeaf(e,n){return this.leaves[this.toIdx(e,n)]}toIdx(e,n){return n*this.size+e}}function $g(t,e,n,s){let h=0,p=Number.MAX_VALUE;for(let y=0;y<3;y++)if(Math.abs(s[y])<1e-15){if(n[y]<t[y]||n[y]>e[y])return null}else{const T=1/s[y];let R=(t[y]-n[y])*T,F=(e[y]-n[y])*T;if(R>F){const W=R;R=F,F=W}if(R>h&&(h=R),F<p&&(p=F),h>p)return null}return h}function qg(t,e,n,s,h,p,y,T,R,F,W){const te=s-t,re=h-e,_e=p-n,we=y-t,Oe=T-e,Ve=R-n,it=W[1]*Ve-W[2]*Oe,bt=W[2]*we-W[0]*Ve,rt=W[0]*Oe-W[1]*we,vt=te*it+re*bt+_e*rt;if(Math.abs(vt)<1e-15)return null;const Lt=1/vt,St=F[0]-t,fn=F[1]-e,hn=F[2]-n,bn=(St*it+fn*bt+hn*rt)*Lt;if(bn<0||bn>1)return null;const hi=fn*_e-hn*re,Tn=hn*te-St*_e,Zn=St*re-fn*te,Yn=(W[0]*hi+W[1]*Tn+W[2]*Zn)*Lt;return Yn<0||bn+Yn>1?null:(we*hi+Oe*Tn+Ve*Zn)*Lt}function Wg(t,e,n){return(t-e)/(n-e)}function Yg(t,e,n,s,h,p,y,T,R){const F=1<<n,W=p-s,te=y-h,re=(t+1)/F*W+s,_e=(e+0)/F*te+h,we=(e+1)/F*te+h;T[0]=(t+0)/F*W+s,T[1]=_e,R[0]=re,R[1]=we}class Im{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const n=function(p){const y=Math.ceil(Math.log2(p.dim/8)),T=[];let R=Math.ceil(Math.pow(2,y));const F=1/R,W=(_e,we,Oe,Ve,it)=>{const bt=Ve?1:0,rt=(_e+1)*Oe-bt,vt=we*Oe,Lt=(we+1)*Oe-bt;it[0]=_e*Oe,it[1]=vt,it[2]=rt,it[3]=Lt};let te=new Hg(R);const re=[];for(let _e=0;_e<R*R;_e++){W(_e%R,Math.floor(_e/R),F,!1,re);const we=$u(re[0],re[1],p),Oe=$u(re[2],re[1],p),Ve=$u(re[2],re[3],p),it=$u(re[0],re[3],p);te.minimums.push(Math.min(we,Oe,Ve,it)),te.maximums.push(Math.max(we,Oe,Ve,it)),te.leaves.push(1)}for(T.push(te),R/=2;R>=1;R/=2){const _e=T[T.length-1];te=new Hg(R);for(let we=0;we<R*R;we++){W(we%R,Math.floor(we/R),2,!0,re);const Oe=_e.getElevation(re[0],re[1]),Ve=_e.getElevation(re[2],re[1]),it=_e.getElevation(re[2],re[3]),bt=_e.getElevation(re[0],re[3]),rt=_e.isLeaf(re[0],re[1]),vt=_e.isLeaf(re[2],re[1]),Lt=_e.isLeaf(re[2],re[3]),St=_e.isLeaf(re[0],re[3]),fn=Math.min(Oe.min,Ve.min,it.min,bt.min),hn=Math.max(Oe.max,Ve.max,it.max,bt.max),bn=rt&&vt&&Lt&&St;te.maximums.push(hn),te.minimums.push(fn),te.leaves.push(hn-fn<=5&&bn?1:0)}T.push(te)}return T}(this.dem),s=n.length-1,h=n[s];this._addNode(h.minimums[0],h.maximums[0],h.leaves[0]),this._construct(n,0,0,s,0)}raycastRoot(e,n,s,h,p,y,T=1){return $g([e,n,-100],[s,h,this.maximums[0]*T],p,y)}raycast(e,n,s,h,p,y,T=1){if(!this.nodeCount)return null;const R=this.raycastRoot(e,n,s,h,p,y,T);if(null==R)return null;const F=[],W=[],te=[],re=[],_e=[{idx:0,t:R,nodex:0,nodey:0,depth:0}];for(;_e.length>0;){const{idx:we,t:Oe,nodex:Ve,nodey:it,depth:bt}=_e.pop();if(this.leaves[we]){Yg(Ve,it,bt,e,n,s,h,te,re);const vt=1<<bt,Lt=(Ve+0)/vt,St=(Ve+1)/vt,fn=(it+0)/vt,hn=(it+1)/vt,bn=$u(Lt,fn,this.dem)*T,hi=$u(St,fn,this.dem)*T,Tn=$u(St,hn,this.dem)*T,Zn=$u(Lt,hn,this.dem)*T,Yn=qg(te[0],te[1],bn,re[0],te[1],hi,re[0],re[1],Tn,p,y),Gn=qg(re[0],re[1],Tn,te[0],re[1],Zn,te[0],te[1],bn,p,y),ci=Math.min(null!==Yn?Yn:Number.MAX_VALUE,null!==Gn?Gn:Number.MAX_VALUE);if(ci!==Number.MAX_VALUE)return ci;{const Kn=Mh([],p,y,Oe);if(Kg(bn,hi,Zn,Tn,Wg(Kn[0],te[0],re[0]),Wg(Kn[1],te[1],re[1]))>=Kn[2])return Oe}continue}let rt=0;for(let vt=0;vt<this._siblingOffset.length;vt++){Yg((Ve<<1)+this._siblingOffset[vt][0],(it<<1)+this._siblingOffset[vt][1],bt+1,e,n,s,h,te,re),te[2]=-100,re[2]=this.maximums[this.childOffsets[we]+vt]*T;const Lt=$g(te,re,p,y);if(null!=Lt){const St=Lt;F[vt]=St;let fn=!1;for(let hn=0;hn<rt&&!fn;hn++)St>=F[W[hn]]&&(W.splice(hn,0,vt),fn=!0);fn||(W[rt]=vt),rt++}}for(let vt=0;vt<rt;vt++){const Lt=W[vt];_e.push({idx:this.childOffsets[we]+Lt,t:F[Lt],nodex:(Ve<<1)+this._siblingOffset[Lt][0],nodey:(it<<1)+this._siblingOffset[Lt][1],depth:bt+1})}}return null}_addNode(e,n,s){return this.minimums.push(e),this.maximums.push(n),this.leaves.push(s),this.childOffsets.push(0),this.nodeCount++}_construct(e,n,s,h,p){if(1===e[h].isLeaf(n,s))return;this.childOffsets[p]||(this.childOffsets[p]=this.nodeCount);const y=h-1,T=e[y];let R=0,F=0;for(let W=0;W<this._siblingOffset.length;W++){const te=2*n+this._siblingOffset[W][0],re=2*s+this._siblingOffset[W][1],_e=T.getElevation(te,re),we=T.isLeaf(te,re),Oe=this._addNode(_e.min,_e.max,we);we&&(R|=1<<W),F||(F=Oe)}for(let W=0;W<this._siblingOffset.length;W++)R&1<<W||this._construct(e,2*n+this._siblingOffset[W][0],2*s+this._siblingOffset[W][1],y,F+W)}}function Kg(t,e,n,s,h,p){return wn(wn(t,n,p),wn(e,s,p),h)}function $u(t,e,n){const s=n.dim,h=kt(t*s-.5,0,s-1),p=kt(e*s-.5,0,s-1),y=Math.floor(h),T=Math.floor(p),R=Math.min(y+1,s-1),F=Math.min(T+1,s-1);return Kg(n.get(y,T),n.get(R,T),n.get(y,F),n.get(R,F),h-y,p-T)}const Pm={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class Bd{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,n,s,h=!1,p=!1){if(this.uid=e,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(s&&"mapbox"!==s&&"terrarium"!==s)return Mi(`"${s}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=n.height;const y=this.dim=n.height-2,T=new Uint32Array(n.data.buffer);if(this.pixels=new Uint8Array(n.data.buffer),this.encoding=s||"mapbox",this.borderReady=h,!h){for(let R=0;R<y;R++)T[this._idx(-1,R)]=T[this._idx(0,R)],T[this._idx(y,R)]=T[this._idx(y-1,R)],T[this._idx(R,-1)]=T[this._idx(R,0)],T[this._idx(R,y)]=T[this._idx(R,y-1)];T[this._idx(-1,-1)]=T[this._idx(0,0)],T[this._idx(y,-1)]=T[this._idx(y-1,0)],T[this._idx(-1,y)]=T[this._idx(0,y-1)],T[this._idx(y,y)]=T[this._idx(y-1,y-1)],p&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new Im(this)}get(e,n,s=!1){s&&(e=kt(e,-1,this.dim),n=kt(n,-1,this.dim));const h=4*this._idx(e,n);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(this.pixels[h],this.pixels[h+1],this.pixels[h+2])}static getUnpackVector(e){return Pm[e]}get unpackVector(){return Pm[this.encoding]}_idx(e,n){if(e<-1||e>=this.dim+1||n<-1||n>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(n+1)*this.stride+(e+1)}_unpackMapbox(e,n,s){return(256*e*256+256*n+s)/10-1e4}_unpackTerrarium(e,n,s){return 256*e+n+s/256-32768}static pack(e,n){const s=[0,0,0,0],h=Bd.getUnpackVector(n);let p=Math.floor((e+h[3])/h[2]);return s[2]=p%256,p=Math.floor(p/256),s[1]=p%256,p=Math.floor(p/256),s[0]=p,s}getPixels(){return new B({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,n,s){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let h=n*this.dim,p=n*this.dim+this.dim,y=s*this.dim,T=s*this.dim+this.dim;switch(n){case-1:h=p-1;break;case 1:p=h+1}switch(s){case-1:y=T-1;break;case 1:T=y+1}const R=-n*this.dim,F=-s*this.dim;for(let W=y;W<T;W++)for(let te=h;te<p;te++){const re=4*this._idx(te,W),_e=4*this._idx(te+R,W+F);this.pixels[re+0]=e.pixels[_e+0],this.pixels[re+1]=e.pixels[_e+1],this.pixels[re+2]=e.pixels[_e+2],this.pixels[re+3]=e.pixels[_e+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Oi(Bd,"DEMData"),Oi(Im,"DemMinMaxQuadTree",{omit:["dem"]});class Xy{constructor(e,n){this.max=e,this.onRemove=n,this.reset()}reset(){for(const e in this.data)for(const n of this.data[e])n.timeout&&clearTimeout(n.timeout),this.onRemove(n.value);return this.data={},this.order=[],this}add(e,n,s){const h=e.wrapped().key;void 0===this.data[h]&&(this.data[h]=[]);const p={value:n,timeout:void 0};if(void 0!==s&&(p.timeout=setTimeout(()=>{this.remove(e,p)},s)),this.data[h].push(p),this.order.push(h),this.order.length>this.max){const y=this._getAndRemoveByKey(this.order[0]);y&&this.onRemove(y)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const n=this.data[e].shift();return n.timeout&&clearTimeout(n.timeout),0===this.data[e].length&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),n.value}getByKey(e){const n=this.data[e];return n?n[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,n){if(!this.has(e))return this;const s=e.wrapped().key,h=void 0===n?0:this.data[s].indexOf(n),p=this.data[s][h];return this.data[s].splice(h,1),p.timeout&&clearTimeout(p.timeout),0===this.data[s].length&&delete this.data[s],this.onRemove(p.value),this.order.splice(this.order.indexOf(s),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const n=this._getAndRemoveByKey(this.order[0]);n&&this.onRemove(n)}return this}filter(e){const n=[];for(const s in this.data)for(const h of this.data[s])e(h.value)||n.push(h);for(const s of n)this.remove(s.value.tileID,s)}}class fh{constructor(e,n,s){this.func=e,this.mask=n,this.range=s}}fh.ReadOnly=!1,fh.ReadWrite=!0,fh.disabled=new fh(519,fh.ReadOnly,[0,1]);class Xg{constructor(e,n,s,h,p,y){this.test=e,this.ref=n,this.mask=s,this.fail=h,this.depthFail=p,this.pass=y}}Xg.disabled=new Xg({func:519,mask:0},0,0,7680,7680,7680);class mc{constructor(e,n,s){this.blendFunction=e,this.blendColor=n,this.mask=s}}mc.Replace=[1,0],mc.disabled=new mc(mc.Replace,zr.transparent,[!1,!1,!1,!1]),mc.unblended=new mc(mc.Replace,zr.transparent,[!0,!0,!0,!0]),mc.alphaBlended=new mc([1,771],zr.transparent,[!0,!0,!0,!0]);class Ac{constructor(e,n,s){this.enable=e,this.mode=n,this.frontFace=s}}Ac.disabled=new Ac(!1,1029,2305),Ac.backCCW=new Ac(!0,1029,2305),Ac.backCW=new Ac(!0,1029,2304),Ac.frontCW=new Ac(!0,1028,2304),Ac.frontCCW=new Ac(!0,1028,2305);class qh extends Xn{constructor(e,n,s){super(),this.id=e,this._onlySymbols=s,n.on("data",h=>{"source"===h.dataType&&"metadata"===h.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===h.dataType&&"content"===h.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),n.on("error",()=>{this._sourceErrored=!0}),this._source=n,this._tiles={},this._cache=new Xy(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=n.minTileCacheSize,this._maxTileCacheSize=n.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new Gg,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(e){this.map=e,this._minTileCacheSize=void 0===this._minTileCacheSize&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const e in this._tiles){const n=this._tiles[e];if("loaded"!==n.state&&"errored"!==n.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,n){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,n)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,()=>{})}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,()=>{})}serialize(){return this._source.serialize()}prepare(e){if(this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._source.prepareTile)for(const n in this._tiles){const s=this._tiles[n];this._source.prepareTile(s)&&this.map.painter.terrain&&this.map.painter.terrain._clearRenderCacheForTile(this.id,s.tileID),s.upload(e),s.prepare(this.map.style.imageManager)}else for(const n in this._tiles){const s=this._tiles[n];s.upload(e),s.prepare(this.map.style.imageManager)}}getIds(){return Cn(this._tiles).map(e=>e.tileID).sort(If).map(e=>e.key)}getRenderableIds(e){const n=[];for(const s in this._tiles)this._isIdRenderable(+s,e)&&n.push(this._tiles[s]);return e?n.sort((s,h)=>{const p=s.tileID,y=h.tileID,T=new Ke(p.canonical.x,p.canonical.y)._rotate(this.transform.angle),R=new Ke(y.canonical.x,y.canonical.y)._rotate(this.transform.angle);return p.overscaledZ-y.overscaledZ||R.y-T.y||R.x-T.x}).map(s=>s.tileID.key):n.map(s=>s.tileID).sort(If).map(s=>s.key)}hasRenderableParent(e){const n=this.findLoadedParent(e,0);return!!n&&this._isIdRenderable(n.tileID.key)}_isIdRenderable(e,n){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(n||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)"errored"!==this._tiles[e].state&&this._reloadTile(+e,"reloading")}}_reloadTile(e,n){const s=this._tiles[e];s&&("loading"!==s.state&&(s.state=n),this._loadTile(s,this._tileLoaded.bind(this,s,e,n)))}_tileLoaded(e,n,s,h){if(h)if(e.state="errored",404!==h.status)this._source.fire(new mi(h,{tile:e}));else if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const p=this.map.painter.terrain;this.update(this.transform,p.getScaledDemTileSize(),!0),p.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=Zr.now(),"expired"===s&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(n,e),"raster-dem"===this._source.type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new Pn("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const n=this.getRenderableIds();for(let h=0;h<n.length;h++){const p=n[h];if(e.neighboringTiles&&e.neighboringTiles[p]){const y=this.getTileByID(p);s(e,y),s(y,e)}}function s(h,p){if(!h.dem||h.dem.borderReady)return;h.needsHillshadePrepare=!0,h.needsDEMTextureUpload=!0;let y=p.tileID.canonical.x-h.tileID.canonical.x;const T=p.tileID.canonical.y-h.tileID.canonical.y,R=Math.pow(2,h.tileID.canonical.z),F=p.tileID.key;0===y&&0===T||Math.abs(T)>1||(Math.abs(y)>1&&(1===Math.abs(y+R)?y+=R:1===Math.abs(y-R)&&(y-=R)),p.dem&&h.dem&&(h.dem.backfillBorder(p.dem,y,T),h.neighboringTiles&&h.neighboringTiles[F]&&(h.neighboringTiles[F].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,n,s,h){for(const p in this._tiles){let y=this._tiles[p];if(h[p]||!y.hasData()||y.tileID.overscaledZ<=n||y.tileID.overscaledZ>s)continue;let T=y.tileID;for(;y&&y.tileID.overscaledZ>n+1;){const F=y.tileID.scaledTo(y.tileID.overscaledZ-1);y=this._tiles[F.key],y&&y.hasData()&&(T=F)}let R=T;for(;R.overscaledZ>n;)if(R=R.scaledTo(R.overscaledZ-1),e[R.key]){h[T.key]=T;break}}}findLoadedParent(e,n){if(e.key in this._loadedParentTiles){const s=this._loadedParentTiles[e.key];return s&&s.tileID.overscaledZ>=n?s:null}for(let s=e.overscaledZ-1;s>=n;s--){const h=e.scaledTo(s),p=this._getLoadedTile(h);if(p)return p}}_getLoadedTile(e){const n=this._tiles[e.key];return n&&n.hasData()?n:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,n){n=n||this._source.tileSize;const s=Math.ceil(e.width/n)+1,h=Math.ceil(e.height/n)+1,p=Math.floor(s*h*5),y="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,p):p,T="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,y):y;this._cache.setMaxSize(T)}handleWrapJump(e){const n=Math.round((e-(void 0===this._prevLng?e:this._prevLng))/360);if(this._prevLng=e,n){const s={};for(const h in this._tiles){const p=this._tiles[h];p.tileID=p.tileID.unwrapTo(p.tileID.wrap+n),s[p.tileID.key]=p}this._tiles=s;for(const h in this._timers)clearTimeout(this._timers[h]),delete this._timers[h];for(const h in this._tiles)this._setTileReloadTimer(+h,this._tiles[h])}}update(e,n,s){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!s)return;let h;this.updateCacheSize(e,n),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?h=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(T=>new Xl(T.canonical.z,T.wrap,T.canonical.z,T.canonical.x,T.canonical.y)):(h=e.coveringTiles({tileSize:n||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!s,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(h=h.filter(T=>this._source.hasTile(T)))):h=[];const p=this._updateRetainedTiles(h);if(Pf(this._source.type)&&0!==h.length){const T={},R={},F=Object.keys(p);for(const te of F){const re=p[te],_e=this._tiles[te];if(!_e||_e.fadeEndTime&&_e.fadeEndTime<=Zr.now())continue;const we=this.findLoadedParent(re,Math.max(re.overscaledZ-qh.maxOverzooming,this._source.minzoom));we&&(this._addTile(we.tileID),T[we.tileID.key]=we.tileID),R[te]=re}const W=h[h.length-1].overscaledZ;for(const te in this._tiles){const re=this._tiles[te];if(p[te]||!re.hasData())continue;let _e=re.tileID;for(;_e.overscaledZ>W;){_e=_e.scaledTo(_e.overscaledZ-1);const we=this._tiles[_e.key];if(we&&we.hasData()&&R[_e.key]){p[te]=re.tileID;break}}}for(const te in T)p[te]||(this._coveredTiles[te]=!0,p[te]=T[te])}for(const T in p)this._tiles[T].clearFadeHold();const y=function(T,R){const F=[];for(const W in T)W in R||F.push(W);return F}(this._tiles,p);for(const T of y){const R=this._tiles[T];R.hasSymbolBuckets&&!R.holdingForFade()?R.setHoldDuration(this.map._fadeDuration):R.hasSymbolBuckets&&!R.symbolFadeFinished()||this._removeTile(+T)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const n={};if(0===e.length)return n;const s={},h=e.reduce((F,W)=>Math.min(F,W.overscaledZ),1/0),p=e[0].overscaledZ,y=Math.max(p-qh.maxOverzooming,this._source.minzoom),T=Math.max(p+qh.maxUnderzooming,this._source.minzoom),R={};for(const F of e){const W=this._addTile(F);n[F.key]=F,W.hasData()||h<this._source.maxzoom&&(R[F.key]=F)}this._retainLoadedChildren(R,h,T,n);for(const F of e){let W=this._tiles[F.key];if(W.hasData())continue;if(F.canonical.z>=this._source.maxzoom){const re=F.children(this._source.maxzoom)[0],_e=this.getTile(re);if(_e&&_e.hasData()){n[re.key]=re;continue}}else{const re=F.children(this._source.maxzoom);if(n[re[0].key]&&n[re[1].key]&&n[re[2].key]&&n[re[3].key])continue}let te=W.wasRequested();for(let re=F.overscaledZ-1;re>=y;--re){const _e=F.scaledTo(re);if(s[_e.key]||(s[_e.key]=!0,W=this.getTile(_e),!W&&te&&(W=this._addTile(_e)),W&&(n[_e.key]=_e,te=W.wasRequested(),W.hasData())))break}}return n}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const n=[];let s,h=this._tiles[e].tileID;for(;h.overscaledZ>0;){if(h.key in this._loadedParentTiles){s=this._loadedParentTiles[h.key];break}n.push(h.key);const p=h.scaledTo(h.overscaledZ-1);if(s=this._getLoadedTile(p),s)break;h=p}for(const p of n)this._loadedParentTiles[p]=s}}_addTile(e){let n=this._tiles[e.key];if(n)return this._source.prepareTile&&this._source.prepareTile(n),n;n=this._cache.getAndRemove(e),n&&(this._setTileReloadTimer(e.key,n),n.tileID=e,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,n)));const s=Boolean(n);if(!s){const h=this.map?this.map.painter:null;n=new Mm(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,h,this._isRaster),this._source.prepareTile&&this._source.prepareTile(n)||this._loadTile(n,this._tileLoaded.bind(this,n,e.key,n.state))}return n?(n.uses++,this._tiles[e.key]=n,s||this._source.fire(new Pn("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n):null}_setTileReloadTimer(e,n){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const s=n.getExpiryTimeout();s&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},s))}_removeTile(e){const n=this._tiles[e];n&&(n.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),n.uses>0||(n.hasData()&&"reloading"!==n.state?this._cache.add(n.tileID,n,n.getExpiryTimeout()):(n.aborted=!0,this._abortTile(n),this._unloadTile(n))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(e,n,s){const h=[],p=this.transform;if(!p)return h;const y="globe"===p.projection.name,T=Tc(p.center.lng);for(const R in this._tiles){const F=this._tiles[R];if(s&&F.clearQueryDebugViz(),F.holdingForFade())continue;let W;if(y){const te=F.tileID.canonical;if(0===te.z){const re=[Math.abs(kt(T,...Wh(te,-1))-T),Math.abs(kt(T,...Wh(te,1))-T)];W=[0,2*re.indexOf(Math.min(...re))-1]}else{const re=[Math.abs(kt(T,...Wh(te,-1))-T),Math.abs(kt(T,...Wh(te,0))-T),Math.abs(kt(T,...Wh(te,1))-T)];W=[re.indexOf(Math.min(...re))-1]}}else W=[0];for(const te of W){const re=e.containsTile(F,p,n,te);re&&h.push(re)}}return h}getVisibleCoordinates(e){const n=this.getRenderableIds(e).map(s=>this._tiles[s].tileID);for(const s of n)s.projMatrix=this.transform.calculateProjMatrix(s.toUnwrapped());return n}hasTransition(){if(this._source.hasTransition())return!0;if(Pf(this._source.type))for(const e in this._tiles){const n=this._tiles[e];if(void 0!==n.fadeEndTime&&n.fadeEndTime>=Zr.now())return!0}return!1}setFeatureState(e,n,s){this._state.updateState(e=e||"_geojsonTileLayer",n,s)}removeFeatureState(e,n,s){this._state.removeFeatureState(e=e||"_geojsonTileLayer",n,s)}getFeatureState(e,n){return this._state.getState(e=e||"_geojsonTileLayer",n)}setDependencies(e,n,s){const h=this._tiles[e];h&&h.setDependencies(n,s)}reloadTilesForDependencies(e,n){for(const s in this._tiles)this._tiles[s].hasDependency(e,n)&&this._reloadTile(+s,"reloading");this._cache.filter(s=>!s.hasDependency(e,n))}_preloadTiles(e,n){const s=new Map,h=Array.isArray(e)?e:[e],p=this.map.painter.terrain,y=this.usedForTerrain&&p?p.getScaledDemTileSize():this._source.tileSize;for(const T of h){const R=T.coveringTiles({tileSize:y,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const F of R)s.set(F.key,F);this.usedForTerrain&&T.updateElevation(!1)}on(Array.from(s.values()),(T,R)=>{const F=new Mm(T,this._source.tileSize*T.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(F,W=>{"raster-dem"===this._source.type&&F.dem&&this._backfillDEM(F),R(W,F)})},n)}}function If(t,e){const n=Math.abs(2*t.wrap)-+(t.wrap<0),s=Math.abs(2*e.wrap)-+(e.wrap<0);return t.overscaledZ-e.overscaledZ||s-n||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}function Pf(t){return"raster"===t||"image"===t||"video"===t}function Wh(t,e){const n=1<<t.z;return[t.x/n+e,(t.x+1)/n+e]}qh.maxOverzooming=10,qh.maxUnderzooming=3;class Rm{constructor(e,n,s){this._demTile=e,this._dem=this._demTile.dem,this._scale=n,this._offset=s}static create(e,n,s){const h=s||e.findDEMTileFor(n);if(!h||!h.dem)return;const p=h.dem,y=h.tileID,T=1<<n.canonical.z-y.canonical.z;return new Rm(h,h.tileSize/Fr/T,[(n.canonical.x/T-y.canonical.x)*p.dim,(n.canonical.y/T-y.canonical.y)*p.dim])}tileCoordToPixel(e,n){const s=n*this._scale+this._offset[1],h=Math.floor(e*this._scale+this._offset[0]),p=Math.floor(s);return new Ke(h,p)}getElevationAt(e,n,s,h){const p=e*this._scale+this._offset[0],y=n*this._scale+this._offset[1],T=Math.floor(p),R=Math.floor(y),F=this._dem;return h=!!h,s?wn(wn(F.get(T,R,h),F.get(T,R+1,h),y-R),wn(F.get(T+1,R,h),F.get(T+1,R+1,h),y-R),p-T):F.get(T,R,h)}getElevationAtPixel(e,n,s){return this._dem.get(e,n,!!s)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*Xs(1,e)*this._dem.stride}}class Jg{constructor(e,n){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new sl(Fr,16,0),this.featureIndexArray=new nc,this.promoteId=n}insert(e,n,s,h,p,y=0){const T=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(s,h,p,y);const R=this.grid;for(let F=0;F<n.length;F++){const W=n[F],te=[1/0,1/0,-1/0,-1/0];for(let re=0;re<W.length;re++){const _e=W[re];te[0]=Math.min(te[0],_e.x),te[1]=Math.min(te[1],_e.y),te[2]=Math.max(te[2],_e.x),te[3]=Math.max(te[3],_e.y)}te[0]<Fr&&te[1]<Fr&&te[2]>=0&&te[3]>=0&&R.insert(T,te[0],te[1],te[2],te[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new xu.VectorTile(new uf(this.rawTileData)).layers,this.sourceLayerCoder=new G_(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,n,s,h){this.loadVTLayers();const p=e.params||{},y=Os(p.filter),T=e.tileResult,R=e.transform,F=T.bufferedTilespaceBounds,W=this.grid.query(F.min.x,F.min.y,F.max.x,F.max.y,(we,Oe,Ve,it)=>$f(T.bufferedTilespaceGeometry,we,Oe,Ve,it));W.sort(Ip);let te=null;R.elevation&&W.length>0&&(te=Rm.create(R.elevation,this.tileID));const re={};let _e;for(let we=0;we<W.length;we++){const Oe=W[we];if(Oe===_e)continue;_e=Oe;const Ve=this.featureIndexArray.get(Oe);let it=null;this.loadMatchingFeature(re,Ve,y,p.layers,p.availableImages,n,s,h,(bt,rt,vt,Lt=0)=>(it||(it=zc(bt,this.tileID.canonical,e.tileTransform)),rt.queryIntersectsFeature(T,bt,vt,it,this.z,e.transform,e.pixelPosMatrix,te,Lt)))}return re}loadMatchingFeature(e,n,s,h,p,y,T,R,F){const{featureIndex:W,bucketIndex:te,sourceLayerIndex:re,layoutVertexArrayOffset:_e}=n,we=this.bucketLayerIDs[te];if(h&&!function(bt,rt){for(let vt=0;vt<bt.length;vt++)if(rt.indexOf(bt[vt])>=0)return!0;return!1}(h,we))return;const Oe=this.sourceLayerCoder.decode(re),Ve=this.vtLayers[Oe].feature(W);if(s.needGeometry){const bt=Qc(Ve,!0);if(!s.filter(new He(this.tileID.overscaledZ),bt,this.tileID.canonical))return}else if(!s.filter(new He(this.tileID.overscaledZ),Ve))return;const it=this.getId(Ve,Oe);for(let bt=0;bt<we.length;bt++){const rt=we[bt];if(h&&h.indexOf(rt)<0)continue;const vt=y[rt];if(!vt)continue;let Lt={};void 0!==it&&R&&(Lt=R.getState(vt.sourceLayer||"_geojsonTileLayer",it));const St=se({},T[rt]);St.paint=Of(St.paint,vt.paint,Ve,Lt,p),St.layout=Of(St.layout,vt.layout,Ve,Lt,p);const fn=!F||F(Ve,vt,Lt,_e);if(!fn)continue;const hn=new jg(Ve,this.z,this.x,this.y,it);hn.layer=St;let bn=e[rt];void 0===bn&&(bn=e[rt]=[]),bn.push({featureIndex:W,feature:hn,intersectionZ:fn})}}lookupSymbolFeatures(e,n,s,h,p,y,T,R){const F={};this.loadVTLayers();const W=Os(p);for(const te of e)this.loadMatchingFeature(F,{bucketIndex:s,sourceLayerIndex:h,featureIndex:te,layoutVertexArrayOffset:0},W,y,T,R,n);return F}loadFeature(e){const{featureIndex:n,sourceLayerIndex:s}=e;this.loadVTLayers();const h=this.sourceLayerCoder.decode(s),p=this.vtFeatures[h];if(p[n])return p[n];const y=this.vtLayers[h].feature(n);return p[n]=y,y}hasLayer(e){for(const n of this.bucketLayerIDs)for(const s of n)if(e===s)return!0;return!1}getId(e,n){let s=e.id;return this.promoteId&&(s=e.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[n]],"boolean"==typeof s&&(s=Number(s))),s}}function Of(t,e,n,s,h){return an(t,(p,y)=>{const T=e instanceof It?e.get(y):null;return T&&T.evaluate?T.evaluate(n,s,h):T})}function Ip(t,e){return e-t}Oi(Jg,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class km{constructor(e){const n={},s=[];for(const T in e){const R=e[T],F=n[T]={};for(const W in R.glyphs){const te=R.glyphs[+W];if(!te||0===te.bitmap.width||0===te.bitmap.height)continue;const re=te.metrics.localGlyph?2:1,_e={x:0,y:0,w:te.bitmap.width+2*re,h:te.bitmap.height+2*re};s.push(_e),F[W]=_e}}const{w:h,h:p}=Sd(s),y=new _({width:h||1,height:p||1});for(const T in e){const R=e[T];for(const F in R.glyphs){const W=R.glyphs[+F];if(!W||0===W.bitmap.width||0===W.bitmap.height)continue;const te=n[T][F],re=W.metrics.localGlyph?2:1;_.copy(W.bitmap,y,{x:0,y:0},{x:te.x+re,y:te.y+re},W.bitmap)}}this.image=y,this.positions=n}}Oi(km,"GlyphAtlas");class Qg{constructor(e){this.tileID=new Xl(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,this.tileTransform=jh(e.tileID.canonical,e.projection),this.projection=e.projection}parse(e,n,s,h,p){this.status="parsing",this.data=e,this.collisionBoxArray=new qo;const y=new G_(Object.keys(e.layers).sort()),T=new Jg(this.tileID,this.promoteId);T.bucketLayerIDs=[];const R={},F=new Df(256,256),W={featureIndex:T,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:F,availableImages:s},te=n.familiesBySource[this.source];for(const Lt in te){const St=e.layers[Lt];if(!St)continue;let fn=!1,hn=!1;for(const Tn of te[Lt])"symbol"===Tn[0].type?fn=!0:hn=!0;if(!0===this.isSymbolTile&&!fn||!1===this.isSymbolTile&&!hn)continue;1===St.version&&Mi(`Vector tile source "${this.source}" layer "${Lt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const bn=y.encode(Lt),hi=[];for(let Tn=0;Tn<St.length;Tn++){const Zn=St.feature(Tn),Yn=T.getId(Zn,Lt);hi.push({feature:Zn,id:Yn,index:Tn,sourceLayerIndex:bn})}for(const Tn of te[Lt]){const Zn=Tn[0];void 0!==this.isSymbolTile&&"symbol"===Zn.type!==this.isSymbolTile||Zn.minzoom&&this.zoom<Math.floor(Zn.minzoom)||Zn.maxzoom&&this.zoom>=Zn.maxzoom||"none"!==Zn.visibility&&(Rf(Tn,this.zoom,s),(R[Zn.id]=Zn.createBucket({index:T.bucketLayerIDs.length,layers:Tn,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:bn,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:s})).populate(hi,W,this.tileID.canonical,this.tileTransform),T.bucketLayerIDs.push(Tn.map(Yn=>Yn.id)))}}let re,_e,we,Oe;F.trim();const Ve={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},it=an(W.glyphDependencies,Lt=>Object.keys(Lt).map(Number));Object.keys(it).length?h.send("getGlyphs",{uid:this.uid,stacks:it},(Lt,St)=>{re||(re=Lt,_e=St,vt.call(this))},void 0,!1,Ve):_e={};const bt=Object.keys(W.iconDependencies);bt.length?h.send("getImages",{icons:bt,source:this.source,tileID:this.tileID,type:"icons"},(Lt,St)=>{re||(re=Lt,we=St,vt.call(this))},void 0,!1,Ve):we={};const rt=Object.keys(W.patternDependencies);function vt(){if(re)return p(re);if(_e&&we&&Oe){const Lt=new km(_e),St=new _g(we,Oe);for(const fn in R){const hn=R[fn];hn instanceof Gu?(Rf(hn.layers,this.zoom,s),Tg(hn,_e,Lt.positions,we,St.iconPositions,this.showCollisionBoxes,s,this.tileID.canonical,this.tileZoom,this.projection)):hn.hasPattern&&(hn instanceof lf||hn instanceof bu||hn instanceof ip)&&(Rf(hn.layers,this.zoom,s),hn.addFeatures(W,this.tileID.canonical,St.patternPositions,s,this.tileTransform))}this.status="done",p(null,{buckets:Cn(R).filter(fn=>!fn.isEmpty()),featureIndex:T,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Lt.image,lineAtlas:F,imageAtlas:St,glyphMap:this.returnDependencies?_e:null,iconMap:this.returnDependencies?we:null,glyphPositions:this.returnDependencies?Lt.positions:null})}}rt.length?h.send("getImages",{icons:rt,source:this.source,tileID:this.tileID,type:"patterns"},(Lt,St)=>{re||(re=Lt,Oe=St,vt.call(this))},void 0,!1,Ve):Oe={},vt.call(this)}}function Rf(t,e,n){const s=new He(e);for(const h of t)h.recalculate(s,n)}class Nm{constructor(e){this.entries={},this.scheduler=e}request(e,n,s,h){const p=this.entries[e]=this.entries[e]||{callbacks:[]};if(p.result){const[y,T]=p.result;return this.scheduler?this.scheduler.add(()=>{h(y,T)},n):h(y,T),()=>{}}return p.callbacks.push(h),p.cancel||(p.cancel=s((y,T)=>{p.result=[y,T];for(const R of p.callbacks)this.scheduler?this.scheduler.add(()=>{R(y,T)},n):R(y,T);setTimeout(()=>delete this.entries[e],3e3)})),()=>{p.result||(p.callbacks=p.callbacks.filter(y=>y!==h),p.callbacks.length||(p.cancel(),delete this.entries[e]))}}}function Lm(t,e,n){const s=JSON.stringify(t.request);return t.data&&(this.deduped.entries[s]={result:[null,t.data]}),this.deduped.request(s,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom},h=>{const p=Kt(t.request,(y,T,R,F)=>{y?h(y):T&&h(null,{vectorTile:n?void 0:new xu.VectorTile(new uf(T)),rawData:T,cacheControl:R,expires:F})});return()=>{p.cancel(),h()}},e)}l.ARRAY_TYPE=dc,l.AUTH_ERR_MSG=Dt,l.Aabb=Ul,l.Actor=class{constructor(t,e,n){this.target=t,this.parent=e,this.mapId=n,this.callbacks={},this.cancelCallbacks={},$t(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=_i()?t:oe,this.scheduler=new Yy}send(t,e,n,s,h=!1,p){const y=Math.round(1e18*Math.random()).toString(36).substring(0,10);n&&(n.metadata=p,this.callbacks[y]=n);const T=Ti(this.globalScope)?void 0:[];return this.target.postMessage({id:y,type:t,hasCallback:!!n,targetMapId:s,mustQueue:h,sourceMapId:this.mapId,data:Ic(e,T)},T),{cancel:()=>{n&&delete this.callbacks[y],this.target.postMessage({id:y,type:"<cancel>",targetMapId:s,sourceMapId:this.mapId})}}}receive(t){const e=t.data,n=e.id;if(n&&(!e.targetMapId||this.mapId===e.targetMapId))if("<cancel>"===e.type){const s=this.cancelCallbacks[n];delete this.cancelCallbacks[n],s&&s.cancel()}else if(e.mustQueue||_i()){const s=this.callbacks[n];this.cancelCallbacks[n]=this.scheduler.add(()=>this.processTask(n,e),s&&s.metadata||{type:"message"})}else this.processTask(n,e)}processTask(t,e){if("<response>"===e.type){const n=this.callbacks[t];delete this.callbacks[t],n&&(e.error?n(Rs(e.error)):n(null,Rs(e.data)))}else{const n=Ti(this.globalScope)?void 0:[],s=e.hasCallback?(p,y)=>{delete this.cancelCallbacks[t],this.target.postMessage({id:t,type:"<response>",sourceMapId:this.mapId,error:p?Ic(p):null,data:Ic(y,n)},n)}:p=>{},h=Rs(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,h,s);else if(this.parent.getWorkerSource){const p=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,p[0],h.source)[p[1]](h,s)}else s(new Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},l.CanonicalTileID=ap,l.Color=zr,l.ColorMode=mc,l.CullFaceMode=Ac,l.DEMData=Bd,l.DataConstantProperty=Ct,l.DedupedRequest=Nm,l.DepthMode=fh,l.EXTENT=Fr,l.Elevation=class{isDataAvailableAtPoint(t){const e=this._source();if(!e||t.y<0||t.y>1)return!1;const n=e.getSource().maxzoom,s=1<<n,h=Math.floor(t.x),p=Math.floor((t.x-h)*s),y=Math.floor(t.y*s),T=this.findDEMTileFor(new Xl(n,h,n,p,y));return!(!T||!T.dem)}getAtPointOrZero(t,e=0){return this.getAtPoint(t,e)||0}getAtPoint(t,e,n=!0){null==e&&(e=null);const s=this._source();if(!s||t.y<0||t.y>1)return e;const h=s.getSource().maxzoom,p=1<<h,y=Math.floor(t.x),T=t.x-y,R=new Xl(h,y,h,Math.floor(T*p),Math.floor(t.y*p)),F=this.findDEMTileFor(R);if(!F||!F.dem)return e;const W=F.dem,te=1<<F.tileID.canonical.z,re=(T*te-F.tileID.canonical.x)*W.dim,_e=(t.y*te-F.tileID.canonical.y)*W.dim,we=Math.floor(re),Oe=Math.floor(_e);return(n?this.exaggeration():1)*wn(wn(W.get(we,Oe),W.get(we,Oe+1),_e-Oe),wn(W.get(we+1,Oe),W.get(we+1,Oe+1),_e-Oe),re-we)}getAtTileOffset(t,e,n){const s=1<<t.canonical.z;return this.getAtPointOrZero(new gu(t.wrap+(t.canonical.x+e/Fr)/s,(t.canonical.y+n/Fr)/s))}getAtTileOffsetFunc(t,e,n,s){return h=>{const p=this.getAtTileOffset(t,h.x,h.y),y=s.upVector(t.canonical,h.x,h.y);return Zc(y,y,p*s.upVectorScale(t.canonical,e,n).metersToTile),y}}getForTilePoints(t,e,n,s){const h=Rm.create(this,t,s);return!!h&&(e.forEach(p=>{p[2]=this.exaggeration()*h.getElevationAt(p[0],p[1],n)}),!0)}getMinMaxForTile(t){const e=this.findDEMTileFor(t);if(!e||!e.dem)return null;const n=e.dem.tree,s=e.tileID,h=1<<t.canonical.z-s.canonical.z;let p=t.canonical.x/h-s.canonical.x,y=t.canonical.y/h-s.canonical.y,T=0;for(let R=0;R<t.canonical.z-s.canonical.z&&!n.leaves[T];R++){p*=2,y*=2;const F=2*Math.floor(y)+Math.floor(p);T=n.childOffsets[T]+F,p%=1,y%=1}return{min:this.exaggeration()*n.minimums[T],max:this.exaggeration()*n.maximums[T]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(t,e,n){throw new Error("Pure virtual method called.")}pointCoordinate(t){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(t){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},l.ErrorEvent=mi,l.EvaluationParameters=He,l.Event=Pn,l.Evented=Xn,l.FillExtrusionBucket=ip,l.Frustum=ef,l.FrustumCorners=Qd,l.GLOBE_METERS_TO_ECEF=gf,l.GLOBE_RADIUS=lh,l.GLOBE_SCALE_MATCH_LATITUDE=45,l.GLOBE_ZOOM_THRESHOLD_MAX=6,l.GLOBE_ZOOM_THRESHOLD_MIN=5,l.GlobeSharedBuffers=class{constructor(t){this._createGrid(t),this._createPoles(t)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const t of this._poleSegments)t.destroy();for(const t of this._gridSegments)t.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const t of this._wireframeSegments)t.destroy()}}_createGrid(t){const e=new gi,n=new Qe,s=65;for(let h=0;h<s;h++)for(let p=0;p<s;p++)e.emplaceBack(p,h);this._gridSegments=[];for(let h=0,p=0;h<Od.length;h++){const y=Od[h];for(let R=0;R<y;R++)for(let F=0;F<64;F++){const W=R*s+F;n.emplaceBack(W+1,W,W+s),n.emplaceBack(W+s,W+s+1,W+1)}const T=64*y*2;this._gridSegments.push(Ha.simpleSegment(0,p,(y+1)*s,T)),p+=T}this._gridBuffer=t.createVertexBuffer(e,Ep.members),this._gridIndexBuffer=t.createIndexBuffer(n,!0)}_createPoles(t){const e=new Qe;for(let h=0;h<=64;h++)e.emplaceBack(0,h+1,h+2);this._poleIndexBuffer=t.createIndexBuffer(e,!0);const n=new Ri,s=new Ri;this._poleSegments=[];for(let h=0,p=0;h<5;h++){const y=360/(1<<h);n.emplaceBack(0,-lh,0,.5,0),s.emplaceBack(0,-lh,0,.5,1);for(let T=0;T<=64;T++){const R=T/64,F=wn(0,y,R),[W,te,re]=ch(F_,bf,F,lh);n.emplaceBack(W,te,re,R,0),s.emplaceBack(W,te,re,R,1)}this._poleSegments.push(Ha.simpleSegment(p,0,66,64)),p+=66}this._poleNorthVertexBuffer=t.createVertexBuffer(n,Ag,!1),this._poleSouthVertexBuffer=t.createVertexBuffer(s,Ag,!1)}getGridBuffers(t){return[this._gridBuffer,this._gridIndexBuffer,this._gridSegments[t]]}getPoleBuffers(t){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[t]]}getWirefameBuffers(t,e){if(!this._wireframeSegments){const n=new Pr,s=64,h=s+1;this._wireframeSegments=[];for(let p=0,y=0;p<Od.length;p++){const T=Od[p];for(let F=0;F<T;F++)for(let W=0;W<s;W++){const te=F*h+W;n.emplaceBack(te,te+1),n.emplaceBack(te,te+h),n.emplaceBack(te,te+h+1)}const R=T*s*3;this._wireframeSegments.push(Ha.simpleSegment(0,y,(T+1)*h,R)),y+=R}this._wireframeIndexBuffer=t.createIndexBuffer(n)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[e]]}},l.GlyphManager=Md,l.ImagePosition=hf,l.LineAtlas=Df,l.LngLat=Eo,l.LngLatBounds=mu,l.LocalGlyphMode=ff,l.MAX_MERCATOR_LATITUDE=Bc,l.MercatorCoordinate=gu,l.ONE_EM=24,l.OverscaledTileID=Xl,l.Properties=Ln,l.RGBAImage=B,l.Ray=Jd,l.RequestManager=class{constructor(t,e,n){this._transformRequestFn=t,this._customAccessToken=e,this._silenceAuthErrors=!!n,this._createSkuToken()}_createSkuToken(){const t=function(){let e="";for(let n=0;n<10;n++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Ot,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}}normalizeStyleURL(t,e){if(!Nn(t))return t;const n=pi(t);return n.path=`/styles/v1${n.path}`,this._makeAPIURL(n,this._customAccessToken||e)}normalizeGlyphsURL(t,e){if(!Nn(t))return t;const n=pi(t);return n.path=`/fonts/v1${n.path}`,this._makeAPIURL(n,this._customAccessToken||e)}normalizeSourceURL(t,e,n,s){if(!Nn(t))return t;const h=pi(t);return h.path=`/v4/${h.authority}.json`,h.params.push("secure"),n&&h.params.push(`language=${n}`),s&&h.params.push(`worldview=${s}`),this._makeAPIURL(h,this._customAccessToken||e)}normalizeSpriteURL(t,e,n,s){const h=pi(t);return Nn(t)?(h.path=`/styles/v1${h.path}/sprite${e}${n}`,this._makeAPIURL(h,this._customAccessToken||s)):(h.path+=`${e}${n}`,to(h))}normalizeTileURL(t,e,n){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!Nn(t))return t;const s=pi(t);s.path=s.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||n&&"raster"!==s.authority&&512===n?"@2x":""}${yo.supported?".webp":"$1"}`),"raster"===s.authority?s.path=`/${Mn.RASTER_URL_PREFIX}${s.path}`:(s.path=s.path.replace(/^.+\/v4\//,"/"),s.path=`/${Mn.TILE_URL_VERSION}${s.path}`);const h=this._customAccessToken||function(p){for(const y of p){const T=y.match(/^access_token=(.*)$/);if(T)return T[1]}return null}(s.params)||Mn.ACCESS_TOKEN;return Mn.REQUIRE_ACCESS_TOKEN&&h&&this._skuToken&&s.params.push(`sku=${this._skuToken}`),this._makeAPIURL(s,h)}canonicalizeTileURL(t,e){const n=pi(t);if(!n.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!n.path.match(/\.[\w]+$/))return t;let s="mapbox://";n.path.match(/^\/raster\/v1\//)?s+=`raster/${n.path.replace(`/${Mn.RASTER_URL_PREFIX}/`,"")}`:s+=`tiles/${n.path.replace(`/${Mn.TILE_URL_VERSION}/`,"")}`;let h=n.params;return e&&(h=h.filter(p=>!p.match(/^access_token=/))),h.length&&(s+=`?${h.join("&")}`),s}canonicalizeTileset(t,e){const n=!!e&&Nn(e),s=[];for(const h of t.tiles||[])nn(h)?s.push(this.canonicalizeTileURL(h,n)):s.push(h);return s}_makeAPIURL(t,e){const n="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",s=pi(Mn.API_URL);if(t.protocol=s.protocol,t.authority=s.authority,"http"===t.protocol){const h=t.params.indexOf("secure");h>=0&&t.params.splice(h,1)}if("/"!==s.path&&(t.path=`${s.path}${t.path}`),!Mn.REQUIRE_ACCESS_TOKEN)return to(t);if(e=e||Mn.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${n}`);if("s"===e[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${n}`)}return t.params=t.params.filter(h=>-1===h.indexOf("access_token")),t.params.push(`access_token=${e||""}`),to(t)}},l.ResourceType=xt,l.SegmentVector=Ha,l.SourceCache=qh,l.StencilMode=Xg,l.StructArrayLayout1ui2=oo,l.StructArrayLayout2f1f2i16=H,l.StructArrayLayout2i4=gi,l.StructArrayLayout2ui4=Pr,l.StructArrayLayout3f12=Ne,l.StructArrayLayout3ui6=Qe,l.StructArrayLayout4i8=vr,l.StructArrayLayout5f20=Ri,l.Texture=$h,l.Tile=Mm,l.Transitionable=tt,l.Uniform1f=Ou,l.Uniform1i=class extends Rc{constructor(t){super(t),this.current=0}set(t,e,n){this.fetchUniformLocation(t,e)&&this.current!==n&&(this.current=n,this.gl.uniform1i(this.location,n))}},l.Uniform2f=class extends Rc{constructor(t){super(t),this.current=[0,0]}set(t,e,n){this.fetchUniformLocation(t,e)&&(n[0]===this.current[0]&&n[1]===this.current[1]||(this.current=n,this.gl.uniform2f(this.location,n[0],n[1])))}},l.Uniform3f=class extends Rc{constructor(t){super(t),this.current=[0,0,0]}set(t,e,n){this.fetchUniformLocation(t,e)&&(n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]||(this.current=n,this.gl.uniform3f(this.location,n[0],n[1],n[2])))}},l.Uniform4f=al,l.UniformColor=xc,l.UniformMatrix2f=class extends Rc{constructor(t){super(t),this.current=xh}set(t,e,n){if(this.fetchUniformLocation(t,e))for(let s=0;s<4;s++)if(n[s]!==this.current[s]){this.current=n,this.gl.uniformMatrix2fv(this.location,!1,n);break}}},l.UniformMatrix3f=class extends Rc{constructor(t){super(t),this.current=Ru}set(t,e,n){if(this.fetchUniformLocation(t,e))for(let s=0;s<9;s++)if(n[s]!==this.current[s]){this.current=n,this.gl.uniformMatrix3fv(this.location,!1,n);break}}},l.UniformMatrix4f=class extends Rc{constructor(t){super(t),this.current=fu}set(t,e,n){if(this.fetchUniformLocation(t,e)){if(n[12]!==this.current[12]||n[0]!==this.current[0])return this.current=n,void this.gl.uniformMatrix4fv(this.location,!1,n);for(let s=1;s<16;s++)if(n[s]!==this.current[s]){this.current=n,this.gl.uniformMatrix4fv(this.location,!1,n);break}}}},l.UnwrappedTileID=lp,l.ValidationError=q,l.VectorTileWorkerSource=class extends Xn{constructor(t,e,n,s,h){super(),this.actor=t,this.layerIndex=e,this.availableImages=n,this.loadVectorData=h||Lm,this.loading={},this.loaded={},this.deduped=new Nm(t.scheduler),this.isSpriteLoaded=s,this.scheduler=t.scheduler}loadTile(t,e){const n=t.uid,s=t&&t.request,h=s&&s.collectResourceTiming,p=this.loading[n]=new Qg(t);p.abort=this.loadVectorData(t,(y,T)=>{const R=!this.loading[n];if(delete this.loading[n],R||y||!T)return p.status="done",R||(this.loaded[n]=p),e(y);const F=T.rawData,W={};T.expires&&(W.expires=T.expires),T.cacheControl&&(W.cacheControl=T.cacheControl),p.vectorTile=T.vectorTile||new xu.VectorTile(new uf(F));const te=()=>{p.parse(p.vectorTile,this.layerIndex,this.availableImages,this.actor,(re,_e)=>{if(re||!_e)return e(re);const we={};if(h){const Oe=Tt(s);Oe.length>0&&(we.resourceTiming=JSON.parse(JSON.stringify(Oe)))}e(null,se({rawTileData:F.slice(0)},_e,W,we))})};this.isSpriteLoaded?te():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(te,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom}):te()}),this.loaded=this.loaded||{},this.loaded[n]=p})}reloadTile(t,e){const n=this.loaded,s=t.uid,h=this;if(n&&n[s]){const p=n[s];p.showCollisionBoxes=t.showCollisionBoxes,p.enableTerrain=!!t.enableTerrain,p.projection=t.projection,p.tileTransform=jh(t.tileID.canonical,t.projection);const y=(T,R)=>{const F=p.reloadCallback;F&&(delete p.reloadCallback,p.parse(p.vectorTile,h.layerIndex,this.availableImages,h.actor,F)),e(T,R)};"parsing"===p.status?p.reloadCallback=y:"done"===p.status&&(p.vectorTile?p.parse(p.vectorTile,this.layerIndex,this.availableImages,this.actor,y):y())}}abortTile(t,e){const n=t.uid,s=this.loading[n];s&&(s.abort&&s.abort(),delete this.loading[n]),e()}removeTile(t,e){const n=this.loaded,s=t.uid;n&&n[s]&&delete n[s],e()}},l.WritingMode=ac,l.ZoomHistory=Yu,l.add=eu,l.addDynamicAttributes=Ef,l.adjoint=function(t,e){var n=e[0],s=e[1],h=e[2],p=e[3],y=e[4],T=e[5],R=e[6],F=e[7],W=e[8];return t[0]=y*W-T*F,t[1]=h*F-s*W,t[2]=s*T-h*y,t[3]=T*R-p*W,t[4]=n*W-h*R,t[5]=h*p-n*T,t[6]=p*F-y*R,t[7]=s*R-n*F,t[8]=n*y-s*p,t},l.asyncAll=on,l.bezier=ft,l.bindAll=$t,l.boundsAttributes=Am,l.bufferConvexPolygon=function(t,e){const n=[];for(let s=0;s<t.length;s++){const h=Qn(s-1,-1,t.length-1),p=Qn(s+1,-1,t.length-1),y=t[s],T=t[p],R=t[h].sub(y).unit(),F=T.sub(y).unit(),W=F.angleWithSep(R.x,R.y),te=R.add(F).unit().mult(-1*e/Math.sin(W/2));n.push(y.add(te))}return n},l.cacheEntryPossiblyAdded=function(t){Xe++,Xe>Zo&&(t.getActor().send("enforceCacheSizeLimit",Ao),Xe=0)},l.calculateGlobeLabelMatrix=function(t,e){const{x:n,y:s}=t.point,h=Og(n,s,t.worldSize/t._pixelsPerMercatorPixel,0,0);return Ah(h,h,wm(iu(e)))},l.calculateGlobeMatrix=function(t){const{x:e,y:n}=t.point,{lng:s,lat:h}=t._center;return Og(e,n,t.worldSize,s,h)},l.calculateGlobeMercatorMatrix=function(t){const e=t.pixelsPerMeter,n=e/Xs(1,t.center.lat),s=ic(new Float64Array(16));return Fu(s,s,[t.point.x,t.point.y,0]),jc(s,s,[n,n,e]),Float32Array.from(s)},l.circumferenceAtLatitude=Eh,l.clamp=kt,l.clearTileCache=function(t){const e=qe(),n=[];for(const s in To)e&&n.push(e.delete(s)),delete To[s];t&&Promise.all(n).catch(t).then(()=>t())},l.clipLine=mm,l.clone=function(t){var e=new dc(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},l.clone$1=An,l.collisionCircleLayout=ug,l.config=Mn,l.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},l.create=function(){var t=new dc(16);return dc!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},l.create$1=Vc,l.createExpression=ai,l.createLayout=Un,l.createStyleLayer=function(t){return"custom"===t.type?new U_(t):new j_[t.type](t)},l.cross=dd,l.degToRad=wt,l.distance=function(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1],e[2]-t[2])},l.div=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t},l.dot=fc,l.ease=tn,l.easeCubicInOut=at,l.emitValidationErrors=Ea,l.endsWith=en,l.enforceCacheSizeLimit=function(t){for(const e in To)Te(e),To[e].then(n=>{n.keys().then(s=>{for(let h=0;h<s.length-t;h++)n.delete(s[h])})})},l.evaluateSizeForFeature=up,l.evaluateSizeForZoom=Td,l.evaluateVariableOffset=ym,l.evented=De,l.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},l.exactEquals$1=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},l.exported=Zr,l.exported$1=yo,l.extend=se,l.extend$1=Gr,l.fillExtrusionHeightLift=em,l.filterObject=Yt,l.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},l.fromQuat=function(t,e){var n=e[0],s=e[1],h=e[2],p=e[3],y=n+n,T=s+s,R=h+h,F=n*y,W=s*y,te=s*T,re=h*y,_e=h*T,we=h*R,Oe=p*y,Ve=p*T,it=p*R;return t[0]=1-te-we,t[1]=W+it,t[2]=re-Ve,t[3]=0,t[4]=W-it,t[5]=1-F-we,t[6]=_e+Oe,t[7]=0,t[8]=re+Ve,t[9]=_e-Oe,t[10]=1-F-te,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},l.fromRotation=function(t,e){var n=Math.sin(e),s=Math.cos(e);return t[0]=s,t[1]=n,t[2]=0,t[3]=-n,t[4]=s,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},l.fromScaling=Kd,l.furthestTileCorner=function(t){const e=Math.round((t+45+360)%360/90)%4;return st[e]},l.getAABBPointSquareDist=function(t,e,n){let s=0;for(let h=0;h<2;++h){const p=n?n[h]:0;t[h]>p&&(s+=(t[h]-p)*(t[h]-p)),e[h]<p&&(s+=(p-e[h])*(p-e[h]))}return s},l.getAnchorAlignment=mp,l.getAnchorJustification=xp,l.getBounds=function(t){let e=1/0,n=1/0,s=-1/0,h=-1/0;for(const p of t)e=Math.min(e,p.x),n=Math.min(n,p.y),s=Math.max(s,p.x),h=Math.max(h,p.y);return{min:new Ke(e,n),max:new Ke(s,h)}},l.getColumn=yn,l.getGridMatrix=function(t,e,n){const s=e.getNorth(),h=e.getSouth(),p=e.getWest(),y=.015625;return[0,(e.getEast()-p)*y,1<<t.z,(h-s)/Od[n],0,t.y,s,p,y]},l.getImage=rn,l.getJSON=function(t,e){return nt(se(t,{type:"json"}),e)},l.getLatitudinalLod=function(t){const e=80.051129;t=kt(t,-80.051129,e)/e*90;const n=Math.pow(Math.abs(Math.sin(wt(t))),3);return Math.round(n*(Od.length-1))},l.getMapSessionAPI=sr,l.getPerformanceMeasurement=Tt,l.getProjection=Cm,l.getRTLTextPluginStatus=Fe,l.getReferrer=Rt,l.getTilePoint=function(t,{x:e,y:n},s=0){return new Ke(((e-s)*t.scale-t.x)*Fr,(n*t.scale-t.y)*Fr)},l.getTileVec3=function(t,e,n=0){return ih(((e.x-n)*t.scale-t.x)*Fr,(e.y*t.scale-t.y)*Fr,Zd(e.z,e.y))},l.getVideo=function(t,e){const n=oe.document.createElement("video");n.muted=!0,n.onloadstart=function(){e(null,n)};for(let s=0;s<t.length;s++){const h=oe.document.createElement("source");Se(t[s])||(n.crossOrigin="Anonymous"),h.src=t[s],n.appendChild(h)}return{cancel:()=>{}}},l.globeCenterToScreenPoint=function(t){const e=[0,0,0],n=ic(new Float64Array(16));return Ah(n,t.pixelMatrix,t.globeMatrix),$a(e,e,n),new Ke(e[0],e[1])},l.globeDenormalizeECEF=wm,l.globeECEFOrigin=function(t,e){const n=[0,0,0];return $a(n,n,_f(iu(e.canonical))),$a(n,n,t),n},l.globeNormalizeECEF=_f,l.globePixelsToTileUnits=function(t,e){return Fr/(512*Math.pow(2,t))*Sp(iu(e))},l.globePoleMatrixForTile=function(t,e,n){const s=ic(new Float64Array(16)),h=(e/(1<<t)-.5)*Math.PI*2;return cd(s,n.globeMatrix,h),Float32Array.from(s)},l.globeTileBounds=iu,l.globeTiltAtLngLat=vf,l.globeToMercatorTransition=yf,l.globeUseCustomAntiAliasing=function(t,e,n){const s=yf(n.zoom),h=t.style.map._antialias,p=!!e.extStandardDerivatives,y=e.extStandardDerivativesForceOff||t.terrain&&t.terrain.exaggeration()>0;return 0===s&&!h&&!y&&p},l.identity=ic,l.identity$1=$p,l.invert=ld,l.isFullscreen=function(){return!!oe.document.fullscreenElement||!!oe.document.webkitFullscreenElement},l.isLngLatBehindGlobe=function(t,e){return vf(t,e)>Math.PI/2*1.01},l.isMapAuthenticated=function(t){return Io.has(t)},l.isMapboxURL=Nn,l.isSafariWithAntialiasingBug=function(t){const e=t.navigator?t.navigator.userAgent:null;return!!Ti(t)&&e&&(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},l.latFromMercatorY=Qa,l.len=Hp,l.length=nh,l.length$1=function(t){return Math.hypot(t[0],t[1],t[2],t[3])},l.loadVectorTile=Lm,l.makeRequest=nt,l.mapValue=function(t,e,n,s,h){return kt((t-e)/(n-e)*(h-s)+s,s,h)},l.mercatorScale=od,l.mercatorXfromLng=Tc,l.mercatorYfromLat=Fc,l.mercatorZfromAltitude=Xs,l.mul=Vp,l.mul$1=Gp,l.multiply=Ah,l.multiply$1=function(t,e,n){var s=e[0],h=e[1],p=e[2],y=e[3],T=e[4],R=e[5],F=e[6],W=e[7],te=e[8],re=n[0],_e=n[1],we=n[2],Oe=n[3],Ve=n[4],it=n[5],bt=n[6],rt=n[7],vt=n[8];return t[0]=re*s+_e*y+we*F,t[1]=re*h+_e*T+we*W,t[2]=re*p+_e*R+we*te,t[3]=Oe*s+Ve*y+it*F,t[4]=Oe*h+Ve*T+it*W,t[5]=Oe*p+Ve*R+it*te,t[6]=bt*s+rt*y+vt*F,t[7]=bt*h+rt*T+vt*W,t[8]=bt*p+rt*R+vt*te,t},l.multiply$2=Zp,l.nextPowerOfTwo=Ci,l.normalize=$l,l.normalize$1=function(t,e){var n=e[0],s=e[1],h=e[2],p=e[3],y=n*n+s*s+h*h+p*p;return y>0&&(y=1/Math.sqrt(y)),t[0]=n*y,t[1]=s*y,t[2]=h*y,t[3]=p*y,t},l.number=wn,l.ortho=function(t,e,n,s,h,p,y){var T=1/(e-n),R=1/(s-h),F=1/(p-y);return t[0]=-2*T,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*R,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*F,t[11]=0,t[12]=(e+n)*T,t[13]=(h+s)*R,t[14]=(y+p)*F,t[15]=1,t},l.pbf=uf,l.perspective=function(t,e,n,s,h){var p,y=1/Math.tan(e/2);return t[0]=y/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=y,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=h&&h!==1/0?(t[10]=(h+s)*(p=1/(s-h)),t[14]=2*h*s*p):(t[10]=-1,t[14]=-2*s),t},l.pick=function(t,e){const n={};for(let s=0;s<e.length;s++){const h=e[s];h in t&&(n[h]=t[h])}return n},l.plugin=Ge,l.pointGeometry=Ke,l.polygonContainsPoint=Lu,l.polygonIntersectsBox=$f,l.polygonIntersectsPolygon=$d,l.polygonizeBounds=function(t,e,n=0,s=!0){const h=new Ke(n,n),p=t.sub(h),y=e.add(h),T=[p,new Ke(y.x,p.y),y,new Ke(p.x,y.y)];return s&&T.push(p.clone()),T},l.posAttributes=Ep,l.postMapLoadEvent=ei,l.postTurnstileEvent=fo,l.potpack=Sd,l.prevPowerOfTwo=function(t){return t<=1?1:Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},l.radToDeg=Bt,l.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],l.registerForPluginStateChange=function(t){return t({pluginStatus:Z,pluginURL:K}),De.on("pluginStateChange",t),t},l.removeAuthState=function(t){Io.delete(t)},l.renderColorRamp=ve,l.resample=Gd,l.rotateX=Yd,l.rotateX$1=pd,l.rotateY=cd,l.rotateY$1=Xd,l.rotateZ=function(t,e,n){var s=Math.sin(n),h=Math.cos(n),p=e[0],y=e[1],T=e[2],R=e[3],F=e[4],W=e[5],te=e[6],re=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=p*h+F*s,t[1]=y*h+W*s,t[2]=T*h+te*s,t[3]=R*h+re*s,t[4]=F*h-p*s,t[5]=W*h-y*s,t[6]=te*h-T*s,t[7]=re*h-R*s,t},l.rotateZ$1=function(t,e,n){n*=.5;var s=e[0],h=e[1],p=e[2],y=e[3],T=Math.sin(n),R=Math.cos(n);return t[0]=s*R+h*T,t[1]=h*R-s*T,t[2]=p*R+y*T,t[3]=y*R-p*T,t},l.scale=jc,l.scale$1=_u,l.scale$2=Zc,l.scaleAndAdd=Mh,l.setCacheLimits=function(t,e){Ao=t,Zo=e},l.setColumn=function(t,e,n){t[4*e+0]=n[0],t[4*e+1]=n[1],t[4*e+2]=n[2],t[4*e+3]=n[3]},l.setRTLTextPlugin=function(t,e,n=!1){if(Z===m||Z===E||Z===M)throw new Error("setRTLTextPlugin cannot be called multiple times.");K=Zr.resolveURL(t),Z=m,z=e,pe(),n||Je()},l.smoothstep=dn,l.spec=qt,l.storeAuthState=function(t,e){e?Io.add(t):Io.delete(t)},l.sub=Gc,l.subtract=hd,l.symbolSize=jy,l.tileAABB=function(t,e,n,s,h,p,y,T,R){if("globe"===R.name)return function L_(t,e,n){const s=e/t.worldSize,h=Number.MAX_VALUE,p=[-h,-h,-h],y=[h,h,h],T=t.globeMatrix;if(n.z<=1)return bm(y,p,iu(n).getCorners(),T,s),new Ul(y,p);const R=xm(n),F=Cp(R);if(bm(y,p,F,T,s),R.contains(t.center)){p[2]=0;const fn=t.point,hn=[fn.x*s,fn.y*s,0];return Wf(y,y,hn),Yf(p,p,hn),new Ul(y,p)}const W=[T[12]*s,T[13]*s,T[14]*s],te=R.getCenter(),re=kt(t.center.lat,-85.051129,Bc),_e=kt(te.lat,-85.051129,Bc),we=Tc(t.center.lng),Oe=Fc(re);let Ve=we-Tc(te.lng);const it=Oe-Fc(_e);Ve>.5?Ve-=1:Ve<-.5&&(Ve+=1);let bt=0;Math.abs(Ve)>Math.abs(it)?bt=Ve>=0?1:3:(bt=it>=0?0:2,Mh(W,W,[T[4]*s,T[5]*s,T[6]*s],-Math.sin(wt(it>=0?R.getSouth():R.getNorth()))*lh));const rt=F[bt],vt=F[(bt+1)%4],Lt=new Wy(rt,vt,W),St=[Ig(Lt,0)||rt[0],Ig(Lt,1)||rt[1],Ig(Lt,2)||rt[2]];return y[2]=Math.min(rt[2],vt[2]),Wf(y,y,St),Yf(p,p,St),new Ul(y,p)}(t,e,new ap(n,s,h));const F=jh({z:n,x:s,y:h},R);return new Ul([(p+F.x/F.scale)*e,e*(F.y/F.scale),y],[(p+F.x2/F.scale)*e,e*(F.y2/F.scale),T])},l.tileCornersToBounds=xm,l.tileTransform=jh,l.transformMat3=function(t,e,n){var s=e[0],h=e[1],p=e[2];return t[0]=s*n[0]+h*n[3]+p*n[6],t[1]=s*n[1]+h*n[4]+p*n[7],t[2]=s*n[2]+h*n[5]+p*n[8],t},l.transformMat4=$a,l.transformMat4$1=zu,l.transformQuat=Ih,l.transitionTileAABBinECEF=vm,l.translate=Fu,l.transpose=function(t,e){if(t===e){var n=e[1],s=e[2],h=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=s,t[7]=h}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},l.triggerPluginCompletionEvent=de,l.uniqueId=ii,l.updateGlobeVertexNormal=function(t,e,n,s,h){const p=5*e+2;t.float32[p+0]=n,t.float32[p+1]=s,t.float32[p+2]=h},l.validateCustomStyleLayer=function(t){const e=[],n=t.id;return void 0===n&&e.push({message:`layers.${n}: missing required property "id"`}),void 0===t.render&&e.push({message:`layers.${n}: missing required method "render"`}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&e.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),e},l.validateFilter=t=>ol(Pe(t)),l.validateFog=t=>ol(dl(t)),l.validateLayer=t=>ol(Vi(t)),l.validateLight=t=>ol(Tl(t)),l.validateSource=t=>ol(Zs(t)),l.validateStyle=Cl,l.validateTerrain=t=>ol(kl(t)),l.values=Cn,l.vectorTile=xu,l.version="2.10.0",l.warnOnce=Mi,l.window=oe,l.wrap=Qn}),N(0,function(l){function oe(qe){if("number"==typeof qe||"boolean"==typeof qe||"string"==typeof qe||null==qe)return JSON.stringify(qe);if(Array.isArray(qe)){let Me="[";for(const We of qe)Me+=`${oe(We)},`;return`${Me}]`}let Te="{";for(const Me of Object.keys(qe).sort())Te+=`${Me}:${oe(qe[Me])},`;return`${Te}}`}function lt(qe){let Te="";for(const Me of l.refProperties)Te+=`/${oe(qe[Me])}`;return Te}class At{constructor(Te){this.keyCache={},Te&&this.replace(Te)}replace(Te){this._layerConfigs={},this._layers={},this.update(Te,[])}update(Te,Me){for(const Xe of Te)this._layerConfigs[Xe.id]=Xe,(this._layers[Xe.id]=l.createStyleLayer(Xe)).compileFilter(),this.keyCache[Xe.id]&&delete this.keyCache[Xe.id];for(const Xe of Me)delete this.keyCache[Xe],delete this._layerConfigs[Xe],delete this._layers[Xe];this.familiesBySource={};const We=function(Xe,xt){const Gt={};for(let nt=0;nt<Xe.length;nt++){const Kt=xt&&xt[Xe[nt].id]||lt(Xe[nt]);xt&&(xt[Xe[nt].id]=Kt);let Dn=Gt[Kt];Dn||(Dn=Gt[Kt]=[]),Dn.push(Xe[nt])}const Rt=[];for(const nt in Gt)Rt.push(Gt[nt]);return Rt}(l.values(this._layerConfigs),this.keyCache);for(const Xe of We){const xt=Xe.map(xe=>this._layers[xe.id]),Gt=xt[0];if("none"===Gt.visibility)continue;const Rt=Gt.source||"";let nt=this.familiesBySource[Rt];nt||(nt=this.familiesBySource[Rt]={});const Kt=Gt.sourceLayer||"_geojsonTileLayer";let Dn=nt[Kt];Dn||(Dn=nt[Kt]=[]),Dn.push(xt)}}}class Ke{loadTile(Te,Me){const{uid:We,encoding:Xe,rawImageData:xt,padding:Gt,buildQuadTree:Rt}=Te,nt=l.window.ImageBitmap&&xt instanceof l.window.ImageBitmap?this.getImageData(xt,Gt):xt;Me(null,new l.DEMData(We,nt,Xe,Gt<1,Rt))}getImageData(Te,Me){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Te.width,Te.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=Te.width,this.offscreenCanvas.height=Te.height,this.offscreenCanvasContext.drawImage(Te,0,0,Te.width,Te.height);const We=this.offscreenCanvasContext.getImageData(-Me,-Me,Te.width+2*Me,Te.height+2*Me);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),We}}var ct=function qe(Te,Me){var We,Xe=Te&&Te.type;if("FeatureCollection"===Xe)for(We=0;We<Te.features.length;We++)qe(Te.features[We],Me);else if("GeometryCollection"===Xe)for(We=0;We<Te.geometries.length;We++)qe(Te.geometries[We],Me);else if("Feature"===Xe)qe(Te.geometry,Me);else if("Polygon"===Xe)_t(Te.coordinates,Me);else if("MultiPolygon"===Xe)for(We=0;We<Te.coordinates.length;We++)_t(Te.coordinates[We],Me);return Te};function _t(qe,Te){if(0!==qe.length){Nt(qe[0],Te);for(var Me=1;Me<qe.length;Me++)Nt(qe[Me],!Te)}}function Nt(qe,Te){for(var Me=0,We=0,Xe=0,xt=qe.length,Gt=xt-1;Xe<xt;Gt=Xe++){var Rt=(qe[Xe][0]-qe[Gt][0])*(qe[Gt][1]+qe[Xe][1]),nt=Me+Rt;We+=Math.abs(Me)>=Math.abs(Rt)?Me-nt+Rt:Rt-nt+Me,Me=nt}Me+We>=0!=!!Te&&qe.reverse()}const wt=l.vectorTile.VectorTileFeature.prototype.toGeoJSON;class Bt{constructor(Te){this._feature=Te,this.extent=l.EXTENT,this.type=Te.type,this.properties=Te.tags,"id"in Te&&!isNaN(Te.id)&&(this.id=parseInt(Te.id,10))}loadGeometry(){if(1===this._feature.type){const Te=[];for(const Me of this._feature.geometry)Te.push([new l.pointGeometry(Me[0],Me[1])]);return Te}{const Te=[];for(const Me of this._feature.geometry){const We=[];for(const Xe of Me)We.push(new l.pointGeometry(Xe[0],Xe[1]));Te.push(We)}return Te}}toGeoJSON(Te,Me,We){return wt.call(this,Te,Me,We)}}class st{constructor(Te){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=l.EXTENT,this.length=Te.length,this._features=Te}feature(Te){return new Bt(this._features[Te])}}var at=l.vectorTile.VectorTileFeature,ft=tn;function tn(qe,Te){this.options=Te||{},this.features=qe,this.length=qe.length}function kt(qe,Te){this.id="number"==typeof qe.id?qe.id:void 0,this.type=qe.type,this.rawGeometry=1===qe.type?[qe.geometry]:qe.geometry,this.properties=qe.tags,this.extent=Te||4096}tn.prototype.feature=function(qe){return new kt(this.features[qe],this.options.extent)},kt.prototype.loadGeometry=function(){var qe=this.rawGeometry;this.geometry=[];for(var Te=0;Te<qe.length;Te++){for(var Me=qe[Te],We=[],Xe=0;Xe<Me.length;Xe++)We.push(new l.pointGeometry(Me[Xe][0],Me[Xe][1]));this.geometry.push(We)}return this.geometry},kt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var qe=this.geometry,Te=1/0,Me=-1/0,We=1/0,Xe=-1/0,xt=0;xt<qe.length;xt++)for(var Gt=qe[xt],Rt=0;Rt<Gt.length;Rt++){var nt=Gt[Rt];Te=Math.min(Te,nt.x),Me=Math.max(Me,nt.x),We=Math.min(We,nt.y),Xe=Math.max(Xe,nt.y)}return[Te,We,Me,Xe]},kt.prototype.toGeoJSON=at.prototype.toGeoJSON;var dn=on,Qn=ft;function on(qe){var Te=new l.pbf;return function(Me,We){for(var Xe in Me.layers)We.writeMessage(3,Cn,Me.layers[Xe])}(qe,Te),Te.finish()}function Cn(qe,Te){var Me;Te.writeVarintField(15,qe.version||1),Te.writeStringField(1,qe.name||""),Te.writeVarintField(5,qe.extent||4096);var We={keys:[],values:[],keycache:{},valuecache:{}};for(Me=0;Me<qe.length;Me++)We.feature=qe.feature(Me),Te.writeMessage(2,se,We);var Xe=We.keys;for(Me=0;Me<Xe.length;Me++)Te.writeStringField(3,Xe[Me]);var xt=We.values;for(Me=0;Me<xt.length;Me++)Te.writeMessage(4,Jt,xt[Me])}function se(qe,Te){var Me=qe.feature;void 0!==Me.id&&Te.writeVarintField(1,Me.id),Te.writeMessage(2,Wi,qe),Te.writeVarintField(3,Me.type),Te.writeMessage(4,Ci,Me)}function Wi(qe,Te){var Me=qe.feature,We=qe.keys,Xe=qe.values,xt=qe.keycache,Gt=qe.valuecache;for(var Rt in Me.properties){var nt=Me.properties[Rt],Kt=xt[Rt];if(null!==nt){void 0===Kt&&(We.push(Rt),xt[Rt]=Kt=We.length-1),Te.writeVarint(Kt);var Dn=typeof nt;"string"!==Dn&&"boolean"!==Dn&&"number"!==Dn&&(nt=JSON.stringify(nt));var xe=Dn+":"+nt,Se=Gt[xe];void 0===Se&&(Xe.push(nt),Gt[xe]=Se=Xe.length-1),Te.writeVarint(Se)}}}function ii(qe,Te){return(Te<<3)+(7&qe)}function kn(qe){return qe<<1^qe>>31}function Ci(qe,Te){for(var Me=qe.loadGeometry(),We=qe.type,Xe=0,xt=0,Gt=Me.length,Rt=0;Rt<Gt;Rt++){var nt=Me[Rt],Kt=1;1===We&&(Kt=nt.length),Te.writeVarint(ii(1,Kt));for(var Dn=3===We?nt.length-1:nt.length,xe=0;xe<Dn;xe++){1===xe&&1!==We&&Te.writeVarint(ii(2,Dn-1));var Se=nt[xe].x-Xe,Be=nt[xe].y-xt;Te.writeVarint(kn(Se)),Te.writeVarint(kn(Be)),Xe+=Se,xt+=Be}3===We&&Te.writeVarint(ii(7,1))}}function Jt(qe,Te){var Me=typeof qe;"string"===Me?Te.writeStringField(1,qe):"boolean"===Me?Te.writeBooleanField(7,qe):"number"===Me&&(qe%1!=0?Te.writeDoubleField(3,qe):qe<0?Te.writeSVarintField(6,qe):Te.writeVarintField(5,qe))}function $t(qe,Te,Me,We,Xe,xt){if(Xe-We<=Me)return;const Gt=We+Xe>>1;en(qe,Te,Gt,We,Xe,xt%2),$t(qe,Te,Me,We,Gt-1,xt+1),$t(qe,Te,Me,Gt+1,Xe,xt+1)}function en(qe,Te,Me,We,Xe,xt){for(;Xe>We;){if(Xe-We>600){const Kt=Xe-We+1,Dn=Me-We+1,xe=Math.log(Kt),Se=.5*Math.exp(2*xe/3),Be=.5*Math.sqrt(xe*Se*(Kt-Se)/Kt)*(Dn-Kt/2<0?-1:1);en(qe,Te,Me,Math.max(We,Math.floor(Me-Dn*Se/Kt+Be)),Math.min(Xe,Math.floor(Me+(Kt-Dn)*Se/Kt+Be)),xt)}const Gt=Te[2*Me+xt];let Rt=We,nt=Xe;for(an(qe,Te,We,Me),Te[2*Xe+xt]>Gt&&an(qe,Te,We,Xe);Rt<nt;){for(an(qe,Te,Rt,nt),Rt++,nt--;Te[2*Rt+xt]<Gt;)Rt++;for(;Te[2*nt+xt]>Gt;)nt--}Te[2*We+xt]===Gt?an(qe,Te,We,nt):(nt++,an(qe,Te,nt,Xe)),nt<=Me&&(We=nt+1),Me<=nt&&(Xe=nt-1)}}function an(qe,Te,Me,We){Yt(qe,Me,We),Yt(Te,2*Me,2*We),Yt(Te,2*Me+1,2*We+1)}function Yt(qe,Te,Me){const We=qe[Te];qe[Te]=qe[Me],qe[Me]=We}function An(qe,Te,Me,We){const Xe=qe-Me,xt=Te-We;return Xe*Xe+xt*xt}dn.fromVectorTileJs=on,dn.fromGeojsonVt=function(qe,Te){Te=Te||{};var Me={};for(var We in qe)Me[We]=new ft(qe[We].features,Te),Me[We].name=We,Me[We].version=Te.version,Me[We].extent=Te.extent;return on({layers:Me})},dn.GeoJSONWrapper=Qn;const Sn=qe=>qe[0],Mi=qe=>qe[1];class mr{constructor(Te,Me=Sn,We=Mi,Xe=64,xt=Float64Array){this.nodeSize=Xe,this.points=Te;const Gt=Te.length<65536?Uint16Array:Uint32Array,Rt=this.ids=new Gt(Te.length),nt=this.coords=new xt(2*Te.length);for(let Kt=0;Kt<Te.length;Kt++)Rt[Kt]=Kt,nt[2*Kt]=Me(Te[Kt]),nt[2*Kt+1]=We(Te[Kt]);$t(Rt,nt,Xe,0,Rt.length-1,0)}range(Te,Me,We,Xe){return function(xt,Gt,Rt,nt,Kt,Dn,xe){const Se=[0,xt.length-1,0],Be=[];let dt,Pt;for(;Se.length;){const rn=Se.pop(),un=Se.pop(),In=Se.pop();if(un-In<=xe){for(let Xn=In;Xn<=un;Xn++)dt=Gt[2*Xn],Pt=Gt[2*Xn+1],dt>=Rt&&dt<=Kt&&Pt>=nt&&Pt<=Dn&&Be.push(xt[Xn]);continue}const Pn=Math.floor((In+un)/2);dt=Gt[2*Pn],Pt=Gt[2*Pn+1],dt>=Rt&&dt<=Kt&&Pt>=nt&&Pt<=Dn&&Be.push(xt[Pn]);const mi=(rn+1)%2;(0===rn?Rt<=dt:nt<=Pt)&&(Se.push(In),Se.push(Pn-1),Se.push(mi)),(0===rn?Kt>=dt:Dn>=Pt)&&(Se.push(Pn+1),Se.push(un),Se.push(mi))}return Be}(this.ids,this.coords,Te,Me,We,Xe,this.nodeSize)}within(Te,Me,We){return function(Xe,xt,Gt,Rt,nt,Kt){const Dn=[0,Xe.length-1,0],xe=[],Se=nt*nt;for(;Dn.length;){const Be=Dn.pop(),dt=Dn.pop(),Pt=Dn.pop();if(dt-Pt<=Kt){for(let mi=Pt;mi<=dt;mi++)An(xt[2*mi],xt[2*mi+1],Gt,Rt)<=Se&&xe.push(Xe[mi]);continue}const rn=Math.floor((Pt+dt)/2),un=xt[2*rn],In=xt[2*rn+1];An(un,In,Gt,Rt)<=Se&&xe.push(Xe[rn]);const Pn=(Be+1)%2;(0===Be?Gt-nt<=un:Rt-nt<=In)&&(Dn.push(Pt),Dn.push(rn-1),Dn.push(Pn)),(0===Be?Gt+nt>=un:Rt+nt>=In)&&(Dn.push(rn+1),Dn.push(dt),Dn.push(Pn))}return xe}(this.ids,this.coords,Te,Me,We,this.nodeSize)}}const wi={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:qe=>qe},_i=Math.fround||(Ki=new Float32Array(1),qe=>(Ki[0]=+qe,Ki[0]));var Ki;class ui{constructor(Te){this.options=fi(Object.create(wi),Te),this.trees=new Array(this.options.maxZoom+1)}load(Te){const{log:Me,minZoom:We,maxZoom:Xe,nodeSize:xt}=this.options;Me&&console.time("total time");const Gt=`prepare ${Te.length} points`;Me&&console.time(Gt),this.points=Te;let Rt=[];for(let nt=0;nt<Te.length;nt++)Te[nt].geometry&&Rt.push(Br(Te[nt],nt));this.trees[Xe+1]=new mr(Rt,nr,Tr,xt,Float32Array),Me&&console.timeEnd(Gt);for(let nt=Xe;nt>=We;nt--){const Kt=+Date.now();Rt=this._cluster(Rt,nt),this.trees[nt]=new mr(Rt,nr,Tr,xt,Float32Array),Me&&console.log("z%d: %d clusters in %dms",nt,Rt.length,+Date.now()-Kt)}return Me&&console.timeEnd("total time"),this}getClusters(Te,Me){let We=((Te[0]+180)%360+360)%360-180;const Xe=Math.max(-90,Math.min(90,Te[1]));let xt=180===Te[2]?180:((Te[2]+180)%360+360)%360-180;const Gt=Math.max(-90,Math.min(90,Te[3]));if(Te[2]-Te[0]>=360)We=-180,xt=180;else if(We>xt){const Dn=this.getClusters([We,Xe,180,Gt],Me),xe=this.getClusters([-180,Xe,xt,Gt],Me);return Dn.concat(xe)}const Rt=this.trees[this._limitZoom(Me)],nt=Rt.range(Tt(We),En(Gt),Tt(xt),En(Xe)),Kt=[];for(const Dn of nt){const xe=Rt.points[Dn];Kt.push(xe.numPoints?yn(xe):this.points[xe.index])}return Kt}getChildren(Te){const Me=this._getOriginId(Te),We=this._getOriginZoom(Te),Xe="No cluster with the specified id.",xt=this.trees[We];if(!xt)throw new Error(Xe);const Gt=xt.points[Me];if(!Gt)throw new Error(Xe);const Rt=this.options.radius/(this.options.extent*Math.pow(2,We-1)),nt=xt.within(Gt.x,Gt.y,Rt),Kt=[];for(const Dn of nt){const xe=xt.points[Dn];xe.parentId===Te&&Kt.push(xe.numPoints?yn(xe):this.points[xe.index])}if(0===Kt.length)throw new Error(Xe);return Kt}getLeaves(Te,Me,We){const Xe=[];return this._appendLeaves(Xe,Te,Me=Me||10,We=We||0,0),Xe}getTile(Te,Me,We){const Xe=this.trees[this._limitZoom(Te)],xt=Math.pow(2,Te),{extent:Gt,radius:Rt}=this.options,nt=Rt/Gt,Kt=(We-nt)/xt,Dn=(We+1+nt)/xt,xe={features:[]};return this._addTileFeatures(Xe.range((Me-nt)/xt,Kt,(Me+1+nt)/xt,Dn),Xe.points,Me,We,xt,xe),0===Me&&this._addTileFeatures(Xe.range(1-nt/xt,Kt,1,Dn),Xe.points,xt,We,xt,xe),Me===xt-1&&this._addTileFeatures(Xe.range(0,Kt,nt/xt,Dn),Xe.points,-1,We,xt,xe),xe.features.length?xe:null}getClusterExpansionZoom(Te){let Me=this._getOriginZoom(Te)-1;for(;Me<=this.options.maxZoom;){const We=this.getChildren(Te);if(Me++,1!==We.length)break;Te=We[0].properties.cluster_id}return Me}_appendLeaves(Te,Me,We,Xe,xt){const Gt=this.getChildren(Me);for(const Rt of Gt){const nt=Rt.properties;if(nt&&nt.cluster?xt+nt.point_count<=Xe?xt+=nt.point_count:xt=this._appendLeaves(Te,nt.cluster_id,We,Xe,xt):xt<Xe?xt++:Te.push(Rt),Te.length===We)break}return xt}_addTileFeatures(Te,Me,We,Xe,xt,Gt){for(const Rt of Te){const nt=Me[Rt],Kt=nt.numPoints;let Dn,xe,Se;if(Kt)Dn=oi(nt),xe=nt.x,Se=nt.y;else{const Pt=this.points[nt.index];Dn=Pt.properties,xe=Tt(Pt.geometry.coordinates[0]),Se=En(Pt.geometry.coordinates[1])}const Be={type:1,geometry:[[Math.round(this.options.extent*(xe*xt-We)),Math.round(this.options.extent*(Se*xt-Xe))]],tags:Dn};let dt;Kt?dt=nt.id:this.options.generateId?dt=nt.index:this.points[nt.index].id&&(dt=this.points[nt.index].id),void 0!==dt&&(Be.id=dt),Gt.features.push(Be)}}_limitZoom(Te){return Math.max(this.options.minZoom,Math.min(+Te,this.options.maxZoom+1))}_cluster(Te,Me){const We=[],{radius:Xe,extent:xt,reduce:Gt,minPoints:Rt}=this.options,nt=Xe/(xt*Math.pow(2,Me));for(let Kt=0;Kt<Te.length;Kt++){const Dn=Te[Kt];if(Dn.zoom<=Me)continue;Dn.zoom=Me;const xe=this.trees[Me+1],Se=xe.within(Dn.x,Dn.y,nt),Be=Dn.numPoints||1;let dt=Be;for(const Pt of Se){const rn=xe.points[Pt];rn.zoom>Me&&(dt+=rn.numPoints||1)}if(dt>Be&&dt>=Rt){let Pt=Dn.x*Be,rn=Dn.y*Be,un=Gt&&Be>1?this._map(Dn,!0):null;const In=(Kt<<5)+(Me+1)+this.points.length;for(const Pn of Se){const mi=xe.points[Pn];if(mi.zoom<=Me)continue;mi.zoom=Me;const Xn=mi.numPoints||1;Pt+=mi.x*Xn,rn+=mi.y*Xn,mi.parentId=In,Gt&&(un||(un=this._map(Dn,!0)),Gt(un,this._map(mi)))}Dn.parentId=In,We.push(Ti(Pt/dt,rn/dt,In,dt,un))}else if(We.push(Dn),dt>1)for(const Pt of Se){const rn=xe.points[Pt];rn.zoom<=Me||(rn.zoom=Me,We.push(rn))}}return We}_getOriginId(Te){return Te-this.points.length>>5}_getOriginZoom(Te){return(Te-this.points.length)%32}_map(Te,Me){if(Te.numPoints)return Me?fi({},Te.properties):Te.properties;const We=this.points[Te.index].properties,Xe=this.options.map(We);return Me&&Xe===We?fi({},Xe):Xe}}function Ti(qe,Te,Me,We,Xe){return{x:_i(qe),y:_i(Te),zoom:1/0,id:Me,parentId:-1,numPoints:We,properties:Xe}}function Br(qe,Te){const[Me,We]=qe.geometry.coordinates;return{x:_i(Tt(Me)),y:_i(En(We)),zoom:1/0,index:Te,parentId:-1}}function yn(qe){return{type:"Feature",id:qe.id,properties:oi(qe),geometry:{type:"Point",coordinates:[(Te=qe.x,360*(Te-.5)),si(qe.y)]}};var Te}function oi(qe){const Te=qe.numPoints,Me=Te>=1e4?`${Math.round(Te/1e3)}k`:Te>=1e3?Math.round(Te/100)/10+"k":Te;return fi(fi({},qe.properties),{cluster:!0,cluster_id:qe.id,point_count:Te,point_count_abbreviated:Me})}function Tt(qe){return qe/360+.5}function En(qe){const Te=Math.sin(qe*Math.PI/180),Me=.5-.25*Math.log((1+Te)/(1-Te))/Math.PI;return Me<0?0:Me>1?1:Me}function si(qe){const Te=(180-360*qe)*Math.PI/180;return 360*Math.atan(Math.exp(Te))/Math.PI-90}function fi(qe,Te){for(const Me in Te)qe[Me]=Te[Me];return qe}function nr(qe){return qe.x}function Tr(qe){return qe.y}function Zr(qe,Te,Me,We){for(var Xe,xt=We,Gt=Me-Te>>1,Rt=Me-Te,nt=qe[Te],Kt=qe[Te+1],Dn=qe[Me],xe=qe[Me+1],Se=Te+3;Se<Me;Se+=3){var Be=Ur(qe[Se],qe[Se+1],nt,Kt,Dn,xe);if(Be>xt)Xe=Se,xt=Be;else if(Be===xt){var dt=Math.abs(Se-Gt);dt<Rt&&(Xe=Se,Rt=dt)}}xt>We&&(Xe-Te>3&&Zr(qe,Te,Xe,We),qe[Xe+2]=xt,Me-Xe>3&&Zr(qe,Xe,Me,We))}function Ur(qe,Te,Me,We,Xe,xt){var Gt=Xe-Me,Rt=xt-We;if(0!==Gt||0!==Rt){var nt=((qe-Me)*Gt+(Te-We)*Rt)/(Gt*Gt+Rt*Rt);nt>1?(Me=Xe,We=xt):nt>0&&(Me+=Gt*nt,We+=Rt*nt)}return(Gt=qe-Me)*Gt+(Rt=Te-We)*Rt}function Mn(qe,Te,Me,We){var Xe={id:void 0===qe?null:qe,type:Te,geometry:Me,tags:We,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(xt){var Gt=xt.geometry,Rt=xt.type;if("Point"===Rt||"MultiPoint"===Rt||"LineString"===Rt)yo(xt,Gt);else if("Polygon"===Rt||"MultiLineString"===Rt)for(var nt=0;nt<Gt.length;nt++)yo(xt,Gt[nt]);else if("MultiPolygon"===Rt)for(nt=0;nt<Gt.length;nt++)for(var Kt=0;Kt<Gt[nt].length;Kt++)yo(xt,Gt[nt][Kt])}(Xe),Xe}function yo(qe,Te){for(var Me=0;Me<Te.length;Me+=3)qe.minX=Math.min(qe.minX,Te[Me]),qe.minY=Math.min(qe.minY,Te[Me+1]),qe.maxX=Math.max(qe.maxX,Te[Me]),qe.maxY=Math.max(qe.maxY,Te[Me+1])}function qr(qe,Te,Me,We){if(Te.geometry){var Xe=Te.geometry.coordinates,xt=Te.geometry.type,Gt=Math.pow(Me.tolerance/((1<<Me.maxZoom)*Me.extent),2),Rt=[],nt=Te.id;if(Me.promoteId?nt=Te.properties[Me.promoteId]:Me.generateId&&(nt=We||0),"Point"===xt)no(Xe,Rt);else if("MultiPoint"===xt)for(var Kt=0;Kt<Xe.length;Kt++)no(Xe[Kt],Rt);else if("LineString"===xt)dr(Xe,Rt,Gt,!1);else if("MultiLineString"===xt){if(Me.lineMetrics){for(Kt=0;Kt<Xe.length;Kt++)dr(Xe[Kt],Rt=[],Gt,!1),qe.push(Mn(nt,"LineString",Rt,Te.properties));return}cs(Xe,Rt,Gt,!1)}else if("Polygon"===xt)cs(Xe,Rt,Gt,!0);else{if("MultiPolygon"!==xt){if("GeometryCollection"===xt){for(Kt=0;Kt<Te.geometry.geometries.length;Kt++)qr(qe,{id:nt,geometry:Te.geometry.geometries[Kt],properties:Te.properties},Me,We);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Kt=0;Kt<Xe.length;Kt++){var Dn=[];cs(Xe[Kt],Dn,Gt,!0),Rt.push(Dn)}}qe.push(Mn(nt,xt,Rt,Te.properties))}}function no(qe,Te){Te.push(cn(qe[0])),Te.push(Ot(qe[1])),Te.push(0)}function dr(qe,Te,Me,We){for(var Xe,xt,Gt=0,Rt=0;Rt<qe.length;Rt++){var nt=cn(qe[Rt][0]),Kt=Ot(qe[Rt][1]);Te.push(nt),Te.push(Kt),Te.push(0),Rt>0&&(Gt+=We?(Xe*Kt-nt*xt)/2:Math.sqrt(Math.pow(nt-Xe,2)+Math.pow(Kt-xt,2))),Xe=nt,xt=Kt}var Dn=Te.length-3;Te[2]=1,Zr(Te,0,Dn,Me),Te[Dn+2]=1,Te.size=Math.abs(Gt),Te.start=0,Te.end=Te.size}function cs(qe,Te,Me,We){for(var Xe=0;Xe<qe.length;Xe++){var xt=[];dr(qe[Xe],xt,Me,We),Te.push(xt)}}function cn(qe){return qe/360+.5}function Ot(qe){var Te=Math.sin(qe*Math.PI/180),Me=.5-.25*Math.log((1+Te)/(1-Te))/Math.PI;return Me<0?0:Me>1?1:Me}function Dt(qe,Te,Me,We,Xe,xt,Gt,Rt){if(We/=Te,xt>=(Me/=Te)&&Gt<We)return qe;if(Gt<Me||xt>=We)return null;for(var nt=[],Kt=0;Kt<qe.length;Kt++){var Dn=qe[Kt],xe=Dn.geometry,Se=Dn.type,Be=0===Xe?Dn.minX:Dn.minY,dt=0===Xe?Dn.maxX:Dn.maxY;if(Be>=Me&&dt<We)nt.push(Dn);else if(!(dt<Me||Be>=We)){var Pt=[];if("Point"===Se||"MultiPoint"===Se)Nn(xe,Pt,Me,We,Xe);else if("LineString"===Se)nn(xe,Pt,Me,We,Xe,!1,Rt.lineMetrics);else if("MultiLineString"===Se)pi(xe,Pt,Me,We,Xe,!1);else if("Polygon"===Se)pi(xe,Pt,Me,We,Xe,!0);else if("MultiPolygon"===Se)for(var rn=0;rn<xe.length;rn++){var un=[];pi(xe[rn],un,Me,We,Xe,!0),un.length&&Pt.push(un)}if(Pt.length){if(Rt.lineMetrics&&"LineString"===Se){for(rn=0;rn<Pt.length;rn++)nt.push(Mn(Dn.id,Se,Pt[rn],Dn.tags));continue}"LineString"!==Se&&"MultiLineString"!==Se||(1===Pt.length?(Se="LineString",Pt=Pt[0]):Se="MultiLineString"),"Point"!==Se&&"MultiPoint"!==Se||(Se=3===Pt.length?"Point":"MultiPoint"),nt.push(Mn(Dn.id,Se,Pt,Dn.tags))}}}return nt.length?nt:null}function Nn(qe,Te,Me,We,Xe){for(var xt=0;xt<qe.length;xt+=3){var Gt=qe[xt+Xe];Gt>=Me&&Gt<=We&&(Te.push(qe[xt]),Te.push(qe[xt+1]),Te.push(qe[xt+2]))}}function nn(qe,Te,Me,We,Xe,xt,Gt){for(var Rt,nt,Kt=jn(qe),Dn=0===Xe?Li:$r,xe=qe.start,Se=0;Se<qe.length-3;Se+=3){var Be=qe[Se],dt=qe[Se+1],Pt=qe[Se+2],rn=qe[Se+3],un=qe[Se+4],In=0===Xe?Be:dt,Pn=0===Xe?rn:un,mi=!1;Gt&&(Rt=Math.sqrt(Math.pow(Be-rn,2)+Math.pow(dt-un,2))),In<Me?Pn>Me&&(nt=Dn(Kt,Be,dt,rn,un,Me),Gt&&(Kt.start=xe+Rt*nt)):In>We?Pn<We&&(nt=Dn(Kt,Be,dt,rn,un,We),Gt&&(Kt.start=xe+Rt*nt)):to(Kt,Be,dt,Pt),Pn<Me&&In>=Me&&(nt=Dn(Kt,Be,dt,rn,un,Me),mi=!0),Pn>We&&In<=We&&(nt=Dn(Kt,Be,dt,rn,un,We),mi=!0),!xt&&mi&&(Gt&&(Kt.end=xe+Rt*nt),Te.push(Kt),Kt=jn(qe)),Gt&&(xe+=Rt)}var Xn=qe.length-3;Be=qe[Xn],dt=qe[Xn+1],Pt=qe[Xn+2],(In=0===Xe?Be:dt)>=Me&&In<=We&&to(Kt,Be,dt,Pt),Xn=Kt.length-3,xt&&Xn>=3&&(Kt[Xn]!==Kt[0]||Kt[Xn+1]!==Kt[1])&&to(Kt,Kt[0],Kt[1],Kt[2]),Kt.length&&Te.push(Kt)}function jn(qe){var Te=[];return Te.size=qe.size,Te.start=qe.start,Te.end=qe.end,Te}function pi(qe,Te,Me,We,Xe,xt){for(var Gt=0;Gt<qe.length;Gt++)nn(qe[Gt],Te,Me,We,Xe,xt,!1)}function to(qe,Te,Me,We){qe.push(Te),qe.push(Me),qe.push(We)}function Li(qe,Te,Me,We,Xe,xt){var Gt=(xt-Te)/(We-Te);return qe.push(xt),qe.push(Me+(Xe-Me)*Gt),qe.push(1),Gt}function $r(qe,Te,Me,We,Xe,xt){var Gt=(xt-Me)/(Xe-Me);return qe.push(Te+(We-Te)*Gt),qe.push(xt),qe.push(1),Gt}function Vr(qe,Te){for(var Me=[],We=0;We<qe.length;We++){var Xe,xt=qe[We],Gt=xt.type;if("Point"===Gt||"MultiPoint"===Gt||"LineString"===Gt)Xe=fo(xt.geometry,Te);else if("MultiLineString"===Gt||"Polygon"===Gt){Xe=[];for(var Rt=0;Rt<xt.geometry.length;Rt++)Xe.push(fo(xt.geometry[Rt],Te))}else if("MultiPolygon"===Gt)for(Xe=[],Rt=0;Rt<xt.geometry.length;Rt++){for(var nt=[],Kt=0;Kt<xt.geometry[Rt].length;Kt++)nt.push(fo(xt.geometry[Rt][Kt],Te));Xe.push(nt)}Me.push(Mn(xt.id,Gt,Xe,xt.tags))}return Me}function fo(qe,Te){var Me=[];Me.size=qe.size,void 0!==qe.start&&(Me.start=qe.start,Me.end=qe.end);for(var We=0;We<qe.length;We+=3)Me.push(qe[We]+Te,qe[We+1],qe[We+2]);return Me}function vo(qe,Te){if(qe.transformed)return qe;var Me,We,Xe,xt=1<<qe.z,Gt=qe.x,Rt=qe.y;for(Me=0;Me<qe.features.length;Me++){var nt=qe.features[Me],Kt=nt.geometry,Dn=nt.type;if(nt.geometry=[],1===Dn)for(We=0;We<Kt.length;We+=2)nt.geometry.push(ei(Kt[We],Kt[We+1],Te,xt,Gt,Rt));else for(We=0;We<Kt.length;We++){var xe=[];for(Xe=0;Xe<Kt[We].length;Xe+=2)xe.push(ei(Kt[We][Xe],Kt[We][Xe+1],Te,xt,Gt,Rt));nt.geometry.push(xe)}}return qe.transformed=!0,qe}function ei(qe,Te,Me,We,Xe,xt){return[Math.round(Me*(qe*We-Xe)),Math.round(Me*(Te*We-xt))]}function fr(qe,Te,Me,We,Xe){for(var xt=Te===Xe.maxZoom?0:Xe.tolerance/((1<<Te)*Xe.extent),Gt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:Me,y:We,z:Te,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Rt=0;Rt<qe.length;Rt++){Gt.numFeatures++,sr(Gt,qe[Rt],xt,Xe);var nt=qe[Rt].minX,Kt=qe[Rt].minY,Dn=qe[Rt].maxX,xe=qe[Rt].maxY;nt<Gt.minX&&(Gt.minX=nt),Kt<Gt.minY&&(Gt.minY=Kt),Dn>Gt.maxX&&(Gt.maxX=Dn),xe>Gt.maxY&&(Gt.maxY=xe)}return Gt}function sr(qe,Te,Me,We){var Xe=Te.geometry,xt=Te.type,Gt=[];if("Point"===xt||"MultiPoint"===xt)for(var Rt=0;Rt<Xe.length;Rt+=3)Gt.push(Xe[Rt]),Gt.push(Xe[Rt+1]),qe.numPoints++,qe.numSimplified++;else if("LineString"===xt)Io(Gt,Xe,qe,Me,!1,!1);else if("MultiLineString"===xt||"Polygon"===xt)for(Rt=0;Rt<Xe.length;Rt++)Io(Gt,Xe[Rt],qe,Me,"Polygon"===xt,0===Rt);else if("MultiPolygon"===xt)for(var nt=0;nt<Xe.length;nt++){var Kt=Xe[nt];for(Rt=0;Rt<Kt.length;Rt++)Io(Gt,Kt[Rt],qe,Me,!0,0===Rt)}if(Gt.length){var Dn=Te.tags||null;if("LineString"===xt&&We.lineMetrics){for(var xe in Dn={},Te.tags)Dn[xe]=Te.tags[xe];Dn.mapbox_clip_start=Xe.start/Xe.size,Dn.mapbox_clip_end=Xe.end/Xe.size}var Se={geometry:Gt,type:"Polygon"===xt||"MultiPolygon"===xt?3:"LineString"===xt||"MultiLineString"===xt?2:1,tags:Dn};null!==Te.id&&(Se.id=Te.id),qe.features.push(Se)}}function Io(qe,Te,Me,We,Xe,xt){var Gt=We*We;if(We>0&&Te.size<(Xe?Gt:We))Me.numPoints+=Te.length/3;else{for(var Rt=[],nt=0;nt<Te.length;nt+=3)(0===We||Te[nt+2]>Gt)&&(Me.numSimplified++,Rt.push(Te[nt]),Rt.push(Te[nt+1])),Me.numPoints++;Xe&&function(Kt,Dn){for(var xe=0,Se=0,Be=Kt.length,dt=Be-2;Se<Be;dt=Se,Se+=2)xe+=(Kt[Se]-Kt[dt])*(Kt[Se+1]+Kt[dt+1]);if(xe>0===Dn)for(Se=0,Be=Kt.length;Se<Be/2;Se+=2){var Pt=Kt[Se],rn=Kt[Se+1];Kt[Se]=Kt[Be-2-Se],Kt[Se+1]=Kt[Be-1-Se],Kt[Be-2-Se]=Pt,Kt[Be-1-Se]=rn}}(Rt,xt),qe.push(Rt)}}function ir(qe,Te){var Me=(Te=this.options=function(Xe,xt){for(var Gt in xt)Xe[Gt]=xt[Gt];return Xe}(Object.create(this.options),Te)).debug;if(Me&&console.time("preprocess data"),Te.maxZoom<0||Te.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Te.promoteId&&Te.generateId)throw new Error("promoteId and generateId cannot be used together.");var Xe,xt,Gt,Rt,nt,Kt,We=function(Xe,xt){var Gt=[];if("FeatureCollection"===Xe.type)for(var Rt=0;Rt<Xe.features.length;Rt++)qr(Gt,Xe.features[Rt],xt,Rt);else qr(Gt,"Feature"===Xe.type?Xe:{geometry:Xe},xt);return Gt}(qe,Te);this.tiles={},this.tileCoords=[],Me&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Te.indexMaxZoom,Te.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(Xe=We,xt=Te,Gt=xt.buffer/xt.extent,Rt=Xe,nt=Dt(Xe,1,-1-Gt,Gt,0,-1,2,xt),Kt=Dt(Xe,1,1-Gt,2+Gt,0,-1,2,xt),(nt||Kt)&&(Rt=Dt(Xe,1,-Gt,1+Gt,0,-1,2,xt)||[],nt&&(Rt=Vr(nt,1).concat(Rt)),Kt&&(Rt=Rt.concat(Vr(Kt,-1)))),We=Rt).length&&this.splitTile(We,0,0,0),Me&&(We.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Ao(qe,Te,Me){return 32*((1<<qe)*Me+Te)+qe}function Zo(qe,Te){const Me=qe.tileID.canonical;if(!this._geoJSONIndex)return Te(null,null);const We=this._geoJSONIndex.getTile(Me.z,Me.x,Me.y);if(!We)return Te(null,null);const Xe=new st(We.features);let xt=dn(Xe);0===xt.byteOffset&&xt.byteLength===xt.buffer.byteLength||(xt=new Uint8Array(xt)),Te(null,{vectorTile:Xe,rawData:xt.buffer})}ir.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ir.prototype.splitTile=function(qe,Te,Me,We,Xe,xt,Gt){for(var Rt=[qe,Te,Me,We],nt=this.options,Kt=nt.debug;Rt.length;){We=Rt.pop(),Me=Rt.pop(),Te=Rt.pop(),qe=Rt.pop();var Dn=1<<Te,xe=Ao(Te,Me,We),Se=this.tiles[xe];if(!Se&&(Kt>1&&console.time("creation"),Se=this.tiles[xe]=fr(qe,Te,Me,We,nt),this.tileCoords.push({z:Te,x:Me,y:We}),Kt)){Kt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Te,Me,We,Se.numFeatures,Se.numPoints,Se.numSimplified),console.timeEnd("creation"));var Be="z"+Te;this.stats[Be]=(this.stats[Be]||0)+1,this.total++}if(Se.source=qe,Xe){if(Te===nt.maxZoom||Te===Xe)continue;var dt=1<<Xe-Te;if(Me!==Math.floor(xt/dt)||We!==Math.floor(Gt/dt))continue}else if(Te===nt.indexMaxZoom||Se.numPoints<=nt.indexMaxPoints)continue;if(Se.source=null,0!==qe.length){Kt>1&&console.time("clipping");var Pt,rn,un,In,Pn,mi,Xn=.5*nt.buffer/nt.extent,qt=.5-Xn,Gr=.5+Xn,gr=1+Xn;Pt=rn=un=In=null,Pn=Dt(qe,Dn,Me-Xn,Me+Gr,0,Se.minX,Se.maxX,nt),mi=Dt(qe,Dn,Me+qt,Me+gr,0,Se.minX,Se.maxX,nt),qe=null,Pn&&(Pt=Dt(Pn,Dn,We-Xn,We+Gr,1,Se.minY,Se.maxY,nt),rn=Dt(Pn,Dn,We+qt,We+gr,1,Se.minY,Se.maxY,nt),Pn=null),mi&&(un=Dt(mi,Dn,We-Xn,We+Gr,1,Se.minY,Se.maxY,nt),In=Dt(mi,Dn,We+qt,We+gr,1,Se.minY,Se.maxY,nt),mi=null),Kt>1&&console.timeEnd("clipping"),Rt.push(Pt||[],Te+1,2*Me,2*We),Rt.push(rn||[],Te+1,2*Me,2*We+1),Rt.push(un||[],Te+1,2*Me+1,2*We),Rt.push(In||[],Te+1,2*Me+1,2*We+1)}}},ir.prototype.getTile=function(qe,Te,Me){var We=this.options,Xe=We.extent,xt=We.debug;if(qe<0||qe>24)return null;var Gt=1<<qe,Rt=Ao(qe,Te=(Te%Gt+Gt)%Gt,Me);if(this.tiles[Rt])return vo(this.tiles[Rt],Xe);xt>1&&console.log("drilling down to z%d-%d-%d",qe,Te,Me);for(var nt,Kt=qe,Dn=Te,xe=Me;!nt&&Kt>0;)Kt--,Dn=Math.floor(Dn/2),xe=Math.floor(xe/2),nt=this.tiles[Ao(Kt,Dn,xe)];return nt&&nt.source?(xt>1&&console.log("found parent tile z%d-%d-%d",Kt,Dn,xe),xt>1&&console.time("drilling down"),this.splitTile(nt.source,Kt,Dn,xe,qe,Te,Me),xt>1&&console.timeEnd("drilling down"),this.tiles[Rt]?vo(this.tiles[Rt],Xe):null):null};class To extends l.VectorTileWorkerSource{constructor(Te,Me,We,Xe,xt){super(Te,Me,We,Xe,Zo),xt&&(this.loadGeoJSON=xt)}loadData(Te,Me){const We=Te&&Te.request,Xe=We&&We.collectResourceTiming;this.loadGeoJSON(Te,(xt,Gt)=>{if(xt||!Gt)return Me(xt);if("object"!=typeof Gt)return Me(new Error(`Input data given to '${Te.source}' is not a valid GeoJSON object.`));{ct(Gt,!0);try{if(Te.filter){const nt=l.createExpression(Te.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===nt.result)throw new Error(nt.value.map(Dn=>`${Dn.key}: ${Dn.message}`).join(", "));const Kt=Gt.features.filter(Dn=>nt.value.evaluate({zoom:0},Dn));Gt={type:"FeatureCollection",features:Kt}}this._geoJSONIndex=Te.cluster?new ui(function({superclusterOptions:nt,clusterProperties:Kt}){if(!Kt||!nt)return nt;const Dn={},xe={},Se={accumulated:null,zoom:0},Be={properties:null},dt=Object.keys(Kt);for(const Pt of dt){const[rn,un]=Kt[Pt],In=l.createExpression(un),Pn=l.createExpression("string"==typeof rn?[rn,["accumulated"],["get",Pt]]:rn);Dn[Pt]=In.value,xe[Pt]=Pn.value}return nt.map=Pt=>{Be.properties=Pt;const rn={};for(const un of dt)rn[un]=Dn[un].evaluate(Se,Be);return rn},nt.reduce=(Pt,rn)=>{Be.properties=rn;for(const un of dt)Se.accumulated=Pt[un],Pt[un]=xe[un].evaluate(Se,Be)},nt}(Te)).load(Gt.features):new ir(nt=Gt,Te.geojsonVtOptions)}catch(nt){return Me(nt)}this.loaded={};const Rt={};if(Xe){const nt=l.getPerformanceMeasurement(We);nt&&(Rt.resourceTiming={},Rt.resourceTiming[Te.source]=JSON.parse(JSON.stringify(nt)))}Me(null,Rt)}var nt})}reloadTile(Te,Me){const We=this.loaded;return We&&We[Te.uid]?super.reloadTile(Te,Me):this.loadTile(Te,Me)}loadGeoJSON(Te,Me){if(Te.request)l.getJSON(Te.request,Me);else{if("string"!=typeof Te.data)return Me(new Error(`Input data given to '${Te.source}' is not a valid GeoJSON object.`));try{return Me(null,JSON.parse(Te.data))}catch(We){return Me(new Error(`Input data given to '${Te.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(Te,Me){try{Me(null,this._geoJSONIndex.getClusterExpansionZoom(Te.clusterId))}catch(We){Me(We)}}getClusterChildren(Te,Me){try{Me(null,this._geoJSONIndex.getChildren(Te.clusterId))}catch(We){Me(We)}}getClusterLeaves(Te,Me){try{Me(null,this._geoJSONIndex.getLeaves(Te.clusterId,Te.limit,Te.offset))}catch(We){Me(We)}}}class Ds{constructor(Te){this.self=Te,this.actor=new l.Actor(Te,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=l.getProjection({name:"mercator"}),this.workerSourceTypes={vector:l.VectorTileWorkerSource,geojson:To},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(Me,We)=>{if(this.workerSourceTypes[Me])throw new Error(`Worker source with name "${Me}" already registered.`);this.workerSourceTypes[Me]=We},this.self.registerRTLTextPlugin=Me=>{if(l.plugin.isParsed())throw new Error("RTL text plugin already registered.");l.plugin.applyArabicShaping=Me.applyArabicShaping,l.plugin.processBidirectionalText=Me.processBidirectionalText,l.plugin.processStyledBidirectionalText=Me.processStyledBidirectionalText}}clearCaches(Te,Me,We){delete this.layerIndexes[Te],delete this.availableImages[Te],delete this.workerSources[Te],delete this.demWorkerSources[Te],We()}checkIfReady(Te,Me,We){We()}setReferrer(Te,Me){this.referrer=Me}spriteLoaded(Te,Me){this.isSpriteLoaded[Te]=Me;for(const We in this.workerSources[Te]){const Xe=this.workerSources[Te][We];for(const xt in Xe)Xe[xt]instanceof l.VectorTileWorkerSource&&(Xe[xt].isSpriteLoaded=Me,Xe[xt].fire(new l.Event("isSpriteLoaded")))}}setImages(Te,Me,We){this.availableImages[Te]=Me;for(const Xe in this.workerSources[Te]){const xt=this.workerSources[Te][Xe];for(const Gt in xt)xt[Gt].availableImages=Me}We()}enableTerrain(Te,Me,We){this.terrain=Me,We()}setProjection(Te,Me){this.projections[Te]=l.getProjection(Me)}setLayers(Te,Me,We){this.getLayerIndex(Te).replace(Me),We()}updateLayers(Te,Me,We){this.getLayerIndex(Te).update(Me.layers,Me.removedIds),We()}loadTile(Te,Me,We){const Xe=this.enableTerrain?l.extend({enableTerrain:this.terrain},Me):Me;Xe.projection=this.projections[Te]||this.defaultProjection,this.getWorkerSource(Te,Me.type,Me.source).loadTile(Xe,We)}loadDEMTile(Te,Me,We){const Xe=this.enableTerrain?l.extend({buildQuadTree:this.terrain},Me):Me;this.getDEMWorkerSource(Te,Me.source).loadTile(Xe,We)}reloadTile(Te,Me,We){const Xe=this.enableTerrain?l.extend({enableTerrain:this.terrain},Me):Me;Xe.projection=this.projections[Te]||this.defaultProjection,this.getWorkerSource(Te,Me.type,Me.source).reloadTile(Xe,We)}abortTile(Te,Me,We){this.getWorkerSource(Te,Me.type,Me.source).abortTile(Me,We)}removeTile(Te,Me,We){this.getWorkerSource(Te,Me.type,Me.source).removeTile(Me,We)}removeSource(Te,Me,We){if(!this.workerSources[Te]||!this.workerSources[Te][Me.type]||!this.workerSources[Te][Me.type][Me.source])return;const Xe=this.workerSources[Te][Me.type][Me.source];delete this.workerSources[Te][Me.type][Me.source],void 0!==Xe.removeSource?Xe.removeSource(Me,We):We()}loadWorkerSource(Te,Me,We){try{this.self.importScripts(Me.url),We()}catch(Xe){We(Xe.toString())}}syncRTLPluginState(Te,Me,We){try{l.plugin.setState(Me);const Xe=l.plugin.getPluginURL();if(l.plugin.isLoaded()&&!l.plugin.isParsed()&&null!=Xe){this.self.importScripts(Xe);const xt=l.plugin.isParsed();We(xt?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Xe}`),xt)}}catch(Xe){We(Xe.toString())}}getAvailableImages(Te){let Me=this.availableImages[Te];return Me||(Me=[]),Me}getLayerIndex(Te){let Me=this.layerIndexes[Te];return Me||(Me=this.layerIndexes[Te]=new At),Me}getWorkerSource(Te,Me,We){return this.workerSources[Te]||(this.workerSources[Te]={}),this.workerSources[Te][Me]||(this.workerSources[Te][Me]={}),this.workerSources[Te][Me][We]||(this.workerSources[Te][Me][We]=new this.workerSourceTypes[Me]({send:(Xe,xt,Gt,Rt,nt,Kt)=>{this.actor.send(Xe,xt,Gt,Te,nt,Kt)},scheduler:this.actor.scheduler},this.getLayerIndex(Te),this.getAvailableImages(Te),this.isSpriteLoaded[Te])),this.workerSources[Te][Me][We]}getDEMWorkerSource(Te,Me){return this.demWorkerSources[Te]||(this.demWorkerSources[Te]={}),this.demWorkerSources[Te][Me]||(this.demWorkerSources[Te][Me]=new Ke),this.demWorkerSources[Te][Me]}enforceCacheSizeLimit(Te,Me){l.enforceCacheSizeLimit(Me)}getWorkerPerformanceMetrics(Te,Me,We){We(void 0,void 0)}}return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new Ds(self)),Ds}),N(0,function(l){function oe(d,i){if(Array.isArray(d)){if(!Array.isArray(i)||d.length!==i.length)return!1;for(let u=0;u<d.length;u++)if(!oe(d[u],i[u]))return!1;return!0}if("object"==typeof d&&null!==d&&null!==i){if("object"!=typeof i||Object.keys(d).length!==Object.keys(i).length)return!1;for(const u in d)if(!oe(d[u],i[u]))return!1;return!0}return d===i}var lt=At;function At(d){return i=d,!("undefined"==typeof window||"undefined"==typeof document||!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)||!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions)||!("JSON"in window&&"parse"in JSON&&"stringify"in JSON)||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var m,E,M=new Blob([""],{type:"text/javascript"}),z=URL.createObjectURL(M);try{E=new Worker(z),m=!0}catch(Z){m=!1}return E&&E.terminate(),URL.revokeObjectURL(z),m}()||!("Uint8ClampedArray"in window)||!ArrayBuffer.isView||!function(){var m=document.createElement("canvas");m.width=m.height=1;var E=m.getContext("2d");if(!E)return!1;var M=E.getImageData(0,0,1,1);return M&&M.width===m.width}()||(void 0===Ke[u=i&&i.failIfMajorPerformanceCaveat]&&(Ke[u]=function(m){var E,z,Z,K,M=(z=m,Z=document.createElement("canvas"),(K=Object.create(At.webGLContextAttributes)).failIfMajorPerformanceCaveat=z,Z.getContext("webgl",K)||Z.getContext("experimental-webgl",K));if(!M)return!1;try{E=M.createShader(M.VERTEX_SHADER)}catch(z){return!1}return!(!E||M.isContextLost())&&(M.shaderSource(E,"void main() {}"),M.compileShader(E),!0===M.getShaderParameter(E,M.COMPILE_STATUS))}(u)),!Ke[u]||document.documentMode));var i,u}var Ke={};function ct(d,i,u){const m=l.window.document.createElement(d);return void 0!==i&&(m.className=i),u&&u.appendChild(m),m}function _t(d,i,u){const m=l.window.document.createElementNS("http://www.w3.org/2000/svg",d);for(const E of Object.keys(i))m.setAttributeNS(null,E,i[E]);return u&&u.appendChild(m),m}At.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const Nt=l.window.document&&l.window.document.documentElement.style,wt=Nt&&void 0!==Nt.userSelect?"userSelect":"WebkitUserSelect";let Bt;function st(){Nt&&wt&&(Bt=Nt[wt],Nt[wt]="none")}function at(){Nt&&wt&&(Nt[wt]=Bt)}function ft(d){d.preventDefault(),d.stopPropagation(),l.window.removeEventListener("click",ft,!0)}function tn(){l.window.addEventListener("click",ft,!0),l.window.setTimeout(()=>{l.window.removeEventListener("click",ft,!0)},0)}function kt(d,i){const u=d.getBoundingClientRect();return on(d,u,i)}function dn(d,i){const u=d.getBoundingClientRect(),m=[];for(let E=0;E<i.length;E++)m.push(on(d,u,i[E]));return m}function Qn(d){return void 0!==l.window.InstallTrigger&&2===d.button&&d.ctrlKey&&l.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:d.button}function on(d,i,u){const m=d.offsetWidth===i.width?1:d.offsetWidth/i.width;return new l.pointGeometry((u.clientX-i.left)*m,(u.clientY-i.top)*m)}function Cn(d,i){var u=i[0],m=i[1],E=i[2],M=i[3],z=u*M-E*m;return z?(d[0]=M*(z=1/z),d[1]=-m*z,d[2]=-E*z,d[3]=u*z,d):null}function se(d){const{userImage:i}=d;return!!(i&&i.render&&i.render())&&(d.data.replace(new Uint8Array(i.data.buffer)),!0)}class Wi extends l.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new l.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(i){if(this.loaded!==i&&(this.loaded=i,i)){for(const{ids:u,callback:m}of this.requestors)this._notify(u,m);this.requestors=[]}}hasImage(i){return!!this.getImage(i)}getImage(i){return this.images[i]}addImage(i,u){this._validate(i,u)&&(this.images[i]=u)}_validate(i,u){let m=!0;return this._validateStretch(u.stretchX,u.data&&u.data.width)||(this.fire(new l.ErrorEvent(new Error(`Image "${i}" has invalid "stretchX" value`))),m=!1),this._validateStretch(u.stretchY,u.data&&u.data.height)||(this.fire(new l.ErrorEvent(new Error(`Image "${i}" has invalid "stretchY" value`))),m=!1),this._validateContent(u.content,u)||(this.fire(new l.ErrorEvent(new Error(`Image "${i}" has invalid "content" value`))),m=!1),m}_validateStretch(i,u){if(!i)return!0;let m=0;for(const E of i){if(E[0]<m||E[1]<E[0]||u<E[1])return!1;m=E[1]}return!0}_validateContent(i,u){return!(i&&(4!==i.length||i[0]<0||u.data.width<i[0]||i[1]<0||u.data.height<i[1]||i[2]<0||u.data.width<i[2]||i[3]<0||u.data.height<i[3]||i[2]<i[0]||i[3]<i[1]))}updateImage(i,u){u.version=this.images[i].version+1,this.images[i]=u,this.updatedImages[i]=!0}removeImage(i){const u=this.images[i];delete this.images[i],delete this.patterns[i],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(i,u){let m=!0;if(!this.isLoaded())for(const E of i)this.images[E]||(m=!1);this.isLoaded()||m?this._notify(i,u):this.requestors.push({ids:i,callback:u})}_notify(i,u){const m={};for(const E of i){this.images[E]||this.fire(new l.Event("styleimagemissing",{id:E}));const M=this.images[E];M?m[E]={data:M.data.clone(),pixelRatio:M.pixelRatio,sdf:M.sdf,version:M.version,stretchX:M.stretchX,stretchY:M.stretchY,content:M.content,hasRenderCallback:Boolean(M.userImage&&M.userImage.render)}:l.warnOnce(`Image "${E}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}u(null,m)}getPixelSize(){const{width:i,height:u}=this.atlasImage;return{width:i,height:u}}getPattern(i){const u=this.patterns[i],m=this.getImage(i);if(!m)return null;if(u&&u.position.version===m.version)return u.position;if(u)u.position.version=m.version;else{const E={w:m.data.width+2,h:m.data.height+2,x:0,y:0},M=new l.ImagePosition(E,m);this.patterns[i]={bin:E,position:M}}return this._updatePatternAtlas(),this.patterns[i].position}bind(i){const u=i.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new l.Texture(i,this.atlasImage,u.RGBA),this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)}_updatePatternAtlas(){const i=[];for(const M in this.patterns)i.push(this.patterns[M].bin);const{w:u,h:m}=l.potpack(i),E=this.atlasImage;E.resize({width:u||1,height:m||1});for(const M in this.patterns){const{bin:z}=this.patterns[M],Z=z.x+1,K=z.y+1,de=this.images[M].data,pe=de.width,De=de.height;l.RGBAImage.copy(de,E,{x:0,y:0},{x:Z,y:K},{width:pe,height:De}),l.RGBAImage.copy(de,E,{x:0,y:De-1},{x:Z,y:K-1},{width:pe,height:1}),l.RGBAImage.copy(de,E,{x:0,y:0},{x:Z,y:K+De},{width:pe,height:1}),l.RGBAImage.copy(de,E,{x:pe-1,y:0},{x:Z-1,y:K},{width:1,height:De}),l.RGBAImage.copy(de,E,{x:0,y:0},{x:Z+pe,y:K},{width:1,height:De})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(i){for(const u of i){if(this.callbackDispatchedThisFrame[u])continue;this.callbackDispatchedThisFrame[u]=!0;const m=this.images[u];se(m)&&this.updateImage(u,m)}}}const ii=new l.Properties({anchor:new l.DataConstantProperty(l.spec.light.anchor),position:new class{constructor(){this.specification=l.spec.light.position}possiblyEvaluate(d,i){return function([u,m,E]){const M=l.degToRad(m+90),z=l.degToRad(E);return{x:u*Math.cos(M)*Math.sin(z),y:u*Math.sin(M)*Math.sin(z),z:u*Math.cos(z),azimuthal:m,polar:E}}(d.expression.evaluate(i))}interpolate(d,i,u){return{x:l.number(d.x,i.x,u),y:l.number(d.y,i.y,u),z:l.number(d.z,i.z,u),azimuthal:l.number(d.azimuthal,i.azimuthal,u),polar:l.number(d.polar,i.polar,u)}}},color:new l.DataConstantProperty(l.spec.light.color),intensity:new l.DataConstantProperty(l.spec.light.intensity)}),kn="-transition";class Ci extends l.Evented{constructor(i){super(),this._transitionable=new l.Transitionable(ii),this.setLight(i),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(i,u={}){if(!this._validate(l.validateLight,i,u))for(const m in i){const E=i[m];l.endsWith(m,kn)?this._transitionable.setTransition(m.slice(0,-kn.length),E):this._transitionable.setValue(m,E)}}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,u,m){return(!m||!1!==m.validate)&&l.emitValidationErrors(this,i.call(l.validateStyle,l.extend({value:u,style:{glyphs:!0,sprite:!0},styleSpec:l.spec})))}}const Jt=new l.Properties({source:new l.DataConstantProperty(l.spec.terrain.source),exaggeration:new l.DataConstantProperty(l.spec.terrain.exaggeration)}),$t="-transition";class en extends l.Evented{constructor(i,u){super(),this._transitionable=new l.Transitionable(Jt),this.set(i),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=u}get(){return this._transitionable.serialize()}set(i){for(const u in i){const m=i[u];l.endsWith(u,$t)?this._transitionable.setTransition(u.slice(0,-$t.length),m):this._transitionable.setValue(u,m)}}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}}function an(d,i,u,m){const E=l.smoothstep(45,65,u),[M,z]=Yt(d,m),Z=l.length(i);let K=1-Math.min(1,Math.exp((Z-M)/(z-M)*-6));return K*=K*K,K=Math.min(1,1.00747*K),K*E*d.alpha}function Yt(d,i){const u=.5/Math.tan(.5*i);return[d.range[0]+u,d.range[1]+u]}const An=new l.Properties({range:new l.DataConstantProperty(l.spec.fog.range),color:new l.DataConstantProperty(l.spec.fog.color),"high-color":new l.DataConstantProperty(l.spec.fog["high-color"]),"space-color":new l.DataConstantProperty(l.spec.fog["space-color"]),"horizon-blend":new l.DataConstantProperty(l.spec.fog["horizon-blend"]),"star-intensity":new l.DataConstantProperty(l.spec.fog["star-intensity"])}),Sn="-transition";class Mi extends l.Evented{constructor(i,u){super(),this._transitionable=new l.Transitionable(An),this.set(i),this._transitioning=this._transitionable.untransitioned(),this._transform=u}get state(){const i=this._transform,u="globe"===i.projection.name,m=l.globeToMercatorTransition(i.zoom),E=this.properties.get("range"),M=[.5,3];return{range:u?[l.number(M[0],E[0],m),l.number(M[1],E[1],m)]:E,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(i,u={}){if(!this._validate(l.validateFog,i,u)){for(const m of Object.keys(l.spec.fog))i&&void 0===i[m]&&(i[m]=l.spec.fog[m].default);for(const m in i){const E=i[m];l.endsWith(m,Sn)?this._transitionable.setTransition(m.slice(0,-Sn.length),E):this._transitionable.setValue(m,E)}}}getOpacity(i){if(!this._transform.projection.supportsFog)return 0;const u=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:l.smoothstep(45,65,i))*u.a}getOpacityAtLatLng(i,u){return this._transform.projection.supportsFog?function(m,E,M){const z=l.MercatorCoordinate.fromLngLat(E),Z=M.elevation?M.elevation.getAtPointOrZero(z):0,K=[z.x,z.y,Z];return l.transformMat4(K,K,M.mercatorFogMatrix),an(m,K,M.pitch,M._fov)}(this.state,i,u):0}getFovAdjustedRange(i){return this._transform.projection.supportsFog?Yt(this.state,i):[0,1]}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,u,m){return(!m||!1!==m.validate)&&l.emitValidationErrors(this,i.call(l.validateStyle,l.extend({value:u,style:{glyphs:!0,sprite:!0},styleSpec:l.spec})))}}class mr{constructor(i,u){this.workerPool=i,this.actors=[],this.currentActor=0,this.id=l.uniqueId();const m=this.workerPool.acquire(this.id);for(let E=0;E<m.length;E++){const M=new mr.Actor(m[E],u,this.id);M.name=`Worker ${E}`,this.actors.push(M)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(i,u,m){l.asyncAll(this.actors,(E,M)=>{E.send(i,u,M)},m=m||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(i=>{i.remove()}),this.actors=[],this.workerPool.release(this.id)}}function wi(d,i,u){return i*(l.EXTENT/(d.tileSize*Math.pow(2,u-d.tileID.overscaledZ)))}mr.Actor=l.Actor;class _i{constructor(i,u,m,E){this.screenBounds=i,this.cameraPoint=u,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=m,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,E)}static createFromScreenPoints(i,u){let m,E;if(i instanceof l.pointGeometry||"number"==typeof i[0]){const M=l.pointGeometry.convert(i);m=[l.pointGeometry.convert(i)],E=u.isPointAboveHorizon(M)}else{const M=l.pointGeometry.convert(i[0]),z=l.pointGeometry.convert(i[1]);m=[M,z],E=l.polygonizeBounds(M,z).every(Z=>u.isPointAboveHorizon(Z))}return new _i(m,u.getCameraPoint(),E,u)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(i){return l.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],i)}bufferedCameraGeometry(i){const u=this.screenBounds[0],m=1===this.screenBounds.length?this.screenBounds[0].add(new l.pointGeometry(1,1)):this.screenBounds[1],E=l.polygonizeBounds(u,m,0,!1);return this.cameraPoint.y>m.y&&(this.cameraPoint.x>u.x&&this.cameraPoint.x<m.x?E.splice(3,0,this.cameraPoint):this.cameraPoint.x>=m.x?E[2]=this.cameraPoint:this.cameraPoint.x<=u.x&&(E[3]=this.cameraPoint)),l.bufferConvexPolygon(E,i)}bufferedCameraGeometryGlobe(i){const u=this.screenBounds[0],m=1===this.screenBounds.length?this.screenBounds[0].add(new l.pointGeometry(1,1)):this.screenBounds[1],E=l.polygonizeBounds(u,m,i),M=this.cameraPoint.clone();switch(3*((M.y>u.y)+(M.y>m.y))+((M.x>u.x)+(M.x>m.x))){case 0:E[0]=M,E[4]=M.clone();break;case 1:E.splice(1,0,M);break;case 2:E[1]=M;break;case 3:E.splice(4,0,M);break;case 5:E.splice(2,0,M);break;case 6:E[3]=M;break;case 7:E.splice(3,0,M);break;case 8:E[2]=M}return E}containsTile(i,u,m,E=0){const M=i.queryPadding/u._pixelsPerMercatorPixel+1,z=m?this._bufferedCameraMercator(M,u):this._bufferedScreenMercator(M,u);let Z=i.tileID.wrap+(z.unwrapped?E:0);const K=z.polygon.map($e=>l.getTilePoint(i.tileTransform,$e,Z));if(!l.polygonIntersectsBox(K,0,0,l.EXTENT,l.EXTENT))return;Z=i.tileID.wrap+(this.screenGeometryMercator.unwrapped?E:0);const de=this.screenGeometryMercator.polygon.map($e=>l.getTileVec3(i.tileTransform,$e,Z)),pe=de.map($e=>new l.pointGeometry($e[0],$e[1])),De=u.getFreeCameraOptions().position||new l.MercatorCoordinate(0,0,0),Fe=l.getTileVec3(i.tileTransform,De,Z),Je=de.map($e=>{const ze=l.sub($e,$e,Fe);return l.normalize(ze,ze),new l.Ray(Fe,ze)}),Ge=wi(i,1,u.zoom)*u._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:pe,tilespaceRays:Je,bufferedTilespaceGeometry:K,bufferedTilespaceBounds:(He=l.getBounds(K),He.min.x=l.clamp(He.min.x,0,l.EXTENT),He.min.y=l.clamp(He.min.y,0,l.EXTENT),He.max.x=l.clamp(He.max.x,0,l.EXTENT),He.max.y=l.clamp(He.max.y,0,l.EXTENT),He),tile:i,tileID:i.tileID,pixelToTileUnitsFactor:Ge};var He}_bufferedScreenMercator(i,u){const m=Ti(i);if(this._screenRaycastCache[m])return this._screenRaycastCache[m];{let E;return E="globe"===u.projection.name?this._projectAndResample(this.bufferedScreenGeometry(i),u):{polygon:this.bufferedScreenGeometry(i).map(M=>u.pointCoordinate3D(M)),unwrapped:!0},this._screenRaycastCache[m]=E,E}}_bufferedCameraMercator(i,u){const m=Ti(i);if(this._cameraRaycastCache[m])return this._cameraRaycastCache[m];{let E;return E="globe"===u.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(i),u):{polygon:this.bufferedCameraGeometry(i).map(M=>u.pointCoordinate3D(M)),unwrapped:!0},this._cameraRaycastCache[m]=E,E}}_projectAndResample(i,u){const m=function(M,z){const Z=l.multiply([],z.pixelMatrix,z.globeMatrix),K=[0,-l.GLOBE_RADIUS,0,1],de=[0,l.GLOBE_RADIUS,0,1],pe=[0,0,0,1];l.transformMat4$1(K,K,Z),l.transformMat4$1(de,de,Z),l.transformMat4$1(pe,pe,Z);const De=new l.pointGeometry(K[0]/K[3],K[1]/K[3]),Fe=new l.pointGeometry(de[0]/de[3],de[1]/de[3]),Je=l.polygonContainsPoint(M,De)&&K[3]<pe[3],Ge=l.polygonContainsPoint(M,Fe)&&de[3]<pe[3];if(!Je&&!Ge)return null;const He=function(It,Ct,Vt){for(let sn=1;sn<It.length;sn++){const ni=ui(Ct.pointCoordinate3D(It[sn-1]).x),Xt=ui(Ct.pointCoordinate3D(It[sn]).x);if(Vt<0){if(ni<Xt)return{idx:sn,t:-ni/(Xt-1-ni)}}else if(Xt<ni)return{idx:sn,t:(1-ni)/(Xt+1-ni)}}return null}(M,z,Je?-1:1);if(!He)return null;const{idx:$e,t:ze}=He;let tt=$e>1?Ki(M.slice(0,$e),z):[],et=$e<M.length?Ki(M.slice($e),z):[];tt=tt.map(It=>new l.pointGeometry(ui(It.x),It.y)),et=et.map(It=>new l.pointGeometry(ui(It.x),It.y));const Mt=[...tt];0===Mt.length&&Mt.push(et[et.length-1]);const Et=l.number(Mt[Mt.length-1].y,(0===et.length?tt[0]:et[0]).y,ze);let yt;return yt=Je?[new l.pointGeometry(0,Et),new l.pointGeometry(0,0),new l.pointGeometry(1,0),new l.pointGeometry(1,Et)]:[new l.pointGeometry(1,Et),new l.pointGeometry(1,1),new l.pointGeometry(0,1),new l.pointGeometry(0,Et)],Mt.push(...yt),0===et.length?Mt.push(tt[0]):Mt.push(...et),{polygon:Mt.map(It=>new l.MercatorCoordinate(It.x,It.y)),unwrapped:!1}}(i,u);if(m)return m;const E=function(M,z){let Z=!1,K=-1/0,de=0;for(let De=0;De<M.length-1;De++)M[De].x>K&&(K=M[De].x,de=De);for(let De=0;De<M.length-1;De++){const Fe=(de+De)%(M.length-1),Je=M[Fe],Ge=M[Fe+1];Math.abs(Je.x-Ge.x)>.5&&(Je.x<Ge.x?(Je.x+=1,0===Fe&&(M[M.length-1].x+=1)):(Ge.x+=1,Fe+1===M.length-1&&(M[0].x+=1)),Z=!0)}const pe=l.mercatorXfromLng(z.center.lng);return Z&&pe<Math.abs(pe-1)&&M.forEach(De=>{De.x-=1}),{polygon:M,unwrapped:Z}}(Ki(i,u).map(M=>new l.pointGeometry(ui(M.x),M.y)),u);return{polygon:E.polygon.map(M=>new l.MercatorCoordinate(M.x,M.y)),unwrapped:E.unwrapped}}}function Ki(d,i){return l.resample(d,u=>{const m=i.pointCoordinate3D(u);u.x=m.x,u.y=m.y},1/256)}function ui(d){return d<0?1+d%1:d%1}function Ti(d){return 100*d|0}function Br(d,i,u,m,E){const M=function(z,Z){if(z)return E(z);if(Z){const K=l.pick(l.extend(Z,d),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);Z.vector_layers&&(K.vectorLayers=Z.vector_layers,K.vectorLayerIds=K.vectorLayers.map(de=>de.id)),Z.language_options&&(K.languageOptions=Z.language_options),Z.language&&Z.language[Z.id]&&(K.language=Z.language[Z.id]),Z.worldview_options&&(K.worldviewOptions=Z.worldview_options),Z.worldview?K.worldview=Z.worldview[Z.id]:Z.worldview_default&&(K.worldview=Z.worldview_default),K.tiles=i.canonicalizeTileset(K,d.url),E(null,K)}};return d.url?l.getJSON(i.transformRequest(i.normalizeSourceURL(d.url,null,u,m),l.ResourceType.Source),M):l.exported.frame(()=>M(null,d))}class yn{constructor(i,u,m){this.bounds=l.LngLatBounds.convert(this.validateBounds(i)),this.minzoom=u||0,this.maxzoom=m||24}validateBounds(i){return Array.isArray(i)&&4===i.length?[Math.max(-180,i[0]),Math.max(-90,i[1]),Math.min(180,i[2]),Math.min(90,i[3])]:[-180,-90,180,90]}contains(i){const u=Math.pow(2,i.z),m=Math.floor(l.mercatorXfromLng(this.bounds.getWest())*u),E=Math.floor(l.mercatorYfromLat(this.bounds.getNorth())*u),M=Math.ceil(l.mercatorXfromLng(this.bounds.getEast())*u),z=Math.ceil(l.mercatorYfromLat(this.bounds.getSouth())*u);return i.x>=m&&i.x<M&&i.y>=E&&i.y<z}}class oi{constructor(i,u,m){this.context=i;const E=i.gl;this.buffer=E.createBuffer(),this.dynamicDraw=Boolean(m),this.context.unbindVAO(),i.bindElementBuffer.set(this.buffer),E.bufferData(E.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?E.DYNAMIC_DRAW:E.STATIC_DRAW),this.dynamicDraw||u.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(i){const u=this.context.gl;this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,i.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Tt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class En{constructor(i,u,m,E){this.length=u.length,this.attributes=m,this.itemSize=u.bytesPerElement,this.dynamicDraw=E,this.context=i;const M=i.gl;this.buffer=M.createBuffer(),i.bindVertexBuffer.set(this.buffer),M.bufferData(M.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?M.DYNAMIC_DRAW:M.STATIC_DRAW),this.dynamicDraw||u.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(i){const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,i.arrayBuffer)}enableAttributes(i,u){for(let m=0;m<this.attributes.length;m++){const E=u.attributes[this.attributes[m].name];void 0!==E&&i.enableVertexAttribArray(E)}}setVertexAttribPointers(i,u,m){for(let E=0;E<this.attributes.length;E++){const M=this.attributes[E],z=u.attributes[M.name];void 0!==z&&i.vertexAttribPointer(z,M.components,i[Tt[M.type]],!1,this.itemSize,M.offset+this.itemSize*(m||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class si{constructor(i){this.gl=i.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(i){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class fi extends si{getDefault(){return l.Color.transparent}set(i){const u=this.current;(i.r!==u.r||i.g!==u.g||i.b!==u.b||i.a!==u.a||this.dirty)&&(this.gl.clearColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class nr extends si{getDefault(){return 1}set(i){(i!==this.current||this.dirty)&&(this.gl.clearDepth(i),this.current=i,this.dirty=!1)}}class Tr extends si{getDefault(){return 0}set(i){(i!==this.current||this.dirty)&&(this.gl.clearStencil(i),this.current=i,this.dirty=!1)}}class Zr extends si{getDefault(){return[!0,!0,!0,!0]}set(i){const u=this.current;(i[0]!==u[0]||i[1]!==u[1]||i[2]!==u[2]||i[3]!==u[3]||this.dirty)&&(this.gl.colorMask(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class Ur extends si{getDefault(){return!0}set(i){(i!==this.current||this.dirty)&&(this.gl.depthMask(i),this.current=i,this.dirty=!1)}}class Mn extends si{getDefault(){return 255}set(i){(i!==this.current||this.dirty)&&(this.gl.stencilMask(i),this.current=i,this.dirty=!1)}}class yo extends si{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(i){const u=this.current;(i.func!==u.func||i.ref!==u.ref||i.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(i.func,i.ref,i.mask),this.current=i,this.dirty=!1)}}class qr extends si{getDefault(){const i=this.gl;return[i.KEEP,i.KEEP,i.KEEP]}set(i){const u=this.current;(i[0]!==u[0]||i[1]!==u[1]||i[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(i[0],i[1],i[2]),this.current=i,this.dirty=!1)}}class no extends si{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;i?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=i,this.dirty=!1}}class dr extends si{getDefault(){return[0,1]}set(i){const u=this.current;(i[0]!==u[0]||i[1]!==u[1]||this.dirty)&&(this.gl.depthRange(i[0],i[1]),this.current=i,this.dirty=!1)}}class cs extends si{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;i?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=i,this.dirty=!1}}class cn extends si{getDefault(){return this.gl.LESS}set(i){(i!==this.current||this.dirty)&&(this.gl.depthFunc(i),this.current=i,this.dirty=!1)}}class Ot extends si{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;i?u.enable(u.BLEND):u.disable(u.BLEND),this.current=i,this.dirty=!1}}class Dt extends si{getDefault(){const i=this.gl;return[i.ONE,i.ZERO]}set(i){const u=this.current;(i[0]!==u[0]||i[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(i[0],i[1]),this.current=i,this.dirty=!1)}}class Nn extends si{getDefault(){return l.Color.transparent}set(i){const u=this.current;(i.r!==u.r||i.g!==u.g||i.b!==u.b||i.a!==u.a||this.dirty)&&(this.gl.blendColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class nn extends si{getDefault(){return this.gl.FUNC_ADD}set(i){(i!==this.current||this.dirty)&&(this.gl.blendEquation(i),this.current=i,this.dirty=!1)}}class jn extends si{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;i?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=i,this.dirty=!1}}class pi extends si{getDefault(){return this.gl.BACK}set(i){(i!==this.current||this.dirty)&&(this.gl.cullFace(i),this.current=i,this.dirty=!1)}}class to extends si{getDefault(){return this.gl.CCW}set(i){(i!==this.current||this.dirty)&&(this.gl.frontFace(i),this.current=i,this.dirty=!1)}}class Li extends si{getDefault(){return null}set(i){(i!==this.current||this.dirty)&&(this.gl.useProgram(i),this.current=i,this.dirty=!1)}}class $r extends si{getDefault(){return this.gl.TEXTURE0}set(i){(i!==this.current||this.dirty)&&(this.gl.activeTexture(i),this.current=i,this.dirty=!1)}}class Vr extends si{getDefault(){const i=this.gl;return[0,0,i.drawingBufferWidth,i.drawingBufferHeight]}set(i){const u=this.current;(i[0]!==u[0]||i[1]!==u[1]||i[2]!==u[2]||i[3]!==u[3]||this.dirty)&&(this.gl.viewport(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class fo extends si{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,i),this.current=i,this.dirty=!1}}class vo extends si{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class ei extends si{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,i),this.current=i,this.dirty=!1}}class fr extends si{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class sr extends si{getDefault(){return null}set(i){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class Io extends si{constructor(i){super(i),this.vao=i.extVertexArrayObject}getDefault(){return null}set(i){this.vao&&(i!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(i),this.current=i,this.dirty=!1)}}class ir extends si{getDefault(){return 4}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,i),this.current=i,this.dirty=!1}}class Ao extends si{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i),this.current=i,this.dirty=!1}}class Zo extends si{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,i),this.current=i,this.dirty=!1}}class To extends si{constructor(i,u){super(i),this.context=i,this.parent=u}getDefault(){return null}}class Ds extends To{setDirty(){this.dirty=!0}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,i,0),this.current=i,this.dirty=!1}}class qe extends To{attachment(){return this.gl.DEPTH_ATTACHMENT}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,this.attachment(),u.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class Te extends qe{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Me{constructor(i,u,m,E){this.context=i,this.width=u,this.height=m;const M=this.framebuffer=i.gl.createFramebuffer();this.colorAttachment=new Ds(i,M),E&&(this.depthAttachment=new qe(i,M))}destroy(){const i=this.context.gl,u=this.colorAttachment.get();if(u&&i.deleteTexture(u),this.depthAttachment){const m=this.depthAttachment.get();m&&i.deleteRenderbuffer(m)}i.deleteFramebuffer(this.framebuffer)}}class We{constructor(i){this.gl=i,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new fi(this),this.clearDepth=new nr(this),this.clearStencil=new Tr(this),this.colorMask=new Zr(this),this.depthMask=new Ur(this),this.stencilMask=new Mn(this),this.stencilFunc=new yo(this),this.stencilOp=new qr(this),this.stencilTest=new no(this),this.depthRange=new dr(this),this.depthTest=new cs(this),this.depthFunc=new cn(this),this.blend=new Ot(this),this.blendFunc=new Dt(this),this.blendColor=new Nn(this),this.blendEquation=new nn(this),this.cullFace=new jn(this),this.cullFaceSide=new pi(this),this.frontFace=new to(this),this.program=new Li(this),this.activeTexture=new $r(this),this.viewport=new Vr(this),this.bindFramebuffer=new fo(this),this.bindRenderbuffer=new vo(this),this.bindTexture=new ei(this),this.bindVertexBuffer=new fr(this),this.bindElementBuffer=new sr(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Io(this),this.pixelStoreUnpack=new ir(this),this.pixelStoreUnpackPremultiplyAlpha=new Ao(this),this.pixelStoreUnpackFlipY=new Zo(this),this.extTextureFilterAnisotropic=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=i.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extTextureHalfFloat=i.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(i.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=i.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=i.getExtension("OES_standard_derivatives"),this.extTimerQuery=i.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(i,u){return new oi(this,i,u)}createVertexBuffer(i,u,m){return new En(this,i,u,m)}createRenderbuffer(i,u,m){const E=this.gl,M=E.createRenderbuffer();return this.bindRenderbuffer.set(M),E.renderbufferStorage(E.RENDERBUFFER,i,u,m),this.bindRenderbuffer.set(null),M}createFramebuffer(i,u,m){return new Me(this,i,u,m)}clear({color:i,depth:u,stencil:m}){const E=this.gl;let M=0;i&&(M|=E.COLOR_BUFFER_BIT,this.clearColor.set(i),this.colorMask.set([!0,!0,!0,!0])),void 0!==u&&(M|=E.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),void 0!==m&&(M|=E.STENCIL_BUFFER_BIT,this.clearStencil.set(m),this.stencilMask.set(255)),E.clear(M)}setCullFace(i){!1===i.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(i.mode),this.frontFace.set(i.frontFace))}setDepthMode(i){i.func!==this.gl.ALWAYS||i.mask?(this.depthTest.set(!0),this.depthFunc.set(i.func),this.depthMask.set(i.mask),this.depthRange.set(i.range)):this.depthTest.set(!1)}setStencilMode(i){i.test.func!==this.gl.ALWAYS||i.mask?(this.stencilTest.set(!0),this.stencilMask.set(i.mask),this.stencilOp.set([i.fail,i.depthFail,i.pass]),this.stencilFunc.set({func:i.test.func,ref:i.ref,mask:i.test.mask})):this.stencilTest.set(!1)}setColorMode(i){oe(i.blendFunction,l.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(i.blendFunction),this.blendColor.set(i.blendColor)),this.colorMask.set(i.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Xe extends l.Evented{constructor(i,u,m,E){super(),this.id=i,this.dispatcher=m,this.setEventedParent(E),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=l.extend({type:"raster"},u),l.extend(this,l.pick(u,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Br(this._options,this.map._requestManager,null,null,(i,u)=>{this._tileJSONRequest=null,this._loaded=!0,i?this.fire(new l.ErrorEvent(i)):u&&(l.extend(this,u),u.bounds&&(this.tileBounds=new yn(u.bounds,this.minzoom,this.maxzoom)),l.postTurnstileEvent(u.tiles),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(i){this.map=i,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return l.extend({},this._options)}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}loadTile(i,u){const m=l.exported.devicePixelRatio>=2,E=this.map._requestManager.normalizeTileURL(i.tileID.canonical.url(this.tiles,this.scheme),m,this.tileSize);i.request=l.getImage(this.map._requestManager.transformRequest(E,l.ResourceType.Tile),(M,z,Z,K)=>(delete i.request,i.aborted?(i.state="unloaded",u(null)):M?(i.state="errored",u(M)):z?(this.map._refreshExpiredTiles&&i.setExpiryData({cacheControl:Z,expires:K}),i.setTexture(z,this.map.painter),i.state="loaded",l.cacheEntryPossiblyAdded(this.dispatcher),void u(null)):u(null)))}static loadTileData(i,u,m){i.setTexture(u,m)}static unloadTileData(i,u){i.texture&&u.saveTileTexture(i.texture)}abortTile(i,u){i.request&&(i.request.cancel(),delete i.request),u()}unloadTile(i,u){i.texture&&this.map.painter.saveTileTexture(i.texture),u()}hasTransition(){return!1}}let xt;function Gt(d,i,u,m,E,M,z,Z){const K=[d,u,E,i,m,M,1,1,1],de=[z,Z,1],pe=l.adjoint([],K),[De,Fe,Je]=l.transformMat3(de,de,l.transpose(pe,pe));return l.multiply$1(K,[De,0,0,0,Fe,0,0,0,Je],K)}class Rt extends l.Evented{constructor(i,u,m,E){super(),this.id=i,this.dispatcher=m,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(E),this.options=u}load(i,u){this._loaded=u||!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this.url=this.options.url,l.getImage(this.map._requestManager.transformRequest(this.url,l.ResourceType.Image),(m,E)=>{if(this._loaded=!0,m)this.fire(new l.ErrorEvent(m));else if(E){const{HTMLImageElement:M}=l.window;this.image=E instanceof M?l.exported.getImageData(E):E,this.width=this.image.width,this.height=this.image.height,i&&(this.coordinates=i),this._finishLoading()}})}loaded(){return this._loaded}updateImage(i){return this.image&&i.url?(this.options.url=i.url,this.load(i.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(i){this.map=i,this.load()}onRemove(){this.texture&&this.texture.destroy()}setCoordinates(i){this.coordinates=i,this._boundsArray=void 0;const u=i.map(l.MercatorCoordinate.fromLngLat);return this.tileID=function(m){let E=1/0,M=1/0,z=-1/0,Z=-1/0;for(const De of m)E=Math.min(E,De.x),M=Math.min(M,De.y),z=Math.max(z,De.x),Z=Math.max(Z,De.y);const K=Math.max(z-E,Z-M),de=Math.max(0,Math.floor(-Math.log(K)/Math.LN2)),pe=Math.pow(2,de);return new l.CanonicalTileID(de,Math.floor((E+z)/2*pe),Math.floor((M+Z)/2*pe))}(u),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(i){for(const K in this.tiles){const de=this.tiles[K];"loaded"!==de.state&&(de.state="loaded",de.texture=this.texture)}if(this._boundsArray)return;const u=l.tileTransform(this.tileID,this.map.transform.projection),[m,E,M,z]=this.coordinates.map(K=>{const de=u.projection.project(K[0],K[1]);return l.getTilePoint(u,de)._round()});this.perspectiveTransform=function(K,de,pe,De,Fe,Je,Ge,He,$e,ze){const tt=Gt(0,0,K,0,0,de,K,de),et=Gt(pe,De,Fe,Je,Ge,He,$e,ze);return l.multiply$1(et,l.adjoint(tt,tt),et),[et[6]/et[8]*K/l.EXTENT,et[7]/et[8]*de/l.EXTENT]}(this.width,this.height,m.x,m.y,E.x,E.y,z.x,z.y,M.x,M.y);const Z=this._boundsArray=new l.StructArrayLayout4i8;Z.emplaceBack(m.x,m.y,0,0),Z.emplaceBack(E.x,E.y,l.EXTENT,0),Z.emplaceBack(z.x,z.y,0,l.EXTENT),Z.emplaceBack(M.x,M.y,l.EXTENT,l.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=i.createVertexBuffer(Z,l.boundsAttributes.members),this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const i=this.map.painter.context,u=i.gl;this.texture?this.texture.update(this.image):(this.texture=new l.Texture(i,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this._prepareData(i)}loadTile(i,u){this.tileID&&this.tileID.equals(i.tileID.canonical)?(this.tiles[String(i.tileID.wrap)]=i,i.buckets={},u(null)):(i.state="errored",u(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const nt={vector:class extends l.Evented{constructor(d,i,u,m){if(super(),this.id=d,this.dispatcher=u,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,l.extend(this,l.pick(i,["url","scheme","tileSize","promoteId"])),this._options=l.extend({type:"vector"},i),this._collectResourceTiming=i.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(m),this._tileWorkers={},this._deduped=new l.DedupedRequest}load(d){this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"}));const i=this.language||this.map._language,u=this.worldview||this.map._worldview;this._tileJSONRequest=Br(this._options,this.map._requestManager,i,u,(m,E)=>{this._tileJSONRequest=null,this._loaded=!0,m?(i&&console.warn(`Ensure that your requested language string is a valid BCP-47 code. Found: ${i}`),u&&2!==u.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${u}`),this.fire(new l.ErrorEvent(m))):E&&(l.extend(this,E),E.bounds&&(this.tileBounds=new yn(E.bounds,this.minzoom,this.maxzoom)),l.postTurnstileEvent(E.tiles,this.map._requestManager._customAccessToken),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"}))),d&&d(m)})}loaded(){return this._loaded}hasTile(d){return!this.tileBounds||this.tileBounds.contains(d.canonical)}onAdd(d){this.map=d,this.load()}setSourceProperty(d){this._tileJSONRequest&&this._tileJSONRequest.cancel(),d(),this.load(()=>{const i=this.map.style._getSourceCaches(this.id);for(const u of i)u.clearTiles()})}setTiles(d){return this.setSourceProperty(()=>{this._options.tiles=d}),this}setUrl(d){return this.setSourceProperty(()=>{this.url=d,this._options.url=d}),this}_setLanguage(d){return d===this.language||this.setSourceProperty(()=>{this.language=d}),this}_setWorldview(d){return d===this.worldview?this:this.worldviewOptions&&d&&!this.worldviewOptions[d]?(console.warn(`Vector tile source "${this.id}" does not support worldview "${d}".`),this):(this.setSourceProperty(()=>{this.worldview=d}),this)}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return l.extend({},this._options)}loadTile(d,i){const u=this.map._requestManager.normalizeTileURL(d.tileID.canonical.url(this.tiles,this.scheme)),m={request:this.map._requestManager.transformRequest(u,l.ResourceType.Tile),data:void 0,uid:d.uid,tileID:d.tileID,tileZoom:d.tileZoom,zoom:d.tileID.overscaledZ,tileSize:this.tileSize*d.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:l.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:d.isSymbolTile};if(m.request.collectResourceTiming=this._collectResourceTiming,d.actor&&"expired"!==d.state)"loading"===d.state?d.reloadCallback=i:d.request=d.actor.send("reloadTile",m,E.bind(this));else if(d.actor=this._tileWorkers[u]=this._tileWorkers[u]||this.dispatcher.getActor(),this.dispatcher.ready)d.request=d.actor.send("loadTile",m,E.bind(this),void 0,!0);else{const M=l.loadVectorTile.call({deduped:this._deduped},m,(z,Z)=>{z||!Z?E.call(this,z):(m.data={cacheControl:Z.cacheControl,expires:Z.expires,rawData:Z.rawData.slice(0)},d.actor&&d.actor.send("loadTile",m,E.bind(this),void 0,!0))},!0);d.request={cancel:M}}function E(M,z){return delete d.request,d.aborted?i(null):M&&404!==M.status?i(M):(z&&z.resourceTiming&&(d.resourceTiming=z.resourceTiming),this.map._refreshExpiredTiles&&z&&d.setExpiryData(z),d.loadVectorData(z,this.map.painter),l.cacheEntryPossiblyAdded(this.dispatcher),i(null),void(d.reloadCallback&&(this.loadTile(d,d.reloadCallback),d.reloadCallback=null)))}}abortTile(d){d.request&&(d.request.cancel(),delete d.request),d.actor&&d.actor.send("abortTile",{uid:d.uid,type:this.type,source:this.id})}unloadTile(d){d.unloadVectorData(),d.actor&&d.actor.send("removeTile",{uid:d.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}},raster:Xe,"raster-dem":class extends Xe{constructor(d,i,u,m){super(d,i,u,m),this.type="raster-dem",this.maxzoom=22,this._options=l.extend({type:"raster-dem"},i),this.encoding=i.encoding||"mapbox"}loadTile(d,i){const u=this.map._requestManager.normalizeTileURL(d.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function m(E,M){E&&(d.state="errored",i(E)),M&&(d.dem=M,d.dem.onDeserialize(),d.needsHillshadePrepare=!0,d.needsDEMTextureUpload=!0,d.state="loaded",i(null))}d.request=l.getImage(this.map._requestManager.transformRequest(u,l.ResourceType.Tile),function(E,M,z,Z){if(delete d.request,d.aborted)d.state="unloaded",i(null);else if(E)d.state="errored",i(E);else if(M){this.map._refreshExpiredTiles&&d.setExpiryData({cacheControl:z,expires:Z});const K=l.window.ImageBitmap&&M instanceof l.window.ImageBitmap&&(null==xt&&(xt=l.window.OffscreenCanvas&&new l.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof l.window.createImageBitmap),xt),de=1-(M.width-l.prevPowerOfTwo(M.width))/2;de<1||d.neighboringTiles||(d.neighboringTiles=this._getNeighboringTiles(d.tileID));const pe=K?M:l.exported.getImageData(M,de),De={uid:d.uid,coord:d.tileID,source:this.id,rawImageData:pe,encoding:this.encoding,padding:de};d.actor&&"expired"!==d.state||(d.actor=this.dispatcher.getActor(),d.actor.send("loadDEMTile",De,m.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(d){const i=d.canonical,u=Math.pow(2,i.z),m=(i.x-1+u)%u,E=0===i.x?d.wrap-1:d.wrap,M=(i.x+1+u)%u,z=i.x+1===u?d.wrap+1:d.wrap,Z={};return Z[new l.OverscaledTileID(d.overscaledZ,E,i.z,m,i.y).key]={backfilled:!1},Z[new l.OverscaledTileID(d.overscaledZ,z,i.z,M,i.y).key]={backfilled:!1},i.y>0&&(Z[new l.OverscaledTileID(d.overscaledZ,E,i.z,m,i.y-1).key]={backfilled:!1},Z[new l.OverscaledTileID(d.overscaledZ,d.wrap,i.z,i.x,i.y-1).key]={backfilled:!1},Z[new l.OverscaledTileID(d.overscaledZ,z,i.z,M,i.y-1).key]={backfilled:!1}),i.y+1<u&&(Z[new l.OverscaledTileID(d.overscaledZ,E,i.z,m,i.y+1).key]={backfilled:!1},Z[new l.OverscaledTileID(d.overscaledZ,d.wrap,i.z,i.x,i.y+1).key]={backfilled:!1},Z[new l.OverscaledTileID(d.overscaledZ,z,i.z,M,i.y+1).key]={backfilled:!1}),Z}unloadTile(d){d.demTexture&&this.map.painter.saveTileTexture(d.demTexture),d.fbo&&(d.fbo.destroy(),delete d.fbo),d.dem&&delete d.dem,delete d.neighboringTiles,d.state="unloaded"}},geojson:class extends l.Evented{constructor(d,i,u,m){super(),this.id=d,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=u.getActor(),this.setEventedParent(m),this._data=i.data,this._options=l.extend({},i),this._collectResourceTiming=i.collectResourceTiming,void 0!==i.maxzoom&&(this.maxzoom=i.maxzoom),i.type&&(this.type=i.type),i.attribution&&(this.attribution=i.attribution),this.promoteId=i.promoteId;const E=l.EXTENT/this.tileSize;this.workerOptions=l.extend({source:this.id,cluster:i.cluster||!1,geojsonVtOptions:{buffer:(void 0!==i.buffer?i.buffer:128)*E,tolerance:(void 0!==i.tolerance?i.tolerance:.375)*E,extent:l.EXTENT,maxZoom:this.maxzoom,lineMetrics:i.lineMetrics||!1,generateId:i.generateId||!1},superclusterOptions:{maxZoom:void 0!==i.clusterMaxZoom?i.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,i.clusterMinPoints||2),extent:l.EXTENT,radius:(void 0!==i.clusterRadius?i.clusterRadius:50)*E,log:!1,generateId:i.generateId||!1},clusterProperties:i.clusterProperties,filter:i.filter},i.workerOptions)}onAdd(d){this.map=d,this.setData(this._data)}setData(d){return this._data=d,this._updateWorkerData(),this}getClusterExpansionZoom(d,i){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:d,source:this.id},i),this}getClusterChildren(d,i){return this.actor.send("geojson.getClusterChildren",{clusterId:d,source:this.id},i),this}getClusterLeaves(d,i,u,m){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:d,limit:i,offset:u},m),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new l.Event("dataloading",{dataType:"source"})),this._loaded=!1;const d=l.extend({},this.workerOptions),i=this._data;"string"==typeof i?(d.request=this.map._requestManager.transformRequest(l.exported.resolveURL(i),l.ResourceType.Source),d.request.collectResourceTiming=this._collectResourceTiming):d.data=JSON.stringify(i),this._pendingLoad=this.actor.send(`${this.type}.loadData`,d,(u,m)=>{if(this._loaded=!0,this._pendingLoad=null,u)this.fire(new l.ErrorEvent(u));else{const E={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&m&&m.resourceTiming&&m.resourceTiming[this.id]&&(E.resourceTiming=m.resourceTiming[this.id]),this.fire(new l.Event("data",E)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(d,i){const u=d.actor?"reloadTile":"loadTile";d.actor=this.actor,d.request=this.actor.send(u,{type:this.type,uid:d.uid,tileID:d.tileID,tileZoom:d.tileZoom,zoom:d.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:l.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(m,E)=>(delete d.request,d.unloadVectorData(),d.aborted?i(null):m?i(m):(d.loadVectorData(E,this.map.painter,"reloadTile"===u),i(null))),void 0,"loadTile"===u)}abortTile(d){d.request&&(d.request.cancel(),delete d.request),d.aborted=!0}unloadTile(d){d.unloadVectorData(),this.actor.send("removeTile",{uid:d.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return l.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Rt{constructor(d,i,u,m){super(d,i,u,m),this.roundZoom=!0,this.type="video",this.options=i}load(){this._loaded=!1;const d=this.options;this.urls=[];for(const i of d.urls)this.urls.push(this.map._requestManager.transformRequest(i,l.ResourceType.Source).url);l.getVideo(this.urls,(i,u)=>{this._loaded=!0,i?this.fire(new l.ErrorEvent(i)):u&&(this.video=u,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(d){if(this.video){const i=this.video.seekable;d<i.start(0)||d>i.end(0)?this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${i.start(0)} and ${i.end(0)}-second mark.`))):this.video.currentTime=d}}getVideo(){return this.video}onAdd(d){this.map||(this.map=d,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const d=this.map.painter.context,i=d.gl;this.texture?this.video.paused||(this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,this.video)):(this.texture=new l.Texture(d,this.video,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(d)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Rt,canvas:class extends Rt{constructor(d,i,u,m){super(d,i,u,m),i.coordinates?Array.isArray(i.coordinates)&&4===i.coordinates.length&&!i.coordinates.some(E=>!Array.isArray(E)||2!==E.length||E.some(M=>"number"!=typeof M))||this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${d}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${d}`,null,'missing required property "coordinates"'))),i.animate&&"boolean"!=typeof i.animate&&this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${d}`,null,'optional "animate" property must be a boolean value'))),i.canvas?"string"==typeof i.canvas||i.canvas instanceof l.window.HTMLCanvasElement||this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${d}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${d}`,null,'missing required property "canvas"'))),this.options=i,this.animate=void 0===i.animate||i.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof l.window.HTMLCanvasElement?this.options.canvas:l.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new l.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(d){this.map=d,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let d=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,d=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,d=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const i=this.map.painter.context;this.texture?(d||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new l.Texture(i,this.canvas,i.gl.RGBA,{premultiply:!0}),this._prepareData(i)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const d of[this.canvas.width,this.canvas.height])if(isNaN(d)||d<=0)return!0;return!1}},custom:class extends l.Evented{constructor(d,i,u,m){super(),this.id=d,this.type="custom",this._dataType="raster",this._dispatcher=u,this._implementation=i,this.setEventedParent(m),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new l.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new l.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new yn(this._implementation.bounds,this.minzoom,this.maxzoom)),i.update=this._update.bind(this),i.coveringTiles=this._coveringTiles.bind(this),l.extend(this,l.pick(i,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return l.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(d){this._map=d,this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(d),this.load()}onRemove(d){this._implementation.onRemove&&this._implementation.onRemove(d)}hasTile(d){if(this._implementation.hasTile){const{x:i,y:u,z:m}=d.canonical;return this._implementation.hasTile({x:i,y:u,z:m})}return!this.tileBounds||this.tileBounds.contains(d.canonical)}loadTile(d,i){const{x:u,y:m,z:E}=d.tileID.canonical,M=new l.window.AbortController,z=this._implementation.loadTile({x:u,y:m,z:E},{signal:M.signal});if(!z)return this.loadTileData(d,{width:this.tileSize,height:this.tileSize,data:null}),d.state="loaded",i(null);z.cancel=()=>M.abort(),d.request=z.then(function(Z){return delete d.request,d.aborted?(d.state="unloaded",i(null)):Z?(K=Z)instanceof l.window.ImageData||K instanceof l.window.ImageBitmap||K instanceof l.window.HTMLCanvasElement?(this.loadTileData(d,Z),d.state="loaded",void i(null)):(d.state="errored",i(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`))):(this.loadTileData(d,{width:this.tileSize,height:this.tileSize,data:null}),d.state="loaded",i(null));var K}.bind(this)).catch(Z=>{20!==Z.code&&(d.state="errored",i(Z))})}loadTileData(d,i){Xe.loadTileData(d,i,this._map.painter)}unloadTileData(d){Xe.unloadTileData(d,this._map.painter)}prepareTile(d){if(!this._implementation.prepareTile)return null;const{x:i,y:u,z:m}=d.tileID.canonical,E=this._implementation.prepareTile({x:i,y:u,z:m});return E?(this.loadTileData(d,E),d.state="loaded",E):null}unloadTile(d,i){if(this.unloadTileData(d),this._implementation.unloadTile){const{x:u,y:m,z:E}=d.tileID.canonical;this._implementation.unloadTile({x:u,y:m,z:E})}i()}abortTile(d,i){d.request&&d.request.cancel&&(d.request.cancel(),delete d.request),i()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(d=>({x:d.canonical.x,y:d.canonical.y,z:d.canonical.z}))}_update(){this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"}))}}},Kt=function(d,i,u,m){const E=new nt[i.type](d,i,u,m);if(E.id!==d)throw new Error(`Expected Source id to be ${d} instead of ${E.id}`);return l.bindAll(["load","abort","unload","serialize","prepare"],E),E};function Dn(d,i){const u=l.identity([]);return l.scale(u,u,[.5*d.width,.5*-d.height,1]),l.translate(u,u,[1,-1,0]),l.multiply(u,u,d.calculateProjMatrix(i.toUnwrapped())),Float32Array.from(u)}function xe(d,i,u,m,E,M,z,Z=!1){const K=d.tilesIn(m,z,Z);K.sort(Be);const de=[];for(const De of K)de.push({wrappedTileID:De.tile.tileID.wrapped().key,queryResults:De.tile.queryRenderedFeatures(i,u,d._state,De,E,M,Dn(d.transform,De.tile.tileID),Z)});const pe=function(De){const Fe={},Je={};for(const Ge of De){const He=Ge.queryResults,$e=Ge.wrappedTileID,ze=Je[$e]=Je[$e]||{};for(const tt in He){const et=He[tt],Mt=ze[tt]=ze[tt]||{},Et=Fe[tt]=Fe[tt]||[];for(const yt of et)Mt[yt.featureIndex]||(Mt[yt.featureIndex]=!0,Et.push(yt))}}return Fe}(de);for(const De in pe)pe[De].forEach(Fe=>{const Je=Fe.feature,Ge=Je.layer;Ge&&"background"!==Ge.type&&"sky"!==Ge.type&&(Je.source=Ge.source,Ge["source-layer"]&&(Je.sourceLayer=Ge["source-layer"]),Je.state=void 0!==Je.id?d.getFeatureState(Ge["source-layer"],Je.id):{})});return pe}function Se(d,i){const u=d.getRenderableIds().map(M=>d.getTileByID(M)),m=[],E={};for(let M=0;M<u.length;M++){const z=u[M],Z=z.tileID.canonical.key;E[Z]||(E[Z]=!0,z.querySourceFeatures(m,i))}return m}function Be(d,i){const u=d.tileID,m=i.tileID;return u.overscaledZ-m.overscaledZ||u.canonical.y-m.canonical.y||u.wrap-m.wrap||u.canonical.x-m.canonical.x}function dt(){return null!=hu.workerClass?new hu.workerClass:new l.window.Worker(hu.workerUrl)}const Pt="mapboxgl_preloaded_worker_pool";class rn{constructor(){this.active={}}acquire(i){if(!this.workers)for(this.workers=[];this.workers.length<rn.workerCount;)this.workers.push(new dt);return this.active[i]=!0,this.workers.slice()}release(i){delete this.active[i],0===this.numActive()&&(this.workers.forEach(u=>{u.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Pt]}numActive(){return Object.keys(this.active).length}}let un;function In(){return un||(un=new rn),un}function Pn(d,i){const u={};for(const m in d)"ref"!==m&&(u[m]=d[m]);return l.refProperties.forEach(m=>{m in i&&(u[m]=i[m])}),u}function mi(d){d=d.slice();const i=Object.create(null);for(let u=0;u<d.length;u++)i[d[u].id]=d[u];for(let u=0;u<d.length;u++)"ref"in d[u]&&(d[u]=Pn(d[u],i[d[u].ref]));return d}rn.workerCount=2;const Xn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function qt(d,i,u){u.push({command:Xn.addSource,args:[d,i[d]]})}function Gr(d,i,u){i.push({command:Xn.removeSource,args:[d]}),u[d]=!0}function gr(d,i,u,m){Gr(d,u,m),qt(d,i,u)}function Rn(d,i,u){let m;for(m in d[u])if(d[u].hasOwnProperty(m)&&"data"!==m&&!oe(d[u][m],i[u][m]))return!1;for(m in i[u])if(i[u].hasOwnProperty(m)&&"data"!==m&&!oe(d[u][m],i[u][m]))return!1;return!0}function ti(d,i,u,m,E,M){let z;for(z in i=i||{},d=d||{})d.hasOwnProperty(z)&&(oe(d[z],i[z])||u.push({command:M,args:[m,z,i[z],E]}));for(z in i)i.hasOwnProperty(z)&&!d.hasOwnProperty(z)&&(oe(d[z],i[z])||u.push({command:M,args:[m,z,i[z],E]}))}function hr(d){return d.id}function Er(d,i){return d[i.id]=i,d}class Mr{constructor(i,u){this.reset(i,u)}reset(i,u){this.points=i||[],this._distances=[0];for(let m=1;m<this.points.length;m++)this._distances[m]=this._distances[m-1]+this.points[m].dist(this.points[m-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(i){if(1===this.points.length)return this.points[0];i=l.clamp(i,0,1);let u=1,m=this._distances[u];const E=i*this.paddedLength+this.padding;for(;m<E&&u<this._distances.length;)m=this._distances[++u];const M=u-1,z=this._distances[M],Z=m-z,K=Z>0?(E-z)/Z:0;return this.points[M].mult(1-K).add(this.points[u].mult(K))}}class Nr{constructor(i,u,m){const E=this.boxCells=[],M=this.circleCells=[];this.xCellCount=Math.ceil(i/m),this.yCellCount=Math.ceil(u/m);for(let z=0;z<this.xCellCount*this.yCellCount;z++)E.push([]),M.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=i,this.height=u,this.xScale=this.xCellCount/i,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(i,u,m,E,M){this._forEachCell(u,m,E,M,this._insertBoxCell,this.boxUid++),this.boxKeys.push(i),this.bboxes.push(u),this.bboxes.push(m),this.bboxes.push(E),this.bboxes.push(M)}insertCircle(i,u,m,E){this._forEachCell(u-E,m-E,u+E,m+E,this._insertCircleCell,this.circleUid++),this.circleKeys.push(i),this.circles.push(u),this.circles.push(m),this.circles.push(E)}_insertBoxCell(i,u,m,E,M,z){this.boxCells[M].push(z)}_insertCircleCell(i,u,m,E,M,z){this.circleCells[M].push(z)}_query(i,u,m,E,M,z){if(m<0||i>this.width||E<0||u>this.height)return!M&&[];const Z=[];if(i<=0&&u<=0&&this.width<=m&&this.height<=E){if(M)return!0;for(let K=0;K<this.boxKeys.length;K++)Z.push({key:this.boxKeys[K],x1:this.bboxes[4*K],y1:this.bboxes[4*K+1],x2:this.bboxes[4*K+2],y2:this.bboxes[4*K+3]});for(let K=0;K<this.circleKeys.length;K++){const de=this.circles[3*K],pe=this.circles[3*K+1],De=this.circles[3*K+2];Z.push({key:this.circleKeys[K],x1:de-De,y1:pe-De,x2:de+De,y2:pe+De})}return z?Z.filter(z):Z}return this._forEachCell(i,u,m,E,this._queryCell,Z,{hitTest:M,seenUids:{box:{},circle:{}}},z),M?Z.length>0:Z}_queryCircle(i,u,m,E,M){const z=i-m,Z=i+m,K=u-m,de=u+m;if(Z<0||z>this.width||de<0||K>this.height)return!E&&[];const pe=[];return this._forEachCell(z,K,Z,de,this._queryCellCircle,pe,{hitTest:E,circle:{x:i,y:u,radius:m},seenUids:{box:{},circle:{}}},M),E?pe.length>0:pe}query(i,u,m,E,M){return this._query(i,u,m,E,!1,M)}hitTest(i,u,m,E,M){return this._query(i,u,m,E,!0,M)}hitTestCircle(i,u,m,E){return this._queryCircle(i,u,m,!0,E)}_queryCell(i,u,m,E,M,z,Z,K){const de=Z.seenUids,pe=this.boxCells[M];if(null!==pe){const Fe=this.bboxes;for(const Je of pe)if(!de.box[Je]){de.box[Je]=!0;const Ge=4*Je;if(i<=Fe[Ge+2]&&u<=Fe[Ge+3]&&m>=Fe[Ge+0]&&E>=Fe[Ge+1]&&(!K||K(this.boxKeys[Je]))){if(Z.hitTest)return z.push(!0),!0;z.push({key:this.boxKeys[Je],x1:Fe[Ge],y1:Fe[Ge+1],x2:Fe[Ge+2],y2:Fe[Ge+3]})}}}const De=this.circleCells[M];if(null!==De){const Fe=this.circles;for(const Je of De)if(!de.circle[Je]){de.circle[Je]=!0;const Ge=3*Je;if(this._circleAndRectCollide(Fe[Ge],Fe[Ge+1],Fe[Ge+2],i,u,m,E)&&(!K||K(this.circleKeys[Je]))){if(Z.hitTest)return z.push(!0),!0;{const He=Fe[Ge],$e=Fe[Ge+1],ze=Fe[Ge+2];z.push({key:this.circleKeys[Je],x1:He-ze,y1:$e-ze,x2:He+ze,y2:$e+ze})}}}}}_queryCellCircle(i,u,m,E,M,z,Z,K){const de=Z.circle,pe=Z.seenUids,De=this.boxCells[M];if(null!==De){const Je=this.bboxes;for(const Ge of De)if(!pe.box[Ge]){pe.box[Ge]=!0;const He=4*Ge;if(this._circleAndRectCollide(de.x,de.y,de.radius,Je[He+0],Je[He+1],Je[He+2],Je[He+3])&&(!K||K(this.boxKeys[Ge])))return z.push(!0),!0}}const Fe=this.circleCells[M];if(null!==Fe){const Je=this.circles;for(const Ge of Fe)if(!pe.circle[Ge]){pe.circle[Ge]=!0;const He=3*Ge;if(this._circlesCollide(Je[He],Je[He+1],Je[He+2],de.x,de.y,de.radius)&&(!K||K(this.circleKeys[Ge])))return z.push(!0),!0}}}_forEachCell(i,u,m,E,M,z,Z,K){const de=this._convertToXCellCoord(i),pe=this._convertToYCellCoord(u),De=this._convertToXCellCoord(m),Fe=this._convertToYCellCoord(E);for(let Je=de;Je<=De;Je++)for(let Ge=pe;Ge<=Fe;Ge++)if(M.call(this,i,u,m,E,this.xCellCount*Ge+Je,z,Z,K))return}_convertToXCellCoord(i){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(i*this.xScale)))}_convertToYCellCoord(i){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(i*this.yScale)))}_circlesCollide(i,u,m,E,M,z){const Z=E-i,K=M-u,de=m+z;return de*de>Z*Z+K*K}_circleAndRectCollide(i,u,m,E,M,z,Z){const K=(z-E)/2,de=Math.abs(i-(E+K));if(de>K+m)return!1;const pe=(Z-M)/2,De=Math.abs(u-(M+pe));if(De>pe+m)return!1;if(de<=K||De<=pe)return!0;const Fe=de-K,Je=De-pe;return Fe*Fe+Je*Je<=m*m}}const Wn=Math.tan(85*Math.PI/180);function Fi(d,i,u,m,E,M,z){const Z=l.create();if(u)if("globe"===M.name){const K=l.calculateGlobeLabelMatrix(E,i);l.multiply(Z,Z,K)}else{const K=Cn([],z);Z[0]=K[0],Z[1]=K[1],Z[4]=K[2],Z[5]=K[3],m||l.rotateZ(Z,Z,E.angle)}else l.multiply(Z,E.labelPlaneMatrix,d);return Z}function Xi(d,i,u,m,E,M,z){const Z=Fi(d,i,u,m,E,M,z);return"globe"===M.name&&u||(Z[2]=Z[6]=Z[10]=Z[14]=0),Z}function Gi(d,i,u,m,E,M,z){if(u){if("globe"===M.name){const Z=Fi(d,i,u,m,E,M,z);return l.invert(Z,Z),l.multiply(Z,d,Z),Z}{const Z=l.clone(d),K=l.identity([]);return K[0]=z[0],K[1]=z[1],K[4]=z[2],K[5]=z[3],l.multiply(Z,Z,K),m||l.rotateZ(Z,Z,-E.angle),Z}}return E.glCoordMatrix}function yi(d,i,u=0){const m=[d.x,d.y,u,1];u?l.transformMat4$1(m,m,i):xr(m,m,i);const E=m[3];return{point:[m[0]/E,m[1]/E,m[2]/E],signedDistanceFromCamera:E}}function Ji(d,i){const u=[d[0],d[1],d[2],1];l.transformMat4$1(u,u,i);const m=u[3];return{point:[u[0]/m,u[1]/m,u[2]/m],signedDistanceFromCamera:m}}function Ko(d,i){return Math.min(.5+d/i*.5,1.5)}function us(d,i){const u=d[0]/d[3],m=d[1]/d[3];return u>=-i[0]&&u<=i[0]&&m>=-i[1]&&m<=i[1]}function Ss(d,i,u,m,E,M,z,Z,K,de){const pe=u.transform,De=m?d.textSizeData:d.iconSizeData,Fe=l.evaluateSizeForZoom(De,u.transform.zoom),Je="globe"===pe.projection.name,Ge=[256/u.width*2+1,256/u.height*2+1],He=m?d.text.dynamicLayoutVertexArray:d.icon.dynamicLayoutVertexArray;He.clear();let $e=null;Je&&($e=m?d.text.globeExtVertexArray:d.icon.globeExtVertexArray);const ze=d.lineVertexArray,tt=m?d.text.placedSymbolArray:d.icon.placedSymbolArray,et=u.transform.width/u.transform.height;let Mt=!1;for(let Et=0;Et<tt.length;Et++){const yt=tt.get(Et);if(yt.writingMode!==l.WritingMode.vertical||Mt||0!==Et&&tt.get(Et-1).writingMode===l.WritingMode.horizontal||(Mt=!0),(yt.hidden||yt.writingMode===l.WritingMode.vertical)&&!Mt){po(yt.numGlyphs,He);continue}Mt=!1;const It=new l.pointGeometry(yt.tileAnchorX,yt.tileAnchorY),Ct=K?K(It):[0,0,0],Vt=pe.projection.projectTilePoint(It.x,It.y,de.canonical),sn=[Vt.x+Ct[0],Vt.y+Ct[1],Vt.z+Ct[2]],ni=[...sn,1];if(l.transformMat4$1(ni,ni,i),!us(ni,Ge)){po(yt.numGlyphs,He);continue}const Xt=Ko(u.transform.cameraToCenterDistance,ni[3]),Ln=l.evaluateSizeForFeature(De,Fe,yt),zn=z?Ln/Xt:Ln*Xt,di=yi(new l.pointGeometry(sn[0],sn[1]),E,sn[2]);if(di.signedDistanceFromCamera<=0){po(yt.numGlyphs,He);continue}let _n={};const li=z?null:K,Un=ks(yt,zn,!1,Z,i,E,M,d.glyphOffsetArray,ze,He,$e,di.point,It,_n,et,li,pe.projection,de,z);Mt=Un.useVertical,li&&Un.needsFlipping&&(_n={}),(Un.notEnoughRoom||Mt||Un.needsFlipping&&ks(yt,zn,!0,Z,i,E,M,d.glyphOffsetArray,ze,He,$e,di.point,It,_n,et,li,pe.projection,de,z).notEnoughRoom)&&po(yt.numGlyphs,He)}m?(d.text.dynamicLayoutVertexBuffer.updateData(He),$e&&d.text.globeExtVertexBuffer.updateData($e)):(d.icon.dynamicLayoutVertexBuffer.updateData(He),$e&&d.icon.globeExtVertexBuffer.updateData($e))}function Hi(d,i,u,m,E,M,z,Z,K,de,pe,De,Fe,Je,Ge,He){const $e=Z.glyphStartIndex+Z.numGlyphs,ze=Z.lineStartIndex,tt=Z.lineStartIndex+Z.lineLength,et=i.getoffsetX(Z.glyphStartIndex),Mt=i.getoffsetX($e-1),Et=Uo(d*et,u,m,E,M,z,Z.segment,ze,tt,K,de,pe,De,Fe,!0,Je,Ge,He);if(!Et)return null;const yt=Uo(d*Mt,u,m,E,M,z,Z.segment,ze,tt,K,de,pe,De,Fe,!0,Je,Ge,He);return yt?{first:Et,last:yt}:null}function lr(d,i,u,m){return d.writingMode===l.WritingMode.horizontal&&Math.abs(u.y-i.y)>Math.abs(u.x-i.x)*m?{useVertical:!0}:d.writingMode===l.WritingMode.vertical?i.y<u.y?{needsFlipping:!0}:null:0!==d.flipState&&function(E,M,z){const Z=(M.x-E.x)*z;return 0===Z||Math.abs((M.y-E.y)/Z)>Wn}(i,u,m)?1===d.flipState?{needsFlipping:!0}:null:i.x>u.x?{needsFlipping:!0}:null}function ks(d,i,u,m,E,M,z,Z,K,de,pe,De,Fe,Je,Ge,He,$e,ze,tt){const et=i/24,Mt=d.lineOffsetX*et,Et=d.lineOffsetY*et;let yt;if(d.numGlyphs>1){const It=d.glyphStartIndex+d.numGlyphs,Ct=d.lineStartIndex,Vt=d.lineStartIndex+d.lineLength,sn=Hi(et,Z,Mt,Et,u,De,Fe,d,K,M,Je,He,!1,$e,ze,tt);if(!sn)return{notEnoughRoom:!0};const ni=Ji(sn.first.point,z).point,Xt=Ji(sn.last.point,z).point,Ln=new l.pointGeometry(ni[0],ni[1]),zn=new l.pointGeometry(Xt[0],Xt[1]);if(m&&!u){const di=lr(d,Ln,zn,Ge);if(d.flipState=di&&di.needsFlipping?1:2,di)return di}yt=[sn.first];for(let di=d.glyphStartIndex+1;di<It-1;di++)yt.push(Uo(et*Z.getoffsetX(di),Mt,Et,u,De,Fe,d.segment,Ct,Vt,K,M,Je,He,!1,!1,$e,ze,tt));yt.push(sn.last)}else{if(m&&!u){const Ct=yi(Fe,E).point,Vt=d.lineStartIndex+d.segment+1,sn=new l.pointGeometry(K.getx(Vt),K.gety(Vt)),ni=yi(sn,E),Xt=ni.signedDistanceFromCamera>0?ni.point:Dr(Fe,sn,Ct,1,E,void 0,$e,ze.canonical),Ln=lr(d,new l.pointGeometry(Ct[0],Ct[1]),new l.pointGeometry(Xt[0],Xt[1]),Ge);if(d.flipState=Ln&&Ln.needsFlipping?1:2,Ln)return Ln}const It=Uo(et*Z.getoffsetX(d.glyphStartIndex),Mt,Et,u,De,Fe,d.segment,d.lineStartIndex,d.lineStartIndex+d.lineLength,K,M,Je,He,!1,!1,$e,ze,tt);if(!It)return{notEnoughRoom:!0};yt=[It]}if(pe)for(const It of yt)l.updateGlobeVertexNormal(pe,de.length+0,It.up[0],It.up[1],It.up[2]),l.updateGlobeVertexNormal(pe,de.length+1,It.up[0],It.up[1],It.up[2]),l.updateGlobeVertexNormal(pe,de.length+2,It.up[0],It.up[1],It.up[2]),l.updateGlobeVertexNormal(pe,de.length+3,It.up[0],It.up[1],It.up[2]),l.addDynamicAttributes(de,It.point[0],It.point[1],It.point[2],It.angle);else for(const It of yt)l.addDynamicAttributes(de,It.point[0],It.point[1],It.point[2],It.angle);return{}}function Po(d,i,u,m,E){const M=m.projectTilePoint(d.x,d.y,i);if(!E)return yi(M,u,M.z);const z=E(d);return yi(new l.pointGeometry(M.x+z[0],M.y+z[1]),u,M.z+z[2])}function Dr(d,i,u,m,E,M,z,Z){const K=Po(d.add(d.sub(i)._unit()),Z,E,z,M).point,de=l.sub([],u,K);return l.scaleAndAdd([],u,de,m/l.length(de))}function Uo(d,i,u,m,E,M,z,Z,K,de,pe,De,Fe,Je,Ge,He,$e,ze){const tt=m?d-i:d+i;let et=tt>0?1:-1,Mt=0;m&&(et*=-1,Mt=Math.PI),et<0&&(Mt+=Math.PI);let Et=et>0?Z+z:Z+z+1,yt=E,It=E,Ct=0,Vt=0;const sn=Math.abs(tt),ni=[],Xt=[];let Ln=M;const zn=()=>{const tr=Et-et;return 0===Ct?M:new l.pointGeometry(de.getx(tr),de.gety(tr))},di=()=>Dr(zn(),Ln,It,sn-Ct+1,pe,Fe,He,$e.canonical);for(;Ct+Vt<=sn;){if(Et+=et,Et<Z||Et>=K)return null;if(It=yt,ni.push(yt),Je&&Xt.push(Ln||zn()),yt=De[Et],void 0===yt){Ln=new l.pointGeometry(de.getx(Et),de.gety(Et));const tr=Po(Ln,$e.canonical,pe,He,Fe);yt=tr.signedDistanceFromCamera>0?De[Et]=tr.point:di()}else Ln=null;Ct+=Vt,Vt=l.distance(It,yt)}Ln=Ln||new l.pointGeometry(de.getx(Et),de.gety(Et));const _n=zn();Ge&&Fe&&(De[Et]=yt=void 0===De[Et]?yt:di(),Vt=l.distance(It,yt));const li=(sn-Ct)/Vt,Un=Ln.sub(_n).mult(li)._add(_n),Ai=l.sub([],yt,It),gi=l.scaleAndAdd([],It,Ai,li);let $i=[0,0,1],vr=Ai[0],jr=Ai[1];if(ze&&($i=He.upVector($e.canonical,Un.x,Un.y),0!==$i[0]||0!==$i[1]||1!==$i[2])){const tr=[1,0,0],Kr=[0,1,0];tr[0]=$i[2],tr[1]=0,tr[2]=-$i[0],l.cross(Kr,$i,tr),l.normalize(tr,tr),l.normalize(Kr,Kr),vr=l.dot(Ai,tr),jr=l.dot(Ai,Kr)}if(u){const tr=l.cross([],$i,Ai);l.normalize(tr,tr),l.scaleAndAdd(gi,gi,tr,u*et)}const mo=Mt+Math.atan2(jr,vr);return ni.push(gi),Je&&Xt.push(Un),{point:gi,angle:mo,path:ni,tilePath:Xt,up:$i}}const ca=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function po(d,i){for(let u=0;u<d;u++){const m=i.length;i.resize(m+4),i.float32.set(ca,4*m)}}function xr(d,i,u){const m=i[0],E=i[1];return d[0]=u[0]*m+u[4]*E+u[12],d[1]=u[1]*m+u[5]*E+u[13],d[3]=u[3]*m+u[7]*E+u[15],d}const zr=100;class rs{constructor(i,u,m=new Nr(i.width+200,i.height+200,25),E=new Nr(i.width+200,i.height+200,25)){this.transform=i,this.grid=m,this.ignoredGrid=E,this.pitchfactor=Math.cos(i._pitch)*i.cameraToCenterDistance,this.screenRightBoundary=i.width+zr,this.screenBottomBoundary=i.height+zr,this.gridRightBoundary=i.width+200,this.gridBottomBoundary=i.height+200,this.fogState=u}placeCollisionBox(i,u,m,E,M,z,Z,K){let de=m.projectedAnchorX,pe=m.projectedAnchorY,De=m.projectedAnchorZ;const Fe=m.elevation,Je=m.tileID;if(Fe&&Je){const Et=i.getProjection().upVector(Je.canonical,m.tileAnchorX,m.tileAnchorY),yt=i.getProjection().upVectorScale(Je.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;de+=Et[0]*Fe*yt,pe+=Et[1]*Fe*yt,De+=Et[2]*Fe*yt}const Ge=this.projectAndGetPerspectiveRatio(Z,[de,pe,De],m.tileID,"globe"===i.projection.name||!!Fe||this.transform.pitch>0,i.getProjection()),He=z*Ge.perspectiveRatio,$e=(m.x1*u+E.x-m.padding)*He+Ge.point.x,ze=(m.y1*u+E.y-m.padding)*He+Ge.point.y,tt=(m.x2*u+E.x+m.padding)*He+Ge.point.x,et=(m.y2*u+E.y+m.padding)*He+Ge.point.y,Mt=Ge.perspectiveRatio<=.55||Ge.occluded;return!this.isInsideGrid($e,ze,tt,et)||!M&&this.grid.hitTest($e,ze,tt,et,K)||Mt?{box:[],offscreen:!1,occluded:Ge.occluded}:{box:[$e,ze,tt,et],offscreen:this.isOffscreen($e,ze,tt,et),occluded:!1}}placeCollisionCircles(i,u,m,E,M,z,Z,K,de,pe,De,Fe,Je,Ge,He){const $e=[],ze=this.transform.elevation,tt=ze?ze.getAtTileOffsetFunc(He,this.transform.center.lat,this.transform.worldSize,i.getProjection()):_n=>[0,0,0],et=new l.pointGeometry(m.tileAnchorX,m.tileAnchorY),Mt=i.getProjection().projectTilePoint(m.tileAnchorX,m.tileAnchorY,He.canonical),Et=tt(et),yt=[Mt.x+Et[0],Mt.y+Et[1],Mt.z+Et[2]],It="globe"===i.projection.name,Ct=this.projectAndGetPerspectiveRatio(Z,[yt[0],yt[1],yt[2]],He,It||!!ze||this.transform.pitch>0,i.getProjection()),{perspectiveRatio:Vt}=Ct,sn=(De?z/Vt:z*Vt)/l.ONE_EM,ni=yi(new l.pointGeometry(yt[0],yt[1]),K,yt[2]).point,Xt=Ct.signedDistanceFromCamera>0?Hi(sn,M,m.lineOffsetX*sn,m.lineOffsetY*sn,!1,ni,et,m,E,K,{},ze&&!De?tt:null,De&&!!ze,i.getProjection(),He,De):null;let Ln=!1,zn=!1,di=!0;if(Xt&&!Ct.occluded){const _n=.5*Je*Vt+Ge,li=new l.pointGeometry(-100,-100),Un=new l.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),Ai=new Mr,gi=Xt.first,$i=Xt.last;let vr=[];for(let tr=gi.path.length-1;tr>=1;tr--)vr.push(gi.path[tr]);for(let tr=1;tr<$i.path.length;tr++)vr.push($i.path[tr]);const jr=2.5*_n;if(de){const tr=vr.map(ze&&!It?(Kr,Ro)=>{const Es=tt(Ro<gi.path.length-1?gi.tilePath[gi.path.length-1-Ro]:$i.tilePath[Ro-gi.path.length+2]);return Kr[2]=Es[2],Ji(Kr,de)}:Kr=>Ji(Kr,de));vr=tr.some(Kr=>Kr.signedDistanceFromCamera<=0)?[]:tr.map(Kr=>Kr.point)}let mo=[];if(vr.length>0){const tr=vr.map(G=>new l.pointGeometry(G[0],G[1]));let Kr=1/0,Ro=-1/0,Es=1/0,Ks=-1/0;for(let G=0;G<tr.length;G++)Kr=Math.min(Kr,tr[G].x),Es=Math.min(Es,tr[G].y),Ro=Math.max(Ro,tr[G].x),Ks=Math.max(Ks,tr[G].y);mo=Kr>=li.x&&Ro<=Un.x&&Es>=li.y&&Ks<=Un.y?[tr]:Ro<li.x||Kr>Un.x||Ks<li.y||Es>Un.y?[]:l.clipLine([tr],li.x,li.y,Un.x,Un.y)}for(const tr of mo){Ai.reset(tr,.25*_n);let Kr=0;Kr=Ai.length<=.5*_n?1:Math.ceil(Ai.paddedLength/jr)+1;for(let Ro=0;Ro<Kr;Ro++){const Es=Ro/Math.max(Kr-1,1),Ks=Ai.lerp(Es),G=Ks.x+zr,P=Ks.y+zr;$e.push(G,P,_n,0);const S=G-_n,H=P-_n,me=G+_n,Ne=P+_n;if(di=di&&this.isOffscreen(S,H,me,Ne),zn=zn||this.isInsideGrid(S,H,me,Ne),!u&&this.grid.hitTestCircle(G,P,_n,Fe)&&(Ln=!0,!pe))return{circles:[],offscreen:!1,collisionDetected:Ln,occluded:!1}}}}return{circles:!pe&&Ln||!zn?[]:$e,offscreen:di,collisionDetected:Ln,occluded:Ct.occluded}}queryRenderedSymbols(i){if(0===i.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const u=[];let m=1/0,E=1/0,M=-1/0,z=-1/0;for(const pe of i){const De=new l.pointGeometry(pe.x+zr,pe.y+zr);m=Math.min(m,De.x),E=Math.min(E,De.y),M=Math.max(M,De.x),z=Math.max(z,De.y),u.push(De)}const Z=this.grid.query(m,E,M,z).concat(this.ignoredGrid.query(m,E,M,z)),K={},de={};for(const pe of Z){const De=pe.key;if(void 0===K[De.bucketInstanceId]&&(K[De.bucketInstanceId]={}),K[De.bucketInstanceId][De.featureIndex])continue;const Fe=[new l.pointGeometry(pe.x1,pe.y1),new l.pointGeometry(pe.x2,pe.y1),new l.pointGeometry(pe.x2,pe.y2),new l.pointGeometry(pe.x1,pe.y2)];l.polygonIntersectsPolygon(u,Fe)&&(K[De.bucketInstanceId][De.featureIndex]=!0,void 0===de[De.bucketInstanceId]&&(de[De.bucketInstanceId]=[]),de[De.bucketInstanceId].push(De.featureIndex))}return de}insertCollisionBox(i,u,m,E,M){(u?this.ignoredGrid:this.grid).insert({bucketInstanceId:m,featureIndex:E,collisionGroupID:M},i[0],i[1],i[2],i[3])}insertCollisionCircles(i,u,m,E,M){const z=u?this.ignoredGrid:this.grid,Z={bucketInstanceId:m,featureIndex:E,collisionGroupID:M};for(let K=0;K<i.length;K+=4)z.insertCircle(Z,i[K],i[K+1],i[K+2])}projectAndGetPerspectiveRatio(i,u,m,E,M){const z=[u[0],u[1],u[2],1];let Z=!1;if(u[2]||this.transform.pitch>0){l.transformMat4$1(z,z,i);const K="globe"===M.name;this.fogState&&m&&!K&&(Z=function(de,pe,De,Fe,Je,Ge){const He=Ge.calculateFogTileMatrix(Je),$e=[pe,De,Fe];return l.transformMat4($e,$e,He),an(de,$e,Ge.pitch,Ge._fov)}(this.fogState,u[0],u[1],u[2],m.toUnwrapped(),this.transform)>.9)}else xr(z,z,i);return{point:new l.pointGeometry((z[0]/z[3]+1)/2*this.transform.width+zr,(-z[1]/z[3]+1)/2*this.transform.height+zr),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(M)/z[3]*.5,1.5),signedDistanceFromCamera:z[3],occluded:E&&z[2]>z[3]||Z}}isOffscreen(i,u,m,E){return m<zr||i>=this.screenRightBoundary||E<zr||u>this.screenBottomBoundary}isInsideGrid(i,u,m,E){return m>=0&&i<this.gridRightBoundary&&E>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const i=l.identity([]);return l.translate(i,i,[-100,-100,0]),i}}function vs(d,i,u){const m=i.createTileMatrix(d,d.worldSize,u.toUnwrapped());return l.multiply(new Float32Array(16),d.projMatrix,m)}function Ir(d,i,u){if(i.projection.name===u.projection.name)return d.projMatrix;const m=u.clone();return m.setProjection(i.projection),vs(m,i.getProjection(),d)}function Vo(d,i,u){return i.name===u.projection.name?d.projMatrix:vs(u,i,d)}class ya{constructor(i,u,m,E){this.opacity=i?Math.max(0,Math.min(1,i.opacity+(i.placed?u:-u))):E&&m?1:0,this.placed=m}isHidden(){return 0===this.opacity&&!this.placed}}class hs{constructor(i,u,m,E,M,z=!1){this.text=new ya(i?i.text:null,u,m,M),this.icon=new ya(i?i.icon:null,u,E,M),this.clipped=z}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class lo{constructor(i,u,m,E=!1){this.text=i,this.icon=u,this.skipFade=m,this.clipped=E}}class Qs{constructor(){this.invProjMatrix=l.create(),this.viewportMatrix=l.create(),this.circles=[]}}class va{constructor(i,u,m,E,M){this.bucketInstanceId=i,this.featureIndex=u,this.sourceLayerIndex=m,this.bucketIndex=E,this.tileID=M}}class ua{constructor(i){this.crossSourceCollisions=i,this.maxGroupID=0,this.collisionGroups={}}get(i){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[i]){const u=++this.maxGroupID;this.collisionGroups[i]={ID:u,predicate:m=>m.collisionGroupID===u}}return this.collisionGroups[i]}}function $o(d,i,u,m,E){const{horizontalAlign:M,verticalAlign:z}=l.getAnchorAlignment(d),Z=-(M-.5)*i,K=-(z-.5)*u,de=l.evaluateVariableOffset(d,m);return new l.pointGeometry(Z+de[0]*E,K+de[1]*E)}function ha(d,i,u,m,E){const M=new l.pointGeometry(d,i);return u&&M._rotate(m?E:-E),M}class ul{constructor(i,u,m,E,M){this.transform=i.clone(),this.projection=i.projection.name,this.collisionIndex=new rs(this.transform,M),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=u,this.retainedQueryData={},this.collisionGroups=new ua(m),this.collisionCircleArrays={},this.prevPlacement=E,E&&(E.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(i,u,m,E){const M=m.getBucket(u),z=m.latestFeatureIndex;if(!M||!z||u.id!==M.layerIds[0])return;const Z=M.layers[0].layout,K=m.collisionBoxArray,de=Math.pow(2,this.transform.zoom-m.tileID.overscaledZ),pe=m.tileSize/l.EXTENT,De=m.tileID.toUnwrapped();this.transform.setProjection(M.projection);const Fe=(Je=m.tileID,Ge=M.getProjection(),He=this.transform,Ge.name===this.projection?He.calculateProjMatrix(Je.toUnwrapped()):vs(He,Ge,Je));var Je,Ge,He;const $e="map"===Z.get("text-pitch-alignment"),ze="map"===Z.get("text-rotation-alignment");u.compileFilter();const tt=u.dynamicFilter(),et=u.dynamicFilterNeedsFeature(),Mt=this.transform.calculatePixelsToTileUnitsMatrix(m),Et=Xi(Fe,m.tileID.canonical,$e,ze,this.transform,M.getProjection(),Mt);let yt=null;if($e){const Vt=Gi(Fe,m.tileID.canonical,$e,ze,this.transform,M.getProjection(),Mt);yt=l.multiply([],this.transform.labelPlaneMatrix,Vt)}let It=null;tt&&m.latestFeatureIndex&&(It={unwrappedTileID:De,dynamicFilter:tt,dynamicFilterNeedsFeature:et,featureIndex:m.latestFeatureIndex}),this.retainedQueryData[M.bucketInstanceId]=new va(M.bucketInstanceId,z,M.sourceLayerIndex,M.index,m.tileID);const Ct={bucket:M,layout:Z,posMatrix:Fe,textLabelPlaneMatrix:Et,labelToScreenMatrix:yt,clippingData:It,scale:de,textPixelRatio:pe,holdingForFade:m.holdingForFade(),collisionBoxArray:K,partiallyEvaluatedTextSize:l.evaluateSizeForZoom(M.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:l.evaluateSizeForZoom(M.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(M.sourceID)};if(E)for(const Vt of M.sortKeyRanges){const{sortKey:sn,symbolInstanceStart:ni,symbolInstanceEnd:Xt}=Vt;i.push({sortKey:sn,symbolInstanceStart:ni,symbolInstanceEnd:Xt,parameters:Ct})}else i.push({symbolInstanceStart:0,symbolInstanceEnd:M.symbolInstances.length,parameters:Ct})}attemptAnchorPlacement(i,u,m,E,M,z,Z,K,de,pe,De,Fe,Je,Ge,He,$e,ze,tt){const et=[Fe.textOffset0,Fe.textOffset1],Mt=$o(i,m,E,et,M),Et=this.collisionIndex.placeCollisionBox(Ge,M,u,ha(Mt.x,Mt.y,z,Z,this.transform.angle),De,K,de,pe.predicate);if((!$e||0!==this.collisionIndex.placeCollisionBox(Ge,Ge.getSymbolInstanceIconSize(tt,this.transform.zoom,Je),$e,ha(Mt.x,Mt.y,z,Z,this.transform.angle),De,K,de,pe.predicate).box.length)&&Et.box.length>0){let yt;return this.prevPlacement&&this.prevPlacement.variableOffsets[Fe.crossTileID]&&this.prevPlacement.placements[Fe.crossTileID]&&this.prevPlacement.placements[Fe.crossTileID].text&&(yt=this.prevPlacement.variableOffsets[Fe.crossTileID].anchor),this.variableOffsets[Fe.crossTileID]={textOffset:et,width:m,height:E,anchor:i,textScale:M,prevAnchor:yt},this.markUsedJustification(Ge,i,Fe,He),Ge.allowVerticalPlacement&&(this.markUsedOrientation(Ge,He,Fe),this.placedOrientations[Fe.crossTileID]=He),{shift:Mt,placedGlyphBoxes:Et}}}placeLayerBucketPart(i,u,m,E){const{bucket:M,layout:z,posMatrix:Z,textLabelPlaneMatrix:K,labelToScreenMatrix:de,clippingData:pe,textPixelRatio:De,holdingForFade:Fe,collisionBoxArray:Je,partiallyEvaluatedTextSize:Ge,partiallyEvaluatedIconSize:He,collisionGroup:$e}=i.parameters,ze=z.get("text-optional"),tt=z.get("icon-optional"),et=z.get("text-allow-overlap"),Mt=z.get("icon-allow-overlap"),Et="map"===z.get("text-rotation-alignment"),yt="map"===z.get("text-pitch-alignment"),It="none"!==z.get("icon-text-fit"),Ct="viewport-y"===z.get("symbol-z-order");this.transform.setProjection(M.projection);let Vt=et&&(Mt||!M.hasIconData()||tt),sn=Mt&&(et||!M.hasTextData()||ze);!M.collisionArrays&&Je&&M.deserializeCollisionBoxes(Je),m&&E&&M.updateCollisionDebugBuffers(this.transform.zoom,Je);const ni=(Xt,Ln,zn)=>{if(pe){const me={zoom:this.transform.zoom,pitch:this.transform.pitch};let Ne=null;if(pe.dynamicFilterNeedsFeature){const Qe=this.retainedQueryData[M.bucketInstanceId];Ne=pe.featureIndex.loadFeature({featureIndex:Xt.featureIndex,bucketIndex:Qe.bucketIndex,sourceLayerIndex:Qe.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,pe.dynamicFilter)(me,Ne,this.retainedQueryData[M.bucketInstanceId].tileID.canonical,new l.pointGeometry(Xt.tileAnchorX,Xt.tileAnchorY),this.transform.calculateDistanceTileData(pe.unwrappedTileID)))return this.placements[Xt.crossTileID]=new lo(!1,!1,!1,!0),void(u[Xt.crossTileID]=!0)}if(u[Xt.crossTileID])return;if(Fe)return void(this.placements[Xt.crossTileID]=new lo(!1,!1,!1));let di=!1,_n=!1,li=!0,Un=!1,Ai=!1,gi=null,$i={box:null,offscreen:null,occluded:null},vr={box:null,offscreen:null,occluded:null},jr=null,mo=null,tr=null,Kr=0,Ro=0,Es=0;zn.textFeatureIndex?Kr=zn.textFeatureIndex:Xt.useRuntimeCollisionCircles&&(Kr=Xt.featureIndex),zn.verticalTextFeatureIndex&&(Ro=zn.verticalTextFeatureIndex);const Ks=me=>{me.tileID=this.retainedQueryData[M.bucketInstanceId].tileID,(this.transform.elevation||me.elevation)&&(me.elevation=this.transform.elevation?this.transform.elevation.getAtTileOffset(this.retainedQueryData[M.bucketInstanceId].tileID,me.tileAnchorX,me.tileAnchorY):0)},G=zn.textBox;if(G){Ks(G);const me=Qe=>{let pt=l.WritingMode.horizontal;if(M.allowVerticalPlacement&&!Qe&&this.prevPlacement){const Qt=this.prevPlacement.placedOrientations[Xt.crossTileID];Qt&&(this.placedOrientations[Xt.crossTileID]=Qt,pt=Qt,this.markUsedOrientation(M,pt,Xt))}return pt},Ne=(Qe,pt)=>{if(M.allowVerticalPlacement&&Xt.numVerticalGlyphVertices>0&&zn.verticalTextBox){for(const Qt of M.writingModes)if(Qt===l.WritingMode.vertical?($i=pt(),vr=$i):$i=Qe(),$i&&$i.box&&$i.box.length)break}else $i=Qe()};if(z.get("text-variable-anchor")){let Qe=z.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Xt.crossTileID]){const mn=this.prevPlacement.variableOffsets[Xt.crossTileID];Qe.indexOf(mn.anchor)>0&&(Qe=Qe.filter(Ri=>Ri!==mn.anchor),Qe.unshift(mn.anchor))}const pt=(mn,Ri,ar)=>{const Pr=M.getSymbolInstanceTextSize(Ge,Xt,this.transform.zoom,Ln),oo=(mn.x2-mn.x1)*Pr+2*mn.padding,kr=(mn.y2-mn.y1)*Pr+2*mn.padding,Or=It&&!Mt?Ri:null;Or&&Ks(Or);let _r={box:[],offscreen:!1,occluded:!1};const Lo=et?2*Qe.length:Qe.length;for(let qo=0;qo<Lo;++qo){const ia=this.attemptAnchorPlacement(Qe[qo%Qe.length],mn,oo,kr,Pr,Et,yt,De,Z,$e,qo>=Qe.length,Xt,Ln,M,ar,Or,Ge,He);if(ia&&(_r=ia.placedGlyphBoxes,_r&&_r.box&&_r.box.length)){di=!0,gi=ia.shift;break}}return _r};Ne(()=>pt(G,zn.iconBox,l.WritingMode.horizontal),()=>{const mn=zn.verticalTextBox;return mn&&Ks(mn),M.allowVerticalPlacement&&!($i&&$i.box&&$i.box.length)&&Xt.numVerticalGlyphVertices>0&&mn?pt(mn,zn.verticalIconBox,l.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),$i&&(di=$i.box,li=$i.offscreen,Un=$i.occluded);const Qt=me($i&&$i.box);if(!di&&this.prevPlacement){const mn=this.prevPlacement.variableOffsets[Xt.crossTileID];mn&&(this.variableOffsets[Xt.crossTileID]=mn,this.markUsedJustification(M,mn.anchor,Xt,Qt))}}else{const Qe=(pt,Qt)=>{const mn=M.getSymbolInstanceTextSize(Ge,Xt,this.transform.zoom,Ln),Ri=this.collisionIndex.placeCollisionBox(M,mn,pt,new l.pointGeometry(0,0),et,De,Z,$e.predicate);return Ri&&Ri.box&&Ri.box.length&&(this.markUsedOrientation(M,Qt,Xt),this.placedOrientations[Xt.crossTileID]=Qt),Ri};Ne(()=>Qe(G,l.WritingMode.horizontal),()=>{const pt=zn.verticalTextBox;return M.allowVerticalPlacement&&Xt.numVerticalGlyphVertices>0&&pt?(Ks(pt),Qe(pt,l.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),me($i&&$i.box&&$i.box.length)}}if(jr=$i,di=jr&&jr.box&&jr.box.length>0,li=jr&&jr.offscreen,Un=jr&&jr.occluded,Xt.useRuntimeCollisionCircles){const me=M.text.placedSymbolArray.get(Xt.centerJustifiedTextSymbolIndex>=0?Xt.centerJustifiedTextSymbolIndex:Xt.verticalPlacedTextSymbolIndex),Ne=l.evaluateSizeForFeature(M.textSizeData,Ge,me),Qe=z.get("text-padding");mo=this.collisionIndex.placeCollisionCircles(M,et,me,M.lineVertexArray,M.glyphOffsetArray,Ne,Z,K,de,m,yt,$e.predicate,Xt.collisionCircleDiameter*Ne/l.ONE_EM,Qe,this.retainedQueryData[M.bucketInstanceId].tileID),di=et||mo.circles.length>0&&!mo.collisionDetected,li=li&&mo.offscreen,Un=mo.occluded}if(zn.iconFeatureIndex&&(Es=zn.iconFeatureIndex),zn.iconBox){const me=Ne=>{Ks(Ne);const Qe=It&&gi?ha(gi.x,gi.y,Et,yt,this.transform.angle):new l.pointGeometry(0,0),pt=M.getSymbolInstanceIconSize(He,this.transform.zoom,Ln);return this.collisionIndex.placeCollisionBox(M,pt,Ne,Qe,Mt,De,Z,$e.predicate)};vr&&vr.box&&vr.box.length&&zn.verticalIconBox?(tr=me(zn.verticalIconBox),_n=tr.box.length>0):(tr=me(zn.iconBox),_n=tr.box.length>0),li=li&&tr.offscreen,Ai=tr.occluded}const P=ze||0===Xt.numHorizontalGlyphVertices&&0===Xt.numVerticalGlyphVertices,S=tt||0===Xt.numIconVertices;if(P||S?S?P||(_n=_n&&di):di=_n&&di:_n=di=_n&&di,di&&jr&&jr.box&&this.collisionIndex.insertCollisionBox(jr.box,z.get("text-ignore-placement"),M.bucketInstanceId,vr&&vr.box&&Ro?Ro:Kr,$e.ID),_n&&tr&&this.collisionIndex.insertCollisionBox(tr.box,z.get("icon-ignore-placement"),M.bucketInstanceId,Es,$e.ID),mo&&(di&&this.collisionIndex.insertCollisionCircles(mo.circles,z.get("text-ignore-placement"),M.bucketInstanceId,Kr,$e.ID),m)){const me=M.bucketInstanceId;let Ne=this.collisionCircleArrays[me];void 0===Ne&&(Ne=this.collisionCircleArrays[me]=new Qs);for(let Qe=0;Qe<mo.circles.length;Qe+=4)Ne.circles.push(mo.circles[Qe+0]),Ne.circles.push(mo.circles[Qe+1]),Ne.circles.push(mo.circles[Qe+2]),Ne.circles.push(mo.collisionDetected?1:0)}const H="globe"!==M.projection.name;Vt=Vt&&(H||!Un),sn=sn&&(H||!Ai),this.placements[Xt.crossTileID]=new lo(di||Vt,_n||sn,li||M.justReloaded),u[Xt.crossTileID]=!0};if(Ct){const Xt=M.getSortedSymbolIndexes(this.transform.angle);for(let Ln=Xt.length-1;Ln>=0;--Ln){const zn=Xt[Ln];ni(M.symbolInstances.get(zn),zn,M.collisionArrays[zn])}}else for(let Xt=i.symbolInstanceStart;Xt<i.symbolInstanceEnd;Xt++)ni(M.symbolInstances.get(Xt),Xt,M.collisionArrays[Xt]);if(m&&M.bucketInstanceId in this.collisionCircleArrays){const Xt=this.collisionCircleArrays[M.bucketInstanceId];l.invert(Xt.invProjMatrix,Z),Xt.viewportMatrix=this.collisionIndex.getViewportMatrix()}M.justReloaded=!1}markUsedJustification(i,u,m,E){let M;M=E===l.WritingMode.vertical?m.verticalPlacedTextSymbolIndex:{left:m.leftJustifiedTextSymbolIndex,center:m.centerJustifiedTextSymbolIndex,right:m.rightJustifiedTextSymbolIndex}[l.getAnchorJustification(u)];const z=[m.leftJustifiedTextSymbolIndex,m.centerJustifiedTextSymbolIndex,m.rightJustifiedTextSymbolIndex,m.verticalPlacedTextSymbolIndex];for(const Z of z)Z>=0&&(i.text.placedSymbolArray.get(Z).crossTileID=M>=0&&Z!==M?0:m.crossTileID)}markUsedOrientation(i,u,m){const E=u===l.WritingMode.horizontal||u===l.WritingMode.horizontalOnly?u:0,M=u===l.WritingMode.vertical?u:0,z=[m.leftJustifiedTextSymbolIndex,m.centerJustifiedTextSymbolIndex,m.rightJustifiedTextSymbolIndex];for(const Z of z)i.text.placedSymbolArray.get(Z).placedOrientation=E;m.verticalPlacedTextSymbolIndex&&(i.text.placedSymbolArray.get(m.verticalPlacedTextSymbolIndex).placedOrientation=M)}commit(i){this.commitTime=i,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let m=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const E=u?u.symbolFadeChange(i):1,M=u?u.opacities:{},z=u?u.variableOffsets:{},Z=u?u.placedOrientations:{};for(const K in this.placements){const de=this.placements[K],pe=M[K];pe?(this.opacities[K]=new hs(pe,E,de.text,de.icon,null,de.clipped),m=m||de.text!==pe.text.placed||de.icon!==pe.icon.placed):(this.opacities[K]=new hs(null,E,de.text,de.icon,de.skipFade,de.clipped),m=m||de.text||de.icon)}for(const K in M){const de=M[K];if(!this.opacities[K]){const pe=new hs(de,E,!1,!1);pe.isHidden()||(this.opacities[K]=pe,m=m||de.text.placed||de.icon.placed)}}for(const K in z)this.variableOffsets[K]||!this.opacities[K]||this.opacities[K].isHidden()||(this.variableOffsets[K]=z[K]);for(const K in Z)this.placedOrientations[K]||!this.opacities[K]||this.opacities[K].isHidden()||(this.placedOrientations[K]=Z[K]);m?this.lastPlacementChangeTime=i:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:i)}updateLayerOpacities(i,u){const m={};for(const E of u){const M=E.getBucket(i);M&&E.latestFeatureIndex&&i.id===M.layerIds[0]&&this.updateBucketOpacities(M,m,E.collisionBoxArray)}}updateBucketOpacities(i,u,m){i.hasTextData()&&i.text.opacityVertexArray.clear(),i.hasIconData()&&i.icon.opacityVertexArray.clear(),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexArray.clear(),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexArray.clear();const E=i.layers[0].layout,M=!!i.layers[0].dynamicFilter(),z=new hs(null,0,!1,!1,!0),Z=E.get("text-allow-overlap"),K=E.get("icon-allow-overlap"),de=E.get("text-variable-anchor"),pe="map"===E.get("text-rotation-alignment"),De="map"===E.get("text-pitch-alignment"),Fe="none"!==E.get("icon-text-fit"),Je=new hs(null,0,Z&&(K||!i.hasIconData()||E.get("icon-optional")),K&&(Z||!i.hasTextData()||E.get("text-optional")),!0);!i.collisionArrays&&m&&(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData())&&i.deserializeCollisionBoxes(m);const Ge=($e,ze,tt)=>{for(let et=0;et<ze/4;et++)$e.opacityVertexArray.emplaceBack(tt)};let He=0;for(let $e=0;$e<i.symbolInstances.length;$e++){const ze=i.symbolInstances.get($e),{numHorizontalGlyphVertices:tt,numVerticalGlyphVertices:et,crossTileID:Mt}=ze;let Et=this.opacities[Mt];u[Mt]?Et=z:Et||(Et=Je,this.opacities[Mt]=Et),u[Mt]=!0;const yt=tt>0||et>0,It=ze.numIconVertices>0,Ct=this.placedOrientations[ze.crossTileID],Vt=Ct===l.WritingMode.vertical,sn=Ct===l.WritingMode.horizontal||Ct===l.WritingMode.horizontalOnly;if(!yt&&!It||Et.isHidden()||He++,yt){const ni=Oo(Et.text);Ge(i.text,tt,Vt?Mo:ni),Ge(i.text,et,sn?Mo:ni);const Xt=Et.text.isHidden();[ze.rightJustifiedTextSymbolIndex,ze.centerJustifiedTextSymbolIndex,ze.leftJustifiedTextSymbolIndex].forEach(di=>{di>=0&&(i.text.placedSymbolArray.get(di).hidden=Xt||Vt?1:0)}),ze.verticalPlacedTextSymbolIndex>=0&&(i.text.placedSymbolArray.get(ze.verticalPlacedTextSymbolIndex).hidden=Xt||sn?1:0);const Ln=this.variableOffsets[ze.crossTileID];Ln&&this.markUsedJustification(i,Ln.anchor,ze,Ct);const zn=this.placedOrientations[ze.crossTileID];zn&&(this.markUsedJustification(i,"left",ze,zn),this.markUsedOrientation(i,zn,ze))}if(It){const ni=Oo(Et.icon);ze.placedIconSymbolIndex>=0&&(Ge(i.icon,ze.numIconVertices,Vt?Mo:ni),i.icon.placedSymbolArray.get(ze.placedIconSymbolIndex).hidden=Et.icon.isHidden()),ze.verticalPlacedIconSymbolIndex>=0&&(Ge(i.icon,ze.numVerticalIconVertices,sn?Mo:ni),i.icon.placedSymbolArray.get(ze.verticalPlacedIconSymbolIndex).hidden=Et.icon.isHidden())}if(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData()){const ni=i.collisionArrays[$e];if(ni){let Xt=new l.pointGeometry(0,0),Ln=!0;if(ni.textBox||ni.verticalTextBox){if(de){const di=this.variableOffsets[Mt];di?(Xt=$o(di.anchor,di.width,di.height,di.textOffset,di.textScale),pe&&Xt._rotate(De?this.transform.angle:-this.transform.angle)):Ln=!1}M&&(Ln=!Et.clipped),ni.textBox&&Qi(i.textCollisionBox.collisionVertexArray,Et.text.placed,!Ln||Vt,Xt.x,Xt.y),ni.verticalTextBox&&Qi(i.textCollisionBox.collisionVertexArray,Et.text.placed,!Ln||sn,Xt.x,Xt.y)}const zn=Ln&&Boolean(!sn&&ni.verticalIconBox);ni.iconBox&&Qi(i.iconCollisionBox.collisionVertexArray,Et.icon.placed,zn,Fe?Xt.x:0,Fe?Xt.y:0),ni.verticalIconBox&&Qi(i.iconCollisionBox.collisionVertexArray,Et.icon.placed,!zn,Fe?Xt.x:0,Fe?Xt.y:0)}}}if(i.fullyClipped=0===He,i.sortFeatures(this.transform.angle),this.retainedQueryData[i.bucketInstanceId]&&(this.retainedQueryData[i.bucketInstanceId].featureSortOrder=i.featureSortOrder),i.hasTextData()&&i.text.opacityVertexBuffer&&i.text.opacityVertexBuffer.updateData(i.text.opacityVertexArray),i.hasIconData()&&i.icon.opacityVertexBuffer&&i.icon.opacityVertexBuffer.updateData(i.icon.opacityVertexArray),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexBuffer&&i.iconCollisionBox.collisionVertexBuffer.updateData(i.iconCollisionBox.collisionVertexArray),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexBuffer&&i.textCollisionBox.collisionVertexBuffer.updateData(i.textCollisionBox.collisionVertexArray),i.bucketInstanceId in this.collisionCircleArrays){const $e=this.collisionCircleArrays[i.bucketInstanceId];i.placementInvProjMatrix=$e.invProjMatrix,i.placementViewportMatrix=$e.viewportMatrix,i.collisionCircleArray=$e.circles,delete this.collisionCircleArrays[i.bucketInstanceId]}}symbolFadeChange(i){return 0===this.fadeDuration?1:(i-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(i){return Math.max(0,(this.transform.zoom-i)/1.5)}hasTransitions(i){return this.stale||i-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(i,u){const m=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*m>i}setStale(){this.stale=!0}}function Qi(d,i,u,m,E){d.emplaceBack(i?1:0,u?1:0,m||0,E||0),d.emplaceBack(i?1:0,u?1:0,m||0,E||0),d.emplaceBack(i?1:0,u?1:0,m||0,E||0),d.emplaceBack(i?1:0,u?1:0,m||0,E||0)}const zs=Math.pow(2,25),Qr=Math.pow(2,24),da=Math.pow(2,17),Da=Math.pow(2,16),Us=Math.pow(2,9),Sa=Math.pow(2,8),qs=Math.pow(2,1);function Oo(d){if(0===d.opacity&&!d.placed)return 0;if(1===d.opacity&&d.placed)return 4294967295;const i=d.placed?1:0,u=Math.floor(127*d.opacity);return u*zs+i*Qr+u*da+i*Da+u*Us+i*Sa+u*qs+i}const Mo=0;class eo{constructor(i){this._sortAcrossTiles="viewport-y"!==i.layout.get("symbol-z-order")&&void 0!==i.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(i,u,m,E,M){const z=this._bucketParts;for(;this._currentTileIndex<i.length;)if(u.getBucketParts(z,E,i[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,M())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,z.sort((Z,K)=>Z.sortKey-K.sortKey));this._currentPartIndex<z.length;){const Z=z[this._currentPartIndex];if(u.placeLayerBucketPart(Z,this._seenCrossTileIDs,m,0===Z.symbolInstanceStart),this._currentPartIndex++,M())return!0}return!1}}class Xo{constructor(i,u,m,E,M,z,Z,K){this.placement=new ul(i,M,z,Z,K),this._currentPlacementIndex=u.length-1,this._forceFullPlacement=m,this._showCollisionBoxes=E,this._done=!1}isDone(){return this._done}continuePlacement(i,u,m){const E=l.exported.now(),M=()=>{const z=l.exported.now()-E;return!this._forceFullPlacement&&z>2};for(;this._currentPlacementIndex>=0;){const z=u[i[this._currentPlacementIndex]],Z=this.placement.collisionIndex.transform.zoom;if("symbol"===z.type&&(!z.minzoom||z.minzoom<=Z)&&(!z.maxzoom||z.maxzoom>Z)){if(this._inProgressLayer||(this._inProgressLayer=new eo(z)),this._inProgressLayer.continuePlacement(m[z.source],this.placement,this._showCollisionBoxes,z,M))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(i){return this.placement.commit(i),this.placement}}const As=512/l.EXTENT/2;class Ms{constructor(i,u,m){this.tileID=i,this.indexedSymbolInstances={},this.bucketInstanceId=m;for(let E=0;E<u.length;E++){const M=u.get(E),z=M.key;this.indexedSymbolInstances[z]||(this.indexedSymbolInstances[z]=[]),this.indexedSymbolInstances[z].push({crossTileID:M.crossTileID,coord:this.getScaledCoordinates(M,i)})}}getScaledCoordinates(i,u){const m=As/Math.pow(2,u.canonical.z-this.tileID.canonical.z);return{x:Math.floor((u.canonical.x*l.EXTENT+i.tileAnchorX)*m),y:Math.floor((u.canonical.y*l.EXTENT+i.tileAnchorY)*m)}}findMatches(i,u,m){const E=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z);for(let M=0;M<i.length;M++){const z=i.get(M);if(z.crossTileID)continue;const Z=this.indexedSymbolInstances[z.key];if(!Z)continue;const K=this.getScaledCoordinates(z,u);for(const de of Z)if(Math.abs(de.coord.x-K.x)<=E&&Math.abs(de.coord.y-K.y)<=E&&!m[de.crossTileID]){m[de.crossTileID]=!0,z.crossTileID=de.crossTileID;break}}}}class Pl{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Aa{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(i){const u=Math.round((i-this.lng)/360);if(0!==u)for(const m in this.indexes){const E=this.indexes[m],M={};for(const z in E){const Z=E[z];Z.tileID=Z.tileID.unwrapTo(Z.tileID.wrap+u),M[Z.tileID.key]=Z}this.indexes[m]=M}this.lng=i}addBucket(i,u,m){if(this.indexes[i.overscaledZ]&&this.indexes[i.overscaledZ][i.key]){if(this.indexes[i.overscaledZ][i.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(i.overscaledZ,this.indexes[i.overscaledZ][i.key])}for(let M=0;M<u.symbolInstances.length;M++)u.symbolInstances.get(M).crossTileID=0;this.usedCrossTileIDs[i.overscaledZ]||(this.usedCrossTileIDs[i.overscaledZ]={});const E=this.usedCrossTileIDs[i.overscaledZ];for(const M in this.indexes){const z=this.indexes[M];if(Number(M)>i.overscaledZ)for(const Z in z){const K=z[Z];K.tileID.isChildOf(i)&&K.findMatches(u.symbolInstances,i,E)}else{const Z=z[i.scaledTo(Number(M)).key];Z&&Z.findMatches(u.symbolInstances,i,E)}}for(let M=0;M<u.symbolInstances.length;M++){const z=u.symbolInstances.get(M);z.crossTileID||(z.crossTileID=m.generate(),E[z.crossTileID]=!0)}return void 0===this.indexes[i.overscaledZ]&&(this.indexes[i.overscaledZ]={}),this.indexes[i.overscaledZ][i.key]=new Ms(i,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(i,u){for(const m in u.indexedSymbolInstances)for(const E of u.indexedSymbolInstances[m])delete this.usedCrossTileIDs[i][E.crossTileID]}removeStaleBuckets(i){let u=!1;for(const m in this.indexes){const E=this.indexes[m];for(const M in E)i[E[M].bucketInstanceId]||(this.removeBucketCrossTileIDs(m,E[M]),delete E[M],u=!0)}return u}}class ds{constructor(){this.layerIndexes={},this.crossTileIDs=new Pl,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(i,u,m,E){let M=this.layerIndexes[i.id];void 0===M&&(M=this.layerIndexes[i.id]=new Aa);let z=!1;const Z={};"globe"!==E.name&&M.handleWrapJump(m);for(const K of u){const de=K.getBucket(i);de&&i.id===de.layerIds[0]&&(de.bucketInstanceId||(de.bucketInstanceId=++this.maxBucketInstanceId),M.addBucket(K.tileID,de,this.crossTileIDs)&&(z=!0),Z[de.bucketInstanceId]=!0)}return M.removeStaleBuckets(Z)&&(z=!0),z}pruneUnusedLayers(i){const u={};i.forEach(m=>{u[m]=!0});for(const m in this.layerIndexes)u[m]||delete this.layerIndexes[m]}}const ea=(d,i)=>l.emitValidationErrors(d,i&&i.filter(u=>"source.canvas"!==u.identifier)),Vs=l.pick(Xn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Wr=l.pick(Xn,["setCenter","setZoom","setBearing","setPitch"]),fs={version:8,layers:[],sources:{}},js={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class ps extends l.Evented{constructor(i,u={}){super(),this.map=i,this.dispatcher=new mr(In(),this),this.imageManager=new Wi,this.imageManager.setEventedParent(this),this.glyphManager=new l.GlyphManager(i._requestManager,u.localFontFamily?l.LocalGlyphMode.all:u.localIdeographFontFamily?l.LocalGlyphMode.ideographs:l.LocalGlyphMode.none,u.localFontFamily||u.localIdeographFontFamily),this.lineAtlas=new l.LineAtlas(256,512),this.crossTileSymbolIndex=new ds,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this.zoomHistory=new l.ZoomHistory,this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",l.getReferrer());const m=this;this._rtlTextPluginCallback=ps.registerForPluginStateChange(E=>{m.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:E.pluginStatus,pluginURL:E.pluginURL},(M,z)=>{if(l.triggerPluginCompletionEvent(M),z&&z.every(Z=>Z))for(const Z in m._sourceCaches){const K=m._sourceCaches[Z],de=K.getSource().type;"vector"!==de&&"geojson"!==de||K.reload()}})}),this.on("data",E=>{if("source"!==E.dataType||"metadata"!==E.sourceDataType)return;const M=this.getSource(E.sourceId);if(M&&M.vectorLayerIds)for(const z in this._layers){const Z=this._layers[z];Z.source===M.id&&this._validateLayer(Z)}})}loadURL(i,u={}){this.fire(new l.Event("dataloading",{dataType:"style"}));const m="boolean"==typeof u.validate?u.validate:!l.isMapboxURL(i);i=this.map._requestManager.normalizeStyleURL(i,u.accessToken);const E=this.map._requestManager.transformRequest(i,l.ResourceType.Style);this._request=l.getJSON(E,(M,z)=>{this._request=null,M?this.fire(new l.ErrorEvent(M)):z&&this._load(z,m)})}loadJSON(i,u={}){this.fire(new l.Event("dataloading",{dataType:"style"})),this._request=l.exported.frame(()=>{this._request=null,this._load(i,!1!==u.validate)})}loadEmpty(){this.fire(new l.Event("dataloading",{dataType:"style"})),this._load(fs,!1)}_updateLayerCount(i,u){const m=u?1:-1;i.is3D()&&(this._num3DLayers+=m),"circle"===i.type&&(this._numCircleLayers+=m),"symbol"===i.type&&(this._numSymbolLayers+=m)}_load(i,u){if(u&&ea(this,l.validateStyle(i)))return;this._loaded=!0,this.stylesheet=l.clone$1(i),this._updateMapProjection();for(const E in i.sources)this.addSource(E,i.sources[E],{validate:!1});this._changed=!1,i.sprite?this._loadSprite(i.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(i.glyphs);const m=mi(this.stylesheet.layers);this._order=m.map(E=>E.id),this._layers={},this._serializedLayers={};for(let E of m)E=l.createStyleLayer(E),E.setEventedParent(this,{layer:{id:E.id}}),this._layers[E.id]=E,this._serializedLayers[E.id]=E.serialize(),this._updateLayerCount(E,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Ci(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new l.Event("data",{dataType:"style"})),this.fire(new l.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}setProjection(i){i?this.stylesheet.projection=i:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(i){this._spriteRequest=function(u,m,E){let M,z,Z;const K=l.exported.devicePixelRatio>1?"@2x":"";let de=l.getJSON(m.transformRequest(m.normalizeSpriteURL(u,K,".json"),l.ResourceType.SpriteJSON),(Fe,Je)=>{de=null,Z||(Z=Fe,M=Je,De())}),pe=l.getImage(m.transformRequest(m.normalizeSpriteURL(u,K,".png"),l.ResourceType.SpriteImage),(Fe,Je)=>{pe=null,Z||(Z=Fe,z=Je,De())});function De(){if(Z)E(Z);else if(M&&z){const Fe=l.exported.getImageData(z),Je={};for(const Ge in M){const{width:He,height:$e,x:ze,y:tt,sdf:et,pixelRatio:Mt,stretchX:Et,stretchY:yt,content:It}=M[Ge],Ct=new l.RGBAImage({width:He,height:$e});l.RGBAImage.copy(Fe,Ct,{x:ze,y:tt},{x:0,y:0},{width:He,height:$e}),Je[Ge]={data:Ct,pixelRatio:Mt,sdf:et,stretchX:Et,stretchY:yt,content:It}}E(null,Je)}}return{cancel(){de&&(de.cancel(),de=null),pe&&(pe.cancel(),pe=null)}}}(i,this.map._requestManager,(u,m)=>{if(this._spriteRequest=null,u)this.fire(new l.ErrorEvent(u));else if(m)for(const E in m)this.imageManager.addImage(E,m[E]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new l.Event("data",{dataType:"style"}))})}_validateLayer(i){const u=this.getSource(i.source);if(!u)return;const m=i.sourceLayer;m&&("geojson"===u.type||u.vectorLayerIds&&-1===u.vectorLayerIds.indexOf(m))&&this.fire(new l.ErrorEvent(new Error(`Source layer "${m}" does not exist on source "${u.id}" as specified by style layer "${i.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const i in this._sourceCaches)if(!this._sourceCaches[i].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(i){const u=[];for(const m of i){const E=this._layers[m];"custom"!==E.type&&u.push(E.serialize())}return u}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const i in this._sourceCaches)if(this._sourceCaches[i].hasTransition())return!0;for(const i in this._layers)if(this._layers[i].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(i){return!!this.terrain&&js[i.type]}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(i){if(!this._loaded)return;const u=this._changed;if(this._changed){const E=Object.keys(this._updatedLayers),M=Object.keys(this._removedLayers);(E.length||M.length)&&this._updateWorkerLayers(E,M);for(const z in this._updatedSources){const Z=this._updatedSources[z];"reload"===Z?this._reloadSource(z):"clear"===Z&&this._clearSource(z)}this._updateTilesForChangedImages();for(const z in this._updatedPaintProps)this._layers[z].updateTransitions(i);this.light.updateTransitions(i),this.fog&&this.fog.updateTransitions(i),this._resetUpdates()}const m={};for(const E in this._sourceCaches){const M=this._sourceCaches[E];m[E]=M.used,M.used=!1}for(const E of this._order){const M=this._layers[E];if(M.recalculate(i,this._availableImages),!M.isHidden(i.zoom)){const Z=this._getLayerSourceCache(M);Z&&(Z.used=!0)}const z=this.map.painter;if(z){const Z=M.getProgramIds();if(!Z)continue;const K=M.getProgramConfiguration(i.zoom);for(const de of Z)z.useProgram(de,K)}}for(const E in m){const M=this._sourceCaches[E];m[E]!==M.used&&M.getSource().fire(new l.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:M.getSource().id}))}this.light.recalculate(i),this.terrain&&this.terrain.recalculate(i),this.fog&&this.fog.recalculate(i),this.z=i.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),u&&this.fire(new l.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const i=Object.keys(this._changedImages);if(i.length){for(const u in this._sourceCaches)this._sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],i);this._changedImages={}}}_updateWorkerLayers(i,u){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(i),removedIds:u})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(i){if(this._checkLoaded(),ea(this,l.validateStyle(i)))return!1;(i=l.clone$1(i)).layers=mi(i.layers);const u=function(E,M){if(!E)return[{command:Xn.setStyle,args:[M]}];let z=[];try{if(!oe(E.version,M.version))return[{command:Xn.setStyle,args:[M]}];oe(E.center,M.center)||z.push({command:Xn.setCenter,args:[M.center]}),oe(E.zoom,M.zoom)||z.push({command:Xn.setZoom,args:[M.zoom]}),oe(E.bearing,M.bearing)||z.push({command:Xn.setBearing,args:[M.bearing]}),oe(E.pitch,M.pitch)||z.push({command:Xn.setPitch,args:[M.pitch]}),oe(E.sprite,M.sprite)||z.push({command:Xn.setSprite,args:[M.sprite]}),oe(E.glyphs,M.glyphs)||z.push({command:Xn.setGlyphs,args:[M.glyphs]}),oe(E.transition,M.transition)||z.push({command:Xn.setTransition,args:[M.transition]}),oe(E.light,M.light)||z.push({command:Xn.setLight,args:[M.light]}),oe(E.fog,M.fog)||z.push({command:Xn.setFog,args:[M.fog]}),oe(E.projection,M.projection)||z.push({command:Xn.setProjection,args:[M.projection]});const Z={},K=[];!function(De,Fe,Je,Ge){let He;for(He in Fe=Fe||{},De=De||{})De.hasOwnProperty(He)&&(Fe.hasOwnProperty(He)||Gr(He,Je,Ge));for(He in Fe)Fe.hasOwnProperty(He)&&(De.hasOwnProperty(He)?oe(De[He],Fe[He])||("geojson"===De[He].type&&"geojson"===Fe[He].type&&Rn(De,Fe,He)?Je.push({command:Xn.setGeoJSONSourceData,args:[He,Fe[He].data]}):gr(He,Fe,Je,Ge)):qt(He,Fe,Je))}(E.sources,M.sources,K,Z);const de=[];E.layers&&E.layers.forEach(De=>{De.source&&Z[De.source]?z.push({command:Xn.removeLayer,args:[De.id]}):de.push(De)});let pe=E.terrain;pe&&Z[pe.source]&&(z.push({command:Xn.setTerrain,args:[void 0]}),pe=void 0),z=z.concat(K),oe(pe,M.terrain)||z.push({command:Xn.setTerrain,args:[M.terrain]}),function(De,Fe,Je){Fe=Fe||[];const Ge=(De=De||[]).map(hr),He=Fe.map(hr),$e=De.reduce(Er,{}),ze=Fe.reduce(Er,{}),tt=Ge.slice(),et=Object.create(null);let Mt,Et,yt,It,Ct,Vt,sn;for(Mt=0,Et=0;Mt<Ge.length;Mt++)yt=Ge[Mt],ze.hasOwnProperty(yt)?Et++:(Je.push({command:Xn.removeLayer,args:[yt]}),tt.splice(tt.indexOf(yt,Et),1));for(Mt=0,Et=0;Mt<He.length;Mt++)yt=He[He.length-1-Mt],tt[tt.length-1-Mt]!==yt&&($e.hasOwnProperty(yt)?(Je.push({command:Xn.removeLayer,args:[yt]}),tt.splice(tt.lastIndexOf(yt,tt.length-Et),1)):Et++,Vt=tt[tt.length-Mt],Je.push({command:Xn.addLayer,args:[ze[yt],Vt]}),tt.splice(tt.length-Mt,0,yt),et[yt]=!0);for(Mt=0;Mt<He.length;Mt++)if(yt=He[Mt],It=$e[yt],Ct=ze[yt],!et[yt]&&!oe(It,Ct))if(oe(It.source,Ct.source)&&oe(It["source-layer"],Ct["source-layer"])&&oe(It.type,Ct.type)){for(sn in ti(It.layout,Ct.layout,Je,yt,null,Xn.setLayoutProperty),ti(It.paint,Ct.paint,Je,yt,null,Xn.setPaintProperty),oe(It.filter,Ct.filter)||Je.push({command:Xn.setFilter,args:[yt,Ct.filter]}),oe(It.minzoom,Ct.minzoom)&&oe(It.maxzoom,Ct.maxzoom)||Je.push({command:Xn.setLayerZoomRange,args:[yt,Ct.minzoom,Ct.maxzoom]}),It)It.hasOwnProperty(sn)&&"layout"!==sn&&"paint"!==sn&&"filter"!==sn&&"metadata"!==sn&&"minzoom"!==sn&&"maxzoom"!==sn&&(0===sn.indexOf("paint.")?ti(It[sn],Ct[sn],Je,yt,sn.slice(6),Xn.setPaintProperty):oe(It[sn],Ct[sn])||Je.push({command:Xn.setLayerProperty,args:[yt,sn,Ct[sn]]}));for(sn in Ct)Ct.hasOwnProperty(sn)&&!It.hasOwnProperty(sn)&&"layout"!==sn&&"paint"!==sn&&"filter"!==sn&&"metadata"!==sn&&"minzoom"!==sn&&"maxzoom"!==sn&&(0===sn.indexOf("paint.")?ti(It[sn],Ct[sn],Je,yt,sn.slice(6),Xn.setPaintProperty):oe(It[sn],Ct[sn])||Je.push({command:Xn.setLayerProperty,args:[yt,sn,Ct[sn]]}))}else Je.push({command:Xn.removeLayer,args:[yt]}),Vt=tt[tt.lastIndexOf(yt)+1],Je.push({command:Xn.addLayer,args:[Ct,Vt]})}(de,M.layers,z)}catch(Z){console.warn("Unable to compute style diff:",Z),z=[{command:Xn.setStyle,args:[M]}]}return z}(this.serialize(),i).filter(E=>!(E.command in Wr));if(0===u.length)return!1;const m=u.filter(E=>!(E.command in Vs));if(m.length>0)throw new Error(`Unimplemented: ${m.map(E=>E.command).join(", ")}.`);return u.forEach(E=>{"setTransition"!==E.command&&"setProjection"!==E.command&&this[E.command].apply(this,E.args)}),this.stylesheet=i,this._updateMapProjection(),!0}addImage(i,u){return this.getImage(i)?this.fire(new l.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(i,u),this._afterImageUpdated(i),this)}updateImage(i,u){this.imageManager.updateImage(i,u)}getImage(i){return this.imageManager.getImage(i)}removeImage(i){return this.getImage(i)?(this.imageManager.removeImage(i),this._afterImageUpdated(i),this):this.fire(new l.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(i){this._availableImages=this.imageManager.listImages(),this._changedImages[i]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(i,u,m={}){if(this._checkLoaded(),void 0!==this.getSource(i))throw new Error("There is already a source with this ID");if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(l.validateSource,`sources.${i}`,u,null,m))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const E=Kt(i,u,this.dispatcher,this);E.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(i),source:E.serialize(),sourceId:i}));const M=z=>{const Z=(z?"symbol:":"other:")+i,K=this._sourceCaches[Z]=new l.SourceCache(Z,E,z);(z?this._symbolSourceCaches:this._otherSourceCaches)[i]=K,K.style=this,K.onAdd(this.map)};M(!1),"vector"!==u.type&&"geojson"!==u.type||M(!0),E.onAdd&&E.onAdd(this.map),this._changed=!0}removeSource(i){this._checkLoaded();const u=this.getSource(i);if(!u)throw new Error("There is no source with this ID");for(const E in this._layers)if(this._layers[E].source===i)return this.fire(new l.ErrorEvent(new Error(`Source "${i}" cannot be removed while layer "${E}" is using it.`)));if(this.terrain&&this.terrain.get().source===i)return this.fire(new l.ErrorEvent(new Error(`Source "${i}" cannot be removed while terrain is using it.`)));const m=this._getSourceCaches(i);for(const E of m)delete this._sourceCaches[E.id],delete this._updatedSources[E.id],E.fire(new l.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:E.getSource().id})),E.setEventedParent(null),E.clearTiles();return delete this._otherSourceCaches[i],delete this._symbolSourceCaches[i],u.setEventedParent(null),u.onRemove&&u.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(i,u){this._checkLoaded(),this.getSource(i).setData(u),this._changed=!0}getSource(i){const u=this._getSourceCache(i);return u&&u.getSource()}addLayer(i,u,m={}){this._checkLoaded();const E=i.id;if(this.getLayer(E))return void this.fire(new l.ErrorEvent(new Error(`Layer with id "${E}" already exists on this map`)));let M;if("custom"===i.type){if(ea(this,l.validateCustomStyleLayer(i)))return;M=l.createStyleLayer(i)}else{if("object"==typeof i.source&&(this.addSource(E,i.source),i=l.clone$1(i),i=l.extend(i,{source:E})),this._validate(l.validateLayer,`layers.${E}`,i,{arrayIndex:-1},m))return;M=l.createStyleLayer(i),this._validateLayer(M),M.setEventedParent(this,{layer:{id:E}}),this._serializedLayers[M.id]=M.serialize(),this._updateLayerCount(M,!0)}const z=u?this._order.indexOf(u):this._order.length;if(u&&-1===z)return void this.fire(new l.ErrorEvent(new Error(`Layer with id "${u}" does not exist on this map.`)));this._order.splice(z,0,E),this._layerOrderChanged=!0,this._layers[E]=M;const Z=this._getLayerSourceCache(M);if(this._removedLayers[E]&&M.source&&Z&&"custom"!==M.type){const K=this._removedLayers[E];delete this._removedLayers[E],K.type!==M.type?this._updatedSources[M.source]="clear":(this._updatedSources[M.source]="reload",Z.pause())}this._updateLayer(M),M.onAdd&&M.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(i,u){if(this._checkLoaded(),this._changed=!0,!this._layers[i])return void this.fire(new l.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be moved.`)));if(i===u)return;const m=this._order.indexOf(i);this._order.splice(m,1);const E=u?this._order.indexOf(u):this._order.length;u&&-1===E?this.fire(new l.ErrorEvent(new Error(`Layer with id "${u}" does not exist on this map.`))):(this._order.splice(E,0,i),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(i){this._checkLoaded();const u=this._layers[i];if(!u)return void this.fire(new l.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be removed.`)));u.setEventedParent(null),this._updateLayerCount(u,!1);const m=this._order.indexOf(i);this._order.splice(m,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[i]=u,delete this._layers[i],delete this._serializedLayers[i],delete this._updatedLayers[i],delete this._updatedPaintProps[i],u.onRemove&&u.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(i){return this._layers[i]}hasLayer(i){return i in this._layers}hasLayerType(i){for(const u in this._layers)if(this._layers[u].type===i)return!0;return!1}setLayerZoomRange(i,u,m){this._checkLoaded();const E=this.getLayer(i);E?E.minzoom===u&&E.maxzoom===m||(null!=u&&(E.minzoom=u),null!=m&&(E.maxzoom=m),this._updateLayer(E)):this.fire(new l.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(i,u,m={}){this._checkLoaded();const E=this.getLayer(i);if(E){if(!oe(E.filter,u))return null==u?(E.filter=void 0,void this._updateLayer(E)):void(this._validate(l.validateFilter,`layers.${E.id}.filter`,u,{layerType:E.type},m)||(E.filter=l.clone$1(u),this._updateLayer(E)))}else this.fire(new l.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be filtered.`)))}getFilter(i){const u=this.getLayer(i);return u&&l.clone$1(u.filter)}setLayoutProperty(i,u,m,E={}){this._checkLoaded();const M=this.getLayer(i);M?oe(M.getLayoutProperty(u),m)||(M.setLayoutProperty(u,m,E),this._updateLayer(M)):this.fire(new l.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(i,u){const m=this.getLayer(i);if(m)return m.getLayoutProperty(u);this.fire(new l.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style.`)))}setPaintProperty(i,u,m,E={}){this._checkLoaded();const M=this.getLayer(i);M?oe(M.getPaintProperty(u),m)||(M.setPaintProperty(u,m,E)&&this._updateLayer(M),this._changed=!0,this._updatedPaintProps[i]=!0):this.fire(new l.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(i,u){const m=this.getLayer(i);return m&&m.getPaintProperty(u)}setFeatureState(i,u){this._checkLoaded();const m=i.source,E=i.sourceLayer,M=this.getSource(m);if(!M)return void this.fire(new l.ErrorEvent(new Error(`The source '${m}' does not exist in the map's style.`)));const z=M.type;if("geojson"===z&&E)return void this.fire(new l.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===z&&!E)return void this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===i.id&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided.")));const Z=this._getSourceCaches(m);for(const K of Z)K.setFeatureState(E,i.id,u)}removeFeatureState(i,u){this._checkLoaded();const m=i.source,E=this.getSource(m);if(!E)return void this.fire(new l.ErrorEvent(new Error(`The source '${m}' does not exist in the map's style.`)));const M=E.type,z="vector"===M?i.sourceLayer:void 0;if("vector"===M&&!z)return void this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(u&&"string"!=typeof i.id&&"number"!=typeof i.id)return void this.fire(new l.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const Z=this._getSourceCaches(m);for(const K of Z)K.removeFeatureState(z,i.id,u)}getFeatureState(i){this._checkLoaded();const u=i.source,m=i.sourceLayer,E=this.getSource(u);if(E){if("vector"!==E.type||m)return void 0===i.id&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(u)[0].getFeatureState(m,i.id);this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new l.ErrorEvent(new Error(`The source '${u}' does not exist in the map's style.`)))}getTransition(){return l.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const i={};for(const u in this._sourceCaches){const m=this._sourceCaches[u].getSource();i[m.id]||(i[m.id]=m.serialize())}return l.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.stylesheet.terrain,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:i,layers:this._serializeLayers(this._order)},u=>void 0!==u)}_updateLayer(i){this._updatedLayers[i.id]=!0;const u=this._getLayerSourceCache(i);i.source&&!this._updatedSources[i.source]&&u&&"raster"!==u.getSource().type&&(this._updatedSources[i.source]="reload",u.pause()),this._changed=!0,i.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(i){const u=z=>"fill-extrusion"===this._layers[z].type,m={},E=[];for(let z=this._order.length-1;z>=0;z--){const Z=this._order[z];if(u(Z)){m[Z]=z;for(const K of i){const de=K[Z];if(de)for(const pe of de)E.push(pe)}}}E.sort((z,Z)=>Z.intersectionZ-z.intersectionZ);const M=[];for(let z=this._order.length-1;z>=0;z--){const Z=this._order[z];if(u(Z))for(let K=E.length-1;K>=0;K--){const de=E[K].feature;if(m[de.layer.id]<z)break;M.push(de),E.pop()}else for(const K of i){const de=K[Z];if(de)for(const pe of de)M.push(pe.feature)}}return M}queryRenderedFeatures(i,u,m){u&&u.filter&&this._validate(l.validateFilter,"queryRenderedFeatures.filter",u.filter,null,u);const E={};if(u&&u.layers){if(!Array.isArray(u.layers))return this.fire(new l.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const K of u.layers){const de=this._layers[K];if(!de)return this.fire(new l.ErrorEvent(new Error(`The layer '${K}' does not exist in the map's style and cannot be queried for features.`))),[];E[de.source]=!0}}const M=[];u.availableImages=this._availableImages;const z=u&&u.layers?u.layers.some(K=>{const de=this.getLayer(K);return de&&de.is3D()}):this.has3DLayers(),Z=_i.createFromScreenPoints(i,m);for(const K in this._sourceCaches){const de=this._sourceCaches[K].getSource().id;u.layers&&!E[de]||M.push(xe(this._sourceCaches[K],this._layers,this._serializedLayers,Z,u,m,z,!!this.map._showQueryGeometry))}return this.placement&&M.push(function(K,de,pe,De,Fe,Je,Ge){const He={},$e=Je.queryRenderedSymbols(De),ze=[];for(const tt of Object.keys($e).map(Number))ze.push(Ge[tt]);ze.sort(Be);for(const tt of ze){const et=tt.featureIndex.lookupSymbolFeatures($e[tt.bucketInstanceId],de,tt.bucketIndex,tt.sourceLayerIndex,Fe.filter,Fe.layers,Fe.availableImages,K);for(const Mt in et){const Et=He[Mt]=He[Mt]||[],yt=et[Mt];yt.sort((It,Ct)=>{const Vt=tt.featureSortOrder;if(Vt){const sn=Vt.indexOf(It.featureIndex);return Vt.indexOf(Ct.featureIndex)-sn}return Ct.featureIndex-It.featureIndex});for(const It of yt)Et.push(It)}}for(const tt in He)He[tt].forEach(et=>{const Mt=et.feature,Et=pe(K[tt]).getFeatureState(Mt.layer["source-layer"],Mt.id);Mt.source=Mt.layer.source,Mt.layer["source-layer"]&&(Mt.sourceLayer=Mt.layer["source-layer"]),Mt.state=Et});return He}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),Z.screenGeometry,u,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(M)}querySourceFeatures(i,u){u&&u.filter&&this._validate(l.validateFilter,"querySourceFeatures.filter",u.filter,null,u);const m=this._getSourceCaches(i);let E=[];for(const M of m)E=E.concat(Se(M,u));return E}addSourceType(i,u,m){return ps.getSourceType(i)?m(new Error(`A source type called "${i}" already exists.`)):(ps.setSourceType(i,u),u.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:i,url:u.workerSourceURL},m):m(null,null))}getLight(){return this.light.getLight()}setLight(i,u={}){this._checkLoaded();const m=this.light.getLight();let E=!1;for(const z in i)if(!oe(i[z],m[z])){E=!0;break}if(!E)return;const M=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(i,u),this.light.updateTransitions(M)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(i,u=1){if(this._checkLoaded(),!i)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(1===u){if("object"==typeof i.source){const m="terrain-dem-src";this.addSource(m,i.source),i=l.clone$1(i),i=l.extend(i,{source:m})}if(this._validate(l.validateTerrain,"terrain",i))return}if(!this.terrain||this.terrain&&u!==this.terrain.drapeRenderMode)this._createTerrain(i,u);else{const m=this.terrain,E=m.get();for(const M of Object.keys(l.spec.terrain))!i.hasOwnProperty(M)&&l.spec.terrain[M].default&&(i[M]=l.spec.terrain[M].default);for(const M in i)if(!oe(i[M],E[M])){m.set(i),this.stylesheet.terrain=i;const z=this._setTransitionParameters({duration:0});m.updateTransitions(z);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(i){const u=this.fog=new Mi(i,this.map.transform);this.stylesheet.fog=i;const m=this._setTransitionParameters({duration:0});u.updateTransitions(m)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const i of this.map._markers)i._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(i){if(this._checkLoaded(),!i)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const u=this.fog,m=u.get();0===Object.keys(i).length&&u.set(i);for(const E in i)if(!oe(i[E],m[E])){u.set(i),this.stylesheet.fog=i;const M=this._setTransitionParameters({duration:0});u.updateTransitions(M);break}}else this._createFog(i);this._markersNeedUpdate=!0}_setTransitionParameters(i){return{now:l.exported.now(),transition:l.extend(i,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const i=this._order.filter(m=>this.isLayerDraped(this._layers[m])),u=this._order.filter(m=>!this.isLayerDraped(this._layers[m]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...i),this._drapedFirstOrder.push(...u)}_createTerrain(i,u){const m=this.terrain=new en(i,u);this.stylesheet.terrain=i,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const E=this._setTransitionParameters({duration:0});m.updateTransitions(E)}_force3DLayerUpdate(){for(const i in this._layers){const u=this._layers[i];"fill-extrusion"===u.type&&this._updateLayer(u)}}_forceSymbolLayerUpdate(){for(const i in this._layers){const u=this._layers[i];"symbol"===u.type&&this._updateLayer(u)}}_validate(i,u,m,E,M={}){return(!M||!1!==M.validate)&&ea(this,i.call(l.validateStyle,l.extend({key:u,style:this.serialize(),value:m,styleSpec:l.spec},E)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),l.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const i in this._layers)this._layers[i].setEventedParent(null);for(const i in this._sourceCaches)this._sourceCaches[i].clearTiles(),this._sourceCaches[i].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(i){const u=this._getSourceCaches(i);for(const m of u)m.clearTiles()}_reloadSource(i){const u=this._getSourceCaches(i);for(const m of u)m.resume(),m.reload()}_updateSources(i){for(const u in this._sourceCaches)this._sourceCaches[u].update(i)}_generateCollisionBoxes(){for(const i in this._sourceCaches){const u=this._sourceCaches[i];u.resume(),u.reload()}}_updatePlacement(i,u,m,E,M=!1){let z=!1,Z=!1;const K={};for(const de of this._order){const pe=this._layers[de];if("symbol"!==pe.type)continue;if(!K[pe.source]){const Fe=this._getLayerSourceCache(pe);if(!Fe)continue;K[pe.source]=Fe.getRenderableIds(!0).map(Je=>Fe.getTileByID(Je)).sort((Je,Ge)=>Ge.tileID.overscaledZ-Je.tileID.overscaledZ||(Je.tileID.isLessThan(Ge.tileID)?-1:1))}const De=this.crossTileSymbolIndex.addLayer(pe,K[pe.source],i.center.lng,i.projection);z=z||De}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),M=M||this._layerOrderChanged||0===m,this._layerOrderChanged&&this.fire(new l.Event("neworder")),(M||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(l.exported.now(),i.zoom))&&(this.pauseablePlacement=new Xo(i,this._order,M,u,m,E,this.placement,this.fog&&i.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,K),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(l.exported.now()),Z=!0),z&&this.pauseablePlacement.placement.setStale()),Z||z)for(const de of this._order){const pe=this._layers[de];"symbol"===pe.type&&this.placement.updateLayerOpacities(pe,K[pe.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(l.exported.now())}_releaseSymbolFadeTiles(){for(const i in this._sourceCaches)this._sourceCaches[i].releaseSymbolFadeTiles()}getImages(i,u,m){this.imageManager.getImages(u.icons,m),this._updateTilesForChangedImages();const E=M=>{M&&M.setDependencies(u.tileID.key,u.type,u.icons)};E(this._otherSourceCaches[u.source]),E(this._symbolSourceCaches[u.source])}getGlyphs(i,u,m){this.glyphManager.getGlyphs(u.stacks,m)}getResource(i,u,m){return l.makeRequest(u,m)}_getSourceCache(i){return this._otherSourceCaches[i]}_getLayerSourceCache(i){return"symbol"===i.type?this._symbolSourceCaches[i.source]:this._otherSourceCaches[i.source]}_getSourceCaches(i){const u=[];return this._otherSourceCaches[i]&&u.push(this._otherSourceCaches[i]),this._symbolSourceCaches[i]&&u.push(this._symbolSourceCaches[i]),u}_isSourceCacheLoaded(i){const u=this._getSourceCaches(i);return 0===u.length?(this.fire(new l.ErrorEvent(new Error(`There is no source with ID '${i}'`))),!1):u.every(m=>m.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}ps.getSourceType=function(d){return nt[d]},ps.setSourceType=function(d,i){nt[d]=i},ps.registerForPluginStateChange=l.registerForPluginStateChange;var Wa="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#define HALF_PI PI/2.0\n#define QUARTER_PI PI/4.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0",I="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",V="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {return currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;vec4 bounds=vec4(d,vec2(1.0)-d);h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",ne="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",ce="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif";let Ee={},Ae={};const Le=[];je(Wa,Le),je(V,Le),je(ne,Le),je(ce,Le),Ee=Ye("",V),Ae=Ye(ce,ne);const Y=Ye("\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}","\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),le=Wa,ee="\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif";var be={background:Ye("uniform vec4 u_color;uniform float u_opacity;void main() {vec4 out_color=u_color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:Ye("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_mix);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:Ye("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);vec4 world_center=vec4(pos,1);\n#else \nmat3 surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);vec4 world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);vec4 occlusion_world_center=vec4(circle_center,cantilevered_height,1);vec4 occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nvec4 occlusion_world_center=world_center;vec4 occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:Ye("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Ye("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\nvec3 pos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:Ye("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Ye("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Ye("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Ye("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;\n#endif\nvarying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}"),fill:Ye("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:Ye("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:Ye("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=mix(color1,color2,u_fade);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:Ye("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:Ye("uniform lowp vec3 u_lightpos;varying vec4 v_color;\n#ifdef RENDER_SHADOWS\nvarying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;varying highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\nvoid main() {vec4 color=v_color;\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;\n#endif\n#ifdef RENDER_SHADOWS\ncolor.xyz=shadowed_color_normal(color.xyz,normalize(v_normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec4 v_color;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying highp vec3 v_normal;varying float v_depth;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;vec3 pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);\n#ifdef RENDER_SHADOWS\nv_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_normal=normal;v_depth=gl_Position.w;\n#endif\nfloat colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);directional*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\nv_color.rgb+=clamp(color.rgb*directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:Ye("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\nvarying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);out_color=out_color*v_lighting;\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 p=vec3(pos_nx.xy,h);\n#else\nvec3 p=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);directional*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\nv_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:Ye("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos);float f=getElevation(v_pos+vec2(epsilon.x,0));float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float h=getElevation(v_pos+vec2(0,epsilon.y));float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Ye("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:Ye("uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;uniform float u_mix;uniform vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash_from\n#pragma mapbox: define lowp vec4 dash_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash_from\n#pragma mapbox: initialize lowp vec4 dash_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist_a=texture2D(u_dash_image,v_tex_a).a;float sdfdist_b=texture2D(u_dash_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfwidth=min(dash_from.z*u_scale.y,dash_to.z*u_scale.z);float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/sdfwidth;alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\n#ifdef RENDER_LINE_GRADIENT\nhighp vec4 out_color=texture2D(u_gradient_image,v_uv.xy);\n#else\nvec4 out_color=color;\n#endif\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);}}\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef RENDER_LINE_ALPHA_DISCARD\nif (alpha < u_alpha_discard_threshold) {discard;}\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nattribute highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform mediump vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash_from\n#pragma mapbox: define lowp vec4 dash_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash_from\n#pragma mapbox: initialize lowp vec4 dash_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;float scaleA=dash_from.z==0.0 ? 0.0 : tileZoomRatio/(dash_from.z*fromScale);float scaleB=dash_to.z==0.0 ? 0.0 : tileZoomRatio/(dash_to.z*toScale);float heightA=dash_from.y;float heightB=dash_to.y;v_tex_a=vec2(a_linesofar*scaleA/floorwidth,(-normal.y*heightA+dash_from.x+0.5)/u_texsize.y);v_tex_b=vec2(a_linesofar*scaleB/floorwidth,(-normal.y*heightB+dash_to.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:Ye("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:Ye("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:Ye("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nvec3 world_pos=vec3(tile_anchor,0)+h;float globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);vec4 offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\nvec4 offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nvec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),symbolSDF:Ye("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nvec3 world_pos=vec3(tile_anchor,0)+h;float globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);vec4 offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\nvec4 offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nvec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),symbolTextAndIcon:Ye("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nvec3 world_pos=vec3(tile_anchor,0)+h;float globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nvec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),terrainRaster:Ye("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nvarying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef RENDER_SHADOWS\ncolor.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nconst float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=u_skirt_height*u_skirt_height*wireframeOffset;\n#endif\nvec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;\n#endif\n}"),terrainDepth:Ye("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Ye("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",I),skyboxGradient:Ye("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",I),skyboxCapture:Ye("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Ye("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);vec4 color=vec4(raster.rgb*antialias,raster.a*antialias);\n#else\nvec4 color=texture2D(u_image0,v_pos0);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;\n#ifdef GLOBE_POLES\nattribute vec3 a_globe_pos;attribute vec2 a_uv;\n#else\nattribute vec2 a_pos;\n#endif\nvarying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idy=u_grid_matrix[1][2];float S=u_grid_matrix[2][2];vec3 latLng=u_grid_matrix*vec3(a_pos,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=a_pos[0]*S;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;\n#ifdef GLOBE_POLES\nvec3 up_vector=normalize(globe_pos)*u_tile_up_scale;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);\n#ifdef TERRAIN_WIREFRAME\nheight+=wireframeOffset;\n#endif\nglobe_pos+=up_vector*height;\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}"),globeAtmosphere:Ye("uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);\n#ifdef PROJECTION_GLOBE_VIEW\nfloat globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(dot(dir,horizon_dir)),0.0);\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));float horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nfloat horizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:\n(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:\nuv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}","attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}")};function je(d,i){const u=d.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let m of u)if(m=m.trim(),"#"===m[0]&&m.includes("if")&&!m.includes("endif")){m=m.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const E=m.split(" ");for(const M of E)i.includes(M)||i.push(M)}}function Ye(d,i){const u=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,m=i.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),E={},M=[...Le];return je(d,M),je(i,M),{fragmentSource:d=d.replace(u,(z,Z,K,de,pe)=>(E[pe]=!0,"define"===Z?`\n#ifndef HAS_UNIFORM_u_${pe}\nvarying ${K} ${de} ${pe};\n#else\nuniform ${K} ${de} u_${pe};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${pe}\n    ${K} ${de} ${pe} = u_${pe};\n#endif\n`)),vertexSource:i=i.replace(u,(z,Z,K,de,pe)=>{const De="float"===de?"vec2":"vec4",Fe=pe.match(/color/)?"color":De;return E[pe]?"define"===Z?`\n#ifndef HAS_UNIFORM_u_${pe}\nuniform lowp float u_${pe}_t;\nattribute ${K} ${De} a_${pe};\nvarying ${K} ${de} ${pe};\n#else\nuniform ${K} ${de} u_${pe};\n#endif\n`:"vec4"===Fe?`\n#ifndef HAS_UNIFORM_u_${pe}\n    ${pe} = a_${pe};\n#else\n    ${K} ${de} ${pe} = u_${pe};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${pe}\n    ${pe} = unpack_mix_${Fe}(a_${pe}, u_${pe}_t);\n#else\n    ${K} ${de} ${pe} = u_${pe};\n#endif\n`:"define"===Z?`\n#ifndef HAS_UNIFORM_u_${pe}\nuniform lowp float u_${pe}_t;\nattribute ${K} ${De} a_${pe};\n#else\nuniform ${K} ${de} u_${pe};\n#endif\n`:"vec4"===Fe?`\n#ifndef HAS_UNIFORM_u_${pe}\n    ${K} ${de} ${pe} = a_${pe};\n#else\n    ${K} ${de} ${pe} = u_${pe};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${pe}\n    ${K} ${de} ${pe} = unpack_mix_${Fe}(a_${pe}, u_${pe}_t);\n#else\n    ${K} ${de} ${pe} = u_${pe};\n#endif\n`}),staticAttributes:m,usedDefines:M}}class mt{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(i,u,m,E,M,z,Z){this.context=i;let K=this.boundPaintVertexBuffers.length!==E.length;for(let pe=0;!K&&pe<E.length;pe++)this.boundPaintVertexBuffers[pe]!==E[pe]&&(K=!0);let de=this.boundDynamicVertexBuffers.length!==Z.length;for(let pe=0;!de&&pe<Z.length;pe++)this.boundDynamicVertexBuffers[pe]!==Z[pe]&&(de=!0);if(!i.extVertexArrayObject||!this.vao||this.boundProgram!==u||this.boundLayoutVertexBuffer!==m||K||de||this.boundIndexBuffer!==M||this.boundVertexOffset!==z)this.freshBind(u,m,E,M,z,Z);else{i.bindVertexArrayOES.set(this.vao);for(const pe of Z)pe&&pe.bind();M&&M.dynamicDraw&&M.bind()}}freshBind(i,u,m,E,M,z){let Z;const K=i.numAttributes,de=this.context,pe=de.gl;if(de.extVertexArrayObject)this.vao&&this.destroy(),this.vao=de.extVertexArrayObject.createVertexArrayOES(),de.bindVertexArrayOES.set(this.vao),Z=0,this.boundProgram=i,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=m,this.boundIndexBuffer=E,this.boundVertexOffset=M,this.boundDynamicVertexBuffers=z;else{Z=de.currentNumAttributes||0;for(let De=K;De<Z;De++)pe.disableVertexAttribArray(De)}u.enableAttributes(pe,i),u.bind(),u.setVertexAttribPointers(pe,i,M);for(const De of m)De.enableAttributes(pe,i),De.bind(),De.setVertexAttribPointers(pe,i,M);for(const De of z)De&&(De.enableAttributes(pe,i),De.bind(),De.setVertexAttribPointers(pe,i,M));E&&E.bind(),de.currentNumAttributes=K}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function On(d,i){const u=Math.pow(2,i.canonical.z),m=i.canonical.y;return[new l.MercatorCoordinate(0,m/u).toLngLat().lat,new l.MercatorCoordinate(0,(m+1)/u).toLngLat().lat]}function Ui(d,i,u,m,E,M,z){const Z=d.context,K=Z.gl,de=u.fbo;if(!de)return;d.prepareDrawTile();const pe=d.useProgram("hillshade");Z.activeTexture.set(K.TEXTURE0),K.bindTexture(K.TEXTURE_2D,de.colorAttachment.get());const De=((He,$e,ze,tt)=>{const et=ze.paint.get("hillshade-shadow-color"),Mt=ze.paint.get("hillshade-highlight-color"),Et=ze.paint.get("hillshade-accent-color");let yt=ze.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===ze.paint.get("hillshade-illumination-anchor")&&(yt-=He.transform.angle);const It=!He.options.moving;return{u_matrix:tt||He.transform.calculateProjMatrix($e.tileID.toUnwrapped(),It),u_image:0,u_latrange:On(0,$e.tileID),u_light:[ze.paint.get("hillshade-exaggeration"),yt],u_shadow:et,u_highlight:Mt,u_accent:Et}})(d,u,m,d.terrain?i.projMatrix:null);d.prepareDrawProgram(Z,pe,i.toUnwrapped());const{tileBoundsBuffer:Fe,tileBoundsIndexBuffer:Je,tileBoundsSegments:Ge}=d.getTileBoundsBuffers(u);pe.draw(Z,K.TRIANGLES,E,M,z,l.CullFaceMode.disabled,De,m.id,Fe,Je,Ge)}function wn(d,i,u){if(!i.needsDEMTextureUpload)return;const m=d.context,E=m.gl;m.pixelStoreUnpackPremultiplyAlpha.set(!1),i.demTexture=i.demTexture||d.getTileTexture(u.stride);const M=u.getPixels();i.demTexture?i.demTexture.update(M,{premultiply:!1}):i.demTexture=new l.Texture(m,M,E.RGBA,{premultiply:!1}),i.needsDEMTextureUpload=!1}function er(d,i,u,m,E,M){const z=d.context,Z=z.gl;if(!i.dem)return;const K=i.dem;if(z.activeTexture.set(Z.TEXTURE1),wn(d,i,K),!i.demTexture)return;i.demTexture.bind(Z.NEAREST,Z.CLAMP_TO_EDGE);const de=K.dim;z.activeTexture.set(Z.TEXTURE0);let pe=i.fbo;if(!pe){const Ge=new l.Texture(z,{width:de,height:de,data:null},Z.RGBA);Ge.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),pe=i.fbo=z.createFramebuffer(de,de,!0),pe.colorAttachment.set(Ge.texture)}z.bindFramebuffer.set(pe.framebuffer),z.viewport.set([0,0,de,de]);const{tileBoundsBuffer:De,tileBoundsIndexBuffer:Fe,tileBoundsSegments:Je}=d.getMercatorTileBoundsBuffers();d.useProgram("hillshadePrepare").draw(z,Z.TRIANGLES,m,E,M,l.CullFaceMode.disabled,((Ge,He)=>{const $e=He.stride,ze=l.create();return l.ortho(ze,0,l.EXTENT,-l.EXTENT,0,0,1),l.translate(ze,ze,[0,-l.EXTENT,0]),{u_matrix:ze,u_image:1,u_dimension:[$e,$e],u_zoom:Ge.overscaledZ,u_unpack:He.unpackVector}})(i.tileID,K),u.id,De,Fe,Je),i.needsHillshadePrepare=!1}const ji=d=>({u_matrix:new l.UniformMatrix4f(d),u_image0:new l.Uniform1i(d),u_skirt_height:new l.Uniform1f(d)}),Lr=(d,i)=>({u_matrix:d,u_image0:0,u_skirt_height:i}),Zi=(d,i,u,m,E,M,z,Z,K,de,pe,De,Fe,Je)=>({u_proj_matrix:Float32Array.from(d),u_globe_matrix:i,u_normalize_matrix:Float32Array.from(m),u_merc_matrix:u,u_zoom_transition:E,u_merc_center:M,u_image0:0,u_frustum_tl:z,u_frustum_tr:Z,u_frustum_br:K,u_frustum_bl:de,u_globe_pos:pe,u_globe_radius:De,u_viewport:Fe,u_grid_matrix:Je?Float32Array.from(Je):new Float32Array(9)});function bi(d,i){return null!=d&&null!=i&&!(!d.hasData()||!i.hasData())&&null!=d.demTexture&&null!=i.demTexture&&d.tileID.key!==i.tileID.key}const ge=new class{constructor(){this.operations={}}newMorphing(d,i,u,m,E){if(d in this.operations){const M=this.operations[d];M.to.tileID.key!==u.tileID.key&&(M.queued=u)}else this.operations[d]={startTime:m,phase:0,duration:E,from:i,to:u,queued:null}}getMorphValuesForProxy(d){if(!(d in this.operations))return null;const i=this.operations[d];return{from:i.from,to:i.to,phase:i.phase}}update(d){for(const i in this.operations){const u=this.operations[i];for(u.phase=(d-u.startTime)/u.duration;u.phase>=1||!this._validOp(u);)if(!this._nextOp(u,d)){delete this.operations[i];break}}}_nextOp(d,i){return!!d.queued&&(d.from=d.to,d.to=d.queued,d.queued=null,d.phase=0,d.startTime=i,!0)}_validOp(d){return d.from.hasData()&&d.to.hasData()}},he={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function ae(d,i){const u=1<<d.z;return!i&&(0===d.x||d.x===u-1)||0===d.y||d.y===u-1}const Re=d=>({u_matrix:d});function gn(d,i,u,m,E){if(E>0){const M=l.exported.now(),z=(M-d.timeAdded)/E,Z=i?(M-i.timeAdded)/E:-1,K=u.getSource(),de=m.coveringZoomLevel({tileSize:K.tileSize,roundZoom:K.roundZoom}),pe=!i||Math.abs(i.tileID.overscaledZ-de)>Math.abs(d.tileID.overscaledZ-de),De=pe&&d.refreshedUponExpiration?1:l.clamp(pe?z:1-Z,0,1);return d.refreshedUponExpiration&&z>=1&&(d.refreshedUponExpiration=!1),i?{opacity:1,mix:1-De}:{opacity:De,mix:0}}return{opacity:1,mix:0}}class xi extends l.SourceCache{constructor(i){const u={type:"raster-dem",maxzoom:i.transform.maxZoom},m=new mr(In(),null),E=Kt("mock-dem",u,m,i.style);super("mock-dem",E,!1),E.setEventedParent(this),this._sourceLoaded=!0}_loadTile(i,u){i.state="loaded",u(null)}}class vi extends l.SourceCache{constructor(i){const u=Kt("proxy",{type:"geojson",maxzoom:i.transform.maxZoom},new mr(In(),null),i.style);super("proxy",u,!1),u.setEventedParent(this),this.map=this.getSource().map=i,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(i,u,m){if(i.freezeTileCoverage)return;this.transform=i;const E=i.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((M,z)=>{if(M[z.key]="",!this._tiles[z.key]){const Z=new l.Tile(z,this._source.tileSize*z.overscaleFactor(),i.tileZoom);Z.state="loaded",this._tiles[z.key]=Z}return M},{});for(const M in this._tiles)M in E||(this.freeFBO(M),this._tiles[M].unloadVectorData(),delete this._tiles[M])}freeFBO(i){const u=this.proxyCachedFBO[i];if(void 0!==u){const m=Object.values(u);this.renderCachePool.push(...m),delete this.proxyCachedFBO[i]}}deallocRenderCache(){this.renderCache.forEach(i=>i.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Jo extends l.OverscaledTileID{constructor(i,u,m){super(i.overscaledZ,i.wrap,i.canonical.z,i.canonical.x,i.canonical.y),this.proxyTileKey=u,this.projMatrix=m}}class ms extends l.Elevation{constructor(i,u){super(),this.painter=i,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[m,E,M]=function(K){const de=new l.StructArrayLayout4i8,pe=new l.StructArrayLayout3ui6;de.reserve(17161),pe.reserve(33800);const Fe=l.EXTENT/128,Je=l.EXTENT+Fe/2,Ge=Je+Fe;for(let $e=-Fe;$e<Ge;$e+=Fe)for(let ze=-Fe;ze<Ge;ze+=Fe){const tt=ze<0||ze>Je||$e<0||$e>Je?24575:0,et=l.clamp(Math.round(ze),0,l.EXTENT),Mt=l.clamp(Math.round($e),0,l.EXTENT);de.emplaceBack(et+tt,Mt,et,Mt)}const He=($e,ze)=>{const tt=131*ze+$e;pe.emplaceBack(tt+1,tt,tt+131),pe.emplaceBack(tt+131,tt+131+1,tt+1)};for(let $e=1;$e<129;$e++)for(let ze=1;ze<129;ze++)He(ze,$e);return[0,129].forEach($e=>{for(let ze=0;ze<130;ze++)He(ze,$e),He($e,ze)}),[de,pe,32768]}(),z=i.context;this.gridBuffer=z.createVertexBuffer(m,l.boundsAttributes.members),this.gridIndexBuffer=z.createIndexBuffer(E),this.gridSegments=l.SegmentVector.simpleSegment(0,0,m.length,E.length),this.gridNoSkirtSegments=l.SegmentVector.simpleSegment(0,0,m.length,M),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new vi(u.map),this.orthoMatrix=l.create(),l.ortho(this.orthoMatrix,0,l.EXTENT,0,l.EXTENT,0,1);const Z=z.gl;this._overlapStencilMode=new l.StencilMode({func:Z.GEQUAL,mask:255},0,255,Z.KEEP,Z.KEEP,Z.REPLACE),this._previousZoom=i.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=u,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new xi(u.map)}set style(i){i.on("data",this._onStyleDataEvent.bind(this)),i.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=i,this._checkRenderCacheEfficiency()}update(i,u,m){if(i&&i.terrain){this._style!==i&&(this.style=i),this.enabled=!0;const E=i.terrain.properties;this.sourceCache=0===i.terrain.drapeRenderMode?this._mockSourceCache:i._getSourceCache(E.get("source")),this._exaggeration=E.get("exaggeration");const M=()=>{this.sourceCache.used&&l.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const z=this.getScaledDemTileSize();this.sourceCache.update(u,z,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,M(),this._initializing=!0),M(),u.updateElevation(!m),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(u),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(i){this._findCoveringTileCache[i]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const i=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==i.efficiency&&l.warnOnce(`Terrain render cache efficiency is not optimal (${i.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${i.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(i){i.coord&&"source"===i.dataType?this._clearRenderCacheForTile(i.sourceCacheId,i.coord):"style"===i.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const i in this._style._sourceCaches)this._style._sourceCaches[i].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(i=>i.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const i=2*this.proxySourceCache.getSource().tileSize;return[i,i]}set useVertexMorphing(i){this._useVertexMorphing=i}updateTileBinding(i){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const u=this.proxySourceCache,m=this.painter.transform;this._initializing&&(this._initializing=0===m._centerAltitude&&-1===this.getAtPointOrZero(l.MercatorCoordinate.fromLngLat(m.center),-1),this._emptyDEMTextureDirty=!this._initializing);const E=this.proxyCoords=u.getIds().map(K=>{const de=u.getTileByID(K).tileID;return de.projMatrix=m.calculateProjMatrix(de.toUnwrapped()),de});(function(K,de){const pe=de.transform.pointCoordinate(de.transform.getCameraPoint()),De=new l.pointGeometry(pe.x,pe.y);K.sort((Fe,Je)=>{if(Je.overscaledZ-Fe.overscaledZ)return Je.overscaledZ-Fe.overscaledZ;const Ge=new l.pointGeometry(Fe.canonical.x+(1<<Fe.canonical.z)*Fe.wrap,Fe.canonical.y),He=new l.pointGeometry(Je.canonical.x+(1<<Je.canonical.z)*Je.wrap,Je.canonical.y),$e=De.mult(1<<Fe.canonical.z);return $e.x-=.5,$e.y-=.5,$e.distSqr(Ge)-$e.distSqr(He)})})(E,this.painter),this._previousZoom=m.zoom;const M=this.proxyToSource||{};this.proxyToSource={},E.forEach(K=>{this.proxyToSource[K.key]={}}),this.terrainTileForTile={};const z=this._style._sourceCaches;for(const K in z){const de=z[K];if(!de.used||(de!==this.sourceCache&&this.resetTileLookupCache(de.id),this._setupProxiedCoordsForOrtho(de,i[K],M),de.usedForTerrain))continue;const pe=i[K];de.getSource().reparseOverscaled&&this._assignTerrainTiles(pe)}this.proxiedCoords[u.id]=E.map(K=>new Jo(K,K.key,this.orthoMatrix)),this._assignTerrainTiles(E),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(M),this.renderingToTexture=!1,this._updateTimestamp=l.exported.now();const Z={};this._visibleDemTiles=[];for(const K of this.proxyCoords){const de=this.terrainTileForTile[K.key];if(!de)continue;const pe=de.tileID.key;pe in Z||(this._visibleDemTiles.push(de),Z[pe]=pe)}}_assignTerrainTiles(i){this._initializing||i.forEach(u=>{if(this.terrainTileForTile[u.key])return;const m=this._findTileCoveringTileID(u,this.sourceCache);m&&(this.terrainTileForTile[u.key]=m)})}_prepareDEMTextures(){const i=this.painter.context,u=i.gl;for(const m in this.terrainTileForTile){const E=this.terrainTileForTile[m],M=E.dem;!M||E.demTexture&&!E.needsDEMTextureUpload||(i.activeTexture.set(u.TEXTURE1),wn(this.painter,E,M))}}_prepareDemTileUniforms(i,u,m,E){if(!u||null==u.demTexture)return!1;const M=i.tileID.canonical,z=Math.pow(2,u.tileID.canonical.z-M.z),Z=E||"";return m[`u_dem_tl${Z}`]=[M.x*z%1,M.y*z%1],m[`u_dem_scale${Z}`]=z,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const i=this.painter.context,u=i.gl;if(!this._emptyDepthBufferTexture){const m=new l.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new l.Texture(i,m,u.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let i=0;const u=this._visibleDemTiles.reduce((m,E)=>{if(!E.dem)return m;const M=E.dem.tree.minimums[0];return M>0&&i++,m+M},0);return i?u/i:0}_updateEmptyDEMTexture(){const i=this.painter.context,u=i.gl;i.activeTexture.set(u.TEXTURE2);const m=this._getLoadedAreaMinimum(),E=new l.RGBAImage({width:1,height:1},new Uint8Array(l.DEMData.pack(m,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let M=this._emptyDEMTexture;return M?M.update(E,{premultiply:!1}):M=this._emptyDEMTexture=new l.Texture(i,E,u.RGBA,{premultiply:!1}),M}setupElevationDraw(i,u,m){const E=this.painter.context,M=E.gl,z=(Z=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:l.DEMData.getUnpackVector(Z),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0,u_tile_tl_up:[0,0,1],u_tile_tr_up:[0,0,1],u_tile_br_up:[0,0,1],u_tile_bl_up:[0,0,1],u_tile_up_scale:1});var Z;z.u_dem_size=this.sourceCache.getSource().tileSize,z.u_exaggeration=this.exaggeration();const K=this.painter.transform,de=K.projection,pe=i.tileID.canonical;z.u_tile_tl_up=de.upVector(pe,0,0),z.u_tile_tr_up=de.upVector(pe,l.EXTENT,0),z.u_tile_br_up=de.upVector(pe,l.EXTENT,l.EXTENT),z.u_tile_bl_up=de.upVector(pe,0,l.EXTENT),z.u_tile_up_scale=m&&m.useDenormalizedUpVectorScale?l.GLOBE_METERS_TO_ECEF:de.upVectorScale(pe,K.center.lat,K.worldSize).metersToTile;let De=null,Fe=null,Je=1;if(m&&m.morphing&&this._useVertexMorphing){const Ge=m.morphing.srcDemTile,He=m.morphing.dstDemTile;Je=m.morphing.phase,Ge&&He&&(this._prepareDemTileUniforms(i,Ge,z,"_prev")&&(Fe=Ge),this._prepareDemTileUniforms(i,He,z)&&(De=He))}if(Fe&&De?(E.activeTexture.set(M.TEXTURE2),De.demTexture.bind(M.NEAREST,M.CLAMP_TO_EDGE,M.NEAREST),E.activeTexture.set(M.TEXTURE4),Fe.demTexture.bind(M.NEAREST,M.CLAMP_TO_EDGE,M.NEAREST),z.u_dem_lerp=Je):(De=this.terrainTileForTile[i.tileID.key],E.activeTexture.set(M.TEXTURE2),(this._prepareDemTileUniforms(i,De,z)?De.demTexture:this.emptyDEMTexture).bind(M.NEAREST,M.CLAMP_TO_EDGE)),E.activeTexture.set(M.TEXTURE3),m&&m.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(M.NEAREST,M.CLAMP_TO_EDGE),this._depthFBO&&(z.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(M.NEAREST,M.CLAMP_TO_EDGE),z.u_depth_size_inv=[1,1]),m&&m.useMeterToDem&&De){const Ge=(1<<De.tileID.canonical.z)*l.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;z.u_meter_to_dem=Ge}m&&m.labelPlaneMatrixInv&&(z.u_label_plane_matrix_inv=m.labelPlaneMatrixInv),u.setTerrainUniformValues(E,z)}renderToBackBuffer(i){const u=this.painter,m=this.painter.context;0!==i.length&&(m.bindFramebuffer.set(null),m.viewport.set([0,0,u.width,u.height]),u.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(E,M,z,Z,K){if("globe"===E.transform.projection.name)!function(de,pe,De,Fe,Je){const Ge=de.context,He=Ge.gl;let $e,ze;const tt=de.options.showTerrainWireframe?2:0,et=de.transform,Mt=l.globeUseCustomAntiAliasing(de,Ge,et),Et=(di,_n)=>{if(ze===di)return;const li=[he[di],"PROJECTION_GLOBE_VIEW"];Mt&&li.push("CUSTOM_ANTIALIASING"),_n&&li.push(he[tt]),$e=de.useProgram("globeRaster",null,li),ze=di},yt=de.colorModeForRenderPass(),It=new l.DepthMode(He.LEQUAL,l.DepthMode.ReadWrite,de.depthRangeFor3D);ge.update(Je);const Ct=l.calculateGlobeMercatorMatrix(et),Vt=[l.mercatorXfromLng(et.center.lng),l.mercatorYfromLat(et.center.lat)],sn=tt?[!1,!0]:[!1],ni=de.globeSharedBuffers,Xt=[et.width*l.exported.devicePixelRatio,et.height*l.exported.devicePixelRatio],Ln=Float32Array.from(et.globeMatrix),zn={useDenormalizedUpVectorScale:!0};if(sn.forEach(di=>{ze=-1;const _n=di?He.LINES:He.TRIANGLES;for(const li of Fe){const Un=De.getTile(li),Ai=l.StencilMode.disabled,gi=pe.prevTerrainTileForTile[li.key],$i=pe.terrainTileForTile[li.key];bi(gi,$i)&&ge.newMorphing(li.key,gi,$i,Je,250),Ge.activeTexture.set(He.TEXTURE0),Un.texture.bind(He.LINEAR,He.CLAMP_TO_EDGE);const vr=ge.getMorphValuesForProxy(li.key),jr=vr?1:0;vr&&l.extend$1(zn,{morphing:{srcDemTile:vr.from,dstDemTile:vr.to,phase:l.easeCubicInOut(vr.phase)}});const mo=l.tileCornersToBounds(li.canonical),tr=l.getLatitudinalLod(mo.getCenter().lat),Kr=l.getGridMatrix(li.canonical,mo,tr),Ro=l.globeNormalizeECEF(l.globeTileBounds(li.canonical)),Es=Zi(et.projMatrix,Ln,Ct,Ro,l.globeToMercatorTransition(et.zoom),Vt,et.frustumCorners.TL,et.frustumCorners.TR,et.frustumCorners.BR,et.frustumCorners.BL,et.globeCenterInViewSpace,et.globeRadius,Xt,Kr);if(Et(jr,di),pe.setupElevationDraw(Un,$e,zn),de.prepareDrawProgram(Ge,$e,li.toUnwrapped()),ni){const[Ks,G,P]=di?ni.getWirefameBuffers(de.context,tr):ni.getGridBuffers(tr);$e.draw(Ge,_n,It,Ai,yt,l.CullFaceMode.backCCW,Es,"globe_raster",Ks,G,P)}}}),ni){const di=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Mt&&di.push("CUSTOM_ANTIALIASING"),$e=de.useProgram("globeRaster",null,di);for(const _n of Fe){const{x:li,y:Un,z:Ai}=_n.canonical,gi=0===Un,$i=Un===(1<<Ai)-1,[vr,jr,mo,tr]=ni.getPoleBuffers(Ai);if(tr&&(gi||$i)){const Kr=De.getTile(_n);Ge.activeTexture.set(He.TEXTURE0),Kr.texture.bind(He.LINEAR,He.CLAMP_TO_EDGE);let Ro=l.globePoleMatrixForTile(Ai,li,et);const Es=l.globeNormalizeECEF(l.globeTileBounds(_n.canonical)),Ks=(G,P)=>G.draw(Ge,He.TRIANGLES,It,l.StencilMode.disabled,yt,l.CullFaceMode.disabled,Zi(et.projMatrix,Ro,Ro,Es,0,Vt,et.frustumCorners.TL,et.frustumCorners.TR,et.frustumCorners.BR,et.frustumCorners.BL,et.globeCenterInViewSpace,et.globeRadius,Xt),"globe_pole_raster",P,mo,tr);pe.setupElevationDraw(Kr,$e,zn),de.prepareDrawProgram(Ge,$e,_n.toUnwrapped()),gi&&Ks($e,vr),$i&&(Ro=l.scale(l.create(),Ro,[1,-1,1]),Ks($e,jr))}}}}(E,M,z,Z,K);else{const de=E.context,pe=de.gl;let De,Fe;const Je=E.options.showTerrainWireframe?2:0,Ge=(et,Mt)=>{if(Fe===et)return;const Et=[he[et]];Mt&&Et.push(he[Je]),De=E.useProgram("terrainRaster",null,Et),Fe=et},He=E.colorModeForRenderPass(),$e=new l.DepthMode(pe.LEQUAL,l.DepthMode.ReadWrite,E.depthRangeFor3D);ge.update(K);const ze=E.transform,tt=6*Math.pow(1.5,22-ze.zoom)*M.exaggeration();(Je?[!1,!0]:[!1]).forEach(et=>{Fe=-1;const Mt=et?pe.LINES:pe.TRIANGLES,[Et,yt]=et?M.getWirefameBuffer():[M.gridIndexBuffer,M.gridSegments];for(const It of Z){const Ct=z.getTile(It),Vt=l.StencilMode.disabled,sn=M.prevTerrainTileForTile[It.key],ni=M.terrainTileForTile[It.key];bi(sn,ni)&&ge.newMorphing(It.key,sn,ni,K,250),de.activeTexture.set(pe.TEXTURE0),Ct.texture.bind(pe.LINEAR,pe.CLAMP_TO_EDGE,pe.LINEAR_MIPMAP_NEAREST);const Xt=ge.getMorphValuesForProxy(It.key),Ln=Xt?1:0;let zn;Xt&&(zn={morphing:{srcDemTile:Xt.from,dstDemTile:Xt.to,phase:l.easeCubicInOut(Xt.phase)}});const di=Lr(It.projMatrix,ae(It.canonical,ze.renderWorldCopies)?tt/10:tt);Ge(Ln,et),M.setupElevationDraw(Ct,De,zn),E.prepareDrawProgram(de,De,It.toUnwrapped()),De.draw(de,Mt,$e,Vt,He,l.CullFaceMode.backCCW,di,"terrain_raster",M.gridBuffer,Et,yt)}})}}(u,this,this.proxySourceCache,i,this._updateTimestamp),this.renderingToTexture=!0,u.gpuTimingDeferredRenderEnd(),i.splice(0,i.length))}renderBatch(i){if(0===this._drapedRenderBatches.length)return i+1;this.renderingToTexture=!0;const u=this.painter,m=this.painter.context,E=this.proxySourceCache,M=this.proxiedCoords[E.id],z=this._drapedRenderBatches.shift(),Z=[],K=u.style.order;let de=0;for(const pe of M){const De=E.getTileByID(pe.proxyTileKey),Fe=E.proxyCachedFBO[pe.key]?E.proxyCachedFBO[pe.key][i]:void 0,Je=void 0!==Fe?E.renderCache[Fe]:this.pool[de++],Ge=void 0!==Fe;if(De.texture=Je.tex,Ge&&!Je.dirty){Z.push(De.tileID);continue}let He;m.bindFramebuffer.set(Je.fb.framebuffer),this.renderedToTile=!1,Je.dirty&&(m.clear({color:l.Color.transparent,stencil:0}),Je.dirty=!1);for(let $e=z.start;$e<=z.end;++$e){const ze=u.style._layers[K[$e]];if(ze.isHidden(u.transform.zoom))continue;const tt=u.style._getLayerSourceCache(ze),et=tt?this.proxyToSource[pe.key][tt.id]:[pe];if(!et)continue;const Mt=et;m.viewport.set([0,0,Je.fb.width,Je.fb.height]),He!==(tt?tt.id:null)&&(this._setupStencil(Je,et,ze,tt),He=tt?tt.id:null),u.renderLayer(u,tt,ze,Mt)}this.renderedToTile?(Je.dirty=!0,Z.push(De.tileID)):Ge||--de,5===de&&(de=0,this.renderToBackBuffer(Z))}return this.renderToBackBuffer(Z),this.renderingToTexture=!1,m.bindFramebuffer.set(null),m.viewport.set([0,0,u.width,u.height]),z.end+1}postRender(){}renderCacheEfficiency(i){const u=i.order.length;if(0===u)return{efficiency:100};let m,E=0,M=0,z=!1;for(let Z=0;Z<u;++Z){const K=i._layers[i.order[Z]];this._style.isLayerDraped(K)?(z&&++E,++M):z||(z=!0,m=K.id)}return 0===M?{efficiency:100}:{efficiency:100*(1-E/M),firstUndrapedLayer:m}}getMinElevationBelowMSL(){let i=0;return this._visibleDemTiles.filter(u=>u.dem).forEach(u=>{i=Math.min(i,u.dem.tree.minimums[0])}),0===i?i:(i-30)*this._exaggeration}raycast(i,u,m){if(!this._visibleDemTiles)return null;const E=this._visibleDemTiles.filter(M=>M.dem).map(M=>{const z=M.tileID,Z=1<<z.overscaledZ,{x:K,y:de}=z.canonical,pe=K/Z,De=(K+1)/Z,Fe=de/Z,Je=(de+1)/Z;return{minx:pe,miny:Fe,maxx:De,maxy:Je,t:M.dem.tree.raycastRoot(pe,Fe,De,Je,i,u,m),tile:M}});E.sort((M,z)=>(null!==M.t?M.t:Number.MAX_VALUE)-(null!==z.t?z.t:Number.MAX_VALUE));for(const M of E){if(null==M.t)return null;const z=M.tile.dem.tree.raycast(M.minx,M.miny,M.maxx,M.maxy,i,u,m);if(null!=z)return z}return null}_createFBO(){const i=this.painter.context,u=i.gl,m=this.drapeBufferSize;i.activeTexture.set(u.TEXTURE0);const E=new l.Texture(i,{width:m[0],height:m[1],data:null},u.RGBA);E.bind(u.LINEAR,u.CLAMP_TO_EDGE);const M=i.createFramebuffer(m[0],m[1],!1);return M.colorAttachment.set(E.texture),M.depthAttachment=new Te(i,M.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=i.createRenderbuffer(i.gl.DEPTH_STENCIL,m[0],m[1]),this._stencilRef=0,M.depthAttachment.set(this._sharedDepthStencil),i.clear({stencil:0})):M.depthAttachment.set(this._sharedDepthStencil),i.extTextureFilterAnisotropic&&!i.extTextureFilterAnisotropicForceOff&&u.texParameterf(u.TEXTURE_2D,i.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,i.extTextureFilterAnisotropicMax),{fb:M,tex:E,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const i in this._style._sourceCaches)if(this._style._sourceCaches[i].hasTransition())return!0;return this._style.order.some(i=>{const u=this._style._layers[i],m=u.isHidden(this.painter.transform.zoom),E=u.getCrossfadeParameters(),M=!!E&&1!==E.t,z=u.hasTransition();return"custom"!==u.type&&!m&&(M||z)})}_clearRasterFadeFromRenderCache(){let i=!1;for(const u in this._style._sourceCaches)if(this._style._sourceCaches[u]._source instanceof Xe){i=!0;break}if(i)for(let u=0;u<this._style.order.length;++u){const m=this._style._layers[this._style.order[u]],E=m.isHidden(this.painter.transform.zoom),M=this._style._getLayerSourceCache(m);if("raster"!==m.type||E||!M)continue;const z=m.paint.get("raster-fade-duration");for(const Z of this.proxyCoords){const K=this.proxyToSource[Z.key][M.id];if(K)for(const de of K){const pe=gn(M.getTile(de),M.findLoadedParent(de,0),M,this.painter.transform,z);(1!==pe.opacity||0!==pe.mix)&&this._clearRenderCacheForTile(M.id,de)}}}}_setupDrapedRenderBatches(){const i=this._style.order,u=i.length;if(0===u)return;const m=[];let E,M=0,z=this._style._layers[i[M]];for(;!this._style.isLayerDraped(z)&&z.isHidden(this.painter.transform.zoom)&&++M<u;)z=this._style._layers[i[M]];for(;M<u;++M){const Z=this._style._layers[i[M]];Z.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(Z)?void 0===E&&(E=M):void 0!==E&&(m.push({start:E,end:M-1}),E=void 0))}void 0!==E&&m.push({start:E,end:M-1}),this._drapedRenderBatches=m}_setupRenderCache(i){const u=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,u.renderCache.length>u.renderCachePool.length){const z=Object.values(u.proxyCachedFBO);u.proxyCachedFBO={};for(let Z=0;Z<z.length;++Z){const K=Object.values(z[Z]);u.renderCachePool.push(...K)}}return}this._clearRasterFadeFromRenderCache();const m=this.proxyCoords,E=this._tilesDirty;for(let z=m.length-1;z>=0;z--){const Z=m[z];if(u.getTileByID(Z.key),void 0!==u.proxyCachedFBO[Z.key]){const K=i[Z.key],de=this.proxyToSource[Z.key];let pe=0;for(const De in de){const Fe=de[De],Je=K[De];if(!Je||Je.length!==Fe.length||Fe.some((Ge,He)=>Ge!==Je[He]||E[De]&&E[De].hasOwnProperty(Ge.key))){pe=-1;break}++pe}for(const De in u.proxyCachedFBO[Z.key])u.renderCache[u.proxyCachedFBO[Z.key][De]].dirty=pe<0||pe!==Object.values(K).length}}const M=[...this._drapedRenderBatches];M.sort((z,Z)=>Z.end-Z.start-(z.end-z.start));for(const z of M)for(const Z of m){if(u.proxyCachedFBO[Z.key])continue;let K=u.renderCachePool.pop();void 0===K&&u.renderCache.length<50&&(K=u.renderCache.length,u.renderCache.push(this._createFBO())),void 0!==K&&(u.proxyCachedFBO[Z.key]={},u.proxyCachedFBO[Z.key][z.start]=K,u.renderCache[K].dirty=!0)}this._tilesDirty={}}_setupStencil(i,u,m,E){if(!E||!this._sourceTilesOverlap[E.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const M=this.painter.context,z=M.gl;if(u.length<=1)return void(this._overlapStencilType=!1);let Z;if(m.isTileClipped())Z=u.length,this._overlapStencilMode.test={func:z.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(u[0].overscaledZ>u[u.length-1].overscaledZ))return void(this._overlapStencilType=!1);Z=1,this._overlapStencilMode.test={func:z.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+Z>255&&(M.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=Z,this._overlapStencilMode.ref=this._stencilRef,m.isTileClipped()&&this._renderTileClippingMasks(u,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(i){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[i.key]),this._overlapStencilMode):l.StencilMode.disabled}_renderTileClippingMasks(i,u){const m=this.painter,E=this.painter.context,M=E.gl;m._tileClippingMaskIDs={},E.setColorMode(l.ColorMode.disabled),E.setDepthMode(l.DepthMode.disabled);const z=m.useProgram("clippingMask");for(const Z of i){const K=m._tileClippingMaskIDs[Z.key]=--u;z.draw(E,M.TRIANGLES,l.DepthMode.disabled,new l.StencilMode({func:M.ALWAYS,mask:0},K,255,M.KEEP,M.KEEP,M.REPLACE),l.ColorMode.disabled,l.CullFaceMode.disabled,Re(Z.projMatrix),"$clipping",m.tileExtentBuffer,m.quadTriangleIndexBuffer,m.tileExtentSegments)}}pointCoordinate(i){const u=this.painter.transform;if(i.x<0||i.x>u.width||i.y<0||i.y>u.height)return null;const m=[i.x,i.y,1,1];l.transformMat4$1(m,m,u.pixelMatrixInverse),l.scale$1(m,m,1/m[3]),m[0]/=u.worldSize,m[1]/=u.worldSize;const E=u._camera.position,M=l.mercatorZfromAltitude(1,u.center.lat),z=[E[0],E[1],E[2]/M,0],Z=l.subtract([],m.slice(0,3),z);l.normalize(Z,Z);const K=this.raycast(z,Z,this._exaggeration);return null!==K&&K?(l.scaleAndAdd(z,z,Z,K),z[3]=z[2],z[2]*=M,z):null}drawDepth(){const i=this.painter,u=i.context,m=this.proxySourceCache,E=Math.ceil(i.width),M=Math.ceil(i.height);if(!this._depthFBO||this._depthFBO.width===E&&this._depthFBO.height===M||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const z=u.gl,Z=u.createFramebuffer(E,M,!0);u.activeTexture.set(z.TEXTURE0);const K=new l.Texture(u,{width:E,height:M,data:null},z.RGBA);K.bind(z.NEAREST,z.CLAMP_TO_EDGE),Z.colorAttachment.set(K.texture);const de=u.createRenderbuffer(u.gl.DEPTH_COMPONENT16,E,M);Z.depthAttachment.set(de),this._depthFBO=Z,this._depthTexture=K}u.bindFramebuffer.set(this._depthFBO.framebuffer),u.viewport.set([0,0,E,M]),function(z,Z,K,de){if("globe"===z.transform.projection.name)return;const pe=z.context,De=pe.gl;pe.clear({depth:1});const Fe=z.useProgram("terrainDepth"),Je=new l.DepthMode(De.LESS,l.DepthMode.ReadWrite,z.depthRangeFor3D);for(const Ge of de){const He=K.getTile(Ge),$e=Lr(Ge.projMatrix,0);Z.setupElevationDraw(He,Fe),Fe.draw(pe,De.TRIANGLES,Je,l.StencilMode.disabled,l.ColorMode.unblended,l.CullFaceMode.backCCW,$e,"terrain_depth",Z.gridBuffer,Z.gridIndexBuffer,Z.gridNoSkirtSegments)}}(i,this,m,this.proxyCoords)}_setupProxiedCoordsForOrtho(i,u,m){if(i.getSource()instanceof Rt)return this._setupProxiedCoordsForImageSource(i,u,m);this._findCoveringTileCache[i.id]=this._findCoveringTileCache[i.id]||{};const E=this.proxiedCoords[i.id]=[],M=this.proxyCoords;for(let Z=0;Z<M.length;Z++){const K=M[Z],de=this._findTileCoveringTileID(K,i);if(de){const pe=this._createProxiedId(K,de,m[K.key]&&m[K.key][i.id]);E.push(pe),this.proxyToSource[K.key][i.id]=[pe]}}let z=!1;for(let Z=0;Z<u.length;Z++){const K=i.getTile(u[Z]);if(!K||!K.hasData())continue;const de=this._findTileCoveringTileID(K.tileID,this.proxySourceCache);if(de&&de.tileID.canonical.z!==K.tileID.canonical.z){const pe=this.proxyToSource[de.tileID.key][i.id],De=this._createProxiedId(de.tileID,K,m[de.tileID.key]&&m[de.tileID.key][i.id]);pe?pe.splice(pe.length-1,0,De):this.proxyToSource[de.tileID.key][i.id]=[De],E.push(De),z=!0}}this._sourceTilesOverlap[i.id]=z}_setupProxiedCoordsForImageSource(i,u,m){if(!i.getSource().loaded())return;const E=this.proxiedCoords[i.id]=[],M=this.proxyCoords,z=i.getSource(),Z=new l.pointGeometry(z.tileID.x,z.tileID.y)._div(1<<z.tileID.z),K=z.coordinates.map(l.MercatorCoordinate.fromLngLat).reduce((pe,De)=>(pe.min.x=Math.min(pe.min.x,De.x-Z.x),pe.min.y=Math.min(pe.min.y,De.y-Z.y),pe.max.x=Math.max(pe.max.x,De.x-Z.x),pe.max.y=Math.max(pe.max.y,De.y-Z.y),pe),{min:new l.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new l.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),de=(pe,De)=>{const Fe=pe.wrap+pe.canonical.x/(1<<pe.canonical.z),Je=pe.canonical.y/(1<<pe.canonical.z),Ge=l.EXTENT/(1<<pe.canonical.z),He=De.wrap+De.canonical.x/(1<<De.canonical.z),$e=De.canonical.y/(1<<De.canonical.z);return Fe+Ge<He+K.min.x||Fe>He+K.max.x||Je+Ge<$e+K.min.y||Je>$e+K.max.y};for(let pe=0;pe<M.length;pe++){const De=M[pe];for(let Fe=0;Fe<u.length;Fe++){const Je=i.getTile(u[Fe]);if(!Je||!Je.hasData()||de(De,Je.tileID))continue;const Ge=this._createProxiedId(De,Je,m[De.key]&&m[De.key][i.id]),He=this.proxyToSource[De.key][i.id];He?He.push(Ge):this.proxyToSource[De.key][i.id]=[Ge],E.push(Ge)}}}_createProxiedId(i,u,m){let E=this.orthoMatrix;if(m){const M=m.find(z=>z.key===u.tileID.key);if(M)return M}if(u.tileID.key!==i.key){const M=i.canonical.z-u.tileID.canonical.z;let z,Z,K;E=l.create();const de=u.tileID.wrap-i.wrap<<i.overscaledZ;M>0?(z=l.EXTENT>>M,Z=z*((u.tileID.canonical.x<<M)-i.canonical.x+de),K=z*((u.tileID.canonical.y<<M)-i.canonical.y)):(z=l.EXTENT<<-M,Z=l.EXTENT*(u.tileID.canonical.x-(i.canonical.x+de<<-M)),K=l.EXTENT*(u.tileID.canonical.y-(i.canonical.y<<-M))),l.ortho(E,0,z,0,z,0,1),l.translate(E,E,[Z,K,0])}return new Jo(u.tileID,i.key,E)}_findTileCoveringTileID(i,u){let m=u.getTile(i);if(m&&m.hasData())return m;const E=this._findCoveringTileCache[u.id],M=E[i.key];if(m=M?u.getTileByID(M):null,m&&m.hasData()||null===M)return m;let z=m?m.tileID:i,Z=z.overscaledZ;const K=u.getSource().minzoom,de=[];if(!M){const De=u.getSource().maxzoom;if(i.canonical.z>=De){const Fe=i.canonical.z-De;u.getSource().reparseOverscaled?(Z=Math.max(i.canonical.z+2,u.transform.tileZoom),z=new l.OverscaledTileID(Z,i.wrap,De,i.canonical.x>>Fe,i.canonical.y>>Fe)):0!==Fe&&(Z=De,z=new l.OverscaledTileID(Z,i.wrap,De,i.canonical.x>>Fe,i.canonical.y>>Fe))}z.key!==i.key&&(de.push(z.key),m=u.getTile(z))}const pe=De=>{de.forEach(Fe=>{E[Fe]=De}),de.length=0};for(Z-=1;Z>=K&&(!m||!m.hasData());Z--){m&&pe(m.tileID.key);const De=z.calculateScaledKey(Z);if(m=u.getTileByID(De),m&&m.hasData())break;const Fe=E[De];if(null===Fe)break;void 0===Fe?de.push(De):m=u.getTileByID(Fe)}return pe(m?m.tileID.key:null),m&&m.hasData()?m:null}findDEMTileFor(i){return this.enabled?this._findTileCoveringTileID(i,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(i,u){let m=this._tilesDirty[i];m||(m=this._tilesDirty[i]={}),m[u.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const i=function(u){let m=0;const E=new l.StructArrayLayout2ui4,M=131;for(let z=1;z<129;z++){for(let Z=1;Z<129;Z++)m=z*M+Z,E.emplaceBack(m,m+1),E.emplaceBack(m,m+M),E.emplaceBack(m+1,m+M),128===z&&E.emplaceBack(m+M,m+M+1);E.emplaceBack(m+1,m+1+M)}return E}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(i),this.wireframeSegments=l.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,i.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class bs{static cacheKey(i,u,m,E){let M=`${u}${E?E.cacheKey:""}`;for(const z of m)i.usedDefines.includes(z)&&(M+=`/${z}`);return M}constructor(i,u,m,E,M,z){const Z=i.gl;this.program=Z.createProgram();const K=function($e){const ze=[];for(let tt=0;tt<$e.length;tt++){if(null===$e[tt])continue;const et=$e[tt].split(" ");ze.push(et.pop())}return ze}(m.staticAttributes),de=E?E.getBinderAttributes():[],pe=K.concat(de);let De=E?E.defines():[];De=De.concat(z.map($e=>`#define ${$e}`));const Fe=De.concat(i.extStandardDerivatives?"#extension GL_OES_standard_derivatives : enable\n".concat(ee):ee,ee,le,Y.fragmentSource,Ae.fragmentSource,m.fragmentSource).join("\n"),Je=De.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",le,Y.vertexSource,Ae.vertexSource,Ee.vertexSource,m.vertexSource).join("\n"),Ge=Z.createShader(Z.FRAGMENT_SHADER);if(Z.isContextLost())return void(this.failedToCreate=!0);Z.shaderSource(Ge,Fe),Z.compileShader(Ge),Z.attachShader(this.program,Ge);const He=Z.createShader(Z.VERTEX_SHADER);if(Z.isContextLost())this.failedToCreate=!0;else{Z.shaderSource(He,Je),Z.compileShader(He),Z.attachShader(this.program,He),this.attributes={},this.numAttributes=pe.length;for(let $e=0;$e<this.numAttributes;$e++)pe[$e]&&(Z.bindAttribLocation(this.program,$e,pe[$e]),this.attributes[pe[$e]]=$e);Z.linkProgram(this.program),Z.deleteShader(He),Z.deleteShader(Ge),this.fixedUniforms=M(i),this.binderUniforms=E?E.getUniforms(i):[],-1!==z.indexOf("TERRAIN")&&(this.terrainUniforms={u_dem:new l.Uniform1i($e=i),u_dem_prev:new l.Uniform1i($e),u_dem_unpack:new l.Uniform4f($e),u_dem_tl:new l.Uniform2f($e),u_dem_scale:new l.Uniform1f($e),u_dem_tl_prev:new l.Uniform2f($e),u_dem_scale_prev:new l.Uniform1f($e),u_dem_size:new l.Uniform1f($e),u_dem_lerp:new l.Uniform1f($e),u_exaggeration:new l.Uniform1f($e),u_depth:new l.Uniform1i($e),u_depth_size_inv:new l.Uniform2f($e),u_meter_to_dem:new l.Uniform1f($e),u_label_plane_matrix_inv:new l.UniformMatrix4f($e),u_tile_tl_up:new l.Uniform3f($e),u_tile_tr_up:new l.Uniform3f($e),u_tile_br_up:new l.Uniform3f($e),u_tile_bl_up:new l.Uniform3f($e),u_tile_up_scale:new l.Uniform1f($e)}),-1!==z.indexOf("FOG")&&(this.fogUniforms=($e=>({u_fog_matrix:new l.UniformMatrix4f($e),u_fog_range:new l.Uniform2f($e),u_fog_color:new l.Uniform4f($e),u_fog_horizon_blend:new l.Uniform1f($e),u_fog_temporal_offset:new l.Uniform1f($e),u_frustum_tl:new l.Uniform3f($e),u_frustum_tr:new l.Uniform3f($e),u_frustum_br:new l.Uniform3f($e),u_frustum_bl:new l.Uniform3f($e),u_globe_pos:new l.Uniform3f($e),u_globe_radius:new l.Uniform1f($e),u_globe_transition:new l.Uniform1f($e),u_is_globe:new l.Uniform1i($e),u_viewport:new l.Uniform2f($e)}))(i))}var $e}setTerrainUniformValues(i,u){if(!this.terrainUniforms)return;const m=this.terrainUniforms;if(!this.failedToCreate){i.program.set(this.program);for(const E in u)m[E].set(this.program,E,u[E])}}setFogUniformValues(i,u){if(!this.fogUniforms)return;const m=this.fogUniforms;if(!this.failedToCreate){i.program.set(this.program);for(const E in u)m[E].set(this.program,E,u[E])}}draw(i,u,m,E,M,z,Z,K,de,pe,De,Fe,Je,Ge,He){const $e=i.gl;if(this.failedToCreate)return;i.program.set(this.program),i.setDepthMode(m),i.setStencilMode(E),i.setColorMode(M),i.setCullFace(z);for(const tt of Object.keys(this.fixedUniforms))this.fixedUniforms[tt].set(this.program,tt,Z[tt]);Ge&&Ge.setUniforms(this.program,i,this.binderUniforms,Fe,{zoom:Je});const ze={[$e.LINES]:2,[$e.TRIANGLES]:3,[$e.LINE_STRIP]:1}[u];for(const tt of De.get()){const et=tt.vaos||(tt.vaos={});(et[K]||(et[K]=new mt)).bind(i,this,de,Ge?Ge.getPaintVertexBuffers():[],pe,tt.vertexOffset,He||[]),$e.drawElements(u,tt.primitiveLength*ze,$e.UNSIGNED_SHORT,tt.primitiveOffset*ze*2)}}}function No(d,i,u){const m=1/wi(u,1,i.transform.tileZoom),E=Math.pow(2,u.tileID.overscaledZ),M=u.tileSize*Math.pow(2,i.transform.tileZoom)/E,z=M*(u.tileID.canonical.x+u.tileID.wrap*E),Z=M*u.tileID.canonical.y;return{u_image:0,u_texsize:u.imageAtlasTexture.size,u_scale:[m,d.fromScale,d.toScale],u_fade:d.t,u_pixel_coord_upper:[z>>16,Z>>16],u_pixel_coord_lower:[65535&z,65535&Z]}}const xs=l.create(),ka=(d,i,u,m,E,M,z,Z,K,de,pe)=>{const De=i.style.light,Fe=De.properties.get("position"),Je=[Fe.x,Fe.y,Fe.z],Ge=l.create$1();"viewport"===De.properties.get("anchor")&&(l.fromRotation(Ge,-i.transform.angle),l.transformMat3(Je,Je,Ge));const He=De.properties.get("color"),$e=i.transform,ze={u_matrix:d,u_lightpos:Je,u_lightintensity:De.properties.get("intensity"),u_lightcolor:[He.r,He.g,He.b],u_vertical_gradient:+u,u_opacity:m,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:xs,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:E,u_edge_radius:M};return"globe"===$e.projection.name&&(ze.u_tile_id=[z.canonical.x,z.canonical.y,1<<z.canonical.z],ze.u_zoom_transition=K,ze.u_inv_rot_matrix=pe,ze.u_merc_center=de,ze.u_up_dir=$e.projection.upVector(new l.CanonicalTileID(0,0,0),de[0]*l.EXTENT,de[1]*l.EXTENT),ze.u_height_lift=Z),ze},ta=(d,i,u,m,E,M,z,Z,K,de,pe,De,Fe)=>{const Je=ka(d,i,u,m,E,M,z,de,pe,De,Fe),Ge={u_height_factor:-Math.pow(2,z.overscaledZ)/K.tileSize/8};return l.extend(Je,No(Z,i,K),Ge)},Hn=d=>({u_matrix:d}),ki=(d,i,u,m)=>l.extend(Hn(d),No(u,i,m)),Go=(d,i)=>({u_matrix:d,u_world:i}),os=(d,i,u,m,E)=>l.extend(ki(d,i,u,m),{u_world:E}),Na=l.create(),La=(d,i,u,m,E,M)=>{const z=d.transform,Z="globe"===z.projection.name;let K;if("map"===M.paint.get("circle-pitch-alignment"))if(Z){const pe=l.globePixelsToTileUnits(z.zoom,i.canonical)*z._pixelsPerMercatorPixel;K=Float32Array.from([pe,0,0,pe])}else K=z.calculatePixelsToTileUnitsMatrix(u);else K=new Float32Array([z.pixelsToGLUnits[0],0,0,z.pixelsToGLUnits[1]]);const de={u_camera_to_center_distance:z.cameraToCenterDistance,u_matrix:d.translatePosMatrix(i.projMatrix,u,M.paint.get("circle-translate"),M.paint.get("circle-translate-anchor")),u_device_pixel_ratio:l.exported.devicePixelRatio,u_extrude_scale:K,u_inv_rot_matrix:Na,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(Z){de.u_inv_rot_matrix=m,de.u_merc_center=E,de.u_tile_id=[i.canonical.x,i.canonical.y,1<<i.canonical.z],de.u_zoom_transition=l.globeToMercatorTransition(z.zoom);const pe=E[0]*l.EXTENT,De=E[1]*l.EXTENT;de.u_up_dir=z.projection.upVector(new l.CanonicalTileID(0,0,0),pe,De)}return de},Qo=d=>{const i=[];return"map"===d.paint.get("circle-pitch-alignment")&&i.push("PITCH_WITH_MAP"),"map"===d.paint.get("circle-pitch-scale")&&i.push("SCALE_WITH_MAP"),i},yl=(d,i,u,m)=>{const E=l.EXTENT/u.tileSize;return{u_matrix:d,u_camera_to_center_distance:i.getCameraToCenterDistance(m),u_extrude_scale:[i.pixelsToGLUnits[0]/E,i.pixelsToGLUnits[1]/E]}},Ua=(d,i,u=1)=>({u_matrix:d,u_color:i,u_overlay:0,u_overlay_scale:u}),hl=l.create(),Ya=(d,i,u,m,E,M,z)=>{const Z=d.transform,K="globe"===Z.projection.name,de=K?l.globePixelsToTileUnits(Z.zoom,i.canonical)*Z._pixelsPerMercatorPixel:wi(u,1,M),pe={u_matrix:i.projMatrix,u_extrude_scale:de,u_intensity:z,u_inv_rot_matrix:hl,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(K){pe.u_inv_rot_matrix=m,pe.u_merc_center=E,pe.u_tile_id=[i.canonical.x,i.canonical.y,1<<i.canonical.z],pe.u_zoom_transition=l.globeToMercatorTransition(Z.zoom);const De=E[0]*l.EXTENT,Fe=E[1]*l.EXTENT;pe.u_up_dir=Z.projection.upVector(new l.CanonicalTileID(0,0,0),De,Fe)}return pe},Ma=(d,i,u,m,E,M,z,Z)=>{const K=d.transform,de=K.calculatePixelsToTileUnitsMatrix(i),pe={u_matrix:ba(d,i,u,E),u_pixels_to_tile_units:de,u_device_pixel_ratio:z,u_units_to_pixels:[1/K.pixelsToGLUnits[0],1/K.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:M,u_texsize:[0,0],u_scale:[0,0,0],u_mix:0,u_alpha_discard_threshold:0,u_trim_offset:Z};if(Ka(u)){const De=ss(i,d.transform);pe.u_texsize=i.lineAtlasTexture.size,pe.u_scale=[De,m.fromScale,m.toScale],pe.u_mix=m.t}return pe},Ws=(d,i,u,m,E,M)=>{const z=d.transform,Z=ss(i,z);return{u_matrix:ba(d,i,u,E),u_texsize:i.imageAtlasTexture.size,u_pixels_to_tile_units:z.calculatePixelsToTileUnitsMatrix(i),u_device_pixel_ratio:M,u_image:0,u_scale:[Z,m.fromScale,m.toScale],u_fade:m.t,u_units_to_pixels:[1/z.pixelsToGLUnits[0],1/z.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function ss(d,i){return 1/wi(d,1,i.tileZoom)}function ba(d,i,u,m){return d.translatePosMatrix(m||i.tileID.projMatrix,i,u.paint.get("line-translate"),u.paint.get("line-translate-anchor"))}function Ka(d){const i=d.paint.get("line-dasharray").value;return i.value||"constant"!==i.kind}const xa=(d,i,u,m,E,M)=>{return{u_matrix:d,u_tl_parent:i,u_scale_parent:u,u_fade_t:m.mix,u_opacity:m.opacity*E.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:E.paint.get("raster-brightness-min"),u_brightness_high:E.paint.get("raster-brightness-max"),u_saturation_factor:(Z=E.paint.get("raster-saturation"),Z>0?1-1/(1.001-Z):-Z),u_contrast_factor:(z=E.paint.get("raster-contrast"),z>0?1/(1-z):1+z),u_spin_weights:gs(E.paint.get("raster-hue-rotate")),u_perspective_transform:M};var z,Z};function gs(d){d*=Math.PI/180;const i=Math.sin(d),u=Math.cos(d);return[(2*u+1)/3,(-Math.sqrt(3)*i-u+1)/3,(Math.sqrt(3)*i-u+1)/3]}const vl=l.create(),Is=(d,i,u,m,E,M,z,Z,K,de,pe,De,Fe,Je,Ge,He)=>{const $e=E.transform,ze={u_is_size_zoom_constant:+("constant"===d||"source"===d),u_is_size_feature_constant:+("constant"===d||"camera"===d),u_size_t:i?i.uSizeT:0,u_size:i?i.uSize:0,u_camera_to_center_distance:$e.cameraToCenterDistance,u_rotate_symbol:+u,u_aspect_ratio:$e.width/$e.height,u_fade_change:E.options.fadeDuration?E.symbolFadeChange:1,u_matrix:M,u_label_plane_matrix:z,u_coord_matrix:Z,u_is_text:+K,u_pitch_with_map:+m,u_texsize:de,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:vl,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:vl,u_up_vector:[0,-1,0]};return"globe"===He.name&&(ze.u_tile_id=[pe.canonical.x,pe.canonical.y,1<<pe.canonical.z],ze.u_zoom_transition=De,ze.u_inv_rot_matrix=Je,ze.u_merc_center=Fe,ze.u_camera_forward=$e._camera.forward(),ze.u_ecef_origin=l.globeECEFOrigin($e.globeMatrix,pe.toUnwrapped()),ze.u_tile_matrix=Float32Array.from($e.globeMatrix),ze.u_up_vector=Ge),ze},wa=(d,i,u,m,E,M,z,Z,K,de,pe,De,Fe,Je,Ge,He,$e)=>l.extend(Is(d,i,u,m,E,M,z,Z,K,de,De,Fe,Je,Ge,He,$e),{u_gamma_scale:m?E.transform.cameraToCenterDistance*Math.cos(E.terrain?0:E.transform._pitch):1,u_device_pixel_ratio:l.exported.devicePixelRatio,u_is_halo:+pe}),_s=(d,i,u,m,E,M,z,Z,K,de,pe,De,Fe,Je,Ge,He)=>l.extend(wa(d,i,u,m,E,M,z,Z,!0,K,!0,pe,De,Fe,Je,Ge,He),{u_texsize_icon:de,u_texture_icon:1}),Va=(d,i,u)=>({u_matrix:d,u_opacity:i,u_color:u}),Ia=(d,i,u,m,E,M)=>l.extend(function(z,Z,K,de){const pe=K.imageManager.getPattern(z.from.toString()),De=K.imageManager.getPattern(z.to.toString()),{width:Fe,height:Je}=K.imageManager.getPixelSize(),Ge=Math.pow(2,de.tileID.overscaledZ),He=de.tileSize*Math.pow(2,K.transform.tileZoom)/Ge,$e=He*(de.tileID.canonical.x+de.tileID.wrap*Ge),ze=He*de.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:pe.tl,u_pattern_br_a:pe.br,u_pattern_tl_b:De.tl,u_pattern_br_b:De.br,u_texsize:[Fe,Je],u_mix:Z.t,u_pattern_size_a:pe.displaySize,u_pattern_size_b:De.displaySize,u_scale_a:Z.fromScale,u_scale_b:Z.toScale,u_tile_units_to_pixels:1/wi(de,1,K.transform.tileZoom),u_pixel_coord_upper:[$e>>16,ze>>16],u_pixel_coord_lower:[65535&$e,65535&ze]}}(m,M,u,E),{u_matrix:d,u_opacity:i}),bl={fillExtrusion:d=>({u_matrix:new l.UniformMatrix4f(d),u_lightpos:new l.Uniform3f(d),u_lightintensity:new l.Uniform1f(d),u_lightcolor:new l.Uniform3f(d),u_vertical_gradient:new l.Uniform1f(d),u_opacity:new l.Uniform1f(d),u_edge_radius:new l.Uniform1f(d),u_ao:new l.Uniform2f(d),u_tile_id:new l.Uniform3f(d),u_zoom_transition:new l.Uniform1f(d),u_inv_rot_matrix:new l.UniformMatrix4f(d),u_merc_center:new l.Uniform2f(d),u_up_dir:new l.Uniform3f(d),u_height_lift:new l.Uniform1f(d)}),fillExtrusionPattern:d=>({u_matrix:new l.UniformMatrix4f(d),u_lightpos:new l.Uniform3f(d),u_lightintensity:new l.Uniform1f(d),u_lightcolor:new l.Uniform3f(d),u_vertical_gradient:new l.Uniform1f(d),u_height_factor:new l.Uniform1f(d),u_edge_radius:new l.Uniform1f(d),u_ao:new l.Uniform2f(d),u_tile_id:new l.Uniform3f(d),u_zoom_transition:new l.Uniform1f(d),u_inv_rot_matrix:new l.UniformMatrix4f(d),u_merc_center:new l.Uniform2f(d),u_up_dir:new l.Uniform3f(d),u_height_lift:new l.Uniform1f(d),u_image:new l.Uniform1i(d),u_texsize:new l.Uniform2f(d),u_pixel_coord_upper:new l.Uniform2f(d),u_pixel_coord_lower:new l.Uniform2f(d),u_scale:new l.Uniform3f(d),u_fade:new l.Uniform1f(d),u_opacity:new l.Uniform1f(d)}),fill:d=>({u_matrix:new l.UniformMatrix4f(d)}),fillPattern:d=>({u_matrix:new l.UniformMatrix4f(d),u_image:new l.Uniform1i(d),u_texsize:new l.Uniform2f(d),u_pixel_coord_upper:new l.Uniform2f(d),u_pixel_coord_lower:new l.Uniform2f(d),u_scale:new l.Uniform3f(d),u_fade:new l.Uniform1f(d)}),fillOutline:d=>({u_matrix:new l.UniformMatrix4f(d),u_world:new l.Uniform2f(d)}),fillOutlinePattern:d=>({u_matrix:new l.UniformMatrix4f(d),u_world:new l.Uniform2f(d),u_image:new l.Uniform1i(d),u_texsize:new l.Uniform2f(d),u_pixel_coord_upper:new l.Uniform2f(d),u_pixel_coord_lower:new l.Uniform2f(d),u_scale:new l.Uniform3f(d),u_fade:new l.Uniform1f(d)}),circle:d=>({u_camera_to_center_distance:new l.Uniform1f(d),u_extrude_scale:new l.UniformMatrix2f(d),u_device_pixel_ratio:new l.Uniform1f(d),u_matrix:new l.UniformMatrix4f(d),u_inv_rot_matrix:new l.UniformMatrix4f(d),u_merc_center:new l.Uniform2f(d),u_tile_id:new l.Uniform3f(d),u_zoom_transition:new l.Uniform1f(d),u_up_dir:new l.Uniform3f(d)}),collisionBox:d=>({u_matrix:new l.UniformMatrix4f(d),u_camera_to_center_distance:new l.Uniform1f(d),u_extrude_scale:new l.Uniform2f(d)}),collisionCircle:d=>({u_matrix:new l.UniformMatrix4f(d),u_inv_matrix:new l.UniformMatrix4f(d),u_camera_to_center_distance:new l.Uniform1f(d),u_viewport_size:new l.Uniform2f(d)}),debug:d=>({u_color:new l.UniformColor(d),u_matrix:new l.UniformMatrix4f(d),u_overlay:new l.Uniform1i(d),u_overlay_scale:new l.Uniform1f(d)}),clippingMask:d=>({u_matrix:new l.UniformMatrix4f(d)}),heatmap:d=>({u_extrude_scale:new l.Uniform1f(d),u_intensity:new l.Uniform1f(d),u_matrix:new l.UniformMatrix4f(d),u_inv_rot_matrix:new l.UniformMatrix4f(d),u_merc_center:new l.Uniform2f(d),u_tile_id:new l.Uniform3f(d),u_zoom_transition:new l.Uniform1f(d),u_up_dir:new l.Uniform3f(d)}),heatmapTexture:d=>({u_image:new l.Uniform1i(d),u_color_ramp:new l.Uniform1i(d),u_opacity:new l.Uniform1f(d)}),hillshade:d=>({u_matrix:new l.UniformMatrix4f(d),u_image:new l.Uniform1i(d),u_latrange:new l.Uniform2f(d),u_light:new l.Uniform2f(d),u_shadow:new l.UniformColor(d),u_highlight:new l.UniformColor(d),u_accent:new l.UniformColor(d)}),hillshadePrepare:d=>({u_matrix:new l.UniformMatrix4f(d),u_image:new l.Uniform1i(d),u_dimension:new l.Uniform2f(d),u_zoom:new l.Uniform1f(d),u_unpack:new l.Uniform4f(d)}),line:d=>({u_matrix:new l.UniformMatrix4f(d),u_pixels_to_tile_units:new l.UniformMatrix2f(d),u_device_pixel_ratio:new l.Uniform1f(d),u_units_to_pixels:new l.Uniform2f(d),u_dash_image:new l.Uniform1i(d),u_gradient_image:new l.Uniform1i(d),u_image_height:new l.Uniform1f(d),u_texsize:new l.Uniform2f(d),u_scale:new l.Uniform3f(d),u_mix:new l.Uniform1f(d),u_alpha_discard_threshold:new l.Uniform1f(d),u_trim_offset:new l.Uniform2f(d)}),linePattern:d=>({u_matrix:new l.UniformMatrix4f(d),u_texsize:new l.Uniform2f(d),u_pixels_to_tile_units:new l.UniformMatrix2f(d),u_device_pixel_ratio:new l.Uniform1f(d),u_image:new l.Uniform1i(d),u_units_to_pixels:new l.Uniform2f(d),u_scale:new l.Uniform3f(d),u_fade:new l.Uniform1f(d),u_alpha_discard_threshold:new l.Uniform1f(d)}),raster:d=>({u_matrix:new l.UniformMatrix4f(d),u_tl_parent:new l.Uniform2f(d),u_scale_parent:new l.Uniform1f(d),u_fade_t:new l.Uniform1f(d),u_opacity:new l.Uniform1f(d),u_image0:new l.Uniform1i(d),u_image1:new l.Uniform1i(d),u_brightness_low:new l.Uniform1f(d),u_brightness_high:new l.Uniform1f(d),u_saturation_factor:new l.Uniform1f(d),u_contrast_factor:new l.Uniform1f(d),u_spin_weights:new l.Uniform3f(d),u_perspective_transform:new l.Uniform2f(d)}),symbolIcon:d=>({u_is_size_zoom_constant:new l.Uniform1i(d),u_is_size_feature_constant:new l.Uniform1i(d),u_size_t:new l.Uniform1f(d),u_size:new l.Uniform1f(d),u_camera_to_center_distance:new l.Uniform1f(d),u_rotate_symbol:new l.Uniform1i(d),u_aspect_ratio:new l.Uniform1f(d),u_fade_change:new l.Uniform1f(d),u_matrix:new l.UniformMatrix4f(d),u_label_plane_matrix:new l.UniformMatrix4f(d),u_coord_matrix:new l.UniformMatrix4f(d),u_is_text:new l.Uniform1i(d),u_pitch_with_map:new l.Uniform1i(d),u_texsize:new l.Uniform2f(d),u_tile_id:new l.Uniform3f(d),u_zoom_transition:new l.Uniform1f(d),u_inv_rot_matrix:new l.UniformMatrix4f(d),u_merc_center:new l.Uniform2f(d),u_camera_forward:new l.Uniform3f(d),u_tile_matrix:new l.UniformMatrix4f(d),u_up_vector:new l.Uniform3f(d),u_ecef_origin:new l.Uniform3f(d),u_texture:new l.Uniform1i(d)}),symbolSDF:d=>({u_is_size_zoom_constant:new l.Uniform1i(d),u_is_size_feature_constant:new l.Uniform1i(d),u_size_t:new l.Uniform1f(d),u_size:new l.Uniform1f(d),u_camera_to_center_distance:new l.Uniform1f(d),u_rotate_symbol:new l.Uniform1i(d),u_aspect_ratio:new l.Uniform1f(d),u_fade_change:new l.Uniform1f(d),u_matrix:new l.UniformMatrix4f(d),u_label_plane_matrix:new l.UniformMatrix4f(d),u_coord_matrix:new l.UniformMatrix4f(d),u_is_text:new l.Uniform1i(d),u_pitch_with_map:new l.Uniform1i(d),u_texsize:new l.Uniform2f(d),u_texture:new l.Uniform1i(d),u_gamma_scale:new l.Uniform1f(d),u_device_pixel_ratio:new l.Uniform1f(d),u_tile_id:new l.Uniform3f(d),u_zoom_transition:new l.Uniform1f(d),u_inv_rot_matrix:new l.UniformMatrix4f(d),u_merc_center:new l.Uniform2f(d),u_camera_forward:new l.Uniform3f(d),u_tile_matrix:new l.UniformMatrix4f(d),u_up_vector:new l.Uniform3f(d),u_ecef_origin:new l.Uniform3f(d),u_is_halo:new l.Uniform1i(d)}),symbolTextAndIcon:d=>({u_is_size_zoom_constant:new l.Uniform1i(d),u_is_size_feature_constant:new l.Uniform1i(d),u_size_t:new l.Uniform1f(d),u_size:new l.Uniform1f(d),u_camera_to_center_distance:new l.Uniform1f(d),u_rotate_symbol:new l.Uniform1i(d),u_aspect_ratio:new l.Uniform1f(d),u_fade_change:new l.Uniform1f(d),u_matrix:new l.UniformMatrix4f(d),u_label_plane_matrix:new l.UniformMatrix4f(d),u_coord_matrix:new l.UniformMatrix4f(d),u_is_text:new l.Uniform1i(d),u_pitch_with_map:new l.Uniform1i(d),u_texsize:new l.Uniform2f(d),u_texsize_icon:new l.Uniform2f(d),u_texture:new l.Uniform1i(d),u_texture_icon:new l.Uniform1i(d),u_gamma_scale:new l.Uniform1f(d),u_device_pixel_ratio:new l.Uniform1f(d),u_is_halo:new l.Uniform1i(d)}),background:d=>({u_matrix:new l.UniformMatrix4f(d),u_opacity:new l.Uniform1f(d),u_color:new l.UniformColor(d)}),backgroundPattern:d=>({u_matrix:new l.UniformMatrix4f(d),u_opacity:new l.Uniform1f(d),u_image:new l.Uniform1i(d),u_pattern_tl_a:new l.Uniform2f(d),u_pattern_br_a:new l.Uniform2f(d),u_pattern_tl_b:new l.Uniform2f(d),u_pattern_br_b:new l.Uniform2f(d),u_texsize:new l.Uniform2f(d),u_mix:new l.Uniform1f(d),u_pattern_size_a:new l.Uniform2f(d),u_pattern_size_b:new l.Uniform2f(d),u_scale_a:new l.Uniform1f(d),u_scale_b:new l.Uniform1f(d),u_pixel_coord_upper:new l.Uniform2f(d),u_pixel_coord_lower:new l.Uniform2f(d),u_tile_units_to_pixels:new l.Uniform1f(d)}),terrainRaster:ji,terrainDepth:ji,skybox:d=>({u_matrix:new l.UniformMatrix4f(d),u_sun_direction:new l.Uniform3f(d),u_cubemap:new l.Uniform1i(d),u_opacity:new l.Uniform1f(d),u_temporal_offset:new l.Uniform1f(d)}),skyboxGradient:d=>({u_matrix:new l.UniformMatrix4f(d),u_color_ramp:new l.Uniform1i(d),u_center_direction:new l.Uniform3f(d),u_radius:new l.Uniform1f(d),u_opacity:new l.Uniform1f(d),u_temporal_offset:new l.Uniform1f(d)}),skyboxCapture:d=>({u_matrix_3f:new l.UniformMatrix3f(d),u_sun_direction:new l.Uniform3f(d),u_sun_intensity:new l.Uniform1f(d),u_color_tint_r:new l.Uniform4f(d),u_color_tint_m:new l.Uniform4f(d),u_luminance:new l.Uniform1f(d)}),globeRaster:d=>({u_proj_matrix:new l.UniformMatrix4f(d),u_globe_matrix:new l.UniformMatrix4f(d),u_normalize_matrix:new l.UniformMatrix4f(d),u_merc_matrix:new l.UniformMatrix4f(d),u_zoom_transition:new l.Uniform1f(d),u_merc_center:new l.Uniform2f(d),u_image0:new l.Uniform1i(d),u_grid_matrix:new l.UniformMatrix3f(d),u_frustum_tl:new l.Uniform3f(d),u_frustum_tr:new l.Uniform3f(d),u_frustum_br:new l.Uniform3f(d),u_frustum_bl:new l.Uniform3f(d),u_globe_pos:new l.Uniform3f(d),u_globe_radius:new l.Uniform1f(d),u_viewport:new l.Uniform2f(d)}),globeAtmosphere:d=>({u_frustum_tl:new l.Uniform3f(d),u_frustum_tr:new l.Uniform3f(d),u_frustum_br:new l.Uniform3f(d),u_frustum_bl:new l.Uniform3f(d),u_horizon:new l.Uniform1f(d),u_transition:new l.Uniform1f(d),u_fadeout_range:new l.Uniform1f(d),u_color:new l.Uniform4f(d),u_high_color:new l.Uniform4f(d),u_space_color:new l.Uniform4f(d),u_star_intensity:new l.Uniform1f(d),u_star_density:new l.Uniform1f(d),u_star_size:new l.Uniform1f(d),u_temporal_offset:new l.Uniform1f(d),u_horizon_angle:new l.Uniform1f(d),u_rotation_matrix:new l.UniformMatrix4f(d)})};let io;function Fa(d,i,u,m,E,M,z){const Z=d.context,K=Z.gl,de=d.transform,pe=d.useProgram("collisionBox"),De=[];let Fe=0,Je=0;for(let Mt=0;Mt<m.length;Mt++){const Et=m[Mt],yt=i.getTile(Et),It=yt.getBucket(u);if(!It)continue;const Ct=Ir(Et,It,de);let Vt=Ct;0===E[0]&&0===E[1]||(Vt=d.translatePosMatrix(Ct,yt,E,M));const sn=z?It.textCollisionBox:It.iconCollisionBox,ni=It.collisionCircleArray;if(ni.length>0){const Xt=l.create(),Ln=Vt;l.mul(Xt,It.placementInvProjMatrix,de.glCoordMatrix),l.mul(Xt,Xt,It.placementViewportMatrix),De.push({circleArray:ni,circleOffset:Je,transform:Ln,invTransform:Xt,projection:It.getProjection()}),Fe+=ni.length/4,Je=Fe}sn&&(d.terrain&&d.terrain.setupElevationDraw(yt,pe),pe.draw(Z,K.LINES,l.DepthMode.disabled,l.StencilMode.disabled,d.colorModeForRenderPass(),l.CullFaceMode.disabled,yl(Vt,de,yt,It.getProjection()),u.id,sn.layoutVertexBuffer,sn.indexBuffer,sn.segments,null,de.zoom,null,[sn.collisionVertexBuffer,sn.collisionVertexBufferExt]))}if(!z||!De.length)return;const Ge=d.useProgram("collisionCircle"),He=new l.StructArrayLayout2f1f2i16;He.resize(4*Fe),He._trim();let $e=0;for(const Mt of De)for(let Et=0;Et<Mt.circleArray.length/4;Et++){const yt=4*Et,It=Mt.circleArray[yt+0],Ct=Mt.circleArray[yt+1],Vt=Mt.circleArray[yt+2],sn=Mt.circleArray[yt+3];He.emplace($e++,It,Ct,Vt,sn,0),He.emplace($e++,It,Ct,Vt,sn,1),He.emplace($e++,It,Ct,Vt,sn,2),He.emplace($e++,It,Ct,Vt,sn,3)}(!io||io.length<2*Fe)&&(io=function(Mt){const Et=2*Mt,yt=new l.StructArrayLayout3ui6;yt.resize(Et),yt._trim();for(let It=0;It<Et;It++){const Ct=6*It;yt.uint16[Ct+0]=4*It+0,yt.uint16[Ct+1]=4*It+1,yt.uint16[Ct+2]=4*It+2,yt.uint16[Ct+3]=4*It+2,yt.uint16[Ct+4]=4*It+3,yt.uint16[Ct+5]=4*It+0}return yt}(Fe));const ze=Z.createIndexBuffer(io,!0),tt=Z.createVertexBuffer(He,l.collisionCircleLayout.members,!0);for(const Mt of De){const Et={u_matrix:Mt.transform,u_inv_matrix:Mt.invTransform,u_camera_to_center_distance:(et=de).getCameraToCenterDistance(Mt.projection),u_viewport_size:[et.width,et.height]};Ge.draw(Z,K.TRIANGLES,l.DepthMode.disabled,l.StencilMode.disabled,d.colorModeForRenderPass(),l.CullFaceMode.disabled,Et,u.id,tt,ze,l.SegmentVector.simpleSegment(0,2*Mt.circleOffset,Mt.circleArray.length,Mt.circleArray.length/2),null,de.zoom)}var et;tt.destroy(),ze.destroy()}const Ns=l.create();function es(d,i,u,m,E,M){const{horizontalAlign:z,verticalAlign:Z}=l.getAnchorAlignment(d),K=-(z-.5)*i,de=-(Z-.5)*u,pe=l.evaluateVariableOffset(d,m);return new l.pointGeometry((K/E+pe[0])*M,(de/E+pe[1])*M)}function Xa(d,i,u,m,E,M,z,Z,K,de,pe){const De=d.text.placedSymbolArray,Fe=d.text.dynamicLayoutVertexArray,Je=d.icon.dynamicLayoutVertexArray,Ge={},He=Vo(Z,d.getProjection(),M),$e=M.elevation,ze=d.getProjection().upVectorScale(Z.canonical,M.center.lat,M.worldSize);Fe.clear();for(let tt=0;tt<De.length;tt++){const et=De.get(tt),Mt=d.allowVerticalPlacement&&!et.placedOrientation,Et=et.hidden||!et.crossTileID||Mt?null:m[et.crossTileID];if(Et){const yt=new l.pointGeometry(et.tileAnchorX,et.tileAnchorY),It=d.getProjection().upVector(Z.canonical,yt.x,yt.y),Ct=$e?$e.getAtTileOffset(Z,yt.x,yt.y):0,Vt=Ji([et.projectedAnchorX+Ct*It[0]*ze.metersToTile,et.projectedAnchorY+Ct*It[1]*ze.metersToTile,et.projectedAnchorZ+Ct*It[2]*ze.metersToTile],u?He:z),sn=Ko(M.getCameraToCenterDistance(d.getProjection()),Vt.signedDistanceFromCamera);let ni=E.evaluateSizeForFeature(d.textSizeData,de,et)*sn/l.ONE_EM;u&&(ni*=d.tilePixelRatio/K);const{width:Xt,height:Ln,anchor:zn,textOffset:di,textScale:_n}=Et,li=es(zn,Xt,Ln,di,_n,ni);let Un;if(u){const gi=yt.add(li),{x:$i,y:vr,z:jr}=d.getProjection().projectTilePoint(gi.x,gi.y,Z.canonical);Un=Ji([$i+Ct*It[0]*ze.metersToTile,vr+Ct*It[1]*ze.metersToTile,jr+Ct*It[2]*ze.metersToTile],z).point}else{const gi=i?li.rotate(-M.angle):li;Un=[Vt.point[0]+gi.x,Vt.point[1]+gi.y,0]}const Ai=d.allowVerticalPlacement&&et.placedOrientation===l.WritingMode.vertical?Math.PI/2:0;for(let gi=0;gi<et.numGlyphs;gi++)l.addDynamicAttributes(Fe,Un[0],Un[1],Un[2],Ai);pe&&et.associatedIconIndex>=0&&(Ge[et.associatedIconIndex]={shiftedAnchor:Un,angle:Ai})}else po(et.numGlyphs,Fe)}if(pe){Je.clear();const tt=d.icon.placedSymbolArray;for(let et=0;et<tt.length;et++){const Mt=tt.get(et);if(Mt.hidden)po(Mt.numGlyphs,Je);else{const Et=Ge[et];if(Et)for(let yt=0;yt<Mt.numGlyphs;yt++)l.addDynamicAttributes(Je,Et.shiftedAnchor[0],Et.shiftedAnchor[1],Et.shiftedAnchor[2],Et.angle);else po(Mt.numGlyphs,Je)}}d.icon.dynamicLayoutVertexBuffer.updateData(Je)}d.text.dynamicLayoutVertexBuffer.updateData(Fe)}function xl(d,i,u){return u.iconsInText&&i?"symbolTextAndIcon":d?"symbolSDF":"symbolIcon"}function Ol(d,i,u,m,E,M,z,Z,K,de,pe,De){const Fe=d.context,Je=Fe.gl,Ge=d.transform,He="map"===Z,$e="map"===K,ze=He&&"point"!==u.layout.get("symbol-placement"),tt=He&&!$e&&!ze,et=void 0!==u.layout.get("symbol-sort-key").constantOr(1);let Mt=!1;const Et=d.depthModeForSublayer(0,l.DepthMode.ReadOnly),yt=[l.mercatorXfromLng(Ge.center.lng),l.mercatorYfromLat(Ge.center.lat)],It=u.layout.get("text-variable-anchor"),Ct="globe"===Ge.projection.name,Vt=[],sn=[0,-1,0];let ni=sn;!Ct&&!Ge.mercatorFromTransition||He||(ni=function(Xt){const Ln=Xt._camera.getWorldToCamera(Xt.worldSize,1),zn=l.multiply([],Ln,Xt.globeMatrix);l.invert(zn,zn);const di=[0,0,0],_n=[0,1,0,0];return l.transformMat4$1(_n,_n,zn),di[0]=_n[0],di[1]=_n[1],di[2]=_n[2],l.normalize(di,di),di}(Ge));for(const Xt of m){const Ln=i.getTile(Xt),zn=Ln.getBucket(u);if(!zn||"mercator"===zn.projection.name&&Ct)continue;const di=E?zn.text:zn.icon;if(!di||zn.fullyClipped||!di.segments.get().length)continue;const _n=di.programConfigurations.get(u.id),li=E||zn.sdfIcons,Un=E?zn.textSizeData:zn.iconSizeData,Ai=$e||0!==Ge.pitch,gi=l.evaluateSizeForZoom(Un,Ge.zoom);let $i,vr,jr,mo,tr=[0,0],Kr=null;if(E){if(vr=Ln.glyphAtlasTexture,jr=Je.LINEAR,$i=Ln.glyphAtlasTexture.size,zn.iconsInText){tr=Ln.imageAtlasTexture.size,Kr=Ln.imageAtlasTexture;const _r="composite"===Un.kind||"camera"===Un.kind;mo=Ai||d.options.rotating||d.options.zooming||_r?Je.LINEAR:Je.NEAREST}}else{const _r=1!==u.layout.get("icon-size").constantOr(0)||zn.iconsNeedLinear;vr=Ln.imageAtlasTexture,jr=li||d.options.rotating||d.options.zooming||_r||Ai?Je.LINEAR:Je.NEAREST,$i=Ln.imageAtlasTexture.size}const Ro="globe"===zn.projection.name,Es=Ro?ni:sn,Ks=Ro?l.globeToMercatorTransition(Ge.zoom):0,G=Vo(Xt,zn.getProjection(),Ge),P=Ge.calculatePixelsToTileUnitsMatrix(Ln),S=Fi(G,Ln.tileID.canonical,$e,He,Ge,zn.getProjection(),P),H=d.terrain&&$e&&ze?l.invert(l.create(),S):Ns,me=Gi(G,Ln.tileID.canonical,$e,He,Ge,zn.getProjection(),P),Ne=It&&zn.hasTextData(),Qe="none"!==u.layout.get("icon-text-fit")&&Ne&&zn.hasIconData();if(ze){const _r=Ge.elevation,Lo=_r?_r.getAtTileOffsetFunc(Xt,Ge.center.lat,Ge.worldSize,zn.getProjection()):ia=>[0,0,0],qo=Xi(G,Ln.tileID.canonical,$e,He,Ge,zn.getProjection(),P);Ss(zn,G,d,E,qo,me,$e,de,Lo,Xt)}const pt=ze||E&&It||Qe,Qt=d.translatePosMatrix(G,Ln,M,z),mn=pt?Ns:S,Ri=d.translatePosMatrix(me,Ln,M,z,!0),ar=zn.getProjection().createInversionMatrix(Ge,Xt.canonical),Pr=[];d.terrain&&$e&&Pr.push("PITCH_WITH_MAP_TERRAIN"),Ro&&Pr.push("PROJECTION_GLOBE_VIEW"),pt&&Pr.push("PROJECTED_POS_ON_VIEWPORT");const oo=li&&0!==u.paint.get(E?"text-halo-width":"icon-halo-width").constantOr(1);let kr;kr=li?zn.iconsInText?_s(Un.kind,gi,tt,$e,d,Qt,mn,Ri,$i,tr,Xt,Ks,yt,ar,Es,zn.getProjection()):wa(Un.kind,gi,tt,$e,d,Qt,mn,Ri,E,$i,!0,Xt,Ks,yt,ar,Es,zn.getProjection()):Is(Un.kind,gi,tt,$e,d,Qt,mn,Ri,E,$i,Xt,Ks,yt,ar,Es,zn.getProjection());const Or={program:d.useProgram(xl(li,E,zn),_n,Pr),buffers:di,uniformValues:kr,atlasTexture:vr,atlasTextureIcon:Kr,atlasInterpolation:jr,atlasInterpolationIcon:mo,isSDF:li,hasHalo:oo,tile:Ln,labelPlaneMatrixInv:H};if(et&&zn.canOverlap){Mt=!0;const _r=di.segments.get();for(const Lo of _r)Vt.push({segments:new l.SegmentVector([Lo]),sortKey:Lo.sortKey,state:Or})}else Vt.push({segments:di.segments,sortKey:0,state:Or})}Mt&&Vt.sort((Xt,Ln)=>Xt.sortKey-Ln.sortKey);for(const Xt of Vt){const Ln=Xt.state;if(d.terrain&&d.terrain.setupElevationDraw(Ln.tile,Ln.program,{useDepthForOcclusion:!Ct,labelPlaneMatrixInv:Ln.labelPlaneMatrixInv}),Fe.activeTexture.set(Je.TEXTURE0),Ln.atlasTexture.bind(Ln.atlasInterpolation,Je.CLAMP_TO_EDGE),Ln.atlasTextureIcon&&(Fe.activeTexture.set(Je.TEXTURE1),Ln.atlasTextureIcon&&Ln.atlasTextureIcon.bind(Ln.atlasInterpolationIcon,Je.CLAMP_TO_EDGE)),Ln.isSDF){const zn=Ln.uniformValues;Ln.hasHalo&&(zn.u_is_halo=1,nl(Ln.buffers,Xt.segments,u,d,Ln.program,Et,pe,De,zn)),zn.u_is_halo=0}nl(Ln.buffers,Xt.segments,u,d,Ln.program,Et,pe,De,Ln.uniformValues)}}function nl(d,i,u,m,E,M,z,Z,K){const de=m.context,pe=[d.dynamicLayoutVertexBuffer,d.opacityVertexBuffer,d.globeExtVertexBuffer];E.draw(de,de.gl.TRIANGLES,M,z,Z,l.CullFaceMode.disabled,K,u.id,d.layoutVertexBuffer,d.indexBuffer,i,u.paint,m.transform.zoom,d.programConfigurations.get(u.id),pe)}function Pa(d,i,u,m,E,M,z){const Z=d.context.gl,K=u.paint.get("fill-pattern"),de=K&&K.constantOr(1),pe=u.getCrossfadeParameters();let De,Fe,Je,Ge,He;z?(Fe=de&&!u.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",De=Z.LINES):(Fe=de?"fillPattern":"fill",De=Z.TRIANGLES);for(const $e of m){const ze=i.getTile($e);if(de&&!ze.patternsLoaded())continue;const tt=ze.getBucket(u);if(!tt)continue;d.prepareDrawTile();const et=tt.programConfigurations.get(u.id),Mt=d.useProgram(Fe,et);de&&(d.context.activeTexture.set(Z.TEXTURE0),ze.imageAtlasTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),et.updatePaintBuffers(pe));const Et=K.constantOr(null);if(Et&&ze.imageAtlas){const It=ze.imageAtlas,Ct=It.patternPositions[Et.to.toString()],Vt=It.patternPositions[Et.from.toString()];Ct&&Vt&&et.setConstantPatternPositions(Ct,Vt)}const yt=d.translatePosMatrix($e.projMatrix,ze,u.paint.get("fill-translate"),u.paint.get("fill-translate-anchor"));if(z){Ge=tt.indexBuffer2,He=tt.segments2;const It=d.terrain&&d.terrain.renderingToTexture?d.terrain.drapeBufferSize:[Z.drawingBufferWidth,Z.drawingBufferHeight];Je="fillOutlinePattern"===Fe&&de?os(yt,d,pe,ze,It):Go(yt,It)}else Ge=tt.indexBuffer,He=tt.segments,Je=de?ki(yt,d,pe,ze):Hn(yt);d.prepareDrawProgram(d.context,Mt,$e.toUnwrapped()),Mt.draw(d.context,De,E,d.stencilModeForClipping($e),M,l.CullFaceMode.disabled,Je,u.id,tt.layoutVertexBuffer,Ge,He,u.paint,d.transform.zoom,et)}}function Ps(d,i,u,m,E,M,z){const Z=d.context,K=Z.gl,de=d.transform,pe=u.paint.get("fill-extrusion-pattern"),De=pe.constantOr(1),Fe=u.getCrossfadeParameters(),Je=u.paint.get("fill-extrusion-opacity"),Ge=[u.paint.get("fill-extrusion-ambient-occlusion-intensity"),u.paint.get("fill-extrusion-ambient-occlusion-radius")],He=u.layout.get("fill-extrusion-edge-radius"),$e="globe"===de.projection.name?l.fillExtrusionHeightLift():0,ze="globe"===de.projection.name,tt=ze?l.globeToMercatorTransition(de.zoom):0,et=[l.mercatorXfromLng(de.center.lng),l.mercatorYfromLat(de.center.lat)],Mt=[];ze&&(Mt.push("PROJECTION_GLOBE_VIEW"),d.style.terrainSetForDrapingOnly()&&Mt.push("TERRAIN")),Ge[0]>0&&Mt.push("FAUX_AO");for(const Et of m){const yt=i.getTile(Et),It=yt.getBucket(u);if(!It||It.projection.name!==de.projection.name)continue;const Ct=It.programConfigurations.get(u.id),Vt=d.useProgram(De?"fillExtrusionPattern":"fillExtrusion",Ct,Mt);if(d.terrain){const _n=d.terrain;if(d.style.terrainSetForDrapingOnly())_n.setupElevationDraw(yt,Vt,{useMeterToDem:!0});else{if(!It.enableTerrain)continue;if(_n.setupElevationDraw(yt,Vt,{useMeterToDem:!0}),Ba(Z,i,Et,It,u,_n),!It.centroidVertexBuffer){const li=Vt.attributes.a_centroid_pos;void 0!==li&&K.vertexAttrib2f(li,0,0)}}}De&&(d.context.activeTexture.set(K.TEXTURE0),yt.imageAtlasTexture.bind(K.LINEAR,K.CLAMP_TO_EDGE),Ct.updatePaintBuffers(Fe));const sn=pe.constantOr(null);if(sn&&yt.imageAtlas){const _n=yt.imageAtlas,li=_n.patternPositions[sn.to.toString()],Un=_n.patternPositions[sn.from.toString()];li&&Un&&Ct.setConstantPatternPositions(li,Un)}const ni=d.translatePosMatrix(Et.projMatrix,yt,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),Xt=de.projection.createInversionMatrix(de,Et.canonical),Ln=u.paint.get("fill-extrusion-vertical-gradient"),zn=De?ta(ni,d,Ln,Je,Ge,He,Et,Fe,yt,$e,tt,et,Xt):ka(ni,d,Ln,Je,Ge,He,Et,$e,tt,et,Xt);d.prepareDrawProgram(Z,Vt,Et.toUnwrapped());const di=[];d.terrain&&di.push(It.centroidVertexBuffer),ze&&di.push(It.layoutVertexExtBuffer),Vt.draw(Z,Z.gl.TRIANGLES,E,M,z,l.CullFaceMode.backCCW,zn,u.id,It.layoutVertexBuffer,It.indexBuffer,It.segments,u.paint,d.transform.zoom,Ct,di)}}function Ba(d,i,u,m,E,M){const z=[ze=>{let tt=ze.canonical.x-1,et=ze.wrap;return tt<0&&(tt=(1<<ze.canonical.z)-1,et--),new l.OverscaledTileID(ze.overscaledZ,et,ze.canonical.z,tt,ze.canonical.y)},ze=>{let tt=ze.canonical.x+1,et=ze.wrap;return tt===1<<ze.canonical.z&&(tt=0,et++),new l.OverscaledTileID(ze.overscaledZ,et,ze.canonical.z,tt,ze.canonical.y)},ze=>new l.OverscaledTileID(ze.overscaledZ,ze.wrap,ze.canonical.z,ze.canonical.x,(0===ze.canonical.y?1<<ze.canonical.z:ze.canonical.y)-1),ze=>new l.OverscaledTileID(ze.overscaledZ,ze.wrap,ze.canonical.z,ze.canonical.x,ze.canonical.y===(1<<ze.canonical.z)-1?0:ze.canonical.y+1)],Z=ze=>{const tt=i.getSource().minzoom,et=Et=>{const yt=i.getTileByID(Et);if(yt&&yt.hasData())return yt.getBucket(E)},Mt=[0,-1,1];for(const Et of Mt){if(ze.overscaledZ+Et<tt)continue;const yt=et(ze.calculateScaledKey(ze.overscaledZ+Et));if(yt)return yt}},K=[0,0,0],de=(ze,tt)=>(K[0]=Math.min(ze.min.y,tt.min.y),K[1]=Math.max(ze.max.y,tt.max.y),K[2]=l.EXTENT-tt.min.x>ze.max.x?tt.min.x-l.EXTENT:ze.max.x,K),pe=(ze,tt)=>(K[0]=Math.min(ze.min.x,tt.min.x),K[1]=Math.max(ze.max.x,tt.max.x),K[2]=l.EXTENT-tt.min.y>ze.max.y?tt.min.y-l.EXTENT:ze.max.y,K),De=[(ze,tt)=>de(ze,tt),(ze,tt)=>de(tt,ze),(ze,tt)=>pe(ze,tt),(ze,tt)=>pe(tt,ze)],Fe=new l.pointGeometry(0,0);let Je,Ge,He;const $e=(ze,tt,et,Mt,Et)=>{const yt=[[Mt?et:ze,Mt?ze:et,0],[Mt?et:tt,Mt?tt:et,0]],It=Et<0?l.EXTENT+Et:Et,Ct=[Mt?It:(ze+tt)/2,Mt?(ze+tt)/2:It,0];return 0===et&&Et<0||0!==et&&Et>0?M.getForTilePoints(He,[Ct],!0,Ge):yt.push(Ct),M.getForTilePoints(u,yt,!0,Je),Math.max(yt[0][2],yt[1][2],Ct[2])/M.exaggeration()};for(let ze=0;ze<4;ze++){const tt=(ze<2?1:5)-ze,et=m.borders[ze];if(0===et.length)continue;const Mt=He=z[ze](u),Et=Z(Mt);if(!(Et&&Et instanceof l.FillExtrusionBucket&&Et.enableTerrain)||m.borderDoneWithNeighborZ[ze]===Et.canonical.z&&Et.borderDoneWithNeighborZ[tt]===m.canonical.z||(Ge=M.findDEMTileFor(Mt),!Ge||!Ge.dem))continue;if(!Je){const Vt=M.findDEMTileFor(u);if(!Vt||!Vt.dem)return;Je=Vt}const yt=Et.borders[tt];let It=0;const Ct=Et.borderDoneWithNeighborZ[tt]!==m.canonical.z;if(m.canonical.z===Et.canonical.z){for(let Vt=0;Vt<et.length;Vt++){const sn=m.featuresOnBorder[et[Vt]],ni=sn.borders[ze];let Xt;for(;It<yt.length&&(Xt=Et.featuresOnBorder[yt[It]],!(Xt.borders[tt][1]>ni[0]+3));)Ct&&Et.encodeCentroid(void 0,Xt,!1),It++;if(Xt&&It<yt.length){const Ln=It;let zn=0;for(;!(Xt.borders[tt][0]>ni[1]-3)&&(zn++,++It!==yt.length);)Xt=Et.featuresOnBorder[yt[It]];if(Xt=Et.featuresOnBorder[yt[Ln]],sn.intersectsCount()>1||Xt.intersectsCount()>1||1!==zn){1!==zn&&(It=Ln),m.encodeCentroid(void 0,sn,!1),Ct&&Et.encodeCentroid(void 0,Xt,!1);continue}const di=De[ze](sn,Xt),_n=ze%2?l.EXTENT-1:0;Fe.x=$e(di[0],Math.min(l.EXTENT-1,di[1]),_n,ze<2,di[2]),Fe.y=0,m.encodeCentroid(Fe,sn,!1),Ct&&Et.encodeCentroid(Fe,Xt,!1)}else m.encodeCentroid(void 0,sn,!1)}m.borderDoneWithNeighborZ[ze]=Et.canonical.z,m.needsCentroidUpdate=!0,Ct&&(Et.borderDoneWithNeighborZ[tt]=m.canonical.z,Et.needsCentroidUpdate=!0)}else{for(const Vt of et)m.encodeCentroid(void 0,m.featuresOnBorder[Vt],!1);if(Ct){for(const Vt of yt)Et.encodeCentroid(void 0,Et.featuresOnBorder[Vt],!1);Et.borderDoneWithNeighborZ[tt]=m.canonical.z,Et.needsCentroidUpdate=!0}m.borderDoneWithNeighborZ[ze]=Et.canonical.z,m.needsCentroidUpdate=!0}}(m.needsCentroidUpdate||!m.centroidVertexBuffer&&0!==m.centroidVertexArray.length)&&m.uploadCentroid(d)}const ws=new l.Color(1,0,0,1),ts=new l.Color(0,1,0,1),bo=new l.Color(0,0,1,1),fa=new l.Color(1,0,1,1),wl=new l.Color(0,1,1,1);function Cr(d,i,u){const m=d.context,E=d.transform,M=m.gl,z="globe"===E.projection.name,Z=z?["PROJECTION_GLOBE_VIEW"]:null;let K=u.projMatrix;if(z&&l.globeToMercatorTransition(E.zoom)>0){const sn=l.transitionTileAABBinECEF(u.canonical,E),ni=l.globeDenormalizeECEF(sn);K=l.multiply(new Float32Array(16),E.globeMatrix,ni),l.multiply(K,E.projMatrix,K)}const de=d.useProgram("debug",null,Z),pe=i.getTileByID(u.key);d.terrain&&d.terrain.setupElevationDraw(pe,de);const De=l.DepthMode.disabled,Fe=l.StencilMode.disabled,Je=d.colorModeForRenderPass();m.activeTexture.set(M.TEXTURE0),d.emptyTexture.bind(M.LINEAR,M.CLAMP_TO_EDGE),z?pe._makeGlobeTileDebugBuffers(d.context,E):pe._makeDebugTileBoundsBuffers(d.context,E.projection);const He=pe._tileDebugBuffer||d.debugBuffer,$e=pe._tileDebugIndexBuffer||d.debugIndexBuffer,ze=pe._tileDebugSegments||d.debugSegments;de.draw(m,M.LINE_STRIP,De,Fe,Je,l.CullFaceMode.disabled,Ua(K,l.Color.red),"$debug",He,$e,ze,null,null,null,[pe._globeTileDebugBorderBuffer]);const tt=pe.latestRawTileData,et=Math.floor((tt&&tt.byteLength||0)/1024),Mt=i.getTile(u).tileSize,Et=512/Math.min(Mt,512)*(u.overscaledZ/E.zoom)*.5;let yt=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(yt+=` => ${u.overscaledZ}`),yt+=` ${et}kb`,function(sn,ni){sn.initDebugOverlayCanvas();const Xt=sn.debugOverlayCanvas,Ln=sn.context.gl,zn=sn.debugOverlayCanvas.getContext("2d");zn.clearRect(0,0,Xt.width,Xt.height),zn.shadowColor="white",zn.shadowBlur=2,zn.lineWidth=1.5,zn.strokeStyle="white",zn.textBaseline="top",zn.font="bold 36px Open Sans, sans-serif",zn.fillText(ni,5,5),zn.strokeText(ni,5,5),sn.debugOverlayTexture.update(Xt),sn.debugOverlayTexture.bind(Ln.LINEAR,Ln.CLAMP_TO_EDGE)}(d,yt);const It=pe._tileDebugTextBuffer||d.debugBuffer,Ct=pe._tileDebugTextIndexBuffer||d.quadTriangleIndexBuffer,Vt=pe._tileDebugTextSegments||d.debugSegments;de.draw(m,M.TRIANGLES,De,Fe,l.ColorMode.alphaBlended,l.CullFaceMode.disabled,Ua(K,l.Color.transparent,Et),"$debug",It,Ct,Vt,null,null,null,[pe._globeTileDebugTextBuffer])}function ja(d,i,u,m){Za(d,0,i+u/2,d.transform.width,u,m)}function Rl(d,i,u,m){Za(d,i-u/2,0,u,d.transform.height,m)}function Za(d,i,u,m,E,M){const z=d.context,Z=z.gl;Z.enable(Z.SCISSOR_TEST),Z.scissor(i*l.exported.devicePixelRatio,u*l.exported.devicePixelRatio,m*l.exported.devicePixelRatio,E*l.exported.devicePixelRatio),z.clear({color:M}),Z.disable(Z.SCISSOR_TEST)}const Ue=l.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:gt}=Ue;function Ut(d,i,u,m){d.emplaceBack(i,u,m)}class vn{constructor(i){this.vertexArray=new l.StructArrayLayout3f12,this.indices=new l.StructArrayLayout3ui6,Ut(this.vertexArray,-1,-1,1),Ut(this.vertexArray,1,-1,1),Ut(this.vertexArray,-1,1,1),Ut(this.vertexArray,1,1,1),Ut(this.vertexArray,-1,-1,-1),Ut(this.vertexArray,1,-1,-1),Ut(this.vertexArray,-1,1,-1),Ut(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=i.createVertexBuffer(this.vertexArray,gt),this.indexBuffer=i.createIndexBuffer(this.indices),this.segment=l.SegmentVector.simpleSegment(0,0,36,12)}}function Wt(d,i,u,m,E,M){const z=d.gl,Z=i.paint.get("sky-atmosphere-color"),K=i.paint.get("sky-atmosphere-halo-color"),de=i.paint.get("sky-atmosphere-sun-intensity"),pe={u_matrix_3f:l.fromMat4(l.create$1(),m),u_sun_direction:E,u_sun_intensity:de,u_color_tint_r:[(Ge=Z).r,Ge.g,Ge.b,Ge.a],u_color_tint_m:[(He=K).r,He.g,He.b,He.a],u_luminance:5e-5};var Ge,He;z.framebufferTexture2D(z.FRAMEBUFFER,z.COLOR_ATTACHMENT0,z.TEXTURE_CUBE_MAP_POSITIVE_X+M,i.skyboxTexture,0),u.draw(d,z.TRIANGLES,l.DepthMode.disabled,l.StencilMode.disabled,l.ColorMode.unblended,l.CullFaceMode.frontCW,pe,"skyboxCapture",i.skyboxGeometry.vertexBuffer,i.skyboxGeometry.indexBuffer,i.skyboxGeometry.segment)}const Bn=l.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Vn{constructor(i){const u=new l.StructArrayLayout5f20;u.emplaceBack(-1,1,1,0,0),u.emplaceBack(1,1,1,1,0),u.emplaceBack(1,-1,1,1,1),u.emplaceBack(-1,-1,1,0,1);const m=new l.StructArrayLayout3ui6;m.emplaceBack(0,1,2),m.emplaceBack(2,3,0),this.vertexBuffer=i.createVertexBuffer(u,Bn.members),this.indexBuffer=i.createIndexBuffer(m),this.segments=l.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const ai={symbol:function(d,i,u,m,E){if("translucent"!==d.renderPass)return;const M=l.StencilMode.disabled,z=d.colorModeForRenderPass();u.layout.get("text-variable-anchor")&&function(Z,K,de,pe,De,Fe,Je){const Ge=K.transform,He="map"===De,$e="map"===Fe;for(const ze of Z){const tt=pe.getTile(ze),et=tt.getBucket(de);if(!et||!et.text||!et.text.segments.get().length)continue;const Mt=l.evaluateSizeForZoom(et.textSizeData,Ge.zoom),Et=Vo(ze,et.getProjection(),Ge),yt=Ge.calculatePixelsToTileUnitsMatrix(tt),It=Fi(Et,tt.tileID.canonical,$e,He,Ge,et.getProjection(),yt),Ct="none"!==de.layout.get("icon-text-fit")&&et.hasIconData();if(Mt){const Vt=Math.pow(2,Ge.zoom-tt.tileID.overscaledZ);Xa(et,He,$e,Je,l.symbolSize,Ge,It,ze,Vt,Mt,Ct)}}}(m,d,u,i,u.layout.get("text-rotation-alignment"),u.layout.get("text-pitch-alignment"),E),0!==u.paint.get("icon-opacity").constantOr(1)&&Ol(d,i,u,m,!1,u.paint.get("icon-translate"),u.paint.get("icon-translate-anchor"),u.layout.get("icon-rotation-alignment"),u.layout.get("icon-pitch-alignment"),u.layout.get("icon-keep-upright"),M,z),0!==u.paint.get("text-opacity").constantOr(1)&&Ol(d,i,u,m,!0,u.paint.get("text-translate"),u.paint.get("text-translate-anchor"),u.layout.get("text-rotation-alignment"),u.layout.get("text-pitch-alignment"),u.layout.get("text-keep-upright"),M,z),i.map.showCollisionBoxes&&(Fa(d,i,u,m,u.paint.get("text-translate"),u.paint.get("text-translate-anchor"),!0),Fa(d,i,u,m,u.paint.get("icon-translate"),u.paint.get("icon-translate-anchor"),!1))},circle:function(d,i,u,m){if("translucent"!==d.renderPass)return;const E=u.paint.get("circle-opacity"),M=u.paint.get("circle-stroke-width"),z=u.paint.get("circle-stroke-opacity"),Z=void 0!==u.layout.get("circle-sort-key").constantOr(1);if(0===E.constantOr(1)&&(0===M.constantOr(1)||0===z.constantOr(1)))return;const K=d.context,de=K.gl,pe=d.transform,De=d.depthModeForSublayer(0,l.DepthMode.ReadOnly),Fe=l.StencilMode.disabled,Je=d.colorModeForRenderPass(),Ge="globe"===pe.projection.name,He=[l.mercatorXfromLng(pe.center.lng),l.mercatorYfromLat(pe.center.lat)],$e=[];for(let tt=0;tt<m.length;tt++){const et=m[tt],Mt=i.getTile(et),Et=Mt.getBucket(u);if(!Et||Et.projection.name!==pe.projection.name)continue;const yt=Et.programConfigurations.get(u.id),It=Qo(u);Ge&&It.push("PROJECTION_GLOBE_VIEW");const Ct=d.useProgram("circle",yt,It),Vt=Et.layoutVertexBuffer,sn=Et.globeExtVertexBuffer,ni=Et.indexBuffer,Xt=pe.projection.createInversionMatrix(pe,et.canonical),Ln={programConfiguration:yt,program:Ct,layoutVertexBuffer:Vt,globeExtVertexBuffer:sn,indexBuffer:ni,uniformValues:La(d,et,Mt,Xt,He,u),tile:Mt};if(Z){const zn=Et.segments.get();for(const di of zn)$e.push({segments:new l.SegmentVector([di]),sortKey:di.sortKey,state:Ln})}else $e.push({segments:Et.segments,sortKey:0,state:Ln})}Z&&$e.sort((tt,et)=>tt.sortKey-et.sortKey);const ze={useDepthForOcclusion:!Ge};for(const tt of $e){const{programConfiguration:et,program:Mt,layoutVertexBuffer:Et,globeExtVertexBuffer:yt,indexBuffer:It,uniformValues:Ct,tile:Vt}=tt.state,sn=tt.segments;d.terrain&&d.terrain.setupElevationDraw(Vt,Mt,ze),d.prepareDrawProgram(K,Mt,Vt.tileID.toUnwrapped()),Mt.draw(K,de.TRIANGLES,De,Fe,Je,l.CullFaceMode.disabled,Ct,u.id,Et,It,sn,u.paint,pe.zoom,et,[yt])}},heatmap:function(d,i,u,m){if(0!==u.paint.get("heatmap-opacity"))if("offscreen"===d.renderPass){const E=d.context,M=E.gl,z=l.StencilMode.disabled,Z=new l.ColorMode([M.ONE,M.ONE],l.Color.transparent,[!0,!0,!0,!0]);(function(Je,Ge,He,$e){const ze=Je.gl,tt=Ge.width*$e,et=Ge.height*$e;Je.activeTexture.set(ze.TEXTURE1),Je.viewport.set([0,0,tt,et]);let Mt=He.heatmapFbo;if(!Mt||Mt&&(Mt.width!==tt||Mt.height!==et)){Mt&&Mt.destroy();const Et=ze.createTexture();ze.bindTexture(ze.TEXTURE_2D,Et),ze.texParameteri(ze.TEXTURE_2D,ze.TEXTURE_WRAP_S,ze.CLAMP_TO_EDGE),ze.texParameteri(ze.TEXTURE_2D,ze.TEXTURE_WRAP_T,ze.CLAMP_TO_EDGE),ze.texParameteri(ze.TEXTURE_2D,ze.TEXTURE_MIN_FILTER,ze.LINEAR),ze.texParameteri(ze.TEXTURE_2D,ze.TEXTURE_MAG_FILTER,ze.LINEAR),Mt=He.heatmapFbo=Je.createFramebuffer(tt,et,!1),function(yt,It,Ct,Vt,sn,ni){const Xt=yt.gl;Xt.texImage2D(Xt.TEXTURE_2D,0,Xt.RGBA,sn,ni,0,Xt.RGBA,yt.extRenderToTextureHalfFloat?yt.extTextureHalfFloat.HALF_FLOAT_OES:Xt.UNSIGNED_BYTE,null),Vt.colorAttachment.set(Ct)}(Je,0,Et,Mt,tt,et)}else ze.bindTexture(ze.TEXTURE_2D,Mt.colorAttachment.get()),Je.bindFramebuffer.set(Mt.framebuffer)})(E,d,u,"globe"===d.transform.projection.name?.5:.25),E.clear({color:l.Color.transparent});const K=d.transform,de="globe"===K.projection.name,pe=de?["PROJECTION_GLOBE_VIEW"]:null,De=de?l.CullFaceMode.frontCCW:l.CullFaceMode.disabled,Fe=[l.mercatorXfromLng(K.center.lng),l.mercatorYfromLat(K.center.lat)];for(let Je=0;Je<m.length;Je++){const Ge=m[Je];if(i.hasRenderableParent(Ge))continue;const He=i.getTile(Ge),$e=He.getBucket(u);if(!$e||$e.projection.name!==K.projection.name)continue;const ze=$e.programConfigurations.get(u.id),tt=d.useProgram("heatmap",ze,pe),{zoom:et}=d.transform;d.terrain&&d.terrain.setupElevationDraw(He,tt),d.prepareDrawProgram(E,tt,Ge.toUnwrapped());const Mt=K.projection.createInversionMatrix(K,Ge.canonical);tt.draw(E,M.TRIANGLES,l.DepthMode.disabled,z,Z,De,Ya(d,Ge,He,Mt,Fe,et,u.paint.get("heatmap-intensity")),u.id,$e.layoutVertexBuffer,$e.indexBuffer,$e.segments,u.paint,d.transform.zoom,ze,de?[$e.globeExtVertexBuffer]:null)}E.viewport.set([0,0,d.width,d.height])}else"translucent"===d.renderPass&&(d.context.setColorMode(d.colorModeForRenderPass()),function(E,M){const z=E.context,Z=z.gl,K=M.heatmapFbo;if(!K)return;z.activeTexture.set(Z.TEXTURE0),Z.bindTexture(Z.TEXTURE_2D,K.colorAttachment.get()),z.activeTexture.set(Z.TEXTURE1);let de=M.colorRampTexture;de||(de=M.colorRampTexture=new l.Texture(z,M.colorRamp,Z.RGBA)),de.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),E.useProgram("heatmapTexture").draw(z,Z.TRIANGLES,l.DepthMode.disabled,l.StencilMode.disabled,E.colorModeForRenderPass(),l.CullFaceMode.disabled,{u_image:0,u_color_ramp:1,u_opacity:M.paint.get("heatmap-opacity")},M.id,E.viewportBuffer,E.quadTriangleIndexBuffer,E.viewportSegments,M.paint,E.transform.zoom)}(d,u))},line:function(d,i,u,m){if("translucent"!==d.renderPass)return;const E=u.paint.get("line-opacity"),M=u.paint.get("line-width");if(0===E.constantOr(1)||0===M.constantOr(1))return;const z=d.depthModeForSublayer(0,l.DepthMode.ReadOnly),Z=d.colorModeForRenderPass(),K=d.terrain&&d.terrain.renderingToTexture?1:l.exported.devicePixelRatio,de=u.paint.get("line-dasharray"),pe=de.constantOr(1),De=u.layout.get("line-cap"),Fe=u.paint.get("line-pattern"),Je=Fe.constantOr(1),Ge=u.paint.get("line-gradient"),He=u.getCrossfadeParameters(),$e=Je?"linePattern":"line",ze=d.context,tt=ze.gl,et=(Et=>{const yt=[];Ka(Et)&&yt.push("RENDER_LINE_DASH"),Et.paint.get("line-gradient")&&yt.push("RENDER_LINE_GRADIENT");const It=Et.paint.get("line-trim-offset");0===It[0]&&0===It[1]||yt.push("RENDER_LINE_TRIM_OFFSET");const Ct=Et.paint.get("line-pattern").constantOr(1),Vt=1!==Et.paint.get("line-opacity").constantOr(1);return!Ct&&Vt&&yt.push("RENDER_LINE_ALPHA_DISCARD"),yt})(u);let Mt=et.includes("RENDER_LINE_ALPHA_DISCARD");d.terrain&&d.terrain.clipOrMaskOverlapStencilType()&&(Mt=!1);for(const Et of m){const yt=i.getTile(Et);if(Je&&!yt.patternsLoaded())continue;const It=yt.getBucket(u);if(!It)continue;d.prepareDrawTile();const Ct=It.programConfigurations.get(u.id),Vt=d.useProgram($e,Ct,et),sn=Fe.constantOr(null);if(sn&&yt.imageAtlas){const Un=yt.imageAtlas,Ai=Un.patternPositions[sn.to.toString()],gi=Un.patternPositions[sn.from.toString()];Ai&&gi&&Ct.setConstantPatternPositions(Ai,gi)}const ni=de.constantOr(null),Xt=De.constantOr(null);if(!Je&&ni&&Xt&&yt.lineAtlas){const Un=yt.lineAtlas,Ai=Un.getDash(ni.to,Xt),gi=Un.getDash(ni.from,Xt);Ai&&gi&&Ct.setConstantPatternPositions(Ai,gi)}let[Ln,zn]=u.paint.get("line-trim-offset");("round"===Xt||"square"===Xt)&&Ln!==zn&&(0===Ln&&(Ln-=1),1===zn&&(zn+=1));const di=d.terrain?Et.projMatrix:null,_n=Je?Ws(d,yt,u,He,di,K):Ma(d,yt,u,He,di,It.lineClipsArray.length,K,[Ln,zn]);if(Ge){const Un=It.gradients[u.id];let Ai=Un.texture;if(u.gradientVersion!==Un.version){let gi=256;if(u.stepInterpolant){const $i=i.getSource().maxzoom,vr=Et.canonical.z===$i?Math.ceil(1<<d.transform.maxZoom-Et.canonical.z):1;gi=l.clamp(l.nextPowerOfTwo(It.maxLineLength/l.EXTENT*1024*vr),256,ze.maxTextureSize)}Un.gradient=l.renderColorRamp({expression:u.gradientExpression(),evaluationKey:"lineProgress",resolution:gi,image:Un.gradient||void 0,clips:It.lineClipsArray}),Un.texture?Un.texture.update(Un.gradient):Un.texture=new l.Texture(ze,Un.gradient,tt.RGBA),Un.version=u.gradientVersion,Ai=Un.texture}ze.activeTexture.set(tt.TEXTURE1),Ai.bind(u.stepInterpolant?tt.NEAREST:tt.LINEAR,tt.CLAMP_TO_EDGE)}pe&&(ze.activeTexture.set(tt.TEXTURE0),yt.lineAtlasTexture.bind(tt.LINEAR,tt.REPEAT),Ct.updatePaintBuffers(He)),Je&&(ze.activeTexture.set(tt.TEXTURE0),yt.imageAtlasTexture.bind(tt.LINEAR,tt.CLAMP_TO_EDGE),Ct.updatePaintBuffers(He)),d.prepareDrawProgram(ze,Vt,Et.toUnwrapped());const li=Un=>{Vt.draw(ze,tt.TRIANGLES,z,Un,Z,l.CullFaceMode.disabled,_n,u.id,It.layoutVertexBuffer,It.indexBuffer,It.segments,u.paint,d.transform.zoom,Ct,[It.layoutVertexBuffer2])};if(Mt){const Un=d.stencilModeForClipping(Et).ref;0===Un&&d.terrain&&ze.clear({stencil:0});const Ai={func:tt.EQUAL,mask:255};_n.u_alpha_discard_threshold=.8,li(new l.StencilMode(Ai,Un,255,tt.KEEP,tt.KEEP,tt.INVERT)),_n.u_alpha_discard_threshold=0,li(new l.StencilMode(Ai,Un,255,tt.KEEP,tt.KEEP,tt.KEEP))}else li(d.stencilModeForClipping(Et))}Mt&&(d.resetStencilClippingMasks(),d.terrain&&ze.clear({stencil:0}))},fill:function(d,i,u,m){const E=u.paint.get("fill-color"),M=u.paint.get("fill-opacity");if(0===M.constantOr(1))return;const z=d.colorModeForRenderPass(),Z=u.paint.get("fill-pattern"),K=d.opaquePassEnabledForLayer()&&!Z.constantOr(1)&&1===E.constantOr(l.Color.transparent).a&&1===M.constantOr(0)?"opaque":"translucent";if(d.renderPass===K){const de=d.depthModeForSublayer(1,"opaque"===d.renderPass?l.DepthMode.ReadWrite:l.DepthMode.ReadOnly);Pa(d,i,u,m,de,z,!1)}if("translucent"===d.renderPass&&u.paint.get("fill-antialias")){const de=d.depthModeForSublayer(u.getPaintProperty("fill-outline-color")?2:0,l.DepthMode.ReadOnly);Pa(d,i,u,m,de,z,!0)}},"fill-extrusion":function(d,i,u,m){const E=u.paint.get("fill-extrusion-opacity");if(0!==E&&"translucent"===d.renderPass){const M=new l.DepthMode(d.context.gl.LEQUAL,l.DepthMode.ReadWrite,d.depthRangeFor3D);if(1!==E||u.paint.get("fill-extrusion-pattern").constantOr(1))Ps(d,i,u,m,M,l.StencilMode.disabled,l.ColorMode.disabled),Ps(d,i,u,m,M,d.stencilModeFor3D(),d.colorModeForRenderPass()),d.resetStencilClippingMasks();else{const z=d.colorModeForRenderPass();Ps(d,i,u,m,M,l.StencilMode.disabled,z)}}},hillshade:function(d,i,u,m){if("offscreen"!==d.renderPass&&"translucent"!==d.renderPass)return;const E=d.context,M=d.depthModeForSublayer(0,l.DepthMode.ReadOnly),z=d.colorModeForRenderPass(),Z=d.terrain&&d.terrain.renderingToTexture,[K,de]="translucent"!==d.renderPass||Z?[{},m]:d.stencilConfigForOverlap(m);for(const pe of de){const De=i.getTile(pe);if(De.needsHillshadePrepare&&"offscreen"===d.renderPass)er(d,De,u,M,l.StencilMode.disabled,z);else if("translucent"===d.renderPass){const Fe=Z&&d.terrain?d.terrain.stencilModeForRTTOverlap(pe):K[pe.overscaledZ];Ui(d,pe,De,u,M,Fe,z)}}E.viewport.set([0,0,d.width,d.height]),d.resetStencilClippingMasks()},raster:function(d,i,u,m,E,M){if("translucent"!==d.renderPass||0===u.paint.get("raster-opacity")||!m.length)return;const z=d.context,Z=z.gl,K=i.getSource(),de=d.useProgram("raster"),pe=d.colorModeForRenderPass(),De=d.terrain&&d.terrain.renderingToTexture,[Fe,Je]=K instanceof Rt||De?[{},m]:d.stencilConfigForOverlap(m),Ge=Je[Je.length-1].overscaledZ,He=!d.options.moving;for(const $e of Je){const ze=De?l.DepthMode.disabled:d.depthModeForSublayer($e.overscaledZ-Ge,1===u.paint.get("raster-opacity")?l.DepthMode.ReadWrite:l.DepthMode.ReadOnly,Z.LESS),tt=$e.toUnwrapped(),et=i.getTile($e);if(De&&(!et||!et.hasData()))continue;const Mt=De?$e.projMatrix:d.transform.calculateProjMatrix(tt,He),Et=d.terrain&&De?d.terrain.stencilModeForRTTOverlap($e):Fe[$e.overscaledZ],yt=M?0:u.paint.get("raster-fade-duration");et.registerFadeDuration(yt);const It=i.findLoadedParent($e,0),Ct=gn(et,It,i,d.transform,yt);let Vt,sn;d.terrain&&d.terrain.prepareDrawTile();const ni="nearest"===u.paint.get("raster-resampling")?Z.NEAREST:Z.LINEAR;z.activeTexture.set(Z.TEXTURE0),et.texture.bind(ni,Z.CLAMP_TO_EDGE),z.activeTexture.set(Z.TEXTURE1),It?(It.texture.bind(ni,Z.CLAMP_TO_EDGE),Vt=Math.pow(2,It.tileID.overscaledZ-et.tileID.overscaledZ),sn=[et.tileID.canonical.x*Vt%1,et.tileID.canonical.y*Vt%1]):et.texture.bind(ni,Z.CLAMP_TO_EDGE);const Xt=xa(Mt,sn||[0,0],Vt||1,Ct,u,K instanceof Rt?K.perspectiveTransform:[0,0]);if(d.prepareDrawProgram(z,de,tt),K instanceof Rt)K.boundsBuffer&&K.boundsSegments&&de.draw(z,Z.TRIANGLES,ze,l.StencilMode.disabled,pe,l.CullFaceMode.disabled,Xt,u.id,K.boundsBuffer,d.quadTriangleIndexBuffer,K.boundsSegments);else{const{tileBoundsBuffer:Ln,tileBoundsIndexBuffer:zn,tileBoundsSegments:di}=d.getTileBoundsBuffers(et);de.draw(z,Z.TRIANGLES,ze,Et,pe,l.CullFaceMode.disabled,Xt,u.id,Ln,zn,di)}}d.resetStencilClippingMasks()},background:function(d,i,u,m){const E=u.paint.get("background-color"),M=u.paint.get("background-opacity");if(0===M)return;const z=d.context,Z=z.gl,K=d.transform,de=K.tileSize,pe=u.paint.get("background-pattern");if(d.isPatternMissing(pe))return;const De=!pe&&1===E.a&&1===M&&d.opaquePassEnabledForLayer()?"opaque":"translucent";if(d.renderPass!==De)return;const Fe=l.StencilMode.disabled,Je=d.depthModeForSublayer(0,"opaque"===De?l.DepthMode.ReadWrite:l.DepthMode.ReadOnly),Ge=d.colorModeForRenderPass(),He=d.useProgram(pe?"backgroundPattern":"background");let $e,ze=m;ze||($e=d.getBackgroundTiles(),ze=Object.values($e).map(et=>et.tileID)),pe&&(z.activeTexture.set(Z.TEXTURE0),d.imageManager.bind(d.context));const tt=u.getCrossfadeParameters();for(const et of ze){const Mt=et.toUnwrapped(),Et=m?et.projMatrix:d.transform.calculateProjMatrix(Mt);d.prepareDrawTile();const yt=i?i.getTile(et):$e?$e[et.key]:new l.Tile(et,de,K.zoom,d),It=pe?Ia(Et,M,d,pe,{tileID:et,tileSize:de},tt):Va(Et,M,E);d.prepareDrawProgram(z,He,Mt);const{tileBoundsBuffer:Ct,tileBoundsIndexBuffer:Vt,tileBoundsSegments:sn}=d.getTileBoundsBuffers(yt);He.draw(z,Z.TRIANGLES,Je,Fe,Ge,l.CullFaceMode.disabled,It,u.id,Ct,Vt,sn)}},sky:function(d,i,u){const m=d.transform,E="mercator"===m.projection.name||"globe"===m.projection.name?1:l.smoothstep(7,8,m.zoom),M=u.paint.get("sky-opacity")*E;if(0===M)return;const z=d.context,Z=u.paint.get("sky-type"),K=new l.DepthMode(z.gl.LEQUAL,l.DepthMode.ReadOnly,[0,1]),de=d.frameCounter/1e3%1;"atmosphere"===Z?"offscreen"===d.renderPass?u.needsSkyboxCapture(d)&&(function(pe,De,Fe,Je){const Ge=pe.context,He=Ge.gl;let $e=De.skyboxFbo;if(!$e){$e=De.skyboxFbo=Ge.createFramebuffer(32,32,!1),De.skyboxGeometry=new vn(Ge),De.skyboxTexture=Ge.gl.createTexture(),He.bindTexture(He.TEXTURE_CUBE_MAP,De.skyboxTexture),He.texParameteri(He.TEXTURE_CUBE_MAP,He.TEXTURE_WRAP_S,He.CLAMP_TO_EDGE),He.texParameteri(He.TEXTURE_CUBE_MAP,He.TEXTURE_WRAP_T,He.CLAMP_TO_EDGE),He.texParameteri(He.TEXTURE_CUBE_MAP,He.TEXTURE_MIN_FILTER,He.LINEAR),He.texParameteri(He.TEXTURE_CUBE_MAP,He.TEXTURE_MAG_FILTER,He.LINEAR);for(let Mt=0;Mt<6;++Mt)He.texImage2D(He.TEXTURE_CUBE_MAP_POSITIVE_X+Mt,0,He.RGBA,32,32,0,He.RGBA,He.UNSIGNED_BYTE,null)}Ge.bindFramebuffer.set($e.framebuffer),Ge.viewport.set([0,0,32,32]);const ze=De.getCenter(pe,!0),tt=pe.useProgram("skyboxCapture"),et=new Float64Array(16);l.identity(et),l.rotateY(et,et,.5*-Math.PI),Wt(Ge,De,tt,et,ze,0),l.identity(et),l.rotateY(et,et,.5*Math.PI),Wt(Ge,De,tt,et,ze,1),l.identity(et),l.rotateX(et,et,.5*-Math.PI),Wt(Ge,De,tt,et,ze,2),l.identity(et),l.rotateX(et,et,.5*Math.PI),Wt(Ge,De,tt,et,ze,3),l.identity(et),Wt(Ge,De,tt,et,ze,4),l.identity(et),l.rotateY(et,et,Math.PI),Wt(Ge,De,tt,et,ze,5),Ge.viewport.set([0,0,pe.width,pe.height])}(d,u),u.markSkyboxValid(d)):"sky"===d.renderPass&&function(pe,De,Fe,Je,Ge){const He=pe.context,$e=He.gl,ze=pe.transform,tt=pe.useProgram("skybox");He.activeTexture.set($e.TEXTURE0),$e.bindTexture($e.TEXTURE_CUBE_MAP,De.skyboxTexture);const et={u_matrix:ze.skyboxMatrix,u_sun_direction:De.getCenter(pe,!1),u_cubemap:0,u_opacity:Je,u_temporal_offset:Ge};pe.prepareDrawProgram(He,tt),tt.draw(He,$e.TRIANGLES,Fe,l.StencilMode.disabled,pe.colorModeForRenderPass(),l.CullFaceMode.backCW,et,"skybox",De.skyboxGeometry.vertexBuffer,De.skyboxGeometry.indexBuffer,De.skyboxGeometry.segment)}(d,u,K,M,de):"gradient"===Z&&"sky"===d.renderPass&&function(pe,De,Fe,Je,Ge){const He=pe.context,$e=He.gl,ze=pe.transform,tt=pe.useProgram("skyboxGradient");De.skyboxGeometry||(De.skyboxGeometry=new vn(He)),He.activeTexture.set($e.TEXTURE0);let et=De.colorRampTexture;et||(et=De.colorRampTexture=new l.Texture(He,De.colorRamp,$e.RGBA)),et.bind($e.LINEAR,$e.CLAMP_TO_EDGE);const Mt=(Et=ze.skyboxMatrix,yt=De.getCenter(pe,!1),It=De.paint.get("sky-gradient-radius"),Ct=Je,Vt=Ge,{u_matrix:Et,u_color_ramp:0,u_center_direction:yt,u_radius:l.degToRad(It),u_opacity:Ct,u_temporal_offset:Vt});var Et,yt,It,Ct,Vt;pe.prepareDrawProgram(He,tt),tt.draw(He,$e.TRIANGLES,Fe,l.StencilMode.disabled,pe.colorModeForRenderPass(),l.CullFaceMode.backCW,Mt,"skyboxGradient",De.skyboxGeometry.vertexBuffer,De.skyboxGeometry.indexBuffer,De.skyboxGeometry.segment)}(d,u,K,M,de)},debug:function(d,i,u){for(let m=0;m<u.length;m++)Cr(d,i,u[m])},custom:function(d,i,u){const m=d.context,E=u.implementation;if(d.transform.projection.unsupportedLayers&&d.transform.projection.unsupportedLayers.includes("custom"))l.warnOnce("Custom layers are not yet supported with non-mercator projections. Use mercator to enable custom layers.");else if("offscreen"===d.renderPass){const M=E.prerender;M&&(d.setCustomLayerDefaults(),m.setColorMode(d.colorModeForRenderPass()),M.call(E,m.gl,d.transform.customLayerMatrix()),m.setDirty(),d.setBaseState())}else if("translucent"===d.renderPass){d.setCustomLayerDefaults(),m.setColorMode(d.colorModeForRenderPass()),m.setStencilMode(l.StencilMode.disabled);const M="3d"===E.renderingMode?new l.DepthMode(d.context.gl.LEQUAL,l.DepthMode.ReadWrite,d.depthRangeFor3D):d.depthModeForSublayer(0,l.DepthMode.ReadOnly);m.setDepthMode(M),E.render(m.gl,d.transform.customLayerMatrix()),m.setDirty(),d.setBaseState(),m.bindFramebuffer.set(null)}}};class Ii{constructor(i,u){this.context=new We(i),this.transform=u,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=l.SourceCache.maxUnderzooming+l.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ds,this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(i,u){const m=!!i&&!!i.terrain&&this.transform.projection.supportsTerrain;if(!(m||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new ms(this,i));const E=this._terrain;this.transform.elevation=m?E:null,E.update(i,this.transform,u)}_updateFog(i){const u=i.fog;if(!u||"globe"===this.transform.projection.name||u.getOpacity(this.transform.pitch)<1||u.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[m,E]=u.getFovAdjustedRange(this.transform._fov);if(m>E)return void(this.transform.fogCullDistSq=null);const M=m+.78*(E-m);this.transform.fogCullDistSq=M*M}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(i,u){if(this.width=i*l.exported.devicePixelRatio,this.height=u*l.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const m of this.style.order)this.style._layers[m].resize()}setup(){const i=this.context,u=new l.StructArrayLayout2i4;u.emplaceBack(0,0),u.emplaceBack(l.EXTENT,0),u.emplaceBack(0,l.EXTENT),u.emplaceBack(l.EXTENT,l.EXTENT),this.tileExtentBuffer=i.createVertexBuffer(u,l.posAttributes.members),this.tileExtentSegments=l.SegmentVector.simpleSegment(0,0,4,2);const m=new l.StructArrayLayout2i4;m.emplaceBack(0,0),m.emplaceBack(l.EXTENT,0),m.emplaceBack(0,l.EXTENT),m.emplaceBack(l.EXTENT,l.EXTENT),this.debugBuffer=i.createVertexBuffer(m,l.posAttributes.members),this.debugSegments=l.SegmentVector.simpleSegment(0,0,4,5);const E=new l.StructArrayLayout2i4;E.emplaceBack(-1,-1),E.emplaceBack(1,-1),E.emplaceBack(-1,1),E.emplaceBack(1,1),this.viewportBuffer=i.createVertexBuffer(E,l.posAttributes.members),this.viewportSegments=l.SegmentVector.simpleSegment(0,0,4,2);const M=new l.StructArrayLayout4i8;M.emplaceBack(0,0,0,0),M.emplaceBack(l.EXTENT,0,l.EXTENT,0),M.emplaceBack(0,l.EXTENT,0,l.EXTENT),M.emplaceBack(l.EXTENT,l.EXTENT,l.EXTENT,l.EXTENT),this.mercatorBoundsBuffer=i.createVertexBuffer(M,l.boundsAttributes.members),this.mercatorBoundsSegments=l.SegmentVector.simpleSegment(0,0,4,2);const z=new l.StructArrayLayout3ui6;z.emplaceBack(0,1,2),z.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=i.createIndexBuffer(z);const Z=new l.StructArrayLayout1ui2;for(const de of[0,1,3,2,0])Z.emplaceBack(de);this.debugIndexBuffer=i.createIndexBuffer(Z),this.emptyTexture=new l.Texture(i,new l.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),i.gl.RGBA),this.identityMat=l.create();const K=this.context.gl;this.stencilClearMode=new l.StencilMode({func:K.ALWAYS,mask:0},0,255,K.ZERO,K.ZERO,K.ZERO),this.loadTimeStamps.push(l.window.performance.now()),this.atmosphereBuffer=new Vn(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(i){return i._makeTileBoundsBuffers(this.context,this.transform.projection),i._tileBoundsBuffer?{tileBoundsBuffer:i._tileBoundsBuffer,tileBoundsIndexBuffer:i._tileBoundsIndexBuffer,tileBoundsSegments:i._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const i=this.context,u=i.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(i,u.TRIANGLES,l.DepthMode.disabled,this.stencilClearMode,l.ColorMode.disabled,l.CullFaceMode.disabled,Re(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(i,u,m){if(!u||this.currentStencilSource===u.id||!i.isTileClipped()||!m||0===m.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let Z=!1;for(const K of m)if(void 0===this._tileClippingMaskIDs[K.key]){Z=!0;break}if(!Z)return}this.currentStencilSource=u.id;const E=this.context,M=E.gl;this.nextStencilID+m.length>256&&this.clearStencil(),E.setColorMode(l.ColorMode.disabled),E.setDepthMode(l.DepthMode.disabled);const z=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const Z of m){const K=u.getTile(Z),de=this._tileClippingMaskIDs[Z.key]=this.nextStencilID++,{tileBoundsBuffer:pe,tileBoundsIndexBuffer:De,tileBoundsSegments:Fe}=this.getTileBoundsBuffers(K);z.draw(E,M.TRIANGLES,l.DepthMode.disabled,new l.StencilMode({func:M.ALWAYS,mask:0},de,255,M.KEEP,M.KEEP,M.REPLACE),l.ColorMode.disabled,l.CullFaceMode.disabled,Re(Z.projMatrix),"$clipping",pe,De,Fe)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const i=this.nextStencilID++,u=this.context.gl;return new l.StencilMode({func:u.NOTEQUAL,mask:255},i,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(i){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(i);const u=this.context.gl;return new l.StencilMode({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[i.key],0,u.KEEP,u.KEEP,u.REPLACE)}stencilConfigForOverlap(i){const u=this.context.gl,m=i.sort((z,Z)=>Z.overscaledZ-z.overscaledZ),E=m[m.length-1].overscaledZ,M=m[0].overscaledZ-E+1;if(M>1){this.currentStencilSource=void 0,this.nextStencilID+M>256&&this.clearStencil();const z={};for(let Z=0;Z<M;Z++)z[Z+E]=new l.StencilMode({func:u.GEQUAL,mask:255},Z+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=M,[z,m]}return[{[E]:l.StencilMode.disabled},m]}colorModeForRenderPass(){const i=this.context.gl;return this._showOverdrawInspector?new l.ColorMode([i.CONSTANT_COLOR,i.ONE],new l.Color(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?l.ColorMode.unblended:l.ColorMode.alphaBlended}depthModeForSublayer(i,u,m){if(!this.opaquePassEnabledForLayer())return l.DepthMode.disabled;const E=1-((1+this.currentLayer)*this.numSublayers+i)*this.depthEpsilon;return new l.DepthMode(m||this.context.gl.LEQUAL,u,[E,E])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(i,u){this.style=i,this.options=u,this.lineAtlas=i.lineAtlas,this.imageManager=i.imageManager,this.glyphManager=i.glyphManager,this.symbolFadeChange=i.placement.symbolFadeChange(l.exported.now()),this.imageManager.beginFrame();const m=this.style.order,E=this.style._sourceCaches;for(const K in E){const de=E[K];de.used&&de.prepare(this.context)}const M={},z={},Z={};for(const K in E){const de=E[K];M[K]=de.getVisibleCoordinates(),z[K]=M[K].slice().reverse(),Z[K]=de.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let K=0;K<m.length;K++)if(this.style._layers[m[K]].is3D()){this.opaquePassCutoff=K;break}if(this.terrain&&(this.terrain.updateTileBinding(Z),this.opaquePassCutoff=0),"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new l.GlobeSharedBuffers(this.context)),l.isMapAuthenticated(this.context.gl)){this.renderPass="offscreen";for(const K of m){const de=this.style._layers[K],pe=i._getLayerSourceCache(de);if(!de.hasOffscreenPass()||de.isHidden(this.transform.zoom))continue;const De=pe?z[pe.id]:void 0;("custom"===de.type||de.isSky()||De&&De.length)&&this.renderLayer(this,pe,de,De)}if(this.depthRangeFor3D=[0,1-(i.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:u.showOverdrawInspector?l.Color.black:l.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=u.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=m.length-1;this.currentLayer>=0;this.currentLayer--){const K=this.style._layers[m[this.currentLayer]],de=i._getLayerSourceCache(K);if(K.isSky())continue;const pe=de?z[de.id]:void 0;this._renderTileClippingMasks(K,de,pe),this.renderLayer(this,de,K,pe)}if(this.style.fog&&this.transform.projection.supportsFog&&function(K,de){const pe=K.context,De=pe.gl,Fe=K.transform,Je=new l.DepthMode(De.LEQUAL,l.DepthMode.ReadOnly,[0,1]),Ge=K.useProgram("globeAtmosphere",null,"globe"===Fe.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),He=l.globeToMercatorTransition(Fe.zoom),$e=de.properties.get("color").toArray01(),ze=de.properties.get("high-color").toArray01(),tt=de.properties.get("space-color").toArray01PremultipliedAlpha(),et=l.identity$1([]);l.rotateY$1(et,et,-l.degToRad(Fe._center.lng)),l.rotateX$1(et,et,l.degToRad(Fe._center.lat)),l.rotateZ$1(et,et,Fe.angle),l.rotateX$1(et,et,-Fe._pitch);const Mt=l.fromQuat(new Float32Array(16),et),Et=l.mapValue(de.properties.get("star-intensity"),0,1,0,.25),It=l.mapValue(de.properties.get("horizon-blend"),0,1,5e-4,.25),Ct=l.globeUseCustomAntiAliasing(K,pe,Fe)&&5e-4===It?Fe.worldSize/(2*Math.PI*1.025)-1:Fe.globeRadius,Vt=K.frameCounter/1e3%1,sn=l.length(Fe.globeCenterInViewSpace),ni=Math.sqrt(Math.pow(sn,2)-Math.pow(Ct,2)),Xt=Math.acos(ni/sn),Ln={u_frustum_tl:Fe.frustumCorners.TL,u_frustum_tr:Fe.frustumCorners.TR,u_frustum_br:Fe.frustumCorners.BR,u_frustum_bl:Fe.frustumCorners.BL,u_horizon:Fe.frustumCorners.horizon,u_transition:He,u_fadeout_range:It,u_color:$e,u_high_color:ze,u_space_color:tt,u_star_intensity:Et,u_star_size:5*l.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:Vt,u_horizon_angle:Xt,u_rotation_matrix:Mt};K.prepareDrawProgram(pe,Ge);const zn=K.atmosphereBuffer;zn&&Ge.draw(pe,De.TRIANGLES,Je,l.StencilMode.disabled,l.ColorMode.alphaBlended,l.CullFaceMode.backCW,Ln,"skybox",zn.vertexBuffer,zn.indexBuffer,zn.segments)}(this,this.style.fog),this.renderPass="sky",(l.globeToMercatorTransition(this.transform.zoom)>0||"globe"!==this.transform.projection.name)&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<m.length;this.currentLayer++){const K=this.style._layers[m[this.currentLayer]],de=i._getLayerSourceCache(K);K.isSky()&&this.renderLayer(this,de,K,de?z[de.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<m.length;){const K=this.style._layers[m[this.currentLayer]],de=i._getLayerSourceCache(K);if(K.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(K)){if(K.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const pe=de?("symbol"===K.type?Z:z)[de.id]:void 0;this._renderTileClippingMasks(K,de,de?M[de.id]:void 0),this.renderLayer(this,de,K,pe),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry){let K=null;l.values(this.style._layers).forEach(de=>{const pe=i._getLayerSourceCache(de);pe&&!de.isHidden(this.transform.zoom)&&(!K||K.getSource().maxzoom<pe.getSource().maxzoom)&&(K=pe)}),K&&this.options.showTileBoundaries&&ai.debug(this,K,K.getVisibleCoordinates())}this.options.showPadding&&function(K){const de=K.transform.padding;ja(K,K.transform.height-(de.top||0),3,ws),ja(K,de.bottom||0,3,ts),Rl(K,de.left||0,3,bo),Rl(K,K.transform.width-(de.right||0),3,fa);const pe=K.transform.centerPoint;var De,Fe,Je,Ge;Za(De=K,(Fe=pe.x)-1,(Je=K.transform.height-pe.y)-10,2,20,Ge=wl),Za(De,Fe-10,Je-1,20,2,Ge)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(l.window.performance.now()),this.saveCanvasCopy())}}renderLayer(i,u,m,E){m.isHidden(this.transform.zoom)||("background"===m.type||"sky"===m.type||"custom"===m.type||E&&E.length)&&(this.id=m.id,this.gpuTimingStart(m),i.transform.projection.unsupportedLayers&&i.transform.projection.unsupportedLayers.includes(m.type)||ai[m.type](i,u,m,E,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(i){if(!this.options.gpuTiming)return;const u=this.context.extTimerQuery;let m=this.gpuTimers[i.id];m||(m=this.gpuTimers[i.id]={calls:0,cpuTime:0,query:u.createQueryEXT()}),m.calls++,u.beginQueryEXT(u.TIME_ELAPSED_EXT,m.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const i=this.context.extTimerQuery,u=i.createQueryEXT();this.deferredRenderGpuTimeQueries.push(u),i.beginQueryEXT(i.TIME_ELAPSED_EXT,u)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const i=this.context.extTimerQuery;i.endQueryEXT(i.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const i=this.context.extTimerQuery;i.endQueryEXT(i.TIME_ELAPSED_EXT)}collectGpuTimers(){const i=this.gpuTimers;return this.gpuTimers={},i}collectDeferredRenderGpuQueries(){const i=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],i}queryGpuTimers(i){const u={};for(const m in i){const E=i[m],M=this.context.extTimerQuery,z=M.getQueryObjectEXT(E.query,M.QUERY_RESULT_EXT)/1e6;M.deleteQueryEXT(E.query),u[m]=z}return u}queryGpuTimeDeferredRender(i){if(!this.options.gpuTimingDeferredRender)return 0;const u=this.context.extTimerQuery;let m=0;for(const E of i)m+=u.getQueryObjectEXT(E,u.QUERY_RESULT_EXT)/1e6,u.deleteQueryEXT(E);return m}translatePosMatrix(i,u,m,E,M){if(!m[0]&&!m[1])return i;const z=M?"map"===E?this.transform.angle:0:"viewport"===E?-this.transform.angle:0;if(z){const de=Math.sin(z),pe=Math.cos(z);m=[m[0]*pe-m[1]*de,m[0]*de+m[1]*pe]}const Z=[M?m[0]:wi(u,m[0],this.transform.zoom),M?m[1]:wi(u,m[1],this.transform.zoom),0],K=new Float32Array(16);return l.translate(K,i,Z),K}saveTileTexture(i){const u=this._tileTextures[i.size[0]];u?u.push(i):this._tileTextures[i.size[0]]=[i]}getTileTexture(i){const u=this._tileTextures[i];return u&&u.length>0?u.pop():null}isPatternMissing(i){if(!i)return!1;if(!i.from||!i.to)return!0;const u=this.imageManager.getPattern(i.from.toString()),m=this.imageManager.getPattern(i.to.toString());return!u||!m}currentGlobalDefines(){const i=this.terrain&&this.terrain.renderingToTexture,u=this.style&&this.style.fog,m=[];return this.terrain&&!this.terrain.renderingToTexture&&m.push("TERRAIN"),u&&!i&&0!==u.getOpacity(this.transform.pitch)&&m.push("FOG"),i&&m.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&m.push("OVERDRAW_INSPECTOR"),m}useProgram(i,u,m){this.cache=this.cache||{};const E=m||[],M=this.currentGlobalDefines().concat(E),z=bs.cacheKey(be[i],i,M,u);return this.cache[z]||(this.cache[z]=new bs(this.context,i,be[i],u,bl[i],M)),this.cache[z]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const i=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(i.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=l.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new l.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(i,u,m){if(this.terrain&&this.terrain.renderingToTexture)return;const E=this.style.fog;if(E){const M=E.getOpacity(this.transform.pitch),z=((Z,K,de,pe,De,Fe,Je,Ge,He,$e,ze)=>{const tt=Z.transform,et=K.properties.get("color").toArray01();et[3]=pe;const Mt=Z.frameCounter/1e3%1;return{u_fog_matrix:de?tt.calculateFogTileMatrix(de):Z.identityMat,u_fog_range:K.getFovAdjustedRange(tt._fov),u_fog_color:et,u_fog_horizon_blend:K.properties.get("horizon-blend"),u_fog_temporal_offset:Mt,u_frustum_tl:De,u_frustum_tr:Fe,u_frustum_br:Je,u_frustum_bl:Ge,u_globe_pos:He,u_globe_radius:$e,u_viewport:ze,u_globe_transition:l.globeToMercatorTransition(tt.zoom),u_is_globe:+("globe"===tt.projection.name)}})(this,E,m,M,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*l.exported.devicePixelRatio,this.transform.height*l.exported.devicePixelRatio]);u.setFogUniformValues(i,z)}}setTileLoadedFlag(i){this.tileLoaded=i}saveCanvasCopy(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1}canvasCopy(){const i=this.context.gl,u=i.createTexture();return i.bindTexture(i.TEXTURE_2D,u),i.copyTexImage2D(i.TEXTURE_2D,0,i.RGBA,0,0,i.drawingBufferWidth,i.drawingBufferHeight,0),u}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const i=this.style&&this.style.fog;return!!i&&0!==i.getOpacity(this.transform.pitch)}getBackgroundTiles(){const i=this._backgroundTiles,u=this._backgroundTiles={},m=this.transform.coveringTiles({tileSize:512});for(const E of m)u[E.key]=i[E.key]||new l.Tile(E,512,this.transform.tileZoom,this);return u}clearBackgroundTiles(){this._backgroundTiles={}}}class pr{constructor(i=0,u=0,m=0,E=0){if(isNaN(i)||i<0||isNaN(u)||u<0||isNaN(m)||m<0||isNaN(E)||E<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=i,this.bottom=u,this.left=m,this.right=E}interpolate(i,u,m){return null!=u.top&&null!=i.top&&(this.top=l.number(i.top,u.top,m)),null!=u.bottom&&null!=i.bottom&&(this.bottom=l.number(i.bottom,u.bottom,m)),null!=u.left&&null!=i.left&&(this.left=l.number(i.left,u.left,m)),null!=u.right&&null!=i.right&&(this.right=l.number(i.right,u.right,m)),this}getCenter(i,u){const m=l.clamp((this.left+i-this.right)/2,0,i),E=l.clamp((this.top+u-this.bottom)/2,0,u);return new l.pointGeometry(m,E)}equals(i){return this.top===i.top&&this.bottom===i.bottom&&this.left===i.left&&this.right===i.right}clone(){return new pr(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Ni(d,i){const u=l.getColumn(d,3);l.fromQuat(d,i),l.setColumn(d,3,u)}function cr(d,i){const u=l.identity$1([]);return l.rotateZ$1(u,u,-i),l.rotateX$1(u,u,-d),u}function yr(d,i){const u=[d[0],d[1],0],m=[i[0],i[1],0];if(l.length(u)>=1e-15){const z=l.normalize([],u);l.scale$2(m,z,l.dot(m,z)),i[0]=m[0],i[1]=m[1]}const E=l.cross([],i,d);if(l.len(E)<1e-15)return null;const M=Math.atan2(-E[1],E[0]);return cr(Math.atan2(Math.sqrt(d[0]*d[0]+d[1]*d[1]),-d[2]),M)}class q{constructor(i,u){this.position=i,this.orientation=u}get position(){return this._position}set position(i){if(i){const u=i instanceof l.MercatorCoordinate?i:new l.MercatorCoordinate(i[0],i[1],i[2]);this._renderWorldCopies&&(u.x=l.wrap(u.x,0,1)),this._position=u}else this._position=null}lookAtPoint(i,u){if(this.orientation=null,!this.position)return;const m=this._elevation?this._elevation.getAtPointOrZero(l.MercatorCoordinate.fromLngLat(i)):0,E=this.position,M=l.MercatorCoordinate.fromLngLat(i,m),z=[M.x-E.x,M.y-E.y,M.z-E.z];u||(u=[0,0,1]),u[2]=Math.abs(u[2]),this.orientation=yr(z,u)}setPitchBearing(i,u){this.orientation=cr(l.degToRad(i),l.degToRad(-u))}}class J{constructor(i,u){this._transform=l.identity([]),this.orientation=u,this.position=i}get mercatorPosition(){const i=this.position;return new l.MercatorCoordinate(i[0],i[1],i[2])}get position(){const i=l.getColumn(this._transform,3);return[i[0],i[1],i[2]]}set position(i){var u;i&&l.setColumn(this._transform,3,[(u=i)[0],u[1],u[2],1])}get orientation(){return this._orientation}set orientation(i){this._orientation=i||l.identity$1([]),i&&Ni(this._transform,this._orientation)}getPitchBearing(){const i=this.forward(),u=this.right();return{bearing:Math.atan2(-u[1],u[0]),pitch:Math.atan2(Math.sqrt(i[0]*i[0]+i[1]*i[1]),-i[2])}}setPitchBearing(i,u){this._orientation=cr(i,u),Ni(this._transform,this._orientation)}forward(){const i=l.getColumn(this._transform,2);return[-i[0],-i[1],-i[2]]}up(){const i=l.getColumn(this._transform,1);return[-i[0],-i[1],-i[2]]}right(){const i=l.getColumn(this._transform,0);return[i[0],i[1],i[2]]}getCameraToWorld(i,u){const m=new Float64Array(16);return l.invert(m,this.getWorldToCamera(i,u)),m}getWorldToCameraPosition(i,u,m){const E=this.position;l.scale$2(E,E,-i);const M=new Float64Array(16);return l.fromScaling(M,[m,m,m]),l.translate(M,M,E),M[10]*=u,M}getWorldToCamera(i,u){const m=new Float64Array(16),E=new Float64Array(4),M=this.position;return l.conjugate(E,this._orientation),l.scale$2(M,M,-i),l.fromQuat(m,E),l.translate(m,m,M),m[1]*=-1,m[5]*=-1,m[9]*=-1,m[13]*=-1,m[8]*=u,m[9]*=u,m[10]*=u,m[11]*=u,m}getCameraToClipPerspective(i,u,m,E){const M=new Float64Array(16);return l.perspective(M,i,u,m,E),M}getDistanceToElevation(i){const u=0===i?0:l.mercatorZfromAltitude(i,this.position[1]),m=this.forward();return(u-this.position[2])/m[2]}clone(){return new J([...this.position],[...this.orientation])}}function Ie(d,i){const u=pn(d.projection,d.zoom,d.width,d.height),m=function(M,z,Z,K,de){const pe=new l.LngLat(Z.lng-180*Jn,Z.lat),De=new l.LngLat(Z.lng+180*Jn,Z.lat),Fe=M.project(pe.lng,pe.lat),Je=M.project(De.lng,De.lat),Ge=-Math.atan2(Je.y-Fe.y,Je.x-Fe.x),He=l.MercatorCoordinate.fromLngLat(Z);He.y=l.clamp(He.y,-.999975,.999975);const $e=He.toLngLat(),ze=M.project($e.lng,$e.lat),tt=l.MercatorCoordinate.fromLngLat($e);tt.x+=Jn;const et=tt.toLngLat(),Mt=M.project(et.lng,et.lat),Et=Ts(Mt.x-ze.x,Mt.y-ze.y,Ge),yt=l.MercatorCoordinate.fromLngLat($e);yt.y+=Jn;const It=yt.toLngLat(),Ct=M.project(It.lng,It.lat),Vt=Ts(Ct.x-ze.x,Ct.y-ze.y,Ge),sn=Math.abs(Et.x)/Math.abs(Vt.y),ni=l.identity([]);l.rotateZ(ni,ni,-Ge*(1-(de?0:K)));const Xt=l.identity([]);return l.scale(Xt,Xt,[1,1-(1-sn)*K,1]),Xt[4]=-Vt.x/Vt.y*K,l.rotateZ(Xt,Xt,Ge),l.multiply(Xt,ni,Xt),Xt}(d.projection,0,d.center,u,i),E=ut(d);return l.scale(m,m,[E,E,1]),m}function ut(d){const i=d.projection,u=pn(d.projection,d.zoom,d.width,d.height),m=xo(i,d.center),E=xo(i,l.LngLat.convert(i.center));return Math.pow(2,m*u+(1-u)*E)}function pn(d,i,u,m,E=1/0){const M=d.range;if(!M)return 0;const z=Math.min(E,Math.max(u,m)),Z=Math.log(z/1024)/Math.LN2;return l.smoothstep(M[0]+Z,M[1]+Z,i)}const Jn=1/4e4;function xo(d,i){const u=l.clamp(i.lat,-l.MAX_MERCATOR_LATITUDE,l.MAX_MERCATOR_LATITUDE),m=new l.LngLat(i.lng-180*Jn,u),E=new l.LngLat(i.lng+180*Jn,u),M=d.project(m.lng,u),z=d.project(E.lng,u),Z=l.MercatorCoordinate.fromLngLat(m),K=l.MercatorCoordinate.fromLngLat(E),de=z.x-M.x,pe=z.y-M.y,De=K.x-Z.x,Fe=K.y-Z.y,Je=Math.sqrt((De*De+Fe*Fe)/(de*de+pe*pe));return Math.log(Je)/Math.LN2}function Ts(d,i,u){const m=Math.cos(u),E=Math.sin(u);return{x:d*m-i*E,y:d*E+i*m}}class Hr{constructor(i,u,m,E,M,z,Z){this.tileSize=512,this._renderWorldCopies=void 0===M||M,this._minZoom=i||0,this._maxZoom=u||22,this._minPitch=null==m?0:m,this._maxPitch=null==E?60:E,this.setProjection(z),this.setMaxBounds(Z),this.width=0,this.height=0,this._center=new l.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new pr,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new J,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const i=new Hr(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return i._elevation=this._elevation,i._centerAltitude=this._centerAltitude,i._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,i.tileSize=this.tileSize,i.width=this.width,i.height=this.height,i.cameraElevationReference=this.cameraElevationReference,i._center=this._center,i._setZoom(this.zoom),i._seaLevelZoom=this._seaLevelZoom,i.angle=this.angle,i._fov=this._fov,i._pitch=this._pitch,i._nearZ=this._nearZ,i._farZ=this._farZ,i._averageElevation=this._averageElevation,i._unmodified=this._unmodified,i._edgeInsets=this._edgeInsets.clone(),i._camera=this._camera.clone(),i._calcMatrices(),i.freezeTileCoverage=this.freezeTileCoverage,i.frustumCorners=this.frustumCorners,i}get elevation(){return this._elevation}set elevation(i){this._elevation!==i&&(this._elevation=i,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(i){const u=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||u)&&this._updateCameraOnTerrain(),(i||u)&&this._constrainCameraAltitude(),this._calcMatrices()}getProjection(){return l.pick(this.projection,["name","center","parallels"])}setProjection(i){this.projectionOptions=i||{name:"mercator"};const u=this.projection?this.getProjection():void 0;this.projection=l.getProjection(this.projectionOptions);const m=!oe(u,this.getProjection());return m&&this._calcMatrices(),this.mercatorFromTransition=!1,m}setMercatorFromTransition(){const i=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=l.getProjection({name:"mercator"});const u=i!==this.projection.name;return u&&this._calcMatrices(),u}get minZoom(){return this._minZoom}set minZoom(i){this._minZoom!==i&&(this._minZoom=i,this.zoom=Math.max(this.zoom,i))}get maxZoom(){return this._maxZoom}set maxZoom(i){this._maxZoom!==i&&(this._maxZoom=i,this.zoom=Math.min(this.zoom,i))}get minPitch(){return this._minPitch}set minPitch(i){this._minPitch!==i&&(this._minPitch=i,this.pitch=Math.max(this.pitch,i))}get maxPitch(){return this._maxPitch}set maxPitch(i){this._maxPitch!==i&&(this._maxPitch=i,this.pitch=Math.min(this.pitch,i))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(i){void 0===i?i=!0:null===i&&(i=!1),this._renderWorldCopies=i}get worldSize(){return this.tileSize*this.scale}get cameraWorldSize(){const i=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(i))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return l.mercatorZfromAltitude(this.center.lat,this.cameraWorldSize)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new l.pointGeometry(this.width,this.height)}get bearing(){return l.wrap(this.rotation,-180,180)}set bearing(i){this.rotation=i}get rotation(){return-this.angle/Math.PI*180}set rotation(i){const u=-i*Math.PI/180;var m,E,M,z,Z,K,de,pe,De,Fe;this.angle!==u&&(this._unmodified=!1,this.angle=u,this._calcMatrices(),this.rotationMatrix=(m=new l.ARRAY_TYPE(4),l.ARRAY_TYPE!=Float32Array&&(m[1]=0,m[2]=0),m[0]=1,m[3]=1,m),E=this.rotationMatrix,z=this.angle,Z=(M=this.rotationMatrix)[0],K=M[1],de=M[2],pe=M[3],De=Math.sin(z),Fe=Math.cos(z),E[0]=Z*Fe+de*De,E[1]=K*Fe+pe*De,E[2]=Z*-De+de*Fe,E[3]=K*-De+pe*Fe)}get pitch(){return this._pitch/Math.PI*180}set pitch(i){const u=l.clamp(i,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==u&&(this._unmodified=!1,this._pitch=u,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(i){i=Math.max(.01,Math.min(60,i)),this._fov!==i&&(this._unmodified=!1,this._fov=i/180*Math.PI,this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(i){this._averageElevation=i,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(i){const u=Math.min(Math.max(i,this.minZoom),this.maxZoom);this._zoom!==u&&(this._unmodified=!1,this._setZoom(u),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(i){this._zoom=i,this.scale=this.zoomScale(i),this.tileZoom=Math.floor(i),this.zoomFraction=i-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const i=this._elevation;this._centerAltitude=i.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=i.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const i=this._elevation,u=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],m=this.horizonLineFromTop();let E=0,M=0;for(let z=0;z<u.length;z++){const Z=new l.pointGeometry(u[z][0]*this.width,m+u[z][1]*(this.height-m)),K=i.pointCoordinate(Z);if(!K)continue;const de=1/Math.hypot(K[0]-this._camera.position[0],K[1]-this._camera.position[1]);E+=K[3]*de,M+=de}return 0===M?NaN:E/M}get center(){return this._center}set center(i){i.lat===this._center.lat&&i.lng===this._center.lng||(this._unmodified=!1,this._center=i,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const i=this._seaLevelZoom,u=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),m=this.pixelsPerMeter/this.worldSize*u,E=this._mercatorZfromZoom(i),M=this._mercatorZfromZoom(this._maxZoom),z=Math.max(E-m,M);this._setZoom(this._zoomFromMercatorZ(z))}get padding(){return this._edgeInsets.toJSON()}set padding(i){this._edgeInsets.equals(i)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,i,1),this._calcMatrices())}computeZoomRelativeTo(i){const u=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,i.toAltitude()));let m;m=i.z<this._camera.position[2]?[u.x,u.y,u.z]:[i.x,i.y,i.z];const E=l.length(l.sub([],this._camera.position,m));return l.clamp(this._zoomFromMercatorZ(E),this._minZoom,this._maxZoom)}setFreeCameraOptions(i){if(!this.height||!i.position&&!i.orientation)return;this._updateCameraState();let u=!1;if(i.orientation&&!l.exactEquals(i.orientation,this._camera.orientation)&&(u=this._setCameraOrientation(i.orientation)),i.position){const m=[i.position.x,i.position.y,i.position.z];l.exactEquals$1(m,this._camera.position)||(this._setCameraPosition(m),u=!0)}u&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const i=this._camera.position,u=new q;return u.position=new l.MercatorCoordinate(i[0],i[1],i[2]),u.orientation=this._camera.orientation,u._elevation=this.elevation,u._renderWorldCopies=this.renderWorldCopies,u}_setCameraOrientation(i){if(!l.length$1(i))return!1;l.normalize$1(i,i);const u=l.transformQuat([],[0,0,-1],i),m=l.transformQuat([],[0,-1,0],i);if(m[2]<0)return!1;const E=yr(u,m);return!!E&&(this._camera.orientation=E,!0)}_setCameraPosition(i){const u=this.zoomScale(this.minZoom)*this.tileSize,m=this.zoomScale(this.maxZoom)*this.tileSize,E=this.cameraToCenterDistance;i[2]=l.clamp(i[2],E/m,E/u),this._camera.position=i}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(i){return this._edgeInsets.equals(i)}interpolatePadding(i,u,m){this._unmodified=!1,this._edgeInsets.interpolate(i,u,m),this._constrain(),this._calcMatrices()}coveringZoomLevel(i){const u=(i.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/i.tileSize));return Math.max(0,u)}getVisibleUnwrappedCoordinates(i){const u=[new l.UnwrappedTileID(0,i)];if(this.renderWorldCopies){const m=this.pointCoordinate(new l.pointGeometry(0,0)),E=this.pointCoordinate(new l.pointGeometry(this.width,0)),M=this.pointCoordinate(new l.pointGeometry(this.width,this.height)),z=this.pointCoordinate(new l.pointGeometry(0,this.height)),Z=Math.floor(Math.min(m.x,E.x,M.x,z.x)),K=Math.floor(Math.max(m.x,E.x,M.x,z.x)),de=1;for(let pe=Z-de;pe<=K+de;pe++)0!==pe&&u.push(new l.UnwrappedTileID(pe,i))}return u}coveringTiles(i){let u=this.coveringZoomLevel(i);const m=u,E=this.elevation&&!i.isTerrainDEM,M="mercator"===this.projection.name;if(void 0!==i.minzoom&&u<i.minzoom)return[];void 0!==i.maxzoom&&u>i.maxzoom&&(u=i.maxzoom);const z=this.locationCoordinate(this.center),Z=this.center.lat,K=1<<u,de=[K*z.x,K*z.y,0],pe="globe"===this.projection.name,De=!pe,Fe=l.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,u,De),Je=pe?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),Ge=K*l.mercatorZfromAltitude(1,this.center.lat),He=this._camera.position[2]/l.mercatorZfromAltitude(1,this.center.lat),$e=[K*Je.x,K*Je.y,He*(De?1:Ge)],ze=this.cameraToCenterDistance/i.tileSize*(i.roundZoom?1:.502),tt=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?u:0,et=i.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,Mt=i.isTerrainDEM?-et:this._elevation?this._elevation.getMinElevationBelowMSL():0,Et=this.projection.isReprojectedInTileSpace?ut(this):1,yt=_n=>{const Un=new l.MercatorCoordinate(_n.x+25e-6,_n.y,_n.z),Ai=new l.MercatorCoordinate(_n.x,_n.y+25e-6,_n.z),gi=_n.toLngLat(),$i=Un.toLngLat(),vr=Ai.toLngLat(),jr=this.locationCoordinate(gi),mo=this.locationCoordinate($i),tr=this.locationCoordinate(vr),Kr=Math.hypot(mo.x-jr.x,mo.y-jr.y),Ro=Math.hypot(tr.x-jr.x,tr.y-jr.y);return Math.sqrt(Kr*Ro)*Et/25e-6},It=_n=>{const li=et,Un=Mt;return{aabb:l.tileAABB(this,K,0,0,0,_n,Un,li,this.projection),zoom:0,x:0,y:0,minZ:Un,maxZ:li,wrap:_n,fullyVisible:!1}},Ct=[];let Vt=[];const sn=u,ni=i.reparseOverscaled?m:u,Xt=_n=>_n*_n,Ln=Xt((He-this._centerAltitude)*Ge),zn=_n=>{if(!this._elevation||!_n.tileID||!M)return;const li=this._elevation.getMinMaxForTile(_n.tileID),Un=_n.aabb;li?(Un.min[2]=li.min,Un.max[2]=li.max,Un.center[2]=(Un.min[2]+Un.max[2])/2):(_n.shouldSplit=di(_n),_n.shouldSplit||(Un.min[2]=Un.max[2]=Un.center[2]=this._centerAltitude))},di=_n=>{if(_n.zoom<tt)return!0;if(_n.zoom===sn)return!1;if(null!=_n.shouldSplit)return _n.shouldSplit;const li=_n.aabb.distanceX($e),Un=_n.aabb.distanceY($e);let Ai=Ln,gi=1;if(pe){Ai=Xt(_n.aabb.distanceZ($e));const vr=Math.pow(2,_n.zoom),jr=l.latFromMercatorY((_n.y+1)/vr),mo=l.latFromMercatorY(_n.y/vr),tr=Math.min(Math.max(Z,jr),mo),Kr=l.circumferenceAtLatitude(tr)/l.circumferenceAtLatitude(Z);if(gi=tr===Z?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Kr/this._mercatorScaleRatio),this.zoom<=l.GLOBE_ZOOM_THRESHOLD_MIN&&_n.zoom===sn-1&&Kr>=.9)return!0}else if(E&&(Ai=Xt(_n.aabb.distanceZ($e)*Ge)),this.projection.isReprojectedInTileSpace&&m<=5){const vr=Math.pow(2,_n.zoom),jr=yt(new l.MercatorCoordinate((_n.x+.5)/vr,(_n.y+.5)/vr));gi=jr>.85?1:jr}const $i=li*li+Un*Un+Ai;return $i<Xt((1<<sn-_n.zoom)*ze*gi*((vr,jr)=>{if(jr*Xt(.707)<vr)return 1;const mo=Math.sqrt(jr/vr);return mo/(1.4144271570014144+(Math.pow(1.1,mo-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Ai,Ln),$i))};if(this.renderWorldCopies)for(let _n=1;_n<=3;_n++)Ct.push(It(-_n)),Ct.push(It(_n));for(Ct.push(It(0));Ct.length>0;){const _n=Ct.pop(),li=_n.x,Un=_n.y;let Ai=_n.fullyVisible;if(!Ai){const gi=_n.aabb.intersects(Fe);if(0===gi)continue;Ai=2===gi}if(_n.zoom!==sn&&di(_n))for(let gi=0;gi<4;gi++){const $i=(li<<1)+gi%2,vr=(Un<<1)+(gi>>1),jr={aabb:M?_n.aabb.quadrant(gi):l.tileAABB(this,K,_n.zoom+1,$i,vr,_n.wrap,_n.minZ,_n.maxZ,this.projection),zoom:_n.zoom+1,x:$i,y:vr,wrap:_n.wrap,fullyVisible:Ai,tileID:void 0,shouldSplit:void 0,minZ:_n.minZ,maxZ:_n.maxZ};E&&!pe&&(jr.tileID=new l.OverscaledTileID(_n.zoom+1===sn?ni:_n.zoom+1,_n.wrap,_n.zoom+1,$i,vr),zn(jr)),Ct.push(jr)}else{const gi=_n.zoom===sn?ni:_n.zoom;if(i.minzoom&&i.minzoom>gi)continue;const $i=de[0]-(.5+li+(_n.wrap<<_n.zoom))*(1<<u-_n.zoom),vr=de[1]-.5-Un,jr=_n.tileID?_n.tileID:new l.OverscaledTileID(gi,_n.wrap,_n.zoom,li,Un);Vt.push({tileID:jr,distanceSq:$i*$i+vr*vr})}}if(this.fogCullDistSq){const _n=this.fogCullDistSq,li=this.horizonLineFromTop();Vt=Vt.filter(Un=>{const Ai=[0,0,0,1],gi=[l.EXTENT,l.EXTENT,0,1],$i=this.calculateFogTileMatrix(Un.tileID.toUnwrapped());l.transformMat4$1(Ai,Ai,$i),l.transformMat4$1(gi,gi,$i);const vr=l.getAABBPointSquareDist(Ai,gi);if(0===vr)return!0;let jr=!1;const mo=this._elevation;if(mo&&vr>_n&&0!==li){const tr=this.calculateProjMatrix(Un.tileID.toUnwrapped());let Kr;i.isTerrainDEM||(Kr=mo.getMinMaxForTile(Un.tileID)),Kr||(Kr={min:Mt,max:et});const Ro=l.furthestTileCorner(this.rotation),Es=[Ro[0]*l.EXTENT,Ro[1]*l.EXTENT,Kr.max];l.transformMat4(Es,Es,tr),jr=(1-Es[1])*this.height*.5<li}return vr<_n||jr})}return Vt.sort((_n,li)=>_n.distanceSq-li.distanceSq).map(_n=>_n.tileID)}resize(i,u){this.width=i,this.height=u,this.pixelsToGLUnits=[2/i,-2/u],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(i){return Math.pow(2,i)}scaleZoom(i){return Math.log(i)/Math.LN2}project(i){const u=l.clamp(i.lat,-l.MAX_MERCATOR_LATITUDE,l.MAX_MERCATOR_LATITUDE),m=this.projection.project(i.lng,u);return new l.pointGeometry(m.x*this.worldSize,m.y*this.worldSize)}unproject(i){return this.projection.unproject(i.x/this.worldSize,i.y/this.worldSize)}get point(){return this.project(this.center)}setLocationAtPoint(i,u){let m,E;const M=this.centerPoint;if("globe"===this.projection.name){const Z=this.worldSize;m=(u.x-M.x)/Z,E=(u.y-M.y)/Z}else{const Z=this.pointCoordinate(u),K=this.pointCoordinate(M);m=Z.x-K.x,E=Z.y-K.y}const z=this.locationCoordinate(i);this.setLocation(new l.MercatorCoordinate(z.x-m,z.y-E))}setLocation(i){this.center=this.coordinateLocation(i),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(i){return this.projection.locationPoint(this,i)}locationPoint3D(i){return this.projection.locationPoint(this,i,!0)}pointLocation(i){return this.coordinateLocation(this.pointCoordinate(i))}pointLocation3D(i){return this.coordinateLocation(this.pointCoordinate3D(i))}locationCoordinate(i,u){const m=u?l.mercatorZfromAltitude(u,i.lat):void 0,E=this.projection.project(i.lng,i.lat);return new l.MercatorCoordinate(E.x,E.y,m)}coordinateLocation(i){return this.projection.unproject(i.x,i.y)}pointRayIntersection(i,u){const m=null!=u?u:this._centerAltitude,E=[i.x,i.y,0,1],M=[i.x,i.y,1,1];l.transformMat4$1(E,E,this.pixelMatrixInverse),l.transformMat4$1(M,M,this.pixelMatrixInverse);const z=M[3];l.scale$1(E,E,1/E[3]),l.scale$1(M,M,1/z);const Z=E[2],K=M[2];return{p0:E,p1:M,t:Z===K?0:(m-Z)/(K-Z)}}screenPointToMercatorRay(i){const u=[i.x,i.y,0,1],m=[i.x,i.y,1,1];return l.transformMat4$1(u,u,this.pixelMatrixInverse),l.transformMat4$1(m,m,this.pixelMatrixInverse),l.scale$1(u,u,1/u[3]),l.scale$1(m,m,1/m[3]),u[2]=l.mercatorZfromAltitude(u[2],this._center.lat)*this.worldSize,m[2]=l.mercatorZfromAltitude(m[2],this._center.lat)*this.worldSize,l.scale$1(u,u,1/this.worldSize),l.scale$1(m,m,1/this.worldSize),new l.Ray([u[0],u[1],u[2]],l.normalize([],l.sub([],m,u)))}rayIntersectionCoordinate(i){const{p0:u,p1:m,t:E}=i,M=l.mercatorZfromAltitude(u[2],this._center.lat),z=l.mercatorZfromAltitude(m[2],this._center.lat);return new l.MercatorCoordinate(l.number(u[0],m[0],E)/this.worldSize,l.number(u[1],m[1],E)/this.worldSize,l.number(M,z,E))}pointCoordinate(i,u=this._centerAltitude){return this.projection.pointCoordinate(this,i.x,i.y,u)}pointCoordinate3D(i){if(!this.elevation)return this.pointCoordinate(i);let u=this.projection.pointCoordinate3D(this,i.x,i.y);if(u)return new l.MercatorCoordinate(u[0],u[1],u[2]);let m=0,E=this.horizonLineFromTop();if(i.y>E)return this.pointCoordinate(i);const M=.02*E,z=i.clone();for(let Z=0;Z<10&&E-m>M;Z++){z.y=l.number(m,E,.66);const K=this.projection.pointCoordinate3D(this,z.x,z.y);K?(E=z.y,u=K):m=z.y}return u?new l.MercatorCoordinate(u[0],u[1],u[2]):this.pointCoordinate(i)}isPointAboveHorizon(i){return this.projection.isPointAboveHorizon(this,i)}_coordinatePoint(i,u){const m=u&&this.elevation?this.elevation.getAtPointOrZero(i,this._centerAltitude):this._centerAltitude,E=[i.x*this.worldSize,i.y*this.worldSize,m+i.toAltitude(),1];return l.transformMat4$1(E,E,this.pixelMatrix),E[3]>0?new l.pointGeometry(E[0]/E[3],E[1]/E[3]):new l.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBounds(i,u){const m=new l.pointGeometry(this._edgeInsets.left,this._edgeInsets.top),E=new l.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top),M=new l.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom),z=new l.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom);let Z=this.pointCoordinate(m,i),K=this.pointCoordinate(E,i);const de=this.pointCoordinate(M,u),pe=this.pointCoordinate(z,u),De=(Fe,Je)=>(Je.y-Fe.y)/(Je.x-Fe.x);return Z.y>1&&K.y>=0?Z=new l.MercatorCoordinate((1-pe.y)/De(pe,Z)+pe.x,1):Z.y<0&&K.y<=1&&(Z=new l.MercatorCoordinate(-pe.y/De(pe,Z)+pe.x,0)),K.y>1&&Z.y>=0?K=new l.MercatorCoordinate((1-de.y)/De(de,K)+de.x,1):K.y<0&&Z.y<=1&&(K=new l.MercatorCoordinate(-de.y/De(de,K)+de.x,0)),(new l.LngLatBounds).extend(this.coordinateLocation(Z)).extend(this.coordinateLocation(K)).extend(this.coordinateLocation(pe)).extend(this.coordinateLocation(de))}_getBounds3D(){const i=this.elevation;if(!i.visibleDemTiles.length)return this._getBounds(0,0);const u=i.visibleDemTiles.reduce((m,E)=>{if(E.dem){const M=E.dem.tree;m.min=Math.min(m.min,M.minimums[0]),m.max=Math.max(m.max,M.maximums[0])}return m},{min:Number.MAX_VALUE,max:0});return this._getBounds(u.min*i.exaggeration(),u.max*i.exaggeration())}getBounds(){return this._terrainEnabled()?this._getBounds3D():this._getBounds(0,0)}horizonLineFromTop(i=!0){const u=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,m=this.height/2-u*(1-this._horizonShift);return i?Math.max(0,m):m}getMaxBounds(){return this.maxBounds}setMaxBounds(i){this.maxBounds=i,this.minLat=-l.MAX_MERCATOR_LATITUDE,this.maxLat=l.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,i&&(this.minLat=i.getSouth(),this.maxLat=i.getNorth(),this.minLng=i.getWest(),this.maxLng=i.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=l.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=l.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=l.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=l.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(i,u){return this.projection.createTileMatrix(this,u,i)}calculateDistanceTileData(i){const u=i.key,m=this._distanceTileDataCache;if(m[u])return m[u];const E=i.canonical,M=1/this.height,z=this.cameraWorldSize/this.zoomScale(E.z),Z=(E.x+Math.pow(2,E.z)*i.wrap)*z,K=E.y*z,de=this.point,pe=this.angle,De=Math.sin(-pe),Fe=-Math.cos(-pe);return m[u]={bearing:[De,Fe],center:[(de.x-Z)*M,(de.y-K)*M],scale:z/l.EXTENT*M},m[u]}calculateFogTileMatrix(i){const u=i.key,m=this._fogTileMatrixCache;if(m[u])return m[u];const E=this.projection.createTileMatrix(this,this.cameraWorldSize,i);return l.multiply(E,this.worldToFogMatrix,E),m[u]=new Float32Array(E),m[u]}calculateProjMatrix(i,u=!1){const m=i.key,E=u?this._alignedProjMatrixCache:this._projMatrixCache;if(E[m])return E[m];const M=this.calculatePosMatrix(i,this.worldSize);return l.multiply(M,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:u?this.alignedProjMatrix:this.projMatrix,M),E[m]=new Float32Array(M),E[m]}calculatePixelsToTileUnitsMatrix(i){const u=i.tileID.key,m=this._pixelsToTileUnitsCache;if(m[u])return m[u];const E=function(M,z){const{scale:Z}=M.tileTransform,K=Z*l.EXTENT/(M.tileSize*Math.pow(2,z.zoom-M.tileID.overscaledZ+M.tileID.canonical.z));return de=new Float32Array(4),Fe=(pe=z.inverseAdjustmentMatrix)[1],Je=pe[2],Ge=pe[3],$e=(De=[K,K])[1],de[0]=pe[0]*(He=De[0]),de[1]=Fe*He,de[2]=Je*$e,de[3]=Ge*$e,de;var de,pe,De,Fe,Je,Ge,He,$e}(i,this);return m[u]=E,m[u]}customLayerMatrix(){return this.mercatorMatrix.slice()}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const i=this._elevation;this._updateCameraState();const u=l.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,m=this._computeCameraPosition(u),E=this._camera.forward(),M=l.mercatorZfromAltitude(1,this._center.lat);m[2]/=M,E[2]/=M,l.normalize(E,E);const z=i.raycast(m,E,i.exaggeration());if(z){const Z=l.scaleAndAdd([],m,E,z),K=new l.MercatorCoordinate(Z[0],Z[1],l.mercatorZfromAltitude(Z[2],l.latFromMercatorY(Z[1]))),de=(K.z+l.length([K.x-m[0],K.y-m[1],K.z-m[2]*M]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(de),this._centerAltitude=K.toAltitude(),this._center=this.coordinateLocation(K),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCameraAltitude(){if(!this._elevation)return;const i=this._elevation;this._updateCameraState();const u=l.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,m=this._computeCameraPosition(u),E=i.getAtPointOrZero(new l.MercatorCoordinate(...m)),M=this._minimumHeightOverTerrain()*Math.cos(l.degToRad(this._maxPitch)),z=this._camera.position[2]-this.pixelsPerMeter/this.worldSize*E;if(z<M){const Z=this.locationCoordinate(this._center,this._centerAltitude),K=[Z.x-m[0],Z.y-m[1],Z.z-m[2]],de=l.length(K);K[2]-=(M-z)/this._pixelsPerMercatorPixel;const pe=l.length(K);if(0===pe)return;l.scale$2(K,K,de/pe*this._pixelsPerMercatorPixel),this._camera.position=[Z.x-K[0],Z.y-K[1],Z.z*this._pixelsPerMercatorPixel-K[2]],this._camera.orientation=yr(K,this._camera.up()),this._updateStateFromCamera()}}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const i="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||i){const Fe=this.center;return Fe.lat=l.clamp(Fe.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!i)&&(Fe.lng=l.clamp(Fe.lng,this.minLng,this.maxLng)),this.center=Fe,void(this._constraining=!1)}const u=this._unmodified,{x:m,y:E}=this.point;let M=0,z=m,Z=E;const K=this.width/2,de=this.height/2,pe=this.worldMinY*this.scale,De=this.worldMaxY*this.scale;if(E-de<pe&&(Z=pe+de),E+de>De&&(Z=De-de),De-pe<this.height&&(M=Math.max(M,this.height/(De-pe)),Z=(De+pe)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const Fe=this.worldMinX*this.scale,Je=this.worldMaxX*this.scale,Ge=this.worldSize/2-(Fe+Je)/2;z=(m+Ge+this.worldSize)%this.worldSize-Ge,z-K<Fe&&(z=Fe+K),z+K>Je&&(z=Je-K),Je-Fe<this.width&&(M=Math.max(M,this.width/(Je-Fe)),z=(Je+Fe)/2)}z===m&&Z===E||(this.center=this.unproject(new l.pointGeometry(z,Z))),M&&(this.zoom+=this.scaleZoom(M)),this._constrainCameraAltitude(),this._unmodified=u,this._constraining=!1}_minZoomForBounds(){let i=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(i=Math.max(i,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),i}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const i=this.centerOffset,u=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=l.mercatorZfromAltitude(1,this.center.lat)/l.mercatorZfromAltitude(1,l.GLOBE_SCALE_MATCH_LATITUDE));const m=pn(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,m),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const E=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?u:1),M=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);M[8]=2*-i.x/this.width,M[9]=2*i.y/this.height;let z=l.mul([],M,E);if(this.projection.isReprojectedInTileSpace){const Et=this.locationCoordinate(this.center),yt=l.identity([]);l.translate(yt,yt,[Et.x*this.worldSize,Et.y*this.worldSize,0]),l.multiply(yt,yt,Ie(this)),l.translate(yt,yt,[-Et.x*this.worldSize,-Et.y*this.worldSize,0]),l.multiply(z,z,yt),this.inverseAdjustmentMatrix=function(It){const Ct=Ie(It,!0);return Cn([],[Ct[0],Ct[1],Ct[4],Ct[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=l.scale([],z,[this.worldSize,this.worldSize,this.worldSize/u,1]),this.projMatrix=z,this.invProjMatrix=l.invert(new Float64Array(16),this.projMatrix);const Z=l.invert([],M);this.frustumCorners=l.FrustumCorners.fromInvProjectionMatrix(Z,this.horizonLineFromTop(),this.height);const K=new Float32Array(16);l.identity(K),l.scale(K,K,[1,-1,1]),l.rotateX(K,K,this._pitch),l.rotateZ(K,K,this.angle);const de=l.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),pe=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;de[8]=2*-i.x/this.width,de[9]=2*(i.y+pe)/this.height,this.skyboxMatrix=l.multiply(K,de,K);const De=this.point,Fe=De.x,Je=De.y,Ge=this.width%2/2,He=this.height%2/2,$e=Math.cos(this.angle),ze=Math.sin(this.angle),tt=Fe-Math.round(Fe)+$e*Ge+ze*He,et=Je-Math.round(Je)+$e*He+ze*Ge,Mt=new Float64Array(z);if(l.translate(Mt,Mt,[tt>.5?tt-1:tt,et>.5?et-1:et,0]),this.alignedProjMatrix=Mt,z=l.create(),l.scale(z,z,[this.width/2,-this.height/2,1]),l.translate(z,z,[1,-1,0]),this.labelPlaneMatrix=z,z=l.create(),l.scale(z,z,[1,-1,1]),l.translate(z,z,[-1,-1,0]),l.scale(z,z,[2/this.width,2/this.height,1]),this.glCoordMatrix=z,this.pixelMatrix=l.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},z=l.invert(new Float64Array(16),this.pixelMatrix),!z)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=z,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=l.calculateGlobeMatrix(this);const Et=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=l.transformMat4(Et,Et,E),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=z;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const i=this.cameraWorldSize,u=this.cameraPixelsPerMeter,m=this._camera.position,E=1/this.height/this._pixelsPerMercatorPixel,M=[i,i,u];l.scale$2(M,M,E),l.scale$2(m,m,-1),l.multiply$2(m,m,M);const z=l.create();l.translate(z,z,m),l.scale(z,z,M),this.mercatorFogMatrix=z,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(i,u,E)}_computeCameraPosition(i){const u=(i=i||this.pixelsPerMeter)/this.pixelsPerMeter,m=this._camera.forward(),E=this.point,M=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*u-i/this.worldSize*this._centerAltitude;return[E.x/this.worldSize-m[0]*M,E.y/this.worldSize-m[1]*M,i/this.worldSize*this._centerAltitude-m[2]*M]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(i){const u=this._maxCameraBoundsDistance()*Math.cos(this._pitch),m=i[2];let E=1;m>0&&(E=Math.min((u-this._camera.position[2])/m,1)),this._camera.position=l.scaleAndAdd([],this._camera.position,i,E),this._updateStateFromCamera(),this.projection.wrap&&(this.center=this.center.wrap())}_updateStateFromCamera(){const i=this._camera.position,u=this._camera.forward(),{pitch:m,bearing:E}=this._camera.getPitchBearing(),M=l.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,z=this._mercatorZfromZoom(this._maxZoom)*Math.cos(l.degToRad(this._maxPitch)),Z=Math.max((i[2]-M)/Math.cos(m),z),K=this._zoomFromMercatorZ(Z);l.scaleAndAdd(i,i,u,Z),this._pitch=l.clamp(m,l.degToRad(this.minPitch),l.degToRad(this.maxPitch)),this.angle=l.wrap(E,-Math.PI,Math.PI),this._setZoom(l.clamp(K,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new l.MercatorCoordinate(i[0],i[1],i[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(i){return Math.pow(2,i)*this.tileSize}_mercatorZfromZoom(i){return this.cameraToCenterDistance/this._worldSizeFromZoom(i)}_minimumHeightOverTerrain(){const i=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+2,this._maxZoom);return this._mercatorZfromZoom(i)}_zoomFromMercatorZ(i){return this.scaleZoom(this.cameraToCenterDistance/(i*this.tileSize))}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(l.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(i,u){const m=Math.min(i.x,u.x),E=Math.max(i.x,u.x),M=Math.min(i.y,u.y),z=Math.max(i.y,u.y);if(M<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const Z=[new l.pointGeometry(m,M),new l.pointGeometry(E,z),new l.pointGeometry(m,z),new l.pointGeometry(E,M)],K=this.renderWorldCopies?-3:0,de=this.renderWorldCopies?4:1;for(const pe of Z){const De=this.pointRayIntersection(pe);if(De.t<0)return!0;const Fe=this.rayIntersectionCoordinate(De);if(Fe.x<K||Fe.y<0||Fe.x>de||Fe.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+l.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new l.pointGeometry(0,0),new l.pointGeometry(this.width,this.height))}zoomDeltaToMovement(i,u){const m=l.length(l.sub([],this._camera.position,i)),E=this._zoomFromMercatorZ(m)+u;return m-this._mercatorZfromZoom(E)}getCameraPoint(){if("globe"===this.projection.name){const i=function(u,m){const E=[u[0],u[1],u[2],1];l.transformMat4$1(E,E,m);const M=Math.max(E[3],1e-6);return[E[0]/M,E[1]/M,E[2]/M,M]}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new l.pointGeometry(i[0],i[1])}{const i=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new l.pointGeometry(0,i))}}getCameraToCenterDistance(i){const u=pn(i,this.zoom,this.width,this.height,1024),m=i.pixelSpaceConversion(this.center.lat,this.worldSize,u);return.5/Math.tan(.5*this._fov)*this.height*m}}function Os(d,i){let u=!1,m=null;const E=()=>{m=null,u&&(d(),m=setTimeout(E,i),u=!1)};return()=>(u=!0,m||E(),m)}class il{constructor(i){this._hashName=i&&encodeURIComponent(i),l.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Os(this._updateHashUnthrottled.bind(this),300)}addTo(i){return this._map=i,l.window.addEventListener("hashchange",this._onHashChange,!1),i.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),l.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const i=this._map;if(!i)return"";const u=rl(i);if(this._hashName){const m=this._hashName;let E=!1;const M=l.window.location.hash.slice(1).split("&").map(z=>{const Z=z.split("=")[0];return Z===m?(E=!0,`${Z}=${u}`):z}).filter(z=>z);return E||M.push(`${m}=${u}`),`#${M.join("&")}`}return`#${u}`}_getCurrentHash(){const i=l.window.location.hash.replace("#","");if(this._hashName){let u;return i.split("&").map(m=>m.split("=")).forEach(m=>{m[0]===this._hashName&&(u=m)}),(u&&u[1]||"").split("/")}return i.split("/")}_onHashChange(){const i=this._map;if(!i)return!1;const u=this._getCurrentHash();if(u.length>=3&&!u.some(m=>isNaN(m))){const m=i.dragRotate.isEnabled()&&i.touchZoomRotate.isEnabled()?+(u[3]||0):i.getBearing();return i.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:m,pitch:+(u[4]||0)}),!0}return!1}_updateHashUnthrottled(){const i=l.window.location.href.replace(/(#.+)?$/,this.getHashString());l.window.history.replaceState(l.window.history.state,null,i)}}function rl(d,i){const u=d.getCenter(),m=Math.round(100*d.getZoom())/100,E=Math.ceil((m*Math.LN2+Math.log(512/360/.5))/Math.LN10),M=Math.pow(10,E),z=Math.round(u.lng*M)/M,Z=Math.round(u.lat*M)/M,K=d.getBearing(),de=d.getPitch();let pe=i?`/${z}/${Z}/${m}`:`${m}/${Z}/${z}`;return(K||de)&&(pe+="/"+Math.round(10*K)/10),de&&(pe+=`/${Math.round(de)}`),pe}const Ta={linearity:.3,easing:l.bezier(0,0,.3,1)},c=l.extend({deceleration:2500,maxSpeed:1400},Ta),v=l.extend({deceleration:20,maxSpeed:1400},Ta),g=l.extend({deceleration:1e3,maxSpeed:360},Ta),x=l.extend({deceleration:1e3,maxSpeed:90},Ta);class C{constructor(i){this._map=i,this.clear()}clear(){this._inertiaBuffer=[]}record(i){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:l.exported.now(),settings:i})}_drainInertiaBuffer(){const i=this._inertiaBuffer,u=l.exported.now();for(;i.length>0&&u-i[0].time>160;)i.shift()}_onMoveEnd(i){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const u={zoom:0,bearing:0,pitch:0,pan:new l.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:M}of this._inertiaBuffer)u.zoom+=M.zoomDelta||0,u.bearing+=M.bearingDelta||0,u.pitch+=M.pitchDelta||0,M.panDelta&&u.pan._add(M.panDelta),M.around&&(u.around=M.around),M.pinchAround&&(u.pinchAround=M.pinchAround);const m=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,E={};if(u.pan.mag()){const M=Q(u.pan.mag(),m,l.extend({},c,i||{}));E.offset=u.pan.mult(M.amount/u.pan.mag()),E.center=this._map.transform.center,U(E,M)}if(u.zoom){const M=Q(u.zoom,m,v);E.zoom=this._map.transform.zoom+M.amount,U(E,M)}if(u.bearing){const M=Q(u.bearing,m,g);E.bearing=this._map.transform.bearing+l.clamp(M.amount,-179,179),U(E,M)}if(u.pitch){const M=Q(u.pitch,m,x);E.pitch=this._map.transform.pitch+M.amount,U(E,M)}if(E.zoom||E.bearing){const M=void 0===u.pinchAround?u.around:u.pinchAround;E.around=M?this._map.unproject(M):this._map.getCenter()}return this.clear(),E.noMoveStart=!0,E}}function U(d,i){(!d.duration||d.duration<i.duration)&&(d.duration=i.duration,d.easing=i.easing)}function Q(d,i,u){const{maxSpeed:m,linearity:E,deceleration:M}=u,z=l.clamp(d*E/(i/1e3),-m,m),Z=Math.abs(z)/(M*E);return{easing:u.easing,duration:1e3*Z,amount:z*(Z/2)}}class ye extends l.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,u,m,E={}){const M=kt(u.getCanvasContainer(),m),z=u.unproject(M);super(i,l.extend({point:M,lngLat:z,originalEvent:m},E)),this._defaultPrevented=!1,this.target=u}}class Pe extends l.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,u,m){const E="touchend"===i?m.changedTouches:m.touches,M=dn(u.getCanvasContainer(),E),z=M.map(K=>u.unproject(K)),Z=M.reduce((K,de,pe,De)=>K.add(de.div(De.length)),new l.pointGeometry(0,0));super(i,{points:M,point:Z,lngLats:z,lngLat:u.unproject(Z),originalEvent:m}),this._defaultPrevented=!1}}class Ze extends l.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,u,m){super(i,{originalEvent:m}),this._defaultPrevented=!1}}class zt{constructor(i,u){this._map=i,this._clickTolerance=u.clickTolerance}reset(){this._mousedownPos=void 0}wheel(i){return this._firePreventable(new Ze(i.type,this._map,i))}mousedown(i,u){return this._mousedownPos=u,this._firePreventable(new ye(i.type,this._map,i))}mouseup(i){this._map.fire(new ye(i.type,this._map,i))}preclick(i){const u=l.extend({},i);u.type="preclick",this._map.fire(new ye(u.type,this._map,u))}click(i,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||(this.preclick(i),this._map.fire(new ye(i.type,this._map,i)))}dblclick(i){return this._firePreventable(new ye(i.type,this._map,i))}mouseover(i){this._map.fire(new ye(i.type,this._map,i))}mouseout(i){this._map.fire(new ye(i.type,this._map,i))}touchstart(i){return this._firePreventable(new Pe(i.type,this._map,i))}touchmove(i){this._map.fire(new Pe(i.type,this._map,i))}touchend(i){this._map.fire(new Pe(i.type,this._map,i))}touchcancel(i){this._map.fire(new Pe(i.type,this._map,i))}_firePreventable(i){if(this._map.fire(i),i.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class qn{constructor(i){this._map=i}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(i){this._map.fire(new ye(i.type,this._map,i))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ye("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(i){this._delayContextMenu?this._contextMenuEvent=i:this._map.fire(new ye(i.type,this._map,i)),this._map.listens("contextmenu")&&i.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Pi{constructor(i,u){this._map=i,this._el=i.getCanvasContainer(),this._container=i.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(i,u){this.isEnabled()&&i.shiftKey&&0===i.button&&(st(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(i,u){if(!this._active)return;const m=u;if(this._lastPos.equals(m)||!this._box&&m.dist(this._startPos)<this._clickTolerance)return;const E=this._startPos;this._lastPos=m,this._box||(this._box=ct("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",i));const M=Math.min(E.x,m.x),z=Math.max(E.x,m.x),Z=Math.min(E.y,m.y),K=Math.max(E.y,m.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${M}px,${Z}px)`,this._box.style.width=z-M+"px",this._box.style.height=K-Z+"px")})}mouseupWindow(i,u){if(!this._active||0!==i.button)return;const m=this._startPos,E=u;if(this.reset(),tn(),m.x!==E.x||m.y!==E.y)return this._map.fire(new l.Event("boxzoomend",{originalEvent:i})),{cameraAnimation:M=>M.fitScreenCoordinates(m,E,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",i)}keydown(i){this._active&&27===i.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",i))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),at(),delete this._startPos,delete this._lastPos}_fireEvent(i,u){return this._map.fire(new l.Event(i,{originalEvent:u}))}}function Vi(d,i){const u={};for(let m=0;m<d.length;m++)u[d[m].identifier]=i[m];return u}class ro{constructor(i){this.reset(),this.numTouches=i.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(i,u,m){(this.centroid||m.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=i.timeStamp),m.length===this.numTouches&&(this.centroid=function(E){const M=new l.pointGeometry(0,0);for(const z of E)M._add(z);return M.div(E.length)}(u),this.touches=Vi(m,u)))}touchmove(i,u,m){if(this.aborted||!this.centroid)return;const E=Vi(m,u);for(const M in this.touches){const z=this.touches[M],Z=E[M];(!Z||Z.dist(z)>30)&&(this.aborted=!0)}}touchend(i,u,m){if((!this.centroid||i.timeStamp-this.startTime>500)&&(this.aborted=!0),0===m.length){const E=!this.aborted&&this.centroid;if(this.reset(),E)return E}}}class co{constructor(i){this.singleTap=new ro(i),this.numTaps=i.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(i,u,m){this.singleTap.touchstart(i,u,m)}touchmove(i,u,m){this.singleTap.touchmove(i,u,m)}touchend(i,u,m){const E=this.singleTap.touchend(i,u,m);if(E){const M=i.timeStamp-this.lastTime<500,z=!this.lastTap||this.lastTap.dist(E)<30;if(M&&z||this.reset(),this.count++,this.lastTime=i.timeStamp,this.lastTap=E,this.count===this.numTaps)return this.reset(),E}}}class Zs{constructor(){this._zoomIn=new co({numTouches:1,numTaps:2}),this._zoomOut=new co({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(i,u,m){this._zoomIn.touchstart(i,u,m),this._zoomOut.touchstart(i,u,m)}touchmove(i,u,m){this._zoomIn.touchmove(i,u,m),this._zoomOut.touchmove(i,u,m)}touchend(i,u,m){const E=this._zoomIn.touchend(i,u,m),M=this._zoomOut.touchend(i,u,m);return E?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:z=>z.easeTo({duration:300,zoom:z.getZoom()+1,around:z.unproject(E)},{originalEvent:i})}):M?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:z=>z.easeTo({duration:300,zoom:z.getZoom()-1,around:z.unproject(M)},{originalEvent:i})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Tl={0:1,2:2};class kl{constructor(i){this.reset(),this._clickTolerance=i.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(i,u){return!1}_move(i,u){return{}}mousedown(i,u){if(this._lastPoint)return;const m=Qn(i);this._correctButton(i,m)&&(this._lastPoint=u,this._eventButton=m)}mousemoveWindow(i,u){const m=this._lastPoint;if(m)if(i.preventDefault(),null!=this._eventButton&&function(E,M){const z=Tl[M];return void 0===E.buttons||(E.buttons&z)!==z}(i,this._eventButton))this.reset();else if(this._moved||!(u.dist(m)<this._clickTolerance))return this._moved=!0,this._lastPoint=u,this._move(m,u)}mouseupWindow(i){this._lastPoint&&Qn(i)===this._eventButton&&(this._moved&&tn(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class dl extends kl{mousedown(i,u){super.mousedown(i,u),this._lastPoint&&(this._active=!0)}_correctButton(i,u){return 0===u&&!i.ctrlKey}_move(i,u){return{around:u,panDelta:u.sub(i)}}}class El extends kl{_correctButton(i,u){return 0===u&&i.ctrlKey||2===u}_move(i,u){const m=.8*(u.x-i.x);if(m)return this._active=!0,{bearingDelta:m}}contextmenu(i){i.preventDefault()}}class Gs extends kl{_correctButton(i,u){return 0===u&&i.ctrlKey||2===u}_move(i,u){const m=-.5*(u.y-i.y);if(m)return this._active=!0,{pitchDelta:m}}contextmenu(i){i.preventDefault()}}class lu{constructor(i,u){this._map=i,this._el=i.getCanvasContainer(),this._minTouches=1,this._clickTolerance=u.clickTolerance||1,this.reset(),l.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new l.pointGeometry(0,0)}touchstart(i,u,m){return this._calculateTransform(i,u,m)}touchmove(i,u,m){if(this._active&&!(m.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===m.length&&!l.isFullscreen())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return i.cancelable&&i.preventDefault(),this._calculateTransform(i,u,m)}}touchend(i,u,m){this._calculateTransform(i,u,m),this._active&&m.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(i,u,m){m.length>0&&(this._active=!0);const E=Vi(m,u),M=new l.pointGeometry(0,0),z=new l.pointGeometry(0,0);let Z=0;for(const de in E){const pe=E[de],De=this._touches[de];De&&(M._add(pe),z._add(pe.sub(De)),Z++,E[de]=pe)}if(this._touches=E,Z<this._minTouches||!z.mag())return;const K=z.div(Z);return this._sum._add(K),this._sum.mag()<this._clickTolerance?void 0:{around:M.div(Z),panDelta:K}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=ct("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class Cl{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(i){}_move(i,u,m){return{}}touchstart(i,u,m){this._firstTwoTouches||m.length<2||(this._firstTwoTouches=[m[0].identifier,m[1].identifier],this._start([u[0],u[1]]))}touchmove(i,u,m){const E=this._firstTwoTouches;if(!E)return;i.preventDefault();const[M,z]=E,Z=Ls(m,u,M),K=Ls(m,u,z);if(!Z||!K)return;const de=this._aroundCenter?null:Z.add(K).div(2);return this._move([Z,K],de,i)}touchend(i,u,m){if(!this._firstTwoTouches)return;const[E,M]=this._firstTwoTouches,z=Ls(m,u,E),Z=Ls(m,u,M);z&&Z||(this._active&&tn(),this.reset())}touchcancel(){this.reset()}enable(i){this._enabled=!0,this._aroundCenter=!!i&&"center"===i.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Ls(d,i,u){for(let m=0;m<d.length;m++)if(d[m].identifier===u)return i[m]}function uc(d,i){return Math.log(d/i)/Math.LN2}class ol extends Cl{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(i){this._startDistance=this._distance=i[0].dist(i[1])}_move(i,u){const m=this._distance;if(this._distance=i[0].dist(i[1]),this._active||!(Math.abs(uc(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:uc(this._distance,m),pinchAround:u}}}function Ea(d,i){return 180*d.angleWith(i)/Math.PI}class sl extends Cl{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(i){this._startVector=this._vector=i[0].sub(i[1]),this._minDiameter=i[0].dist(i[1])}_move(i,u){const m=this._vector;if(this._vector=i[0].sub(i[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ea(this._vector,m),pinchAround:u}}_isBelowThreshold(i){this._minDiameter=Math.min(this._minDiameter,i.mag());const u=25/(Math.PI*this._minDiameter)*360,m=Ea(i,this._startVector);return Math.abs(m)<u}}function Fs(d){return Math.abs(d.y)>Math.abs(d.x)}class Nl extends Cl{constructor(i){super(),this._map=i}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(i){this._lastPoints=i,Fs(i[0].sub(i[1]))&&(this._valid=!1)}_move(i,u,m){const E=this._lastPoints;if(!E)return;const M=i[0].sub(E[0]),z=i[1].sub(E[1]);return this._map._cooperativeGestures&&m.touches.length<3||(this._valid=this.gestureBeginsVertically(M,z,m.timeStamp),!this._valid)?void 0:(this._lastPoints=i,this._active=!0,{pitchDelta:(M.y+z.y)/2*-.5})}gestureBeginsVertically(i,u,m){if(void 0!==this._valid)return this._valid;const E=i.mag()>=2,M=u.mag()>=2;if(!E&&!M)return;if(!E||!M)return null==this._firstMove&&(this._firstMove=m),m-this._firstMove<100&&void 0;const z=i.y>0==u.y>0;return Fs(i)&&Fs(u)&&z}}const Oi={panStep:100,bearingStep:15,pitchStep:10};class yc{constructor(){const i=Oi;this._panStep=i.panStep,this._bearingStep=i.bearingStep,this._pitchStep=i.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(i){if(i.altKey||i.ctrlKey||i.metaKey)return;let u=0,m=0,E=0,M=0,z=0;switch(i.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:i.shiftKey?m=-1:(i.preventDefault(),M=-1);break;case 39:i.shiftKey?m=1:(i.preventDefault(),M=1);break;case 38:i.shiftKey?E=1:(i.preventDefault(),z=-1);break;case 40:i.shiftKey?E=-1:(i.preventDefault(),z=1);break;default:return}return this._rotationDisabled&&(m=0,E=0),{cameraAnimation:Z=>{const K=Z.getZoom();Z.easeTo({duration:300,easeId:"keyboardHandler",easing:gh,zoom:u?Math.round(K)+u*(i.shiftKey?2:1):K,bearing:Z.getBearing()+m*this._bearingStep,pitch:Z.getPitch()+E*this._pitchStep,offset:[-M*this._panStep,-z*this._panStep],center:Z.getCenter()},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function gh(d){return d*(2-d)}const Ic=4.000244140625;class Rs{constructor(i,u){this._map=i,this._el=i.getCanvasContainer(),this._handler=u,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,l.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(i){this._defaultZoomRate=i}setWheelZoomRate(i){this._wheelZoomRate=i}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(i){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!i&&"center"===i.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(i){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(i.ctrlKey||i.metaKey||this.isZooming()||l.isFullscreen()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let u=i.deltaMode===l.window.WheelEvent.DOM_DELTA_LINE?40*i.deltaY:i.deltaY;const m=l.exported.now(),E=m-(this._lastWheelEventTime||0);this._lastWheelEventTime=m,0!==u&&u%Ic==0?this._type="wheel":0!==u&&Math.abs(u)<4?this._type="trackpad":E>400?(this._type=null,this._lastValue=u,this._timeout=setTimeout(this._onTimeout,40,i)):this._type||(this._type=Math.abs(E*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),i.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=i,this._delta-=u,this._active||this._start(i)),i.preventDefault()}_onTimeout(i){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(i)}_start(i){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=kt(this._el,i);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:u,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const i=this._map.transform,u=()=>i._terrainEnabled()&&this._aroundCoord?i.computeZoomRelativeTo(this._aroundCoord):i.zoom;if(0!==this._delta){const K="wheel"===this._type&&Math.abs(this._delta)>Ic?this._wheelZoomRate:this._defaultZoomRate;let de=2/(1+Math.exp(-Math.abs(this._delta*K)));this._delta<0&&0!==de&&(de=1/de);const pe=u(),De=Math.pow(2,pe),Fe="number"==typeof this._targetZoom?i.zoomScale(this._targetZoom):De;this._targetZoom=Math.min(i.maxZoom,Math.max(i.minZoom,i.scaleZoom(Fe*de))),"wheel"===this._type&&(this._startZoom=pe,this._easing=this._smoothOutEasing(200)),this._delta=0}const m="number"==typeof this._targetZoom?this._targetZoom:u(),E=this._startZoom,M=this._easing;let z,Z=!1;if("wheel"===this._type&&E&&M){const K=Math.min((l.exported.now()-this._lastWheelEventTime)/200,1),de=M(K);z=l.number(E,m,de),K<1?this._frameId||(this._frameId=!0):Z=!0}else z=m,Z=!0;return this._active=!0,Z&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!Z,zoomDelta:z-u(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(i){let u=l.ease;if(this._prevEase){const m=this._prevEase,E=(l.exported.now()-m.start)/m.duration,M=m.easing(E+.01)-m.easing(E),z=.27/Math.sqrt(M*M+1e-4)*.01,Z=Math.sqrt(.0729-z*z);u=l.bezier(z,Z,.25,1)}return this._prevEase={start:l.exported.now(),duration:i,easing:u},u}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=ct("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(l.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Yu{constructor(i,u){this._clickZoom=i,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class hc{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(i,u){return i.preventDefault(),{cameraAnimation:m=>{m.easeTo({duration:300,zoom:m.getZoom()+(i.shiftKey?-1:1),around:m.unproject(u)},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class _h{constructor(){this._tap=new co({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(i,u,m){this._swipePoint||(this._tapTime&&i.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?m.length>0&&(this._swipePoint=u[0],this._swipeTouch=m[0].identifier):this._tap.touchstart(i,u,m))}touchmove(i,u,m){if(this._tapTime){if(this._swipePoint){if(m[0].identifier!==this._swipeTouch)return;const E=u[0],M=E.y-this._swipePoint.y;return this._swipePoint=E,i.preventDefault(),this._active=!0,{zoomDelta:M/128}}}else this._tap.touchmove(i,u,m)}touchend(i,u,m){this._tapTime?this._swipePoint&&0===m.length&&this.reset():this._tap.touchend(i,u,m)&&(this._tapTime=i.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Du{constructor(i,u,m){this._el=i,this._mousePan=u,this._touchPan=m}enable(i){this._inertiaOptions=i||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Jh{constructor(i,u,m){this._pitchWithRotate=i.pitchWithRotate,this._mouseRotate=u,this._mousePitch=m}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Qh{constructor(i,u,m,E){this._el=i,this._touchZoom=u,this._touchRotate=m,this._tapDragZoom=E,this._rotationDisabled=!1,this._enabled=!0}enable(i){this._touchZoom.enable(i),this._rotationDisabled||this._touchRotate.enable(i),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const cu=d=>d.zoom||d.drag||d.pitch||d.rotate;class Ga extends l.Event{}class vc{constructor(){this.constants=[1,1,.01],this.radius=0}setup(i,u){const m=l.sub([],u,i);this.radius=l.length(m[2]<0?l.div([],m,this.constants):[m[0],m[1],0])}projectRay(i){l.div(i,i,this.constants),l.normalize(i,i),l.mul$1(i,i,this.constants);const u=l.scale$2([],i,this.radius);if(u[2]>0){const m=l.scale$2([],[0,0,1],l.dot(u,[0,0,1])),E=l.scale$2([],l.normalize([],[u[0],u[1],0]),this.radius),M=l.add([],u,l.scale$2([],l.sub([],l.add([],E,m),u),2));u[0]=M[0],u[1]=M[1]}return u}}function Hs(d){return d.panDelta&&d.panDelta.mag()||d.zoomDelta||d.bearingDelta||d.pitchDelta}class Ys{constructor(i,u){this._map=i,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new C(i),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new vc,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(u),l.bindAll(["handleEvent","handleWindowEvent"],this);const m=this._el;this._listeners=[[m,"touchstart",{passive:!0}],[m,"touchmove",{passive:!1}],[m,"touchend",void 0],[m,"touchcancel",void 0],[m,"mousedown",void 0],[m,"mousemove",void 0],[m,"mouseup",void 0],[l.window.document,"mousemove",{capture:!0}],[l.window.document,"mouseup",void 0],[m,"mouseover",void 0],[m,"mouseout",void 0],[m,"dblclick",void 0],[m,"click",void 0],[m,"keydown",{capture:!1}],[m,"keyup",void 0],[m,"wheel",{passive:!1}],[m,"contextmenu",void 0],[l.window,"blur",void 0]];for(const[E,M,z]of this._listeners)E.addEventListener(M,E===l.window.document?this.handleWindowEvent:this.handleEvent,z)}destroy(){for(const[i,u,m]of this._listeners)i.removeEventListener(u,i===l.window.document?this.handleWindowEvent:this.handleEvent,m)}_addDefaultHandlers(i){const u=this._map,m=u.getCanvasContainer();this._add("mapEvent",new zt(u,i));const E=u.boxZoom=new Pi(u,i);this._add("boxZoom",E);const M=new Zs,z=new hc;u.doubleClickZoom=new Yu(z,M),this._add("tapZoom",M),this._add("clickZoom",z);const Z=new _h;this._add("tapDragZoom",Z);const K=u.touchPitch=new Nl(u);this._add("touchPitch",K);const de=new El(i),pe=new Gs(i);u.dragRotate=new Jh(i,de,pe),this._add("mouseRotate",de,["mousePitch"]),this._add("mousePitch",pe,["mouseRotate"]);const De=new dl(i),Fe=new lu(u,i);u.dragPan=new Du(m,De,Fe),this._add("mousePan",De),this._add("touchPan",Fe,["touchZoom","touchRotate"]);const Je=new sl,Ge=new ol;u.touchZoomRotate=new Qh(m,Ge,Je,Z),this._add("touchRotate",Je,["touchPan","touchZoom"]),this._add("touchZoom",Ge,["touchPan","touchRotate"]),this._add("blockableMapEvent",new qn(u));const He=u.scrollZoom=new Rs(u,this);this._add("scrollZoom",He,["mousePan"]);const $e=u.keyboard=new yc;this._add("keyboard",$e);for(const ze of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])i.interactive&&i[ze]&&u[ze].enable(i[ze])}_add(i,u,m){this._handlers.push({handlerName:i,handler:u,allowed:m}),this._handlersById[i]=u}stop(i){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},i),this._changes=[]}}isActive(){for(const{handler:i}of this._handlers)if(i.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!cu(this._eventsInProgress)||this.isZooming()}_blockedByActive(i,u,m){for(const E in i)if(E!==m&&(!u||u.indexOf(E)<0))return!0;return!1}handleWindowEvent(i){this.handleEvent(i,`${i.type}Window`)}_getMapTouches(i){const u=[];for(const m of i)this._el.contains(m.target)&&u.push(m);return u}handleEvent(i,u){this._updatingCamera=!0;const m="renderFrame"===i.type,E=m?void 0:i,M={needsRenderFrame:!1},z={},Z={},K=i.touches?this._getMapTouches(i.touches):void 0,de=K?dn(this._el,K):m?void 0:kt(this._el,i);for(const{handlerName:Fe,handler:Je,allowed:Ge}of this._handlers){if(!Je.isEnabled())continue;let He;this._blockedByActive(Z,Ge,Fe)?Je.reset():Je[u||i.type]&&(He=Je[u||i.type](i,de,K),this.mergeHandlerResult(M,z,He,Fe,E),He&&He.needsRenderFrame&&this._triggerRenderFrame()),(He||Je.isActive())&&(Z[Fe]=Je)}const pe={};for(const Fe in this._previousActiveHandlers)Z[Fe]||(pe[Fe]=E);this._previousActiveHandlers=Z,(Object.keys(pe).length||Hs(M))&&(this._changes.push([M,z,pe]),this._triggerRenderFrame()),(Object.keys(Z).length||Hs(M))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:De}=M;De&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],De(this._map))}mergeHandlerResult(i,u,m,E,M){if(!m)return;l.extend(i,m);const z={handlerName:E,originalEvent:m.originalEvent||M};void 0!==m.zoomDelta&&(u.zoom=z),void 0!==m.panDelta&&(u.drag=z),void 0!==m.pitchDelta&&(u.pitch=z),void 0!==m.bearingDelta&&(u.rotate=z)}_applyChanges(){const i={},u={},m={};for(const[E,M,z]of this._changes)E.panDelta&&(i.panDelta=(i.panDelta||new l.pointGeometry(0,0))._add(E.panDelta)),E.zoomDelta&&(i.zoomDelta=(i.zoomDelta||0)+E.zoomDelta),E.bearingDelta&&(i.bearingDelta=(i.bearingDelta||0)+E.bearingDelta),E.pitchDelta&&(i.pitchDelta=(i.pitchDelta||0)+E.pitchDelta),void 0!==E.around&&(i.around=E.around),void 0!==E.aroundCoord&&(i.aroundCoord=E.aroundCoord),void 0!==E.pinchAround&&(i.pinchAround=E.pinchAround),E.noInertia&&(i.noInertia=E.noInertia),l.extend(u,M),l.extend(m,z);this._updateMapTransform(i,u,m),this._changes=[]}_updateMapTransform(i,u,m){const E=this._map,M=E.transform,z=tt=>[tt.x,tt.y,tt.z];if((tt=>{const et=this._eventsInProgress.drag;return et&&!this._handlersById[et.handlerName].isActive()})()&&!Hs(i)){const tt=M.zoom;M.cameraElevationReference="sea",M.recenterOnTerrain(),M.cameraElevationReference="ground",tt!==M.zoom&&this._map._update(!0)}if(!Hs(i))return void this._fireEvents(u,m,!0);let{panDelta:Z,zoomDelta:K,bearingDelta:de,pitchDelta:pe,around:De,aroundCoord:Fe,pinchAround:Je}=i;void 0!==Je&&(De=Je),(tt=>u.drag&&!this._eventsInProgress.drag)()&&De&&(this._dragOrigin=z(M.pointCoordinate3D(De)),this._trackingEllipsoid.setup(M._camera.position,this._dragOrigin)),M.cameraElevationReference="sea",E._stop(!0),De=De||E.transform.centerPoint,de&&(M.bearing+=de),pe&&(M.pitch+=pe),M._updateCameraState();const Ge=[0,0,0];if(Z)if("mercator"===M.projection.name){const tt=this._trackingEllipsoid.projectRay(M.screenPointToMercatorRay(De).dir),et=this._trackingEllipsoid.projectRay(M.screenPointToMercatorRay(De.sub(Z)).dir);Ge[0]=et[0]-tt[0],Ge[1]=et[1]-tt[1]}else{const tt=M.pointCoordinate(De);if("globe"===M.projection.name){Z=Z.rotate(-M.angle);const et=M._pixelsPerMercatorPixel/M.worldSize;Ge[0]=-Z.x*l.mercatorScale(l.latFromMercatorY(tt.y))*et,Ge[1]=-Z.y*l.mercatorScale(M.center.lat)*et}else{const et=M.pointCoordinate(De.sub(Z));tt&&et&&(Ge[0]=et.x-tt.x,Ge[1]=et.y-tt.y)}}const He=M.zoom,$e=[0,0,0];if(K){const tt=z(Fe||M.pointCoordinate3D(De)),et={dir:l.normalize([],l.sub([],tt,M._camera.position))};if(et.dir[2]<0){const Mt=M.zoomDeltaToMovement(tt,K);l.scale$2($e,et.dir,Mt)}}const ze=l.add(Ge,Ge,$e);M._translateCameraConstrained(ze),K&&Math.abs(M.zoom-He)>1e-4&&M.recenterOnTerrain(),M.cameraElevationReference="ground",this._map._update(),i.noInertia||this._inertia.record(i),this._fireEvents(u,m,!0)}_fireEvents(i,u,m){const E=cu(this._eventsInProgress),M=cu(i),z={};for(const pe in i){const{originalEvent:De}=i[pe];this._eventsInProgress[pe]||(z[`${pe}start`]=De),this._eventsInProgress[pe]=i[pe]}!E&&M&&this._fireEvent("movestart",M.originalEvent);for(const pe in z)this._fireEvent(pe,z[pe]);M&&this._fireEvent("move",M.originalEvent);for(const pe in i){const{originalEvent:De}=i[pe];this._fireEvent(pe,De)}const Z={};let K;for(const pe in this._eventsInProgress){const{handlerName:De,originalEvent:Fe}=this._eventsInProgress[pe];this._handlersById[De].isActive()||(delete this._eventsInProgress[pe],K=u[De]||Fe,Z[`${pe}end`]=K)}for(const pe in Z)this._fireEvent(pe,Z[pe]);const de=cu(this._eventsInProgress);if(m&&(E||M)&&!de){this._updatingCamera=!0;const pe=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),De=Fe=>0!==Fe&&-this._bearingSnap<Fe&&Fe<this._bearingSnap;pe?(De(pe.bearing||this._map.getBearing())&&(pe.bearing=0),this._map.easeTo(pe,{originalEvent:K})):(this._map.fire(new l.Event("moveend",{originalEvent:K})),De(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(i,u){this._map.fire(new l.Event(i,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(i=>{this._frameId=void 0,this.handleEvent(new Ga("renderFrame",{timeStamp:i})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const ec="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Ku extends l.Evented{constructor(i,u){super(),this._moving=!1,this._zooming=!1,this.transform=i,this._bearingSnap=u.bearingSnap,l.bindAll(["_renderFrameCallback"],this)}getCenter(){return new l.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(i,u){return this.jumpTo({center:i},u)}panBy(i,u,m){return i=l.pointGeometry.convert(i).mult(-1),this.panTo(this.transform.center,l.extend({offset:i},u),m)}panTo(i,u,m){return this.easeTo(l.extend({center:i},u),m)}getZoom(){return this.transform.zoom}setZoom(i,u){return this.jumpTo({zoom:i},u),this}zoomTo(i,u,m){return this.easeTo(l.extend({zoom:i},u),m)}zoomIn(i,u){return this.zoomTo(this.getZoom()+1,i,u),this}zoomOut(i,u){return this.zoomTo(this.getZoom()-1,i,u),this}getBearing(){return this.transform.bearing}setBearing(i,u){return this.jumpTo({bearing:i},u),this}getPadding(){return this.transform.padding}setPadding(i,u){return this.jumpTo({padding:i},u),this}rotateTo(i,u,m){return this.easeTo(l.extend({bearing:i},u),m)}resetNorth(i,u){return this.rotateTo(0,l.extend({duration:1e3},i),u),this}resetNorthPitch(i,u){return this.easeTo(l.extend({bearing:0,pitch:0,duration:1e3},i),u),this}snapToNorth(i,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(i,u):this}getPitch(){return this.transform.pitch}setPitch(i,u){return this.jumpTo({pitch:i},u),this}cameraForBounds(i,u){"globe"===this.transform.projection.name&&l.warnOnce('Globe projection does not support cameraForBounds API, this API may behave unexpectedly."'),i=l.LngLatBounds.convert(i);const m=u&&u.bearing||0;return this._cameraForBoxAndBearing(i.getNorthWest(),i.getSouthEast(),m,u)}_extendCameraOptions(i){const u={top:0,bottom:0,right:0,left:0};if("number"==typeof(i=l.extend({padding:u,offset:[0,0],maxZoom:this.transform.maxZoom},i)).padding){const m=i.padding;i.padding={top:m,bottom:m,right:m,left:m}}return i.padding=l.extend(u,i.padding),i}_cameraForBoxAndBearing(i,u,m,E){const M=this._extendCameraOptions(E),z=this.transform,Z=z.padding,K=z.project(l.LngLat.convert(i)),de=z.project(l.LngLat.convert(u)),pe=new l.pointGeometry(K.x,de.y),De=new l.pointGeometry(de.x,K.y),Fe=-l.degToRad(m),Je=K.rotate(Fe),Ge=de.rotate(Fe),He=pe.rotate(Fe),$e=De.rotate(Fe),ze=new l.pointGeometry(Math.max(Je.x,Ge.x,He.x,$e.x),Math.max(Je.y,Ge.y,He.y,$e.y)),tt=new l.pointGeometry(Math.min(Je.x,Ge.x,He.x,$e.x),Math.min(Je.y,Ge.y,He.y,$e.y)),et=ze.sub(tt),Mt=(z.width-((Z.left||0)+(Z.right||0)+M.padding.left+M.padding.right))/et.x,Et=(z.height-((Z.top||0)+(Z.bottom||0)+M.padding.top+M.padding.bottom))/et.y;if(Et<0||Mt<0)return void l.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const yt=Math.min(z.scaleZoom(z.scale*Math.min(Mt,Et)),M.maxZoom),It="number"==typeof M.offset.x&&"number"==typeof M.offset.y?new l.pointGeometry(M.offset.x,M.offset.y):l.pointGeometry.convert(M.offset),Ct=new l.pointGeometry((M.padding.left-M.padding.right)/2,(M.padding.top-M.padding.bottom)/2).rotate(m*Math.PI/180),Vt=It.add(Ct).mult(z.scale/z.zoomScale(yt));return{center:z.unproject(K.add(de).div(2).sub(Vt)),zoom:yt,bearing:m}}_cameraForBox(i,u,m,E,M){const z=this._extendCameraOptions(M);m=m||0,E=E||0,i=l.LngLat.convert(i),u=l.LngLat.convert(u);const Z=this.transform.clone();Z.padding=z.padding;const K=this.getFreeCameraOptions(),de=new l.LngLat(.5*(i.lng+u.lng),.5*(i.lat+u.lat)),pe=.5*(m+E);if(Z._camera.position[2]<l.mercatorZfromAltitude(pe,de.lat))return void l.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");K.lookAtPoint(de),Z.setFreeCameraOptions(K);const De=l.MercatorCoordinate.fromLngLat(i),Fe=l.MercatorCoordinate.fromLngLat(u),Je=Z.pointRayIntersection(Z.centerPoint,pe),Ge=[(He=Z.rayIntersectionCoordinate(Je)).x,He.y,He.z];var He;const $e=Z.screenPointToMercatorRay(Z.centerPoint),ze="globe"!==Z.projection.name;let tt,et=0;do{const Mt=Math.floor(Z.zoom),Et=1<<Mt,yt=Math.min(Et*De.x,Et*Fe.x),It=Math.min(Et*De.y,Et*Fe.y),Ct=Math.max(Et*De.x,Et*Fe.x),Vt=Math.max(Et*De.y,Et*Fe.y),sn=new l.Aabb([yt,It,m],[Ct,Vt,E]),ni=l.Frustum.fromInvProjectionMatrix(Z.invProjMatrix,Z.worldSize,Mt,ze);if(2!==sn.intersects(ni)){tt&&(Z._camera.position=l.scaleAndAdd([],Z._camera.position,$e.dir,-tt),Z._updateStateFromCamera());break}const Xt=l.sub([],Z._camera.position,Ge);tt=.5*l.length(Xt),Z._camera.position=l.scaleAndAdd([],Z._camera.position,$e.dir,tt);try{Z._updateStateFromCamera()}catch(Ln){return void l.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}}while(++et<10);return{center:Z.center,zoom:Z.zoom,bearing:Z.bearing,pitch:Z.pitch}}fitBounds(i,u,m){return"globe"===this.transform.projection.name&&l.warnOnce("Globe projection does not support fitBounds API, this API may behave unexpectedly."),this._fitInternal(this.cameraForBounds(i,u),u,m)}_raycastElevationBox(i,u){const m=this.transform.elevation;if(!m)return;const E=new l.pointGeometry(i.x,u.y),M=new l.pointGeometry(u.x,i.y),z=m.pointCoordinate(i);if(!z)return;const Z=m.pointCoordinate(u);if(!Z)return;const K=m.pointCoordinate(E);if(!K)return;const de=m.pointCoordinate(M);if(!de)return;const pe=new l.MercatorCoordinate(z[0],z[1]).toLngLat(),De=new l.MercatorCoordinate(Z[0],Z[1]).toLngLat(),Fe=new l.MercatorCoordinate(K[0],K[1]).toLngLat(),Je=new l.MercatorCoordinate(de[0],de[1]).toLngLat(),Ge=Math.min(pe.lng,Math.min(De.lng,Math.min(Fe.lng,Je.lng))),He=Math.min(pe.lat,Math.min(De.lat,Math.min(Fe.lat,Je.lat))),$e=Math.max(pe.lng,Math.max(De.lng,Math.max(Fe.lng,Je.lng))),ze=Math.max(pe.lat,Math.max(De.lat,Math.max(Fe.lat,Je.lat))),tt=Math.min(z[3],Math.min(Z[3],Math.min(K[3],de[3]))),et=Math.max(z[3],Math.max(Z[3],Math.max(K[3],de[3])));return{minLngLat:new l.LngLat(Ge,He),maxLngLat:new l.LngLat($e,ze),minAltitude:tt,maxAltitude:et}}fitScreenCoordinates(i,u,m,E,M){let z,Z,K,de;"globe"===this.transform.projection.name&&l.warnOnce("Globe projection does not support fitScreenCoordinates API, this API may behave unexpectedly.");const pe=l.pointGeometry.convert(i),De=l.pointGeometry.convert(u),Fe=this._raycastElevationBox(pe,De);if(Fe)z=Fe.minLngLat,Z=Fe.maxLngLat,K=Fe.minAltitude,de=Fe.maxAltitude;else{if(this.transform.anyCornerOffEdge(pe,De))return this;z=this.transform.pointLocation(pe),Z=this.transform.pointLocation(De)}return this._fitInternal(0===this.transform.pitch?this._cameraForBoxAndBearing(this.transform.pointLocation(l.pointGeometry.convert(i)),this.transform.pointLocation(l.pointGeometry.convert(u)),m,E):this._cameraForBox(z,Z,K,de,E),E,M)}_fitInternal(i,u,m){return i?(delete(u=l.extend(i,u)).padding,u.linear?this.easeTo(u,m):this.flyTo(u,m)):this}jumpTo(i,u){this.stop();const m=i.preloadOnly?this.transform.clone():this.transform;let E=!1,M=!1,z=!1;return"zoom"in i&&m.zoom!==+i.zoom&&(E=!0,m.zoom=+i.zoom),void 0!==i.center&&(m.center=l.LngLat.convert(i.center)),"bearing"in i&&m.bearing!==+i.bearing&&(M=!0,m.bearing=+i.bearing),"pitch"in i&&m.pitch!==+i.pitch&&(z=!0,m.pitch=+i.pitch),null==i.padding||m.isPaddingEqual(i.padding)||(m.padding=i.padding),i.preloadOnly?(this._preloadTiles(m),this):(this.fire(new l.Event("movestart",u)).fire(new l.Event("move",u)),E&&this.fire(new l.Event("zoomstart",u)).fire(new l.Event("zoom",u)).fire(new l.Event("zoomend",u)),M&&this.fire(new l.Event("rotatestart",u)).fire(new l.Event("rotate",u)).fire(new l.Event("rotateend",u)),z&&this.fire(new l.Event("pitchstart",u)).fire(new l.Event("pitch",u)).fire(new l.Event("pitchend",u)),this.fire(new l.Event("moveend",u)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||l.warnOnce(ec),this.transform.getFreeCameraOptions()}setFreeCameraOptions(i,u){const m=this.transform;if(!m.projection.supportsFreeCamera)return l.warnOnce(ec),this;this.stop();const E=m.zoom,M=m.pitch,z=m.bearing;m.setFreeCameraOptions(i);const Z=E!==m.zoom,K=M!==m.pitch,de=z!==m.bearing;return this.fire(new l.Event("movestart",u)).fire(new l.Event("move",u)),Z&&this.fire(new l.Event("zoomstart",u)).fire(new l.Event("zoom",u)).fire(new l.Event("zoomend",u)),de&&this.fire(new l.Event("rotatestart",u)).fire(new l.Event("rotate",u)).fire(new l.Event("rotateend",u)),K&&this.fire(new l.Event("pitchstart",u)).fire(new l.Event("pitch",u)).fire(new l.Event("pitchend",u)),this.fire(new l.Event("moveend",u)),this}easeTo(i,u){this._stop(!1,i.easeId),(!1===(i=l.extend({offset:[0,0],duration:500,easing:l.ease},i)).animate||!i.essential&&l.exported.prefersReducedMotion)&&(i.duration=0);const m=this.transform,E=this.getZoom(),M=this.getBearing(),z=this.getPitch(),Z=this.getPadding(),K="zoom"in i?+i.zoom:E,de="bearing"in i?this._normalizeBearing(i.bearing,M):M,pe="pitch"in i?+i.pitch:z,De="padding"in i?i.padding:m.padding,Fe=l.pointGeometry.convert(i.offset);let Je,Ge,He;if("globe"===m.projection.name){const Vt=l.MercatorCoordinate.fromLngLat(m.center),sn=Fe.rotate(-m.angle);Vt.x+=sn.x/m.worldSize,Vt.y+=sn.y/m.worldSize;const ni=Vt.toLngLat(),Xt=l.LngLat.convert(i.center||ni);this._normalizeCenter(Xt),Je=m.centerPoint.add(sn),Ge=new l.pointGeometry(Vt.x,Vt.y).mult(m.worldSize),He=new l.pointGeometry(l.mercatorXfromLng(Xt.lng),l.mercatorYfromLat(Xt.lat)).mult(m.worldSize).sub(Ge)}else{Je=m.centerPoint.add(Fe);const Vt=m.pointLocation(Je),sn=l.LngLat.convert(i.center||Vt);this._normalizeCenter(sn),Ge=m.project(Vt),He=m.project(sn).sub(Ge)}const $e=m.zoomScale(K-E);let ze,tt;i.around&&(ze=l.LngLat.convert(i.around),tt=m.locationPoint(ze));const et=this._zooming||K!==E,Mt=this._rotating||M!==de,Et=this._pitching||pe!==z,yt=!m.isPaddingEqual(De),It=Vt=>sn=>{if(et&&(Vt.zoom=l.number(E,K,sn)),Mt&&(Vt.bearing=l.number(M,de,sn)),Et&&(Vt.pitch=l.number(z,pe,sn)),yt&&(Vt.interpolatePadding(Z,De,sn),Je=Vt.centerPoint.add(Fe)),ze)Vt.setLocationAtPoint(ze,tt);else{const ni=Vt.zoomScale(Vt.zoom-E),Xt=K>E?Math.min(2,$e):Math.max(.5,$e),Ln=Math.pow(Xt,1-sn),zn=Vt.unproject(Ge.add(He.mult(sn*Ln)).mult(ni));Vt.setLocationAtPoint(Vt.renderWorldCopies?zn.wrap():zn,Je)}return i.preloadOnly||this._fireMoveEvents(u),Vt};if(i.preloadOnly){const Vt=this._emulate(It,i.duration,m);return this._preloadTiles(Vt),this}const Ct={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=et,this._rotating=Mt,this._pitching=Et,this._padding=yt,this._easeId=i.easeId,this._prepareEase(u,i.noMoveStart,Ct),this._ease(It(m),Vt=>{m.recenterOnTerrain(),this._afterEase(u,Vt)},i),this}_prepareEase(i,u,m={}){this._moving=!0,this.transform.cameraElevationReference="sea",u||m.moving||this.fire(new l.Event("movestart",i)),this._zooming&&!m.zooming&&this.fire(new l.Event("zoomstart",i)),this._rotating&&!m.rotating&&this.fire(new l.Event("rotatestart",i)),this._pitching&&!m.pitching&&this.fire(new l.Event("pitchstart",i))}_fireMoveEvents(i){this.fire(new l.Event("move",i)),this._zooming&&this.fire(new l.Event("zoom",i)),this._rotating&&this.fire(new l.Event("rotate",i)),this._pitching&&this.fire(new l.Event("pitch",i))}_afterEase(i,u){if(this._easeId&&u&&this._easeId===u)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const m=this._zooming,E=this._rotating,M=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,m&&this.fire(new l.Event("zoomend",i)),E&&this.fire(new l.Event("rotateend",i)),M&&this.fire(new l.Event("pitchend",i)),this.fire(new l.Event("moveend",i))}flyTo(i,u){if(!i.essential&&l.exported.prefersReducedMotion){const Ai=l.pick(i,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Ai,u)}this.stop(),i=l.extend({offset:[0,0],speed:1.2,curve:1.42,easing:l.ease},i);const m=this.transform,E=this.getZoom(),M=this.getBearing(),z=this.getPitch(),Z=this.getPadding(),K="zoom"in i?l.clamp(+i.zoom,m.minZoom,m.maxZoom):E,de="bearing"in i?this._normalizeBearing(i.bearing,M):M,pe="pitch"in i?+i.pitch:z,De="padding"in i?i.padding:m.padding,Fe=m.zoomScale(K-E),Je=l.pointGeometry.convert(i.offset);let Ge=m.centerPoint.add(Je);const He=m.pointLocation(Ge),$e=l.LngLat.convert(i.center||He);this._normalizeCenter($e);const ze=m.project(He),tt=m.project($e).sub(ze);let et=i.curve;const Mt=Math.max(m.width,m.height),Et=Mt/Fe,yt=tt.mag();if("minZoom"in i){const Ai=l.clamp(Math.min(i.minZoom,E,K),m.minZoom,m.maxZoom),gi=Mt/m.zoomScale(Ai-E);et=Math.sqrt(gi/yt*2)}const It=et*et;function Ct(Ai){const gi=(Et*Et-Mt*Mt+(Ai?-1:1)*It*It*yt*yt)/(2*(Ai?Et:Mt)*It*yt);return Math.log(Math.sqrt(gi*gi+1)-gi)}function Vt(Ai){return(Math.exp(Ai)-Math.exp(-Ai))/2}function sn(Ai){return(Math.exp(Ai)+Math.exp(-Ai))/2}const ni=Ct(0);let Xt=function(Ai){return sn(ni)/sn(ni+et*Ai)},Ln=function(Ai){return Mt*((sn(ni)*(Vt(gi=ni+et*Ai)/sn(gi))-Vt(ni))/It)/yt;var gi},zn=(Ct(1)-ni)/et;if(Math.abs(yt)<1e-6||!isFinite(zn)){if(Math.abs(Mt-Et)<1e-6)return this.easeTo(i,u);const Ai=Et<Mt?-1:1;zn=Math.abs(Math.log(Et/Mt))/et,Ln=function(){return 0},Xt=function(gi){return Math.exp(Ai*et*gi)}}i.duration="duration"in i?+i.duration:1e3*zn/("screenSpeed"in i?+i.screenSpeed/et:+i.speed),i.maxDuration&&i.duration>i.maxDuration&&(i.duration=0);const di=M!==de,_n=pe!==z,li=!m.isPaddingEqual(De),Un=Ai=>gi=>{const $i=gi*zn,vr=1/Xt($i);Ai.zoom=1===gi?K:E+Ai.scaleZoom(vr),di&&(Ai.bearing=l.number(M,de,gi)),_n&&(Ai.pitch=l.number(z,pe,gi)),li&&(Ai.interpolatePadding(Z,De,gi),Ge=Ai.centerPoint.add(Je));const jr=1===gi?$e:Ai.unproject(ze.add(tt.mult(Ln($i))).mult(vr));return Ai.setLocationAtPoint(Ai.renderWorldCopies?jr.wrap():jr,Ge),Ai._updateCameraOnTerrain(),i.preloadOnly||this._fireMoveEvents(u),Ai};if(i.preloadOnly){const Ai=this._emulate(Un,i.duration,m);return this._preloadTiles(Ai),this}return this._zooming=!0,this._rotating=di,this._pitching=_n,this._padding=li,this._prepareEase(u,!1),this._ease(Un(m),()=>this._afterEase(u),i),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(i,u){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const m=this._onEaseEnd;this._onEaseEnd=void 0,m.call(this,u)}if(!i){const m=this.handlers;m&&m.stop(!1)}return this}_ease(i,u,m){!1===m.animate||0===m.duration?(i(1),u()):(this._easeStart=l.exported.now(),this._easeOptions=m,this._onEaseFrame=i,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const i=Math.min((l.exported.now()-this._easeStart)/this._easeOptions.duration,1),u=this._onEaseFrame;u&&u(this._easeOptions.easing(i)),i<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(i,u){i=l.wrap(i,-180,180);const m=Math.abs(i-u);return Math.abs(i-360-u)<m&&(i-=360),Math.abs(i+360-u)<m&&(i+=360),i}_normalizeCenter(i){const u=this.transform;if(!u.renderWorldCopies||u.maxBounds)return;const m=i.lng-u.center.lng;i.lng+=m>180?-360:m<-180?360:0}_emulate(i,u,m){const E=Math.ceil(15*u/1e3),M=[],z=i(m.clone());for(let Z=0;Z<=E;Z++){const K=z(Z/E);M.push(K.clone())}return M}}class Xu{constructor(i={}){this.options=i,l.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(i){const u=this.options&&this.options.compact;return this._map=i,this._container=ct("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=ct("button","mapboxgl-ctrl-attrib-button",this._container),ct("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=ct("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),u&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===u&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(i,u){const m=this._map._getUIString(`AttributionControl.${u}`);i.setAttribute("aria-label",m),i.removeAttribute("title"),i.firstElementChild&&i.firstElementChild.setAttribute("title",m)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let i=this._editLink;i||(i=this._editLink=this._container.querySelector(".mapbox-improve-map"));const u=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||l.config.ACCESS_TOKEN}];if(i){const m=u.reduce((E,M,z)=>(M.value&&(E+=`${M.key}=${M.value}${z<u.length-1?"&":""}`),E),"?");i.href=`${l.config.FEEDBACK_URL}/${m}#${rl(this._map,!0)}`,i.rel="noopener nofollow",this._setElementTitle(i,"MapFeedback")}}_updateData(i){!i||"metadata"!==i.sourceDataType&&"visibility"!==i.sourceDataType&&"style"!==i.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let i=[];if(this._map.style.stylesheet){const E=this._map.style.stylesheet;this.styleOwner=E.owner,this.styleId=E.id}const u=this._map.style._sourceCaches;for(const E in u){const M=u[E];if(M.used){const z=M.getSource();z.attribution&&i.indexOf(z.attribution)<0&&i.push(z.attribution)}}i.sort((E,M)=>E.length-M.length),i=i.filter((E,M)=>{for(let z=M+1;z<i.length;z++)if(i[z].indexOf(E)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?i=[...this.options.customAttribution,...i]:i.unshift(this.options.customAttribution));const m=i.join(" | ");m!==this._attribHTML&&(this._attribHTML=m,i.length?(this._innerContainer.innerHTML=m,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Dl{constructor(){l.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(i){this._map=i,this._container=ct("div","mapboxgl-ctrl");const u=ct("a","mapboxgl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://www.mapbox.com/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(i){i&&"metadata"!==i.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const i=this._map.style._sourceCaches;if(0===Object.entries(i).length)return!0;for(const u in i){const m=i[u].getSource();if(m.hasOwnProperty("mapbox_logo")&&!m.mapbox_logo)return!1}return!0}_updateCompact(){const i=this._container.children;if(i.length){const u=i[0];this._map.getCanvasContainer().offsetWidth<250?u.classList.add("mapboxgl-compact"):u.classList.remove("mapboxgl-compact")}}}class Zl{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(i){const u=++this._id;return this._queue.push({callback:i,id:u,cancelled:!1}),u}remove(i){const u=this._currentlyRunning,m=u?this._queue.concat(u):this._queue;for(const E of m)if(E.id===i)return void(E.cancelled=!0)}run(i=0){const u=this._currentlyRunning=this._queue;this._queue=[];for(const m of u)if(!m.cancelled&&(m.callback(i),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Gl(d,i,u){if(d=new l.LngLat(d.lng,d.lat),i){const m=new l.LngLat(d.lng-360,d.lat),E=new l.LngLat(d.lng+360,d.lat),M=360*Math.ceil(Math.abs(d.lng-u.center.lng)/360),z=u.locationPoint(d).distSqr(i),Z=i.x<0||i.y<0||i.x>u.width||i.y>u.height;u.locationPoint(m).distSqr(i)<z&&(Z||Math.abs(m.lng-u.center.lng)<M)?d=m:u.locationPoint(E).distSqr(i)<z&&(Z||Math.abs(E.lng-u.center.lng)<M)&&(d=E)}for(;Math.abs(d.lng-u.center.lng)>180;){const m=u.locationPoint(d);if(m.x>=0&&m.y>=0&&m.x<=u.width&&m.y<=u.height)break;d.lng>u.center.lng?d.lng-=360:d.lng+=360}return d}const Ll={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class tc extends l.Evented{constructor(i,u){if(super(),(i instanceof l.window.HTMLElement||u)&&(i=l.extend({element:i},u)),l.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=i&&i.anchor||"center",this._color=i&&i.color||"#3FB1CE",this._scale=i&&i.scale||1,this._draggable=i&&i.draggable||!1,this._clickTolerance=i&&i.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=i&&i.rotation||0,this._rotationAlignment=i&&i.rotationAlignment||"auto",this._pitchAlignment=i&&i.pitchAlignment&&i.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),i&&i.element)this._element=i.element,this._offset=l.pointGeometry.convert(i&&i.offset||[0,0]);else{this._defaultMarker=!0,this._element=ct("div");const E=41,M=27,z=_t("svg",{display:"block",height:E*this._scale+"px",width:M*this._scale+"px",viewBox:`0 0 ${M} ${E}`},this._element),Z=_t("radialGradient",{id:"shadowGradient"},_t("defs",{},z));_t("stop",{offset:"10%","stop-opacity":.4},Z),_t("stop",{offset:"100%","stop-opacity":.05},Z),_t("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},z),_t("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},z),_t("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},z),_t("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},z),this._offset=l.pointGeometry.convert(i&&i.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",E=>{E.preventDefault()}),this._element.addEventListener("mousedown",E=>{E.preventDefault()});const m=this._element.classList;for(const E in Ll)m.remove(`mapboxgl-marker-anchor-${E}`);m.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(i){return i===this._map||(this.remove(),this._map=i,i.getCanvasContainer().appendChild(this._element),i.on("move",this._updateMoving),i.on("moveend",this._update),i.on("remove",this._clearFadeTimer),i._addMarker(this),this.setDraggable(this._draggable),this._update(),i.on("click",this._onMapClick)),this}remove(){const i=this._map;return i&&(i.off("click",this._onMapClick),i.off("move",this._updateMoving),i.off("moveend",this._update),i.off("mousedown",this._addDragHandler),i.off("touchstart",this._addDragHandler),i.off("mouseup",this._onUp),i.off("touchend",this._onUp),i.off("mousemove",this._onMove),i.off("touchmove",this._onMove),i.off("remove",this._clearFadeTimer),i._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(i){return this._lngLat=l.LngLat.convert(i),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(i){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),i){if(!("offset"in i.options)){const E=Math.sqrt(Math.pow(13.5,2)/2);i.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[E,-1*(24.6+E)],"bottom-right":[-E,-1*(24.6+E)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=i,i._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(i){const u=i.code,m=i.charCode||i.keyCode;"Space"!==u&&"Enter"!==u&&32!==m&&13!==m||this.togglePopup()}_onMapClick(i){const u=i.originalEvent.target,m=this._element;this._popup&&(u===m||m.contains(u))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const i=this._popup;return i?(i.isOpen()?(i.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(i.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const i=this._map;if(!i)return!1;const u=i.unproject(this._pos),m=i.getFreeCameraOptions();if(!m.position)return!1;const E=m.position.toLngLat();return E.distanceTo(u)<.9*E.distanceTo(this._lngLat)}_evaluateOpacity(){const i=this._map;if(!i)return;const u=this._pos;if(!u||u.x<0||u.x>i.transform.width||u.y<0||u.y>i.transform.height)return void this._clearFadeTimer();const m=i.unproject(u);let E;i._showingGlobe()&&l.isLngLatBehindGlobe(i.transform,this._lngLat)?E=0:(E=1-i._queryFogOpacity(m),i.transform._terrainEnabled()&&i.getTerrain()&&this._behindTerrain()&&(E*=.2)),this._element.style.opacity=`${E}`,this._element.style.pointerEvents=E>0?"auto":"none",this._popup&&this._popup._setOpacity(E),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const i=this._pos;if(!i||!this._map)return;const u=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${i.x}px,${i.y}px)\n            ${Ll[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${u.x}px,${u.y}px)\n        `}_calculateXYTransform(){const i=this._pos,u=this._map,m=this.getPitchAlignment();if(!u||!i||"map"!==m)return"";if(!u._showingGlobe()){const K=u.getPitch();return K?`rotateX(${K}deg)`:""}const E=l.radToDeg(l.globeTiltAtLngLat(u.transform,this._lngLat)),M=i.sub(l.globeCenterToScreenPoint(u.transform)),z=Math.abs(M.x)+Math.abs(M.y);if(0===z)return"";const Z=E/z;return`rotateX(${-M.y*Z}deg) rotateY(${M.x*Z}deg)`}_calculateZTransform(){const i=this._pos,u=this._map;if(!u||!i)return"";let m=0;const E=this.getRotationAlignment();if("map"===E)if(u._showingGlobe()){const M=u.project(new l.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),z=u.project(new l.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(M);m=l.radToDeg(Math.atan2(z.y,z.x))-90}else m=-u.getBearing();else if("horizon"===E){const M=l.smoothstep(4,6,u.getZoom()),z=l.globeCenterToScreenPoint(u.transform);z.y+=M*u.transform.height;const Z=i.sub(z),K=l.radToDeg(Math.atan2(Z.y,Z.x));m=(K>90?K-270:K+90)*(1-M)}return m+=this._rotation,m?`rotateZ(${m}deg)`:""}_update(i){l.window.cancelAnimationFrame(this._updateFrameId);const u=this._map;u&&(u.transform.renderWorldCopies&&(this._lngLat=Gl(this._lngLat,this._pos,u.transform)),this._pos=u.project(this._lngLat),!0===i?this._updateFrameId=l.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),u._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(u._showingGlobe()||u.getTerrain()||u.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(i){return this._offset=l.pointGeometry.convert(i),this._update(),this}_onMove(i){const u=this._map;if(u){if(!this._isDragging){const m=this._clickTolerance||u._clickTolerance;this._isDragging=i.point.dist(this._pointerdownPos)>=m}this._isDragging&&(this._pos=i.point.sub(this._positionDelta),this._lngLat=u.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new l.Event("dragstart"))),this.fire(new l.Event("drag")))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const i=this._map;i&&(i.off("mousemove",this._onMove),i.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new l.Event("dragend")),this._state="inactive"}_addDragHandler(i){const u=this._map;u&&this._element.contains(i.originalEvent.target)&&(i.preventDefault(),this._positionDelta=i.point.sub(this._pos),this._pointerdownPos=i.point,this._state="pending",u.on("mousemove",this._onMove),u.on("touchmove",this._onMove),u.once("mouseup",this._onUp),u.once("touchend",this._onUp))}setDraggable(i){this._draggable=!!i;const u=this._map;return u&&(i?(u.on("mousedown",this._addDragHandler),u.on("touchstart",this._addDragHandler)):(u.off("mousedown",this._addDragHandler),u.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(i){return this._rotation=i||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(i){return this._rotationAlignment=i||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(i){return this._pitchAlignment=i||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}}class Su{constructor(i){this.jumpTo(i)}getValue(i){if(i<=this._startTime)return this._start;if(i>=this._endTime)return this._end;const u=l.easeCubicInOut((i-this._startTime)/(this._endTime-this._startTime));return this._start*(1-u)+this._end*u}isEasing(i){return i>=this._startTime&&i<=this._endTime}jumpTo(i){this._startTime=-1/0,this._endTime=-1/0,this._start=i,this._end=i}easeTo(i,u,m){this._start=this.getValue(u),this._end=i,this._startTime=u,this._endTime=u+m}}const na={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},yh={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0};function Au(d){d.parentNode&&d.parentNode.removeChild(d)}const ed={showCompass:!0,showZoom:!0,visualizePitch:!1};class Mu{constructor(i,u,m=!1){this._clickTolerance=10,this.element=u,this.mouseRotate=new El({clickTolerance:i.dragRotate._mouseRotate._clickTolerance}),this.map=i,m&&(this.mousePitch=new Gs({clickTolerance:i.dragRotate._mousePitch._clickTolerance})),l.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),u.addEventListener("mousedown",this.mousedown),u.addEventListener("touchstart",this.touchstart,{passive:!1}),u.addEventListener("touchmove",this.touchmove),u.addEventListener("touchend",this.touchend),u.addEventListener("touchcancel",this.reset)}down(i,u){this.mouseRotate.mousedown(i,u),this.mousePitch&&this.mousePitch.mousedown(i,u),st()}move(i,u){const m=this.map,E=this.mouseRotate.mousemoveWindow(i,u),M=E&&E.bearingDelta;if(M&&m.setBearing(m.getBearing()+M),this.mousePitch){const z=this.mousePitch.mousemoveWindow(i,u),Z=z&&z.pitchDelta;Z&&m.setPitch(m.getPitch()+Z)}}off(){const i=this.element;i.removeEventListener("mousedown",this.mousedown),i.removeEventListener("touchstart",this.touchstart,{passive:!1}),i.removeEventListener("touchmove",this.touchmove),i.removeEventListener("touchend",this.touchend),i.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){at(),l.window.removeEventListener("mousemove",this.mousemove),l.window.removeEventListener("mouseup",this.mouseup)}mousedown(i){this.down(l.extend({},i,{ctrlKey:!0,preventDefault:()=>i.preventDefault()}),kt(this.element,i)),l.window.addEventListener("mousemove",this.mousemove),l.window.addEventListener("mouseup",this.mouseup)}mousemove(i){this.move(i,kt(this.element,i))}mouseup(i){this.mouseRotate.mouseupWindow(i),this.mousePitch&&this.mousePitch.mouseupWindow(i),this.offTemp()}touchstart(i){1!==i.targetTouches.length?this.reset():(this._startPos=this._lastPos=dn(this.element,i.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>i.preventDefault()},this._startPos))}touchmove(i){1!==i.targetTouches.length?this.reset():(this._lastPos=dn(this.element,i.targetTouches)[0],this.move({preventDefault:()=>i.preventDefault()},this._lastPos))}touchend(i){0===i.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const fl={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},uu={maxWidth:100,unit:"metric"};function bc(d,i,u){const m=Iu(i),E=m/i,M={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"}[u];this._map._requestDomTask(()=>{this._container.style.width=d*E+"px",this._container.innerHTML=`${m}&nbsp;${M}`})}function Iu(d){const i=Math.pow(10,`${Math.floor(d)}`.length-1);let u=d/i;return u=u>=10?10:u>=5?5:u>=3?3:u>=2?2:u>=1?1:function(m){const E=Math.pow(10,Math.ceil(-Math.log(m)/Math.LN10));return Math.round(m*E)/E}(u),i*u}const vh={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},td=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Pu(d=new l.pointGeometry(0,0),i="bottom"){if("number"==typeof d){const u=Math.round(Math.sqrt(.5*Math.pow(d,2)));switch(i){case"top":return new l.pointGeometry(0,d);case"top-left":return new l.pointGeometry(u,u);case"top-right":return new l.pointGeometry(-u,u);case"bottom":return new l.pointGeometry(0,-d);case"bottom-left":return new l.pointGeometry(u,-u);case"bottom-right":return new l.pointGeometry(-u,-u);case"left":return new l.pointGeometry(d,0);case"right":return new l.pointGeometry(-d,0)}return new l.pointGeometry(0,0)}return d instanceof l.pointGeometry||Array.isArray(d)?l.pointGeometry.convert(d):l.pointGeometry.convert(d[i]||[0,0])}const hu={version:l.version,supported:lt,setRTLTextPlugin:l.setRTLTextPlugin,getRTLTextPluginStatus:l.getRTLTextPluginStatus,Map:class extends Ku{constructor(d){if(null!=(d=l.extend({},yh,d)).minZoom&&null!=d.maxZoom&&d.minZoom>d.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=d.minPitch&&null!=d.maxPitch&&d.minPitch>d.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=d.minPitch&&d.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=d.maxPitch&&d.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(d.antialias&&l.isSafariWithAntialiasingBug(l.window)&&(d.antialias=!1,l.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Hr(d.minZoom,d.maxZoom,d.minPitch,d.maxPitch,d.renderWorldCopies),d),this._interactive=d.interactive,this._minTileCacheSize=d.minTileCacheSize,this._maxTileCacheSize=d.maxTileCacheSize,this._failIfMajorPerformanceCaveat=d.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=d.preserveDrawingBuffer,this._antialias=d.antialias,this._trackResize=d.trackResize,this._bearingSnap=d.bearingSnap,this._refreshExpiredTiles=d.refreshExpiredTiles,this._fadeDuration=d.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=d.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=d.collectResourceTiming,this._optimizeForTerrain=d.optimizeForTerrain,this._language="auto"===d.language?l.window.navigator.language:d.language,this._worldview=d.worldview,this._renderTaskQueue=new Zl,this._domRenderTaskQueue=new Zl,this._controls=[],this._markers=[],this._mapId=l.uniqueId(),this._locale=l.extend({},na,d.locale),this._clickTolerance=d.clickTolerance,this._cooperativeGestures=d.cooperativeGestures,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Su(0),this._useExplicitProjection=!1,this._requestManager=new l.RequestManager(d.transformRequest,d.accessToken,d.testMode),this._silenceAuthErrors=!!d.testMode,"string"==typeof d.container){if(this._container=l.window.document.getElementById(d.container),!this._container)throw new Error(`Container '${d.container}' not found.`)}else{if(!(d.container instanceof l.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=d.container}if(this._container.childNodes.length>0&&l.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),d.maxBounds&&this.setMaxBounds(d.maxBounds),l.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==l.window&&(l.window.addEventListener("online",this._onWindowOnline,!1),l.window.addEventListener("resize",this._onWindowResize,!1),l.window.addEventListener("orientationchange",this._onWindowResize,!1),l.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1)),this.handlers=new Ys(this,d),this._localFontFamily=d.localFontFamily,this._localIdeographFontFamily=d.localIdeographFontFamily,d.style&&this.setStyle(d.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),d.projection&&this.setProjection(d.projection),this._hash=d.hash&&new il("string"==typeof d.hash&&d.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:d.center,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch}),d.bounds&&(this.resize(),this.fitBounds(d.bounds,l.extend({},d.fitBoundsOptions,{duration:0})))),this.resize(),d.attributionControl&&this.addControl(new Xu({customAttribution:d.customAttribution})),this._logoControl=new Dl,this.addControl(this._logoControl,d.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",i=>{this._update("style"===i.dataType),this.fire(new l.Event(`${i.dataType}data`,i))}),this.on("dataloading",i=>{this.fire(new l.Event(`${i.dataType}dataloading`,i))})}_getMapId(){return this._mapId}addControl(d,i){if(void 0===i&&(i=d.getDefaultPosition?d.getDefaultPosition():"top-right"),!d||!d.onAdd)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=d.onAdd(this);this._controls.push(d);const m=this._controlPositions[i];return-1!==i.indexOf("bottom")?m.insertBefore(u,m.firstChild):m.appendChild(u),this}removeControl(d){if(!d||!d.onRemove)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const i=this._controls.indexOf(d);return i>-1&&this._controls.splice(i,1),d.onRemove(this),this}hasControl(d){return this._controls.indexOf(d)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(d){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const i=!this._moving;return i&&this.fire(new l.Event("movestart",d)).fire(new l.Event("move",d)),this.fire(new l.Event("resize",d)),i&&this.fire(new l.Event("moveend",d)),this}getBounds(){return"globe"===this.transform.projection.name&&l.warnOnce('Globe projection does not support getBounds API, this API may behave unexpectedly."'),this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(d){return this.transform.setMaxBounds(l.LngLatBounds.convert(d)),this._update()}setMinZoom(d){if((d=null==d?-2:d)>=-2&&d<=this.transform.maxZoom)return this.transform.minZoom=d,this._update(),this.getZoom()<d?this.setZoom(d):this.fire(new l.Event("zoomstart")).fire(new l.Event("zoom")).fire(new l.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(d){if((d=null==d?22:d)>=this.transform.minZoom)return this.transform.maxZoom=d,this._update(),this.getZoom()>d?this.setZoom(d):this.fire(new l.Event("zoomstart")).fire(new l.Event("zoom")).fire(new l.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(d){if((d=null==d?0:d)<0)throw new Error("minPitch must be greater than or equal to 0");if(d>=0&&d<=this.transform.maxPitch)return this.transform.minPitch=d,this._update(),this.getPitch()<d?this.setPitch(d):this.fire(new l.Event("pitchstart")).fire(new l.Event("pitch")).fire(new l.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(d){if((d=null==d?85:d)>85)throw new Error("maxPitch must be less than or equal to 85");if(d>=this.transform.minPitch)return this.transform.maxPitch=d,this._update(),this.getPitch()>d?this.setPitch(d):this.fire(new l.Event("pitchstart")).fire(new l.Event("pitch")).fire(new l.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(d){return this.transform.renderWorldCopies=d,this._update()}getLanguage(){return this._language}setLanguage(d){if(this._language="auto"===d?l.window.navigator.language:d,this.style)for(const i in this.style._sourceCaches){const u=this.style._sourceCaches[i]._source;u._setLanguage&&u._setLanguage(this._language)}for(const i of this._controls)i._setLanguage&&i._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(d){if(this._worldview=d,this.style)for(const i in this.style._sourceCaches){const u=this.style._sourceCaches[i]._source;u._setWorldview&&u._setWorldview(d)}return this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(d){return this._lazyInitEmptyStyle(),d?"string"==typeof d&&(d={name:d}):d=null,this._useExplicitProjection=!!d,this._prioritizeAndUpdateProjection(d,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const d=this.transform,i=d.projection.name;let u;"globe"===i&&d.zoom>=l.GLOBE_ZOOM_THRESHOLD_MAX?(d.setMercatorFromTransition(),u=!0):"mercator"===i&&d.zoom<l.GLOBE_ZOOM_THRESHOLD_MAX&&(d.setProjection({name:"globe"}),u=!0),u&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(d,i){return this._updateProjection(d||i||{name:"mercator"})}_updateProjection(d){let i;if(i="globe"===d.name&&this.transform.zoom>=l.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(d),this.style.applyProjectionUpdate(),i){this.painter.clearBackgroundTiles();for(const u in this.style._sourceCaches)this.style._sourceCaches[u].clearTiles();this._update(!0)}return this}project(d){return this.transform.locationPoint3D(l.LngLat.convert(d))}unproject(d){return this.transform.pointLocation3D(l.pointGeometry.convert(d))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_createDelegatedListener(d,i,u){if("mouseenter"===d||"mouseover"===d){let m=!1;const E=z=>{const Z=i.filter(de=>this.getLayer(de)),K=Z.length?this.queryRenderedFeatures(z.point,{layers:Z}):[];K.length?m||(m=!0,u.call(this,new ye(d,this,z.originalEvent,{features:K}))):m=!1},M=()=>{m=!1};return{layers:new Set(i),listener:u,delegates:{mousemove:E,mouseout:M}}}if("mouseleave"===d||"mouseout"===d){let m=!1;const E=z=>{const Z=i.filter(K=>this.getLayer(K));(Z.length?this.queryRenderedFeatures(z.point,{layers:Z}):[]).length?m=!0:m&&(m=!1,u.call(this,new ye(d,this,z.originalEvent)))},M=z=>{m&&(m=!1,u.call(this,new ye(d,this,z.originalEvent)))};return{layers:new Set(i),listener:u,delegates:{mousemove:E,mouseout:M}}}{const m=E=>{const M=i.filter(Z=>this.getLayer(Z)),z=M.length?this.queryRenderedFeatures(E.point,{layers:M}):[];z.length&&(E.features=z,u.call(this,E),delete E.features)};return{layers:new Set(i),listener:u,delegates:{[d]:m}}}}on(d,i,u){if(void 0===u)return super.on(d,i);Array.isArray(i)||(i=[i]);const m=this._createDelegatedListener(d,i,u);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[d]=this._delegatedListeners[d]||[],this._delegatedListeners[d].push(m);for(const E in m.delegates)this.on(E,m.delegates[E]);return this}once(d,i,u){if(void 0===u)return super.once(d,i);Array.isArray(i)||(i=[i]);const m=this._createDelegatedListener(d,i,u);for(const E in m.delegates)this.once(E,m.delegates[E]);return this}off(d,i,u){if(void 0===u)return super.off(d,i);i=new Set(Array.isArray(i)?i:[i]);const m=(M,z)=>{if(M.size!==z.size)return!1;for(const Z of M)if(!z.has(Z))return!1;return!0},E=this._delegatedListeners?this._delegatedListeners[d]:void 0;return E&&(M=>{for(let z=0;z<M.length;z++){const Z=M[z];if(Z.listener===u&&m(Z.layers,i)){for(const K in Z.delegates)this.off(K,Z.delegates[K]);return M.splice(z,1),this}}})(E),this}queryRenderedFeatures(d,i){return this.style?(void 0!==i||void 0===d||d instanceof l.pointGeometry||Array.isArray(d)||(i=d,d=void 0),this.style.queryRenderedFeatures(d=d||[[0,0],[this.transform.width,this.transform.height]],i=i||{},this.transform)):[]}querySourceFeatures(d,i){return this.style.querySourceFeatures(d,i)}queryTerrainElevation(d,i){const u=this.transform.elevation;return u?(i=l.extend({},{exaggerated:!0},i),u.getAtPoint(l.MercatorCoordinate.fromLngLat(d),null,i.exaggerated)):null}setStyle(d,i){return!1!==(i=l.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},i)).diff&&i.localIdeographFontFamily===this._localIdeographFontFamily&&i.localFontFamily===this._localFontFamily&&this.style&&d?(this._diffStyle(d,i),this):(this._localIdeographFontFamily=i.localIdeographFontFamily,this._localFontFamily=i.localFontFamily,this._updateStyle(d,i))}_getUIString(d){const i=this._locale[d];if(null==i)throw new Error(`Missing UI string '${d}'`);return i}_updateStyle(d,i){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),d&&(this.style=new ps(this,i||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof d?this.style.loadURL(d):this.style.loadJSON(d)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new ps(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(d,i){if("string"==typeof d){const u=this._requestManager.normalizeStyleURL(d),m=this._requestManager.transformRequest(u,l.ResourceType.Style);l.getJSON(m,(E,M)=>{E?this.fire(new l.ErrorEvent(E)):M&&this._updateDiff(M,i)})}else"object"==typeof d&&this._updateDiff(d,i)}_updateDiff(d,i){try{this.style.setState(d)&&this._update(!0)}catch(u){l.warnOnce(`Unable to perform style diff: ${u.message||u.error||u}.  Rebuilding the style from scratch.`),this._updateStyle(d,i)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(l.warnOnce("There is no style added to the map."),!1)}addSource(d,i){return this._lazyInitEmptyStyle(),this.style.addSource(d,i),this._update(!0)}isSourceLoaded(d){return!!this.style&&this.style._isSourceCacheLoaded(d)}areTilesLoaded(){const d=this.style&&this.style._sourceCaches;for(const i in d){const u=d[i]._tiles;for(const m in u){const E=u[m];if("loaded"!==E.state&&"errored"!==E.state)return!1}}return!0}addSourceType(d,i,u){this._lazyInitEmptyStyle(),this.style.addSourceType(d,i,u)}removeSource(d){return this.style.removeSource(d),this._updateTerrain(),this._update(!0)}getSource(d){return this.style.getSource(d)}addImage(d,i,{pixelRatio:u=1,sdf:m=!1,stretchX:E,stretchY:M,content:z}={}){if(this._lazyInitEmptyStyle(),i instanceof l.window.HTMLImageElement||l.window.ImageBitmap&&i instanceof l.window.ImageBitmap){const{width:Z,height:K,data:de}=l.exported.getImageData(i);this.style.addImage(d,{data:new l.RGBAImage({width:Z,height:K},de),pixelRatio:u,stretchX:E,stretchY:M,content:z,sdf:m,version:0})}else if(void 0===i.width||void 0===i.height)this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:Z,height:K}=i,de=i;this.style.addImage(d,{data:new l.RGBAImage({width:Z,height:K},new Uint8Array(de.data)),pixelRatio:u,stretchX:E,stretchY:M,content:z,sdf:m,version:0,userImage:de}),de.onAdd&&de.onAdd(this,d)}}updateImage(d,i){const u=this.style.getImage(d);if(!u)return void this.fire(new l.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const m=i instanceof l.window.HTMLImageElement||l.window.ImageBitmap&&i instanceof l.window.ImageBitmap?l.exported.getImageData(i):i,{width:E,height:M}=m;void 0!==E&&void 0!==M?E===u.data.width&&M===u.data.height?(u.data.replace(m.data,!(i instanceof l.window.HTMLImageElement||l.window.ImageBitmap&&i instanceof l.window.ImageBitmap)),this.style.updateImage(d,u)):this.fire(new l.ErrorEvent(new Error(`The width and height of the updated image (${E}, ${M})\n                must be that same as the previous version of the image\n                (${u.data.width}, ${u.data.height})`))):this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(d){return d?!!this.style.getImage(d):(this.fire(new l.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(d){this.style.removeImage(d)}loadImage(d,i){l.getImage(this._requestManager.transformRequest(d,l.ResourceType.Image),(u,m)=>{i(u,m instanceof l.window.HTMLImageElement?l.exported.getImageData(m):m)})}listImages(){return this.style.listImages()}addLayer(d,i){return this._lazyInitEmptyStyle(),this.style.addLayer(d,i),this._update(!0)}moveLayer(d,i){return this.style.moveLayer(d,i),this._update(!0)}removeLayer(d){return this.style.removeLayer(d),this._update(!0)}getLayer(d){return this.style.getLayer(d)}setLayerZoomRange(d,i,u){return this.style.setLayerZoomRange(d,i,u),this._update(!0)}setFilter(d,i,u={}){return this.style.setFilter(d,i,u),this._update(!0)}getFilter(d){return this.style.getFilter(d)}setPaintProperty(d,i,u,m={}){return this.style.setPaintProperty(d,i,u,m),this._update(!0)}getPaintProperty(d,i){return this.style.getPaintProperty(d,i)}setLayoutProperty(d,i,u,m={}){return this.style.setLayoutProperty(d,i,u,m),this._update(!0)}getLayoutProperty(d,i){return this.style.getLayoutProperty(d,i)}setLight(d,i={}){return this._lazyInitEmptyStyle(),this.style.setLight(d,i),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(d){return this._lazyInitEmptyStyle(),!d&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(d),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(d){return this._lazyInitEmptyStyle(),this.style.setFog(d),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(d){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(l.LngLat.convert(d),this.transform):0}setFeatureState(d,i){return this.style.setFeatureState(d,i),this._update()}removeFeatureState(d,i){return this.style.removeFeatureState(d,i),this._update()}getFeatureState(d){return this.style.getFeatureState(d)}_updateContainerDimensions(){if(!this._container)return;const d=this._container.getBoundingClientRect().width||400,i=this._container.getBoundingClientRect().height||300;let u,m,E,M=this._container;for(;M&&(!m||!E);){const z=l.window.getComputedStyle(M).transform;z&&"none"!==z&&(u=z.match(/matrix.*\((.+)\)/)[1].split(", "),u[0]&&"0"!==u[0]&&"1"!==u[0]&&(m=u[0]),u[3]&&"0"!==u[3]&&"1"!==u[3]&&(E=u[3])),M=M.parentElement}this._containerWidth=m?Math.abs(d/m):d,this._containerHeight=E?Math.abs(i/E):i}_detectMissingCSS(){"rgb(250, 128, 114)"!==l.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&l.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const d=this._container;d.classList.add("mapboxgl-map"),(this._missingCSSCanary=ct("div","mapboxgl-canary",d)).style.visibility="hidden",this._detectMissingCSS();const i=this._canvasContainer=ct("div","mapboxgl-canvas-container",d);this._interactive&&i.classList.add("mapboxgl-interactive"),this._canvas=ct("canvas","mapboxgl-canvas",i),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const u=this._controlContainer=ct("div","mapboxgl-control-container",d),m=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(E=>{m[E]=ct("div",`mapboxgl-ctrl-${E}`,u)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(d,i){const u=l.exported.devicePixelRatio||1;this._canvas.width=u*Math.ceil(d),this._canvas.height=u*Math.ceil(i),this._canvas.style.width=`${d}px`,this._canvas.style.height=`${i}px`}_addMarker(d){this._markers.push(d)}_removeMarker(d){const i=this._markers.indexOf(d);-1!==i&&this._markers.splice(i,1)}_setupPainter(){const d=l.extend({},lt.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),i=this._canvas.getContext("webgl",d)||this._canvas.getContext("experimental-webgl",d);i?(l.storeAuthState(i,!0),this.painter=new Ii(i,this.transform),this.on("data",u=>{"source"===u.dataType&&this.painter.setTileLoadedFlag(!0)}),l.exported$1.testSupport(i)):this.fire(new l.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(d){d.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new l.Event("webglcontextlost",{originalEvent:d}))}_contextRestored(d){this._setupPainter(),this.resize(),this._update(),this.fire(new l.Event("webglcontextrestored",{originalEvent:d}))}_onMapScroll(d){if(d.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(d){return this.style?(this._styleDirty=this._styleDirty||d,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(d){return this._update(),this._renderTaskQueue.add(d)}_cancelRenderFrame(d){this._renderTaskQueue.remove(d)}_requestDomTask(d){!this.loaded()||this.loaded()&&!this.isMoving()?d():this._domRenderTaskQueue.add(d)}_render(d){let i;const u=this.painter.context.extTimerQuery,m=l.exported.now();if(this.listens("gpu-timing-frame")&&(i=u.createQueryEXT(),u.beginQueryEXT(u.TIME_ELAPSED_EXT,i)),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(d),this._domRenderTaskQueue.run(d),this._removed)return;this._updateProjectionTransition();let E=!1;const M=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const K=this.transform.zoom,de=this.transform.pitch,pe=l.exported.now();this.style.zoomHistory.update(K,pe);const De=new l.EvaluationParameters(K,{now:pe,fadeDuration:M,pitch:de,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Fe=De.crossFadingFactor();1===Fe&&Fe===this._crossFadingFactor||(E=!0,this._crossFadingFactor=Fe),this.style.update(De)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let z=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),z=this._updateAverageElevation(m),this.style._updateSources(this.transform),this._forceMarkerUpdate()):z=this._updateAverageElevation(m),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,M,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:M,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new l.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new l.Event("load"))),this.style&&(this.style.hasTransitions()||E)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),i){const K=l.exported.now()-m;u.endQueryEXT(u.TIME_ELAPSED_EXT,i),setTimeout(()=>{const de=u.getQueryObjectEXT(i,u.QUERY_RESULT_EXT)/1e6;u.deleteQueryEXT(i),this.fire(new l.Event("gpu-timing-frame",{cpuTime:K,gpuTime:de})),l.window.performance.mark("frame-gpu",{startTime:m,detail:{gpuTime:de}})},50)}if(this.listens("gpu-timing-layer")){const K=this.painter.collectGpuTimers();setTimeout(()=>{const de=this.painter.queryGpuTimers(K);this.fire(new l.Event("gpu-timing-layer",{layerTimes:de}))},50)}if(this.listens("gpu-timing-deferred-render")){const K=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const de=this.painter.queryGpuTimeDeferredRender(K);this.fire(new l.Event("gpu-timing-deferred-render",{gpuTime:de}))},50)}const Z=this._sourcesDirty||this._styleDirty||this._placementDirty||z;if(Z||this._repaint)this.triggerRepaint();else{const K=!this.isMoving()&&this.loaded();if(K&&(z=this._updateAverageElevation(m,!0)),z)this.triggerRepaint();else if(this._triggerFrame(!1),K&&(this.fire(new l.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const de=this._calculateSpeedIndex();this.fire(new l.Event("speedindexcompleted",{speedIndex:de})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||Z||(this._fullyLoaded=!0,this._authenticate())}_forceMarkerUpdate(){for(const d of this._markers)d._update()}_updateAverageElevation(d,i=!1){const u=m=>(this.transform.averageElevation=m,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&u(0);if((i||d-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(d)){const m=this.transform.averageElevation;let E=this.transform.sampleAverageElevation(),M=!1;this.transform.elevation&&(M=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(E)?E=0:this._averageElevationLastSampledAt=d;const z=Math.abs(m-E);if(z>1){if(this._isInitialLoad||M)return this._averageElevation.jumpTo(E),u(E);this._averageElevation.easeTo(E,d,300)}else if(z>1e-4)return this._averageElevation.jumpTo(E),u(E)}return!!this._averageElevation.isEasing(d)&&u(this._averageElevation.getValue(d))}_authenticate(){l.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,d=>{if(d&&(d.message===l.AUTH_ERR_MSG||401===d.status)){const i=this.painter.context.gl;l.storeAuthState(i,!1),this._logoControl instanceof Dl&&this._logoControl._updateLogo(),i&&i.clear(i.DEPTH_BUFFER_BIT|i.COLOR_BUFFER_BIT|i.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new l.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),l.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){this.painter.updateTerrain(this.style,this.isMoving()||this.isRotating()||this.isZooming())}_calculateSpeedIndex(){const d=this.painter.canvasCopy(),i=this.painter.getCanvasCopiesAndTimestamps();i.timeStamps.push(performance.now());const u=this.painter.context.gl,m=u.createFramebuffer();function E(M){u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,M,0);const z=new Uint8Array(u.drawingBufferWidth*u.drawingBufferHeight*4);return u.readPixels(0,0,u.drawingBufferWidth,u.drawingBufferHeight,u.RGBA,u.UNSIGNED_BYTE,z),z}return u.bindFramebuffer(u.FRAMEBUFFER,m),this._canvasPixelComparison(E(d),i.canvasCopies.map(E),i.timeStamps)}_canvasPixelComparison(d,i,u){let m=u[1]-u[0];const E=d.length/4;for(let M=0;M<i.length;M++){const z=i[M];let Z=0;for(let K=0;K<z.length;K+=4)z[K]===d[K]&&z[K+1]===d[K+1]&&z[K+2]===d[K+2]&&z[K+3]===d[K+3]&&(Z+=1);m+=(u[M+2]-u[M+1])*(1-Z/E)}return m}remove(){this._hash&&this._hash.remove();for(const i of this._controls)i.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),void 0!==l.window&&(l.window.removeEventListener("resize",this._onWindowResize,!1),l.window.removeEventListener("orientationchange",this._onWindowResize,!1),l.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),l.window.removeEventListener("online",this._onWindowOnline,!1));const d=this.painter.context.gl.getExtension("WEBGL_lose_context");d&&d.loseContext(),Au(this._canvasContainer),Au(this._controlContainer),Au(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),l.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new l.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(d){this._renderNextFrame=this._renderNextFrame||d,this.style&&!this._frame&&(this._frame=l.exported.frame(i=>{const u=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,u&&this._render(i)}))}_preloadTiles(d){const i=this.style?Object.values(this.style._sourceCaches):[];return l.asyncAll(i,(u,m)=>u._preloadTiles(d,m),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(d){this._trackResize&&this.resize({originalEvent:d})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(d){this._showTileBoundaries!==d&&(this._showTileBoundaries=d,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(d){this._showTerrainWireframe!==d&&(this._showTerrainWireframe=d,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(d){this._speedIndexTiming!==d&&(this._speedIndexTiming=d,this._update())}get showPadding(){return!!this._showPadding}set showPadding(d){this._showPadding!==d&&(this._showPadding=d,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(d){this._showCollisionBoxes!==d&&(this._showCollisionBoxes=d,d?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(d){this._showOverdrawInspector!==d&&(this._showOverdrawInspector=d,this._update())}get repaint(){return!!this._repaint}set repaint(d){this._repaint!==d&&(this._repaint=d,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(d){this._vertices=d,this._update()}_setCacheLimits(d,i){l.setCacheLimits(d,i)}get version(){return l.version}},NavigationControl:class{constructor(d){this.options=l.extend({},ed,d),this._container=ct("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",i=>i.preventDefault()),this.options.showZoom&&(l.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",i=>{this._map&&this._map.zoomIn({},{originalEvent:i})}),ct("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",i=>{this._map&&this._map.zoomOut({},{originalEvent:i})}),ct("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(l.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",i=>{const u=this._map;u&&(this.options.visualizePitch?u.resetNorthPitch({},{originalEvent:i}):u.resetNorth({},{originalEvent:i}))}),this._compassIcon=ct("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const d=this._map;if(!d)return;const i=d.getZoom(),u=i===d.getMaxZoom(),m=i===d.getMinZoom();this._zoomInButton.disabled=u,this._zoomOutButton.disabled=m,this._zoomInButton.setAttribute("aria-disabled",u.toString()),this._zoomOutButton.setAttribute("aria-disabled",m.toString())}_rotateCompassArrow(){const d=this._map;if(!d)return;const i=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(d.transform.pitch*(Math.PI/180)),.5)}) rotateX(${d.transform.pitch}deg) rotateZ(${d.transform.angle*(180/Math.PI)}deg)`:`rotate(${d.transform.angle*(180/Math.PI)}deg)`;d._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=i)})}onAdd(d){return this._map=d,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),d.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&d.on("pitch",this._rotateCompassArrow),d.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Mu(d,this._compass,this.options.visualizePitch)),this._container}onRemove(){const d=this._map;d&&(this._container.remove(),this.options.showZoom&&d.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&d.off("pitch",this._rotateCompassArrow),d.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(d,i){const u=ct("button",d,this._container);return u.type="button",u.addEventListener("click",i),u}_setButtonTitle(d,i){if(!this._map)return;const u=this._map._getUIString(`NavigationControl.${i}`);d.setAttribute("aria-label",u),d.firstElementChild&&d.firstElementChild.setAttribute("title",u)}},GeolocateControl:class extends l.Evented{constructor(d){super(),this.options=l.extend({geolocation:l.window.navigator.geolocation},fl,d),l.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Os(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(d){return this._map=d,this._container=ct("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(d){void 0!==this._supportsGeolocation?d(this._supportsGeolocation):void 0!==l.window.navigator.permissions?l.window.navigator.permissions.query({name:"geolocation"}).then(i=>{this._supportsGeolocation="denied"!==i.state,d(this._supportsGeolocation)}):(this._supportsGeolocation=!!this.options.geolocation,d(this._supportsGeolocation))}_isOutOfMapMaxBounds(d){const i=this._map.getMaxBounds(),u=d.coords;return!!i&&(u.longitude<i.getWest()||u.longitude>i.getEast()||u.latitude<i.getSouth()||u.latitude>i.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(d){if(this._map){if(this._isOutOfMapMaxBounds(d))return this._setErrorState(),this.fire(new l.Event("outofmaxbounds",d)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=d,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(d),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(d),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new l.Event("geolocate",d)),this._finish()}}_updateCamera(d){const i=new l.LngLat(d.coords.longitude,d.coords.latitude),u=d.coords.accuracy,m=this._map.getBearing(),E=l.extend({bearing:m},this.options.fitBoundsOptions);this._map.fitBounds(i.toBounds(u),E,{geolocateSource:!0})}_updateMarker(d){if(d){const i=new l.LngLat(d.coords.longitude,d.coords.latitude);this._accuracyCircleMarker.setLngLat(i).addTo(this._map),this._userLocationDotMarker.setLngLat(i).addTo(this._map),this._accuracy=d.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const d=this._map.transform,i=l.mercatorZfromAltitude(1,d._center.lat)*d.worldSize,u=Math.ceil(2*this._accuracy*i);this._circleElement.style.width=`${u}px`,this._circleElement.style.height=`${u}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(d){if(this._map){if(this.options.trackUserLocation)if(1===d.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",i),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",i),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===d.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new l.Event("error",d)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(d){if(this._container.addEventListener("contextmenu",i=>i.preventDefault()),this._geolocateButton=ct("button","mapboxgl-ctrl-geolocate",this._container),ct("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===d){l.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",i),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",i)}else{const i=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",i),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",i)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=ct("div","mapboxgl-user-location"),this._dotElement.appendChild(ct("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(ct("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new tc({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=ct("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new tc({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",i=>{i.geolocateSource||"ACTIVE_LOCK"!==this._watchState||i.originalEvent&&"resize"===i.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new l.Event("trackuserlocationend")))})}_onDeviceOrientation(d){this._userLocationDotMarker&&(d.webkitCompassHeading?this._heading=d.webkitCompassHeading:!0===d.absolute&&(this._heading=-1*d.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return l.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new l.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new l.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new l.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let d;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(d={maximumAge:6e5,timeout:0},this._noTimeout=!0):(d=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,d),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const d=()=>{l.window.addEventListener("ondeviceorientationabsolute"in l.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};void 0!==l.window.DeviceMotionEvent&&"function"==typeof l.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(i=>{"granted"===i&&d()}).catch(console.error):d()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),l.window.removeEventListener("deviceorientation",this._onDeviceOrientation),l.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Xu,ScaleControl:class{constructor(d){this.options=l.extend({},uu,d),function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"narrow",unit:"meter"}),!0}catch(i){return!1}}()||(this._setScale=bc.bind(this)),l.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const d=this.options.maxWidth||100,i=this._map,u=i._containerHeight/2,m=i._containerWidth/2-d/2,E=i.unproject([m,u]),M=i.unproject([m+d,u]),z=E.distanceTo(M);if("imperial"===this.options.unit){const Z=3.2808*z;Z>5280?this._setScale(d,Z/5280,"mile"):this._setScale(d,Z,"foot")}else"nautical"===this.options.unit?this._setScale(d,z/1852,"nautical-mile"):z>=1e3?this._setScale(d,z/1e3,"kilometer"):this._setScale(d,z,"meter")}_setScale(d,i,u){const m=Iu(i),E=m/i;this._map._requestDomTask(()=>{this._container.style.width=d*E+"px",this._container.innerHTML="nautical-mile"!==u?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"narrow",unit:u}).format(m):`${m}&nbsp;nm`})}onAdd(d){return this._map=d,this._language=d.getLanguage(),this._container=ct("div","mapboxgl-ctrl mapboxgl-ctrl-scale",d.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(d){this._language=d,this._update()}setUnit(d){this.options.unit=d,this._update()}},FullscreenControl:class{constructor(d){this._fullscreen=!1,d&&d.container&&(d.container instanceof l.window.HTMLElement?this._container=d.container:l.warnOnce("Full screen control 'container' must be a DOM element.")),l.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in l.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in l.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(d){return this._map=d,this._container||(this._container=this._map.getContainer()),this._controlContainer=ct("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",l.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,l.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!l.window.document.fullscreenEnabled&&!l.window.document.webkitFullscreenEnabled)}_setupUI(){const d=this._fullscreenButton=ct("button","mapboxgl-ctrl-fullscreen",this._controlContainer);ct("span","mapboxgl-ctrl-icon",d).setAttribute("aria-hidden","true"),d.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),l.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const d=this._getTitle();this._fullscreenButton.setAttribute("aria-label",d),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",d)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(l.window.document.fullscreenElement||l.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?l.window.document.exitFullscreen?l.window.document.exitFullscreen():l.window.document.webkitCancelFullScreen&&l.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends l.Evented{constructor(d){super(),this.options=l.extend(Object.create(vh),d),l.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(d&&d.className?d.className.trim().split(/\s+/):[])}addTo(d){return this._map&&this.remove(),this._map=d,this.options.closeOnClick&&d.on("preclick",this._onClose),this.options.closeOnMove&&d.on("move",this._onClose),d.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(d.on("mousemove",this._onMouseEvent),d.on("mouseup",this._onMouseEvent),d._canvasContainer.classList.add("mapboxgl-track-pointer")):d.on("move",this._update),this.fire(new l.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const d=this._map;return d&&(d.off("move",this._update),d.off("move",this._onClose),d.off("preclick",this._onClose),d.off("click",this._onClose),d.off("remove",this.remove),d.off("mousemove",this._onMouseEvent),d.off("mouseup",this._onMouseEvent),d.off("drag",this._onMouseEvent),this._map=void 0),this.fire(new l.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(d){this._lngLat=l.LngLat.convert(d),this._pos=null,this._trackPointer=!1,this._update();const i=this._map;return i&&(i.on("move",this._update),i.off("mousemove",this._onMouseEvent),i._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const d=this._map;return d&&(d.off("move",this._update),d.on("mousemove",this._onMouseEvent),d.on("drag",this._onMouseEvent),d._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(d){return this.setDOMContent(l.window.document.createTextNode(d))}setHTML(d){const i=l.window.document.createDocumentFragment(),u=l.window.document.createElement("body");let m;for(u.innerHTML=d;m=u.firstChild,m;)i.appendChild(m);return this.setDOMContent(i)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(d){return this.options.maxWidth=d,this._update(),this}setDOMContent(d){let i=this._content;if(i)for(;i.hasChildNodes();)i.firstChild&&i.removeChild(i.firstChild);else i=this._content=ct("div","mapboxgl-popup-content",this._container||void 0);if(i.appendChild(d),this.options.closeButton){const u=this._closeButton=ct("button","mapboxgl-popup-close-button",i);u.type="button",u.setAttribute("aria-label","Close popup"),u.setAttribute("aria-hidden","true"),u.innerHTML="&#215;",u.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(d){return this._classList.add(d),this._updateClassList(),this}removeClassName(d){return this._classList.delete(d),this._updateClassList(),this}setOffset(d){return this.options.offset=d,this._update(),this}toggleClassName(d){let i;return this._classList.delete(d)?i=!1:(this._classList.add(d),i=!0),this._updateClassList(),i}_onMouseEvent(d){this._update(d.point)}_getAnchor(d){if(this.options.anchor)return this.options.anchor;const i=this._map,u=this._container,m=this._pos;if(!i||!u||!m)return"bottom";const E=u.offsetWidth,M=u.offsetHeight,z=m.x<E/2,Z=m.x>i.transform.width-E/2;if(m.y+d<M)return z?"top-left":Z?"top-right":"top";if(m.y>i.transform.height-M){if(z)return"bottom-left";if(Z)return"bottom-right"}return z?"left":Z?"right":"bottom"}_updateClassList(){const d=this._container;if(!d)return;const i=[...this._classList];i.push("mapboxgl-popup"),this._anchor&&i.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&i.push("mapboxgl-popup-track-pointer"),d.className=i.join(" ")}_update(d){const i=this._map,u=this._content;if(!i||!this._lngLat&&!this._trackPointer||!u)return;let m=this._container;if(m||(m=this._container=ct("div","mapboxgl-popup",i.getContainer()),this._tip=ct("div","mapboxgl-popup-tip",m),m.appendChild(u)),this.options.maxWidth&&m.style.maxWidth!==this.options.maxWidth&&(m.style.maxWidth=this.options.maxWidth),i.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Gl(this._lngLat,this._pos,i.transform)),!this._trackPointer||d){const E=this._pos=this._trackPointer&&d?d:i.project(this._lngLat),M=Pu(this.options.offset),z=this._anchor=this._getAnchor(M.y),Z=Pu(this.options.offset,z),K=E.add(Z).round();i._requestDomTask(()=>{this._container&&z&&(this._container.style.transform=`${Ll[z]} translate(${K.x}px,${K.y}px)`)})}if(!this._marker&&i._showingGlobe()){const E=l.isLngLatBehindGlobe(i.transform,this._lngLat)?0:1;this._setOpacity(E)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const d=this._container.querySelector(td);d&&d.focus()}_onClose(){this.remove()}_setOpacity(d){this._container&&(this._container.style.opacity=`${d}`),this._content&&(this._content.style.pointerEvents=d?"auto":"none")}},Marker:tc,Style:ps,LngLat:l.LngLat,LngLatBounds:l.LngLatBounds,Point:l.pointGeometry,MercatorCoordinate:l.MercatorCoordinate,FreeCameraOptions:q,Evented:l.Evented,config:l.config,prewarm:function(){In().acquire(Pt)},clearPrewarmedResources:function(){const d=un;d&&(d.isPreloaded()&&1===d.numActive()?(d.release(Pt),un=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return l.config.ACCESS_TOKEN},set accessToken(d){l.config.ACCESS_TOKEN=d},get baseApiUrl(){return l.config.API_URL},set baseApiUrl(d){l.config.API_URL=d},get workerCount(){return rn.workerCount},set workerCount(d){rn.workerCount=d},get maxParallelImageRequests(){return l.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(d){l.config.MAX_PARALLEL_IMAGE_REQUESTS=d},clearStorage(d){l.clearTileCache(d)},workerUrl:"",workerClass:null,setNow:l.exported.setNow,restoreNow:l.exported.restoreNow};return hu}),D}()},937:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{op:()=>Me,$V:()=>Rt,Xd:()=>Dn});var D=fe(7579),N=fe(4968),l=(fe(6451),fe(1566)),oe=fe(4482),lt=fe(8421),At=fe(5403),ct=fe(5963);var Nt=fe(2722),st=(fe(1884),fe(9718),fe(4893)),at=fe(9808);function ft(xe){return getComputedStyle(xe)}function tn(xe,Se){for(var Be in Se){var dt=Se[Be];"number"==typeof dt&&(dt+="px"),xe.style[Be]=dt}return xe}function kt(xe){var Se=document.createElement("div");return Se.className=xe,Se}var dn="undefined"!=typeof Element&&(Element.prototype.matches||Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector);function Qn(xe,Se){if(!dn)throw new Error("No element matching method supported");return dn.call(xe,Se)}function on(xe){xe.remove?xe.remove():xe.parentNode&&xe.parentNode.removeChild(xe)}function Cn(xe,Se){return Array.prototype.filter.call(xe.children,function(Be){return Qn(Be,Se)})}var se_element_thumb=function(xe){return"ps__thumb-"+xe},se_element_rail=function(xe){return"ps__rail-"+xe},se_element_consuming="ps__child--consume",se_state_focus="ps--focus",se_state_clicking="ps--clicking",se_state_active=function(xe){return"ps--active-"+xe},se_state_scrolling=function(xe){return"ps--scrolling-"+xe},Wi={x:null,y:null};function ii(xe,Se){var Be=xe.element.classList,dt=se_state_scrolling(Se);Be.contains(dt)?clearTimeout(Wi[Se]):Be.add(dt)}function kn(xe,Se){Wi[Se]=setTimeout(function(){return xe.isAlive&&xe.element.classList.remove(se_state_scrolling(Se))},xe.settings.scrollingThreshold)}var Jt=function(Se){this.element=Se,this.handlers={}},$t={isEmpty:{configurable:!0}};Jt.prototype.bind=function(Se,Be){void 0===this.handlers[Se]&&(this.handlers[Se]=[]),this.handlers[Se].push(Be),this.element.addEventListener(Se,Be,!1)},Jt.prototype.unbind=function(Se,Be){var dt=this;this.handlers[Se]=this.handlers[Se].filter(function(Pt){return!(!Be||Pt===Be)||(dt.element.removeEventListener(Se,Pt,!1),!1)})},Jt.prototype.unbindAll=function(){for(var Se in this.handlers)this.unbind(Se)},$t.isEmpty.get=function(){var xe=this;return Object.keys(this.handlers).every(function(Se){return 0===xe.handlers[Se].length})},Object.defineProperties(Jt.prototype,$t);var en=function(){this.eventElements=[]};function an(xe){if("function"==typeof window.CustomEvent)return new CustomEvent(xe);var Se=document.createEvent("CustomEvent");return Se.initCustomEvent(xe,!1,!1,void 0),Se}function Yt(xe,Se,Be,dt,Pt){var rn;if(void 0===dt&&(dt=!0),void 0===Pt&&(Pt=!1),"top"===Se)rn=["contentHeight","containerHeight","scrollTop","y","up","down"];else{if("left"!==Se)throw new Error("A proper axis should be provided");rn=["contentWidth","containerWidth","scrollLeft","x","left","right"]}!function An(xe,Se,Be,dt,Pt){var rn=Be[0],un=Be[1],In=Be[2],Pn=Be[3],mi=Be[4],Xn=Be[5];void 0===dt&&(dt=!0),void 0===Pt&&(Pt=!1);var qt=xe.element;xe.reach[Pn]=null,qt[In]<1&&(xe.reach[Pn]="start"),qt[In]>xe[rn]-xe[un]-1&&(xe.reach[Pn]="end"),Se&&(qt.dispatchEvent(an("ps-scroll-"+Pn)),Se<0?qt.dispatchEvent(an("ps-scroll-"+mi)):Se>0&&qt.dispatchEvent(an("ps-scroll-"+Xn)),dt&&function Ci(xe,Se){ii(xe,Se),kn(xe,Se)}(xe,Pn)),xe.reach[Pn]&&(Se||Pt)&&qt.dispatchEvent(an("ps-"+Pn+"-reach-"+xe.reach[Pn]))}(xe,Be,rn,dt,Pt)}function Sn(xe){return parseInt(xe,10)||0}en.prototype.eventElement=function(Se){var Be=this.eventElements.filter(function(dt){return dt.element===Se})[0];return Be||(Be=new Jt(Se),this.eventElements.push(Be)),Be},en.prototype.bind=function(Se,Be,dt){this.eventElement(Se).bind(Be,dt)},en.prototype.unbind=function(Se,Be,dt){var Pt=this.eventElement(Se);Pt.unbind(Be,dt),Pt.isEmpty&&this.eventElements.splice(this.eventElements.indexOf(Pt),1)},en.prototype.unbindAll=function(){this.eventElements.forEach(function(Se){return Se.unbindAll()}),this.eventElements=[]},en.prototype.once=function(Se,Be,dt){var Pt=this.eventElement(Se),rn=function(un){Pt.unbind(Be,rn),dt(un)};Pt.bind(Be,rn)};var wi={isWebKit:"undefined"!=typeof document&&"WebkitAppearance"in document.documentElement.style,supportsTouch:"undefined"!=typeof window&&("ontouchstart"in window||"maxTouchPoints"in window.navigator&&window.navigator.maxTouchPoints>0||window.DocumentTouch&&document instanceof window.DocumentTouch),supportsIePointer:"undefined"!=typeof navigator&&navigator.msMaxTouchPoints,isChrome:"undefined"!=typeof navigator&&/Chrome/i.test(navigator&&navigator.userAgent)};function _i(xe){var Se=xe.element,Be=Math.floor(Se.scrollTop),dt=Se.getBoundingClientRect();xe.containerWidth=Math.ceil(dt.width),xe.containerHeight=Math.ceil(dt.height),xe.contentWidth=Se.scrollWidth,xe.contentHeight=Se.scrollHeight,Se.contains(xe.scrollbarXRail)||(Cn(Se,se_element_rail("x")).forEach(function(Pt){return on(Pt)}),Se.appendChild(xe.scrollbarXRail)),Se.contains(xe.scrollbarYRail)||(Cn(Se,se_element_rail("y")).forEach(function(Pt){return on(Pt)}),Se.appendChild(xe.scrollbarYRail)),!xe.settings.suppressScrollX&&xe.containerWidth+xe.settings.scrollXMarginOffset<xe.contentWidth?(xe.scrollbarXActive=!0,xe.railXWidth=xe.containerWidth-xe.railXMarginWidth,xe.railXRatio=xe.containerWidth/xe.railXWidth,xe.scrollbarXWidth=Ki(xe,Sn(xe.railXWidth*xe.containerWidth/xe.contentWidth)),xe.scrollbarXLeft=Sn((xe.negativeScrollAdjustment+Se.scrollLeft)*(xe.railXWidth-xe.scrollbarXWidth)/(xe.contentWidth-xe.containerWidth))):xe.scrollbarXActive=!1,!xe.settings.suppressScrollY&&xe.containerHeight+xe.settings.scrollYMarginOffset<xe.contentHeight?(xe.scrollbarYActive=!0,xe.railYHeight=xe.containerHeight-xe.railYMarginHeight,xe.railYRatio=xe.containerHeight/xe.railYHeight,xe.scrollbarYHeight=Ki(xe,Sn(xe.railYHeight*xe.containerHeight/xe.contentHeight)),xe.scrollbarYTop=Sn(Be*(xe.railYHeight-xe.scrollbarYHeight)/(xe.contentHeight-xe.containerHeight))):xe.scrollbarYActive=!1,xe.scrollbarXLeft>=xe.railXWidth-xe.scrollbarXWidth&&(xe.scrollbarXLeft=xe.railXWidth-xe.scrollbarXWidth),xe.scrollbarYTop>=xe.railYHeight-xe.scrollbarYHeight&&(xe.scrollbarYTop=xe.railYHeight-xe.scrollbarYHeight),function ui(xe,Se){var Be={width:Se.railXWidth},dt=Math.floor(xe.scrollTop);Be.left=Se.isRtl?Se.negativeScrollAdjustment+xe.scrollLeft+Se.containerWidth-Se.contentWidth:xe.scrollLeft,Se.isScrollbarXUsingBottom?Be.bottom=Se.scrollbarXBottom-dt:Be.top=Se.scrollbarXTop+dt,tn(Se.scrollbarXRail,Be);var Pt={top:dt,height:Se.railYHeight};Se.isScrollbarYUsingRight?Pt.right=Se.isRtl?Se.contentWidth-(Se.negativeScrollAdjustment+xe.scrollLeft)-Se.scrollbarYRight-Se.scrollbarYOuterWidth-9:Se.scrollbarYRight-xe.scrollLeft:Pt.left=Se.isRtl?Se.negativeScrollAdjustment+xe.scrollLeft+2*Se.containerWidth-Se.contentWidth-Se.scrollbarYLeft-Se.scrollbarYOuterWidth:Se.scrollbarYLeft+xe.scrollLeft,tn(Se.scrollbarYRail,Pt),tn(Se.scrollbarX,{left:Se.scrollbarXLeft,width:Se.scrollbarXWidth-Se.railBorderXWidth}),tn(Se.scrollbarY,{top:Se.scrollbarYTop,height:Se.scrollbarYHeight-Se.railBorderYWidth})}(Se,xe),xe.scrollbarXActive?Se.classList.add(se_state_active("x")):(Se.classList.remove(se_state_active("x")),xe.scrollbarXWidth=0,xe.scrollbarXLeft=0,Se.scrollLeft=!0===xe.isRtl?xe.contentWidth:0),xe.scrollbarYActive?Se.classList.add(se_state_active("y")):(Se.classList.remove(se_state_active("y")),xe.scrollbarYHeight=0,xe.scrollbarYTop=0,Se.scrollTop=0)}function Ki(xe,Se){return xe.settings.minScrollbarLength&&(Se=Math.max(Se,xe.settings.minScrollbarLength)),xe.settings.maxScrollbarLength&&(Se=Math.min(Se,xe.settings.maxScrollbarLength)),Se}function yn(xe,Se){var Be=Se[0],dt=Se[1],Pt=Se[2],rn=Se[3],un=Se[4],In=Se[5],Pn=Se[6],mi=Se[7],Xn=Se[8],qt=xe.element,Gr=null,gr=null,Rn=null;function ti(Mr){Mr.touches&&Mr.touches[0]&&(Mr[Pt]=Mr.touches[0].pageY),qt[Pn]=Gr+Rn*(Mr[Pt]-gr),ii(xe,mi),_i(xe),Mr.stopPropagation(),Mr.preventDefault()}function hr(){kn(xe,mi),xe[Xn].classList.remove(se_state_clicking),xe.event.unbind(xe.ownerDocument,"mousemove",ti)}function Er(Mr,Nr){Gr=qt[Pn],Nr&&Mr.touches&&(Mr[Pt]=Mr.touches[0].pageY),gr=Mr[Pt],Rn=(xe[dt]-xe[Be])/(xe[rn]-xe[In]),Nr?xe.event.bind(xe.ownerDocument,"touchmove",ti):(xe.event.bind(xe.ownerDocument,"mousemove",ti),xe.event.once(xe.ownerDocument,"mouseup",hr),Mr.preventDefault()),xe[Xn].classList.add(se_state_clicking),Mr.stopPropagation()}xe.event.bind(xe[un],"mousedown",function(Mr){Er(Mr)}),xe.event.bind(xe[un],"touchstart",function(Mr){Er(Mr,!0)})}var fi={"click-rail":function Ti(xe){xe.event.bind(xe.scrollbarY,"mousedown",function(Be){return Be.stopPropagation()}),xe.event.bind(xe.scrollbarYRail,"mousedown",function(Be){var dt=Be.pageY-window.pageYOffset-xe.scrollbarYRail.getBoundingClientRect().top;xe.element.scrollTop+=(dt>xe.scrollbarYTop?1:-1)*xe.containerHeight,_i(xe),Be.stopPropagation()}),xe.event.bind(xe.scrollbarX,"mousedown",function(Be){return Be.stopPropagation()}),xe.event.bind(xe.scrollbarXRail,"mousedown",function(Be){var dt=Be.pageX-window.pageXOffset-xe.scrollbarXRail.getBoundingClientRect().left;xe.element.scrollLeft+=(dt>xe.scrollbarXLeft?1:-1)*xe.containerWidth,_i(xe),Be.stopPropagation()})},"drag-thumb":function Br(xe){yn(xe,["containerWidth","contentWidth","pageX","railXWidth","scrollbarX","scrollbarXWidth","scrollLeft","x","scrollbarXRail"]),yn(xe,["containerHeight","contentHeight","pageY","railYHeight","scrollbarY","scrollbarYHeight","scrollTop","y","scrollbarYRail"])},keyboard:function oi(xe){var Se=xe.element;xe.event.bind(xe.ownerDocument,"keydown",function(rn){if(!(rn.isDefaultPrevented&&rn.isDefaultPrevented()||rn.defaultPrevented)&&(Qn(Se,":hover")||Qn(xe.scrollbarX,":focus")||Qn(xe.scrollbarY,":focus"))){var un=document.activeElement?document.activeElement:xe.ownerDocument.activeElement;if(un){if("IFRAME"===un.tagName)un=un.contentDocument.activeElement;else for(;un.shadowRoot;)un=un.shadowRoot.activeElement;if(function Mi(xe){return Qn(xe,"input,[contenteditable]")||Qn(xe,"select,[contenteditable]")||Qn(xe,"textarea,[contenteditable]")||Qn(xe,"button,[contenteditable]")}(un))return}var In=0,Pn=0;switch(rn.which){case 37:In=rn.metaKey?-xe.contentWidth:rn.altKey?-xe.containerWidth:-30;break;case 38:Pn=rn.metaKey?xe.contentHeight:rn.altKey?xe.containerHeight:30;break;case 39:In=rn.metaKey?xe.contentWidth:rn.altKey?xe.containerWidth:30;break;case 40:Pn=rn.metaKey?-xe.contentHeight:rn.altKey?-xe.containerHeight:-30;break;case 32:Pn=rn.shiftKey?xe.containerHeight:-xe.containerHeight;break;case 33:Pn=xe.containerHeight;break;case 34:Pn=-xe.containerHeight;break;case 36:Pn=xe.contentHeight;break;case 35:Pn=-xe.contentHeight;break;default:return}xe.settings.suppressScrollX&&0!==In||xe.settings.suppressScrollY&&0!==Pn||(Se.scrollTop-=Pn,Se.scrollLeft+=In,_i(xe),function Pt(rn,un){var In=Math.floor(Se.scrollTop);if(0===rn){if(!xe.scrollbarYActive)return!1;if(0===In&&un>0||In>=xe.contentHeight-xe.containerHeight&&un<0)return!xe.settings.wheelPropagation}var Pn=Se.scrollLeft;if(0===un){if(!xe.scrollbarXActive)return!1;if(0===Pn&&rn<0||Pn>=xe.contentWidth-xe.containerWidth&&rn>0)return!xe.settings.wheelPropagation}return!0}(In,Pn)&&rn.preventDefault())}})},wheel:function Tt(xe){var Se=xe.element;function rn(un){var In=function dt(un){var In=un.deltaX,Pn=-1*un.deltaY;return(void 0===In||void 0===Pn)&&(In=-1*un.wheelDeltaX/6,Pn=un.wheelDeltaY/6),un.deltaMode&&1===un.deltaMode&&(In*=10,Pn*=10),In!=In&&Pn!=Pn&&(In=0,Pn=un.wheelDelta),un.shiftKey?[-Pn,-In]:[In,Pn]}(un),Pn=In[0],mi=In[1];if(!function Pt(un,In,Pn){if(!wi.isWebKit&&Se.querySelector("select:focus"))return!0;if(!Se.contains(un))return!1;for(var mi=un;mi&&mi!==Se;){if(mi.classList.contains(se_element_consuming))return!0;var Xn=ft(mi);if(Pn&&Xn.overflowY.match(/(scroll|auto)/)){var qt=mi.scrollHeight-mi.clientHeight;if(qt>0&&(mi.scrollTop>0&&Pn<0||mi.scrollTop<qt&&Pn>0))return!0}if(In&&Xn.overflowX.match(/(scroll|auto)/)){var Gr=mi.scrollWidth-mi.clientWidth;if(Gr>0&&(mi.scrollLeft>0&&In<0||mi.scrollLeft<Gr&&In>0))return!0}mi=mi.parentNode}return!1}(un.target,Pn,mi)){var Xn=!1;xe.settings.useBothWheelAxes?xe.scrollbarYActive&&!xe.scrollbarXActive?(mi?Se.scrollTop-=mi*xe.settings.wheelSpeed:Se.scrollTop+=Pn*xe.settings.wheelSpeed,Xn=!0):xe.scrollbarXActive&&!xe.scrollbarYActive&&(Pn?Se.scrollLeft+=Pn*xe.settings.wheelSpeed:Se.scrollLeft-=mi*xe.settings.wheelSpeed,Xn=!0):(Se.scrollTop-=mi*xe.settings.wheelSpeed,Se.scrollLeft+=Pn*xe.settings.wheelSpeed),_i(xe),Xn=Xn||function Be(un,In){var Pn=Math.floor(Se.scrollTop),mi=0===Se.scrollTop,Xn=Pn+Se.offsetHeight===Se.scrollHeight,qt=0===Se.scrollLeft,Gr=Se.scrollLeft+Se.offsetWidth===Se.scrollWidth;return!(Math.abs(In)>Math.abs(un)?mi||Xn:qt||Gr)||!xe.settings.wheelPropagation}(Pn,mi),Xn&&!un.ctrlKey&&(un.stopPropagation(),un.preventDefault())}}void 0!==window.onwheel?xe.event.bind(Se,"wheel",rn):void 0!==window.onmousewheel&&xe.event.bind(Se,"mousewheel",rn)},touch:function En(xe){if(wi.supportsTouch||wi.supportsIePointer){var Se=xe.element,Pt={},rn=0,un={},In=null;wi.supportsTouch?(xe.event.bind(Se,"touchstart",Xn),xe.event.bind(Se,"touchmove",Gr),xe.event.bind(Se,"touchend",gr)):wi.supportsIePointer&&(window.PointerEvent?(xe.event.bind(Se,"pointerdown",Xn),xe.event.bind(Se,"pointermove",Gr),xe.event.bind(Se,"pointerup",gr)):window.MSPointerEvent&&(xe.event.bind(Se,"MSPointerDown",Xn),xe.event.bind(Se,"MSPointerMove",Gr),xe.event.bind(Se,"MSPointerUp",gr)))}function dt(Rn,ti){Se.scrollTop-=ti,Se.scrollLeft-=Rn,_i(xe)}function Pn(Rn){return Rn.targetTouches?Rn.targetTouches[0]:Rn}function mi(Rn){return!(Rn.pointerType&&"pen"===Rn.pointerType&&0===Rn.buttons||!(Rn.targetTouches&&1===Rn.targetTouches.length||Rn.pointerType&&"mouse"!==Rn.pointerType&&Rn.pointerType!==Rn.MSPOINTER_TYPE_MOUSE))}function Xn(Rn){if(mi(Rn)){var ti=Pn(Rn);Pt.pageX=ti.pageX,Pt.pageY=ti.pageY,rn=(new Date).getTime(),null!==In&&clearInterval(In)}}function Gr(Rn){if(mi(Rn)){var ti=Pn(Rn),hr={pageX:ti.pageX,pageY:ti.pageY},Er=hr.pageX-Pt.pageX,Mr=hr.pageY-Pt.pageY;if(function qt(Rn,ti,hr){if(!Se.contains(Rn))return!1;for(var Er=Rn;Er&&Er!==Se;){if(Er.classList.contains(se_element_consuming))return!0;var Mr=ft(Er);if(hr&&Mr.overflowY.match(/(scroll|auto)/)){var Nr=Er.scrollHeight-Er.clientHeight;if(Nr>0&&(Er.scrollTop>0&&hr<0||Er.scrollTop<Nr&&hr>0))return!0}if(ti&&Mr.overflowX.match(/(scroll|auto)/)){var Wn=Er.scrollWidth-Er.clientWidth;if(Wn>0&&(Er.scrollLeft>0&&ti<0||Er.scrollLeft<Wn&&ti>0))return!0}Er=Er.parentNode}return!1}(Rn.target,Er,Mr))return;dt(Er,Mr),Pt=hr;var Nr=(new Date).getTime(),Wn=Nr-rn;Wn>0&&(un.x=Er/Wn,un.y=Mr/Wn,rn=Nr),function Be(Rn,ti){var hr=Math.floor(Se.scrollTop),Er=Se.scrollLeft,Mr=Math.abs(Rn),Nr=Math.abs(ti);if(Nr>Mr){if(ti<0&&hr===xe.contentHeight-xe.containerHeight||ti>0&&0===hr)return 0===window.scrollY&&ti>0&&wi.isChrome}else if(Mr>Nr&&(Rn<0&&Er===xe.contentWidth-xe.containerWidth||Rn>0&&0===Er))return!0;return!0}(Er,Mr)&&Rn.preventDefault()}}function gr(){xe.settings.swipeEasing&&(clearInterval(In),In=setInterval(function(){xe.isInitialized?clearInterval(In):un.x||un.y?Math.abs(un.x)<.01&&Math.abs(un.y)<.01?clearInterval(In):(dt(30*un.x,30*un.y),un.x*=.8,un.y*=.8):clearInterval(In)},10))}}},nr=function(Se,Be){var dt=this;if(void 0===Be&&(Be={}),"string"==typeof Se&&(Se=document.querySelector(Se)),!Se||!Se.nodeName)throw new Error("no element is specified to initialize PerfectScrollbar");for(var Pt in this.element=Se,Se.classList.add("ps"),this.settings={handlers:["click-rail","drag-thumb","keyboard","wheel","touch"],maxScrollbarLength:null,minScrollbarLength:null,scrollingThreshold:1e3,scrollXMarginOffset:0,scrollYMarginOffset:0,suppressScrollX:!1,suppressScrollY:!1,swipeEasing:!0,useBothWheelAxes:!1,wheelPropagation:!0,wheelSpeed:1},Be)this.settings[Pt]=Be[Pt];this.containerWidth=null,this.containerHeight=null,this.contentWidth=null,this.contentHeight=null;var Xn,mi,rn=function(){return Se.classList.add(se_state_focus)},un=function(){return Se.classList.remove(se_state_focus)};this.isRtl="rtl"===ft(Se).direction,!0===this.isRtl&&Se.classList.add("ps__rtl"),this.isNegativeScroll=(mi=Se.scrollLeft,Se.scrollLeft=-1,Xn=Se.scrollLeft<0,Se.scrollLeft=mi,Xn),this.negativeScrollAdjustment=this.isNegativeScroll?Se.scrollWidth-Se.clientWidth:0,this.event=new en,this.ownerDocument=Se.ownerDocument||document,this.scrollbarXRail=kt(se_element_rail("x")),Se.appendChild(this.scrollbarXRail),this.scrollbarX=kt(se_element_thumb("x")),this.scrollbarXRail.appendChild(this.scrollbarX),this.scrollbarX.setAttribute("tabindex",0),this.event.bind(this.scrollbarX,"focus",rn),this.event.bind(this.scrollbarX,"blur",un),this.scrollbarXActive=null,this.scrollbarXWidth=null,this.scrollbarXLeft=null;var In=ft(this.scrollbarXRail);this.scrollbarXBottom=parseInt(In.bottom,10),isNaN(this.scrollbarXBottom)?(this.isScrollbarXUsingBottom=!1,this.scrollbarXTop=Sn(In.top)):this.isScrollbarXUsingBottom=!0,this.railBorderXWidth=Sn(In.borderLeftWidth)+Sn(In.borderRightWidth),tn(this.scrollbarXRail,{display:"block"}),this.railXMarginWidth=Sn(In.marginLeft)+Sn(In.marginRight),tn(this.scrollbarXRail,{display:""}),this.railXWidth=null,this.railXRatio=null,this.scrollbarYRail=kt(se_element_rail("y")),Se.appendChild(this.scrollbarYRail),this.scrollbarY=kt(se_element_thumb("y")),this.scrollbarYRail.appendChild(this.scrollbarY),this.scrollbarY.setAttribute("tabindex",0),this.event.bind(this.scrollbarY,"focus",rn),this.event.bind(this.scrollbarY,"blur",un),this.scrollbarYActive=null,this.scrollbarYHeight=null,this.scrollbarYTop=null;var Pn=ft(this.scrollbarYRail);this.scrollbarYRight=parseInt(Pn.right,10),isNaN(this.scrollbarYRight)?(this.isScrollbarYUsingRight=!1,this.scrollbarYLeft=Sn(Pn.left)):this.isScrollbarYUsingRight=!0,this.scrollbarYOuterWidth=this.isRtl?function mr(xe){var Se=ft(xe);return Sn(Se.width)+Sn(Se.paddingLeft)+Sn(Se.paddingRight)+Sn(Se.borderLeftWidth)+Sn(Se.borderRightWidth)}(this.scrollbarY):null,this.railBorderYWidth=Sn(Pn.borderTopWidth)+Sn(Pn.borderBottomWidth),tn(this.scrollbarYRail,{display:"block"}),this.railYMarginHeight=Sn(Pn.marginTop)+Sn(Pn.marginBottom),tn(this.scrollbarYRail,{display:""}),this.railYHeight=null,this.railYRatio=null,this.reach={x:Se.scrollLeft<=0?"start":Se.scrollLeft>=this.contentWidth-this.containerWidth?"end":null,y:Se.scrollTop<=0?"start":Se.scrollTop>=this.contentHeight-this.containerHeight?"end":null},this.isAlive=!0,this.settings.handlers.forEach(function(mi){return fi[mi](dt)}),this.lastScrollTop=Math.floor(Se.scrollTop),this.lastScrollLeft=Se.scrollLeft,this.event.bind(this.element,"scroll",function(mi){return dt.onScroll(mi)}),_i(this)};nr.prototype.update=function(){!this.isAlive||(this.negativeScrollAdjustment=this.isNegativeScroll?this.element.scrollWidth-this.element.clientWidth:0,tn(this.scrollbarXRail,{display:"block"}),tn(this.scrollbarYRail,{display:"block"}),this.railXMarginWidth=Sn(ft(this.scrollbarXRail).marginLeft)+Sn(ft(this.scrollbarXRail).marginRight),this.railYMarginHeight=Sn(ft(this.scrollbarYRail).marginTop)+Sn(ft(this.scrollbarYRail).marginBottom),tn(this.scrollbarXRail,{display:"none"}),tn(this.scrollbarYRail,{display:"none"}),_i(this),Yt(this,"top",0,!1,!0),Yt(this,"left",0,!1,!0),tn(this.scrollbarXRail,{display:""}),tn(this.scrollbarYRail,{display:""}))},nr.prototype.onScroll=function(Se){!this.isAlive||(_i(this),Yt(this,"top",this.element.scrollTop-this.lastScrollTop),Yt(this,"left",this.element.scrollLeft-this.lastScrollLeft),this.lastScrollTop=Math.floor(this.element.scrollTop),this.lastScrollLeft=this.element.scrollLeft)},nr.prototype.destroy=function(){!this.isAlive||(this.event.unbindAll(),on(this.scrollbarX),on(this.scrollbarY),on(this.scrollbarXRail),on(this.scrollbarYRail),this.removePsClasses(),this.element=null,this.scrollbarX=null,this.scrollbarY=null,this.scrollbarXRail=null,this.scrollbarYRail=null,this.isAlive=!1)},nr.prototype.removePsClasses=function(){this.element.className=this.element.className.split(" ").filter(function(Se){return!Se.match(/^ps([-_].+|)$/)}).join(" ")};const Tr=nr;var Zr=function(){if("undefined"!=typeof Map)return Map;function xe(Se,Be){var dt=-1;return Se.some(function(Pt,rn){return Pt[0]===Be&&(dt=rn,!0)}),dt}return function(){function Se(){this.__entries__=[]}return Object.defineProperty(Se.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),Se.prototype.get=function(Be){var dt=xe(this.__entries__,Be),Pt=this.__entries__[dt];return Pt&&Pt[1]},Se.prototype.set=function(Be,dt){var Pt=xe(this.__entries__,Be);~Pt?this.__entries__[Pt][1]=dt:this.__entries__.push([Be,dt])},Se.prototype.delete=function(Be){var dt=this.__entries__,Pt=xe(dt,Be);~Pt&&dt.splice(Pt,1)},Se.prototype.has=function(Be){return!!~xe(this.__entries__,Be)},Se.prototype.clear=function(){this.__entries__.splice(0)},Se.prototype.forEach=function(Be,dt){void 0===dt&&(dt=null);for(var Pt=0,rn=this.__entries__;Pt<rn.length;Pt++){var un=rn[Pt];Be.call(dt,un[1],un[0])}},Se}()}(),Ur="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,Mn="undefined"!=typeof global&&global.Math===Math?global:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),yo="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(Mn):function(xe){return setTimeout(function(){return xe(Date.now())},1e3/60)},cs=["top","right","bottom","left","width","height","size","weight"],cn="undefined"!=typeof MutationObserver,Ot=function(){function xe(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function no(xe,Se){var Be=!1,dt=!1,Pt=0;function rn(){Be&&(Be=!1,xe()),dt&&In()}function un(){yo(rn)}function In(){var Pn=Date.now();if(Be){if(Pn-Pt<2)return;dt=!0}else Be=!0,dt=!1,setTimeout(un,Se);Pt=Pn}return In}(this.refresh.bind(this),20)}return xe.prototype.addObserver=function(Se){~this.observers_.indexOf(Se)||this.observers_.push(Se),this.connected_||this.connect_()},xe.prototype.removeObserver=function(Se){var Be=this.observers_,dt=Be.indexOf(Se);~dt&&Be.splice(dt,1),!Be.length&&this.connected_&&this.disconnect_()},xe.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},xe.prototype.updateObservers_=function(){var Se=this.observers_.filter(function(Be){return Be.gatherActive(),Be.hasActive()});return Se.forEach(function(Be){return Be.broadcastActive()}),Se.length>0},xe.prototype.connect_=function(){!Ur||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),cn?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},xe.prototype.disconnect_=function(){!Ur||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},xe.prototype.onTransitionEnd_=function(Se){var Be=Se.propertyName,dt=void 0===Be?"":Be;cs.some(function(rn){return!!~dt.indexOf(rn)})&&this.refresh()},xe.getInstance=function(){return this.instance_||(this.instance_=new xe),this.instance_},xe.instance_=null,xe}(),Dt=function(xe,Se){for(var Be=0,dt=Object.keys(Se);Be<dt.length;Be++){var Pt=dt[Be];Object.defineProperty(xe,Pt,{value:Se[Pt],enumerable:!1,writable:!1,configurable:!0})}return xe},Nn=function(xe){return xe&&xe.ownerDocument&&xe.ownerDocument.defaultView||Mn},nn=fr(0,0,0,0);function jn(xe){return parseFloat(xe)||0}function pi(xe){for(var Se=[],Be=1;Be<arguments.length;Be++)Se[Be-1]=arguments[Be];return Se.reduce(function(dt,Pt){return dt+jn(xe["border-"+Pt+"-width"])},0)}var Vr="undefined"!=typeof SVGGraphicsElement?function(xe){return xe instanceof Nn(xe).SVGGraphicsElement}:function(xe){return xe instanceof Nn(xe).SVGElement&&"function"==typeof xe.getBBox};function vo(xe){return Ur?Vr(xe)?function Li(xe){var Se=xe.getBBox();return fr(0,0,Se.width,Se.height)}(xe):function $r(xe){var Se=xe.clientWidth,Be=xe.clientHeight;if(!Se&&!Be)return nn;var dt=Nn(xe).getComputedStyle(xe),Pt=function to(xe){for(var Be={},dt=0,Pt=["top","right","bottom","left"];dt<Pt.length;dt++){var rn=Pt[dt];Be[rn]=jn(xe["padding-"+rn])}return Be}(dt),rn=Pt.left+Pt.right,un=Pt.top+Pt.bottom,In=jn(dt.width),Pn=jn(dt.height);if("border-box"===dt.boxSizing&&(Math.round(In+rn)!==Se&&(In-=pi(dt,"left","right")+rn),Math.round(Pn+un)!==Be&&(Pn-=pi(dt,"top","bottom")+un)),!function fo(xe){return xe===Nn(xe).document.documentElement}(xe)){var mi=Math.round(In+rn)-Se,Xn=Math.round(Pn+un)-Be;1!==Math.abs(mi)&&(In-=mi),1!==Math.abs(Xn)&&(Pn-=Xn)}return fr(Pt.left,Pt.top,In,Pn)}(xe):nn}function fr(xe,Se,Be,dt){return{x:xe,y:Se,width:Be,height:dt}}var sr=function(){function xe(Se){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=fr(0,0,0,0),this.target=Se}return xe.prototype.isActive=function(){var Se=vo(this.target);return this.contentRect_=Se,Se.width!==this.broadcastWidth||Se.height!==this.broadcastHeight},xe.prototype.broadcastRect=function(){var Se=this.contentRect_;return this.broadcastWidth=Se.width,this.broadcastHeight=Se.height,Se},xe}(),Io=function xe(Se,Be){var dt=function ei(xe){var Se=xe.x,Be=xe.y,dt=xe.width,Pt=xe.height,rn="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,un=Object.create(rn.prototype);return Dt(un,{x:Se,y:Be,width:dt,height:Pt,top:Be,right:Se+dt,bottom:Pt+Be,left:Se}),un}(Be);Dt(this,{target:Se,contentRect:dt})},ir=function(){function xe(Se,Be,dt){if(this.activeObservations_=[],this.observations_=new Zr,"function"!=typeof Se)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=Se,this.controller_=Be,this.callbackCtx_=dt}return xe.prototype.observe=function(Se){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(Se instanceof Nn(Se).Element))throw new TypeError('parameter 1 is not of type "Element".');var Be=this.observations_;Be.has(Se)||(Be.set(Se,new sr(Se)),this.controller_.addObserver(this),this.controller_.refresh())}},xe.prototype.unobserve=function(Se){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(Se instanceof Nn(Se).Element))throw new TypeError('parameter 1 is not of type "Element".');var Be=this.observations_;!Be.has(Se)||(Be.delete(Se),Be.size||this.controller_.removeObserver(this))}},xe.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},xe.prototype.gatherActive=function(){var Se=this;this.clearActive(),this.observations_.forEach(function(Be){Be.isActive()&&Se.activeObservations_.push(Be)})},xe.prototype.broadcastActive=function(){if(this.hasActive()){var Se=this.callbackCtx_,Be=this.activeObservations_.map(function(dt){return new Io(dt.target,dt.broadcastRect())});this.callback_.call(Se,Be,Se),this.clearActive()}},xe.prototype.clearActive=function(){this.activeObservations_.splice(0)},xe.prototype.hasActive=function(){return this.activeObservations_.length>0},xe}(),Ao="undefined"!=typeof WeakMap?new WeakMap:new Zr,Zo=function xe(Se){if(!(this instanceof xe))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var Be=Ot.getInstance(),dt=new ir(Se,Be,this);Ao.set(this,dt)};["observe","unobserve","disconnect"].forEach(function(xe){Zo.prototype[xe]=function(){var Se;return(Se=Ao.get(this))[xe].apply(Se,arguments)}});const Ds=void 0!==Mn.ResizeObserver?Mn.ResizeObserver:Zo,Me=new st.OlP("PERFECT_SCROLLBAR_CONFIG");class We{constructor(Se,Be,dt,Pt){this.x=Se,this.y=Be,this.w=dt,this.h=Pt}}class Xe{constructor(Se,Be){this.x=Se,this.y=Be}}const xt=["psScrollY","psScrollX","psScrollUp","psScrollDown","psScrollLeft","psScrollRight","psYReachEnd","psYReachStart","psXReachEnd","psXReachStart"];class Gt{constructor(Se={}){this.assign(Se)}assign(Se={}){for(const Be in Se)this[Be]=Se[Be]}}let Rt=(()=>{class xe{constructor(Be,dt,Pt,rn,un){this.zone=Be,this.differs=dt,this.elementRef=Pt,this.platformId=rn,this.defaults=un,this.instance=null,this.ro=null,this.timeout=null,this.animation=null,this.configDiff=null,this.ngDestroy=new D.x,this.disabled=!1,this.psScrollY=new st.vpe,this.psScrollX=new st.vpe,this.psScrollUp=new st.vpe,this.psScrollDown=new st.vpe,this.psScrollLeft=new st.vpe,this.psScrollRight=new st.vpe,this.psYReachEnd=new st.vpe,this.psYReachStart=new st.vpe,this.psXReachEnd=new st.vpe,this.psXReachStart=new st.vpe}ngOnInit(){if(!this.disabled&&(0,at.NF)(this.platformId)){const Be=new Gt(this.defaults);Be.assign(this.config),this.zone.runOutsideAngular(()=>{this.instance=new Tr(this.elementRef.nativeElement,Be)}),this.configDiff||(this.configDiff=this.differs.find(this.config||{}).create(),this.configDiff.diff(this.config||{})),this.zone.runOutsideAngular(()=>{this.ro=new Ds(()=>{this.update()}),this.elementRef.nativeElement.children[0]&&this.ro.observe(this.elementRef.nativeElement.children[0]),this.ro.observe(this.elementRef.nativeElement)}),this.zone.runOutsideAngular(()=>{xt.forEach(dt=>{const Pt=dt.replace(/([A-Z])/g,rn=>`-${rn.toLowerCase()}`);(0,N.R)(this.elementRef.nativeElement,Pt).pipe(function _t(xe,Se=l.z){return function Ke(xe){return(0,oe.e)((Se,Be)=>{let dt=!1,Pt=null,rn=null,un=!1;const In=()=>{if(null==rn||rn.unsubscribe(),rn=null,dt){dt=!1;const mi=Pt;Pt=null,Be.next(mi)}un&&Be.complete()},Pn=()=>{rn=null,un&&Be.complete()};Se.subscribe((0,At.x)(Be,mi=>{dt=!0,Pt=mi,rn||(0,lt.Xf)(xe(mi)).subscribe(rn=(0,At.x)(Be,In,Pn))},()=>{un=!0,(!dt||!rn||rn.closed)&&Be.complete()}))})}(()=>(0,ct.H)(xe,Se))}(20),(0,Nt.R)(this.ngDestroy)).subscribe(rn=>{this[dt].emit(rn)})})})}}ngOnDestroy(){(0,at.NF)(this.platformId)&&(this.ngDestroy.next(),this.ngDestroy.complete(),this.ro&&this.ro.disconnect(),this.timeout&&"undefined"!=typeof window&&window.clearTimeout(this.timeout),this.zone.runOutsideAngular(()=>{this.instance&&this.instance.destroy()}),this.instance=null)}ngDoCheck(){!this.disabled&&this.configDiff&&(0,at.NF)(this.platformId)&&this.configDiff.diff(this.config||{})&&(this.ngOnDestroy(),this.ngOnInit())}ngOnChanges(Be){Be.disabled&&!Be.disabled.isFirstChange()&&(0,at.NF)(this.platformId)&&Be.disabled.currentValue!==Be.disabled.previousValue&&(!0===Be.disabled.currentValue?this.ngOnDestroy():!1===Be.disabled.currentValue&&this.ngOnInit())}ps(){return this.instance}update(){"undefined"!=typeof window&&(this.timeout&&window.clearTimeout(this.timeout),this.timeout=window.setTimeout(()=>{if(!this.disabled&&this.configDiff)try{this.zone.runOutsideAngular(()=>{this.instance&&this.instance.update()})}catch(Be){}},0))}geometry(Be="scroll"){return new We(this.elementRef.nativeElement[Be+"Left"],this.elementRef.nativeElement[Be+"Top"],this.elementRef.nativeElement[Be+"Width"],this.elementRef.nativeElement[Be+"Height"])}position(Be=!1){return!Be&&this.instance?new Xe(this.instance.reach.x||0,this.instance.reach.y||0):new Xe(this.elementRef.nativeElement.scrollLeft,this.elementRef.nativeElement.scrollTop)}scrollable(Be="any"){const dt=this.elementRef.nativeElement;return"any"===Be?dt.classList.contains("ps--active-x")||dt.classList.contains("ps--active-y"):"both"===Be?dt.classList.contains("ps--active-x")&&dt.classList.contains("ps--active-y"):dt.classList.contains("ps--active-"+Be)}scrollTo(Be,dt,Pt){this.disabled||(null==dt&&null==Pt?this.animateScrolling("scrollTop",Be,Pt):(null!=Be&&this.animateScrolling("scrollLeft",Be,Pt),null!=dt&&this.animateScrolling("scrollTop",dt,Pt)))}scrollToX(Be,dt){this.animateScrolling("scrollLeft",Be,dt)}scrollToY(Be,dt){this.animateScrolling("scrollTop",Be,dt)}scrollToTop(Be,dt){this.animateScrolling("scrollTop",Be||0,dt)}scrollToLeft(Be,dt){this.animateScrolling("scrollLeft",Be||0,dt)}scrollToRight(Be,dt){this.animateScrolling("scrollLeft",this.elementRef.nativeElement.scrollWidth-this.elementRef.nativeElement.clientWidth-(Be||0),dt)}scrollToBottom(Be,dt){this.animateScrolling("scrollTop",this.elementRef.nativeElement.scrollHeight-this.elementRef.nativeElement.clientHeight-(Be||0),dt)}scrollToElement(Be,dt,Pt){if("string"==typeof Be&&(Be=this.elementRef.nativeElement.querySelector(Be)),Be){const rn=Be.getBoundingClientRect(),un=this.elementRef.nativeElement.getBoundingClientRect();this.elementRef.nativeElement.classList.contains("ps--active-x")&&this.animateScrolling("scrollLeft",rn.left-un.left+this.elementRef.nativeElement.scrollLeft+(dt||0),Pt),this.elementRef.nativeElement.classList.contains("ps--active-y")&&this.animateScrolling("scrollTop",rn.top-un.top+this.elementRef.nativeElement.scrollTop+(dt||0),Pt)}}animateScrolling(Be,dt,Pt){if(this.animation&&(window.cancelAnimationFrame(this.animation),this.animation=null),Pt&&"undefined"!=typeof window){if(dt!==this.elementRef.nativeElement[Be]){let rn=0,un=0,In=performance.now(),Pn=this.elementRef.nativeElement[Be];const mi=(Pn-dt)/2,Xn=qt=>{un+=Math.PI/(Pt/(qt-In)),rn=Math.round(dt+mi+mi*Math.cos(un)),this.elementRef.nativeElement[Be]===Pn&&(un>=Math.PI?this.animateScrolling(Be,dt,0):(this.elementRef.nativeElement[Be]=rn,Pn=this.elementRef.nativeElement[Be],In=qt,this.animation=window.requestAnimationFrame(Xn)))};window.requestAnimationFrame(Xn)}}else this.elementRef.nativeElement[Be]=dt}}return xe.\u0275fac=function(Be){return new(Be||xe)(st.Y36(st.R0b),st.Y36(st.aQg),st.Y36(st.SBq),st.Y36(st.Lbi),st.Y36(Me,8))},xe.\u0275dir=st.lG2({type:xe,selectors:[["","perfectScrollbar",""]],inputs:{disabled:"disabled",config:["perfectScrollbar","config"]},outputs:{psScrollY:"psScrollY",psScrollX:"psScrollX",psScrollUp:"psScrollUp",psScrollDown:"psScrollDown",psScrollLeft:"psScrollLeft",psScrollRight:"psScrollRight",psYReachEnd:"psYReachEnd",psYReachStart:"psYReachStart",psXReachEnd:"psXReachEnd",psXReachStart:"psXReachStart"},exportAs:["ngxPerfectScrollbar"],features:[st.TTD]}),xe})(),Dn=(()=>{class xe{}return xe.\u0275fac=function(Be){return new(Be||xe)},xe.\u0275mod=st.oAB({type:xe}),xe.\u0275inj=st.cJS({imports:[[at.ez],at.ez]}),xe})()},1135:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{X:()=>N});var D=fe(7579);class N extends D.x{constructor(l){super(),this._value=l}get value(){return this.getValue()}_subscribe(l){const oe=super._subscribe(l);return!oe.closed&&l.next(this._value),oe}getValue(){const{hasError:l,thrownError:oe,_value:lt}=this;if(l)throw oe;return this._throwIfClosed(),lt}next(l){super.next(this._value=l)}}},8306:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{y:()=>_t});var D=fe(930),N=fe(727),A=fe(8822),l=fe(4671);var At=fe(2416),Ke=fe(576),ct=fe(2806);let _t=(()=>{class st{constructor(ft){ft&&(this._subscribe=ft)}lift(ft){const tn=new st;return tn.source=this,tn.operator=ft,tn}subscribe(ft,tn,kt){const dn=function Bt(st){return st&&st instanceof D.Lv||function wt(st){return st&&(0,Ke.m)(st.next)&&(0,Ke.m)(st.error)&&(0,Ke.m)(st.complete)}(st)&&(0,N.Nn)(st)}(ft)?ft:new D.Hp(ft,tn,kt);return(0,ct.x)(()=>{const{operator:Qn,source:on}=this;dn.add(Qn?Qn.call(dn,on):on?this._subscribe(dn):this._trySubscribe(dn))}),dn}_trySubscribe(ft){try{return this._subscribe(ft)}catch(tn){ft.error(tn)}}forEach(ft,tn){return new(tn=Nt(tn))((kt,dn)=>{const Qn=new D.Hp({next:on=>{try{ft(on)}catch(Cn){dn(Cn),Qn.unsubscribe()}},error:dn,complete:kt});this.subscribe(Qn)})}_subscribe(ft){var tn;return null===(tn=this.source)||void 0===tn?void 0:tn.subscribe(ft)}[A.L](){return this}pipe(...ft){return function lt(st){return 0===st.length?l.y:1===st.length?st[0]:function(ft){return st.reduce((tn,kt)=>kt(tn),ft)}}(ft)(this)}toPromise(ft){return new(ft=Nt(ft))((tn,kt)=>{let dn;this.subscribe(Qn=>dn=Qn,Qn=>kt(Qn),()=>tn(dn))})}}return st.create=at=>new st(at),st})();function Nt(st){var at;return null!==(at=null!=st?st:At.v.Promise)&&void 0!==at?at:Promise}},7579:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{x:()=>At});var D=fe(8306),N=fe(727);const l=(0,fe(3888).d)(ct=>function(){ct(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var oe=fe(8737),lt=fe(2806);let At=(()=>{class ct extends D.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(Nt){const wt=new Ke(this,this);return wt.operator=Nt,wt}_throwIfClosed(){if(this.closed)throw new l}next(Nt){(0,lt.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const wt of this.currentObservers)wt.next(Nt)}})}error(Nt){(0,lt.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=Nt;const{observers:wt}=this;for(;wt.length;)wt.shift().error(Nt)}})}complete(){(0,lt.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:Nt}=this;for(;Nt.length;)Nt.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var Nt;return(null===(Nt=this.observers)||void 0===Nt?void 0:Nt.length)>0}_trySubscribe(Nt){return this._throwIfClosed(),super._trySubscribe(Nt)}_subscribe(Nt){return this._throwIfClosed(),this._checkFinalizedStatuses(Nt),this._innerSubscribe(Nt)}_innerSubscribe(Nt){const{hasError:wt,isStopped:Bt,observers:st}=this;return wt||Bt?N.Lc:(this.currentObservers=null,st.push(Nt),new N.w0(()=>{this.currentObservers=null,(0,oe.P)(st,Nt)}))}_checkFinalizedStatuses(Nt){const{hasError:wt,thrownError:Bt,isStopped:st}=this;wt?Nt.error(Bt):st&&Nt.complete()}asObservable(){const Nt=new D.y;return Nt.source=this,Nt}}return ct.create=(_t,Nt)=>new Ke(_t,Nt),ct})();class Ke extends At{constructor(_t,Nt){super(),this.destination=_t,this.source=Nt}next(_t){var Nt,wt;null===(wt=null===(Nt=this.destination)||void 0===Nt?void 0:Nt.next)||void 0===wt||wt.call(Nt,_t)}error(_t){var Nt,wt;null===(wt=null===(Nt=this.destination)||void 0===Nt?void 0:Nt.error)||void 0===wt||wt.call(Nt,_t)}complete(){var _t,Nt;null===(Nt=null===(_t=this.destination)||void 0===_t?void 0:_t.complete)||void 0===Nt||Nt.call(_t)}_subscribe(_t){var Nt,wt;return null!==(wt=null===(Nt=this.source)||void 0===Nt?void 0:Nt.subscribe(_t))&&void 0!==wt?wt:N.Lc}}},930:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{Hp:()=>ft,Lv:()=>wt});var D=fe(576),N=fe(727),A=fe(2416),l=fe(7849),oe=fe(5032);const lt=ct("C",void 0,void 0);function ct(on,Cn,se){return{kind:on,value:Cn,error:se}}var _t=fe(3410),Nt=fe(2806);class wt extends N.w0{constructor(Cn){super(),this.isStopped=!1,Cn?(this.destination=Cn,(0,N.Nn)(Cn)&&Cn.add(this)):this.destination=Qn}static create(Cn,se,Wi){return new ft(Cn,se,Wi)}next(Cn){this.isStopped?dn(function Ke(on){return ct("N",on,void 0)}(Cn),this):this._next(Cn)}error(Cn){this.isStopped?dn(function At(on){return ct("E",void 0,on)}(Cn),this):(this.isStopped=!0,this._error(Cn))}complete(){this.isStopped?dn(lt,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(Cn){this.destination.next(Cn)}_error(Cn){try{this.destination.error(Cn)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Bt=Function.prototype.bind;function st(on,Cn){return Bt.call(on,Cn)}class at{constructor(Cn){this.partialObserver=Cn}next(Cn){const{partialObserver:se}=this;if(se.next)try{se.next(Cn)}catch(Wi){tn(Wi)}}error(Cn){const{partialObserver:se}=this;if(se.error)try{se.error(Cn)}catch(Wi){tn(Wi)}else tn(Cn)}complete(){const{partialObserver:Cn}=this;if(Cn.complete)try{Cn.complete()}catch(se){tn(se)}}}class ft extends wt{constructor(Cn,se,Wi){let ii;if(super(),(0,D.m)(Cn)||!Cn)ii={next:null!=Cn?Cn:void 0,error:null!=se?se:void 0,complete:null!=Wi?Wi:void 0};else{let kn;this&&A.v.useDeprecatedNextContext?(kn=Object.create(Cn),kn.unsubscribe=()=>this.unsubscribe(),ii={next:Cn.next&&st(Cn.next,kn),error:Cn.error&&st(Cn.error,kn),complete:Cn.complete&&st(Cn.complete,kn)}):ii=Cn}this.destination=new at(ii)}}function tn(on){A.v.useDeprecatedSynchronousErrorHandling?(0,Nt.O)(on):(0,l.h)(on)}function dn(on,Cn){const{onStoppedNotification:se}=A.v;se&&_t.z.setTimeout(()=>se(on,Cn))}const Qn={closed:!0,next:oe.Z,error:function kt(on){throw on},complete:oe.Z}},727:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{Lc:()=>lt,w0:()=>oe,Nn:()=>At});var D=fe(576);const A=(0,fe(3888).d)(ct=>function(Nt){ct(this),this.message=Nt?`${Nt.length} errors occurred during unsubscription:\n${Nt.map((wt,Bt)=>`${Bt+1}) ${wt.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=Nt});var l=fe(8737);class oe{constructor(_t){this.initialTeardown=_t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let _t;if(!this.closed){this.closed=!0;const{_parentage:Nt}=this;if(Nt)if(this._parentage=null,Array.isArray(Nt))for(const st of Nt)st.remove(this);else Nt.remove(this);const{initialTeardown:wt}=this;if((0,D.m)(wt))try{wt()}catch(st){_t=st instanceof A?st.errors:[st]}const{_finalizers:Bt}=this;if(Bt){this._finalizers=null;for(const st of Bt)try{Ke(st)}catch(at){_t=null!=_t?_t:[],at instanceof A?_t=[..._t,...at.errors]:_t.push(at)}}if(_t)throw new A(_t)}}add(_t){var Nt;if(_t&&_t!==this)if(this.closed)Ke(_t);else{if(_t instanceof oe){if(_t.closed||_t._hasParent(this))return;_t._addParent(this)}(this._finalizers=null!==(Nt=this._finalizers)&&void 0!==Nt?Nt:[]).push(_t)}}_hasParent(_t){const{_parentage:Nt}=this;return Nt===_t||Array.isArray(Nt)&&Nt.includes(_t)}_addParent(_t){const{_parentage:Nt}=this;this._parentage=Array.isArray(Nt)?(Nt.push(_t),Nt):Nt?[Nt,_t]:_t}_removeParent(_t){const{_parentage:Nt}=this;Nt===_t?this._parentage=null:Array.isArray(Nt)&&(0,l.P)(Nt,_t)}remove(_t){const{_finalizers:Nt}=this;Nt&&(0,l.P)(Nt,_t),_t instanceof oe&&_t._removeParent(this)}}oe.EMPTY=(()=>{const ct=new oe;return ct.closed=!0,ct})();const lt=oe.EMPTY;function At(ct){return ct instanceof oe||ct&&"closed"in ct&&(0,D.m)(ct.remove)&&(0,D.m)(ct.add)&&(0,D.m)(ct.unsubscribe)}function Ke(ct){(0,D.m)(ct)?ct():ct.unsubscribe()}},2416:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{v:()=>D});const D={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},9841:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{a:()=>_t});var D=fe(8306),N=fe(4742),A=fe(2076),l=fe(4671),oe=fe(3268),lt=fe(3269),At=fe(8089),Ke=fe(5403),ct=fe(9672);function _t(...Bt){const st=(0,lt.yG)(Bt),at=(0,lt.jO)(Bt),{args:ft,keys:tn}=(0,N.D)(Bt);if(0===ft.length)return(0,A.D)([],st);const kt=new D.y(function Nt(Bt,st,at=l.y){return ft=>{wt(st,()=>{const{length:tn}=Bt,kt=new Array(tn);let dn=tn,Qn=tn;for(let on=0;on<tn;on++)wt(st,()=>{const Cn=(0,A.D)(Bt[on],st);let se=!1;Cn.subscribe((0,Ke.x)(ft,Wi=>{kt[on]=Wi,se||(se=!0,Qn--),Qn||ft.next(at(kt.slice()))},()=>{--dn||ft.complete()}))},ft)},ft)}}(ft,st,tn?dn=>(0,At.n)(tn,dn):l.y));return at?kt.pipe((0,oe.Z)(at)):kt}function wt(Bt,st,at){Bt?(0,ct.f)(at,Bt,st):st()}},7272:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{z:()=>oe});var D=fe(8189),A=fe(3269),l=fe(2076);function oe(...lt){return function N(){return(0,D.J)(1)}()((0,l.D)(lt,(0,A.yG)(lt)))}},515:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{E:()=>N});const N=new(fe(8306).y)(oe=>oe.complete())},4128:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{D:()=>Ke});var D=fe(8306),N=fe(4742),A=fe(8421),l=fe(3269),oe=fe(5403),lt=fe(3268),At=fe(8089);function Ke(...ct){const _t=(0,l.jO)(ct),{args:Nt,keys:wt}=(0,N.D)(ct),Bt=new D.y(st=>{const{length:at}=Nt;if(!at)return void st.complete();const ft=new Array(at);let tn=at,kt=at;for(let dn=0;dn<at;dn++){let Qn=!1;(0,A.Xf)(Nt[dn]).subscribe((0,oe.x)(st,on=>{Qn||(Qn=!0,kt--),ft[dn]=on},()=>tn--,void 0,()=>{(!tn||!Qn)&&(kt||st.next(wt?(0,At.n)(wt,ft):ft),st.complete())}))}});return _t?Bt.pipe((0,lt.Z)(_t)):Bt}},2076:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{D:()=>Wi});var D=fe(8421),N=fe(9672),A=fe(4482),l=fe(5403);function oe(ii,kn=0){return(0,A.e)((Ci,Jt)=>{Ci.subscribe((0,l.x)(Jt,$t=>(0,N.f)(Jt,ii,()=>Jt.next($t),kn),()=>(0,N.f)(Jt,ii,()=>Jt.complete(),kn),$t=>(0,N.f)(Jt,ii,()=>Jt.error($t),kn)))})}function lt(ii,kn=0){return(0,A.e)((Ci,Jt)=>{Jt.add(ii.schedule(()=>Ci.subscribe(Jt),kn))})}var ct=fe(8306),Nt=fe(2202),wt=fe(576);function st(ii,kn){if(!ii)throw new Error("Iterable cannot be null");return new ct.y(Ci=>{(0,N.f)(Ci,kn,()=>{const Jt=ii[Symbol.asyncIterator]();(0,N.f)(Ci,kn,()=>{Jt.next().then($t=>{$t.done?Ci.complete():Ci.next($t.value)})},0,!0)})})}var at=fe(3670),ft=fe(8239),tn=fe(1144),kt=fe(6495),dn=fe(2206),Qn=fe(4532),on=fe(3260);function Wi(ii,kn){return kn?function se(ii,kn){if(null!=ii){if((0,at.c)(ii))return function At(ii,kn){return(0,D.Xf)(ii).pipe(lt(kn),oe(kn))}(ii,kn);if((0,tn.z)(ii))return function _t(ii,kn){return new ct.y(Ci=>{let Jt=0;return kn.schedule(function(){Jt===ii.length?Ci.complete():(Ci.next(ii[Jt++]),Ci.closed||this.schedule())})})}(ii,kn);if((0,ft.t)(ii))return function Ke(ii,kn){return(0,D.Xf)(ii).pipe(lt(kn),oe(kn))}(ii,kn);if((0,dn.D)(ii))return st(ii,kn);if((0,kt.T)(ii))return function Bt(ii,kn){return new ct.y(Ci=>{let Jt;return(0,N.f)(Ci,kn,()=>{Jt=ii[Nt.h](),(0,N.f)(Ci,kn,()=>{let $t,en;try{({value:$t,done:en}=Jt.next())}catch(an){return void Ci.error(an)}en?Ci.complete():Ci.next($t)},0,!0)}),()=>(0,wt.m)(null==Jt?void 0:Jt.return)&&Jt.return()})}(ii,kn);if((0,on.L)(ii))return function Cn(ii,kn){return st((0,on.Q)(ii),kn)}(ii,kn)}throw(0,Qn.z)(ii)}(ii,kn):(0,D.Xf)(ii)}},4968:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{R:()=>_t});var D=fe(8421),N=fe(8306),A=fe(5577),l=fe(1144),oe=fe(576),lt=fe(3268);const At=["addListener","removeListener"],Ke=["addEventListener","removeEventListener"],ct=["on","off"];function _t(at,ft,tn,kt){if((0,oe.m)(tn)&&(kt=tn,tn=void 0),kt)return _t(at,ft,tn).pipe((0,lt.Z)(kt));const[dn,Qn]=function st(at){return(0,oe.m)(at.addEventListener)&&(0,oe.m)(at.removeEventListener)}(at)?Ke.map(on=>Cn=>at[on](ft,Cn,tn)):function wt(at){return(0,oe.m)(at.addListener)&&(0,oe.m)(at.removeListener)}(at)?At.map(Nt(at,ft)):function Bt(at){return(0,oe.m)(at.on)&&(0,oe.m)(at.off)}(at)?ct.map(Nt(at,ft)):[];if(!dn&&(0,l.z)(at))return(0,A.z)(on=>_t(on,ft,tn))((0,D.Xf)(at));if(!dn)throw new TypeError("Invalid event target");return new N.y(on=>{const Cn=(...se)=>on.next(1<se.length?se:se[0]);return dn(Cn),()=>Qn(Cn)})}function Nt(at,ft){return tn=>kt=>at[tn](ft,kt)}},8421:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{Xf:()=>Bt});var D=fe(655),N=fe(1144),A=fe(8239),l=fe(8306),oe=fe(3670),lt=fe(2206),At=fe(4532),Ke=fe(6495),ct=fe(3260),_t=fe(576),Nt=fe(7849),wt=fe(8822);function Bt(on){if(on instanceof l.y)return on;if(null!=on){if((0,oe.c)(on))return function st(on){return new l.y(Cn=>{const se=on[wt.L]();if((0,_t.m)(se.subscribe))return se.subscribe(Cn);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(on);if((0,N.z)(on))return function at(on){return new l.y(Cn=>{for(let se=0;se<on.length&&!Cn.closed;se++)Cn.next(on[se]);Cn.complete()})}(on);if((0,A.t)(on))return function ft(on){return new l.y(Cn=>{on.then(se=>{Cn.closed||(Cn.next(se),Cn.complete())},se=>Cn.error(se)).then(null,Nt.h)})}(on);if((0,lt.D)(on))return kt(on);if((0,Ke.T)(on))return function tn(on){return new l.y(Cn=>{for(const se of on)if(Cn.next(se),Cn.closed)return;Cn.complete()})}(on);if((0,ct.L)(on))return function dn(on){return kt((0,ct.Q)(on))}(on)}throw(0,At.z)(on)}function kt(on){return new l.y(Cn=>{(function Qn(on,Cn){var se,Wi,ii,kn;return(0,D.mG)(this,void 0,void 0,function*(){try{for(se=(0,D.KL)(on);!(Wi=yield se.next()).done;)if(Cn.next(Wi.value),Cn.closed)return}catch(Ci){ii={error:Ci}}finally{try{Wi&&!Wi.done&&(kn=se.return)&&(yield kn.call(se))}finally{if(ii)throw ii.error}}Cn.complete()})})(on,Cn).catch(se=>Cn.error(se))})}},6451:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{T:()=>lt});var D=fe(8189),N=fe(8421),A=fe(515),l=fe(3269),oe=fe(2076);function lt(...At){const Ke=(0,l.yG)(At),ct=(0,l._6)(At,1/0),_t=At;return _t.length?1===_t.length?(0,N.Xf)(_t[0]):(0,D.J)(ct)((0,oe.D)(_t,Ke)):A.E}},9646:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{of:()=>A});var D=fe(3269),N=fe(2076);function A(...l){const oe=(0,D.yG)(l);return(0,N.D)(l,oe)}},5963:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{H:()=>oe});var D=fe(8306),N=fe(1566),A=fe(3532);function oe(lt=0,At,Ke=N.P){let ct=-1;return null!=At&&((0,A.K)(At)?Ke=At:ct=At),new D.y(_t=>{let Nt=function l(lt){return lt instanceof Date&&!isNaN(lt)}(lt)?+lt-Ke.now():lt;Nt<0&&(Nt=0);let wt=0;return Ke.schedule(function(){_t.closed||(_t.next(wt++),0<=ct?this.schedule(void 0,ct):_t.complete())},Nt)})}},5403:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{x:()=>N});var D=fe(930);function N(l,oe,lt,At,Ke){return new A(l,oe,lt,At,Ke)}class A extends D.Lv{constructor(oe,lt,At,Ke,ct,_t){super(oe),this.onFinalize=ct,this.shouldUnsubscribe=_t,this._next=lt?function(Nt){try{lt(Nt)}catch(wt){oe.error(wt)}}:super._next,this._error=Ke?function(Nt){try{Ke(Nt)}catch(wt){oe.error(wt)}finally{this.unsubscribe()}}:super._error,this._complete=At?function(){try{At()}catch(Nt){oe.error(Nt)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var oe;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:lt}=this;super.unsubscribe(),!lt&&(null===(oe=this.onFinalize)||void 0===oe||oe.call(this))}}}},262:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{K:()=>l});var D=fe(8421),N=fe(5403),A=fe(4482);function l(oe){return(0,A.e)((lt,At)=>{let _t,Ke=null,ct=!1;Ke=lt.subscribe((0,N.x)(At,void 0,void 0,Nt=>{_t=(0,D.Xf)(oe(Nt,l(oe)(lt))),Ke?(Ke.unsubscribe(),Ke=null,_t.subscribe(At)):ct=!0})),ct&&(Ke.unsubscribe(),Ke=null,_t.subscribe(At))})}},4351:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{b:()=>A});var D=fe(5577),N=fe(576);function A(l,oe){return(0,N.m)(oe)?(0,D.z)(l,oe,1):(0,D.z)(l,1)}},1005:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{g:()=>wt});var D=fe(1566),N=fe(7272),A=fe(5698),l=fe(4482),oe=fe(5403),lt=fe(5032),Ke=fe(9718),ct=fe(5577);function _t(Bt,st){return st?at=>(0,N.z)(st.pipe((0,A.q)(1),function At(){return(0,l.e)((Bt,st)=>{Bt.subscribe((0,oe.x)(st,lt.Z))})}()),at.pipe(_t(Bt))):(0,ct.z)((at,ft)=>Bt(at,ft).pipe((0,A.q)(1),(0,Ke.h)(at)))}var Nt=fe(5963);function wt(Bt,st=D.z){const at=(0,Nt.H)(Bt,st);return _t(()=>at)}},1884:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{x:()=>l});var D=fe(4671),N=fe(4482),A=fe(5403);function l(lt,At=D.y){return lt=null!=lt?lt:oe,(0,N.e)((Ke,ct)=>{let _t,Nt=!0;Ke.subscribe((0,A.x)(ct,wt=>{const Bt=At(wt);(Nt||!lt(_t,Bt))&&(Nt=!1,_t=Bt,ct.next(wt))}))})}function oe(lt,At){return lt===At}},9300:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{h:()=>A});var D=fe(4482),N=fe(5403);function A(l,oe){return(0,D.e)((lt,At)=>{let Ke=0;lt.subscribe((0,N.x)(At,ct=>l.call(oe,ct,Ke++)&&At.next(ct)))})}},4004:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{U:()=>A});var D=fe(4482),N=fe(5403);function A(l,oe){return(0,D.e)((lt,At)=>{let Ke=0;lt.subscribe((0,N.x)(At,ct=>{At.next(l.call(oe,ct,Ke++))}))})}},9718:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{h:()=>N});var D=fe(4004);function N(A){return(0,D.U)(()=>A)}},8189:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{J:()=>A});var D=fe(5577),N=fe(4671);function A(l=1/0){return(0,D.z)(N.y,l)}},5577:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{z:()=>Ke});var D=fe(4004),N=fe(8421),A=fe(4482),l=fe(9672),oe=fe(5403),At=fe(576);function Ke(ct,_t,Nt=1/0){return(0,At.m)(_t)?Ke((wt,Bt)=>(0,D.U)((st,at)=>_t(wt,st,Bt,at))((0,N.Xf)(ct(wt,Bt))),Nt):("number"==typeof _t&&(Nt=_t),(0,A.e)((wt,Bt)=>function lt(ct,_t,Nt,wt,Bt,st,at,ft){const tn=[];let kt=0,dn=0,Qn=!1;const on=()=>{Qn&&!tn.length&&!kt&&_t.complete()},Cn=Wi=>kt<wt?se(Wi):tn.push(Wi),se=Wi=>{st&&_t.next(Wi),kt++;let ii=!1;(0,N.Xf)(Nt(Wi,dn++)).subscribe((0,oe.x)(_t,kn=>{null==Bt||Bt(kn),st?Cn(kn):_t.next(kn)},()=>{ii=!0},void 0,()=>{if(ii)try{for(kt--;tn.length&&kt<wt;){const kn=tn.shift();at?(0,l.f)(_t,at,()=>se(kn)):se(kn)}on()}catch(kn){_t.error(kn)}}))};return ct.subscribe((0,oe.x)(_t,Cn,()=>{Qn=!0,on()})),()=>{null==ft||ft()}}(wt,Bt,ct,Nt)))}},8675:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{O:()=>l});var D=fe(7272),N=fe(3269),A=fe(4482);function l(...oe){const lt=(0,N.yG)(oe);return(0,A.e)((At,Ke)=>{(lt?(0,D.z)(oe,At,lt):(0,D.z)(oe,At)).subscribe(Ke)})}},3900:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{w:()=>l});var D=fe(8421),N=fe(4482),A=fe(5403);function l(oe,lt){return(0,N.e)((At,Ke)=>{let ct=null,_t=0,Nt=!1;const wt=()=>Nt&&!ct&&Ke.complete();At.subscribe((0,A.x)(Ke,Bt=>{null==ct||ct.unsubscribe();let st=0;const at=_t++;(0,D.Xf)(oe(Bt,at)).subscribe(ct=(0,A.x)(Ke,ft=>Ke.next(lt?lt(Bt,ft,at,st++):ft),()=>{ct=null,wt()}))},()=>{Nt=!0,wt()}))})}},5698:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{q:()=>l});var D=fe(515),N=fe(4482),A=fe(5403);function l(oe){return oe<=0?()=>D.E:(0,N.e)((lt,At)=>{let Ke=0;lt.subscribe((0,A.x)(At,ct=>{++Ke<=oe&&(At.next(ct),oe<=Ke&&At.complete())}))})}},2722:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{R:()=>oe});var D=fe(4482),N=fe(5403),A=fe(8421),l=fe(5032);function oe(lt){return(0,D.e)((At,Ke)=>{(0,A.Xf)(lt).subscribe((0,N.x)(Ke,()=>Ke.complete(),l.Z)),!Ke.closed&&At.subscribe(Ke)})}},8505:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{b:()=>oe});var D=fe(576),N=fe(4482),A=fe(5403),l=fe(4671);function oe(lt,At,Ke){const ct=(0,D.m)(lt)||At||Ke?{next:lt,error:At,complete:Ke}:lt;return ct?(0,N.e)((_t,Nt)=>{var wt;null===(wt=ct.subscribe)||void 0===wt||wt.call(ct);let Bt=!0;_t.subscribe((0,A.x)(Nt,st=>{var at;null===(at=ct.next)||void 0===at||at.call(ct,st),Nt.next(st)},()=>{var st;Bt=!1,null===(st=ct.complete)||void 0===st||st.call(ct),Nt.complete()},st=>{var at;Bt=!1,null===(at=ct.error)||void 0===at||at.call(ct,st),Nt.error(st)},()=>{var st,at;Bt&&(null===(st=ct.unsubscribe)||void 0===st||st.call(ct)),null===(at=ct.finalize)||void 0===at||at.call(ct)}))}):l.y}},1566:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{P:()=>_t,z:()=>ct});var D=fe(727);class N extends D.w0{constructor(wt,Bt){super()}schedule(wt,Bt=0){return this}}const A={setInterval(Nt,wt,...Bt){const{delegate:st}=A;return(null==st?void 0:st.setInterval)?st.setInterval(Nt,wt,...Bt):setInterval(Nt,wt,...Bt)},clearInterval(Nt){const{delegate:wt}=A;return((null==wt?void 0:wt.clearInterval)||clearInterval)(Nt)},delegate:void 0};var l=fe(8737);const lt={now:()=>(lt.delegate||Date).now(),delegate:void 0};class At{constructor(wt,Bt=At.now){this.schedulerActionCtor=wt,this.now=Bt}schedule(wt,Bt=0,st){return new this.schedulerActionCtor(this,wt).schedule(st,Bt)}}At.now=lt.now;const ct=new class Ke extends At{constructor(wt,Bt=At.now){super(wt,Bt),this.actions=[],this._active=!1}flush(wt){const{actions:Bt}=this;if(this._active)return void Bt.push(wt);let st;this._active=!0;do{if(st=wt.execute(wt.state,wt.delay))break}while(wt=Bt.shift());if(this._active=!1,st){for(;wt=Bt.shift();)wt.unsubscribe();throw st}}}(class oe extends N{constructor(wt,Bt){super(wt,Bt),this.scheduler=wt,this.work=Bt,this.pending=!1}schedule(wt,Bt=0){var st;if(this.closed)return this;this.state=wt;const at=this.id,ft=this.scheduler;return null!=at&&(this.id=this.recycleAsyncId(ft,at,Bt)),this.pending=!0,this.delay=Bt,this.id=null!==(st=this.id)&&void 0!==st?st:this.requestAsyncId(ft,this.id,Bt),this}requestAsyncId(wt,Bt,st=0){return A.setInterval(wt.flush.bind(wt,this),st)}recycleAsyncId(wt,Bt,st=0){if(null!=st&&this.delay===st&&!1===this.pending)return Bt;null!=Bt&&A.clearInterval(Bt)}execute(wt,Bt){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const st=this._execute(wt,Bt);if(st)return st;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(wt,Bt){let at,st=!1;try{this.work(wt)}catch(ft){st=!0,at=ft||new Error("Scheduled action threw falsy error")}if(st)return this.unsubscribe(),at}unsubscribe(){if(!this.closed){const{id:wt,scheduler:Bt}=this,{actions:st}=Bt;this.work=this.state=this.scheduler=null,this.pending=!1,(0,l.P)(st,this),null!=wt&&(this.id=this.recycleAsyncId(Bt,wt,null)),this.delay=null,super.unsubscribe()}}}),_t=ct},3410:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{z:()=>D});const D={setTimeout(N,A,...l){const{delegate:oe}=D;return(null==oe?void 0:oe.setTimeout)?oe.setTimeout(N,A,...l):setTimeout(N,A,...l)},clearTimeout(N){const{delegate:A}=D;return((null==A?void 0:A.clearTimeout)||clearTimeout)(N)},delegate:void 0}},2202:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{h:()=>N});const N=function D(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},8822:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{L:()=>D});const D="function"==typeof Symbol&&Symbol.observable||"@@observable"},3269:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{jO:()=>l,yG:()=>oe,_6:()=>lt});var D=fe(576),N=fe(3532);function A(At){return At[At.length-1]}function l(At){return(0,D.m)(A(At))?At.pop():void 0}function oe(At){return(0,N.K)(A(At))?At.pop():void 0}function lt(At,Ke){return"number"==typeof A(At)?At.pop():Ke}},4742:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{D:()=>oe});const{isArray:D}=Array,{getPrototypeOf:N,prototype:A,keys:l}=Object;function oe(At){if(1===At.length){const Ke=At[0];if(D(Ke))return{args:Ke,keys:null};if(function lt(At){return At&&"object"==typeof At&&N(At)===A}(Ke)){const ct=l(Ke);return{args:ct.map(_t=>Ke[_t]),keys:ct}}}return{args:At,keys:null}}},8737:(Bi,Zt,fe)=>{"use strict";function D(N,A){if(N){const l=N.indexOf(A);0<=l&&N.splice(l,1)}}fe.d(Zt,{P:()=>D})},3888:(Bi,Zt,fe)=>{"use strict";function D(N){const l=N(oe=>{Error.call(oe),oe.stack=(new Error).stack});return l.prototype=Object.create(Error.prototype),l.prototype.constructor=l,l}fe.d(Zt,{d:()=>D})},8089:(Bi,Zt,fe)=>{"use strict";function D(N,A){return N.reduce((l,oe,lt)=>(l[oe]=A[lt],l),{})}fe.d(Zt,{n:()=>D})},2806:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{x:()=>A,O:()=>l});var D=fe(2416);let N=null;function A(oe){if(D.v.useDeprecatedSynchronousErrorHandling){const lt=!N;if(lt&&(N={errorThrown:!1,error:null}),oe(),lt){const{errorThrown:At,error:Ke}=N;if(N=null,At)throw Ke}}else oe()}function l(oe){D.v.useDeprecatedSynchronousErrorHandling&&N&&(N.errorThrown=!0,N.error=oe)}},9672:(Bi,Zt,fe)=>{"use strict";function D(N,A,l,oe=0,lt=!1){const At=A.schedule(function(){l(),lt?N.add(this.schedule(null,oe)):this.unsubscribe()},oe);if(N.add(At),!lt)return At}fe.d(Zt,{f:()=>D})},4671:(Bi,Zt,fe)=>{"use strict";function D(N){return N}fe.d(Zt,{y:()=>D})},1144:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{z:()=>D});const D=N=>N&&"number"==typeof N.length&&"function"!=typeof N},2206:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{D:()=>N});var D=fe(576);function N(A){return Symbol.asyncIterator&&(0,D.m)(null==A?void 0:A[Symbol.asyncIterator])}},576:(Bi,Zt,fe)=>{"use strict";function D(N){return"function"==typeof N}fe.d(Zt,{m:()=>D})},3670:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{c:()=>A});var D=fe(8822),N=fe(576);function A(l){return(0,N.m)(l[D.L])}},6495:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{T:()=>A});var D=fe(2202),N=fe(576);function A(l){return(0,N.m)(null==l?void 0:l[D.h])}},8239:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{t:()=>N});var D=fe(576);function N(A){return(0,D.m)(null==A?void 0:A.then)}},3260:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{Q:()=>A,L:()=>l});var D=fe(655),N=fe(576);function A(oe){return(0,D.FC)(this,arguments,function*(){const At=oe.getReader();try{for(;;){const{value:Ke,done:ct}=yield(0,D.qq)(At.read());if(ct)return yield(0,D.qq)(void 0);yield yield(0,D.qq)(Ke)}}finally{At.releaseLock()}})}function l(oe){return(0,N.m)(null==oe?void 0:oe.getReader)}},3532:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{K:()=>N});var D=fe(576);function N(A){return A&&(0,D.m)(A.schedule)}},4482:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{A:()=>N,e:()=>A});var D=fe(576);function N(l){return(0,D.m)(null==l?void 0:l.lift)}function A(l){return oe=>{if(N(oe))return oe.lift(function(lt){try{return l(lt,this)}catch(At){this.error(At)}});throw new TypeError("Unable to lift unknown Observable type")}}},3268:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{Z:()=>l});var D=fe(4004);const{isArray:N}=Array;function l(oe){return(0,D.U)(lt=>function A(oe,lt){return N(lt)?oe(...lt):oe(lt)}(oe,lt))}},5032:(Bi,Zt,fe)=>{"use strict";function D(){}fe.d(Zt,{Z:()=>D})},7849:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{h:()=>A});var D=fe(2416),N=fe(3410);function A(l){N.z.setTimeout(()=>{const{onUnhandledError:oe}=D.v;if(!oe)throw l;oe(l)})}},4532:(Bi,Zt,fe)=>{"use strict";function D(N){return new TypeError(`You provided ${null!==N&&"object"==typeof N?"an invalid object":`'${N}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}fe.d(Zt,{z:()=>D})},5226:function(Bi){Bi.exports=function(){"use strict";var Zt={awaitingPromise:new WeakMap,promise:new WeakMap,innerParams:new WeakMap,domCache:new WeakMap};const D=q=>{const J={};for(const Ie in q)J[q[Ie]]="swal2-"+q[Ie];return J},N=D(["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","default-outline","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error","no-war"]),A=D(["success","warning","info","question","error"]),l="SweetAlert2:",lt=q=>q.charAt(0).toUpperCase()+q.slice(1),At=q=>{console.warn("".concat(l," ").concat("object"==typeof q?q.join(" "):q))},Ke=q=>{console.error("".concat(l," ").concat(q))},ct=[],Nt=(q,J)=>{(q=>{ct.includes(q)||(ct.push(q),At(q))})('"'.concat(q,'" is deprecated and will be removed in the next major release. Please use "').concat(J,'" instead.'))},wt=q=>"function"==typeof q?q():q,Bt=q=>q&&"function"==typeof q.toPromise,st=q=>Bt(q)?q.toPromise():Promise.resolve(q),at=q=>q&&Promise.resolve(q)===q,ft=()=>document.body.querySelector(".".concat(N.container)),tn=q=>{const J=ft();return J?J.querySelector(q):null},kt=q=>tn(".".concat(q)),dn=()=>kt(N.popup),Qn=()=>kt(N.icon),on=()=>kt(N.title),Cn=()=>kt(N["html-container"]),se=()=>kt(N.image),Wi=()=>kt(N["progress-steps"]),ii=()=>kt(N["validation-message"]),kn=()=>tn(".".concat(N.actions," .").concat(N.confirm)),Ci=()=>tn(".".concat(N.actions," .").concat(N.deny)),$t=()=>tn(".".concat(N.loader)),en=()=>tn(".".concat(N.actions," .").concat(N.cancel)),an=()=>kt(N.actions),Yt=()=>kt(N.footer),An=()=>kt(N["timer-progress-bar"]),Sn=()=>kt(N.close),mr=()=>{const q=Array.from(dn().querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])')).sort((Ie,ut)=>{const pn=parseInt(Ie.getAttribute("tabindex")),Jn=parseInt(ut.getAttribute("tabindex"));return pn>Jn?1:pn<Jn?-1:0}),J=Array.from(dn().querySelectorAll('\n  a[href],\n  area[href],\n  input:not([disabled]),\n  select:not([disabled]),\n  textarea:not([disabled]),\n  button:not([disabled]),\n  iframe,\n  object,\n  embed,\n  [tabindex="0"],\n  [contenteditable],\n  audio[controls],\n  video[controls],\n  summary\n')).filter(Ie=>"-1"!==Ie.getAttribute("tabindex"));return(q=>{const J=[];for(let Ie=0;Ie<q.length;Ie++)-1===J.indexOf(q[Ie])&&J.push(q[Ie]);return J})(q.concat(J)).filter(Ie=>no(Ie))},wi=()=>Br(document.body,N.shown)&&!Br(document.body,N["toast-shown"])&&!Br(document.body,N["no-backdrop"]),_i=()=>dn()&&Br(dn(),N.toast),ui={previousBodyPadding:null},Ti=(q,J)=>{if(q.textContent="",J){const ut=(new DOMParser).parseFromString(J,"text/html");Array.from(ut.querySelector("head").childNodes).forEach(pn=>{q.appendChild(pn)}),Array.from(ut.querySelector("body").childNodes).forEach(pn=>{pn instanceof HTMLVideoElement||pn instanceof HTMLAudioElement?q.appendChild(pn.cloneNode(!0)):q.appendChild(pn)})}},Br=(q,J)=>{if(!J)return!1;const Ie=J.split(/\s+/);for(let ut=0;ut<Ie.length;ut++)if(!q.classList.contains(Ie[ut]))return!1;return!0},oi=(q,J,Ie)=>{if(((q,J)=>{Array.from(q.classList).forEach(Ie=>{!Object.values(N).includes(Ie)&&!Object.values(A).includes(Ie)&&!Object.values(J.showClass).includes(Ie)&&q.classList.remove(Ie)})})(q,J),J.customClass&&J.customClass[Ie]){if("string"!=typeof J.customClass[Ie]&&!J.customClass[Ie].forEach)return void At("Invalid type of customClass.".concat(Ie,'! Expected string or iterable object, got "').concat(typeof J.customClass[Ie],'"'));fi(q,J.customClass[Ie])}},Tt=(q,J)=>{if(!J)return null;switch(J){case"select":case"textarea":case"file":return q.querySelector(".".concat(N.popup," > .").concat(N[J]));case"checkbox":return q.querySelector(".".concat(N.popup," > .").concat(N.checkbox," input"));case"radio":return q.querySelector(".".concat(N.popup," > .").concat(N.radio," input:checked"))||q.querySelector(".".concat(N.popup," > .").concat(N.radio," input:first-child"));case"range":return q.querySelector(".".concat(N.popup," > .").concat(N.range," input"));default:return q.querySelector(".".concat(N.popup," > .").concat(N.input))}},En=q=>{if(q.focus(),"file"!==q.type){const J=q.value;q.value="",q.value=J}},si=(q,J,Ie)=>{!q||!J||("string"==typeof J&&(J=J.split(/\s+/).filter(Boolean)),J.forEach(ut=>{Array.isArray(q)?q.forEach(pn=>{Ie?pn.classList.add(ut):pn.classList.remove(ut)}):Ie?q.classList.add(ut):q.classList.remove(ut)}))},fi=(q,J)=>{si(q,J,!0)},nr=(q,J)=>{si(q,J,!1)},Tr=(q,J)=>{const Ie=Array.from(q.children);for(let ut=0;ut<Ie.length;ut++){const pn=Ie[ut];if(pn instanceof HTMLElement&&Br(pn,J))return pn}},Zr=(q,J,Ie)=>{Ie==="".concat(parseInt(Ie))&&(Ie=parseInt(Ie)),Ie||0===parseInt(Ie)?q.style[J]="number"==typeof Ie?"".concat(Ie,"px"):Ie:q.style.removeProperty(J)},Ur=function(q){q.style.display=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"flex"},Mn=q=>{q.style.display="none"},yo=(q,J,Ie,ut)=>{const pn=q.querySelector(J);pn&&(pn.style[Ie]=ut)},qr=function(q,J){J?Ur(q,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"flex"):Mn(q)},no=q=>!(!q||!(q.offsetWidth||q.offsetHeight||q.getClientRects().length)),cs=q=>q.scrollHeight>q.clientHeight,cn=q=>{const J=window.getComputedStyle(q),Ie=parseFloat(J.getPropertyValue("animation-duration")||"0"),ut=parseFloat(J.getPropertyValue("transition-duration")||"0");return Ie>0||ut>0},Ot=function(q){let J=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const Ie=An();no(Ie)&&(J&&(Ie.style.transition="none",Ie.style.width="100%"),setTimeout(()=>{Ie.style.transition="width ".concat(q/1e3,"s linear"),Ie.style.width="0%"},10))},nn={},pi=q=>new Promise(J=>{if(!q)return J();const Ie=window.scrollX,ut=window.scrollY;nn.restoreFocusTimeout=setTimeout(()=>{nn.previousActiveElement instanceof HTMLElement?(nn.previousActiveElement.focus(),nn.previousActiveElement=null):document.body&&document.body.focus(),J()},100),window.scrollTo(Ie,ut)}),to=()=>"undefined"==typeof window||"undefined"==typeof document,Li='\n <div aria-labelledby="'.concat(N.title,'" aria-describedby="').concat(N["html-container"],'" class="').concat(N.popup,'" tabindex="-1">\n   <button type="button" class="').concat(N.close,'"></button>\n   <ul class="').concat(N["progress-steps"],'"></ul>\n   <div class="').concat(N.icon,'"></div>\n   <img class="').concat(N.image,'" />\n   <h2 class="').concat(N.title,'" id="').concat(N.title,'"></h2>\n   <div class="').concat(N["html-container"],'" id="').concat(N["html-container"],'"></div>\n   <input class="').concat(N.input,'" />\n   <input type="file" class="').concat(N.file,'" />\n   <div class="').concat(N.range,'">\n     <input type="range" />\n     <output></output>\n   </div>\n   <select class="').concat(N.select,'"></select>\n   <div class="').concat(N.radio,'"></div>\n   <label for="').concat(N.checkbox,'" class="').concat(N.checkbox,'">\n     <input type="checkbox" />\n     <span class="').concat(N.label,'"></span>\n   </label>\n   <textarea class="').concat(N.textarea,'"></textarea>\n   <div class="').concat(N["validation-message"],'" id="').concat(N["validation-message"],'"></div>\n   <div class="').concat(N.actions,'">\n     <div class="').concat(N.loader,'"></div>\n     <button type="button" class="').concat(N.confirm,'"></button>\n     <button type="button" class="').concat(N.deny,'"></button>\n     <button type="button" class="').concat(N.cancel,'"></button>\n   </div>\n   <div class="').concat(N.footer,'"></div>\n   <div class="').concat(N["timer-progress-bar-container"],'">\n     <div class="').concat(N["timer-progress-bar"],'"></div>\n   </div>\n </div>\n').replace(/(^|\n)\s*/g,""),Vr=()=>{nn.currentInstance.resetValidationMessage()},sr=q=>{const J=(()=>{const q=ft();return!!q&&(q.remove(),nr([document.documentElement,document.body],[N["no-backdrop"],N["toast-shown"],N["has-column"]]),!0)})();if(to())return void Ke("SweetAlert2 requires document to initialize");const Ie=document.createElement("div");Ie.className=N.container,J&&fi(Ie,N["no-transition"]),Ti(Ie,Li);const ut=(q=>"string"==typeof q?document.querySelector(q):q)(q.target);ut.appendChild(Ie),(q=>{const J=dn();J.setAttribute("role",q.toast?"alert":"dialog"),J.setAttribute("aria-live",q.toast?"polite":"assertive"),q.toast||J.setAttribute("aria-modal","true")})(q),(q=>{"rtl"===window.getComputedStyle(q).direction&&fi(ft(),N.rtl)})(ut),(()=>{const q=dn(),J=Tr(q,N.input),Ie=Tr(q,N.file),ut=q.querySelector(".".concat(N.range," input")),pn=q.querySelector(".".concat(N.range," output")),Jn=Tr(q,N.select),xo=q.querySelector(".".concat(N.checkbox," input")),Ts=Tr(q,N.textarea);J.oninput=Vr,Ie.onchange=Vr,Jn.onchange=Vr,xo.onchange=Vr,Ts.oninput=Vr,ut.oninput=()=>{Vr(),pn.value=ut.value},ut.onchange=()=>{Vr(),pn.value=ut.value}})()},Io=(q,J)=>{q instanceof HTMLElement?J.appendChild(q):"object"==typeof q?ir(q,J):q&&Ti(J,q)},ir=(q,J)=>{q.jquery?Ao(J,q):Ti(J,q.toString())},Ao=(q,J)=>{if(q.textContent="",0 in J)for(let Ie=0;Ie in J;Ie++)q.appendChild(J[Ie].cloneNode(!0));else q.appendChild(J.cloneNode(!0))},Zo=(()=>{if(to())return!1;const q=document.createElement("div"),J={WebkitAnimation:"webkitAnimationEnd",animation:"animationend"};for(const Ie in J)if(Object.prototype.hasOwnProperty.call(J,Ie)&&void 0!==q.style[Ie])return J[Ie];return!1})(),Ds=(q,J)=>{const Ie=an(),ut=$t();J.showConfirmButton||J.showDenyButton||J.showCancelButton?Ur(Ie):Mn(Ie),oi(Ie,J,"actions"),function qe(q,J,Ie){const ut=kn(),pn=Ci(),Jn=en();Me(ut,"confirm",Ie),Me(pn,"deny",Ie),Me(Jn,"cancel",Ie),function Te(q,J,Ie,ut){ut.buttonsStyling?(fi([q,J,Ie],N.styled),ut.confirmButtonColor&&(q.style.backgroundColor=ut.confirmButtonColor,fi(q,N["default-outline"])),ut.denyButtonColor&&(J.style.backgroundColor=ut.denyButtonColor,fi(J,N["default-outline"])),ut.cancelButtonColor&&(Ie.style.backgroundColor=ut.cancelButtonColor,fi(Ie,N["default-outline"]))):nr([q,J,Ie],N.styled)}(ut,pn,Jn,Ie),Ie.reverseButtons&&(Ie.toast?(q.insertBefore(Jn,ut),q.insertBefore(pn,ut)):(q.insertBefore(Jn,J),q.insertBefore(pn,J),q.insertBefore(ut,J)))}(Ie,ut,J),Ti(ut,J.loaderHtml),oi(ut,J,"loader")};function Me(q,J,Ie){qr(q,Ie["show".concat(lt(J),"Button")],"inline-block"),Ti(q,Ie["".concat(J,"ButtonText")]),q.setAttribute("aria-label",Ie["".concat(J,"ButtonAriaLabel")]),q.className=N[J],oi(q,Ie,"".concat(J,"Button")),fi(q,Ie["".concat(J,"ButtonClass")])}const Xe=(q,J)=>{const Ie=ft();!Ie||(function xt(q,J){"string"==typeof J?q.style.background=J:J||fi([document.documentElement,document.body],N["no-backdrop"])}(Ie,J.backdrop),function Gt(q,J){J in N?fi(q,N[J]):(At('The "position" parameter is not valid, defaulting to "center"'),fi(q,N.center))}(Ie,J.position),function Rt(q,J){if(J&&"string"==typeof J){const Ie="grow-".concat(J);Ie in N&&fi(q,N[Ie])}}(Ie,J.grow),oi(Ie,J,"container"))};const nt=["input","file","range","select","radio","checkbox","textarea"],Dn=q=>{if(!In[q.input])return void Ke('Unexpected type of input! Expected "text", "email", "password", "number", "tel", "select", "radio", "checkbox", "textarea", "file" or "url", got "'.concat(q.input,'"'));const J=rn(q.input),Ie=In[q.input](J,q);Ur(J),setTimeout(()=>{En(Ie)})},Se=(q,J)=>{const Ie=Tt(dn(),q);if(Ie){(q=>{for(let J=0;J<q.attributes.length;J++){const Ie=q.attributes[J].name;["type","value","style"].includes(Ie)||q.removeAttribute(Ie)}})(Ie);for(const ut in J)Ie.setAttribute(ut,J[ut])}},Be=q=>{const J=rn(q.input);"object"==typeof q.customClass&&fi(J,q.customClass.input)},dt=(q,J)=>{(!q.placeholder||J.inputPlaceholder)&&(q.placeholder=J.inputPlaceholder)},Pt=(q,J,Ie)=>{if(Ie.inputLabel){q.id=N.input;const ut=document.createElement("label"),pn=N["input-label"];ut.setAttribute("for",q.id),ut.className=pn,"object"==typeof Ie.customClass&&fi(ut,Ie.customClass.inputLabel),ut.innerText=Ie.inputLabel,J.insertAdjacentElement("beforebegin",ut)}},rn=q=>Tr(dn(),N[q]||N.input),un=(q,J)=>{["string","number"].includes(typeof J)?q.value="".concat(J):at(J)||At('Unexpected type of inputValue! Expected "string", "number" or "Promise", got "'.concat(typeof J,'"'))},In={};In.text=In.email=In.password=In.number=In.tel=In.url=(q,J)=>(un(q,J.inputValue),Pt(q,q,J),dt(q,J),q.type=J.input,q),In.file=(q,J)=>(Pt(q,q,J),dt(q,J),q),In.range=(q,J)=>{const Ie=q.querySelector("input"),ut=q.querySelector("output");return un(Ie,J.inputValue),Ie.type=J.input,un(ut,J.inputValue),Pt(Ie,q,J),q},In.select=(q,J)=>{if(q.textContent="",J.inputPlaceholder){const Ie=document.createElement("option");Ti(Ie,J.inputPlaceholder),Ie.value="",Ie.disabled=!0,Ie.selected=!0,q.appendChild(Ie)}return Pt(q,q,J),q},In.radio=q=>(q.textContent="",q),In.checkbox=(q,J)=>{const Ie=Tt(dn(),"checkbox");Ie.value="1",Ie.id=N.checkbox,Ie.checked=Boolean(J.inputValue);const ut=q.querySelector("span");return Ti(ut,J.inputPlaceholder),Ie},In.textarea=(q,J)=>{un(q,J.inputValue),dt(q,J),Pt(q,q,J);return setTimeout(()=>{if("MutationObserver"in window){const ut=parseInt(window.getComputedStyle(dn()).width);new MutationObserver(()=>{const Jn=q.offsetWidth+(ut=>parseInt(window.getComputedStyle(ut).marginLeft)+parseInt(window.getComputedStyle(ut).marginRight))(q);dn().style.width=Jn>ut?"".concat(Jn,"px"):null}).observe(q,{attributes:!0,attributeFilter:["style"]})}}),q};const Pn=(q,J)=>{const Ie=Cn();oi(Ie,J,"htmlContainer"),J.html?(Io(J.html,Ie),Ur(Ie,"block")):J.text?(Ie.textContent=J.text,Ur(Ie,"block")):Mn(Ie),((q,J)=>{const Ie=dn(),ut=Zt.innerParams.get(q),pn=!ut||J.input!==ut.input;nt.forEach(Jn=>{const xo=Tr(Ie,N[Jn]);Se(Jn,J.inputAttributes),xo.className=N[Jn],pn&&Mn(xo)}),J.input&&(pn&&Dn(J),Be(J))})(q,J)},qt=(q,J)=>{for(const Ie in A)J.icon!==Ie&&nr(q,A[Ie]);fi(q,A[J.icon]),hr(q,J),Gr(),oi(q,J,"icon")},Gr=()=>{const q=dn(),J=window.getComputedStyle(q).getPropertyValue("background-color"),Ie=q.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix");for(let ut=0;ut<Ie.length;ut++)Ie[ut].style.backgroundColor=J},ti=(q,J)=>{let ut,Ie=q.innerHTML;J.iconHtml?ut=Er(J.iconHtml):"success"===J.icon?(ut='\n  <div class="swal2-success-circular-line-left"></div>\n  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>\n  <div class="swal2-success-ring"></div> <div class="swal2-success-fix"></div>\n  <div class="swal2-success-circular-line-right"></div>\n',Ie=Ie.replace(/ style=".*?"/g,"")):ut="error"===J.icon?'\n  <span class="swal2-x-mark">\n    <span class="swal2-x-mark-line-left"></span>\n    <span class="swal2-x-mark-line-right"></span>\n  </span>\n':Er({question:"?",warning:"!",info:"i"}[J.icon]),Ie.trim()!==ut.trim()&&Ti(q,ut)},hr=(q,J)=>{if(J.iconColor){q.style.color=J.iconColor,q.style.borderColor=J.iconColor;for(const Ie of[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"])yo(q,Ie,"backgroundColor",J.iconColor);yo(q,".swal2-success-ring","borderColor",J.iconColor)}},Er=q=>'<div class="'.concat(N["icon-content"],'">').concat(q,"</div>"),Wn=(q,J)=>{q.className="".concat(N.popup," ").concat(no(q)?J.showClass.popup:""),J.toast?(fi([document.documentElement,document.body],N["toast-shown"]),fi(q,N.toast)):fi(q,N.modal),oi(q,J,"popup"),"string"==typeof J.customClass&&fi(q,J.customClass),J.icon&&fi(q,N["icon-".concat(J.icon)])},Xi=q=>{const J=document.createElement("li");return fi(J,N["progress-step"]),Ti(J,q),J},Gi=q=>{const J=document.createElement("li");return fi(J,N["progress-step-line"]),q.progressStepsDistance&&Zr(J,"width",q.progressStepsDistance),J},Ji=(q,J)=>{((q,J)=>{const Ie=ft(),ut=dn();J.toast?(Zr(Ie,"width",J.width),ut.style.width="100%",ut.insertBefore($t(),Qn())):Zr(ut,"width",J.width),Zr(ut,"padding",J.padding),J.color&&(ut.style.color=J.color),J.background&&(ut.style.background=J.background),Mn(ii()),Wn(ut,J)})(0,J),Xe(0,J),((q,J)=>{const Ie=Wi();J.progressSteps&&0!==J.progressSteps.length?(Ur(Ie),Ie.textContent="",J.currentProgressStep>=J.progressSteps.length&&At("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),J.progressSteps.forEach((ut,pn)=>{const Jn=Xi(ut);if(Ie.appendChild(Jn),pn===J.currentProgressStep&&fi(Jn,N["active-progress-step"]),pn!==J.progressSteps.length-1){const xo=Gi(J);Ie.appendChild(xo)}})):Mn(Ie)})(0,J),((q,J)=>{const Ie=Zt.innerParams.get(q),ut=Qn();Ie&&J.icon===Ie.icon?(ti(ut,J),qt(ut,J)):J.icon||J.iconHtml?J.icon&&-1===Object.keys(A).indexOf(J.icon)?(Ke('Unknown icon! Expected "success", "error", "warning", "info" or "question", got "'.concat(J.icon,'"')),Mn(ut)):(Ur(ut),ti(ut,J),qt(ut,J),fi(ut,J.showClass.icon)):Mn(ut)})(q,J),((q,J)=>{const Ie=se();J.imageUrl?(Ur(Ie,""),Ie.setAttribute("src",J.imageUrl),Ie.setAttribute("alt",J.imageAlt),Zr(Ie,"width",J.imageWidth),Zr(Ie,"height",J.imageHeight),Ie.className=N.image,oi(Ie,J,"image")):Mn(Ie)})(0,J),((q,J)=>{const Ie=on();qr(Ie,J.title||J.titleText,"block"),J.title&&Io(J.title,Ie),J.titleText&&(Ie.innerText=J.titleText),oi(Ie,J,"title")})(0,J),((q,J)=>{const Ie=Sn();Ti(Ie,J.closeButtonHtml),oi(Ie,J,"closeButton"),qr(Ie,J.showCloseButton),Ie.setAttribute("aria-label",J.closeButtonAriaLabel)})(0,J),Pn(q,J),Ds(0,J),((q,J)=>{const Ie=Yt();qr(Ie,J.footer),J.footer&&Io(J.footer,Ie),oi(Ie,J,"footer")})(0,J),"function"==typeof J.didRender&&J.didRender(dn())};function Ko(){const q=Zt.innerParams.get(this);if(!q)return;const J=Zt.domCache.get(this);Mn(J.loader),_i()?q.icon&&Ur(Qn()):us(J),nr([J.popup,J.actions],N.loading),J.popup.removeAttribute("aria-busy"),J.popup.removeAttribute("data-loading"),J.confirmButton.disabled=!1,J.denyButton.disabled=!1,J.cancelButton.disabled=!1}const us=q=>{const J=q.popup.getElementsByClassName(q.loader.getAttribute("data-button-to-replace"));J.length?Ur(J[0],"inline-block"):!no(kn())&&!no(Ci())&&!no(en())&&Mn(q.actions)};const lr=()=>kn()&&kn().click(),Dr=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),Uo=q=>{q.keydownTarget&&q.keydownHandlerAdded&&(q.keydownTarget.removeEventListener("keydown",q.keydownHandler,{capture:q.keydownListenerCapture}),q.keydownHandlerAdded=!1)},po=(q,J,Ie)=>{const ut=mr();if(ut.length)return(J+=Ie)===ut.length?J=0:-1===J&&(J=ut.length-1),ut[J].focus();dn().focus()},xr=["ArrowRight","ArrowDown"],zr=["ArrowLeft","ArrowUp"],rs=(q,J,Ie)=>{const ut=Zt.innerParams.get(q);!ut||J.isComposing||229===J.keyCode||(ut.stopKeydownPropagation&&J.stopPropagation(),"Enter"===J.key?vs(q,J,ut):"Tab"===J.key?Ir(J,ut):[...xr,...zr].includes(J.key)?Vo(J.key):"Escape"===J.key&&ya(J,ut,Ie))},vs=(q,J,Ie)=>{if(wt(Ie.allowEnterKey)&&J.target&&q.getInput()&&J.target instanceof HTMLElement&&J.target.outerHTML===q.getInput().outerHTML){if(["textarea","file"].includes(Ie.input))return;lr(),J.preventDefault()}},Ir=(q,J)=>{const Ie=q.target,ut=mr();let pn=-1;for(let Jn=0;Jn<ut.length;Jn++)if(Ie===ut[Jn]){pn=Jn;break}po(0,pn,q.shiftKey?-1:1),q.stopPropagation(),q.preventDefault()},Vo=q=>{const J=kn(),Ie=Ci(),ut=en();if(document.activeElement instanceof HTMLElement&&![J,Ie,ut].includes(document.activeElement))return;const pn=xr.includes(q)?"nextElementSibling":"previousElementSibling";let Jn=document.activeElement;for(let xo=0;xo<an().children.length;xo++){if(Jn=Jn[pn],!Jn)return;if(Jn instanceof HTMLButtonElement&&no(Jn))break}Jn instanceof HTMLButtonElement&&Jn.focus()},ya=(q,J,Ie)=>{wt(J.allowEscapeKey)&&(q.preventDefault(),Ie(Dr.esc))};var hs={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap};const Qs=()=>{Array.from(document.body.children).forEach(J=>{J.hasAttribute("data-previous-aria-hidden")?(J.setAttribute("aria-hidden",J.getAttribute("data-previous-aria-hidden")),J.removeAttribute("data-previous-aria-hidden")):J.removeAttribute("aria-hidden")})},ua=()=>{const q=navigator.userAgent,J=!!q.match(/iPad/i)||!!q.match(/iPhone/i),Ie=!!q.match(/WebKit/i);J&&Ie&&!q.match(/CriOS/i)&&dn().scrollHeight>window.innerHeight-44&&(ft().style.paddingBottom="".concat(44,"px"))},$o=()=>{const q=ft();let J;q.ontouchstart=Ie=>{J=ha(Ie)},q.ontouchmove=Ie=>{J&&(Ie.preventDefault(),Ie.stopPropagation())}},ha=q=>{const J=q.target,Ie=ft();return!ul(q)&&!Qi(q)&&(J===Ie||!cs(Ie)&&J instanceof HTMLElement&&"INPUT"!==J.tagName&&"TEXTAREA"!==J.tagName&&!(cs(Cn())&&Cn().contains(J)))},ul=q=>q.touches&&q.touches.length&&"stylus"===q.touches[0].touchType,Qi=q=>q.touches&&q.touches.length>1,Qr=()=>{null===ui.previousBodyPadding&&document.body.scrollHeight>window.innerHeight&&(ui.previousBodyPadding=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight="".concat(ui.previousBodyPadding+(()=>{const q=document.createElement("div");q.className=N["scrollbar-measure"],document.body.appendChild(q);const J=q.getBoundingClientRect().width-q.clientWidth;return document.body.removeChild(q),J})(),"px"))};function Da(q,J,Ie,ut){_i()?Pl(q,ut):(pi(Ie).then(()=>Pl(q,ut)),Uo(nn)),/^((?!chrome|android).)*safari/i.test(navigator.userAgent)?(J.setAttribute("style","display:none !important"),J.removeAttribute("class"),J.innerHTML=""):J.remove(),wi()&&(null!==ui.previousBodyPadding&&(document.body.style.paddingRight="".concat(ui.previousBodyPadding,"px"),ui.previousBodyPadding=null),(()=>{if(Br(document.body,N.iosfix)){const q=parseInt(document.body.style.top,10);nr(document.body,N.iosfix),document.body.style.top="",document.body.scrollTop=-1*q}})(),Qs()),function Us(){nr([document.documentElement,document.body],[N.shown,N["height-auto"],N["no-backdrop"],N["toast-shown"]])}()}function Sa(q){q=Xo(q);const J=hs.swalPromiseResolve.get(this),Ie=Oo(this);this.isAwaitingPromise()?q.isDismissed||(eo(this),J(q)):Ie&&J(q)}const Oo=q=>{const J=dn();if(!J)return!1;const Ie=Zt.innerParams.get(q);if(!Ie||Br(J,Ie.hideClass.popup))return!1;nr(J,Ie.showClass.popup),fi(J,Ie.hideClass.popup);const ut=ft();return nr(ut,Ie.showClass.backdrop),fi(ut,Ie.hideClass.backdrop),As(q,J,Ie),!0};const eo=q=>{q.isAwaitingPromise()&&(Zt.awaitingPromise.delete(q),Zt.innerParams.get(q)||q._destroy())},Xo=q=>void 0===q?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},q),As=(q,J,Ie)=>{const ut=ft(),pn=Zo&&cn(J);"function"==typeof Ie.willClose&&Ie.willClose(J),pn?Ms(q,J,ut,Ie.returnFocus,Ie.didClose):Da(q,ut,Ie.returnFocus,Ie.didClose)},Ms=(q,J,Ie,ut,pn)=>{nn.swalCloseEventFinishedCallback=Da.bind(null,q,Ie,ut,pn),J.addEventListener(Zo,function(Jn){Jn.target===J&&(nn.swalCloseEventFinishedCallback(),delete nn.swalCloseEventFinishedCallback)})},Pl=(q,J)=>{setTimeout(()=>{"function"==typeof J&&J.bind(q.params)(),q._destroy()})};function Aa(q,J,Ie){const ut=Zt.domCache.get(q);J.forEach(pn=>{ut[pn].disabled=Ie})}function ds(q,J){if(q)if("radio"===q.type){const ut=q.parentNode.parentNode.querySelectorAll("input");for(let pn=0;pn<ut.length;pn++)ut[pn].disabled=J}else q.disabled=J}const I={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0},V=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","willClose"],ne={},ce=["allowOutsideClick","allowEnterKey","backdrop","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],Ee=q=>Object.prototype.hasOwnProperty.call(I,q),Ae=q=>-1!==V.indexOf(q),Le=q=>ne[q],Y=q=>{Ee(q)||At('Unknown parameter "'.concat(q,'"'))},le=q=>{ce.includes(q)&&At('The parameter "'.concat(q,'" is incompatible with toasts'))},ee=q=>{Le(q)&&Nt(q,Le(q))};const Ye=q=>{const J={};return Object.keys(q).forEach(Ie=>{Ae(Ie)?J[Ie]=q[Ie]:At("Invalid parameter to update: ".concat(Ie))}),J};const On=q=>{Ui(q),delete q.params,delete nn.keydownHandler,delete nn.keydownTarget,delete nn.currentInstance},Ui=q=>{q.isAwaitingPromise()?(wn(Zt,q),Zt.awaitingPromise.set(q,!0)):(wn(hs,q),wn(Zt,q))},wn=(q,J)=>{for(const Ie in q)q[Ie].delete(J)};var er=Object.freeze({hideLoading:Ko,disableLoading:Ko,getInput:function Ss(q){const J=Zt.innerParams.get(q||this),Ie=Zt.domCache.get(q||this);return Ie?Tt(Ie.popup,J.input):null},close:Sa,isAwaitingPromise:function qs(){return!!Zt.awaitingPromise.get(this)},rejectPromise:function Mo(q){const J=hs.swalPromiseReject.get(this);eo(this),J&&J(q)},handleAwaitingPromise:eo,closePopup:Sa,closeModal:Sa,closeToast:Sa,enableButtons:function ea(){Aa(this,["confirmButton","denyButton","cancelButton"],!1)},disableButtons:function Vs(){Aa(this,["confirmButton","denyButton","cancelButton"],!0)},enableInput:function Wr(){ds(this.getInput(),!1)},disableInput:function fs(){ds(this.getInput(),!0)},showValidationMessage:function js(q){const J=Zt.domCache.get(this),Ie=Zt.innerParams.get(this);Ti(J.validationMessage,q),J.validationMessage.className=N["validation-message"],Ie.customClass&&Ie.customClass.validationMessage&&fi(J.validationMessage,Ie.customClass.validationMessage),Ur(J.validationMessage);const ut=this.getInput();ut&&(ut.setAttribute("aria-invalid",!0),ut.setAttribute("aria-describedby",N["validation-message"]),En(ut),fi(ut,N.inputerror))},resetValidationMessage:function ps(){const q=Zt.domCache.get(this);q.validationMessage&&Mn(q.validationMessage);const J=this.getInput();J&&(J.removeAttribute("aria-invalid"),J.removeAttribute("aria-describedby"),nr(J,N.inputerror))},getProgressSteps:function Wa(){return Zt.domCache.get(this).progressSteps},update:function je(q){const J=dn(),Ie=Zt.innerParams.get(this);if(!J||Br(J,Ie.hideClass.popup))return At("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");const ut=Ye(q),pn=Object.assign({},Ie,ut);Ji(this,pn),Zt.innerParams.set(this,pn),Object.defineProperties(this,{params:{value:Object.assign({},this.params,q),writable:!1,enumerable:!0}})},_destroy:function mt(){const q=Zt.domCache.get(this),J=Zt.innerParams.get(this);J?(q.popup&&nn.swalCloseEventFinishedCallback&&(nn.swalCloseEventFinishedCallback(),delete nn.swalCloseEventFinishedCallback),"function"==typeof J.didDestroy&&J.didDestroy(),On(this)):Ui(this)}});const ji=q=>{let J=dn();J||new yr,J=dn();const Ie=$t();_i()?Mn(Qn()):Lr(J,q),Ur(Ie),J.setAttribute("data-loading","true"),J.setAttribute("aria-busy","true"),J.focus()},Lr=(q,J)=>{const Ie=an(),ut=$t();!J&&no(kn())&&(J=kn()),Ur(Ie),J&&(Mn(J),ut.setAttribute("data-button-to-replace",J.className)),ut.parentNode.insertBefore(ut,J),fi([q,Ie],N.loading)},ge=q=>q.checked?1:0,he=q=>q.checked?q.value:null,ae=q=>q.files.length?null!==q.getAttribute("multiple")?q.files:q.files[0]:null,Re=(q,J)=>{const Ie=dn(),ut=pn=>{xi[J.input](Ie,vi(pn),J)};Bt(J.inputOptions)||at(J.inputOptions)?(ji(kn()),st(J.inputOptions).then(pn=>{q.hideLoading(),ut(pn)})):"object"==typeof J.inputOptions?ut(J.inputOptions):Ke("Unexpected type of inputOptions! Expected object, Map or Promise, got ".concat(typeof J.inputOptions))},gn=(q,J)=>{const Ie=q.getInput();Mn(Ie),st(J.inputValue).then(ut=>{Ie.value="".concat("number"===J.input?parseFloat(ut)||0:ut),Ur(Ie),Ie.focus(),q.hideLoading()}).catch(ut=>{Ke("Error in inputValue promise: ".concat(ut)),Ie.value="",Ur(Ie),Ie.focus(),q.hideLoading()})},xi={select:(q,J,Ie)=>{const ut=Tr(q,N.select),pn=(Jn,xo,Ts)=>{const Hr=document.createElement("option");Hr.value=Ts,Ti(Hr,xo),Hr.selected=Jo(Ts,Ie.inputValue),Jn.appendChild(Hr)};J.forEach(Jn=>{const xo=Jn[0],Ts=Jn[1];if(Array.isArray(Ts)){const Hr=document.createElement("optgroup");Hr.label=xo,Hr.disabled=!1,ut.appendChild(Hr),Ts.forEach(Os=>pn(Hr,Os[1],Os[0]))}else pn(ut,Ts,xo)}),ut.focus()},radio:(q,J,Ie)=>{const ut=Tr(q,N.radio);J.forEach(Jn=>{const xo=Jn[0],Ts=Jn[1],Hr=document.createElement("input"),Os=document.createElement("label");Hr.type="radio",Hr.name=N.radio,Hr.value=xo,Jo(xo,Ie.inputValue)&&(Hr.checked=!0);const il=document.createElement("span");Ti(il,Ts),il.className=N.label,Os.appendChild(Hr),Os.appendChild(il),ut.appendChild(Os)});const pn=ut.querySelectorAll("input");pn.length&&pn[0].focus()}},vi=q=>{const J=[];return"undefined"!=typeof Map&&q instanceof Map?q.forEach((Ie,ut)=>{let pn=Ie;"object"==typeof pn&&(pn=vi(pn)),J.push([ut,pn])}):Object.keys(q).forEach(Ie=>{let ut=q[Ie];"object"==typeof ut&&(ut=vi(ut)),J.push([Ie,ut])}),J},Jo=(q,J)=>J&&J.toString()===q.toString(),xs=(q,J)=>{const Ie=Zt.innerParams.get(q);if(!Ie.input)return void Ke('The "input" parameter is needed to be set when using returnInputValueOn'.concat(lt(J)));const ut=((q,J)=>{const Ie=q.getInput();if(!Ie)return null;switch(J.input){case"checkbox":return ge(Ie);case"radio":return he(Ie);case"file":return ae(Ie);default:return J.inputAutoTrim?Ie.value.trim():Ie.value}})(q,Ie);Ie.inputValidator?ka(q,ut,J):q.getInput().checkValidity()?"deny"===J?ta(q,ut):Go(q,ut):(q.enableButtons(),q.showValidationMessage(Ie.validationMessage))},ka=(q,J,Ie)=>{const ut=Zt.innerParams.get(q);q.disableInput(),Promise.resolve().then(()=>st(ut.inputValidator(J,ut.validationMessage))).then(Jn=>{q.enableButtons(),q.enableInput(),Jn?q.showValidationMessage(Jn):"deny"===Ie?ta(q,J):Go(q,J)})},ta=(q,J)=>{const Ie=Zt.innerParams.get(q||void 0);Ie.showLoaderOnDeny&&ji(Ci()),Ie.preDeny?(Zt.awaitingPromise.set(q||void 0,!0),Promise.resolve().then(()=>st(Ie.preDeny(J,Ie.validationMessage))).then(pn=>{!1===pn?(q.hideLoading(),eo(q)):q.close({isDenied:!0,value:void 0===pn?J:pn})}).catch(pn=>ki(q||void 0,pn))):q.close({isDenied:!0,value:J})},Hn=(q,J)=>{q.close({isConfirmed:!0,value:J})},ki=(q,J)=>{q.rejectPromise(J)},Go=(q,J)=>{const Ie=Zt.innerParams.get(q||void 0);Ie.showLoaderOnConfirm&&ji(),Ie.preConfirm?(q.resetValidationMessage(),Zt.awaitingPromise.set(q||void 0,!0),Promise.resolve().then(()=>st(Ie.preConfirm(J,Ie.validationMessage))).then(pn=>{no(ii())||!1===pn?(q.hideLoading(),eo(q)):Hn(q,void 0===pn?J:pn)}).catch(pn=>ki(q||void 0,pn))):Hn(q,J)},Na=(q,J,Ie)=>{J.popup.onclick=()=>{const ut=Zt.innerParams.get(q);ut&&(La(ut)||ut.timer||ut.input)||Ie(Dr.close)}},La=q=>q.showConfirmButton||q.showDenyButton||q.showCancelButton||q.showCloseButton;let Qo=!1;const yl=q=>{q.popup.onmousedown=()=>{q.container.onmouseup=function(J){q.container.onmouseup=void 0,J.target===q.container&&(Qo=!0)}}},Ua=q=>{q.container.onmousedown=()=>{q.popup.onmouseup=function(J){q.popup.onmouseup=void 0,(J.target===q.popup||q.popup.contains(J.target))&&(Qo=!0)}}},hl=(q,J,Ie)=>{J.container.onclick=ut=>{const pn=Zt.innerParams.get(q);Qo?Qo=!1:ut.target===J.container&&wt(pn.allowOutsideClick)&&Ie(Dr.backdrop)}},Ma=q=>q instanceof Element||(q=>"object"==typeof q&&q.jquery)(q);const xa=()=>{if(nn.timeout)return(()=>{const q=An(),J=parseInt(window.getComputedStyle(q).width);q.style.removeProperty("transition"),q.style.width="100%";const ut=J/parseInt(window.getComputedStyle(q).width)*100;q.style.removeProperty("transition"),q.style.width="".concat(ut,"%")})(),nn.timeout.stop()},gs=()=>{if(nn.timeout){const q=nn.timeout.start();return Ot(q),q}};let _s=!1;const Va={};const bl=q=>{for(let J=q.target;J&&J!==document;J=J.parentNode)for(const Ie in Va){const ut=J.getAttribute(Ie);if(ut)return void Va[Ie].fire({template:ut})}};var io=Object.freeze({isValidParameter:Ee,isUpdatableParameter:Ae,isDeprecatedParameter:Le,argsToParams:q=>{const J={};return"object"!=typeof q[0]||Ma(q[0])?["title","html","icon"].forEach((Ie,ut)=>{const pn=q[ut];"string"==typeof pn||Ma(pn)?J[Ie]=pn:void 0!==pn&&Ke("Unexpected type of ".concat(Ie,'! Expected "string" or "Element", got ').concat(typeof pn))}):Object.assign(J,q[0]),J},isVisible:()=>no(dn()),clickConfirm:lr,clickDeny:()=>Ci()&&Ci().click(),clickCancel:()=>en()&&en().click(),getContainer:ft,getPopup:dn,getTitle:on,getHtmlContainer:Cn,getImage:se,getIcon:Qn,getInputLabel:()=>kt(N["input-label"]),getCloseButton:Sn,getActions:an,getConfirmButton:kn,getDenyButton:Ci,getCancelButton:en,getLoader:$t,getFooter:Yt,getTimerProgressBar:An,getFocusableElements:mr,getValidationMessage:ii,isLoading:()=>dn().hasAttribute("data-loading"),fire:function ss(){const q=this;for(var J=arguments.length,Ie=new Array(J),ut=0;ut<J;ut++)Ie[ut]=arguments[ut];return new q(...Ie)},mixin:function ba(q){return class J extends(this){_main(ut,pn){return super._main(ut,Object.assign({},q,pn))}}},showLoading:ji,enableLoading:ji,getTimerLeft:()=>nn.timeout&&nn.timeout.getTimerLeft(),stopTimer:xa,resumeTimer:gs,toggleTimer:()=>{const q=nn.timeout;return q&&(q.running?xa():gs())},increaseTimer:q=>{if(nn.timeout){const J=nn.timeout.increase(q);return Ot(J,!0),J}},isTimerRunning:()=>nn.timeout&&nn.timeout.isRunning(),bindClickHandler:function Ia(){Va[arguments.length>0&&void 0!==arguments[0]?arguments[0]:"data-swal-template"]=this,_s||(document.body.addEventListener("click",bl),_s=!0)}});class Fa{constructor(J,Ie){this.callback=J,this.remaining=Ie,this.running=!1,this.start()}start(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}stop(){return this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=(new Date).getTime()-this.started.getTime()),this.remaining}increase(J){const Ie=this.running;return Ie&&this.stop(),this.remaining+=J,Ie&&this.start(),this.remaining}getTimerLeft(){return this.running&&(this.stop(),this.start()),this.remaining}isRunning(){return this.running}}const Ns=["swal-title","swal-html","swal-footer"],Xa=q=>{const J={};return Array.from(q.querySelectorAll("swal-param")).forEach(ut=>{ts(ut,["name","value"]);const pn=ut.getAttribute("name"),Jn=ut.getAttribute("value");J[pn]="boolean"==typeof I[pn]?"false"!==Jn:"object"==typeof I[pn]?JSON.parse(Jn):Jn}),J},xl=q=>{const J={};return Array.from(q.querySelectorAll("swal-function-param")).forEach(ut=>{const pn=ut.getAttribute("name"),Jn=ut.getAttribute("value");J[pn]=new Function("return ".concat(Jn))()}),J},Ol=q=>{const J={};return Array.from(q.querySelectorAll("swal-button")).forEach(ut=>{ts(ut,["type","color","aria-label"]);const pn=ut.getAttribute("type");J["".concat(pn,"ButtonText")]=ut.innerHTML,J["show".concat(lt(pn),"Button")]=!0,ut.hasAttribute("color")&&(J["".concat(pn,"ButtonColor")]=ut.getAttribute("color")),ut.hasAttribute("aria-label")&&(J["".concat(pn,"ButtonAriaLabel")]=ut.getAttribute("aria-label"))}),J},nl=q=>{const J={},Ie=q.querySelector("swal-image");return Ie&&(ts(Ie,["src","width","height","alt"]),Ie.hasAttribute("src")&&(J.imageUrl=Ie.getAttribute("src")),Ie.hasAttribute("width")&&(J.imageWidth=Ie.getAttribute("width")),Ie.hasAttribute("height")&&(J.imageHeight=Ie.getAttribute("height")),Ie.hasAttribute("alt")&&(J.imageAlt=Ie.getAttribute("alt"))),J},Pa=q=>{const J={},Ie=q.querySelector("swal-icon");return Ie&&(ts(Ie,["type","color"]),Ie.hasAttribute("type")&&(J.icon=Ie.getAttribute("type")),Ie.hasAttribute("color")&&(J.iconColor=Ie.getAttribute("color")),J.iconHtml=Ie.innerHTML),J},Ps=q=>{const J={},Ie=q.querySelector("swal-input");Ie&&(ts(Ie,["type","label","placeholder","value"]),J.input=Ie.getAttribute("type")||"text",Ie.hasAttribute("label")&&(J.inputLabel=Ie.getAttribute("label")),Ie.hasAttribute("placeholder")&&(J.inputPlaceholder=Ie.getAttribute("placeholder")),Ie.hasAttribute("value")&&(J.inputValue=Ie.getAttribute("value")));const ut=Array.from(q.querySelectorAll("swal-input-option"));return ut.length&&(J.inputOptions={},ut.forEach(pn=>{ts(pn,["value"]);const Jn=pn.getAttribute("value");J.inputOptions[Jn]=pn.innerHTML})),J},Ba=(q,J)=>{const Ie={};for(const ut in J){const pn=J[ut],Jn=q.querySelector(pn);Jn&&(ts(Jn,[]),Ie[pn.replace(/^swal-/,"")]=Jn.innerHTML.trim())}return Ie},ws=q=>{const J=Ns.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(q.children).forEach(Ie=>{const ut=Ie.tagName.toLowerCase();J.includes(ut)||At("Unrecognized element <".concat(ut,">"))})},ts=(q,J)=>{Array.from(q.attributes).forEach(Ie=>{-1===J.indexOf(Ie.name)&&At(['Unrecognized attribute "'.concat(Ie.name,'" on <').concat(q.tagName.toLowerCase(),">."),"".concat(J.length?"Allowed attributes are: ".concat(J.join(", ")):"To set the value, use HTML within the element.")])})},fa=q=>{const J=ft(),Ie=dn();"function"==typeof q.willOpen&&q.willOpen(Ie);const pn=window.getComputedStyle(document.body).overflowY;Rl(J,Ie,q),setTimeout(()=>{Cr(J,Ie)},10),wi()&&(ja(J,q.scrollbarPadding,pn),Array.from(document.body.children).forEach(J=>{J===ft()||J.contains(ft())||(J.hasAttribute("aria-hidden")&&J.setAttribute("data-previous-aria-hidden",J.getAttribute("aria-hidden")),J.setAttribute("aria-hidden","true"))})),!_i()&&!nn.previousActiveElement&&(nn.previousActiveElement=document.activeElement),"function"==typeof q.didOpen&&setTimeout(()=>q.didOpen(Ie)),nr(J,N["no-transition"])},wl=q=>{const J=dn();if(q.target!==J)return;const Ie=ft();J.removeEventListener(Zo,wl),Ie.style.overflowY="auto"},Cr=(q,J)=>{Zo&&cn(J)?(q.style.overflowY="hidden",J.addEventListener(Zo,wl)):q.style.overflowY="auto"},ja=(q,J,Ie)=>{(()=>{if((/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1)&&!Br(document.body,N.iosfix)){const J=document.body.scrollTop;document.body.style.top="".concat(-1*J,"px"),fi(document.body,N.iosfix),$o(),ua()}})(),J&&"hidden"!==Ie&&Qr(),setTimeout(()=>{q.scrollTop=0})},Rl=(q,J,Ie)=>{fi(q,Ie.showClass.backdrop),J.style.setProperty("opacity","0","important"),Ur(J,"grid"),setTimeout(()=>{fi(J,Ie.showClass.popup),J.style.removeProperty("opacity")},10),fi([document.documentElement,document.body],N.shown),Ie.heightAuto&&Ie.backdrop&&!Ie.toast&&fi([document.documentElement,document.body],N["height-auto"])};var Za={email:(q,J)=>/^[a-zA-Z0-9.+_-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]{2,24}$/.test(q)?Promise.resolve():Promise.resolve(J||"Invalid email address"),url:(q,J)=>/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(q)?Promise.resolve():Promise.resolve(J||"Invalid URL")};function Ut(q){(function Ue(q){q.inputValidator||Object.keys(Za).forEach(J=>{q.input===J&&(q.inputValidator=Za[J])})})(q),q.showLoaderOnConfirm&&!q.preConfirm&&At("showLoaderOnConfirm is set to true, but preConfirm is not defined.\nshowLoaderOnConfirm should be used together with preConfirm, see usage example:\nhttps://sweetalert2.github.io/#ajax-request"),function gt(q){(!q.target||"string"==typeof q.target&&!document.querySelector(q.target)||"string"!=typeof q.target&&!q.target.appendChild)&&(At('Target parameter is not valid, defaulting to "body"'),q.target="body")}(q),"string"==typeof q.title&&(q.title=q.title.split("\n").join("<br />")),sr(q)}let vn;class Wt{constructor(){if("undefined"==typeof window)return;vn=this;for(var J=arguments.length,Ie=new Array(J),ut=0;ut<J;ut++)Ie[ut]=arguments[ut];const pn=Object.freeze(this.constructor.argsToParams(Ie));Object.defineProperties(this,{params:{value:pn,writable:!1,enumerable:!0,configurable:!0}});const Jn=vn._main(vn.params);Zt.promise.set(this,Jn)}_main(J){let Ie=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(q=>{!1===q.backdrop&&q.allowOutsideClick&&At('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`');for(const J in q)Y(J),q.toast&&le(J),ee(J)})(Object.assign({},Ie,J)),nn.currentInstance&&(nn.currentInstance._destroy(),wi()&&Qs()),nn.currentInstance=vn;const ut=Vn(J,Ie);Ut(ut),Object.freeze(ut),nn.timeout&&(nn.timeout.stop(),delete nn.timeout),clearTimeout(nn.restoreFocusTimeout);const pn=ai(vn);return Ji(vn,ut),Zt.innerParams.set(vn,ut),Bn(vn,pn,ut)}then(J){return Zt.promise.get(this).then(J)}finally(J){return Zt.promise.get(this).finally(J)}}const Bn=(q,J,Ie)=>new Promise((ut,pn)=>{const Jn=xo=>{q.close({isDismissed:!0,dismiss:xo})};hs.swalPromiseResolve.set(q,ut),hs.swalPromiseReject.set(q,pn),J.confirmButton.onclick=()=>{(q=>{const J=Zt.innerParams.get(q);q.disableButtons(),J.input?xs(q,"confirm"):Go(q,!0)})(q)},J.denyButton.onclick=()=>{(q=>{const J=Zt.innerParams.get(q);q.disableButtons(),J.returnInputValueOnDeny?xs(q,"deny"):ta(q,!1)})(q)},J.cancelButton.onclick=()=>{((q,J)=>{q.disableButtons(),J(Dr.cancel)})(q,Jn)},J.closeButton.onclick=()=>{Jn(Dr.close)},((q,J,Ie)=>{Zt.innerParams.get(q).toast?Na(q,J,Ie):(yl(J),Ua(J),hl(q,J,Ie))})(q,J,Jn),((q,J,Ie,ut)=>{Uo(J),Ie.toast||(J.keydownHandler=pn=>rs(q,pn,ut),J.keydownTarget=Ie.keydownListenerCapture?window:dn(),J.keydownListenerCapture=Ie.keydownListenerCapture,J.keydownTarget.addEventListener("keydown",J.keydownHandler,{capture:J.keydownListenerCapture}),J.keydownHandlerAdded=!0)})(q,nn,Ie,Jn),((q,J)=>{"select"===J.input||"radio"===J.input?Re(q,J):["text","email","number","tel","textarea"].includes(J.input)&&(Bt(J.inputValue)||at(J.inputValue))&&(ji(kn()),gn(q,J))})(q,Ie),fa(Ie),Ii(nn,Ie,Jn),pr(J,Ie),setTimeout(()=>{J.container.scrollTop=0})}),Vn=(q,J)=>{const Ie=(q=>{const J="string"==typeof q.template?document.querySelector(q.template):q.template;if(!J)return{};const Ie=J.content;return ws(Ie),Object.assign(Xa(Ie),xl(Ie),Ol(Ie),nl(Ie),Pa(Ie),Ps(Ie),Ba(Ie,Ns))})(q),ut=Object.assign({},I,J,Ie,q);return ut.showClass=Object.assign({},I.showClass,ut.showClass),ut.hideClass=Object.assign({},I.hideClass,ut.hideClass),ut},ai=q=>{const J={popup:dn(),container:ft(),actions:an(),confirmButton:kn(),denyButton:Ci(),cancelButton:en(),loader:$t(),closeButton:Sn(),validationMessage:ii(),progressSteps:Wi()};return Zt.domCache.set(q,J),J},Ii=(q,J,Ie)=>{const ut=An();Mn(ut),J.timer&&(q.timeout=new Fa(()=>{Ie("timer"),delete q.timeout},J.timer),J.timerProgressBar&&(Ur(ut),oi(ut,J,"timerProgressBar"),setTimeout(()=>{q.timeout&&q.timeout.running&&Ot(J.timer)})))},pr=(q,J)=>{if(!J.toast){if(!wt(J.allowEnterKey))return void cr();Ni(q,J)||po(0,-1,1)}},Ni=(q,J)=>J.focusDeny&&no(q.denyButton)?(q.denyButton.focus(),!0):J.focusCancel&&no(q.cancelButton)?(q.cancelButton.focus(),!0):!(!J.focusConfirm||!no(q.confirmButton)||(q.confirmButton.focus(),0)),cr=()=>{document.activeElement instanceof HTMLElement&&"function"==typeof document.activeElement.blur&&document.activeElement.blur()};"undefined"!=typeof window&&/^ru\b/.test(navigator.language)&&location.host.match(/\.(ru|su|xn--p1ai)$/)&&(document.body.style.pointerEvents="none"),Object.assign(Wt.prototype,er),Object.assign(Wt,io),Object.keys(er).forEach(q=>{Wt[q]=function(){if(vn)return vn[q](...arguments)}}),Wt.DismissReason=Dr,Wt.version="11.5.2";const yr=Wt;return yr.default=yr,yr}(),void 0!==this&&this.Sweetalert2&&(this.swal=this.sweetAlert=this.Swal=this.SweetAlert=this.Sweetalert2),"undefined"!=typeof document&&function(Zt,fe){var D=Zt.createElement("style");if(Zt.getElementsByTagName("head")[0].appendChild(D),D.styleSheet)D.styleSheet.disabled||(D.styleSheet.cssText=fe);else try{D.innerHTML=fe}catch(N){D.innerText=fe}}(document,'.swal2-popup.swal2-toast{box-sizing:border-box;grid-column:1/4!important;grid-row:1/4!important;grid-template-columns:1fr 99fr 1fr;padding:1em;overflow-y:hidden;background:#fff;box-shadow:0 0 1px hsla(0deg,0%,0%,.075),0 1px 2px hsla(0deg,0%,0%,.075),1px 2px 4px hsla(0deg,0%,0%,.075),1px 3px 8px hsla(0deg,0%,0%,.075),2px 4px 16px hsla(0deg,0%,0%,.075);pointer-events:all}.swal2-popup.swal2-toast>*{grid-column:2}.swal2-popup.swal2-toast .swal2-title{margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-popup.swal2-toast .swal2-loading{justify-content:center}.swal2-popup.swal2-toast .swal2-input{height:2em;margin:.5em;font-size:1em}.swal2-popup.swal2-toast .swal2-validation-message{font-size:1em}.swal2-popup.swal2-toast .swal2-footer{margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-popup.swal2-toast .swal2-close{grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-popup.swal2-toast .swal2-html-container{margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-popup.swal2-toast .swal2-html-container:empty{padding:0}.swal2-popup.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-popup.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-popup.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:700}.swal2-popup.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-popup.swal2-toast .swal2-actions{justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-popup.swal2-toast .swal2-styled{margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-popup.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;transform:rotate(45deg);border-radius:50%}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-.8em;left:-.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-popup.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-popup.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}.swal2-popup.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-popup.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}.swal2-popup.swal2-toast.swal2-show{animation:swal2-toast-show .5s}.swal2-popup.swal2-toast.swal2-hide{animation:swal2-toast-hide .1s forwards}.swal2-container{display:grid;position:fixed;z-index:1060;top:0;right:0;bottom:0;left:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content,auto) minmax(min-content,auto) minmax(min-content,auto);height:100%;padding:.625em;overflow-x:hidden;transition:background-color .1s;-webkit-overflow-scrolling:touch}.swal2-container.swal2-backdrop-show,.swal2-container.swal2-noanimation{background:rgba(0,0,0,.4)}.swal2-container.swal2-backdrop-hide{background:0 0!important}.swal2-container.swal2-bottom-start,.swal2-container.swal2-center-start,.swal2-container.swal2-top-start{grid-template-columns:minmax(0,1fr) auto auto}.swal2-container.swal2-bottom,.swal2-container.swal2-center,.swal2-container.swal2-top{grid-template-columns:auto minmax(0,1fr) auto}.swal2-container.swal2-bottom-end,.swal2-container.swal2-center-end,.swal2-container.swal2-top-end{grid-template-columns:auto auto minmax(0,1fr)}.swal2-container.swal2-top-start>.swal2-popup{align-self:start}.swal2-container.swal2-top>.swal2-popup{grid-column:2;align-self:start;justify-self:center}.swal2-container.swal2-top-end>.swal2-popup,.swal2-container.swal2-top-right>.swal2-popup{grid-column:3;align-self:start;justify-self:end}.swal2-container.swal2-center-left>.swal2-popup,.swal2-container.swal2-center-start>.swal2-popup{grid-row:2;align-self:center}.swal2-container.swal2-center>.swal2-popup{grid-column:2;grid-row:2;align-self:center;justify-self:center}.swal2-container.swal2-center-end>.swal2-popup,.swal2-container.swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;align-self:center;justify-self:end}.swal2-container.swal2-bottom-left>.swal2-popup,.swal2-container.swal2-bottom-start>.swal2-popup{grid-column:1;grid-row:3;align-self:end}.swal2-container.swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;justify-self:center;align-self:end}.swal2-container.swal2-bottom-end>.swal2-popup,.swal2-container.swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;align-self:end;justify-self:end}.swal2-container.swal2-grow-fullscreen>.swal2-popup,.swal2-container.swal2-grow-row>.swal2-popup{grid-column:1/4;width:100%}.swal2-container.swal2-grow-column>.swal2-popup,.swal2-container.swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}.swal2-container.swal2-no-transition{transition:none!important}.swal2-popup{display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0,100%);width:32em;max-width:100%;padding:0 0 1.25em;border:none;border-radius:5px;background:#fff;color:#545454;font-family:inherit;font-size:1rem}.swal2-popup:focus{outline:0}.swal2-popup.swal2-loading{overflow-y:hidden}.swal2-title{position:relative;max-width:100%;margin:0;padding:.8em 1em 0;color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word}.swal2-actions{display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:center;width:auto;margin:1.25em auto 0;padding:0}.swal2-actions:not(.swal2-loading) .swal2-styled[disabled]{opacity:.4}.swal2-actions:not(.swal2-loading) .swal2-styled:hover{background-image:linear-gradient(rgba(0,0,0,.1),rgba(0,0,0,.1))}.swal2-actions:not(.swal2-loading) .swal2-styled:active{background-image:linear-gradient(rgba(0,0,0,.2),rgba(0,0,0,.2))}.swal2-loader{display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 transparent #2778c4 transparent}.swal2-styled{margin:.3125em;padding:.625em 1.1em;transition:box-shadow .1s;box-shadow:0 0 0 3px transparent;font-weight:500}.swal2-styled:not([disabled]){cursor:pointer}.swal2-styled.swal2-confirm{border:0;border-radius:.25em;background:initial;background-color:#7066e0;color:#fff;font-size:1em}.swal2-styled.swal2-confirm:focus{box-shadow:0 0 0 3px rgba(112,102,224,.5)}.swal2-styled.swal2-deny{border:0;border-radius:.25em;background:initial;background-color:#dc3741;color:#fff;font-size:1em}.swal2-styled.swal2-deny:focus{box-shadow:0 0 0 3px rgba(220,55,65,.5)}.swal2-styled.swal2-cancel{border:0;border-radius:.25em;background:initial;background-color:#6e7881;color:#fff;font-size:1em}.swal2-styled.swal2-cancel:focus{box-shadow:0 0 0 3px rgba(110,120,129,.5)}.swal2-styled.swal2-default-outline:focus{box-shadow:0 0 0 3px rgba(100,150,200,.5)}.swal2-styled:focus{outline:0}.swal2-styled::-moz-focus-inner{border:0}.swal2-footer{justify-content:center;margin:1em 0 0;padding:1em 1em 0;border-top:1px solid #eee;color:inherit;font-size:1em}.swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto!important;overflow:hidden;border-bottom-right-radius:5px;border-bottom-left-radius:5px}.swal2-timer-progress-bar{width:100%;height:.25em;background:rgba(0,0,0,.2)}.swal2-image{max-width:100%;margin:2em auto 1em}.swal2-close{z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:color .1s,box-shadow .1s;border:none;border-radius:5px;background:0 0;color:#ccc;font-family:serif;font-family:monospace;font-size:2.5em;cursor:pointer;justify-self:end}.swal2-close:hover{transform:none;background:0 0;color:#f27474}.swal2-close:focus{outline:0;box-shadow:inset 0 0 0 3px rgba(100,150,200,.5)}.swal2-close::-moz-focus-inner{border:0}.swal2-html-container{z-index:1;justify-content:center;margin:1em 1.6em .3em;padding:0;overflow:auto;color:inherit;font-size:1.125em;font-weight:400;line-height:normal;text-align:center;word-wrap:break-word;word-break:break-word}.swal2-checkbox,.swal2-file,.swal2-input,.swal2-radio,.swal2-select,.swal2-textarea{margin:1em 2em 3px}.swal2-file,.swal2-input,.swal2-textarea{box-sizing:border-box;width:auto;transition:border-color .1s,box-shadow .1s;border:1px solid #d9d9d9;border-radius:.1875em;background:0 0;box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px transparent;color:inherit;font-size:1.125em}.swal2-file.swal2-inputerror,.swal2-input.swal2-inputerror,.swal2-textarea.swal2-inputerror{border-color:#f27474!important;box-shadow:0 0 2px #f27474!important}.swal2-file:focus,.swal2-input:focus,.swal2-textarea:focus{border:1px solid #b4dbed;outline:0;box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(100,150,200,.5)}.swal2-file::-moz-placeholder,.swal2-input::-moz-placeholder,.swal2-textarea::-moz-placeholder{color:#ccc}.swal2-file::placeholder,.swal2-input::placeholder,.swal2-textarea::placeholder{color:#ccc}.swal2-range{margin:1em 2em 3px;background:#fff}.swal2-range input{width:80%}.swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}.swal2-range input,.swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}.swal2-input{height:2.625em;padding:0 .75em}.swal2-file{width:75%;margin-right:auto;margin-left:auto;background:0 0;font-size:1.125em}.swal2-textarea{height:6.75em;padding:.75em}.swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:0 0;color:inherit;font-size:1.125em}.swal2-checkbox,.swal2-radio{align-items:center;justify-content:center;background:#fff;color:inherit}.swal2-checkbox label,.swal2-radio label{margin:0 .6em;font-size:1.125em}.swal2-checkbox input,.swal2-radio input{flex-shrink:0;margin:0 .4em}.swal2-input-label{display:flex;justify-content:center;margin:1em auto 0}.swal2-validation-message{align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:#f0f0f0;color:#666;font-size:1em;font-weight:300}.swal2-validation-message::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}.swal2-icon{position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;border:.25em solid transparent;border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;-webkit-user-select:none;-moz-user-select:none;user-select:none}.swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}.swal2-icon.swal2-error{border-color:#f27474;color:#f27474}.swal2-icon.swal2-error .swal2-x-mark{position:relative;flex-grow:1}.swal2-icon.swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}.swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}.swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}.swal2-icon.swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}.swal2-icon.swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}.swal2-icon.swal2-warning{border-color:#facea8;color:#f8bb86}.swal2-icon.swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}.swal2-icon.swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}.swal2-icon.swal2-info{border-color:#9de0f6;color:#3fc3ee}.swal2-icon.swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}.swal2-icon.swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}.swal2-icon.swal2-question{border-color:#c9dae1;color:#87adbd}.swal2-icon.swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}.swal2-icon.swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}.swal2-icon.swal2-success{border-color:#a5dc86;color:#a5dc86}.swal2-icon.swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;transform:rotate(45deg);border-radius:50%}.swal2-icon.swal2-success [class^=swal2-success-circular-line][class$=left]{top:-.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}.swal2-icon.swal2-success [class^=swal2-success-circular-line][class$=right]{top:-.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}.swal2-icon.swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-.25em;left:-.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}.swal2-icon.swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}.swal2-icon.swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}.swal2-icon.swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}.swal2-icon.swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}.swal2-icon.swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}.swal2-icon.swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}.swal2-icon.swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}.swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:0 0;font-weight:600}.swal2-progress-steps li{display:inline-block;position:relative}.swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}.swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}.swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:#add8e6;color:#fff}.swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:#add8e6}.swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}[class^=swal2]{-webkit-tap-highlight-color:transparent}.swal2-show{animation:swal2-show .3s}.swal2-hide{animation:swal2-hide .15s forwards}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}@keyframes swal2-toast-show{0%{transform:translateY(-.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}@keyframes swal2-show{0%{transform:scale(.7)}45%{transform:scale(1.05)}80%{transform:scale(.95)}100%{transform:scale(1)}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(.5);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(.4);opacity:0}50%{margin-top:1.625em;transform:scale(.4);opacity:0}80%{margin-top:-.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto!important}body.swal2-no-backdrop .swal2-container{background-color:transparent!important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px rgba(0,0,0,.4)}@media print{body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown){overflow-y:scroll!important}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown) .swal2-container{position:static!important}}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:transparent;pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{top:0;right:auto;bottom:auto;left:50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{top:0;right:0;bottom:auto;left:auto}body.swal2-toast-shown .swal2-container.swal2-top-left,body.swal2-toast-shown .swal2-container.swal2-top-start{top:0;right:auto;bottom:auto;left:0}body.swal2-toast-shown .swal2-container.swal2-center-left,body.swal2-toast-shown .swal2-container.swal2-center-start{top:50%;right:auto;bottom:auto;left:0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{top:50%;right:auto;bottom:auto;left:50%;transform:translate(-50%,-50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{top:50%;right:0;bottom:auto;left:auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-left,body.swal2-toast-shown .swal2-container.swal2-bottom-start{top:auto;right:auto;bottom:0;left:0}body.swal2-toast-shown .swal2-container.swal2-bottom{top:auto;right:auto;bottom:0;left:50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{top:auto;right:0;bottom:0;left:auto}')},655:(Bi,Zt,fe)=>{"use strict";function Ke(Jt,$t,en,an){return new(en||(en=Promise))(function(An,Sn){function Mi(_i){try{wi(an.next(_i))}catch(Ki){Sn(Ki)}}function mr(_i){try{wi(an.throw(_i))}catch(Ki){Sn(Ki)}}function wi(_i){_i.done?An(_i.value):function Yt(An){return An instanceof en?An:new en(function(Sn){Sn(An)})}(_i.value).then(Mi,mr)}wi((an=an.apply(Jt,$t||[])).next())})}function tn(Jt){return this instanceof tn?(this.v=Jt,this):new tn(Jt)}function kt(Jt,$t,en){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Yt,an=en.apply(Jt,$t||[]),An=[];return Yt={},Sn("next"),Sn("throw"),Sn("return"),Yt[Symbol.asyncIterator]=function(){return this},Yt;function Sn(ui){an[ui]&&(Yt[ui]=function(Ti){return new Promise(function(Br,yn){An.push([ui,Ti,Br,yn])>1||Mi(ui,Ti)})})}function Mi(ui,Ti){try{!function mr(ui){ui.value instanceof tn?Promise.resolve(ui.value.v).then(wi,_i):Ki(An[0][2],ui)}(an[ui](Ti))}catch(Br){Ki(An[0][3],Br)}}function wi(ui){Mi("next",ui)}function _i(ui){Mi("throw",ui)}function Ki(ui,Ti){ui(Ti),An.shift(),An.length&&Mi(An[0][0],An[0][1])}}function Qn(Jt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var en,$t=Jt[Symbol.asyncIterator];return $t?$t.call(Jt):(Jt=function wt(Jt){var $t="function"==typeof Symbol&&Symbol.iterator,en=$t&&Jt[$t],an=0;if(en)return en.call(Jt);if(Jt&&"number"==typeof Jt.length)return{next:function(){return Jt&&an>=Jt.length&&(Jt=void 0),{value:Jt&&Jt[an++],done:!Jt}}};throw new TypeError($t?"Object is not iterable.":"Symbol.iterator is not defined.")}(Jt),en={},an("next"),an("throw"),an("return"),en[Symbol.asyncIterator]=function(){return this},en);function an(An){en[An]=Jt[An]&&function(Sn){return new Promise(function(Mi,mr){!function Yt(An,Sn,Mi,mr){Promise.resolve(mr).then(function(wi){An({value:wi,done:Mi})},Sn)}(Mi,mr,(Sn=Jt[An](Sn)).done,Sn.value)})}}}fe.d(Zt,{mG:()=>Ke,qq:()=>tn,FC:()=>kt,KL:()=>Qn})},9808:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{mr:()=>dn,ez:()=>Aa,K0:()=>At,uU:()=>Qi,JJ:()=>Oo,Do:()=>on,V_:()=>_t,Ye:()=>Cn,S$:()=>tn,mk:()=>Xi,sg:()=>Ji,O5:()=>Ss,PC:()=>zr,tP:()=>rs,b0:()=>Qn,lw:()=>Ke,EM:()=>V,JF:()=>Le,NF:()=>fs,w_:()=>lt,bD:()=>ds,q:()=>A,Mx:()=>Fi,HT:()=>oe});var D=fe(4893);let N=null;function A(){return N}function oe(Y){N||(N=Y)}class lt{}const At=new D.OlP("DocumentToken");let Ke=(()=>{class Y{historyGo(ee){throw new Error("Not implemented")}}return Y.\u0275fac=function(ee){return new(ee||Y)},Y.\u0275prov=D.Yz7({token:Y,factory:function(){return function ct(){return(0,D.LFG)(Nt)}()},providedIn:"platform"}),Y})();const _t=new D.OlP("Location Initialized");let Nt=(()=>{class Y extends Ke{constructor(ee){super(),this._doc=ee,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return A().getBaseHref(this._doc)}onPopState(ee){const be=A().getGlobalEventTarget(this._doc,"window");return be.addEventListener("popstate",ee,!1),()=>be.removeEventListener("popstate",ee)}onHashChange(ee){const be=A().getGlobalEventTarget(this._doc,"window");return be.addEventListener("hashchange",ee,!1),()=>be.removeEventListener("hashchange",ee)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(ee){this.location.pathname=ee}pushState(ee,be,je){wt()?this._history.pushState(ee,be,je):this.location.hash=je}replaceState(ee,be,je){wt()?this._history.replaceState(ee,be,je):this.location.hash=je}forward(){this._history.forward()}back(){this._history.back()}historyGo(ee=0){this._history.go(ee)}getState(){return this._history.state}}return Y.\u0275fac=function(ee){return new(ee||Y)(D.LFG(At))},Y.\u0275prov=D.Yz7({token:Y,factory:function(){return function Bt(){return new Nt((0,D.LFG)(At))}()},providedIn:"platform"}),Y})();function wt(){return!!window.history.pushState}function st(Y,le){if(0==Y.length)return le;if(0==le.length)return Y;let ee=0;return Y.endsWith("/")&&ee++,le.startsWith("/")&&ee++,2==ee?Y+le.substring(1):1==ee?Y+le:Y+"/"+le}function at(Y){const le=Y.match(/#|\?|$/),ee=le&&le.index||Y.length;return Y.slice(0,ee-("/"===Y[ee-1]?1:0))+Y.slice(ee)}function ft(Y){return Y&&"?"!==Y[0]?"?"+Y:Y}let tn=(()=>{class Y{historyGo(ee){throw new Error("Not implemented")}}return Y.\u0275fac=function(ee){return new(ee||Y)},Y.\u0275prov=D.Yz7({token:Y,factory:function(){return function kt(Y){const le=(0,D.LFG)(At).location;return new Qn((0,D.LFG)(Ke),le&&le.origin||"")}()},providedIn:"root"}),Y})();const dn=new D.OlP("appBaseHref");let Qn=(()=>{class Y extends tn{constructor(ee,be){if(super(),this._platformLocation=ee,this._removeListenerFns=[],null==be&&(be=this._platformLocation.getBaseHrefFromDOM()),null==be)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=be}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(ee){this._removeListenerFns.push(this._platformLocation.onPopState(ee),this._platformLocation.onHashChange(ee))}getBaseHref(){return this._baseHref}prepareExternalUrl(ee){return st(this._baseHref,ee)}path(ee=!1){const be=this._platformLocation.pathname+ft(this._platformLocation.search),je=this._platformLocation.hash;return je&&ee?`${be}${je}`:be}pushState(ee,be,je,Ye){const mt=this.prepareExternalUrl(je+ft(Ye));this._platformLocation.pushState(ee,be,mt)}replaceState(ee,be,je,Ye){const mt=this.prepareExternalUrl(je+ft(Ye));this._platformLocation.replaceState(ee,be,mt)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(ee=0){var be,je;null===(je=(be=this._platformLocation).historyGo)||void 0===je||je.call(be,ee)}}return Y.\u0275fac=function(ee){return new(ee||Y)(D.LFG(Ke),D.LFG(dn,8))},Y.\u0275prov=D.Yz7({token:Y,factory:Y.\u0275fac}),Y})(),on=(()=>{class Y extends tn{constructor(ee,be){super(),this._platformLocation=ee,this._baseHref="",this._removeListenerFns=[],null!=be&&(this._baseHref=be)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(ee){this._removeListenerFns.push(this._platformLocation.onPopState(ee),this._platformLocation.onHashChange(ee))}getBaseHref(){return this._baseHref}path(ee=!1){let be=this._platformLocation.hash;return null==be&&(be="#"),be.length>0?be.substring(1):be}prepareExternalUrl(ee){const be=st(this._baseHref,ee);return be.length>0?"#"+be:be}pushState(ee,be,je,Ye){let mt=this.prepareExternalUrl(je+ft(Ye));0==mt.length&&(mt=this._platformLocation.pathname),this._platformLocation.pushState(ee,be,mt)}replaceState(ee,be,je,Ye){let mt=this.prepareExternalUrl(je+ft(Ye));0==mt.length&&(mt=this._platformLocation.pathname),this._platformLocation.replaceState(ee,be,mt)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(ee=0){var be,je;null===(je=(be=this._platformLocation).historyGo)||void 0===je||je.call(be,ee)}}return Y.\u0275fac=function(ee){return new(ee||Y)(D.LFG(Ke),D.LFG(dn,8))},Y.\u0275prov=D.Yz7({token:Y,factory:Y.\u0275fac}),Y})(),Cn=(()=>{class Y{constructor(ee,be){this._subject=new D.vpe,this._urlChangeListeners=[],this._platformStrategy=ee;const je=this._platformStrategy.getBaseHref();this._platformLocation=be,this._baseHref=at(ii(je)),this._platformStrategy.onPopState(Ye=>{this._subject.emit({url:this.path(!0),pop:!0,state:Ye.state,type:Ye.type})})}path(ee=!1){return this.normalize(this._platformStrategy.path(ee))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(ee,be=""){return this.path()==this.normalize(ee+ft(be))}normalize(ee){return Y.stripTrailingSlash(function Wi(Y,le){return Y&&le.startsWith(Y)?le.substring(Y.length):le}(this._baseHref,ii(ee)))}prepareExternalUrl(ee){return ee&&"/"!==ee[0]&&(ee="/"+ee),this._platformStrategy.prepareExternalUrl(ee)}go(ee,be="",je=null){this._platformStrategy.pushState(je,"",ee,be),this._notifyUrlChangeListeners(this.prepareExternalUrl(ee+ft(be)),je)}replaceState(ee,be="",je=null){this._platformStrategy.replaceState(je,"",ee,be),this._notifyUrlChangeListeners(this.prepareExternalUrl(ee+ft(be)),je)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(ee=0){var be,je;null===(je=(be=this._platformStrategy).historyGo)||void 0===je||je.call(be,ee)}onUrlChange(ee){this._urlChangeListeners.push(ee),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(be=>{this._notifyUrlChangeListeners(be.url,be.state)}))}_notifyUrlChangeListeners(ee="",be){this._urlChangeListeners.forEach(je=>je(ee,be))}subscribe(ee,be,je){return this._subject.subscribe({next:ee,error:be,complete:je})}}return Y.normalizeQueryParams=ft,Y.joinWithSlash=st,Y.stripTrailingSlash=at,Y.\u0275fac=function(ee){return new(ee||Y)(D.LFG(tn),D.LFG(Ke))},Y.\u0275prov=D.Yz7({token:Y,factory:function(){return function se(){return new Cn((0,D.LFG)(tn),(0,D.LFG)(Ke))}()},providedIn:"root"}),Y})();function ii(Y){return Y.replace(/\/index.html$/,"")}var Ci=(()=>((Ci=Ci||{})[Ci.Decimal=0]="Decimal",Ci[Ci.Percent=1]="Percent",Ci[Ci.Currency=2]="Currency",Ci[Ci.Scientific=3]="Scientific",Ci))(),$t=(()=>(($t=$t||{})[$t.Format=0]="Format",$t[$t.Standalone=1]="Standalone",$t))(),en=(()=>((en=en||{})[en.Narrow=0]="Narrow",en[en.Abbreviated=1]="Abbreviated",en[en.Wide=2]="Wide",en[en.Short=3]="Short",en))(),an=(()=>((an=an||{})[an.Short=0]="Short",an[an.Medium=1]="Medium",an[an.Long=2]="Long",an[an.Full=3]="Full",an))(),Yt=(()=>((Yt=Yt||{})[Yt.Decimal=0]="Decimal",Yt[Yt.Group=1]="Group",Yt[Yt.List=2]="List",Yt[Yt.PercentSign=3]="PercentSign",Yt[Yt.PlusSign=4]="PlusSign",Yt[Yt.MinusSign=5]="MinusSign",Yt[Yt.Exponential=6]="Exponential",Yt[Yt.SuperscriptingExponent=7]="SuperscriptingExponent",Yt[Yt.PerMille=8]="PerMille",Yt[Yt.Infinity=9]="Infinity",Yt[Yt.NaN=10]="NaN",Yt[Yt.TimeSeparator=11]="TimeSeparator",Yt[Yt.CurrencyDecimal=12]="CurrencyDecimal",Yt[Yt.CurrencyGroup=13]="CurrencyGroup",Yt))();function Ti(Y,le){return qr((0,D.cg1)(Y)[D.wAp.DateFormat],le)}function Br(Y,le){return qr((0,D.cg1)(Y)[D.wAp.TimeFormat],le)}function yn(Y,le){return qr((0,D.cg1)(Y)[D.wAp.DateTimeFormat],le)}function oi(Y,le){const ee=(0,D.cg1)(Y),be=ee[D.wAp.NumberSymbols][le];if(void 0===be){if(le===Yt.CurrencyDecimal)return ee[D.wAp.NumberSymbols][Yt.Decimal];if(le===Yt.CurrencyGroup)return ee[D.wAp.NumberSymbols][Yt.Group]}return be}function Zr(Y){if(!Y[D.wAp.ExtraData])throw new Error(`Missing extra locale data for the locale "${Y[D.wAp.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function qr(Y,le){for(let ee=le;ee>-1;ee--)if(void 0!==Y[ee])return Y[ee];throw new Error("Locale data API: locale data undefined")}function no(Y){const[le,ee]=Y.split(":");return{hours:+le,minutes:+ee}}const Ot=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,Dt={},Nn=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var nn=(()=>((nn=nn||{})[nn.Short=0]="Short",nn[nn.ShortGMT=1]="ShortGMT",nn[nn.Long=2]="Long",nn[nn.Extended=3]="Extended",nn))(),jn=(()=>((jn=jn||{})[jn.FullYear=0]="FullYear",jn[jn.Month=1]="Month",jn[jn.Date=2]="Date",jn[jn.Hours=3]="Hours",jn[jn.Minutes=4]="Minutes",jn[jn.Seconds=5]="Seconds",jn[jn.FractionalSeconds=6]="FractionalSeconds",jn[jn.Day=7]="Day",jn))(),pi=(()=>((pi=pi||{})[pi.DayPeriods=0]="DayPeriods",pi[pi.Days=1]="Days",pi[pi.Months=2]="Months",pi[pi.Eras=3]="Eras",pi))();function to(Y,le,ee,be){let je=function Rt(Y){if(Kt(Y))return Y;if("number"==typeof Y&&!isNaN(Y))return new Date(Y);if("string"==typeof Y){if(Y=Y.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(Y)){const[je,Ye=1,mt=1]=Y.split("-").map(On=>+On);return Li(je,Ye-1,mt)}const ee=parseFloat(Y);if(!isNaN(Y-ee))return new Date(ee);let be;if(be=Y.match(Ot))return function nt(Y){const le=new Date(0);let ee=0,be=0;const je=Y[8]?le.setUTCFullYear:le.setFullYear,Ye=Y[8]?le.setUTCHours:le.setHours;Y[9]&&(ee=Number(Y[9]+Y[10]),be=Number(Y[9]+Y[11])),je.call(le,Number(Y[1]),Number(Y[2])-1,Number(Y[3]));const mt=Number(Y[4]||0)-ee,On=Number(Y[5]||0)-be,Ui=Number(Y[6]||0),wn=Math.floor(1e3*parseFloat("0."+(Y[7]||0)));return Ye.call(le,mt,On,Ui,wn),le}(be)}const le=new Date(Y);if(!Kt(le))throw new Error(`Unable to convert "${Y}" into a date`);return le}(Y);le=$r(ee,le)||le;let On,mt=[];for(;le;){if(On=Nn.exec(le),!On){mt.push(le);break}{mt=mt.concat(On.slice(1));const er=mt.pop();if(!er)break;le=er}}let Ui=je.getTimezoneOffset();be&&(Ui=Xe(be,Ui),je=function Gt(Y,le,ee){const be=ee?-1:1,je=Y.getTimezoneOffset();return function xt(Y,le){return(Y=new Date(Y.getTime())).setMinutes(Y.getMinutes()+le),Y}(Y,be*(Xe(le,je)-je))}(je,be,!0));let wn="";return mt.forEach(er=>{const ji=function We(Y){if(Me[Y])return Me[Y];let le;switch(Y){case"G":case"GG":case"GGG":le=sr(pi.Eras,en.Abbreviated);break;case"GGGG":le=sr(pi.Eras,en.Wide);break;case"GGGGG":le=sr(pi.Eras,en.Narrow);break;case"y":le=ei(jn.FullYear,1,0,!1,!0);break;case"yy":le=ei(jn.FullYear,2,0,!0,!0);break;case"yyy":le=ei(jn.FullYear,3,0,!1,!0);break;case"yyyy":le=ei(jn.FullYear,4,0,!1,!0);break;case"Y":le=Te(1);break;case"YY":le=Te(2,!0);break;case"YYY":le=Te(3);break;case"YYYY":le=Te(4);break;case"M":case"L":le=ei(jn.Month,1,1);break;case"MM":case"LL":le=ei(jn.Month,2,1);break;case"MMM":le=sr(pi.Months,en.Abbreviated);break;case"MMMM":le=sr(pi.Months,en.Wide);break;case"MMMMM":le=sr(pi.Months,en.Narrow);break;case"LLL":le=sr(pi.Months,en.Abbreviated,$t.Standalone);break;case"LLLL":le=sr(pi.Months,en.Wide,$t.Standalone);break;case"LLLLL":le=sr(pi.Months,en.Narrow,$t.Standalone);break;case"w":le=qe(1);break;case"ww":le=qe(2);break;case"W":le=qe(1,!0);break;case"d":le=ei(jn.Date,1);break;case"dd":le=ei(jn.Date,2);break;case"c":case"cc":le=ei(jn.Day,1);break;case"ccc":le=sr(pi.Days,en.Abbreviated,$t.Standalone);break;case"cccc":le=sr(pi.Days,en.Wide,$t.Standalone);break;case"ccccc":le=sr(pi.Days,en.Narrow,$t.Standalone);break;case"cccccc":le=sr(pi.Days,en.Short,$t.Standalone);break;case"E":case"EE":case"EEE":le=sr(pi.Days,en.Abbreviated);break;case"EEEE":le=sr(pi.Days,en.Wide);break;case"EEEEE":le=sr(pi.Days,en.Narrow);break;case"EEEEEE":le=sr(pi.Days,en.Short);break;case"a":case"aa":case"aaa":le=sr(pi.DayPeriods,en.Abbreviated);break;case"aaaa":le=sr(pi.DayPeriods,en.Wide);break;case"aaaaa":le=sr(pi.DayPeriods,en.Narrow);break;case"b":case"bb":case"bbb":le=sr(pi.DayPeriods,en.Abbreviated,$t.Standalone,!0);break;case"bbbb":le=sr(pi.DayPeriods,en.Wide,$t.Standalone,!0);break;case"bbbbb":le=sr(pi.DayPeriods,en.Narrow,$t.Standalone,!0);break;case"B":case"BB":case"BBB":le=sr(pi.DayPeriods,en.Abbreviated,$t.Format,!0);break;case"BBBB":le=sr(pi.DayPeriods,en.Wide,$t.Format,!0);break;case"BBBBB":le=sr(pi.DayPeriods,en.Narrow,$t.Format,!0);break;case"h":le=ei(jn.Hours,1,-12);break;case"hh":le=ei(jn.Hours,2,-12);break;case"H":le=ei(jn.Hours,1);break;case"HH":le=ei(jn.Hours,2);break;case"m":le=ei(jn.Minutes,1);break;case"mm":le=ei(jn.Minutes,2);break;case"s":le=ei(jn.Seconds,1);break;case"ss":le=ei(jn.Seconds,2);break;case"S":le=ei(jn.FractionalSeconds,1);break;case"SS":le=ei(jn.FractionalSeconds,2);break;case"SSS":le=ei(jn.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":le=ir(nn.Short);break;case"ZZZZZ":le=ir(nn.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":le=ir(nn.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":le=ir(nn.Long);break;default:return null}return Me[Y]=le,le}(er);wn+=ji?ji(je,ee,Ui):"''"===er?"'":er.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),wn}function Li(Y,le,ee){const be=new Date(0);return be.setFullYear(Y,le,ee),be.setHours(0,0,0),be}function $r(Y,le){const ee=function Sn(Y){return(0,D.cg1)(Y)[D.wAp.LocaleId]}(Y);if(Dt[ee]=Dt[ee]||{},Dt[ee][le])return Dt[ee][le];let be="";switch(le){case"shortDate":be=Ti(Y,an.Short);break;case"mediumDate":be=Ti(Y,an.Medium);break;case"longDate":be=Ti(Y,an.Long);break;case"fullDate":be=Ti(Y,an.Full);break;case"shortTime":be=Br(Y,an.Short);break;case"mediumTime":be=Br(Y,an.Medium);break;case"longTime":be=Br(Y,an.Long);break;case"fullTime":be=Br(Y,an.Full);break;case"short":const je=$r(Y,"shortTime"),Ye=$r(Y,"shortDate");be=Vr(yn(Y,an.Short),[je,Ye]);break;case"medium":const mt=$r(Y,"mediumTime"),On=$r(Y,"mediumDate");be=Vr(yn(Y,an.Medium),[mt,On]);break;case"long":const Ui=$r(Y,"longTime"),wn=$r(Y,"longDate");be=Vr(yn(Y,an.Long),[Ui,wn]);break;case"full":const er=$r(Y,"fullTime"),ji=$r(Y,"fullDate");be=Vr(yn(Y,an.Full),[er,ji])}return be&&(Dt[ee][le]=be),be}function Vr(Y,le){return le&&(Y=Y.replace(/\{([^}]+)}/g,function(ee,be){return null!=le&&be in le?le[be]:ee})),Y}function fo(Y,le,ee="-",be,je){let Ye="";(Y<0||je&&Y<=0)&&(je?Y=1-Y:(Y=-Y,Ye=ee));let mt=String(Y);for(;mt.length<le;)mt="0"+mt;return be&&(mt=mt.substr(mt.length-le)),Ye+mt}function ei(Y,le,ee=0,be=!1,je=!1){return function(Ye,mt){let On=function fr(Y,le){switch(Y){case jn.FullYear:return le.getFullYear();case jn.Month:return le.getMonth();case jn.Date:return le.getDate();case jn.Hours:return le.getHours();case jn.Minutes:return le.getMinutes();case jn.Seconds:return le.getSeconds();case jn.FractionalSeconds:return le.getMilliseconds();case jn.Day:return le.getDay();default:throw new Error(`Unknown DateType value "${Y}".`)}}(Y,Ye);if((ee>0||On>-ee)&&(On+=ee),Y===jn.Hours)0===On&&-12===ee&&(On=12);else if(Y===jn.FractionalSeconds)return function vo(Y,le){return fo(Y,3).substr(0,le)}(On,le);const Ui=oi(mt,Yt.MinusSign);return fo(On,le,Ui,be,je)}}function sr(Y,le,ee=$t.Format,be=!1){return function(je,Ye){return function Io(Y,le,ee,be,je,Ye){switch(ee){case pi.Months:return function wi(Y,le,ee){const be=(0,D.cg1)(Y),Ye=qr([be[D.wAp.MonthsFormat],be[D.wAp.MonthsStandalone]],le);return qr(Ye,ee)}(le,je,be)[Y.getMonth()];case pi.Days:return function mr(Y,le,ee){const be=(0,D.cg1)(Y),Ye=qr([be[D.wAp.DaysFormat],be[D.wAp.DaysStandalone]],le);return qr(Ye,ee)}(le,je,be)[Y.getDay()];case pi.DayPeriods:const mt=Y.getHours(),On=Y.getMinutes();if(Ye){const wn=function Ur(Y){const le=(0,D.cg1)(Y);return Zr(le),(le[D.wAp.ExtraData][2]||[]).map(be=>"string"==typeof be?no(be):[no(be[0]),no(be[1])])}(le),er=function Mn(Y,le,ee){const be=(0,D.cg1)(Y);Zr(be);const Ye=qr([be[D.wAp.ExtraData][0],be[D.wAp.ExtraData][1]],le)||[];return qr(Ye,ee)||[]}(le,je,be),ji=wn.findIndex(Lr=>{if(Array.isArray(Lr)){const[Zi,bi]=Lr,ge=mt>=Zi.hours&&On>=Zi.minutes,he=mt<bi.hours||mt===bi.hours&&On<bi.minutes;if(Zi.hours<bi.hours){if(ge&&he)return!0}else if(ge||he)return!0}else if(Lr.hours===mt&&Lr.minutes===On)return!0;return!1});if(-1!==ji)return er[ji]}return function Mi(Y,le,ee){const be=(0,D.cg1)(Y),Ye=qr([be[D.wAp.DayPeriodsFormat],be[D.wAp.DayPeriodsStandalone]],le);return qr(Ye,ee)}(le,je,be)[mt<12?0:1];case pi.Eras:return function _i(Y,le){return qr((0,D.cg1)(Y)[D.wAp.Eras],le)}(le,be)[Y.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${ee}`)}}(je,Ye,Y,le,ee,be)}}function ir(Y){return function(le,ee,be){const je=-1*be,Ye=oi(ee,Yt.MinusSign),mt=je>0?Math.floor(je/60):Math.ceil(je/60);switch(Y){case nn.Short:return(je>=0?"+":"")+fo(mt,2,Ye)+fo(Math.abs(je%60),2,Ye);case nn.ShortGMT:return"GMT"+(je>=0?"+":"")+fo(mt,1,Ye);case nn.Long:return"GMT"+(je>=0?"+":"")+fo(mt,2,Ye)+":"+fo(Math.abs(je%60),2,Ye);case nn.Extended:return 0===be?"Z":(je>=0?"+":"")+fo(mt,2,Ye)+":"+fo(Math.abs(je%60),2,Ye);default:throw new Error(`Unknown zone width "${Y}"`)}}}function Ds(Y){return Li(Y.getFullYear(),Y.getMonth(),Y.getDate()+(4-Y.getDay()))}function qe(Y,le=!1){return function(ee,be){let je;if(le){const Ye=new Date(ee.getFullYear(),ee.getMonth(),1).getDay()-1,mt=ee.getDate();je=1+Math.floor((mt+Ye)/7)}else{const Ye=Ds(ee),mt=function To(Y){const le=Li(Y,0,1).getDay();return Li(Y,0,1+(le<=4?4:11)-le)}(Ye.getFullYear()),On=Ye.getTime()-mt.getTime();je=1+Math.round(On/6048e5)}return fo(je,Y,oi(be,Yt.MinusSign))}}function Te(Y,le=!1){return function(ee,be){return fo(Ds(ee).getFullYear(),Y,oi(be,Yt.MinusSign),le)}}const Me={};function Xe(Y,le){Y=Y.replace(/:/g,"");const ee=Date.parse("Jan 01, 1970 00:00:00 "+Y)/6e4;return isNaN(ee)?le:ee}function Kt(Y){return Y instanceof Date&&!isNaN(Y.valueOf())}const Dn=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function hr(Y){const le=parseInt(Y);if(isNaN(le))throw new Error("Invalid integer literal when parsing "+Y);return le}function Fi(Y,le){le=encodeURIComponent(le);for(const ee of Y.split(";")){const be=ee.indexOf("="),[je,Ye]=-1==be?[ee,""]:[ee.slice(0,be),ee.slice(be+1)];if(je.trim()===le)return decodeURIComponent(Ye)}return null}let Xi=(()=>{class Y{constructor(ee,be,je,Ye){this._iterableDiffers=ee,this._keyValueDiffers=be,this._ngEl=je,this._renderer=Ye,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(ee){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof ee?ee.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(ee){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof ee?ee.split(/\s+/):ee,this._rawClass&&((0,D.sIi)(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const ee=this._iterableDiffer.diff(this._rawClass);ee&&this._applyIterableChanges(ee)}else if(this._keyValueDiffer){const ee=this._keyValueDiffer.diff(this._rawClass);ee&&this._applyKeyValueChanges(ee)}}_applyKeyValueChanges(ee){ee.forEachAddedItem(be=>this._toggleClass(be.key,be.currentValue)),ee.forEachChangedItem(be=>this._toggleClass(be.key,be.currentValue)),ee.forEachRemovedItem(be=>{be.previousValue&&this._toggleClass(be.key,!1)})}_applyIterableChanges(ee){ee.forEachAddedItem(be=>{if("string"!=typeof be.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${(0,D.AaK)(be.item)}`);this._toggleClass(be.item,!0)}),ee.forEachRemovedItem(be=>this._toggleClass(be.item,!1))}_applyClasses(ee){ee&&(Array.isArray(ee)||ee instanceof Set?ee.forEach(be=>this._toggleClass(be,!0)):Object.keys(ee).forEach(be=>this._toggleClass(be,!!ee[be])))}_removeClasses(ee){ee&&(Array.isArray(ee)||ee instanceof Set?ee.forEach(be=>this._toggleClass(be,!1)):Object.keys(ee).forEach(be=>this._toggleClass(be,!1)))}_toggleClass(ee,be){(ee=ee.trim())&&ee.split(/\s+/g).forEach(je=>{be?this._renderer.addClass(this._ngEl.nativeElement,je):this._renderer.removeClass(this._ngEl.nativeElement,je)})}}return Y.\u0275fac=function(ee){return new(ee||Y)(D.Y36(D.ZZ4),D.Y36(D.aQg),D.Y36(D.SBq),D.Y36(D.Qsj))},Y.\u0275dir=D.lG2({type:Y,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),Y})();class yi{constructor(le,ee,be,je){this.$implicit=le,this.ngForOf=ee,this.index=be,this.count=je}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Ji=(()=>{class Y{constructor(ee,be,je){this._viewContainer=ee,this._template=be,this._differs=je,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(ee){this._ngForOf=ee,this._ngForOfDirty=!0}set ngForTrackBy(ee){this._trackByFn=ee}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(ee){ee&&(this._template=ee)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const ee=this._ngForOf;!this._differ&&ee&&(this._differ=this._differs.find(ee).create(this.ngForTrackBy))}if(this._differ){const ee=this._differ.diff(this._ngForOf);ee&&this._applyChanges(ee)}}_applyChanges(ee){const be=this._viewContainer;ee.forEachOperation((je,Ye,mt)=>{if(null==je.previousIndex)be.createEmbeddedView(this._template,new yi(je.item,this._ngForOf,-1,-1),null===mt?void 0:mt);else if(null==mt)be.remove(null===Ye?void 0:Ye);else if(null!==Ye){const On=be.get(Ye);be.move(On,mt),Ko(On,je)}});for(let je=0,Ye=be.length;je<Ye;je++){const On=be.get(je).context;On.index=je,On.count=Ye,On.ngForOf=this._ngForOf}ee.forEachIdentityChange(je=>{Ko(be.get(je.currentIndex),je)})}static ngTemplateContextGuard(ee,be){return!0}}return Y.\u0275fac=function(ee){return new(ee||Y)(D.Y36(D.s_b),D.Y36(D.Rgc),D.Y36(D.ZZ4))},Y.\u0275dir=D.lG2({type:Y,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),Y})();function Ko(Y,le){Y.context.$implicit=le.item}let Ss=(()=>{class Y{constructor(ee,be){this._viewContainer=ee,this._context=new Hi,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=be}set ngIf(ee){this._context.$implicit=this._context.ngIf=ee,this._updateView()}set ngIfThen(ee){lr("ngIfThen",ee),this._thenTemplateRef=ee,this._thenViewRef=null,this._updateView()}set ngIfElse(ee){lr("ngIfElse",ee),this._elseTemplateRef=ee,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(ee,be){return!0}}return Y.\u0275fac=function(ee){return new(ee||Y)(D.Y36(D.s_b),D.Y36(D.Rgc))},Y.\u0275dir=D.lG2({type:Y,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),Y})();class Hi{constructor(){this.$implicit=null,this.ngIf=null}}function lr(Y,le){if(le&&!le.createEmbeddedView)throw new Error(`${Y} must be a TemplateRef, but received '${(0,D.AaK)(le)}'.`)}let zr=(()=>{class Y{constructor(ee,be,je){this._ngEl=ee,this._differs=be,this._renderer=je,this._ngStyle=null,this._differ=null}set ngStyle(ee){this._ngStyle=ee,!this._differ&&ee&&(this._differ=this._differs.find(ee).create())}ngDoCheck(){if(this._differ){const ee=this._differ.diff(this._ngStyle);ee&&this._applyChanges(ee)}}_setStyle(ee,be){const[je,Ye]=ee.split(".");null!=(be=null!=be&&Ye?`${be}${Ye}`:be)?this._renderer.setStyle(this._ngEl.nativeElement,je,be):this._renderer.removeStyle(this._ngEl.nativeElement,je)}_applyChanges(ee){ee.forEachRemovedItem(be=>this._setStyle(be.key,null)),ee.forEachAddedItem(be=>this._setStyle(be.key,be.currentValue)),ee.forEachChangedItem(be=>this._setStyle(be.key,be.currentValue))}}return Y.\u0275fac=function(ee){return new(ee||Y)(D.Y36(D.SBq),D.Y36(D.aQg),D.Y36(D.Qsj))},Y.\u0275dir=D.lG2({type:Y,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"}}),Y})(),rs=(()=>{class Y{constructor(ee){this._viewContainerRef=ee,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null}ngOnChanges(ee){if(ee.ngTemplateOutlet){const be=this._viewContainerRef;this._viewRef&&be.remove(be.indexOf(this._viewRef)),this._viewRef=this.ngTemplateOutlet?be.createEmbeddedView(this.ngTemplateOutlet,this.ngTemplateOutletContext):null}else this._viewRef&&ee.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return Y.\u0275fac=function(ee){return new(ee||Y)(D.Y36(D.s_b))},Y.\u0275dir=D.lG2({type:Y,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet"},features:[D.TTD]}),Y})();function Ir(Y,le){return new D.vHH(2100,"")}const ul=new D.OlP("DATE_PIPE_DEFAULT_TIMEZONE");let Qi=(()=>{class Y{constructor(ee,be){this.locale=ee,this.defaultTimezone=be}transform(ee,be="mediumDate",je,Ye){var mt;if(null==ee||""===ee||ee!=ee)return null;try{return to(ee,be,Ye||this.locale,null!==(mt=null!=je?je:this.defaultTimezone)&&void 0!==mt?mt:void 0)}catch(On){throw Ir()}}}return Y.\u0275fac=function(ee){return new(ee||Y)(D.Y36(D.soG,16),D.Y36(ul,24))},Y.\u0275pipe=D.Yjl({name:"date",type:Y,pure:!0}),Y})(),Oo=(()=>{class Y{constructor(ee){this._locale=ee}transform(ee,be,je){if(!function Xo(Y){return!(null==Y||""===Y||Y!=Y)}(ee))return null;je=je||this._locale;try{return function qt(Y,le,ee){return function Pn(Y,le,ee,be,je,Ye,mt=!1){let On="",Ui=!1;if(isFinite(Y)){let wn=function Rn(Y){let be,je,Ye,mt,On,le=Math.abs(Y)+"",ee=0;for((je=le.indexOf("."))>-1&&(le=le.replace(".","")),(Ye=le.search(/e/i))>0?(je<0&&(je=Ye),je+=+le.slice(Ye+1),le=le.substring(0,Ye)):je<0&&(je=le.length),Ye=0;"0"===le.charAt(Ye);Ye++);if(Ye===(On=le.length))be=[0],je=1;else{for(On--;"0"===le.charAt(On);)On--;for(je-=Ye,be=[],mt=0;Ye<=On;Ye++,mt++)be[mt]=Number(le.charAt(Ye))}return je>22&&(be=be.splice(0,21),ee=je-1,je=1),{digits:be,exponent:ee,integerLen:je}}(Y);mt&&(wn=function gr(Y){if(0===Y.digits[0])return Y;const le=Y.digits.length-Y.integerLen;return Y.exponent?Y.exponent+=2:(0===le?Y.digits.push(0,0):1===le&&Y.digits.push(0),Y.integerLen+=2),Y}(wn));let er=le.minInt,ji=le.minFrac,Lr=le.maxFrac;if(Ye){const Re=Ye.match(Dn);if(null===Re)throw new Error(`${Ye} is not a valid digit info`);const gn=Re[1],xi=Re[3],vi=Re[5];null!=gn&&(er=hr(gn)),null!=xi&&(ji=hr(xi)),null!=vi?Lr=hr(vi):null!=xi&&ji>Lr&&(Lr=ji)}!function ti(Y,le,ee){if(le>ee)throw new Error(`The minimum number of digits after fraction (${le}) is higher than the maximum (${ee}).`);let be=Y.digits,je=be.length-Y.integerLen;const Ye=Math.min(Math.max(le,je),ee);let mt=Ye+Y.integerLen,On=be[mt];if(mt>0){be.splice(Math.max(Y.integerLen,mt));for(let ji=mt;ji<be.length;ji++)be[ji]=0}else{je=Math.max(0,je),Y.integerLen=1,be.length=Math.max(1,mt=Ye+1),be[0]=0;for(let ji=1;ji<mt;ji++)be[ji]=0}if(On>=5)if(mt-1<0){for(let ji=0;ji>mt;ji--)be.unshift(0),Y.integerLen++;be.unshift(1),Y.integerLen++}else be[mt-1]++;for(;je<Math.max(0,Ye);je++)be.push(0);let Ui=0!==Ye;const wn=le+Y.integerLen,er=be.reduceRight(function(ji,Lr,Zi,bi){return bi[Zi]=(Lr+=ji)<10?Lr:Lr-10,Ui&&(0===bi[Zi]&&Zi>=wn?bi.pop():Ui=!1),Lr>=10?1:0},0);er&&(be.unshift(er),Y.integerLen++)}(wn,ji,Lr);let Zi=wn.digits,bi=wn.integerLen;const ge=wn.exponent;let he=[];for(Ui=Zi.every(Re=>!Re);bi<er;bi++)Zi.unshift(0);for(;bi<0;bi++)Zi.unshift(0);bi>0?he=Zi.splice(bi,Zi.length):(he=Zi,Zi=[0]);const ae=[];for(Zi.length>=le.lgSize&&ae.unshift(Zi.splice(-le.lgSize,Zi.length).join(""));Zi.length>le.gSize;)ae.unshift(Zi.splice(-le.gSize,Zi.length).join(""));Zi.length&&ae.unshift(Zi.join("")),On=ae.join(oi(ee,be)),he.length&&(On+=oi(ee,je)+he.join("")),ge&&(On+=oi(ee,Yt.Exponential)+"+"+ge)}else On=oi(ee,Yt.Infinity);return On=Y<0&&!Ui?le.negPre+On+le.negSuf:le.posPre+On+le.posSuf,On}(Y,function Gr(Y,le="-"){const ee={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},be=Y.split(";"),je=be[0],Ye=be[1],mt=-1!==je.indexOf(".")?je.split("."):[je.substring(0,je.lastIndexOf("0")+1),je.substring(je.lastIndexOf("0")+1)],On=mt[0],Ui=mt[1]||"";ee.posPre=On.substr(0,On.indexOf("#"));for(let er=0;er<Ui.length;er++){const ji=Ui.charAt(er);"0"===ji?ee.minFrac=ee.maxFrac=er+1:"#"===ji?ee.maxFrac=er+1:ee.posSuf+=ji}const wn=On.split(",");if(ee.gSize=wn[1]?wn[1].length:0,ee.lgSize=wn[2]||wn[1]?(wn[2]||wn[1]).length:0,Ye){const er=je.length-ee.posPre.length-ee.posSuf.length,ji=Ye.indexOf("#");ee.negPre=Ye.substr(0,ji).replace(/'/g,""),ee.negSuf=Ye.substr(ji+er).replace(/'/g,"")}else ee.negPre=le+ee.posPre,ee.negSuf=ee.posSuf;return ee}(function Tt(Y,le){return(0,D.cg1)(Y)[D.wAp.NumberFormats][le]}(le,Ci.Decimal),oi(le,Yt.MinusSign)),le,Yt.Group,Yt.Decimal,ee)}(function As(Y){if("string"==typeof Y&&!isNaN(Number(Y)-parseFloat(Y)))return Number(Y);if("number"!=typeof Y)throw new Error(`${Y} is not a number`);return Y}(ee),je,be)}catch(Ye){throw Ir()}}}return Y.\u0275fac=function(ee){return new(ee||Y)(D.Y36(D.soG,16))},Y.\u0275pipe=D.Yjl({name:"number",type:Y,pure:!0}),Y})();let Aa=(()=>{class Y{}return Y.\u0275fac=function(ee){return new(ee||Y)},Y.\u0275mod=D.oAB({type:Y}),Y.\u0275inj=D.cJS({}),Y})();const ds="browser";function fs(Y){return Y===ds}let V=(()=>{class Y{}return Y.\u0275prov=(0,D.Yz7)({token:Y,providedIn:"root",factory:()=>new ne((0,D.LFG)(At),window)}),Y})();class ne{constructor(le,ee){this.document=le,this.window=ee,this.offset=()=>[0,0]}setOffset(le){this.offset=Array.isArray(le)?()=>le:le}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(le){this.supportsScrolling()&&this.window.scrollTo(le[0],le[1])}scrollToAnchor(le){if(!this.supportsScrolling())return;const ee=function Ee(Y,le){const ee=Y.getElementById(le)||Y.getElementsByName(le)[0];if(ee)return ee;if("function"==typeof Y.createTreeWalker&&Y.body&&(Y.body.createShadowRoot||Y.body.attachShadow)){const be=Y.createTreeWalker(Y.body,NodeFilter.SHOW_ELEMENT);let je=be.currentNode;for(;je;){const Ye=je.shadowRoot;if(Ye){const mt=Ye.getElementById(le)||Ye.querySelector(`[name="${le}"]`);if(mt)return mt}je=be.nextNode()}}return null}(this.document,le);ee&&(this.scrollToElement(ee),ee.focus())}setHistoryScrollRestoration(le){if(this.supportScrollRestoration()){const ee=this.window.history;ee&&ee.scrollRestoration&&(ee.scrollRestoration=le)}}scrollToElement(le){const ee=le.getBoundingClientRect(),be=ee.left+this.window.pageXOffset,je=ee.top+this.window.pageYOffset,Ye=this.offset();this.window.scrollTo(be-Ye[0],je-Ye[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const le=ce(this.window.history)||ce(Object.getPrototypeOf(this.window.history));return!(!le||!le.writable&&!le.set)}catch(le){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(le){return!1}}}function ce(Y){return Object.getOwnPropertyDescriptor(Y,"scrollRestoration")}class Le{}},520:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{eN:()=>Yt,JF:()=>no,WM:()=>_t});var D=fe(9808),N=fe(4893),A=fe(9646),l=fe(8306),oe=fe(4351),lt=fe(9300),At=fe(4004);class Ke{}class ct{}class _t{constructor(Ot){this.normalizedNames=new Map,this.lazyUpdate=null,Ot?this.lazyInit="string"==typeof Ot?()=>{this.headers=new Map,Ot.split("\n").forEach(Dt=>{const Nn=Dt.indexOf(":");if(Nn>0){const nn=Dt.slice(0,Nn),jn=nn.toLowerCase(),pi=Dt.slice(Nn+1).trim();this.maybeSetNormalizedName(nn,jn),this.headers.has(jn)?this.headers.get(jn).push(pi):this.headers.set(jn,[pi])}})}:()=>{this.headers=new Map,Object.keys(Ot).forEach(Dt=>{let Nn=Ot[Dt];const nn=Dt.toLowerCase();"string"==typeof Nn&&(Nn=[Nn]),Nn.length>0&&(this.headers.set(nn,Nn),this.maybeSetNormalizedName(Dt,nn))})}:this.headers=new Map}has(Ot){return this.init(),this.headers.has(Ot.toLowerCase())}get(Ot){this.init();const Dt=this.headers.get(Ot.toLowerCase());return Dt&&Dt.length>0?Dt[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(Ot){return this.init(),this.headers.get(Ot.toLowerCase())||null}append(Ot,Dt){return this.clone({name:Ot,value:Dt,op:"a"})}set(Ot,Dt){return this.clone({name:Ot,value:Dt,op:"s"})}delete(Ot,Dt){return this.clone({name:Ot,value:Dt,op:"d"})}maybeSetNormalizedName(Ot,Dt){this.normalizedNames.has(Dt)||this.normalizedNames.set(Dt,Ot)}init(){this.lazyInit&&(this.lazyInit instanceof _t?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(Ot=>this.applyUpdate(Ot)),this.lazyUpdate=null))}copyFrom(Ot){Ot.init(),Array.from(Ot.headers.keys()).forEach(Dt=>{this.headers.set(Dt,Ot.headers.get(Dt)),this.normalizedNames.set(Dt,Ot.normalizedNames.get(Dt))})}clone(Ot){const Dt=new _t;return Dt.lazyInit=this.lazyInit&&this.lazyInit instanceof _t?this.lazyInit:this,Dt.lazyUpdate=(this.lazyUpdate||[]).concat([Ot]),Dt}applyUpdate(Ot){const Dt=Ot.name.toLowerCase();switch(Ot.op){case"a":case"s":let Nn=Ot.value;if("string"==typeof Nn&&(Nn=[Nn]),0===Nn.length)return;this.maybeSetNormalizedName(Ot.name,Dt);const nn=("a"===Ot.op?this.headers.get(Dt):void 0)||[];nn.push(...Nn),this.headers.set(Dt,nn);break;case"d":const jn=Ot.value;if(jn){let pi=this.headers.get(Dt);if(!pi)return;pi=pi.filter(to=>-1===jn.indexOf(to)),0===pi.length?(this.headers.delete(Dt),this.normalizedNames.delete(Dt)):this.headers.set(Dt,pi)}else this.headers.delete(Dt),this.normalizedNames.delete(Dt)}}forEach(Ot){this.init(),Array.from(this.normalizedNames.keys()).forEach(Dt=>Ot(this.normalizedNames.get(Dt),this.headers.get(Dt)))}}class Nt{encodeKey(Ot){return at(Ot)}encodeValue(Ot){return at(Ot)}decodeKey(Ot){return decodeURIComponent(Ot)}decodeValue(Ot){return decodeURIComponent(Ot)}}const Bt=/%(\d[a-f0-9])/gi,st={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function at(cn){return encodeURIComponent(cn).replace(Bt,(Ot,Dt)=>{var Nn;return null!==(Nn=st[Dt])&&void 0!==Nn?Nn:Ot})}function ft(cn){return`${cn}`}class tn{constructor(Ot={}){if(this.updates=null,this.cloneFrom=null,this.encoder=Ot.encoder||new Nt,Ot.fromString){if(Ot.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function wt(cn,Ot){const Dt=new Map;return cn.length>0&&cn.replace(/^\?/,"").split("&").forEach(nn=>{const jn=nn.indexOf("="),[pi,to]=-1==jn?[Ot.decodeKey(nn),""]:[Ot.decodeKey(nn.slice(0,jn)),Ot.decodeValue(nn.slice(jn+1))],Li=Dt.get(pi)||[];Li.push(to),Dt.set(pi,Li)}),Dt}(Ot.fromString,this.encoder)}else Ot.fromObject?(this.map=new Map,Object.keys(Ot.fromObject).forEach(Dt=>{const Nn=Ot.fromObject[Dt];this.map.set(Dt,Array.isArray(Nn)?Nn:[Nn])})):this.map=null}has(Ot){return this.init(),this.map.has(Ot)}get(Ot){this.init();const Dt=this.map.get(Ot);return Dt?Dt[0]:null}getAll(Ot){return this.init(),this.map.get(Ot)||null}keys(){return this.init(),Array.from(this.map.keys())}append(Ot,Dt){return this.clone({param:Ot,value:Dt,op:"a"})}appendAll(Ot){const Dt=[];return Object.keys(Ot).forEach(Nn=>{const nn=Ot[Nn];Array.isArray(nn)?nn.forEach(jn=>{Dt.push({param:Nn,value:jn,op:"a"})}):Dt.push({param:Nn,value:nn,op:"a"})}),this.clone(Dt)}set(Ot,Dt){return this.clone({param:Ot,value:Dt,op:"s"})}delete(Ot,Dt){return this.clone({param:Ot,value:Dt,op:"d"})}toString(){return this.init(),this.keys().map(Ot=>{const Dt=this.encoder.encodeKey(Ot);return this.map.get(Ot).map(Nn=>Dt+"="+this.encoder.encodeValue(Nn)).join("&")}).filter(Ot=>""!==Ot).join("&")}clone(Ot){const Dt=new tn({encoder:this.encoder});return Dt.cloneFrom=this.cloneFrom||this,Dt.updates=(this.updates||[]).concat(Ot),Dt}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(Ot=>this.map.set(Ot,this.cloneFrom.map.get(Ot))),this.updates.forEach(Ot=>{switch(Ot.op){case"a":case"s":const Dt=("a"===Ot.op?this.map.get(Ot.param):void 0)||[];Dt.push(ft(Ot.value)),this.map.set(Ot.param,Dt);break;case"d":if(void 0===Ot.value){this.map.delete(Ot.param);break}{let Nn=this.map.get(Ot.param)||[];const nn=Nn.indexOf(ft(Ot.value));-1!==nn&&Nn.splice(nn,1),Nn.length>0?this.map.set(Ot.param,Nn):this.map.delete(Ot.param)}}}),this.cloneFrom=this.updates=null)}}class dn{constructor(){this.map=new Map}set(Ot,Dt){return this.map.set(Ot,Dt),this}get(Ot){return this.map.has(Ot)||this.map.set(Ot,Ot.defaultValue()),this.map.get(Ot)}delete(Ot){return this.map.delete(Ot),this}has(Ot){return this.map.has(Ot)}keys(){return this.map.keys()}}function on(cn){return"undefined"!=typeof ArrayBuffer&&cn instanceof ArrayBuffer}function Cn(cn){return"undefined"!=typeof Blob&&cn instanceof Blob}function se(cn){return"undefined"!=typeof FormData&&cn instanceof FormData}class ii{constructor(Ot,Dt,Nn,nn){let jn;if(this.url=Dt,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=Ot.toUpperCase(),function Qn(cn){switch(cn){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||nn?(this.body=void 0!==Nn?Nn:null,jn=nn):jn=Nn,jn&&(this.reportProgress=!!jn.reportProgress,this.withCredentials=!!jn.withCredentials,jn.responseType&&(this.responseType=jn.responseType),jn.headers&&(this.headers=jn.headers),jn.context&&(this.context=jn.context),jn.params&&(this.params=jn.params)),this.headers||(this.headers=new _t),this.context||(this.context=new dn),this.params){const pi=this.params.toString();if(0===pi.length)this.urlWithParams=Dt;else{const to=Dt.indexOf("?");this.urlWithParams=Dt+(-1===to?"?":to<Dt.length-1?"&":"")+pi}}else this.params=new tn,this.urlWithParams=Dt}serializeBody(){return null===this.body?null:on(this.body)||Cn(this.body)||se(this.body)||function Wi(cn){return"undefined"!=typeof URLSearchParams&&cn instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof tn?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||se(this.body)?null:Cn(this.body)?this.body.type||null:on(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof tn?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(Ot={}){var Dt;const Nn=Ot.method||this.method,nn=Ot.url||this.url,jn=Ot.responseType||this.responseType,pi=void 0!==Ot.body?Ot.body:this.body,to=void 0!==Ot.withCredentials?Ot.withCredentials:this.withCredentials,Li=void 0!==Ot.reportProgress?Ot.reportProgress:this.reportProgress;let $r=Ot.headers||this.headers,Vr=Ot.params||this.params;const fo=null!==(Dt=Ot.context)&&void 0!==Dt?Dt:this.context;return void 0!==Ot.setHeaders&&($r=Object.keys(Ot.setHeaders).reduce((vo,ei)=>vo.set(ei,Ot.setHeaders[ei]),$r)),Ot.setParams&&(Vr=Object.keys(Ot.setParams).reduce((vo,ei)=>vo.set(ei,Ot.setParams[ei]),Vr)),new ii(Nn,nn,pi,{params:Vr,headers:$r,context:fo,reportProgress:Li,responseType:jn,withCredentials:to})}}var kn=(()=>((kn=kn||{})[kn.Sent=0]="Sent",kn[kn.UploadProgress=1]="UploadProgress",kn[kn.ResponseHeader=2]="ResponseHeader",kn[kn.DownloadProgress=3]="DownloadProgress",kn[kn.Response=4]="Response",kn[kn.User=5]="User",kn))();class Ci{constructor(Ot,Dt=200,Nn="OK"){this.headers=Ot.headers||new _t,this.status=void 0!==Ot.status?Ot.status:Dt,this.statusText=Ot.statusText||Nn,this.url=Ot.url||null,this.ok=this.status>=200&&this.status<300}}class Jt extends Ci{constructor(Ot={}){super(Ot),this.type=kn.ResponseHeader}clone(Ot={}){return new Jt({headers:Ot.headers||this.headers,status:void 0!==Ot.status?Ot.status:this.status,statusText:Ot.statusText||this.statusText,url:Ot.url||this.url||void 0})}}class $t extends Ci{constructor(Ot={}){super(Ot),this.type=kn.Response,this.body=void 0!==Ot.body?Ot.body:null}clone(Ot={}){return new $t({body:void 0!==Ot.body?Ot.body:this.body,headers:Ot.headers||this.headers,status:void 0!==Ot.status?Ot.status:this.status,statusText:Ot.statusText||this.statusText,url:Ot.url||this.url||void 0})}}class en extends Ci{constructor(Ot){super(Ot,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${Ot.url||"(unknown url)"}`:`Http failure response for ${Ot.url||"(unknown url)"}: ${Ot.status} ${Ot.statusText}`,this.error=Ot.error||null}}function an(cn,Ot){return{body:Ot,headers:cn.headers,context:cn.context,observe:cn.observe,params:cn.params,reportProgress:cn.reportProgress,responseType:cn.responseType,withCredentials:cn.withCredentials}}let Yt=(()=>{class cn{constructor(Dt){this.handler=Dt}request(Dt,Nn,nn={}){let jn;if(Dt instanceof ii)jn=Dt;else{let Li,$r;Li=nn.headers instanceof _t?nn.headers:new _t(nn.headers),nn.params&&($r=nn.params instanceof tn?nn.params:new tn({fromObject:nn.params})),jn=new ii(Dt,Nn,void 0!==nn.body?nn.body:null,{headers:Li,context:nn.context,params:$r,reportProgress:nn.reportProgress,responseType:nn.responseType||"json",withCredentials:nn.withCredentials})}const pi=(0,A.of)(jn).pipe((0,oe.b)(Li=>this.handler.handle(Li)));if(Dt instanceof ii||"events"===nn.observe)return pi;const to=pi.pipe((0,lt.h)(Li=>Li instanceof $t));switch(nn.observe||"body"){case"body":switch(jn.responseType){case"arraybuffer":return to.pipe((0,At.U)(Li=>{if(null!==Li.body&&!(Li.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return Li.body}));case"blob":return to.pipe((0,At.U)(Li=>{if(null!==Li.body&&!(Li.body instanceof Blob))throw new Error("Response is not a Blob.");return Li.body}));case"text":return to.pipe((0,At.U)(Li=>{if(null!==Li.body&&"string"!=typeof Li.body)throw new Error("Response is not a string.");return Li.body}));default:return to.pipe((0,At.U)(Li=>Li.body))}case"response":return to;default:throw new Error(`Unreachable: unhandled observe type ${nn.observe}}`)}}delete(Dt,Nn={}){return this.request("DELETE",Dt,Nn)}get(Dt,Nn={}){return this.request("GET",Dt,Nn)}head(Dt,Nn={}){return this.request("HEAD",Dt,Nn)}jsonp(Dt,Nn){return this.request("JSONP",Dt,{params:(new tn).append(Nn,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(Dt,Nn={}){return this.request("OPTIONS",Dt,Nn)}patch(Dt,Nn,nn={}){return this.request("PATCH",Dt,an(nn,Nn))}post(Dt,Nn,nn={}){return this.request("POST",Dt,an(nn,Nn))}put(Dt,Nn,nn={}){return this.request("PUT",Dt,an(nn,Nn))}}return cn.\u0275fac=function(Dt){return new(Dt||cn)(N.LFG(Ke))},cn.\u0275prov=N.Yz7({token:cn,factory:cn.\u0275fac}),cn})();class An{constructor(Ot,Dt){this.next=Ot,this.interceptor=Dt}handle(Ot){return this.interceptor.intercept(Ot,this.next)}}const Sn=new N.OlP("HTTP_INTERCEPTORS");let Mi=(()=>{class cn{intercept(Dt,Nn){return Nn.handle(Dt)}}return cn.\u0275fac=function(Dt){return new(Dt||cn)},cn.\u0275prov=N.Yz7({token:cn,factory:cn.\u0275fac}),cn})();const oi=/^\)\]\}',?\n/;let En=(()=>{class cn{constructor(Dt){this.xhrFactory=Dt}handle(Dt){if("JSONP"===Dt.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new l.y(Nn=>{const nn=this.xhrFactory.build();if(nn.open(Dt.method,Dt.urlWithParams),Dt.withCredentials&&(nn.withCredentials=!0),Dt.headers.forEach((ei,fr)=>nn.setRequestHeader(ei,fr.join(","))),Dt.headers.has("Accept")||nn.setRequestHeader("Accept","application/json, text/plain, */*"),!Dt.headers.has("Content-Type")){const ei=Dt.detectContentTypeHeader();null!==ei&&nn.setRequestHeader("Content-Type",ei)}if(Dt.responseType){const ei=Dt.responseType.toLowerCase();nn.responseType="json"!==ei?ei:"text"}const jn=Dt.serializeBody();let pi=null;const to=()=>{if(null!==pi)return pi;const ei=nn.statusText||"OK",fr=new _t(nn.getAllResponseHeaders()),sr=function Tt(cn){return"responseURL"in cn&&cn.responseURL?cn.responseURL:/^X-Request-URL:/m.test(cn.getAllResponseHeaders())?cn.getResponseHeader("X-Request-URL"):null}(nn)||Dt.url;return pi=new Jt({headers:fr,status:nn.status,statusText:ei,url:sr}),pi},Li=()=>{let{headers:ei,status:fr,statusText:sr,url:Io}=to(),ir=null;204!==fr&&(ir=void 0===nn.response?nn.responseText:nn.response),0===fr&&(fr=ir?200:0);let Ao=fr>=200&&fr<300;if("json"===Dt.responseType&&"string"==typeof ir){const Zo=ir;ir=ir.replace(oi,"");try{ir=""!==ir?JSON.parse(ir):null}catch(To){ir=Zo,Ao&&(Ao=!1,ir={error:To,text:ir})}}Ao?(Nn.next(new $t({body:ir,headers:ei,status:fr,statusText:sr,url:Io||void 0})),Nn.complete()):Nn.error(new en({error:ir,headers:ei,status:fr,statusText:sr,url:Io||void 0}))},$r=ei=>{const{url:fr}=to(),sr=new en({error:ei,status:nn.status||0,statusText:nn.statusText||"Unknown Error",url:fr||void 0});Nn.error(sr)};let Vr=!1;const fo=ei=>{Vr||(Nn.next(to()),Vr=!0);let fr={type:kn.DownloadProgress,loaded:ei.loaded};ei.lengthComputable&&(fr.total=ei.total),"text"===Dt.responseType&&!!nn.responseText&&(fr.partialText=nn.responseText),Nn.next(fr)},vo=ei=>{let fr={type:kn.UploadProgress,loaded:ei.loaded};ei.lengthComputable&&(fr.total=ei.total),Nn.next(fr)};return nn.addEventListener("load",Li),nn.addEventListener("error",$r),nn.addEventListener("timeout",$r),nn.addEventListener("abort",$r),Dt.reportProgress&&(nn.addEventListener("progress",fo),null!==jn&&nn.upload&&nn.upload.addEventListener("progress",vo)),nn.send(jn),Nn.next({type:kn.Sent}),()=>{nn.removeEventListener("error",$r),nn.removeEventListener("abort",$r),nn.removeEventListener("load",Li),nn.removeEventListener("timeout",$r),Dt.reportProgress&&(nn.removeEventListener("progress",fo),null!==jn&&nn.upload&&nn.upload.removeEventListener("progress",vo)),nn.readyState!==nn.DONE&&nn.abort()}})}}return cn.\u0275fac=function(Dt){return new(Dt||cn)(N.LFG(D.JF))},cn.\u0275prov=N.Yz7({token:cn,factory:cn.\u0275fac}),cn})();const si=new N.OlP("XSRF_COOKIE_NAME"),fi=new N.OlP("XSRF_HEADER_NAME");class nr{}let Tr=(()=>{class cn{constructor(Dt,Nn,nn){this.doc=Dt,this.platform=Nn,this.cookieName=nn,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const Dt=this.doc.cookie||"";return Dt!==this.lastCookieString&&(this.parseCount++,this.lastToken=(0,D.Mx)(Dt,this.cookieName),this.lastCookieString=Dt),this.lastToken}}return cn.\u0275fac=function(Dt){return new(Dt||cn)(N.LFG(D.K0),N.LFG(N.Lbi),N.LFG(si))},cn.\u0275prov=N.Yz7({token:cn,factory:cn.\u0275fac}),cn})(),Zr=(()=>{class cn{constructor(Dt,Nn){this.tokenService=Dt,this.headerName=Nn}intercept(Dt,Nn){const nn=Dt.url.toLowerCase();if("GET"===Dt.method||"HEAD"===Dt.method||nn.startsWith("http://")||nn.startsWith("https://"))return Nn.handle(Dt);const jn=this.tokenService.getToken();return null!==jn&&!Dt.headers.has(this.headerName)&&(Dt=Dt.clone({headers:Dt.headers.set(this.headerName,jn)})),Nn.handle(Dt)}}return cn.\u0275fac=function(Dt){return new(Dt||cn)(N.LFG(nr),N.LFG(fi))},cn.\u0275prov=N.Yz7({token:cn,factory:cn.\u0275fac}),cn})(),Ur=(()=>{class cn{constructor(Dt,Nn){this.backend=Dt,this.injector=Nn,this.chain=null}handle(Dt){if(null===this.chain){const Nn=this.injector.get(Sn,[]);this.chain=Nn.reduceRight((nn,jn)=>new An(nn,jn),this.backend)}return this.chain.handle(Dt)}}return cn.\u0275fac=function(Dt){return new(Dt||cn)(N.LFG(ct),N.LFG(N.zs3))},cn.\u0275prov=N.Yz7({token:cn,factory:cn.\u0275fac}),cn})(),qr=(()=>{class cn{static disable(){return{ngModule:cn,providers:[{provide:Zr,useClass:Mi}]}}static withOptions(Dt={}){return{ngModule:cn,providers:[Dt.cookieName?{provide:si,useValue:Dt.cookieName}:[],Dt.headerName?{provide:fi,useValue:Dt.headerName}:[]]}}}return cn.\u0275fac=function(Dt){return new(Dt||cn)},cn.\u0275mod=N.oAB({type:cn}),cn.\u0275inj=N.cJS({providers:[Zr,{provide:Sn,useExisting:Zr,multi:!0},{provide:nr,useClass:Tr},{provide:si,useValue:"XSRF-TOKEN"},{provide:fi,useValue:"X-XSRF-TOKEN"}]}),cn})(),no=(()=>{class cn{}return cn.\u0275fac=function(Dt){return new(Dt||cn)},cn.\u0275mod=N.oAB({type:cn}),cn.\u0275inj=N.cJS({providers:[Yt,{provide:Ke,useClass:Ur},En,{provide:ct,useExisting:En}],imports:[[qr.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),cn})()},4893:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{deG:()=>Yu,tb:()=>U0,AFp:()=>L0,ip1:()=>N0,CZH:()=>_y,hGG:()=>tw,z2F:()=>Ey,sBO:()=>zx,Sil:()=>bx,_Vd:()=>a_,EJc:()=>yx,SBq:()=>Wm,qLn:()=>Nu,vpe:()=>mh,tBr:()=>Vt,XFs:()=>dr,OlP:()=>Rs,zs3:()=>Dc,ZZ4:()=>Iy,aQg:()=>Py,soG:()=>vy,YKP:()=>Zv,h0i:()=>Lp,PXZ:()=>Ox,R0b:()=>qu,FiY:()=>sn,Lbi:()=>z0,g9A:()=>B0,Qsj:()=>yb,FYo:()=>zv,JOm:()=>Vc,q3G:()=>Oa,tp0:()=>Xt,Rgc:()=>Jm,dDg:()=>G0,GfV:()=>Uv,s_b:()=>u_,ifc:()=>Li,eFA:()=>q0,G48:()=>Bx,Gpc:()=>at,_c5:()=>ew,VLi:()=>Mx,c2e:()=>V0,zSh:()=>yp,wAp:()=>ao,vHH:()=>dn,EiD:()=>Nc,mCW:()=>rr,qzn:()=>qo,JVY:()=>Ja,pB0:()=>Fl,eBb:()=>Hl,L6k:()=>Yc,LAX:()=>Sl,cg1:()=>q_,kL8:()=>lv,yhl:()=>ia,dqk:()=>ei,sIi:()=>bf,CqO:()=>Lm,QGY:()=>Rf,F4k:()=>Nm,RDi:()=>Y,AaK:()=>wt,z3N:()=>Lo,qOj:()=>ch,TTD:()=>Aa,_Bn:()=>Lv,xp6:()=>So,uIk:()=>Rd,Tol:()=>go,Gre:()=>su,ekj:()=>Cs,Suo:()=>f0,Xpm:()=>We,lG2:()=>xe,Yz7:()=>Tt,cJS:()=>si,oAB:()=>nt,Yjl:()=>Se,Y36:()=>mc,_UZ:()=>Wh,BQk:()=>Ip,ynx:()=>Of,qZA:()=>Pf,TgZ:()=>If,EpF:()=>Qg,n5z:()=>Ls,Ikx:()=>$_,SDv:()=>Rv,QtT:()=>kv,pQV:()=>K_,LFG:()=>ze,$8M:()=>ol,$Z:()=>Mp,NdJ:()=>t,CRH:()=>p0,oxw:()=>y,ALo:()=>n0,lcZ:()=>r0,xi3:()=>o0,Hsn:()=>F,F$t:()=>R,Q6J:()=>Mf,s9C:()=>W,MGl:()=>te,DdM:()=>qv,VKq:()=>Wv,WLB:()=>Yv,kEZ:()=>Kv,iGM:()=>h0,MAs:()=>Gu,CHM:()=>Go,LSH:()=>Th,kYT:()=>Kt,Udp:()=>zi,YNc:()=>Ap,W1O:()=>y0,_uU:()=>Wl,Oqu:()=>cl,hij:()=>Wc,Gf:()=>d0});var D=fe(7579),N=fe(727),A=fe(8306),l=fe(6451),oe=fe(8421),lt=fe(930),At=fe(4482);function ct(r,o,...a){if(!0===o)return void r();if(!1===o)return;const f=new lt.Hp({next:()=>{f.unsubscribe(),r()}});return o(...a).subscribe(f)}function _t(r){for(let o in r)if(r[o]===_t)return o;throw Error("Could not find renamed property on target object.")}function Nt(r,o){for(const a in o)o.hasOwnProperty(a)&&!r.hasOwnProperty(a)&&(r[a]=o[a])}function wt(r){if("string"==typeof r)return r;if(Array.isArray(r))return"["+r.map(wt).join(", ")+"]";if(null==r)return""+r;if(r.overriddenName)return`${r.overriddenName}`;if(r.name)return`${r.name}`;const o=r.toString();if(null==o)return""+o;const a=o.indexOf("\n");return-1===a?o:o.substring(0,a)}function Bt(r,o){return null==r||""===r?null===o?"":o:null==o||""===o?r:r+" "+o}const st=_t({__forward_ref__:_t});function at(r){return r.__forward_ref__=at,r.toString=function(){return wt(this())},r}function ft(r){return tn(r)?r():r}function tn(r){return"function"==typeof r&&r.hasOwnProperty(st)&&r.__forward_ref__===at}class dn extends Error{constructor(o,a){super(function Qn(r,o){return`NG0${Math.abs(r)}${o?": "+o:""}`}(o,a)),this.code=o}}function on(r){return"string"==typeof r?r:null==r?"":String(r)}function Cn(r){return"function"==typeof r?r.name||r.toString():"object"==typeof r&&null!=r&&"function"==typeof r.type?r.type.name||r.type.toString():on(r)}function kn(r,o){const a=o?` in ${o}`:"";throw new dn(-201,`No provider for ${Cn(r)} found${a}`)}function Ti(r,o,a,f){throw new Error(`ASSERTION ERROR: ${r}`+(null==f?"":` [Expected=> ${a} ${f} ${o} <=Actual]`))}function Tt(r){return{token:r.token,providedIn:r.providedIn||null,factory:r.factory,value:void 0}}function si(r){return{providers:r.providers||[],imports:r.imports||[]}}function fi(r){return nr(r,Mn)||nr(r,qr)}function nr(r,o){return r.hasOwnProperty(o)?r[o]:null}function Ur(r){return r&&(r.hasOwnProperty(yo)||r.hasOwnProperty(no))?r[yo]:null}const Mn=_t({\u0275prov:_t}),yo=_t({\u0275inj:_t}),qr=_t({ngInjectableDef:_t}),no=_t({ngInjectorDef:_t});var dr=(()=>((dr=dr||{})[dr.Default=0]="Default",dr[dr.Host=1]="Host",dr[dr.Self=2]="Self",dr[dr.SkipSelf=4]="SkipSelf",dr[dr.Optional=8]="Optional",dr))();let cs;function Ot(r){const o=cs;return cs=r,o}function Dt(r,o,a){const f=fi(r);return f&&"root"==f.providedIn?void 0===f.value?f.value=f.factory():f.value:a&dr.Optional?null:void 0!==o?o:void kn(wt(r),"Injector")}function nn(r){return{toString:r}.toString()}var jn=(()=>((jn=jn||{})[jn.OnPush=0]="OnPush",jn[jn.Default=1]="Default",jn))(),Li=(()=>{return(r=Li||(Li={}))[r.Emulated=0]="Emulated",r[r.None=2]="None",r[r.ShadowDom=3]="ShadowDom",Li;var r})();const $r="undefined"!=typeof globalThis&&globalThis,Vr="undefined"!=typeof window&&window,fo="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,ei=$r||"undefined"!=typeof global&&global||Vr||fo,Io={},ir=[],Ao=_t({\u0275cmp:_t}),Zo=_t({\u0275dir:_t}),To=_t({\u0275pipe:_t}),Ds=_t({\u0275mod:_t}),qe=_t({\u0275fac:_t}),Te=_t({__NG_ELEMENT_ID__:_t});let Me=0;function We(r){return nn(()=>{const a={},f={type:r.type,providersResolver:null,decls:r.decls,vars:r.vars,factory:null,template:r.template||null,consts:r.consts||null,ngContentSelectors:r.ngContentSelectors,hostBindings:r.hostBindings||null,hostVars:r.hostVars||0,hostAttrs:r.hostAttrs||null,contentQueries:r.contentQueries||null,declaredInputs:a,inputs:null,outputs:null,exportAs:r.exportAs||null,onPush:r.changeDetection===jn.OnPush,directiveDefs:null,pipeDefs:null,selectors:r.selectors||ir,viewQuery:r.viewQuery||null,features:r.features||null,data:r.data||{},encapsulation:r.encapsulation||Li.Emulated,id:"c",styles:r.styles||ir,_:null,setInput:null,schemas:r.schemas||null,tView:null},b=r.directives,O=r.features,j=r.pipes;return f.id+=Me++,f.inputs=Dn(r.inputs,a),f.outputs=Dn(r.outputs),O&&O.forEach(X=>X(f)),f.directiveDefs=b?()=>("function"==typeof b?b():b).map(xt):null,f.pipeDefs=j?()=>("function"==typeof j?j():j).map(Gt):null,f})}function xt(r){return Be(r)||function dt(r){return r[Zo]||null}(r)}function Gt(r){return function Pt(r){return r[To]||null}(r)}const Rt={};function nt(r){return nn(()=>{const o={type:r.type,bootstrap:r.bootstrap||ir,declarations:r.declarations||ir,imports:r.imports||ir,exports:r.exports||ir,transitiveCompileScopes:null,schemas:r.schemas||null,id:r.id||null};return null!=r.id&&(Rt[r.id]=r.type),o})}function Kt(r,o){return nn(()=>{const a=rn(r,!0);a.declarations=o.declarations||ir,a.imports=o.imports||ir,a.exports=o.exports||ir})}function Dn(r,o){if(null==r)return Io;const a={};for(const f in r)if(r.hasOwnProperty(f)){let b=r[f],O=b;Array.isArray(b)&&(O=b[1],b=b[0]),a[b]=f,o&&(o[b]=O)}return a}const xe=We;function Se(r){return{type:r.type,name:r.name,factory:null,pure:!1!==r.pure,onDestroy:r.type.prototype.ngOnDestroy||null}}function Be(r){return r[Ao]||null}function rn(r,o){const a=r[Ds]||null;if(!a&&!0===o)throw new Error(`Type ${wt(r)} does not have '\u0275mod' property.`);return a}function po(r){return Array.isArray(r)&&"object"==typeof r[1]}function xr(r){return Array.isArray(r)&&!0===r[1]}function zr(r){return 0!=(8&r.flags)}function rs(r){return 2==(2&r.flags)}function vs(r){return 1==(1&r.flags)}function Ir(r){return null!==r.template}function Vo(r){return 0!=(512&r[2])}function Ms(r,o){return r.hasOwnProperty(qe)?r[qe]:null}class Pl{constructor(o,a,f){this.previousValue=o,this.currentValue=a,this.firstChange=f}isFirstChange(){return this.firstChange}}function Aa(){return ds}function ds(r){return r.type.prototype.ngOnChanges&&(r.setInput=Vs),ea}function ea(){const r=fs(this),o=null==r?void 0:r.current;if(o){const a=r.previous;if(a===Io)r.previous=o;else for(let f in o)a[f]=o[f];r.current=null,this.ngOnChanges(o)}}function Vs(r,o,a,f){const b=fs(r)||function js(r,o){return r[Wr]=o}(r,{previous:Io,current:null}),O=b.current||(b.current={}),j=b.previous,X=this.declaredInputs[a],ue=j[X];O[X]=new Pl(ue&&ue.currentValue,o,j===Io),r[f]=o}Aa.ngInherit=!0;const Wr="__ngSimpleChanges__";function fs(r){return r[Wr]||null}let Le;function Y(r){Le=r}function le(){return void 0!==Le?Le:"undefined"!=typeof document?document:void 0}function be(r){return!!r.listen}const je={createRenderer:(r,o)=>le()};function mt(r){for(;Array.isArray(r);)r=r[0];return r}function wn(r,o){return mt(o[r])}function er(r,o){return mt(o[r.index])}function Lr(r,o){return r.data[o]}function Zi(r,o){return r[o]}function bi(r,o){const a=o[r];return po(a)?a:a[0]}function ge(r){return 4==(4&r[2])}function he(r){return 128==(128&r[2])}function Re(r,o){return null==o?null:r[o]}function gn(r){r[18]=0}function xi(r,o){r[5]+=o;let a=r,f=r[3];for(;null!==f&&(1===o&&1===a[5]||-1===o&&0===a[5]);)f[5]+=o,a=f,f=f[3]}const vi={lFrame:xl(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function xs(){return vi.bindingsEnabled}function Hn(){return vi.lFrame.lView}function ki(){return vi.lFrame.tView}function Go(r){return vi.lFrame.contextLView=r,r[8]}function os(){let r=Na();for(;null!==r&&64===r.type;)r=r.parent;return r}function Na(){return vi.lFrame.currentTNode}function La(){const r=vi.lFrame,o=r.currentTNode;return r.isParent?o:o.parent}function Qo(r,o){const a=vi.lFrame;a.currentTNode=r,a.isParent=o}function yl(){return vi.lFrame.isParent}function Ua(){vi.lFrame.isParent=!1}function Ma(){return vi.isInCheckNoChangesMode}function Ws(r){vi.isInCheckNoChangesMode=r}function ss(){const r=vi.lFrame;let o=r.bindingRootIndex;return-1===o&&(o=r.bindingRootIndex=r.tView.bindingStartIndex),o}function xa(){return vi.lFrame.bindingIndex++}function gs(r){const o=vi.lFrame,a=o.bindingIndex;return o.bindingIndex=o.bindingIndex+r,a}function Is(r){vi.lFrame.inI18n=r}function wa(r,o){const a=vi.lFrame;a.bindingIndex=a.bindingRootIndex=r,Va(o)}function Va(r){vi.lFrame.currentDirectiveIndex=r}function bl(){return vi.lFrame.currentQueryIndex}function io(r){vi.lFrame.currentQueryIndex=r}function Fa(r){const o=r[1];return 2===o.type?o.declTNode:1===o.type?r[6]:null}function Ns(r,o,a){if(a&dr.SkipSelf){let b=o,O=r;for(;!(b=b.parent,null!==b||a&dr.Host||(b=Fa(O),null===b||(O=O[15],10&b.type))););if(null===b)return!1;o=b,r=O}const f=vi.lFrame=Xa();return f.currentTNode=o,f.lView=r,!0}function es(r){const o=Xa(),a=r[1];vi.lFrame=o,o.currentTNode=a.firstChild,o.lView=r,o.tView=a,o.contextLView=r,o.bindingIndex=a.bindingStartIndex,o.inI18n=!1}function Xa(){const r=vi.lFrame,o=null===r?null:r.child;return null===o?xl(r):o}function xl(r){const o={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:r,child:null,inI18n:!1};return null!==r&&(r.child=o),o}function Ol(){const r=vi.lFrame;return vi.lFrame=r.parent,r.currentTNode=null,r.lView=null,r}const nl=Ol;function Pa(){const r=Ol();r.isParent=!0,r.tView=null,r.selectedIndex=-1,r.contextLView=null,r.elementDepthCount=0,r.currentDirectiveIndex=-1,r.currentNamespace=null,r.bindingRootIndex=-1,r.bindingIndex=-1,r.currentQueryIndex=0}function ws(){return vi.lFrame.selectedIndex}function ts(r){vi.lFrame.selectedIndex=r}function bo(){const r=vi.lFrame;return Lr(r.tView,r.selectedIndex)}function Ue(r,o){for(let a=o.directiveStart,f=o.directiveEnd;a<f;a++){const O=r.data[a].type.prototype,{ngAfterContentInit:j,ngAfterContentChecked:X,ngAfterViewInit:ue,ngAfterViewChecked:Ce,ngOnDestroy:ke}=O;j&&(r.contentHooks||(r.contentHooks=[])).push(-a,j),X&&((r.contentHooks||(r.contentHooks=[])).push(a,X),(r.contentCheckHooks||(r.contentCheckHooks=[])).push(a,X)),ue&&(r.viewHooks||(r.viewHooks=[])).push(-a,ue),Ce&&((r.viewHooks||(r.viewHooks=[])).push(a,Ce),(r.viewCheckHooks||(r.viewCheckHooks=[])).push(a,Ce)),null!=ke&&(r.destroyHooks||(r.destroyHooks=[])).push(a,ke)}}function gt(r,o,a){Wt(r,o,3,a)}function Ut(r,o,a,f){(3&r[2])===a&&Wt(r,o,a,f)}function vn(r,o){let a=r[2];(3&a)===o&&(a&=2047,a+=1,r[2]=a)}function Wt(r,o,a,f){const O=null!=f?f:-1,j=o.length-1;let X=0;for(let ue=void 0!==f?65535&r[18]:0;ue<j;ue++)if("number"==typeof o[ue+1]){if(X=o[ue],null!=f&&X>=f)break}else o[ue]<0&&(r[18]+=65536),(X<O||-1==O)&&(Bn(r,a,o,ue),r[18]=(4294901760&r[18])+ue+2),ue++}function Bn(r,o,a,f){const b=a[f]<0,O=a[f+1],X=r[b?-a[f]:a[f]];if(b){if(r[2]>>11<r[18]>>16&&(3&r[2])===o){r[2]+=2048;try{O.call(X)}finally{}}}else try{O.call(X)}finally{}}class ai{constructor(o,a,f){this.factory=o,this.resolving=!1,this.canSeeViewProviders=a,this.injectImpl=f}}function ut(r,o,a){const f=be(r);let b=0;for(;b<a.length;){const O=a[b];if("number"==typeof O){if(0!==O)break;b++;const j=a[b++],X=a[b++],ue=a[b++];f?r.setAttribute(o,X,ue,j):o.setAttributeNS(j,X,ue)}else{const j=O,X=a[++b];Jn(j)?f&&r.setProperty(o,j,X):f?r.setAttribute(o,j,X):o.setAttribute(j,X),b++}}return b}function pn(r){return 3===r||4===r||6===r}function Jn(r){return 64===r.charCodeAt(0)}function xo(r,o){if(null!==o&&0!==o.length)if(null===r||0===r.length)r=o.slice();else{let a=-1;for(let f=0;f<o.length;f++){const b=o[f];"number"==typeof b?a=b:0===a||Ts(r,a,b,null,-1===a||2===a?o[++f]:null)}}return r}function Ts(r,o,a,f,b){let O=0,j=r.length;if(-1===o)j=-1;else for(;O<r.length;){const X=r[O++];if("number"==typeof X){if(X===o){j=-1;break}if(X>o){j=O-1;break}}}for(;O<r.length;){const X=r[O];if("number"==typeof X)break;if(X===a){if(null===f)return void(null!==b&&(r[O+1]=b));if(f===r[O+1])return void(r[O+2]=b)}O++,null!==f&&O++,null!==b&&O++}-1!==j&&(r.splice(j,0,o),O=j+1),r.splice(O++,0,a),null!==f&&r.splice(O++,0,f),null!==b&&r.splice(O++,0,b)}function Hr(r){return-1!==r}function Os(r){return 32767&r}function rl(r,o){let a=function il(r){return r>>16}(r),f=o;for(;a>0;)f=f[15],a--;return f}let Ta=!0;function c(r){const o=Ta;return Ta=r,o}let C=0;function Q(r,o){const a=Pe(r,o);if(-1!==a)return a;const f=o[1];f.firstCreatePass&&(r.injectorIndex=o.length,ye(f.data,r),ye(o,null),ye(f.blueprint,null));const b=Ze(r,o),O=r.injectorIndex;if(Hr(b)){const j=Os(b),X=rl(b,o),ue=X[1].data;for(let Ce=0;Ce<8;Ce++)o[O+Ce]=X[j+Ce]|ue[j+Ce]}return o[O+8]=b,O}function ye(r,o){r.push(0,0,0,0,0,0,0,0,o)}function Pe(r,o){return-1===r.injectorIndex||r.parent&&r.parent.injectorIndex===r.injectorIndex||null===o[r.injectorIndex+8]?-1:r.injectorIndex}function Ze(r,o){if(r.parent&&-1!==r.parent.injectorIndex)return r.parent.injectorIndex;let a=0,f=null,b=o;for(;null!==b;){const O=b[1],j=O.type;if(f=2===j?O.declTNode:1===j?b[6]:null,null===f)return-1;if(a++,b=b[15],-1!==f.injectorIndex)return f.injectorIndex|a<<16}return-1}function zt(r,o,a){!function U(r,o,a){let f;"string"==typeof a?f=a.charCodeAt(0)||0:a.hasOwnProperty(Te)&&(f=a[Te]),null==f&&(f=a[Te]=C++);const b=255&f;o.data[r+(b>>5)]|=1<<b}(r,o,a)}function Pi(r,o,a){if(a&dr.Optional)return r;kn(o,"NodeInjector")}function Vi(r,o,a,f){if(a&dr.Optional&&void 0===f&&(f=null),0==(a&(dr.Self|dr.Host))){const b=r[9],O=Ot(void 0);try{return b?b.get(o,f,a&dr.Optional):Dt(o,f,a&dr.Optional)}finally{Ot(O)}}return Pi(f,o,a)}function ro(r,o,a,f=dr.Default,b){if(null!==r){const O=function El(r){if("string"==typeof r)return r.charCodeAt(0)||0;const o=r.hasOwnProperty(Te)?r[Te]:void 0;return"number"==typeof o?o>=0?255&o:Zs:o}(a);if("function"==typeof O){if(!Ns(o,r,f))return f&dr.Host?Pi(b,a,f):Vi(o,a,f,b);try{const j=O(f);if(null!=j||f&dr.Optional)return j;kn(a)}finally{nl()}}else if("number"==typeof O){let j=null,X=Pe(r,o),ue=-1,Ce=f&dr.Host?o[16][6]:null;for((-1===X||f&dr.SkipSelf)&&(ue=-1===X?Ze(r,o):o[X+8],-1!==ue&&lu(f,!1)?(j=o[1],X=Os(ue),o=rl(ue,o)):X=-1);-1!==X;){const ke=o[1];if(Gs(O,X,ke.data)){const ot=Tl(X,o,a,j,f,Ce);if(ot!==co)return ot}ue=o[X+8],-1!==ue&&lu(f,o[1].data[X+8]===Ce)&&Gs(O,X,o)?(j=ke,X=Os(ue),o=rl(ue,o)):X=-1}}}return Vi(o,a,f,b)}const co={};function Zs(){return new Cl(os(),Hn())}function Tl(r,o,a,f,b,O){const j=o[1],X=j.data[r+8],ke=kl(X,j,a,null==f?rs(X)&&Ta:f!=j&&0!=(3&X.type),b&dr.Host&&O===X);return null!==ke?dl(o,j,ke,X):co}function kl(r,o,a,f,b){const O=r.providerIndexes,j=o.data,X=1048575&O,ue=r.directiveStart,ke=O>>20,Ft=b?X+ke:r.directiveEnd;for(let ln=f?X:X+ke;ln<Ft;ln++){const $n=j[ln];if(ln<ue&&a===$n||ln>=ue&&$n.type===a)return ln}if(b){const ln=j[ue];if(ln&&Ir(ln)&&ln.type===a)return ue}return null}function dl(r,o,a,f){let b=r[a];const O=o.data;if(function Ii(r){return r instanceof ai}(b)){const j=b;j.resolving&&function se(r,o){const a=o?`. Dependency path: ${o.join(" > ")} > ${r}`:"";throw new dn(-200,`Circular dependency in DI detected for ${r}${a}`)}(Cn(O[a]));const X=c(j.canSeeViewProviders);j.resolving=!0;const ue=j.injectImpl?Ot(j.injectImpl):null;Ns(r,f,dr.Default);try{b=r[a]=j.factory(void 0,O,r,f),o.firstCreatePass&&a>=f.directiveStart&&function Za(r,o,a){const{ngOnChanges:f,ngOnInit:b,ngDoCheck:O}=o.type.prototype;if(f){const j=ds(o);(a.preOrderHooks||(a.preOrderHooks=[])).push(r,j),(a.preOrderCheckHooks||(a.preOrderCheckHooks=[])).push(r,j)}b&&(a.preOrderHooks||(a.preOrderHooks=[])).push(0-r,b),O&&((a.preOrderHooks||(a.preOrderHooks=[])).push(r,O),(a.preOrderCheckHooks||(a.preOrderCheckHooks=[])).push(r,O))}(a,O[a],o)}finally{null!==ue&&Ot(ue),c(X),j.resolving=!1,nl()}}return b}function Gs(r,o,a){return!!(a[o+(r>>5)]&1<<r)}function lu(r,o){return!(r&dr.Self||r&dr.Host&&o)}class Cl{constructor(o,a){this._tNode=o,this._lView=a}get(o,a,f){return ro(this._tNode,this._lView,o,f,a)}}function Ls(r){return nn(()=>{const o=r.prototype.constructor,a=o[qe]||uc(o),f=Object.prototype;let b=Object.getPrototypeOf(r.prototype).constructor;for(;b&&b!==f;){const O=b[qe]||uc(b);if(O&&O!==a)return O;b=Object.getPrototypeOf(b)}return O=>new O})}function uc(r){return tn(r)?()=>{const o=uc(ft(r));return o&&o()}:Ms(r)}function ol(r){return function qn(r,o){if("class"===o)return r.classes;if("style"===o)return r.styles;const a=r.attrs;if(a){const f=a.length;let b=0;for(;b<f;){const O=a[b];if(pn(O))break;if(0===O)b+=2;else if("number"==typeof O)for(b++;b<f&&"string"==typeof a[b];)b++;else{if(O===o)return a[b+1];b+=2}}}return null}(os(),r)}const sl="__parameters__";function yc(r,o,a){return nn(()=>{const f=function Oi(r){return function(...a){if(r){const f=r(...a);for(const b in f)this[b]=f[b]}}}(o);function b(...O){if(this instanceof b)return f.apply(this,O),this;const j=new b(...O);return X.annotation=j,X;function X(ue,Ce,ke){const ot=ue.hasOwnProperty(sl)?ue[sl]:Object.defineProperty(ue,sl,{value:[]})[sl];for(;ot.length<=ke;)ot.push(null);return(ot[ke]=ot[ke]||[]).push(j),ue}}return a&&(b.prototype=Object.create(a.prototype)),b.prototype.ngMetadataName=r,b.annotationCls=b,b})}class Rs{constructor(o,a){this._desc=o,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof a?this.__NG_ELEMENT_ID__=a:void 0!==a&&(this.\u0275prov=Tt({token:this,providedIn:a.providedIn||"root",factory:a.factory}))}toString(){return`InjectionToken ${this._desc}`}}const Yu=new Rs("AnalyzeForEntryComponents");function Dl(r,o){void 0===o&&(o=r);for(let a=0;a<r.length;a++){let f=r[a];Array.isArray(f)?(o===r&&(o=r.slice(0,a)),Dl(f,o)):o!==r&&o.push(f)}return o}function Zl(r,o){r.forEach(a=>Array.isArray(a)?Zl(a,o):o(a))}function Gl(r,o,a){o>=r.length?r.push(a):r.splice(o,0,a)}function Ll(r,o){return o>=r.length-1?r.pop():r.splice(o,1)[0]}function tc(r,o){const a=[];for(let f=0;f<r;f++)a.push(o);return a}function fl(r,o,a){let f=bc(r,o);return f>=0?r[1|f]=a:(f=~f,function yh(r,o,a,f){let b=r.length;if(b==o)r.push(a,f);else if(1===b)r.push(f,r[0]),r[0]=a;else{for(b--,r.push(r[b-1],r[b]);b>o;)r[b]=r[b-2],b--;r[o]=a,r[o+1]=f}}(r,f,o,a)),f}function uu(r,o){const a=bc(r,o);if(a>=0)return r[1|a]}function bc(r,o){return function vh(r,o,a){let f=0,b=r.length>>a;for(;b!==f;){const O=f+(b-f>>1),j=r[O<<a];if(o===j)return O<<a;j>o?b=O:f=O+1}return~(b<<a)}(r,o,1)}const z={},Z="__NG_DI_FLAG__",K="ngTempTokenPath",pe=/\n/gm,Fe="__source",Je=_t({provide:String,useValue:_t});let Ge;function He(r){const o=Ge;return Ge=r,o}function $e(r,o=dr.Default){if(void 0===Ge)throw new dn(203,"");return null===Ge?Dt(r,void 0,o):Ge.get(r,o&dr.Optional?null:void 0,o)}function ze(r,o=dr.Default){return(function cn(){return cs}()||$e)(ft(r),o)}const et=ze;function Mt(r){const o=[];for(let a=0;a<r.length;a++){const f=ft(r[a]);if(Array.isArray(f)){if(0===f.length)throw new dn(900,"");let b,O=dr.Default;for(let j=0;j<f.length;j++){const X=f[j],ue=yt(X);"number"==typeof ue?-1===ue?b=X.token:O|=ue:b=X}o.push(ze(b,O))}else o.push(ze(f))}return o}function Et(r,o){return r[Z]=o,r.prototype[Z]=o,r}function yt(r){return r[Z]}const Vt=Et(yc("Inject",r=>({token:r})),-1),sn=Et(yc("Optional"),8),Xt=Et(yc("SkipSelf"),4);let G;function S(r){var o;return(null===(o=function P(){if(void 0===G&&(G=null,ei.trustedTypes))try{G=ei.trustedTypes.createPolicy("angular",{createHTML:r=>r,createScript:r=>r,createScriptURL:r=>r})}catch(r){}return G}())||void 0===o?void 0:o.createHTML(r))||r}class ar{constructor(o){this.changingThisBreaksApplicationSecurity=o}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class Pr extends ar{getTypeName(){return"HTML"}}class oo extends ar{getTypeName(){return"Style"}}class kr extends ar{getTypeName(){return"Script"}}class Or extends ar{getTypeName(){return"URL"}}class _r extends ar{getTypeName(){return"ResourceURL"}}function Lo(r){return r instanceof ar?r.changingThisBreaksApplicationSecurity:r}function qo(r,o){const a=ia(r);if(null!=a&&a!==o){if("ResourceURL"===a&&"URL"===o)return!0;throw new Error(`Required a safe ${o}, got a ${a} (see https://g.co/ng/security#xss)`)}return a===o}function ia(r){return r instanceof ar&&r.getTypeName()||null}function Ja(r){return new Pr(r)}function Yc(r){return new oo(r)}function Hl(r){return new kr(r)}function Sl(r){return new Or(r)}function Fl(r){return new _r(r)}function Bl(r){const o=new bh(r);return function du(){try{return!!(new window.DOMParser).parseFromString(S(""),"text/html")}catch(r){return!1}}()?new nc(o):o}class nc{constructor(o){this.inertDocumentHelper=o}getInertBodyElement(o){o="<body><remove></remove>"+o;try{const a=(new window.DOMParser).parseFromString(S(o),"text/html").body;return null===a?this.inertDocumentHelper.getInertBodyElement(o):(a.removeChild(a.firstChild),a)}catch(a){return null}}}class bh{constructor(o){if(this.defaultDoc=o,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const a=this.inertDocument.createElement("html");this.inertDocument.appendChild(a);const f=this.inertDocument.createElement("body");a.appendChild(f)}}getInertBodyElement(o){const a=this.inertDocument.createElement("template");if("content"in a)return a.innerHTML=S(o),a;const f=this.inertDocument.createElement("body");return f.innerHTML=S(o),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(f),f}stripCustomNsAttrs(o){const a=o.attributes;for(let b=a.length-1;0<b;b--){const j=a.item(b).name;("xmlns:ns1"===j||0===j.indexOf("ns1:"))&&o.removeAttribute(j)}let f=o.firstChild;for(;f;)f.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(f),f=f.nextSibling}}const Pc=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,Kc=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function rr(r){return(r=String(r)).match(Pc)||r.match(Kc)?r:"unsafe:"+r}function Rr(r){return(r=String(r)).split(",").map(o=>rr(o.trim())).join(", ")}function Sr(r){const o={};for(const a of r.split(","))o[a]=!0;return o}function wo(...r){const o={};for(const a of r)for(const f in a)a.hasOwnProperty(f)&&(o[f]=!0);return o}const Ca=Sr("area,br,col,hr,img,wbr"),za=Sr("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),pl=Sr("rp,rt"),Ou=wo(Ca,wo(za,Sr("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),wo(pl,Sr("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),wo(pl,za)),al=Sr("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),xc=Sr("srcset"),xh=wo(al,xc,Sr("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Sr("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),Bf=Sr("script,style,template");class id{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(o){let a=o.firstChild,f=!0;for(;a;)if(a.nodeType===Node.ELEMENT_NODE?f=this.startElement(a):a.nodeType===Node.TEXT_NODE?this.chars(a.nodeValue):this.sanitizedSomething=!0,f&&a.firstChild)a=a.firstChild;else for(;a;){a.nodeType===Node.ELEMENT_NODE&&this.endElement(a);let b=this.checkClobberedElement(a,a.nextSibling);if(b){a=b;break}a=this.checkClobberedElement(a,a.parentNode)}return this.buf.join("")}startElement(o){const a=o.nodeName.toLowerCase();if(!Ou.hasOwnProperty(a))return this.sanitizedSomething=!0,!Bf.hasOwnProperty(a);this.buf.push("<"),this.buf.push(a);const f=o.attributes;for(let b=0;b<f.length;b++){const O=f.item(b),j=O.name,X=j.toLowerCase();if(!xh.hasOwnProperty(X)){this.sanitizedSomething=!0;continue}let ue=O.value;al[X]&&(ue=rr(ue)),xc[X]&&(ue=Rr(ue)),this.buf.push(" ",j,'="',wc(ue),'"')}return this.buf.push(">"),!0}endElement(o){const a=o.nodeName.toLowerCase();Ou.hasOwnProperty(a)&&!Ca.hasOwnProperty(a)&&(this.buf.push("</"),this.buf.push(a),this.buf.push(">"))}chars(o){this.buf.push(wc(o))}checkClobberedElement(o,a){if(a&&(o.compareDocumentPosition(a)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${o.outerHTML}`);return a}}const wh=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,pu=/([^\#-~ |!])/g;function wc(r){return r.replace(/&/g,"&amp;").replace(wh,function(o){return"&#"+(1024*(o.charCodeAt(0)-55296)+(o.charCodeAt(1)-56320)+65536)+";"}).replace(pu,function(o){return"&#"+o.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let kc;function Nc(r,o){let a=null;try{kc=kc||Bl(r);let f=o?String(o):"";a=kc.getInertBodyElement(f);let b=5,O=f;do{if(0===b)throw new Error("Failed to sanitize html because the input is unstable");b--,f=O,O=a.innerHTML,a=kc.getInertBodyElement(f)}while(f!==O);return S((new id).sanitizeChildren(Xc(a)||a))}finally{if(a){const f=Xc(a)||a;for(;f.firstChild;)f.removeChild(f.firstChild)}}}function Xc(r){return"content"in r&&function Vd(r){return r.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===r.nodeName}(r)?r.content:null}var Oa=(()=>((Oa=Oa||{})[Oa.NONE=0]="NONE",Oa[Oa.HTML=1]="HTML",Oa[Oa.STYLE=2]="STYLE",Oa[Oa.SCRIPT=3]="SCRIPT",Oa[Oa.URL=4]="URL",Oa[Oa.RESOURCE_URL=5]="RESOURCE_URL",Oa))();function Th(r){const o=function Eo(){const r=Hn();return r&&r[12]}();return o?o.sanitize(Oa.URL,r)||"":qo(r,"URL")?Lo(r):rr(on(r))}const Fc="__ngContext__";function Xs(r,o){r[Fc]=o}function Qa(r){const o=function Al(r){return r[Fc]||null}(r);return o?Array.isArray(o)?o:o.lView:null}function Qc(r){return r.ngOriginalError}function Sh(r,...o){r.error(...o)}class Nu{constructor(){this._console=console}handleError(o){const a=this._findOriginalError(o),f=function Dh(r){return r&&r.ngErrorLogger||Sh}(o);f(this._console,"ERROR",o),a&&f(this._console,"ORIGINAL ERROR",a)}_findOriginalError(o){let a=o&&Qc(o);for(;a&&Qc(a);)a=Qc(a);return a||null}}const qd=/^>|^->|<!--|-->|--!>|<!-$/g,jf=/(<|>)/;const $f=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(ei))();function Uc(r){return r instanceof Function?r():r}var Vc=(()=>((Vc=Vc||{})[Vc.Important=1]="Important",Vc[Vc.DashCase=2]="DashCase",Vc))();let ic;function ld(r,o){return ic(r,o)}function jc(r){const o=r[3];return xr(o)?o[3]:o}function Kd(r){return Vp(r[13])}function ud(r){return Vp(r[4])}function Vp(r){for(;null!==r&&!xr(r);)r=r[4];return r}function Bu(r,o,a,f,b){if(null!=f){let O,j=!1;xr(f)?O=f:po(f)&&(j=!0,f=f[0]);const X=mt(f);0===r&&null!==a?null==b?zu(o,a,X):_u(o,a,X,b||null,!0):1===r&&null!==a?_u(o,a,X,b||null,!0):2===r?nf(o,X,j):3===r&&o.destroyNode(X),null!=O&&function B(r,o,a,f,b){const O=a[7];O!==mt(a)&&Bu(o,r,f,O,b);for(let X=10;X<a.length;X++){const ue=a[X];w(ue[1],ue,r,o,f,O)}}(o,r,O,a,b)}}function nh(r,o){return be(r)?r.createText(o):r.createTextNode(o)}function ih(r,o,a){be(r)?r.setValue(o,a):o.textContent=a}function eu(r,o){return r.createComment(function Up(r){return r.replace(qd,o=>o.replace(jf,"\u200b$1\u200b"))}(o))}function hd(r,o,a){if(be(r))return r.createElement(o,a);{const f=null!==a?function Ae(r){const o=r.toLowerCase();return"svg"===o?"http://www.w3.org/2000/svg":"math"===o?"http://www.w3.org/1998/MathML/":null}(a):null;return null===f?r.createElement(o):r.createElementNS(f,o)}}function fc(r,o){const a=r[9],f=a.indexOf(o),b=o[3];1024&o[2]&&(o[2]&=-1025,xi(b,-1)),a.splice(f,1)}function dd(r,o){if(r.length<=10)return;const a=10+o,f=r[a];if(f){const b=f[17];null!==b&&b!==r&&fc(b,f),o>0&&(r[a-1][4]=f[4]);const O=Ll(r,10+o);!function Zp(r,o){w(r,o,o[11],2,null,null),o[0]=null,o[6]=null}(f[1],f);const j=O[19];null!==j&&j.detachView(O[1]),f[3]=null,f[4]=null,f[2]&=-129}return f}function $a(r,o){if(!(256&o[2])){const a=o[11];be(a)&&a.destroyNode&&w(r,o,a,3,null,null),function Zc(r){let o=r[13];if(!o)return Ih(r[1],r);for(;o;){let a=null;if(po(o))a=o[13];else{const f=o[10];f&&(a=f)}if(!a){for(;o&&!o[4]&&o!==r;)po(o)&&Ih(o[1],o),o=o[3];null===o&&(o=r),po(o)&&Ih(o[1],o),a=o&&o[4]}o=a}}(o)}}function Ih(r,o){if(!(256&o[2])){o[2]&=-129,o[2]|=256,function Gc(r,o){let a;if(null!=r&&null!=(a=r.destroyHooks))for(let f=0;f<a.length;f+=2){const b=o[a[f]];if(!(b instanceof ai)){const O=a[f+1];if(Array.isArray(O))for(let j=0;j<O.length;j+=2){const X=b[O[j]],ue=O[j+1];try{ue.call(X)}finally{}}else try{O.call(b)}finally{}}}}(r,o),function fd(r,o){const a=r.cleanup,f=o[7];let b=-1;if(null!==a)for(let O=0;O<a.length-1;O+=2)if("string"==typeof a[O]){const j=a[O+1],X="function"==typeof j?j(o):mt(o[j]),ue=f[b=a[O+2]],Ce=a[O+3];"boolean"==typeof Ce?X.removeEventListener(a[O],ue,Ce):Ce>=0?f[b=Ce]():f[b=-Ce].unsubscribe(),O+=2}else{const j=f[b=a[O+1]];a[O].call(j)}if(null!==f){for(let O=b+1;O<f.length;O++)f[O]();o[7]=null}}(r,o),1===o[1].type&&be(o[11])&&o[11].destroy();const a=o[17];if(null!==a&&xr(o[3])){a!==o[3]&&fc(a,o);const f=o[19];null!==f&&f.detachView(r)}}}function Gp(r,o,a){return Hp(r,o.parent,a)}function Hp(r,o,a){let f=o;for(;null!==f&&40&f.type;)f=(o=f).parent;if(null===f)return a[0];if(2&f.flags){const b=r.data[f.directiveStart].encapsulation;if(b===Li.None||b===Li.Emulated)return null}return er(f,a)}function _u(r,o,a,f,b){be(r)?r.insertBefore(o,a,f,b):o.insertBefore(a,f,b)}function zu(r,o,a){be(r)?r.appendChild(o,a):o.appendChild(a)}function Kf(r,o,a,f,b){null!==f?_u(r,o,a,f,b):zu(r,o,a)}function pd(r,o){return be(r)?r.parentNode(o):o.parentNode}function Jd(r,o,a){return ef(r,o,a)}function Qd(r,o,a){return 40&r.type?er(r,a):null}let Ul,ef=Qd;function Xf(r,o){ef=r,Ul=o}function tf(r,o,a,f){const b=Gp(r,f,o),O=o[11],X=Jd(f.parent||o[6],f,o);if(null!=b)if(Array.isArray(a))for(let ue=0;ue<a.length;ue++)Kf(O,b,a[ue],X,!1);else Kf(O,b,a,X,!1);void 0!==Ul&&Ul(O,f,o,a,b)}function md(r,o){if(null!==o){const a=o.type;if(3&a)return er(o,r);if(4&a)return gd(-1,r[o.index]);if(8&a){const f=o.child;if(null!==f)return md(r,f);{const b=r[o.index];return xr(b)?gd(-1,b):mt(b)}}if(32&a)return ld(o,r)()||mt(r[o.index]);{const f=qp(r,o);return null!==f?Array.isArray(f)?f[0]:md(jc(r[16]),f):md(r,o.next)}}return null}function qp(r,o){return null!==o?r[16][6].projection[o.projection]:null}function gd(r,o){const a=10+r+1;if(a<o.length){const f=o[a],b=f[1].firstChild;if(null!==b)return md(f,b)}return o[7]}function nf(r,o,a){const f=pd(r,o);f&&function $p(r,o,a,f){be(r)?r.removeChild(o,a,f):o.removeChild(a)}(r,f,o,a)}function _d(r,o,a,f,b,O,j){for(;null!=a;){const X=f[a.index],ue=a.type;if(j&&0===o&&(X&&Xs(mt(X),f),a.flags|=4),64!=(64&a.flags))if(8&ue)_d(r,o,a.child,f,b,O,!1),Bu(o,r,b,X,O);else if(32&ue){const Ce=ld(a,f);let ke;for(;ke=Ce();)Bu(o,r,b,ke,O);Bu(o,r,b,X,O)}else 16&ue?_(r,o,f,a,b,O):Bu(o,r,b,X,O);a=j?a.projectionNext:a.next}}function w(r,o,a,f,b,O){_d(a,f,r.firstChild,o,b,O,!1)}function _(r,o,a,f,b,O){const j=a[16],ue=j[6].projection[f.projection];if(Array.isArray(ue))for(let Ce=0;Ce<ue.length;Ce++)Bu(o,r,b,ue[Ce],O);else _d(r,o,ue,j[3],b,O,!0)}function ve(r,o,a){be(r)?r.setAttribute(o,"style",a):o.style.cssText=a}function ht(r,o,a){be(r)?""===a?r.removeAttribute(o,"class"):r.setAttribute(o,"class",a):o.className=a}function Ht(r,o,a){let f=r.length;for(;;){const b=r.indexOf(o,a);if(-1===b)return b;if(0===b||r.charCodeAt(b-1)<=32){const O=o.length;if(b+O===f||r.charCodeAt(b+O)<=32)return b}a=b+1}}const xn="ng-template";function Fn(r,o,a){let f=0;for(;f<r.length;){let b=r[f++];if(a&&"class"===b){if(b=r[f],-1!==Ht(b.toLowerCase(),o,0))return!0}else if(1===b){for(;f<r.length&&"string"==typeof(b=r[f++]);)if(b.toLowerCase()===o)return!0;return!1}}return!1}function or(r){return 4===r.type&&r.value!==xn}function qi(r,o,a){return o===(4!==r.type||a?r.value:xn)}function ur(r,o,a){let f=4;const b=r.attrs||[],O=function jo(r){for(let o=0;o<r.length;o++)if(pn(r[o]))return o;return r.length}(b);let j=!1;for(let X=0;X<o.length;X++){const ue=o[X];if("number"!=typeof ue){if(!j)if(4&f){if(f=2|1&f,""!==ue&&!qi(r,ue,a)||""===ue&&1===o.length){if(uo(f))return!1;j=!0}}else{const Ce=8&f?ue:o[++X];if(8&f&&null!==r.attrs){if(!Fn(r.attrs,Ce,a)){if(uo(f))return!1;j=!0}continue}const ot=Yr(8&f?"class":ue,b,or(r),a);if(-1===ot){if(uo(f))return!1;j=!0;continue}if(""!==Ce){let Ft;Ft=ot>O?"":b[ot+1].toLowerCase();const ln=8&f?Ft:null;if(ln&&-1!==Ht(ln,Ce,0)||2&f&&Ce!==Ft){if(uo(f))return!1;j=!0}}}}else{if(!j&&!uo(f)&&!uo(ue))return!1;if(j&&uo(ue))continue;j=!1,f=ue|1&f}}return uo(f)||j}function uo(r){return 0==(1&r)}function Yr(r,o,a,f){if(null===o)return-1;let b=0;if(f||!a){let O=!1;for(;b<o.length;){const j=o[b];if(j===r)return b;if(3===j||6===j)O=!0;else{if(1===j||2===j){let X=o[++b];for(;"string"==typeof X;)X=o[++b];continue}if(4===j)break;if(0===j){b+=4;continue}}b+=O?1:2}return-1}return function pa(r,o){let a=r.indexOf(4);if(a>-1)for(a++;a<r.length;){const f=r[a];if("number"==typeof f)return-1;if(f===o)return a;a++}return-1}(o,r)}function Do(r,o,a=!1){for(let f=0;f<o.length;f++)if(ur(r,o[f],a))return!0;return!1}function ns(r,o){e:for(let a=0;a<o.length;a++){const f=o[a];if(r.length===f.length){for(let b=0;b<r.length;b++)if(r[b]!==f[b])continue e;return!0}}return!1}function Ho(r,o){return r?":not("+o.trim()+")":o}function Yo(r){let o=r[0],a=1,f=2,b="",O=!1;for(;a<r.length;){let j=r[a];if("string"==typeof j)if(2&f){const X=r[++a];b+="["+j+(X.length>0?'="'+X+'"':"")+"]"}else 8&f?b+="."+j:4&f&&(b+=" "+j);else""!==b&&!uo(j)&&(o+=Ho(O,b),b=""),f=j,O=O||!uo(f);a++}return""!==b&&(o+=Ho(O,b)),o}const Ar={};function So(r){ma(ki(),Hn(),ws()+r,Ma())}function ma(r,o,a,f){if(!f)if(3==(3&o[2])){const O=r.preOrderCheckHooks;null!==O&&gt(o,O,a)}else{const O=r.preOrderHooks;null!==O&&Ut(o,O,0,a)}ts(a)}function qa(r,o){return r<<17|o<<2}function el(r){return r>>17&32767}function Kl(r){return 2|r}function Vl(r){return(131068&r)>>2}function Ec(r,o){return-131069&r|o<<2}function Ph(r){return 1|r}function bd(r,o){const a=r.contentQueries;if(null!==a)for(let f=0;f<a.length;f+=2){const b=a[f],O=a[f+1];if(-1!==O){const j=r.data[O];io(b),j.contentQueries(2,o[O],O)}}}function sh(r,o,a,f,b,O,j,X,ue,Ce){const ke=o.blueprint.slice();return ke[0]=b,ke[2]=140|f,gn(ke),ke[3]=ke[15]=r,ke[8]=a,ke[10]=j||r&&r[10],ke[11]=X||r&&r[11],ke[12]=ue||r&&r[12]||null,ke[9]=Ce||r&&r[9]||null,ke[6]=O,ke[16]=2==o.type?r[16]:ke,ke}function Lh(r,o,a,f,b){let O=r.data[o];if(null===O)O=nm(r,o,a,f,b),function vl(){return vi.lFrame.inI18n}()&&(O.flags|=64);else if(64&O.type){O.type=a,O.value=f,O.attrs=b;const j=La();O.injectorIndex=null===j?-1:j.injectorIndex}return Qo(O,!0),O}function nm(r,o,a,f,b){const O=Na(),j=yl(),ue=r.data[o]=function cg(r,o,a,f,b,O){return{type:a,index:f,insertBeforeIndex:null,injectorIndex:o?o.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:b,attrs:O,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:o,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,j?O:O&&O.parent,a,o,f,b);return null===r.firstChild&&(r.firstChild=ue),null!==O&&(j?null==O.child&&null!==ue.parent&&(O.child=ue):null===O.next&&(O.next=ue)),ue}function xd(r,o,a,f){if(0===a)return-1;const b=o.length;for(let O=0;O<a;O++)o.push(f),r.blueprint.push(f),r.data.push(null);return b}function af(r,o,a){es(o);try{const f=r.viewQuery;null!==f&&hm(1,f,a);const b=r.template;null!==b&&og(r,o,b,1,a),r.firstCreatePass&&(r.firstCreatePass=!1),r.staticContentQueries&&bd(r,o),r.staticViewQueries&&hm(2,r.viewQuery,a);const O=r.components;null!==O&&function rg(r,o){for(let a=0;a<o.length;a++)S_(r,o[a])}(o,O)}catch(f){throw r.firstCreatePass&&(r.incompleteFirstPass=!0,r.firstCreatePass=!1),f}finally{o[2]&=-5,Pa()}}function wd(r,o,a,f){const b=o[2];if(256==(256&b))return;es(o);const O=Ma();try{gn(o),function Ka(r){return vi.lFrame.bindingIndex=r}(r.bindingStartIndex),null!==a&&og(r,o,a,2,f);const j=3==(3&b);if(!O)if(j){const Ce=r.preOrderCheckHooks;null!==Ce&&gt(o,Ce,null)}else{const Ce=r.preOrderHooks;null!==Ce&&Ut(o,Ce,0,null),vn(o,0)}if(function Dd(r){for(let o=Kd(r);null!==o;o=ud(o)){if(!o[2])continue;const a=o[9];for(let f=0;f<a.length;f++){const b=a[f],O=b[3];0==(1024&b[2])&&xi(O,1),b[2]|=1024}}}(o),function dp(r){for(let o=Kd(r);null!==o;o=ud(o))for(let a=10;a<o.length;a++){const f=o[a],b=f[1];he(f)&&wd(b,f,b.template,f[8])}}(o),null!==r.contentQueries&&bd(r,o),!O)if(j){const Ce=r.contentCheckHooks;null!==Ce&&gt(o,Ce)}else{const Ce=r.contentHooks;null!==Ce&&Ut(o,Ce,1),vn(o,1)}!function Xl(r,o){const a=r.hostBindingOpCodes;if(null!==a)try{for(let f=0;f<a.length;f++){const b=a[f];if(b<0)ts(~b);else{const O=b,j=a[++f],X=a[++f];wa(j,O),X(2,o[O])}}}finally{ts(-1)}}(r,o);const X=r.components;null!==X&&function sf(r,o){for(let a=0;a<o.length;a++)gg(r,o[a])}(o,X);const ue=r.viewQuery;if(null!==ue&&hm(2,ue,f),!O)if(j){const Ce=r.viewCheckHooks;null!==Ce&&gt(o,Ce)}else{const Ce=r.viewHooks;null!==Ce&&Ut(o,Ce,2),vn(o,2)}!0===r.firstUpdatePass&&(r.firstUpdatePass=!1),O||(o[2]&=-73),1024&o[2]&&(o[2]&=-1025,xi(o[3],-1))}finally{Pa()}}function x_(r,o,a,f){const b=o[10],O=!Ma(),j=ge(o);try{O&&!j&&b.begin&&b.begin(),j&&af(r,o,f),wd(r,o,a,f)}finally{O&&!j&&b.end&&b.end()}}function og(r,o,a,f,b){const O=ws(),j=2&f;try{ts(-1),j&&o.length>20&&ma(r,o,20,Ma()),a(f,b)}finally{ts(O)}}function lf(r,o,a){if(zr(o)){const b=o.directiveEnd;for(let O=o.directiveStart;O<b;O++){const j=r.data[O];j.contentQueries&&j.contentQueries(1,a[O],O)}}}function im(r,o,a){!xs()||(function Bs(r,o,a,f){const b=a.directiveStart,O=a.directiveEnd;r.firstCreatePass||Q(a,o),Xs(f,o);const j=a.initialInputs;for(let X=b;X<O;X++){const ue=r.data[X],Ce=Ir(ue);Ce&&E_(o,a,ue);const ke=dl(o,r,X,a);Xs(ke,o),null!==j&&C_(0,X-b,ke,ue,0,j),Ce&&(bi(a.index,o)[8]=ke)}}(r,o,a,er(a,o)),128==(128&a.flags)&&function sm(r,o,a){const f=a.directiveStart,b=a.directiveEnd,j=a.index,X=function _s(){return vi.lFrame.currentDirectiveIndex}();try{ts(j);for(let ue=f;ue<b;ue++){const Ce=r.data[ue],ke=o[ue];Va(ue),(null!==Ce.hostBindings||0!==Ce.hostVars||null!==Ce.hostAttrs)&&am(Ce,ke)}}finally{ts(-1),Va(X)}}(r,o,a))}function cp(r,o,a=er){const f=o.localNames;if(null!==f){let b=o.index+1;for(let O=0;O<f.length;O+=2){const j=f[O+1],X=-1===j?a(o,r):r[j];r[b++]=X}}}function rm(r){const o=r.tView;return null===o||o.incompleteFirstPass?r.tView=cf(1,null,r.template,r.decls,r.vars,r.directiveDefs,r.pipeDefs,r.viewQuery,r.schemas,r.consts):o}function cf(r,o,a,f,b,O,j,X,ue,Ce){const ke=20+f,ot=ke+b,Ft=function w_(r,o){const a=[];for(let f=0;f<o;f++)a.push(f<r?null:Ar);return a}(ke,ot),ln="function"==typeof Ce?Ce():Ce;return Ft[1]={type:r,blueprint:Ft,template:a,queries:null,viewQuery:X,declTNode:o,data:Ft.slice().fill(null,ke),bindingStartIndex:ke,expandoStartIndex:ot,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof O?O():O,pipeRegistry:"function"==typeof j?j():j,firstChild:null,schemas:ue,consts:ln,incompleteFirstPass:!1}}function lg(r,o,a,f){const b=vg(o);null===a?b.push(f):(b.push(a),r.firstCreatePass&&dm(r).push(f,b.length-1))}function ug(r,o,a){for(let f in r)if(r.hasOwnProperty(f)){const b=r[f];(a=null===a?{}:a).hasOwnProperty(f)?a[f].push(o,b):a[f]=[o,b]}return a}function sc(r,o,a,f,b,O,j,X){const ue=er(o,a);let ke,Ce=o.inputs;!X&&null!=Ce&&(ke=Ce[f])?(mp(r,a,ke,f,b),rs(o)&&function up(r,o){const a=bi(o,r);16&a[2]||(a[2]|=64)}(a,o.index)):3&o.type&&(f=function wu(r){return"class"===r?"className":"for"===r?"htmlFor":"formaction"===r?"formAction":"innerHtml"===r?"innerHTML":"readonly"===r?"readOnly":"tabindex"===r?"tabIndex":r}(f),b=null!=j?j(b,o.value||"",f):b,be(O)?O.setProperty(ue,f,b):Jn(f)||(ue.setProperty?ue.setProperty(f,b):ue[f]=b))}function hp(r,o,a,f){let b=!1;if(xs()){const O=function hg(r,o,a){const f=r.directiveRegistry;let b=null;if(f)for(let O=0;O<f.length;O++){const j=f[O];Do(a,j.selectors,!1)&&(b||(b=[]),zt(Q(a,o),r,j.type),Ir(j)?(Tu(r,a),b.unshift(j)):b.push(j))}return b}(r,o,a),j=null===f?null:{"":-1};if(null!==O){b=!0,fg(a,r.data.length,O.length);for(let ke=0;ke<O.length;ke++){const ot=O[ke];ot.providersResolver&&ot.providersResolver(ot)}let X=!1,ue=!1,Ce=xd(r,o,O.length,null);for(let ke=0;ke<O.length;ke++){const ot=O[ke];a.mergedAttrs=xo(a.mergedAttrs,ot.hostAttrs),pg(r,a,o,Ce,ot),dg(Ce,ot,j),null!==ot.contentQueries&&(a.flags|=8),(null!==ot.hostBindings||null!==ot.hostAttrs||0!==ot.hostVars)&&(a.flags|=128);const Ft=ot.type.prototype;!X&&(Ft.ngOnChanges||Ft.ngOnInit||Ft.ngDoCheck)&&((r.preOrderHooks||(r.preOrderHooks=[])).push(a.index),X=!0),!ue&&(Ft.ngOnChanges||Ft.ngDoCheck)&&((r.preOrderCheckHooks||(r.preOrderCheckHooks=[])).push(a.index),ue=!0),Ce++}!function jl(r,o){const f=o.directiveEnd,b=r.data,O=o.attrs,j=[];let X=null,ue=null;for(let Ce=o.directiveStart;Ce<f;Ce++){const ke=b[Ce],ot=ke.inputs,Ft=null===O||or(o)?null:D_(ot,O);j.push(Ft),X=ug(ot,Ce,X),ue=ug(ke.outputs,Ce,ue)}null!==X&&(X.hasOwnProperty("class")&&(o.flags|=16),X.hasOwnProperty("style")&&(o.flags|=32)),o.initialInputs=j,o.inputs=X,o.outputs=ue}(r,a)}j&&function Cd(r,o,a){if(o){const f=r.localNames=[];for(let b=0;b<o.length;b+=2){const O=a[o[b+1]];if(null==O)throw new dn(-301,!1);f.push(o[b],O)}}}(a,f,j)}return a.mergedAttrs=xo(a.mergedAttrs,a.attrs),b}function om(r,o,a,f,b,O){const j=O.hostBindings;if(j){let X=r.hostBindingOpCodes;null===X&&(X=r.hostBindingOpCodes=[]);const ue=~o.index;(function uf(r){let o=r.length;for(;o>0;){const a=r[--o];if("number"==typeof a&&a<0)return a}return 0})(X)!=ue&&X.push(ue),X.push(f,b,j)}}function am(r,o){null!==r.hostBindings&&r.hostBindings(1,o)}function Tu(r,o){o.flags|=2,(r.components||(r.components=[])).push(o.index)}function dg(r,o,a){if(a){if(o.exportAs)for(let f=0;f<o.exportAs.length;f++)a[o.exportAs[f]]=r;Ir(o)&&(a[""]=r)}}function fg(r,o,a){r.flags|=1,r.directiveStart=o,r.directiveEnd=o+a,r.providerIndexes=o}function pg(r,o,a,f,b){r.data[f]=b;const O=b.factory||(b.factory=Ms(b.type)),j=new ai(O,Ir(b),null);r.blueprint[f]=j,a[f]=j,om(r,o,0,f,xd(r,a,b.hostVars,Ar),b)}function E_(r,o,a){const f=er(o,r),b=rm(a),O=r[10],j=Sd(r,sh(r,b,null,a.onPush?64:16,f,o,O,O.createRenderer(f,a),null,null));r[o.index]=j}function lm(r,o,a,f,b,O,j){if(null==O)be(r)?r.removeAttribute(o,b,a):o.removeAttribute(b);else{const X=null==j?on(O):j(O,f||"",b);be(r)?r.setAttribute(o,b,X,a):a?o.setAttributeNS(a,b,X):o.setAttribute(b,X)}}function C_(r,o,a,f,b,O){const j=O[o];if(null!==j){const X=f.setInput;for(let ue=0;ue<j.length;){const Ce=j[ue++],ke=j[ue++],ot=j[ue++];null!==X?f.setInput(a,ot,Ce,ke):a[ke]=ot}}}function D_(r,o){let a=null,f=0;for(;f<o.length;){const b=o[f];if(0!==b)if(5!==b){if("number"==typeof b)break;r.hasOwnProperty(b)&&(null===a&&(a=[]),a.push(b,r[b],o[f+1])),f+=2}else f+=2;else f+=4}return a}function mg(r,o,a,f){return new Array(r,!0,!1,o,null,0,f,a,null,null)}function gg(r,o){const a=bi(o,r);if(he(a)){const f=a[1];80&a[2]?wd(f,a,f.template,a[8]):a[5]>0&&cm(a)}}function cm(r){for(let f=Kd(r);null!==f;f=ud(f))for(let b=10;b<f.length;b++){const O=f[b];if(1024&O[2]){const j=O[1];wd(j,O,j.template,O[8])}else O[5]>0&&cm(O)}const a=r[1].components;if(null!==a)for(let f=0;f<a.length;f++){const b=bi(a[f],r);he(b)&&b[5]>0&&cm(b)}}function S_(r,o){const a=bi(o,r),f=a[1];(function A_(r,o){for(let a=o.length;a<r.blueprint.length;a++)o.push(r.blueprint[a])})(f,a),af(f,a,a[8])}function Sd(r,o){return r[13]?r[14][4]=o:r[13]=o,r[14]=o,o}function hf(r){for(;r;){r[2]|=64;const o=jc(r);if(Vo(r)&&!o)return r;r=o}return null}function Fh(r,o,a){const f=o[10];f.begin&&f.begin();try{wd(r,o,r.template,a)}catch(b){throw pp(o,b),b}finally{f.end&&f.end()}}function Bh(r){!function ac(r){for(let o=0;o<r.components.length;o++){const a=r.components[o],f=Qa(a),b=f[1];x_(b,f,b.template,a)}}(r[8])}function hm(r,o,a){io(0),o(r,a)}const yg=(()=>Promise.resolve(null))();function vg(r){return r[7]||(r[7]=[])}function dm(r){return r.cleanup||(r.cleanup=[])}function pp(r,o){const a=r[9],f=a?a.get(Nu,null):null;f&&f.handleError(o)}function mp(r,o,a,f,b){for(let O=0;O<a.length;){const j=a[O++],X=a[O++],ue=o[j],Ce=r.data[j];null!==Ce.setInput?Ce.setInput(ue,b,f,X):ue[X]=b}}function gp(r,o,a){let f=a?r.styles:null,b=a?r.classes:null,O=0;if(null!==o)for(let j=0;j<o.length;j++){const X=o[j];"number"==typeof X?O=X:1==O?b=Bt(b,X):2==O&&(f=Bt(f,X+": "+o[++j]+";"))}a?r.styles=f:r.stylesWithoutHost=f,a?r.classes=b:r.classesWithoutHost=b}const _p=new Rs("INJECTOR",-1);class pm{get(o,a=z){if(a===z){const f=new Error(`NullInjectorError: No provider for ${wt(o)}!`);throw f.name="NullInjectorError",f}return a}}const yp=new Rs("Set Injector scope."),df={},P_={};let vp;function mm(){return void 0===vp&&(vp=new pm),vp}function Ad(r,o=null,a=null,f){const b=gm(r,o,a,f);return b._resolveInjectorDefTypes(),b}function gm(r,o=null,a=null,f){return new xg(r,a,o||mm(),f)}class xg{constructor(o,a,f,b=null){this.parent=f,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const O=[];a&&Zl(a,X=>this.processProvider(X,o,a)),Zl([o],X=>this.processInjectorType(X,[],O)),this.records.set(_p,zh(void 0,this));const j=this.records.get(yp);this.scope=null!=j?j.value:null,this.source=b||("object"==typeof o?null:wt(o))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(o=>o.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(o,a=z,f=dr.Default){this.assertNotDestroyed();const b=He(this),O=Ot(void 0);try{if(!(f&dr.SkipSelf)){let X=this.records.get(o);if(void 0===X){const ue=function Pd(r){return"function"==typeof r||"object"==typeof r&&r instanceof Rs}(o)&&fi(o);X=ue&&this.injectableDefInScope(ue)?zh(ff(o),df):null,this.records.set(o,X)}if(null!=X)return this.hydrate(o,X)}return(f&dr.Self?mm():this.parent).get(o,a=f&dr.Optional&&a===z?null:a)}catch(j){if("NullInjectorError"===j.name){if((j[K]=j[K]||[]).unshift(wt(o)),b)throw j;return function It(r,o,a,f){const b=r[K];throw o[Fe]&&b.unshift(o[Fe]),r.message=function Ct(r,o,a,f=null){r=r&&"\n"===r.charAt(0)&&"\u0275"==r.charAt(1)?r.substr(2):r;let b=wt(o);if(Array.isArray(o))b=o.map(wt).join(" -> ");else if("object"==typeof o){let O=[];for(let j in o)if(o.hasOwnProperty(j)){let X=o[j];O.push(j+":"+("string"==typeof X?JSON.stringify(X):wt(X)))}b=`{${O.join(", ")}}`}return`${a}${f?"("+f+")":""}[${b}]: ${r.replace(pe,"\n  ")}`}("\n"+r.message,b,a,f),r.ngTokenPath=b,r[K]=null,r}(j,o,"R3InjectorError",this.source)}throw j}finally{Ot(O),He(b)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(o=>this.get(o))}toString(){const o=[];return this.records.forEach((f,b)=>o.push(wt(b))),`R3Injector[${o.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new dn(205,!1)}processInjectorType(o,a,f){if(!(o=ft(o)))return!1;let b=Ur(o);const O=null==b&&o.ngModule||void 0,j=void 0===O?o:O,X=-1!==f.indexOf(j);if(void 0!==O&&(b=Ur(O)),null==b)return!1;if(null!=b.imports&&!X){let ke;f.push(j);try{Zl(b.imports,ot=>{this.processInjectorType(ot,a,f)&&(void 0===ke&&(ke=[]),ke.push(ot))})}finally{}if(void 0!==ke)for(let ot=0;ot<ke.length;ot++){const{ngModule:Ft,providers:ln}=ke[ot];Zl(ln,$n=>this.processProvider($n,Ft,ln||ir))}}this.injectorDefTypes.add(j);const ue=Ms(j)||(()=>new j);this.records.set(j,zh(ue,df));const Ce=b.providers;if(null!=Ce&&!X){const ke=o;Zl(Ce,ot=>this.processProvider(ot,ke,Ce))}return void 0!==O&&void 0!==o.providers}processProvider(o,a,f){let b=Id(o=ft(o))?o:ft(o&&o.provide);const O=function wg(r,o,a){return mf(r)?zh(void 0,r.useValue):zh(pf(r),df)}(o);if(Id(o)||!0!==o.multi)this.records.get(b);else{let j=this.records.get(b);j||(j=zh(void 0,df,!0),j.factory=()=>Mt(j.multi),this.records.set(b,j)),b=o,j.multi.push(o)}this.records.set(b,O)}hydrate(o,a){return a.value===df&&(a.value=P_,a.value=a.factory()),"object"==typeof a.value&&a.value&&function N_(r){return null!==r&&"object"==typeof r&&"function"==typeof r.ngOnDestroy}(a.value)&&this.onDestroy.add(a.value),a.value}injectableDefInScope(o){if(!o.providedIn)return!1;const a=ft(o.providedIn);return"string"==typeof a?"any"===a||a===this.scope:this.injectorDefTypes.has(a)}}function ff(r){const o=fi(r),a=null!==o?o.factory:Ms(r);if(null!==a)return a;if(r instanceof Rs)throw new dn(204,!1);if(r instanceof Function)return function Md(r){const o=r.length;if(o>0)throw tc(o,"?"),new dn(204,!1);const a=function Tr(r){const o=r&&(r[Mn]||r[qr]);if(o){const a=function Zr(r){if(r.hasOwnProperty("name"))return r.name;const o=(""+r).match(/^function\s*([^\s(]+)/);return null===o?"":o[1]}(r);return console.warn(`DEPRECATED: DI is instantiating a token "${a}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${a}" class.`),o}return null}(r);return null!==a?()=>a.factory(r):()=>new r}(r);throw new dn(204,!1)}function pf(r,o,a){let f;if(Id(r)){const b=ft(r);return Ms(b)||ff(b)}if(mf(r))f=()=>ft(r.useValue);else if(function O_(r){return!(!r||!r.useFactory)}(r))f=()=>r.useFactory(...Mt(r.deps||[]));else if(function bp(r){return!(!r||!r.useExisting)}(r))f=()=>ze(ft(r.useExisting));else{const b=ft(r&&(r.useClass||r.provide));if(!function k_(r){return!!r.deps}(r))return Ms(b)||ff(b);f=()=>new b(...Mt(r.deps))}return f}function zh(r,o,a=!1){return{factory:r,value:o,multi:a?[]:void 0}}function mf(r){return null!==r&&"object"==typeof r&&Je in r}function Id(r){return"function"==typeof r}let Dc=(()=>{class r{static create(a,f){var b;if(Array.isArray(a))return Ad({name:""},f,a,"");{const O=null!==(b=a.name)&&void 0!==b?b:"";return Ad({name:O},a.parent,a.providers,O)}}}return r.THROW_IF_NOT_FOUND=z,r.NULL=new pm,r.\u0275prov=Tt({token:r,providedIn:"any",factory:()=>ze(_p)}),r.__NG_ELEMENT_ID__=-1,r})();function L_(r,o){Ue(Qa(r)[1],os())}function ch(r){let o=function Cp(r){return Object.getPrototypeOf(r.prototype).constructor}(r.type),a=!0;const f=[r];for(;o;){let b;if(Ir(r))b=o.\u0275cmp||o.\u0275dir;else{if(o.\u0275cmp)throw new dn(903,"");b=o.\u0275dir}if(b){if(a){f.push(b);const j=r;j.inputs=Uh(r.inputs),j.declaredInputs=Uh(r.declaredInputs),j.outputs=Uh(r.outputs);const X=b.hostBindings;X&&_f(r,X);const ue=b.viewQuery,Ce=b.contentQueries;if(ue&&Sp(r,ue),Ce&&Pg(r,Ce),Nt(r.inputs,b.inputs),Nt(r.declaredInputs,b.declaredInputs),Nt(r.outputs,b.outputs),Ir(b)&&b.data.animation){const ke=r.data;ke.animation=(ke.animation||[]).concat(b.data.animation)}}const O=b.features;if(O)for(let j=0;j<O.length;j++){const X=O[j];X&&X.ngInherit&&X(r),X===ch&&(a=!1)}}o=Object.getPrototypeOf(o)}!function Dp(r){let o=0,a=null;for(let f=r.length-1;f>=0;f--){const b=r[f];b.hostVars=o+=b.hostVars,b.hostAttrs=xo(b.hostAttrs,a=xo(a,b.hostAttrs))}}(f)}function Uh(r){return r===Io?{}:r===ir?[]:r}function Sp(r,o){const a=r.viewQuery;r.viewQuery=a?(f,b)=>{o(f,b),a(f,b)}:o}function Pg(r,o){const a=r.contentQueries;r.contentQueries=a?(f,b,O)=>{o(f,b,O),a(f,b,O)}:o}function _f(r,o){const a=r.hostBindings;r.hostBindings=a?(f,b)=>{o(f,b),a(f,b)}:o}let vf=null;function Vh(){if(!vf){const r=ei.Symbol;if(r&&r.iterator)vf=r.iterator;else{const o=Object.getOwnPropertyNames(Map.prototype);for(let a=0;a<o.length;++a){const f=o[a];"entries"!==f&&"size"!==f&&Map.prototype[f]===Map.prototype.entries&&(vf=f)}}}return vf}function bf(r){return!!Tm(r)&&(Array.isArray(r)||!(r instanceof Map)&&Vh()in r)}function Tm(r){return null!==r&&("function"==typeof r||"object"==typeof r)}function ql(r,o,a){return r[o]=a}function ml(r,o,a){return!Object.is(r[o],a)&&(r[o]=a,!0)}function ru(r,o,a,f){const b=ml(r,o,a);return ml(r,o+1,f)||b}function Rd(r,o,a,f){const b=Hn();return ml(b,xa(),o)&&(ki(),function Eu(r,o,a,f,b,O){const j=er(r,o);lm(o[11],j,O,r.value,a,f,b)}(bo(),b,r,o,a,f)),Rd}function Nd(r,o,a,f){return ml(r,xa(),a)?o+on(a)+f:Ar}function Ap(r,o,a,f,b,O,j,X){const ue=Hn(),Ce=ki(),ke=r+20,ot=Ce.firstCreatePass?function B_(r,o,a,f,b,O,j,X,ue){const Ce=o.consts,ke=Lh(o,r,4,j||null,Re(Ce,X));hp(o,a,ke,Re(Ce,ue)),Ue(o,ke);const ot=ke.tViews=cf(2,ke,f,b,O,o.directiveRegistry,o.pipeRegistry,null,o.schemas,Ce);return null!==o.queries&&(o.queries.template(o,ke),ot.queries=o.queries.embeddedTView(ke)),ke}(ke,Ce,ue,o,a,f,b,O,j):Ce.data[ke];Qo(ot,!1);const Ft=ue[11].createComment("");tf(Ce,ue,Ft,ot),Xs(Ft,ue),Sd(ue,ue[ke]=mg(Ft,ue,Ft,ot)),vs(ot)&&im(Ce,ue,ot),null!=j&&cp(ue,ot,X)}function Gu(r){return Zi(function Ya(){return vi.lFrame.contextLView}(),20+r)}function mc(r,o=dr.Default){const a=Hn();return null===a?ze(r,o):ro(os(),a,ft(r),o)}function Mp(){throw new Error("invalid")}function Mf(r,o,a){const f=Hn();return ml(f,xa(),o)&&sc(ki(),bo(),f,r,o,f[11],a,!1),Mf}function Ac(r,o,a,f,b){const j=b?"class":"style";mp(r,a,o.inputs[j],j,f)}function If(r,o,a,f){const b=Hn(),O=ki(),j=20+r,X=b[11],ue=b[j]=hd(X,o,function Rl(){return vi.lFrame.currentNamespace}()),Ce=O.firstCreatePass?function qh(r,o,a,f,b,O,j){const X=o.consts,Ce=Lh(o,r,2,b,Re(X,O));return hp(o,a,Ce,Re(X,j)),null!==Ce.attrs&&gp(Ce,Ce.attrs,!1),null!==Ce.mergedAttrs&&gp(Ce,Ce.mergedAttrs,!0),null!==o.queries&&o.queries.elementStart(o,Ce),Ce}(j,O,b,0,o,a,f):O.data[j];Qo(Ce,!0);const ke=Ce.mergedAttrs;null!==ke&&ut(X,ue,ke);const ot=Ce.classes;null!==ot&&ht(X,ue,ot);const Ft=Ce.styles;return null!==Ft&&ve(X,ue,Ft),64!=(64&Ce.flags)&&tf(O,b,ue,Ce),0===function ms(){return vi.lFrame.elementDepthCount}()&&Xs(ue,b),function bs(){vi.lFrame.elementDepthCount++}(),vs(Ce)&&(im(O,b,Ce),lf(O,Ce,b)),null!==f&&cp(b,Ce),If}function Pf(){let r=os();yl()?Ua():(r=r.parent,Qo(r,!1));const o=r;!function No(){vi.lFrame.elementDepthCount--}();const a=ki();return a.firstCreatePass&&(Ue(a,r),zr(r)&&a.queries.elementEnd(r)),null!=o.classesWithoutHost&&function yr(r){return 0!=(16&r.flags)}(o)&&Ac(a,o,Hn(),o.classesWithoutHost,!0),null!=o.stylesWithoutHost&&function q(r){return 0!=(32&r.flags)}(o)&&Ac(a,o,Hn(),o.stylesWithoutHost,!1),Pf}function Wh(r,o,a,f){return If(r,o,a,f),Pf(),Wh}function Of(r,o,a){const f=Hn(),b=ki(),O=r+20,j=b.firstCreatePass?function Jg(r,o,a,f,b){const O=o.consts,j=Re(O,f),X=Lh(o,r,8,"ng-container",j);return null!==j&&gp(X,j,!0),hp(o,a,X,Re(O,b)),null!==o.queries&&o.queries.elementStart(o,X),X}(O,b,f,o,a):b.data[O];Qo(j,!0);const X=f[O]=f[11].createComment("");return tf(b,f,X,j),Xs(X,f),vs(j)&&(im(b,f,j),lf(b,j,f)),null!=a&&cp(f,j),Of}function Ip(){let r=os();const o=ki();return yl()?Ua():(r=r.parent,Qo(r,!1)),o.firstCreatePass&&(Ue(o,r),zr(r)&&o.queries.elementEnd(r)),Ip}function Qg(){return Hn()}function Rf(r){return!!r&&"function"==typeof r.then}function Nm(r){return!!r&&"function"==typeof r.subscribe}const Lm=Nm;function t(r,o,a,f){const b=Hn(),O=ki(),j=os();return function s(r,o,a,f,b,O,j,X){const ue=vs(f),ke=r.firstCreatePass&&dm(r),ot=o[8],Ft=vg(o);let ln=!0;if(3&f.type||X){const Yi=er(f,o),br=X?X(Yi):Yi,ri=Ft.length,Jr=X?ls=>X(mt(ls[f.index])):f.index;if(be(a)){let ls=null;if(!X&&ue&&(ls=function n(r,o,a,f){const b=r.cleanup;if(null!=b)for(let O=0;O<b.length-1;O+=2){const j=b[O];if(j===a&&b[O+1]===f){const X=o[7],ue=b[O+2];return X.length>ue?X[ue]:null}"string"==typeof j&&(O+=2)}return null}(r,o,b,f.index)),null!==ls)(ls.__ngLastListenerFn__||ls).__ngNextListenerFn__=O,ls.__ngLastListenerFn__=O,ln=!1;else{O=p(f,o,ot,O,!1);const la=a.listen(br,b,O);Ft.push(O,la),ke&&ke.push(b,Jr,ri,ri+1)}}else O=p(f,o,ot,O,!0),br.addEventListener(b,O,j),Ft.push(O),ke&&ke.push(b,Jr,ri,j)}else O=p(f,o,ot,O,!1);const $n=f.outputs;let Si;if(ln&&null!==$n&&(Si=$n[b])){const Yi=Si.length;if(Yi)for(let br=0;br<Yi;br+=2){const au=o[Si[br]][Si[br+1]].subscribe(O),Ff=Ft.length;Ft.push(O,au),ke&&ke.push(b,f.index,Ff,-(Ff+1))}}}(O,b,b[11],j,r,o,!!a,f),t}function h(r,o,a,f){try{return!1!==a(f)}catch(b){return pp(r,b),!1}}function p(r,o,a,f,b){return function O(j){if(j===Function)return f;const X=2&r.flags?bi(r.index,o):o;0==(32&o[2])&&hf(X);let ue=h(o,0,f,j),Ce=O.__ngNextListenerFn__;for(;Ce;)ue=h(o,0,Ce,j)&&ue,Ce=Ce.__ngNextListenerFn__;return b&&!1===ue&&(j.preventDefault(),j.returnValue=!1),ue}}function y(r=1){return function Ps(r){return(vi.lFrame.contextLView=function Ba(r,o){for(;r>0;)o=o[15],r--;return o}(r,vi.lFrame.contextLView))[8]}(r)}function T(r,o){let a=null;const f=function Wo(r){const o=r.attrs;if(null!=o){const a=o.indexOf(5);if(0==(1&a))return o[a+1]}return null}(r);for(let b=0;b<o.length;b++){const O=o[b];if("*"!==O){if(null===f?Do(r,O,!0):ns(f,O))return b}else a=b}return a}function R(r){const o=Hn()[16][6];if(!o.projection){const f=o.projection=tc(r?r.length:1,null),b=f.slice();let O=o.child;for(;null!==O;){const j=r?T(O,r):0;null!==j&&(b[j]?b[j].projectionNext=O:f[j]=O,b[j]=O),O=O.next}}}function F(r,o=0,a){const f=Hn(),b=ki(),O=Lh(b,20+r,16,null,a||null);null===O.projection&&(O.projection=o),Ua(),64!=(64&O.flags)&&function k(r,o,a){_(o[11],0,o,a,Gp(r,a,o),Jd(a.parent||o[6],a,o))}(b,f,O)}function W(r,o,a){return te(r,"",o,"",a),W}function te(r,o,a,f,b){const O=Hn(),j=Nd(O,o,a,f);return j!==Ar&&sc(ki(),bo(),O,r,j,O[11],b,!1),te}function fn(r,o,a,f,b){const O=r[a+1],j=null===o;let X=f?el(O):Vl(O),ue=!1;for(;0!==X&&(!1===ue||j);){const ke=r[X+1];hn(r[X],o)&&(ue=!0,r[X+1]=f?Ph(ke):Kl(ke)),X=f?el(ke):Vl(ke)}ue&&(r[a+1]=f?Kl(O):Ph(O))}function hn(r,o){return null===r||null==o||(Array.isArray(r)?r[1]:r)===o||!(!Array.isArray(r)||"string"!=typeof o)&&bc(r,o)>=0}const bn={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function hi(r){return r.substring(bn.key,bn.keyEnd)}function Yn(r,o){const a=bn.textEnd;return a===o?-1:(o=bn.keyEnd=function so(r,o,a){for(;o<a&&r.charCodeAt(o)>32;)o++;return o}(r,bn.key=o,a),Di(r,o,a))}function Di(r,o,a){for(;o<a&&r.charCodeAt(o)<=32;)o++;return o}function zi(r,o,a){return Bo(r,o,a,!1),zi}function Cs(r,o){return Bo(r,o,null,!0),Cs}function go(r){ko(fl,_o,r,!0)}function _o(r,o){for(let a=function Zn(r){return function Kn(r){bn.key=0,bn.keyEnd=0,bn.value=0,bn.valueEnd=0,bn.textEnd=r.length}(r),Yn(r,Di(r,0,bn.textEnd))}(o);a>=0;a=Yn(o,a))fl(r,hi(o),!0)}function Bo(r,o,a,f){const b=Hn(),O=ki(),j=gs(2);O.firstUpdatePass&&$s(O,r,j,f),o!==Ar&&ml(b,j,o)&&Js(O,O.data[ws()],b,b[11],r,b[j+1]=function gl(r,o){return null==r||("string"==typeof o?r+=o:"object"==typeof r&&(r=wt(Lo(r)))),r}(o,a),f,j)}function ko(r,o,a,f){const b=ki(),O=gs(2);b.firstUpdatePass&&$s(b,null,O,f);const j=Hn();if(a!==Ar&&ml(j,O,a)){const X=b.data[ws()];if(Il(X,f)&&!ys(b,O)){let ue=f?X.classesWithoutHost:X.stylesWithoutHost;null!==ue&&(a=Bt(ue,a||"")),Ac(b,X,j,a,f)}else!function Ql(r,o,a,f,b,O,j,X){b===Ar&&(b=ir);let ue=0,Ce=0,ke=0<b.length?b[0]:null,ot=0<O.length?O[0]:null;for(;null!==ke||null!==ot;){const Ft=ue<b.length?b[ue+1]:void 0,ln=Ce<O.length?O[Ce+1]:void 0;let Si,$n=null;ke===ot?(ue+=2,Ce+=2,Ft!==ln&&($n=ot,Si=ln)):null===ot||null!==ke&&ke<ot?(ue+=2,$n=ke):(Ce+=2,$n=ot,Si=ln),null!==$n&&Js(r,o,a,f,$n,Si,j,X),ke=ue<b.length?b[ue]:null,ot=Ce<O.length?O[Ce]:null}}(b,X,j,j[11],j[O+1],j[O+1]=function is(r,o,a){if(null==a||""===a)return ir;const f=[],b=Lo(a);if(Array.isArray(b))for(let O=0;O<b.length;O++)r(f,b[O],!0);else if("object"==typeof b)for(const O in b)b.hasOwnProperty(O)&&r(f,O,b[O]);else"string"==typeof b&&o(f,b);return f}(r,o,a),f,O)}}function ys(r,o){return o>=r.expandoStartIndex}function $s(r,o,a,f){const b=r.data;if(null===b[a+1]){const O=b[ws()],j=ys(r,a);Il(O,f)&&null===o&&!j&&(o=!1),o=function ga(r,o,a,f){const b=function Ia(r){const o=vi.lFrame.currentDirectiveIndex;return-1===o?null:r[o]}(r);let O=f?o.residualClasses:o.residualStyles;if(null===b)0===(f?o.classBindings:o.styleBindings)&&(a=ll(a=_a(null,r,o,a,f),o.attrs,f),O=null);else{const j=o.directiveStylingLast;if(-1===j||r[j]!==b)if(a=_a(b,r,o,a,f),null===O){let ue=function Ml(r,o,a){const f=a?o.classBindings:o.styleBindings;if(0!==Vl(f))return r[el(f)]}(r,o,f);void 0!==ue&&Array.isArray(ue)&&(ue=_a(null,r,o,ue[1],f),ue=ll(ue,o.attrs,f),function cc(r,o,a,f){r[el(a?o.classBindings:o.styleBindings)]=f}(r,o,f,ue))}else O=function zo(r,o,a){let f;const b=o.directiveEnd;for(let O=1+o.directiveStylingLast;O<b;O++)f=ll(f,r[O].hostAttrs,a);return ll(f,o.attrs,a)}(r,o,f)}return void 0!==O&&(f?o.residualClasses=O:o.residualStyles=O),a}(b,O,o,f),function Lt(r,o,a,f,b,O){let j=O?o.classBindings:o.styleBindings,X=el(j),ue=Vl(j);r[f]=a;let ke,Ce=!1;if(Array.isArray(a)){const ot=a;ke=ot[1],(null===ke||bc(ot,ke)>0)&&(Ce=!0)}else ke=a;if(b)if(0!==ue){const Ft=el(r[X+1]);r[f+1]=qa(Ft,X),0!==Ft&&(r[Ft+1]=Ec(r[Ft+1],f)),r[X+1]=function Yl(r,o){return 131071&r|o<<17}(r[X+1],f)}else r[f+1]=qa(X,0),0!==X&&(r[X+1]=Ec(r[X+1],f)),X=f;else r[f+1]=qa(ue,0),0===X?X=f:r[ue+1]=Ec(r[ue+1],f),ue=f;Ce&&(r[f+1]=Kl(r[f+1])),fn(r,ke,f,!0),fn(r,ke,f,!1),function St(r,o,a,f,b){const O=b?r.residualClasses:r.residualStyles;null!=O&&"string"==typeof o&&bc(O,o)>=0&&(a[f+1]=Ph(a[f+1]))}(o,ke,r,f,O),j=qa(X,ue),O?o.classBindings=j:o.styleBindings=j}(b,O,o,a,j,f)}}function _a(r,o,a,f,b){let O=null;const j=a.directiveEnd;let X=a.directiveStylingLast;for(-1===X?X=a.directiveStart:X++;X<j&&(O=o[X],f=ll(f,O.hostAttrs,b),O!==r);)X++;return null!==r&&(a.directiveStylingLast=X),f}function ll(r,o,a){const f=a?1:2;let b=-1;if(null!==o)for(let O=0;O<o.length;O++){const j=o[O];"number"==typeof j?b=j:b===f&&(Array.isArray(r)||(r=void 0===r?[]:["",r]),fl(r,j,!!a||o[++O]))}return void 0===r?null:r}function Js(r,o,a,f,b,O,j,X){if(!(3&o.type))return;const ue=r.data,Ce=ue[X+1];tl(function Uu(r){return 1==(1&r)}(Ce)?Ra(ue,o,a,b,Vl(Ce),j):void 0)||(tl(O)||function pc(r){return 2==(2&r)}(Ce)&&(O=Ra(ue,null,a,b,X,j)),function ie(r,o,a,f,b){const O=be(r);if(o)b?O?r.addClass(a,f):a.classList.add(f):O?r.removeClass(a,f):a.classList.remove(f);else{let j=-1===f.indexOf("-")?void 0:Vc.DashCase;if(null==b)O?r.removeStyle(a,f,j):a.style.removeProperty(f);else{const X="string"==typeof b&&b.endsWith("!important");X&&(b=b.slice(0,-10),j|=Vc.Important),O?r.setStyle(a,f,b,j):a.style.setProperty(f,b,X?"important":"")}}}(f,j,wn(ws(),a),b,O))}function Ra(r,o,a,f,b,O){const j=null===o;let X;for(;b>0;){const ue=r[b],Ce=Array.isArray(ue),ke=Ce?ue[1]:ue,ot=null===ke;let Ft=a[b+1];Ft===Ar&&(Ft=ot?ir:void 0);let ln=ot?uu(Ft,f):ke===f?Ft:void 0;if(Ce&&!tl(ln)&&(ln=uu(ue,f)),tl(ln)&&(X=ln,j))return X;const $n=r[b+1];b=j?el($n):Vl($n)}if(null!==o){let ue=O?o.residualClasses:o.residualStyles;null!=ue&&(X=uu(ue,f))}return X}function tl(r){return void 0!==r}function Il(r,o){return 0!=(r.flags&(o?16:32))}function Wl(r,o=""){const a=Hn(),f=ki(),b=r+20,O=f.firstCreatePass?Lh(f,b,1,o,null):f.data[b],j=a[b]=nh(a[11],o);tf(f,a,j,O),Qo(O,!1)}function cl(r){return Wc("",r,""),cl}function Wc(r,o,a){const f=Hn(),b=Nd(f,r,o,a);return b!==Ar&&function Cu(r,o,a){const f=wn(o,r);ih(r[11],f,a)}(f,ws(),b),Wc}function su(r,o,a){ko(fl,_o,Nd(Hn(),r,o,a),!0)}function $_(r,o,a){const f=Hn();return ml(f,xa(),o)&&sc(ki(),bo(),f,r,o,f[11],a,!0),$_}const Nf=void 0;var m1=["en",[["a","p"],["AM","PM"],Nf],[["AM","PM"],Nf,Nf],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Nf,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Nf,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Nf,"{1} 'at' {0}",Nf],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function p1(r){const a=Math.floor(Math.abs(r)),f=r.toString().replace(/^[^.]*\.?/,"").length;return 1===a&&0===f?1:5}];let Rp={};function q_(r){const o=function g1(r){return r.toLowerCase().replace(/_/g,"-")}(r);let a=cv(o);if(a)return a;const f=o.split("-")[0];if(a=cv(f),a)return a;if("en"===f)return m1;throw new Error(`Missing locale data for the locale "${r}".`)}function lv(r){return q_(r)[ao.PluralCase]}function cv(r){return r in Rp||(Rp[r]=ei.ng&&ei.ng.common&&ei.ng.common.locales&&ei.ng.common.locales[r]),Rp[r]}var ao=(()=>((ao=ao||{})[ao.LocaleId=0]="LocaleId",ao[ao.DayPeriodsFormat=1]="DayPeriodsFormat",ao[ao.DayPeriodsStandalone=2]="DayPeriodsStandalone",ao[ao.DaysFormat=3]="DaysFormat",ao[ao.DaysStandalone=4]="DaysStandalone",ao[ao.MonthsFormat=5]="MonthsFormat",ao[ao.MonthsStandalone=6]="MonthsStandalone",ao[ao.Eras=7]="Eras",ao[ao.FirstDayOfWeek=8]="FirstDayOfWeek",ao[ao.WeekendRange=9]="WeekendRange",ao[ao.DateFormat=10]="DateFormat",ao[ao.TimeFormat=11]="TimeFormat",ao[ao.DateTimeFormat=12]="DateTimeFormat",ao[ao.NumberSymbols=13]="NumberSymbols",ao[ao.NumberFormats=14]="NumberFormats",ao[ao.CurrencyCode=15]="CurrencyCode",ao[ao.CurrencySymbol=16]="CurrencySymbol",ao[ao.CurrencyName=17]="CurrencyName",ao[ao.Currencies=18]="Currencies",ao[ao.Directionality=19]="Directionality",ao[ao.PluralCase=20]="PluralCase",ao[ao.ExtraData=21]="ExtraData",ao))();const _1=["zero","one","two","few","many"],n_="en-US",i_={marker:"element"},r_={marker:"ICU"};var _l=(()=>((_l=_l||{})[_l.SHIFT=2]="SHIFT",_l[_l.APPEND_EAGERLY=1]="APPEND_EAGERLY",_l[_l.COMMENT=2]="COMMENT",_l))();let uv=n_;function hv(r,o,a){const f=o.insertBeforeIndex,b=Array.isArray(f)?f[0]:f;return null===b?Qd(r,0,a):mt(a[b])}function dv(r,o,a,f,b){const O=o.insertBeforeIndex;if(Array.isArray(O)){let j=f,X=null;if(3&o.type||(X=j,j=b),null!==j&&0==(2&o.flags))for(let ue=1;ue<O.length;ue++)_u(r,j,a[O[ue]],X,!1)}}function fv(r,o){if(r.push(o),r.length>1)for(let a=r.length-2;a>=0;a--){const f=r[a];pv(f)||w1(f,o)&&null===T1(f)&&E1(f,o.index)}}function pv(r){return!(64&r.type)}function w1(r,o){return pv(o)||r.index>o.index}function T1(r){const o=r.insertBeforeIndex;return Array.isArray(o)?o[0]:o}function E1(r,o){const a=r.insertBeforeIndex;Array.isArray(a)?a[0]=o:(Xf(hv,dv),r.insertBeforeIndex=o)}function Gm(r,o){const a=r.data[o];return null===a||"string"==typeof a?null:a.hasOwnProperty("currentCaseLViewIndex")?a:a.value}function S1(r,o,a){const f=nm(r,a,64,null,null);return fv(o,f),f}function o_(r,o){const a=o[r.currentCaseLViewIndex];return null===a?a:a<0?~a:a}function mv(r){return r>>>17}function gv(r){return(131070&r)>>>1}let Hm=0,$m=0;function yv(r,o,a,f){const b=a[11];let j,O=null;for(let X=0;X<o.length;X++){const ue=o[X];if("string"==typeof ue){const Ce=o[++X];null===a[Ce]&&(a[Ce]=nh(b,ue))}else if("number"==typeof ue)switch(1&ue){case 0:const Ce=mv(ue);let ke,ot;if(null===O&&(O=Ce,j=pd(b,f)),Ce===O?(ke=f,ot=j):(ke=null,ot=mt(a[Ce])),null!==ot){const Si=gv(ue);_u(b,ot,a[Si],ke,!1);const br=Gm(r,Si);if(null!==br&&"object"==typeof br){const ri=o_(br,a);null!==ri&&yv(r,br.create[ri],a,a[br.anchorIdx])}}break;case 1:const ln=o[++X],$n=o[++X];lm(b,wn(ue>>>1,a),null,null,ln,$n,null)}else switch(ue){case r_:const Ce=o[++X],ke=o[++X];null===a[ke]&&Xs(a[ke]=eu(b,Ce),a);break;case i_:const ot=o[++X],Ft=o[++X];null===a[Ft]&&Xs(a[Ft]=hd(b,ot,null),a)}}}function vv(r,o,a,f,b){for(let O=0;O<a.length;O++){const j=a[O],X=a[++O];if(j&b){let ue="";for(let Ce=O+1;Ce<=O+X;Ce++){const ke=a[Ce];if("string"==typeof ke)ue+=ke;else if("number"==typeof ke)if(ke<0)ue+=on(o[f-ke]);else{const ot=ke>>>2;switch(3&ke){case 1:const Ft=a[++Ce],ln=a[++Ce],$n=r.data[ot];"string"==typeof $n?lm(o[11],o[ot],null,$n,Ft,ue,ln):sc(r,$n,o,Ft,ue,o[11],ln,!1);break;case 0:const Si=o[ot];null!==Si&&ih(o[11],Si,ue);break;case 2:O1(r,Gm(r,ot),o,ue);break;case 3:bv(r,Gm(r,ot),f,o)}}}}else{const ue=a[O+1];if(ue>0&&3==(3&ue)){const ke=Gm(r,ue>>>2);o[ke.currentCaseLViewIndex]<0&&bv(r,ke,f,o)}}O+=X}}function bv(r,o,a,f){let b=f[o.currentCaseLViewIndex];if(null!==b){let O=Hm;b<0&&(b=f[o.currentCaseLViewIndex]=~b,O=-1),vv(r,f,o.update[b],a,O)}}function O1(r,o,a,f){const b=function R1(r,o){let a=r.cases.indexOf(o);if(-1===a)switch(r.type){case 1:{const f=function y1(r,o){const a=lv(o)(parseInt(r,10)),f=_1[a];return void 0!==f?f:"other"}(o,function x1(){return uv}());a=r.cases.indexOf(f),-1===a&&"other"!==f&&(a=r.cases.indexOf("other"));break}case 0:a=r.cases.indexOf("other")}return-1===a?null:a}(o,f);if(o_(o,a)!==b&&(xv(r,o,a),a[o.currentCaseLViewIndex]=null===b?null:~b,null!==b)){const j=a[o.anchorIdx];j&&yv(r,o.create[b],a,j)}}function xv(r,o,a){let f=o_(o,a);if(null!==f){const b=o.remove[f];for(let O=0;O<b.length;O++){const j=b[O];if(j>0){const X=wn(j,a);null!==X&&nf(a[11],X)}else xv(r,Gm(r,~j),a)}}}function k1(){const r=[];let a,f,o=-1;function O(X,ue){o=0;const Ce=o_(X,ue);f=null!==Ce?X.remove[Ce]:ir}function j(){if(o<f.length){const X=f[o++];return X>0?a[X]:(r.push(o,f),O(a[1].data[~X],a),j())}return 0===r.length?null:(f=r.pop(),o=r.pop(),j())}return function b(X,ue){for(a=ue;r.length;)r.pop();return O(X.value,ue),j}}const s_=/\ufffd(\d+):?\d*\ufffd/gi,L1=/\ufffd(\d+)\ufffd/,Tv=/^\s*(\ufffd\d+:?\d*\ufffd)\s*,\s*(select|plural)\s*,/,F1=/\ufffd\/?\*(\d+:\d+)\ufffd/gi,B1=/\ufffd(\/?[#*]\d+):?\d*\ufffd/gi,z1=/\uE500/g;function Ev(r,o,a,f,b,O,j){const X=xd(r,f,1,null);let ue=X<<_l.SHIFT,Ce=La();o===Ce&&(Ce=null),null===Ce&&(ue|=_l.APPEND_EAGERLY),j&&(ue|=_l.COMMENT,function Ah(r){void 0===ic&&(ic=r())}(k1)),b.push(ue,null===O?"":O);const ke=nm(r,X,j?32:1,null===O?"":O,null);fv(a,ke);const ot=ke.index;return Qo(ke,!1),null!==Ce&&o!==Ce&&function D1(r,o){let a=r.insertBeforeIndex;null===a?(Xf(hv,dv),a=r.insertBeforeIndex=[null,o]):(function an(r,o,a){r!=o&&Ti(a,r,o,"==")}(Array.isArray(a),!0,"Expecting array here"),a.push(o))}(Ce,ot),ke}function j1(r,o,a,f,b,O,j){const X=j.match(s_),ue=Ev(r,o,a,O,f,X?null:j,!1);X&&kp(b,j,ue.index,null,0,null)}function kp(r,o,a,f,b,O){const j=r.length,X=j+1;r.push(null,null);const ue=j+2,Ce=o.split(s_);let ke=0;for(let ot=0;ot<Ce.length;ot++){const Ft=Ce[ot];if(1&ot){const ln=b+parseInt(Ft,10);r.push(-1-ln),ke|=Cv(ln)}else""!==Ft&&r.push(Ft)}return r.push(a<<2|(f?1:0)),f&&r.push(f,O),r[j]=ke,r[X]=r.length-ue,ke}function Cv(r){return 1<<Math.min(r,31)}function Dv(r){let o,O,a="",f=0,b=!1;for(;null!==(o=F1.exec(r));)b?o[0]===`\ufffd/*${O}\ufffd`&&(f=o.index,b=!1):(a+=r.substring(f,o.index+o[0].length),O=o[1],b=!0);return a+=r.substr(f),a}function Sv(r,o,a,f,b,O){let j=0;const X={type:b.type,currentCaseLViewIndex:xd(r,o,1,null),anchorIdx:O,cases:[],create:[],remove:[],update:[]};(function K1(r,o,a){r.push(Cv(o.mainBinding),2,-1-o.mainBinding,a<<2|2)})(a,b,O),function C1(r,o,a){const f=r.data[o];null===f?r.data[o]=a:f.value=a}(r,O,X);const ue=b.values;for(let Ce=0;Ce<ue.length;Ce++){const ke=ue[Ce],ot=[];for(let Ft=0;Ft<ke.length;Ft++){const ln=ke[Ft];if("string"!=typeof ln){const $n=ot.push(ln)-1;ke[Ft]=`\x3c!--\ufffd${$n}\ufffd--\x3e`}}j=W1(r,X,o,a,f,b.cases[Ce],ke.join(""),ot)|j}j&&function X1(r,o,a){r.push(o,1,a<<2|3)}(a,j,O)}function q1(r){const o=[],a=[];let f=1,b=0;const O=W_(r=r.replace(Tv,function(j,X,ue){return f="select"===ue?0:1,b=parseInt(X.substr(1),10),""}));for(let j=0;j<O.length;){let X=O[j++].trim();1===f&&(X=X.replace(/\s*(?:=)?(\w+)\s*/,"$1")),X.length&&o.push(X);const ue=W_(O[j++]);o.length>a.length&&a.push(ue)}return{type:f,mainBinding:b,cases:o,values:a}}function W_(r){if(!r)return[];let o=0;const a=[],f=[],b=/[{}]/g;let O;for(b.lastIndex=0;O=b.exec(r);){const X=O.index;if("}"==O[0]){if(a.pop(),0==a.length){const ue=r.substring(o,X);Tv.test(ue)?f.push(q1(ue)):f.push(ue),o=X+1}}else{if(0==a.length){const ue=r.substring(o,X);f.push(ue),o=X+1}a.push("{")}}const j=r.substring(o);return f.push(j),f}function W1(r,o,a,f,b,O,j,X){const ue=[],Ce=[],ke=[];o.cases.push(O),o.create.push(ue),o.remove.push(Ce),o.update.push(ke);const Ft=Bl(le()).getInertBodyElement(j),ln=Xc(Ft)||Ft;return ln?Av(r,o,a,f,ue,Ce,ke,ln,b,X,0):0}function Av(r,o,a,f,b,O,j,X,ue,Ce,ke){let ot=0,Ft=X.firstChild;for(;Ft;){const ln=xd(r,a,1,null);switch(Ft.nodeType){case Node.ELEMENT_NODE:const $n=Ft,Si=$n.tagName.toLowerCase();if(Ou.hasOwnProperty(Si)){Y_(b,i_,Si,ue,ln),r.data[ln]=Si;const Jr=$n.attributes;for(let ls=0;ls<Jr.length;ls++){const la=Jr.item(ls),au=la.name.toLowerCase();la.value.match(s_)?xh.hasOwnProperty(au)&&kp(j,la.value,ln,la.name,0,al[au]?rr:xc[au]?Rr:null):J1(b,ln,la)}ot=Av(r,o,a,f,b,O,j,Ft,ln,Ce,ke+1)|ot,Mv(O,ln,ke)}break;case Node.TEXT_NODE:const Yi=Ft.textContent||"",br=Yi.match(s_);Y_(b,null,br?"":Yi,ue,ln),Mv(O,ln,ke),br&&(ot=kp(j,Yi,ln,null,0,null)|ot);break;case Node.COMMENT_NODE:const ri=L1.exec(Ft.textContent||"");if(ri){const ls=Ce[parseInt(ri[1],10)];Y_(b,r_,"",ue,ln),Sv(r,a,f,ue,ls,ln),Y1(O,ln,ke)}}Ft=Ft.nextSibling}return ot}function Mv(r,o,a){0===a&&r.push(o)}function Y1(r,o,a){0===a&&(r.push(~o),r.push(o))}function Y_(r,o,a,f,b){null!==o&&r.push(o),r.push(a,b,function A1(r,o,a){return r|o<<17|a<<1}(0,f,b))}function J1(r,o,a){r.push(o<<1|1,a.name,a.value)}function Pv(r,o,a=-1){const f=ki(),b=Hn(),O=20+r,j=Re(f.consts,o),X=La();f.firstCreatePass&&function V1(r,o,a,f,b,O){const j=La(),X=[],ue=[],Ce=[[]];b=function $1(r,o){if(function H1(r){return-1===r}(o))return Dv(r);{const a=r.indexOf(`:${o}\ufffd`)+2+o.toString().length,f=r.search(new RegExp(`\ufffd\\/\\*\\d+:${o}\ufffd`));return Dv(r.substring(a,f))}}(b,O);const ke=function U1(r){return r.replace(z1," ")}(b).split(B1);for(let ot=0;ot<ke.length;ot++){let Ft=ke[ot];if(0==(1&ot)){const ln=W_(Ft);for(let $n=0;$n<ln.length;$n++){let Si=ln[$n];if(0==(1&$n)){const Yi=Si;""!==Yi&&j1(r,j,Ce[0],X,ue,a,Yi)}else{const Yi=Si;if("object"!=typeof Yi)throw new Error(`Unable to parse ICU expression in "${b}" message.`);Sv(r,a,ue,o,Yi,Ev(r,j,Ce[0],a,X,"",!0).index)}}}else{const ln=47===Ft.charCodeAt(0),Si=(Ft.charCodeAt(ln?1:0),20+Number.parseInt(Ft.substring(ln?2:1)));if(ln)Ce.shift(),Qo(La(),!1);else{const Yi=S1(r,Ce[0],Si);Ce.unshift([]),Qo(Yi,!0)}}}r.data[f]={create:X,update:ue}}(f,null===X?0:X.index,b,O,j,a);const ue=f.data[O],ke=Hp(f,X===b[6]?null:X,b);(function P1(r,o,a,f){const b=r[11];for(let O=0;O<o.length;O++){const j=o[O++],X=o[O],ue=(j&_l.COMMENT)===_l.COMMENT,Ce=(j&_l.APPEND_EAGERLY)===_l.APPEND_EAGERLY,ke=j>>>_l.SHIFT;let ot=r[ke];null===ot&&(ot=r[ke]=ue?b.createComment(X):nh(b,X)),Ce&&null!==a&&_u(b,a,ot,f,!1)}})(b,ue.create,ke,X&&8&X.type?b[X.index]:null),Is(!0)}function Rv(r,o,a){Pv(r,o,a),function Ov(){Is(!1)}()}function K_(r){return function M1(r){r&&(Hm|=1<<Math.min($m,31)),$m++}(ml(Hn(),xa(),r)),K_}function kv(r){!function I1(r,o,a){if($m>0){const f=r.data[a];vv(r,o,Array.isArray(f)?f:f.update,function ba(){return vi.lFrame.bindingIndex}()-$m-1,Hm)}Hm=0,$m=0}(ki(),Hn(),r+20)}function X_(r,o,a,f,b){if(r=ft(r),Array.isArray(r))for(let O=0;O<r.length;O++)X_(r[O],o,a,f,b);else{const O=ki(),j=Hn();let X=Id(r)?r:ft(r.provide),ue=pf(r);const Ce=os(),ke=1048575&Ce.providerIndexes,ot=Ce.directiveStart,Ft=Ce.providerIndexes>>20;if(Id(r)||!r.multi){const ln=new ai(ue,b,mc),$n=Q_(X,o,b?ke:ke+Ft,ot);-1===$n?(zt(Q(Ce,j),O,X),J_(O,r,o.length),o.push(X),Ce.directiveStart++,Ce.directiveEnd++,b&&(Ce.providerIndexes+=1048576),a.push(ln),j.push(ln)):(a[$n]=ln,j[$n]=ln)}else{const ln=Q_(X,o,ke+Ft,ot),$n=Q_(X,o,ke,ke+Ft),Si=ln>=0&&a[ln],Yi=$n>=0&&a[$n];if(b&&!Yi||!b&&!Si){zt(Q(Ce,j),O,X);const br=function db(r,o,a,f,b){const O=new ai(r,a,mc);return O.multi=[],O.index=o,O.componentProviders=0,Nv(O,b,f&&!a),O}(b?hb:ub,a.length,b,f,ue);!b&&Yi&&(a[$n].providerFactory=br),J_(O,r,o.length,0),o.push(X),Ce.directiveStart++,Ce.directiveEnd++,b&&(Ce.providerIndexes+=1048576),a.push(br),j.push(br)}else J_(O,r,ln>-1?ln:$n,Nv(a[b?$n:ln],ue,!b&&f));!b&&f&&Yi&&a[$n].componentProviders++}}}function J_(r,o,a,f){const b=Id(o),O=function R_(r){return!!r.useClass}(o);if(b||O){const ue=(O?ft(o.useClass):o).prototype.ngOnDestroy;if(ue){const Ce=r.destroyHooks||(r.destroyHooks=[]);if(!b&&o.multi){const ke=Ce.indexOf(a);-1===ke?Ce.push(a,[f,ue]):Ce[ke+1].push(f,ue)}else Ce.push(a,ue)}}}function Nv(r,o,a){return a&&r.componentProviders++,r.multi.push(o)-1}function Q_(r,o,a,f){for(let b=a;b<f;b++)if(o[b]===r)return b;return-1}function ub(r,o,a,f){return ey(this.multi,[])}function hb(r,o,a,f){const b=this.multi;let O;if(this.providerFactory){const j=this.providerFactory.componentProviders,X=dl(a,a[1],this.providerFactory.index,f);O=X.slice(0,j),ey(b,O);for(let ue=j;ue<X.length;ue++)O.push(X[ue])}else O=[],ey(b,O);return O}function ey(r,o){for(let a=0;a<r.length;a++)o.push((0,r[a])());return o}function Lv(r,o=[]){return a=>{a.providersResolver=(f,b)=>function cb(r,o,a){const f=ki();if(f.firstCreatePass){const b=Ir(r);X_(a,f.data,f.blueprint,b,!0),X_(o,f.data,f.blueprint,b,!1)}}(f,b?b(r):r,o)}}class Fv{}class mb{resolveComponentFactory(o){throw function pb(r){const o=Error(`No component factory found for ${wt(r)}. Did you add it to @NgModule.entryComponents?`);return o.ngComponent=r,o}(o)}}let a_=(()=>{class r{}return r.NULL=new mb,r})();function gb(){return Np(os(),Hn())}function Np(r,o){return new Wm(er(r,o))}let Wm=(()=>{class r{constructor(a){this.nativeElement=a}}return r.__NG_ELEMENT_ID__=gb,r})();function _b(r){return r instanceof Wm?r.nativeElement:r}class zv{}let yb=(()=>{class r{}return r.__NG_ELEMENT_ID__=()=>function bb(){const r=Hn(),a=bi(os().index,r);return function vb(r){return r[11]}(po(a)?a:r)}(),r})(),xb=(()=>{class r{}return r.\u0275prov=Tt({token:r,providedIn:"root",factory:()=>null}),r})();class Uv{constructor(o){this.full=o,this.major=o.split(".")[0],this.minor=o.split(".")[1],this.patch=o.split(".").slice(2).join(".")}}const wb=new Uv("13.2.7"),ty={};function l_(r,o,a,f,b=!1){for(;null!==a;){const O=o[a.index];if(null!==O&&f.push(mt(O)),xr(O))for(let X=10;X<O.length;X++){const ue=O[X],Ce=ue[1].firstChild;null!==Ce&&l_(ue[1],ue,Ce,f)}const j=a.type;if(8&j)l_(r,o,a.child,f);else if(32&j){const X=ld(a,o);let ue;for(;ue=X();)f.push(ue)}else if(16&j){const X=qp(o,a);if(Array.isArray(X))f.push(...X);else{const ue=jc(o[16]);l_(ue[1],ue,X,f,!0)}}a=b?a.projectionNext:a.next}return f}class Ym{constructor(o,a){this._lView=o,this._cdRefInjectingView=a,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const o=this._lView,a=o[1];return l_(a,o,a.firstChild,[])}get context(){return this._lView[8]}set context(o){this._lView[8]=o}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const o=this._lView[3];if(xr(o)){const a=o[8],f=a?a.indexOf(this):-1;f>-1&&(dd(o,f),Ll(a,f))}this._attachedToViewContainer=!1}$a(this._lView[1],this._lView)}onDestroy(o){lg(this._lView[1],this._lView,null,o)}markForCheck(){hf(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){Fh(this._lView[1],this._lView,this.context)}checkNoChanges(){!function um(r,o,a){Ws(!0);try{Fh(r,o,a)}finally{Ws(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new dn(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Yf(r,o){w(r,o,o[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(o){if(this._attachedToViewContainer)throw new dn(902,"");this._appRef=o}}class Tb extends Ym{constructor(o){super(o),this._view=o}detectChanges(){Bh(this._view)}checkNoChanges(){!function fp(r){Ws(!0);try{Bh(r)}finally{Ws(!1)}}(this._view)}get context(){return null}}class Vv extends a_{constructor(o){super(),this.ngModule=o}resolveComponentFactory(o){const a=Be(o);return new ny(a,this.ngModule)}}function jv(r){const o=[];for(let a in r)r.hasOwnProperty(a)&&o.push({propName:r[a],templateName:a});return o}class ny extends Fv{constructor(o,a){super(),this.componentDef=o,this.ngModule=a,this.componentType=o.type,this.selector=function oa(r){return r.map(Yo).join(",")}(o.selectors),this.ngContentSelectors=o.ngContentSelectors?o.ngContentSelectors:[],this.isBoundToModule=!!a}get inputs(){return jv(this.componentDef.inputs)}get outputs(){return jv(this.componentDef.outputs)}create(o,a,f,b){const O=(b=b||this.ngModule)?function Cb(r,o){return{get:(a,f,b)=>{const O=r.get(a,ty,b);return O!==ty||f===ty?O:o.get(a,f,b)}}}(o,b.injector):o,j=O.get(zv,je),X=O.get(xb,null),ue=j.createRenderer(null,this.componentDef),Ce=this.componentDef.selectors[0][0]||"div",ke=f?function ag(r,o,a){if(be(r))return r.selectRootElement(o,a===Li.ShadowDom);let f="string"==typeof o?r.querySelector(o):o;return f.textContent="",f}(ue,f,this.componentDef.encapsulation):hd(j.createRenderer(null,this.componentDef),Ce,function Eb(r){const o=r.toLowerCase();return"svg"===o?"svg":"math"===o?"math":null}(Ce)),ot=this.componentDef.onPush?576:528,Ft=function bm(r,o){return{components:[],scheduler:r||$f,clean:yg,playerHandler:o||null,flags:0}}(),ln=cf(0,null,null,1,0,null,null,null,null,null),$n=sh(null,ln,Ft,ot,null,null,j,ue,X,O);let Si,Yi;es($n);try{const br=function iu(r,o,a,f,b,O){const j=a[1];a[20]=r;const ue=Lh(j,20,2,"#host",null),Ce=ue.mergedAttrs=o.hostAttrs;null!==Ce&&(gp(ue,Ce,!0),null!==r&&(ut(b,r,Ce),null!==ue.classes&&ht(b,r,ue.classes),null!==ue.styles&&ve(b,r,ue.styles)));const ke=f.createRenderer(r,o),ot=sh(a,rm(o),null,o.onPush?64:16,a[20],ue,f,ke,O||null,null);return j.firstCreatePass&&(zt(Q(ue,a),j,o.type),Tu(j,ue),fg(ue,a.length,1)),Sd(a,ot),a[20]=ot}(ke,this.componentDef,$n,j,ue);if(ke)if(f)ut(ue,ke,["ng-version",wb.full]);else{const{attrs:ri,classes:Jr}=function as(r){const o=[],a=[];let f=1,b=2;for(;f<r.length;){let O=r[f];if("string"==typeof O)2===b?""!==O&&o.push(O,r[++f]):8===b&&a.push(O);else{if(!uo(b))break;b=O}f++}return{attrs:o,classes:a}}(this.componentDef.selectors[0]);ri&&ut(ue,ke,ri),Jr&&Jr.length>0&&ht(ue,ke,Jr.join(" "))}if(Yi=Lr(ln,20),void 0!==a){const ri=Yi.projection=[];for(let Jr=0;Jr<this.ngContentSelectors.length;Jr++){const ls=a[Jr];ri.push(null!=ls?Array.from(ls):null)}}Si=function vm(r,o,a,f,b){const O=a[1],j=function T_(r,o,a){const f=os();r.firstCreatePass&&(a.providersResolver&&a.providersResolver(a),pg(r,f,o,xd(r,o,1,null),a));const b=dl(o,r,f.directiveStart,f);Xs(b,o);const O=er(f,o);return O&&Xs(O,o),b}(O,a,o);if(f.components.push(j),r[8]=j,b&&b.forEach(ue=>ue(j,o)),o.contentQueries){const ue=os();o.contentQueries(1,j,ue.directiveStart)}const X=os();return!O.firstCreatePass||null===o.hostBindings&&null===o.hostAttrs||(ts(X.index),om(a[1],X,0,X.directiveStart,X.directiveEnd,o),am(o,j)),j}(br,this.componentDef,$n,Ft,[L_]),af(ln,$n,null)}finally{Pa()}return new Sb(this.componentType,Si,Np(Yi,$n),$n,Yi)}}class Sb extends class fb{}{constructor(o,a,f,b,O){super(),this.location=f,this._rootLView=b,this._tNode=O,this.instance=a,this.hostView=this.changeDetectorRef=new Tb(b),this.componentType=o}get injector(){return new Cl(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(o){this.hostView.onDestroy(o)}}class Lp{}class Zv{}const Fp=new Map;class $v extends Lp{constructor(o,a){super(),this._parent=a,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new Vv(this);const f=rn(o);this._bootstrapComponents=Uc(f.bootstrap),this._r3Injector=gm(o,a,[{provide:Lp,useValue:this},{provide:a_,useValue:this.componentFactoryResolver}],wt(o)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(o)}get(o,a=Dc.THROW_IF_NOT_FOUND,f=dr.Default){return o===Dc||o===Lp||o===_p?this:this._r3Injector.get(o,a,f)}destroy(){const o=this._r3Injector;!o.destroyed&&o.destroy(),this.destroyCbs.forEach(a=>a()),this.destroyCbs=null}onDestroy(o){this.destroyCbs.push(o)}}class iy extends Zv{constructor(o){super(),this.moduleType=o,null!==rn(o)&&function Mb(r){const o=new Set;!function a(f){const b=rn(f,!0),O=b.id;null!==O&&(function Gv(r,o,a){if(o&&o!==a)throw new Error(`Duplicate module registered for ${r} - ${wt(o)} vs ${wt(o.name)}`)}(O,Fp.get(O),f),Fp.set(O,f));const j=Uc(b.imports);for(const X of j)o.has(X)||(o.add(X),a(X))}(r)}(o)}create(o){return new $v(this.moduleType,o)}}function qv(r,o,a){const f=ss()+r,b=Hn();return b[f]===Ar?ql(b,f,a?o.call(a):o()):function xf(r,o){return r[o]}(b,f)}function Wv(r,o,a,f){return Xv(Hn(),ss(),r,o,a,f)}function Yv(r,o,a,f,b){return Jv(Hn(),ss(),r,o,a,f,b)}function Kv(r,o,a,f,b,O){return function Qv(r,o,a,f,b,O,j,X){const ue=o+a;return function uh(r,o,a,f,b){const O=ru(r,o,a,f);return ml(r,o+2,b)||O}(r,ue,b,O,j)?ql(r,ue+3,X?f.call(X,b,O,j):f(b,O,j)):Km(r,ue+3)}(Hn(),ss(),r,o,a,f,b,O)}function Km(r,o){const a=r[o];return a===Ar?void 0:a}function Xv(r,o,a,f,b,O){const j=o+a;return ml(r,j,b)?ql(r,j+1,O?f.call(O,b):f(b)):Km(r,j+1)}function Jv(r,o,a,f,b,O,j){const X=o+a;return ru(r,X,b,O)?ql(r,X+2,j?f.call(j,b,O):f(b,O)):Km(r,X+2)}function n0(r,o){const a=ki();let f;const b=r+20;a.firstCreatePass?(f=function Lb(r,o){if(o)for(let a=o.length-1;a>=0;a--){const f=o[a];if(r===f.name)return f}}(o,a.pipeRegistry),a.data[b]=f,f.onDestroy&&(a.destroyHooks||(a.destroyHooks=[])).push(b,f.onDestroy)):f=a.data[b];const O=f.factory||(f.factory=Ms(f.type)),j=Ot(mc);try{const X=c(!1),ue=O();return c(X),function Dm(r,o,a,f){a>=r.data.length&&(r.data[a]=null,r.blueprint[a]=null),o[a]=f}(a,Hn(),b,ue),ue}finally{Ot(j)}}function r0(r,o,a){const f=r+20,b=Hn(),O=Zi(b,f);return Xm(b,f)?Xv(b,ss(),o,O.transform,a,O):O.transform(a)}function o0(r,o,a,f){const b=r+20,O=Hn(),j=Zi(O,b);return Xm(O,b)?Jv(O,ss(),o,j.transform,a,f,j):j.transform(a,f)}function Xm(r,o){return r[1].data[o].pure}function ry(r){return o=>{setTimeout(r,void 0,o)}}const mh=class Ub extends D.x{constructor(o=!1){super(),this.__isAsync=o}emit(o){super.next(o)}subscribe(o,a,f){var b,O,j;let X=o,ue=a||(()=>null),Ce=f;if(o&&"object"==typeof o){const ot=o;X=null===(b=ot.next)||void 0===b?void 0:b.bind(ot),ue=null===(O=ot.error)||void 0===O?void 0:O.bind(ot),Ce=null===(j=ot.complete)||void 0===j?void 0:j.bind(ot)}this.__isAsync&&(ue=ry(ue),X&&(X=ry(X)),Ce&&(Ce=ry(Ce)));const ke=super.subscribe({next:X,error:ue,complete:Ce});return o instanceof N.w0&&o.add(ke),ke}};function Vb(){return this._results[Vh()]()}class oy{constructor(o=!1){this._emitDistinctChangesOnly=o,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const a=Vh(),f=oy.prototype;f[a]||(f[a]=Vb)}get changes(){return this._changes||(this._changes=new mh)}get(o){return this._results[o]}map(o){return this._results.map(o)}filter(o){return this._results.filter(o)}find(o){return this._results.find(o)}reduce(o,a){return this._results.reduce(o,a)}forEach(o){this._results.forEach(o)}some(o){return this._results.some(o)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(o,a){const f=this;f.dirty=!1;const b=Dl(o);(this._changesDetected=!function Xu(r,o,a){if(r.length!==o.length)return!1;for(let f=0;f<r.length;f++){let b=r[f],O=o[f];if(a&&(b=a(b),O=a(O)),O!==b)return!1}return!0}(f._results,b,a))&&(f._results=b,f.length=b.length,f.last=b[this.length-1],f.first=b[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let Jm=(()=>{class r{}return r.__NG_ELEMENT_ID__=Gb,r})();const jb=Jm,Zb=class extends jb{constructor(o,a,f){super(),this._declarationLView=o,this._declarationTContainer=a,this.elementRef=f}createEmbeddedView(o){const a=this._declarationTContainer.tViews,f=sh(this._declarationLView,a,o,16,null,a.declTNode,null,null,null,null);f[17]=this._declarationLView[this._declarationTContainer.index];const O=this._declarationLView[19];return null!==O&&(f[19]=O.createEmbeddedView(a)),af(a,f,o),new Ym(f)}};function Gb(){return c_(os(),Hn())}function c_(r,o){return 4&r.type?new Zb(o,r,Np(r,o)):null}let u_=(()=>{class r{}return r.__NG_ELEMENT_ID__=Hb,r})();function Hb(){return l0(os(),Hn())}const $b=u_,s0=class extends $b{constructor(o,a,f){super(),this._lContainer=o,this._hostTNode=a,this._hostLView=f}get element(){return Np(this._hostTNode,this._hostLView)}get injector(){return new Cl(this._hostTNode,this._hostLView)}get parentInjector(){const o=Ze(this._hostTNode,this._hostLView);if(Hr(o)){const a=rl(o,this._hostLView),f=Os(o);return new Cl(a[1].data[f+8],a)}return new Cl(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(o){const a=a0(this._lContainer);return null!==a&&a[o]||null}get length(){return this._lContainer.length-10}createEmbeddedView(o,a,f){const b=o.createEmbeddedView(a||{});return this.insert(b,f),b}createComponent(o,a,f,b,O){const j=o&&!function ec(r){return"function"==typeof r}(o);let X;if(j)X=a;else{const ot=a||{};X=ot.index,f=ot.injector,b=ot.projectableNodes,O=ot.ngModuleRef}const ue=j?o:new ny(Be(o)),Ce=f||this.parentInjector;if(!O&&null==ue.ngModule){const Ft=(j?Ce:this.parentInjector).get(Lp,null);Ft&&(O=Ft)}const ke=ue.create(Ce,b,void 0,O);return this.insert(ke.hostView,X),ke}insert(o,a){const f=o._lView,b=f[1];if(function ae(r){return xr(r[3])}(f)){const ke=this.indexOf(o);if(-1!==ke)this.detach(ke);else{const ot=f[3],Ft=new s0(ot,ot[6],ot[3]);Ft.detach(Ft.indexOf(o))}}const O=this._adjustIndex(a),j=this._lContainer;!function Mh(r,o,a,f){const b=10+f,O=a.length;f>0&&(a[b-1][4]=o),f<O-10?(o[4]=a[b],Gl(a,10+f,o)):(a.push(o),o[4]=null),o[3]=a;const j=o[17];null!==j&&a!==j&&function $l(r,o){const a=r[9];o[16]!==o[3][3][16]&&(r[2]=!0),null===a?r[9]=[o]:a.push(o)}(j,o);const X=o[19];null!==X&&X.insertView(r),o[2]|=128}(b,f,j,O);const X=gd(O,j),ue=f[11],Ce=pd(ue,j[7]);return null!==Ce&&function Wf(r,o,a,f,b,O){f[0]=b,f[6]=o,w(r,f,a,1,b,O)}(b,j[6],ue,f,Ce,X),o.attachToViewContainerRef(),Gl(sy(j),O,o),o}move(o,a){return this.insert(o,a)}indexOf(o){const a=a0(this._lContainer);return null!==a?a.indexOf(o):-1}remove(o){const a=this._adjustIndex(o,-1),f=dd(this._lContainer,a);f&&(Ll(sy(this._lContainer),a),$a(f[1],f))}detach(o){const a=this._adjustIndex(o,-1),f=dd(this._lContainer,a);return f&&null!=Ll(sy(this._lContainer),a)?new Ym(f):null}_adjustIndex(o,a=0){return null==o?this.length+a:o}};function a0(r){return r[8]}function sy(r){return r[8]||(r[8]=[])}function l0(r,o){let a;const f=o[r.index];if(xr(f))a=f;else{let b;if(8&r.type)b=mt(f);else{const O=o[11];b=O.createComment("");const j=er(r,o);_u(O,pd(O,j),b,function Xd(r,o){return be(r)?r.nextSibling(o):o.nextSibling}(O,j),!1)}o[r.index]=a=mg(f,o,b,r),Sd(o,a)}return new s0(a,r,o)}class ay{constructor(o){this.queryList=o,this.matches=null}clone(){return new ay(this.queryList)}setDirty(){this.queryList.setDirty()}}class ly{constructor(o=[]){this.queries=o}createEmbeddedView(o){const a=o.queries;if(null!==a){const f=null!==o.contentQueries?o.contentQueries[0]:a.length,b=[];for(let O=0;O<f;O++){const j=a.getByIndex(O);b.push(this.queries[j.indexInDeclarationView].clone())}return new ly(b)}return null}insertView(o){this.dirtyQueriesWithMatches(o)}detachView(o){this.dirtyQueriesWithMatches(o)}dirtyQueriesWithMatches(o){for(let a=0;a<this.queries.length;a++)null!==_0(o,a).matches&&this.queries[a].setDirty()}}class c0{constructor(o,a,f=null){this.predicate=o,this.flags=a,this.read=f}}class cy{constructor(o=[]){this.queries=o}elementStart(o,a){for(let f=0;f<this.queries.length;f++)this.queries[f].elementStart(o,a)}elementEnd(o){for(let a=0;a<this.queries.length;a++)this.queries[a].elementEnd(o)}embeddedTView(o){let a=null;for(let f=0;f<this.length;f++){const b=null!==a?a.length:0,O=this.getByIndex(f).embeddedTView(o,b);O&&(O.indexInDeclarationView=f,null!==a?a.push(O):a=[O])}return null!==a?new cy(a):null}template(o,a){for(let f=0;f<this.queries.length;f++)this.queries[f].template(o,a)}getByIndex(o){return this.queries[o]}get length(){return this.queries.length}track(o){this.queries.push(o)}}class uy{constructor(o,a=-1){this.metadata=o,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=a}elementStart(o,a){this.isApplyingToNode(a)&&this.matchTNode(o,a)}elementEnd(o){this._declarationNodeIndex===o.index&&(this._appliesToNextNode=!1)}template(o,a){this.elementStart(o,a)}embeddedTView(o,a){return this.isApplyingToNode(o)?(this.crossesNgTemplate=!0,this.addMatch(-o.index,a),new uy(this.metadata)):null}isApplyingToNode(o){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const a=this._declarationNodeIndex;let f=o.parent;for(;null!==f&&8&f.type&&f.index!==a;)f=f.parent;return a===(null!==f?f.index:-1)}return this._appliesToNextNode}matchTNode(o,a){const f=this.metadata.predicate;if(Array.isArray(f))for(let b=0;b<f.length;b++){const O=f[b];this.matchTNodeWithReadOption(o,a,Yb(a,O)),this.matchTNodeWithReadOption(o,a,kl(a,o,O,!1,!1))}else f===Jm?4&a.type&&this.matchTNodeWithReadOption(o,a,-1):this.matchTNodeWithReadOption(o,a,kl(a,o,f,!1,!1))}matchTNodeWithReadOption(o,a,f){if(null!==f){const b=this.metadata.read;if(null!==b)if(b===Wm||b===u_||b===Jm&&4&a.type)this.addMatch(a.index,-2);else{const O=kl(a,o,b,!1,!1);null!==O&&this.addMatch(a.index,O)}else this.addMatch(a.index,f)}}addMatch(o,a){null===this.matches?this.matches=[o,a]:this.matches.push(o,a)}}function Yb(r,o){const a=r.localNames;if(null!==a)for(let f=0;f<a.length;f+=2)if(a[f]===o)return a[f+1];return null}function Xb(r,o,a,f){return-1===a?function Kb(r,o){return 11&r.type?Np(r,o):4&r.type?c_(r,o):null}(o,r):-2===a?function Jb(r,o,a){return a===Wm?Np(o,r):a===Jm?c_(o,r):a===u_?l0(o,r):void 0}(r,o,f):dl(r,r[1],a,o)}function u0(r,o,a,f){const b=o[19].queries[f];if(null===b.matches){const O=r.data,j=a.matches,X=[];for(let ue=0;ue<j.length;ue+=2){const Ce=j[ue];X.push(Ce<0?null:Xb(o,O[Ce],j[ue+1],a.metadata.read))}b.matches=X}return b.matches}function hy(r,o,a,f){const b=r.queries.getByIndex(a),O=b.matches;if(null!==O){const j=u0(r,o,b,a);for(let X=0;X<O.length;X+=2){const ue=O[X];if(ue>0)f.push(j[X/2]);else{const Ce=O[X+1],ke=o[-ue];for(let ot=10;ot<ke.length;ot++){const Ft=ke[ot];Ft[17]===Ft[3]&&hy(Ft[1],Ft,Ce,f)}if(null!==ke[9]){const ot=ke[9];for(let Ft=0;Ft<ot.length;Ft++){const ln=ot[Ft];hy(ln[1],ln,Ce,f)}}}}}return f}function h0(r){const o=Hn(),a=ki(),f=bl();io(f+1);const b=_0(a,f);if(r.dirty&&ge(o)===(2==(2&b.metadata.flags))){if(null===b.matches)r.reset([]);else{const O=b.crossesNgTemplate?hy(a,o,f,[]):u0(a,o,b,f);r.reset(O,_b),r.notifyOnChanges()}return!0}return!1}function d0(r,o,a){const f=ki();f.firstCreatePass&&(g0(f,new c0(r,o,a),-1),2==(2&o)&&(f.staticViewQueries=!0)),m0(f,Hn(),o)}function f0(r,o,a,f){const b=ki();if(b.firstCreatePass){const O=os();g0(b,new c0(o,a,f),O.index),function ex(r,o){const a=r.contentQueries||(r.contentQueries=[]);o!==(a.length?a[a.length-1]:-1)&&a.push(r.queries.length-1,o)}(b,r),2==(2&a)&&(b.staticContentQueries=!0)}m0(b,Hn(),a)}function p0(){return function Qb(r,o){return r[19].queries[o].queryList}(Hn(),bl())}function m0(r,o,a){const f=new oy(4==(4&a));lg(r,o,f,f.destroy),null===o[19]&&(o[19]=new ly),o[19].queries.push(new ay(f))}function g0(r,o,a){null===r.queries&&(r.queries=new cy),r.queries.track(new uy(o,a))}function _0(r,o){return r.queries.getByIndex(o)}function y0(r,o){return c_(r,o)}function f_(...r){}const N0=new Rs("Application Initializer");let _y=(()=>{class r{constructor(a){this.appInits=a,this.resolve=f_,this.reject=f_,this.initialized=!1,this.done=!1,this.donePromise=new Promise((f,b)=>{this.resolve=f,this.reject=b})}runInitializers(){if(this.initialized)return;const a=[],f=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let b=0;b<this.appInits.length;b++){const O=this.appInits[b]();if(Rf(O))a.push(O);else if(Lm(O)){const j=new Promise((X,ue)=>{O.subscribe({complete:X,error:ue})});a.push(j)}}Promise.all(a).then(()=>{f()}).catch(b=>{this.reject(b)}),0===a.length&&f(),this.initialized=!0}}return r.\u0275fac=function(a){return new(a||r)(ze(N0,8))},r.\u0275prov=Tt({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();const L0=new Rs("AppId",{providedIn:"root",factory:function F0(){return`${yy()}${yy()}${yy()}`}});function yy(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const B0=new Rs("Platform Initializer"),z0=new Rs("Platform ID"),U0=new Rs("appBootstrapListener");let V0=(()=>{class r{log(a){console.log(a)}warn(a){console.warn(a)}}return r.\u0275fac=function(a){return new(a||r)},r.\u0275prov=Tt({token:r,factory:r.\u0275fac}),r})();const vy=new Rs("LocaleId",{providedIn:"root",factory:()=>et(vy,dr.Optional|dr.SkipSelf)||function _x(){return"undefined"!=typeof $localize&&$localize.locale||n_}()}),yx=new Rs("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});class vx{constructor(o,a){this.ngModuleFactory=o,this.componentFactories=a}}let bx=(()=>{class r{compileModuleSync(a){return new iy(a)}compileModuleAsync(a){return Promise.resolve(this.compileModuleSync(a))}compileModuleAndAllComponentsSync(a){const f=this.compileModuleSync(a),O=Uc(rn(a).declarations).reduce((j,X)=>{const ue=Be(X);return ue&&j.push(new ny(ue)),j},[]);return new vx(f,O)}compileModuleAndAllComponentsAsync(a){return Promise.resolve(this.compileModuleAndAllComponentsSync(a))}clearCache(){}clearCacheFor(a){}getModuleId(a){}}return r.\u0275fac=function(a){return new(a||r)},r.\u0275prov=Tt({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();const wx=(()=>Promise.resolve(0))();function by(r){"undefined"==typeof Zone?wx.then(()=>{r&&r.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",r)}class qu{constructor({enableLongStackTrace:o=!1,shouldCoalesceEventChangeDetection:a=!1,shouldCoalesceRunChangeDetection:f=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new mh(!1),this.onMicrotaskEmpty=new mh(!1),this.onStable=new mh(!1),this.onError=new mh(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const b=this;b._nesting=0,b._outer=b._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(b._inner=b._inner.fork(new Zone.TaskTrackingZoneSpec)),o&&Zone.longStackTraceZoneSpec&&(b._inner=b._inner.fork(Zone.longStackTraceZoneSpec)),b.shouldCoalesceEventChangeDetection=!f&&a,b.shouldCoalesceRunChangeDetection=f,b.lastRequestAnimationFrameId=-1,b.nativeRequestAnimationFrame=function Tx(){let r=ei.requestAnimationFrame,o=ei.cancelAnimationFrame;if("undefined"!=typeof Zone&&r&&o){const a=r[Zone.__symbol__("OriginalDelegate")];a&&(r=a);const f=o[Zone.__symbol__("OriginalDelegate")];f&&(o=f)}return{nativeRequestAnimationFrame:r,nativeCancelAnimationFrame:o}}().nativeRequestAnimationFrame,function Dx(r){const o=()=>{!function Cx(r){r.isCheckStableRunning||-1!==r.lastRequestAnimationFrameId||(r.lastRequestAnimationFrameId=r.nativeRequestAnimationFrame.call(ei,()=>{r.fakeTopEventTask||(r.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{r.lastRequestAnimationFrameId=-1,wy(r),r.isCheckStableRunning=!0,xy(r),r.isCheckStableRunning=!1},void 0,()=>{},()=>{})),r.fakeTopEventTask.invoke()}),wy(r))}(r)};r._inner=r._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(a,f,b,O,j,X)=>{try{return j0(r),a.invokeTask(b,O,j,X)}finally{(r.shouldCoalesceEventChangeDetection&&"eventTask"===O.type||r.shouldCoalesceRunChangeDetection)&&o(),Z0(r)}},onInvoke:(a,f,b,O,j,X,ue)=>{try{return j0(r),a.invoke(b,O,j,X,ue)}finally{r.shouldCoalesceRunChangeDetection&&o(),Z0(r)}},onHasTask:(a,f,b,O)=>{a.hasTask(b,O),f===b&&("microTask"==O.change?(r._hasPendingMicrotasks=O.microTask,wy(r),xy(r)):"macroTask"==O.change&&(r.hasPendingMacrotasks=O.macroTask))},onHandleError:(a,f,b,O)=>(a.handleError(b,O),r.runOutsideAngular(()=>r.onError.emit(O)),!1)})}(b)}static isInAngularZone(){return"undefined"!=typeof Zone&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!qu.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(qu.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(o,a,f){return this._inner.run(o,a,f)}runTask(o,a,f,b){const O=this._inner,j=O.scheduleEventTask("NgZoneEvent: "+b,o,Ex,f_,f_);try{return O.runTask(j,a,f)}finally{O.cancelTask(j)}}runGuarded(o,a,f){return this._inner.runGuarded(o,a,f)}runOutsideAngular(o){return this._outer.run(o)}}const Ex={};function xy(r){if(0==r._nesting&&!r.hasPendingMicrotasks&&!r.isStable)try{r._nesting++,r.onMicrotaskEmpty.emit(null)}finally{if(r._nesting--,!r.hasPendingMicrotasks)try{r.runOutsideAngular(()=>r.onStable.emit(null))}finally{r.isStable=!0}}}function wy(r){r.hasPendingMicrotasks=!!(r._hasPendingMicrotasks||(r.shouldCoalesceEventChangeDetection||r.shouldCoalesceRunChangeDetection)&&-1!==r.lastRequestAnimationFrameId)}function j0(r){r._nesting++,r.isStable&&(r.isStable=!1,r.onUnstable.emit(null))}function Z0(r){r._nesting--,xy(r)}class Sx{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new mh,this.onMicrotaskEmpty=new mh,this.onStable=new mh,this.onError=new mh}run(o,a,f){return o.apply(a,f)}runGuarded(o,a,f){return o.apply(a,f)}runOutsideAngular(o){return o()}runTask(o,a,f,b){return o.apply(a,f)}}let G0=(()=>{class r{constructor(a){this._ngZone=a,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),a.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{qu.assertNotInAngularZone(),by(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())by(()=>{for(;0!==this._callbacks.length;){let a=this._callbacks.pop();clearTimeout(a.timeoutId),a.doneCb(this._didWork)}this._didWork=!1});else{let a=this.getPendingTasks();this._callbacks=this._callbacks.filter(f=>!f.updateCb||!f.updateCb(a)||(clearTimeout(f.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(a=>({source:a.source,creationLocation:a.creationLocation,data:a.data})):[]}addCallback(a,f,b){let O=-1;f&&f>0&&(O=setTimeout(()=>{this._callbacks=this._callbacks.filter(j=>j.timeoutId!==O),a(this._didWork,this.getPendingTasks())},f)),this._callbacks.push({doneCb:a,timeoutId:O,updateCb:b})}whenStable(a,f,b){if(b&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(a,f,b),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(a,f,b){return[]}}return r.\u0275fac=function(a){return new(a||r)(ze(qu))},r.\u0275prov=Tt({token:r,factory:r.\u0275fac}),r})(),H0=(()=>{class r{constructor(){this._applications=new Map,Ty.addToWindow(this)}registerApplication(a,f){this._applications.set(a,f)}unregisterApplication(a){this._applications.delete(a)}unregisterAllApplications(){this._applications.clear()}getTestability(a){return this._applications.get(a)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(a,f=!0){return Ty.findTestabilityInTree(this,a,f)}}return r.\u0275fac=function(a){return new(a||r)},r.\u0275prov=Tt({token:r,factory:r.\u0275fac}),r})();class Ax{addToWindow(o){}findTestabilityInTree(o,a,f){return null}}function Mx(r){Ty=r}let Wu,Ty=new Ax;const $0=new Rs("AllowMultipleToken");class Ox{constructor(o,a){this.name=o,this.token=a}}function q0(r,o,a=[]){const f=`Platform: ${o}`,b=new Rs(f);return(O=[])=>{let j=W0();if(!j||j.injector.get($0,!1))if(r)r(a.concat(O).concat({provide:b,useValue:!0}));else{const X=a.concat(O).concat({provide:b,useValue:!0},{provide:yp,useValue:"platform"});!function Rx(r){if(Wu&&!Wu.destroyed&&!Wu.injector.get($0,!1))throw new dn(400,"");Wu=r.get(Y0);const o=r.get(B0,null);o&&o.forEach(a=>a())}(Dc.create({providers:X,name:f}))}return function kx(r){const o=W0();if(!o)throw new dn(401,"");return o}()}}function W0(){return Wu&&!Wu.destroyed?Wu:null}let Y0=(()=>{class r{constructor(a){this._injector=a,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(a,f){const X=function Nx(r,o){let a;return a="noop"===r?new Sx:("zone.js"===r?void 0:r)||new qu({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==o?void 0:o.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==o?void 0:o.ngZoneRunCoalescing)}),a}(f?f.ngZone:void 0,{ngZoneEventCoalescing:f&&f.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:f&&f.ngZoneRunCoalescing||!1}),ue=[{provide:qu,useValue:X}];return X.run(()=>{const Ce=Dc.create({providers:ue,parent:this.injector,name:a.moduleType.name}),ke=a.create(Ce),ot=ke.injector.get(Nu,null);if(!ot)throw new dn(402,"");return X.runOutsideAngular(()=>{const Ft=X.onError.subscribe({next:ln=>{ot.handleError(ln)}});ke.onDestroy(()=>{Cy(this._modules,ke),Ft.unsubscribe()})}),function Lx(r,o,a){try{const f=a();return Rf(f)?f.catch(b=>{throw o.runOutsideAngular(()=>r.handleError(b)),b}):f}catch(f){throw o.runOutsideAngular(()=>r.handleError(f)),f}}(ot,X,()=>{const Ft=ke.injector.get(_y);return Ft.runInitializers(),Ft.donePromise.then(()=>(function b1(r){(function ui(r,o){null==r&&Ti(o,r,null,"!=")})(r,"Expected localeId to be defined"),"string"==typeof r&&(uv=r.toLowerCase().replace(/_/g,"-"))}(ke.injector.get(vy,n_)||n_),this._moduleDoBootstrap(ke),ke))})})}bootstrapModule(a,f=[]){const b=K0({},f);return function Ix(r,o,a){const f=new iy(a);return Promise.resolve(f)}(0,0,a).then(O=>this.bootstrapModuleFactory(O,b))}_moduleDoBootstrap(a){const f=a.injector.get(Ey);if(a._bootstrapComponents.length>0)a._bootstrapComponents.forEach(b=>f.bootstrap(b));else{if(!a.instance.ngDoBootstrap)throw new dn(403,"");a.instance.ngDoBootstrap(f)}this._modules.push(a)}onDestroy(a){this._destroyListeners.push(a)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new dn(404,"");this._modules.slice().forEach(a=>a.destroy()),this._destroyListeners.forEach(a=>a()),this._destroyed=!0}get destroyed(){return this._destroyed}}return r.\u0275fac=function(a){return new(a||r)(ze(Dc))},r.\u0275prov=Tt({token:r,factory:r.\u0275fac}),r})();function K0(r,o){return Array.isArray(o)?o.reduce(K0,r):Object.assign(Object.assign({},r),o)}let Ey=(()=>{class r{constructor(a,f,b,O,j){this._zone=a,this._injector=f,this._exceptionHandler=b,this._componentFactoryResolver=O,this._initStatus=j,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const X=new A.y(Ce=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{Ce.next(this._stable),Ce.complete()})}),ue=new A.y(Ce=>{let ke;this._zone.runOutsideAngular(()=>{ke=this._zone.onStable.subscribe(()=>{qu.assertNotInAngularZone(),by(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,Ce.next(!0))})})});const ot=this._zone.onUnstable.subscribe(()=>{qu.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{Ce.next(!1)}))});return()=>{ke.unsubscribe(),ot.unsubscribe()}});this.isStable=(0,l.T)(X,ue.pipe(function Ke(r={}){const{connector:o=(()=>new D.x),resetOnError:a=!0,resetOnComplete:f=!0,resetOnRefCountZero:b=!0}=r;return O=>{let j,X,ue,Ce=0,ke=!1,ot=!1;const Ft=()=>{null==X||X.unsubscribe(),X=void 0},ln=()=>{Ft(),j=ue=void 0,ke=ot=!1},$n=()=>{const Si=j;ln(),null==Si||Si.unsubscribe()};return(0,At.e)((Si,Yi)=>{Ce++,!ot&&!ke&&Ft();const br=ue=null!=ue?ue:o();Yi.add(()=>{Ce--,0===Ce&&!ot&&!ke&&(X=ct($n,b))}),br.subscribe(Yi),!j&&Ce>0&&(j=new lt.Hp({next:ri=>br.next(ri),error:ri=>{ot=!0,Ft(),X=ct(ln,a,ri),br.error(ri)},complete:()=>{ke=!0,Ft(),X=ct(ln,f),br.complete()}}),(0,oe.Xf)(Si).subscribe(j))})(O)}}()))}bootstrap(a,f){if(!this._initStatus.done)throw new dn(405,"");let b;b=a instanceof Fv?a:this._componentFactoryResolver.resolveComponentFactory(a),this.componentTypes.push(b.componentType);const O=function Px(r){return r.isBoundToModule}(b)?void 0:this._injector.get(Lp),X=b.create(Dc.NULL,[],f||b.selector,O),ue=X.location.nativeElement,Ce=X.injector.get(G0,null),ke=Ce&&X.injector.get(H0);return Ce&&ke&&ke.registerApplication(ue,Ce),X.onDestroy(()=>{this.detachView(X.hostView),Cy(this.components,X),ke&&ke.unregisterApplication(ue)}),this._loadComponent(X),X}tick(){if(this._runningTick)throw new dn(101,"");try{this._runningTick=!0;for(let a of this._views)a.detectChanges()}catch(a){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(a))}finally{this._runningTick=!1}}attachView(a){const f=a;this._views.push(f),f.attachToAppRef(this)}detachView(a){const f=a;Cy(this._views,f),f.detachFromAppRef()}_loadComponent(a){this.attachView(a.hostView),this.tick(),this.components.push(a),this._injector.get(U0,[]).concat(this._bootstrapListeners).forEach(b=>b(a))}ngOnDestroy(){this._views.slice().forEach(a=>a.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return r.\u0275fac=function(a){return new(a||r)(ze(qu),ze(Dc),ze(Nu),ze(a_),ze(_y))},r.\u0275prov=Tt({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();function Cy(r,o){const a=r.indexOf(o);a>-1&&r.splice(a,1)}let J0=!0;function Bx(){J0=!1}let zx=(()=>{class r{}return r.__NG_ELEMENT_ID__=Ux,r})();function Ux(r){return function Vx(r,o,a){if(rs(r)&&!a){const f=bi(r.index,o);return new Ym(f,f)}return 47&r.type?new Ym(o[16],o):null}(os(),Hn(),16==(16&r))}class i1{constructor(){}supports(o){return bf(o)}create(o){return new qx(o)}}const $x=(r,o)=>o;class qx{constructor(o){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=o||$x}forEachItem(o){let a;for(a=this._itHead;null!==a;a=a._next)o(a)}forEachOperation(o){let a=this._itHead,f=this._removalsHead,b=0,O=null;for(;a||f;){const j=!f||a&&a.currentIndex<o1(f,b,O)?a:f,X=o1(j,b,O),ue=j.currentIndex;if(j===f)b--,f=f._nextRemoved;else if(a=a._next,null==j.previousIndex)b++;else{O||(O=[]);const Ce=X-b,ke=ue-b;if(Ce!=ke){for(let Ft=0;Ft<Ce;Ft++){const ln=Ft<O.length?O[Ft]:O[Ft]=0,$n=ln+Ft;ke<=$n&&$n<Ce&&(O[Ft]=ln+1)}O[j.previousIndex]=ke-Ce}}X!==ue&&o(j,X,ue)}}forEachPreviousItem(o){let a;for(a=this._previousItHead;null!==a;a=a._nextPrevious)o(a)}forEachAddedItem(o){let a;for(a=this._additionsHead;null!==a;a=a._nextAdded)o(a)}forEachMovedItem(o){let a;for(a=this._movesHead;null!==a;a=a._nextMoved)o(a)}forEachRemovedItem(o){let a;for(a=this._removalsHead;null!==a;a=a._nextRemoved)o(a)}forEachIdentityChange(o){let a;for(a=this._identityChangesHead;null!==a;a=a._nextIdentityChange)o(a)}diff(o){if(null==o&&(o=[]),!bf(o))throw new dn(900,"");return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let b,O,j,a=this._itHead,f=!1;if(Array.isArray(o)){this.length=o.length;for(let X=0;X<this.length;X++)O=o[X],j=this._trackByFn(X,O),null!==a&&Object.is(a.trackById,j)?(f&&(a=this._verifyReinsertion(a,O,j,X)),Object.is(a.item,O)||this._addIdentityChange(a,O)):(a=this._mismatch(a,O,j,X),f=!0),a=a._next}else b=0,function jh(r,o){if(Array.isArray(r))for(let a=0;a<r.length;a++)o(r[a]);else{const a=r[Vh()]();let f;for(;!(f=a.next()).done;)o(f.value)}}(o,X=>{j=this._trackByFn(b,X),null!==a&&Object.is(a.trackById,j)?(f&&(a=this._verifyReinsertion(a,X,j,b)),Object.is(a.item,X)||this._addIdentityChange(a,X)):(a=this._mismatch(a,X,j,b),f=!0),a=a._next,b++}),this.length=b;return this._truncate(a),this.collection=o,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let o;for(o=this._previousItHead=this._itHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._additionsHead;null!==o;o=o._nextAdded)o.previousIndex=o.currentIndex;for(this._additionsHead=this._additionsTail=null,o=this._movesHead;null!==o;o=o._nextMoved)o.previousIndex=o.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(o,a,f,b){let O;return null===o?O=this._itTail:(O=o._prev,this._remove(o)),null!==(o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(f,null))?(Object.is(o.item,a)||this._addIdentityChange(o,a),this._reinsertAfter(o,O,b)):null!==(o=null===this._linkedRecords?null:this._linkedRecords.get(f,b))?(Object.is(o.item,a)||this._addIdentityChange(o,a),this._moveAfter(o,O,b)):o=this._addAfter(new Wx(a,f),O,b),o}_verifyReinsertion(o,a,f,b){let O=null===this._unlinkedRecords?null:this._unlinkedRecords.get(f,null);return null!==O?o=this._reinsertAfter(O,o._prev,b):o.currentIndex!=b&&(o.currentIndex=b,this._addToMoves(o,b)),o}_truncate(o){for(;null!==o;){const a=o._next;this._addToRemovals(this._unlink(o)),o=a}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(o,a,f){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(o);const b=o._prevRemoved,O=o._nextRemoved;return null===b?this._removalsHead=O:b._nextRemoved=O,null===O?this._removalsTail=b:O._prevRemoved=b,this._insertAfter(o,a,f),this._addToMoves(o,f),o}_moveAfter(o,a,f){return this._unlink(o),this._insertAfter(o,a,f),this._addToMoves(o,f),o}_addAfter(o,a,f){return this._insertAfter(o,a,f),this._additionsTail=null===this._additionsTail?this._additionsHead=o:this._additionsTail._nextAdded=o,o}_insertAfter(o,a,f){const b=null===a?this._itHead:a._next;return o._next=b,o._prev=a,null===b?this._itTail=o:b._prev=o,null===a?this._itHead=o:a._next=o,null===this._linkedRecords&&(this._linkedRecords=new r1),this._linkedRecords.put(o),o.currentIndex=f,o}_remove(o){return this._addToRemovals(this._unlink(o))}_unlink(o){null!==this._linkedRecords&&this._linkedRecords.remove(o);const a=o._prev,f=o._next;return null===a?this._itHead=f:a._next=f,null===f?this._itTail=a:f._prev=a,o}_addToMoves(o,a){return o.previousIndex===a||(this._movesTail=null===this._movesTail?this._movesHead=o:this._movesTail._nextMoved=o),o}_addToRemovals(o){return null===this._unlinkedRecords&&(this._unlinkedRecords=new r1),this._unlinkedRecords.put(o),o.currentIndex=null,o._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=o,o._prevRemoved=null):(o._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=o),o}_addIdentityChange(o,a){return o.item=a,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=o:this._identityChangesTail._nextIdentityChange=o,o}}class Wx{constructor(o,a){this.item=o,this.trackById=a,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class Yx{constructor(){this._head=null,this._tail=null}add(o){null===this._head?(this._head=this._tail=o,o._nextDup=null,o._prevDup=null):(this._tail._nextDup=o,o._prevDup=this._tail,o._nextDup=null,this._tail=o)}get(o,a){let f;for(f=this._head;null!==f;f=f._nextDup)if((null===a||a<=f.currentIndex)&&Object.is(f.trackById,o))return f;return null}remove(o){const a=o._prevDup,f=o._nextDup;return null===a?this._head=f:a._nextDup=f,null===f?this._tail=a:f._prevDup=a,null===this._head}}class r1{constructor(){this.map=new Map}put(o){const a=o.trackById;let f=this.map.get(a);f||(f=new Yx,this.map.set(a,f)),f.add(o)}get(o,a){const b=this.map.get(o);return b?b.get(o,a):null}remove(o){const a=o.trackById;return this.map.get(a).remove(o)&&this.map.delete(a),o}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function o1(r,o,a){const f=r.previousIndex;if(null===f)return f;let b=0;return a&&f<a.length&&(b=a[f]),f+o+b}class s1{constructor(){}supports(o){return o instanceof Map||Tm(o)}create(){return new Kx}}class Kx{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(o){let a;for(a=this._mapHead;null!==a;a=a._next)o(a)}forEachPreviousItem(o){let a;for(a=this._previousMapHead;null!==a;a=a._nextPrevious)o(a)}forEachChangedItem(o){let a;for(a=this._changesHead;null!==a;a=a._nextChanged)o(a)}forEachAddedItem(o){let a;for(a=this._additionsHead;null!==a;a=a._nextAdded)o(a)}forEachRemovedItem(o){let a;for(a=this._removalsHead;null!==a;a=a._nextRemoved)o(a)}diff(o){if(o){if(!(o instanceof Map||Tm(o)))throw new dn(900,"")}else o=new Map;return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let a=this._mapHead;if(this._appendAfter=null,this._forEach(o,(f,b)=>{if(a&&a.key===b)this._maybeAddToChanges(a,f),this._appendAfter=a,a=a._next;else{const O=this._getOrCreateRecordForKey(b,f);a=this._insertBeforeOrAppend(a,O)}}),a){a._prev&&(a._prev._next=null),this._removalsHead=a;for(let f=a;null!==f;f=f._nextRemoved)f===this._mapHead&&(this._mapHead=null),this._records.delete(f.key),f._nextRemoved=f._next,f.previousValue=f.currentValue,f.currentValue=null,f._prev=null,f._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(o,a){if(o){const f=o._prev;return a._next=o,a._prev=f,o._prev=a,f&&(f._next=a),o===this._mapHead&&(this._mapHead=a),this._appendAfter=o,o}return this._appendAfter?(this._appendAfter._next=a,a._prev=this._appendAfter):this._mapHead=a,this._appendAfter=a,null}_getOrCreateRecordForKey(o,a){if(this._records.has(o)){const b=this._records.get(o);this._maybeAddToChanges(b,a);const O=b._prev,j=b._next;return O&&(O._next=j),j&&(j._prev=O),b._next=null,b._prev=null,b}const f=new Xx(o);return this._records.set(o,f),f.currentValue=a,this._addToAdditions(f),f}_reset(){if(this.isDirty){let o;for(this._previousMapHead=this._mapHead,o=this._previousMapHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._changesHead;null!==o;o=o._nextChanged)o.previousValue=o.currentValue;for(o=this._additionsHead;null!=o;o=o._nextAdded)o.previousValue=o.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(o,a){Object.is(a,o.currentValue)||(o.previousValue=o.currentValue,o.currentValue=a,this._addToChanges(o))}_addToAdditions(o){null===this._additionsHead?this._additionsHead=this._additionsTail=o:(this._additionsTail._nextAdded=o,this._additionsTail=o)}_addToChanges(o){null===this._changesHead?this._changesHead=this._changesTail=o:(this._changesTail._nextChanged=o,this._changesTail=o)}_forEach(o,a){o instanceof Map?o.forEach(a):Object.keys(o).forEach(f=>a(o[f],f))}}class Xx{constructor(o){this.key=o,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function a1(){return new Iy([new i1])}let Iy=(()=>{class r{constructor(a){this.factories=a}static create(a,f){if(null!=f){const b=f.factories.slice();a=a.concat(b)}return new r(a)}static extend(a){return{provide:r,useFactory:f=>r.create(a,f||a1()),deps:[[r,new Xt,new sn]]}}find(a){const f=this.factories.find(b=>b.supports(a));if(null!=f)return f;throw new dn(901,"")}}return r.\u0275prov=Tt({token:r,providedIn:"root",factory:a1}),r})();function l1(){return new Py([new s1])}let Py=(()=>{class r{constructor(a){this.factories=a}static create(a,f){if(f){const b=f.factories.slice();a=a.concat(b)}return new r(a)}static extend(a){return{provide:r,useFactory:f=>r.create(a,f||l1()),deps:[[r,new Xt,new sn]]}}find(a){const f=this.factories.find(O=>O.supports(a));if(f)return f;throw new dn(901,"")}}return r.\u0275prov=Tt({token:r,providedIn:"root",factory:l1}),r})();const ew=q0(null,"core",[{provide:z0,useValue:"unknown"},{provide:Y0,deps:[Dc]},{provide:H0,deps:[]},{provide:V0,deps:[]}]);let tw=(()=>{class r{constructor(a){}}return r.\u0275fac=function(a){return new(a||r)(ze(Ey))},r.\u0275mod=nt({type:r}),r.\u0275inj=si({}),r})()},3075:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{Wl:()=>_t,Fj:()=>st,qu:()=>Zi,u:()=>Us,sg:()=>ha,u5:()=>er,nD:()=>be,wO:()=>le,JU:()=>Ke,JJ:()=>Mn,JL:()=>yo,On:()=>ca,YN:()=>eo,UX:()=>ji,EJ:()=>Mo,kI:()=>Qn,_Y:()=>po,Kr:()=>ds});var D=fe(4893),N=fe(9808),A=fe(2076),l=fe(4128),oe=fe(4004);let lt=(()=>{class ge{constructor(ae,Re){this._renderer=ae,this._elementRef=Re,this.onChange=gn=>{},this.onTouched=()=>{}}setProperty(ae,Re){this._renderer.setProperty(this._elementRef.nativeElement,ae,Re)}registerOnTouched(ae){this.onTouched=ae}registerOnChange(ae){this.onChange=ae}setDisabledState(ae){this.setProperty("disabled",ae)}}return ge.\u0275fac=function(ae){return new(ae||ge)(D.Y36(D.Qsj),D.Y36(D.SBq))},ge.\u0275dir=D.lG2({type:ge}),ge})(),At=(()=>{class ge extends lt{}return ge.\u0275fac=function(){let he;return function(Re){return(he||(he=D.n5z(ge)))(Re||ge)}}(),ge.\u0275dir=D.lG2({type:ge,features:[D.qOj]}),ge})();const Ke=new D.OlP("NgValueAccessor"),ct={provide:Ke,useExisting:(0,D.Gpc)(()=>_t),multi:!0};let _t=(()=>{class ge extends At{writeValue(ae){this.setProperty("checked",ae)}}return ge.\u0275fac=function(){let he;return function(Re){return(he||(he=D.n5z(ge)))(Re||ge)}}(),ge.\u0275dir=D.lG2({type:ge,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(ae,Re){1&ae&&D.NdJ("change",function(xi){return Re.onChange(xi.target.checked)})("blur",function(){return Re.onTouched()})},features:[D._Bn([ct]),D.qOj]}),ge})();const Nt={provide:Ke,useExisting:(0,D.Gpc)(()=>st),multi:!0},Bt=new D.OlP("CompositionEventMode");let st=(()=>{class ge extends lt{constructor(ae,Re,gn){super(ae,Re),this._compositionMode=gn,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function wt(){const ge=(0,N.q)()?(0,N.q)().getUserAgent():"";return/android (\d+)/.test(ge.toLowerCase())}())}writeValue(ae){this.setProperty("value",null==ae?"":ae)}_handleInput(ae){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(ae)}_compositionStart(){this._composing=!0}_compositionEnd(ae){this._composing=!1,this._compositionMode&&this.onChange(ae)}}return ge.\u0275fac=function(ae){return new(ae||ge)(D.Y36(D.Qsj),D.Y36(D.SBq),D.Y36(Bt,8))},ge.\u0275dir=D.lG2({type:ge,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(ae,Re){1&ae&&D.NdJ("input",function(xi){return Re._handleInput(xi.target.value)})("blur",function(){return Re.onTouched()})("compositionstart",function(){return Re._compositionStart()})("compositionend",function(xi){return Re._compositionEnd(xi.target.value)})},features:[D._Bn([Nt]),D.qOj]}),ge})();function at(ge){return null==ge||0===ge.length}function ft(ge){return null!=ge&&"number"==typeof ge.length}const tn=new D.OlP("NgValidators"),kt=new D.OlP("NgAsyncValidators"),dn=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class Qn{static min(he){return function on(ge){return he=>{if(at(he.value)||at(ge))return null;const ae=parseFloat(he.value);return!isNaN(ae)&&ae<ge?{min:{min:ge,actual:he.value}}:null}}(he)}static max(he){return function Cn(ge){return he=>{if(at(he.value)||at(ge))return null;const ae=parseFloat(he.value);return!isNaN(ae)&&ae>ge?{max:{max:ge,actual:he.value}}:null}}(he)}static required(he){return function se(ge){return at(ge.value)?{required:!0}:null}(he)}static requiredTrue(he){return function Wi(ge){return!0===ge.value?null:{required:!0}}(he)}static email(he){return function ii(ge){return at(ge.value)||dn.test(ge.value)?null:{email:!0}}(he)}static minLength(he){return kn(he)}static maxLength(he){return Ci(he)}static pattern(he){return function Jt(ge){if(!ge)return $t;let he,ae;return"string"==typeof ge?(ae="","^"!==ge.charAt(0)&&(ae+="^"),ae+=ge,"$"!==ge.charAt(ge.length-1)&&(ae+="$"),he=new RegExp(ae)):(ae=ge.toString(),he=ge),Re=>{if(at(Re.value))return null;const gn=Re.value;return he.test(gn)?null:{pattern:{requiredPattern:ae,actualValue:gn}}}}(he)}static nullValidator(he){return null}static compose(he){return mr(he)}static composeAsync(he){return _i(he)}}function kn(ge){return he=>at(he.value)||!ft(he.value)?null:he.value.length<ge?{minlength:{requiredLength:ge,actualLength:he.value.length}}:null}function Ci(ge){return he=>ft(he.value)&&he.value.length>ge?{maxlength:{requiredLength:ge,actualLength:he.value.length}}:null}function $t(ge){return null}function en(ge){return null!=ge}function an(ge){const he=(0,D.QGY)(ge)?(0,A.D)(ge):ge;return(0,D.CqO)(he),he}function Yt(ge){let he={};return ge.forEach(ae=>{he=null!=ae?Object.assign(Object.assign({},he),ae):he}),0===Object.keys(he).length?null:he}function An(ge,he){return he.map(ae=>ae(ge))}function Mi(ge){return ge.map(he=>function Sn(ge){return!ge.validate}(he)?he:ae=>he.validate(ae))}function mr(ge){if(!ge)return null;const he=ge.filter(en);return 0==he.length?null:function(ae){return Yt(An(ae,he))}}function wi(ge){return null!=ge?mr(Mi(ge)):null}function _i(ge){if(!ge)return null;const he=ge.filter(en);return 0==he.length?null:function(ae){const Re=An(ae,he).map(an);return(0,l.D)(Re).pipe((0,oe.U)(Yt))}}function Ki(ge){return null!=ge?_i(Mi(ge)):null}function ui(ge,he){return null===ge?[he]:Array.isArray(ge)?[...ge,he]:[ge,he]}function Ti(ge){return ge._rawValidators}function Br(ge){return ge._rawAsyncValidators}function yn(ge){return ge?Array.isArray(ge)?ge:[ge]:[]}function oi(ge,he){return Array.isArray(ge)?ge.includes(he):ge===he}function Tt(ge,he){const ae=yn(he);return yn(ge).forEach(gn=>{oi(ae,gn)||ae.push(gn)}),ae}function En(ge,he){return yn(he).filter(ae=>!oi(ge,ae))}class si{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(he){this._rawValidators=he||[],this._composedValidatorFn=wi(this._rawValidators)}_setAsyncValidators(he){this._rawAsyncValidators=he||[],this._composedAsyncValidatorFn=Ki(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(he){this._onDestroyCallbacks.push(he)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(he=>he()),this._onDestroyCallbacks=[]}reset(he){this.control&&this.control.reset(he)}hasError(he,ae){return!!this.control&&this.control.hasError(he,ae)}getError(he,ae){return this.control?this.control.getError(he,ae):null}}class fi extends si{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class nr extends si{get formDirective(){return null}get path(){return null}}class Tr{constructor(he){this._cd=he}is(he){var ae,Re,gn;return"submitted"===he?!!(null===(ae=this._cd)||void 0===ae?void 0:ae.submitted):!!(null===(gn=null===(Re=this._cd)||void 0===Re?void 0:Re.control)||void 0===gn?void 0:gn[he])}}let Mn=(()=>{class ge extends Tr{constructor(ae){super(ae)}}return ge.\u0275fac=function(ae){return new(ae||ge)(D.Y36(fi,2))},ge.\u0275dir=D.lG2({type:ge,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(ae,Re){2&ae&&D.ekj("ng-untouched",Re.is("untouched"))("ng-touched",Re.is("touched"))("ng-pristine",Re.is("pristine"))("ng-dirty",Re.is("dirty"))("ng-valid",Re.is("valid"))("ng-invalid",Re.is("invalid"))("ng-pending",Re.is("pending"))},features:[D.qOj]}),ge})(),yo=(()=>{class ge extends Tr{constructor(ae){super(ae)}}return ge.\u0275fac=function(ae){return new(ae||ge)(D.Y36(nr,10))},ge.\u0275dir=D.lG2({type:ge,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(ae,Re){2&ae&&D.ekj("ng-untouched",Re.is("untouched"))("ng-touched",Re.is("touched"))("ng-pristine",Re.is("pristine"))("ng-dirty",Re.is("dirty"))("ng-valid",Re.is("valid"))("ng-invalid",Re.is("invalid"))("ng-pending",Re.is("pending"))("ng-submitted",Re.is("submitted"))},features:[D.qOj]}),ge})();function vo(ge,he){return[...he.path,ge]}function ei(ge,he){ir(ge,he),he.valueAccessor.writeValue(ge.value),function Zo(ge,he){he.valueAccessor.registerOnChange(ae=>{ge._pendingValue=ae,ge._pendingChange=!0,ge._pendingDirty=!0,"change"===ge.updateOn&&Ds(ge,he)})}(ge,he),function qe(ge,he){const ae=(Re,gn)=>{he.valueAccessor.writeValue(Re),gn&&he.viewToModelUpdate(Re)};ge.registerOnChange(ae),he._registerOnDestroy(()=>{ge._unregisterOnChange(ae)})}(ge,he),function To(ge,he){he.valueAccessor.registerOnTouched(()=>{ge._pendingTouched=!0,"blur"===ge.updateOn&&ge._pendingChange&&Ds(ge,he),"submit"!==ge.updateOn&&ge.markAsTouched()})}(ge,he),function Io(ge,he){if(he.valueAccessor.setDisabledState){const ae=Re=>{he.valueAccessor.setDisabledState(Re)};ge.registerOnDisabledChange(ae),he._registerOnDestroy(()=>{ge._unregisterOnDisabledChange(ae)})}}(ge,he)}function fr(ge,he,ae=!0){const Re=()=>{};he.valueAccessor&&(he.valueAccessor.registerOnChange(Re),he.valueAccessor.registerOnTouched(Re)),Ao(ge,he),ge&&(he._invokeOnDestroyCallbacks(),ge._registerOnCollectionChange(()=>{}))}function sr(ge,he){ge.forEach(ae=>{ae.registerOnValidatorChange&&ae.registerOnValidatorChange(he)})}function ir(ge,he){const ae=Ti(ge);null!==he.validator?ge.setValidators(ui(ae,he.validator)):"function"==typeof ae&&ge.setValidators([ae]);const Re=Br(ge);null!==he.asyncValidator?ge.setAsyncValidators(ui(Re,he.asyncValidator)):"function"==typeof Re&&ge.setAsyncValidators([Re]);const gn=()=>ge.updateValueAndValidity();sr(he._rawValidators,gn),sr(he._rawAsyncValidators,gn)}function Ao(ge,he){let ae=!1;if(null!==ge){if(null!==he.validator){const gn=Ti(ge);if(Array.isArray(gn)&&gn.length>0){const xi=gn.filter(vi=>vi!==he.validator);xi.length!==gn.length&&(ae=!0,ge.setValidators(xi))}}if(null!==he.asyncValidator){const gn=Br(ge);if(Array.isArray(gn)&&gn.length>0){const xi=gn.filter(vi=>vi!==he.asyncValidator);xi.length!==gn.length&&(ae=!0,ge.setAsyncValidators(xi))}}}const Re=()=>{};return sr(he._rawValidators,Re),sr(he._rawAsyncValidators,Re),ae}function Ds(ge,he){ge._pendingDirty&&ge.markAsDirty(),ge.setValue(ge._pendingValue,{emitModelToViewChange:!1}),he.viewToModelUpdate(ge._pendingValue),ge._pendingChange=!1}function Rt(ge,he){if(!ge.hasOwnProperty("model"))return!1;const ae=ge.model;return!!ae.isFirstChange()||!Object.is(he,ae.currentValue)}function Dn(ge,he){if(!he)return null;let ae,Re,gn;return Array.isArray(he),he.forEach(xi=>{xi.constructor===st?ae=xi:function nt(ge){return Object.getPrototypeOf(ge.constructor)===At}(xi)?Re=xi:gn=xi}),gn||Re||ae||null}function xe(ge,he){const ae=ge.indexOf(he);ae>-1&&ge.splice(ae,1)}const dt="VALID",Pt="INVALID",rn="PENDING",un="DISABLED";function Pn(ge){return(Gr(ge)?ge.validators:ge)||null}function mi(ge){return Array.isArray(ge)?wi(ge):ge||null}function Xn(ge,he){return(Gr(he)?he.asyncValidators:ge)||null}function qt(ge){return Array.isArray(ge)?Ki(ge):ge||null}function Gr(ge){return null!=ge&&!Array.isArray(ge)&&"object"==typeof ge}const gr=ge=>ge instanceof Wn,Rn=ge=>ge instanceof Fi,ti=ge=>ge instanceof Xi;function hr(ge){return gr(ge)?ge.value:ge.getRawValue()}function Er(ge,he){const ae=Rn(ge),Re=ge.controls;if(!(ae?Object.keys(Re):Re).length)throw new D.vHH(1e3,"");if(!Re[he])throw new D.vHH(1001,"")}function Mr(ge,he){Rn(ge),ge._forEachChild((Re,gn)=>{if(void 0===he[gn])throw new D.vHH(1002,"")})}class Nr{constructor(he,ae){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=he,this._rawAsyncValidators=ae,this._composedValidatorFn=mi(this._rawValidators),this._composedAsyncValidatorFn=qt(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(he){this._rawValidators=this._composedValidatorFn=he}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(he){this._rawAsyncValidators=this._composedAsyncValidatorFn=he}get parent(){return this._parent}get valid(){return this.status===dt}get invalid(){return this.status===Pt}get pending(){return this.status==rn}get disabled(){return this.status===un}get enabled(){return this.status!==un}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(he){this._rawValidators=he,this._composedValidatorFn=mi(he)}setAsyncValidators(he){this._rawAsyncValidators=he,this._composedAsyncValidatorFn=qt(he)}addValidators(he){this.setValidators(Tt(he,this._rawValidators))}addAsyncValidators(he){this.setAsyncValidators(Tt(he,this._rawAsyncValidators))}removeValidators(he){this.setValidators(En(he,this._rawValidators))}removeAsyncValidators(he){this.setAsyncValidators(En(he,this._rawAsyncValidators))}hasValidator(he){return oi(this._rawValidators,he)}hasAsyncValidator(he){return oi(this._rawAsyncValidators,he)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(he={}){this.touched=!0,this._parent&&!he.onlySelf&&this._parent.markAsTouched(he)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(he=>he.markAllAsTouched())}markAsUntouched(he={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(ae=>{ae.markAsUntouched({onlySelf:!0})}),this._parent&&!he.onlySelf&&this._parent._updateTouched(he)}markAsDirty(he={}){this.pristine=!1,this._parent&&!he.onlySelf&&this._parent.markAsDirty(he)}markAsPristine(he={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(ae=>{ae.markAsPristine({onlySelf:!0})}),this._parent&&!he.onlySelf&&this._parent._updatePristine(he)}markAsPending(he={}){this.status=rn,!1!==he.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!he.onlySelf&&this._parent.markAsPending(he)}disable(he={}){const ae=this._parentMarkedDirty(he.onlySelf);this.status=un,this.errors=null,this._forEachChild(Re=>{Re.disable(Object.assign(Object.assign({},he),{onlySelf:!0}))}),this._updateValue(),!1!==he.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},he),{skipPristineCheck:ae})),this._onDisabledChange.forEach(Re=>Re(!0))}enable(he={}){const ae=this._parentMarkedDirty(he.onlySelf);this.status=dt,this._forEachChild(Re=>{Re.enable(Object.assign(Object.assign({},he),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:he.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},he),{skipPristineCheck:ae})),this._onDisabledChange.forEach(Re=>Re(!1))}_updateAncestors(he){this._parent&&!he.onlySelf&&(this._parent.updateValueAndValidity(he),he.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(he){this._parent=he}updateValueAndValidity(he={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===dt||this.status===rn)&&this._runAsyncValidator(he.emitEvent)),!1!==he.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!he.onlySelf&&this._parent.updateValueAndValidity(he)}_updateTreeValidity(he={emitEvent:!0}){this._forEachChild(ae=>ae._updateTreeValidity(he)),this.updateValueAndValidity({onlySelf:!0,emitEvent:he.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?un:dt}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(he){if(this.asyncValidator){this.status=rn,this._hasOwnPendingAsyncValidator=!0;const ae=an(this.asyncValidator(this));this._asyncValidationSubscription=ae.subscribe(Re=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(Re,{emitEvent:he})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(he,ae={}){this.errors=he,this._updateControlsErrors(!1!==ae.emitEvent)}get(he){return function In(ge,he,ae){if(null==he||(Array.isArray(he)||(he=he.split(ae)),Array.isArray(he)&&0===he.length))return null;let Re=ge;return he.forEach(gn=>{Re=Rn(Re)?Re.controls.hasOwnProperty(gn)?Re.controls[gn]:null:ti(Re)&&Re.at(gn)||null}),Re}(this,he,".")}getError(he,ae){const Re=ae?this.get(ae):this;return Re&&Re.errors?Re.errors[he]:null}hasError(he,ae){return!!this.getError(he,ae)}get root(){let he=this;for(;he._parent;)he=he._parent;return he}_updateControlsErrors(he){this.status=this._calculateStatus(),he&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(he)}_initObservables(){this.valueChanges=new D.vpe,this.statusChanges=new D.vpe}_calculateStatus(){return this._allControlsDisabled()?un:this.errors?Pt:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(rn)?rn:this._anyControlsHaveStatus(Pt)?Pt:dt}_anyControlsHaveStatus(he){return this._anyControls(ae=>ae.status===he)}_anyControlsDirty(){return this._anyControls(he=>he.dirty)}_anyControlsTouched(){return this._anyControls(he=>he.touched)}_updatePristine(he={}){this.pristine=!this._anyControlsDirty(),this._parent&&!he.onlySelf&&this._parent._updatePristine(he)}_updateTouched(he={}){this.touched=this._anyControlsTouched(),this._parent&&!he.onlySelf&&this._parent._updateTouched(he)}_isBoxedValue(he){return"object"==typeof he&&null!==he&&2===Object.keys(he).length&&"value"in he&&"disabled"in he}_registerOnCollectionChange(he){this._onCollectionChange=he}_setUpdateStrategy(he){Gr(he)&&null!=he.updateOn&&(this._updateOn=he.updateOn)}_parentMarkedDirty(he){return!he&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class Wn extends Nr{constructor(he=null,ae,Re){super(Pn(ae),Xn(Re,ae)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(he),this._setUpdateStrategy(ae),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Gr(ae)&&ae.initialValueIsDefault&&(this.defaultValue=this._isBoxedValue(he)?he.value:he)}setValue(he,ae={}){this.value=this._pendingValue=he,this._onChange.length&&!1!==ae.emitModelToViewChange&&this._onChange.forEach(Re=>Re(this.value,!1!==ae.emitViewToModelChange)),this.updateValueAndValidity(ae)}patchValue(he,ae={}){this.setValue(he,ae)}reset(he=this.defaultValue,ae={}){this._applyFormState(he),this.markAsPristine(ae),this.markAsUntouched(ae),this.setValue(this.value,ae),this._pendingChange=!1}_updateValue(){}_anyControls(he){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(he){this._onChange.push(he)}_unregisterOnChange(he){xe(this._onChange,he)}registerOnDisabledChange(he){this._onDisabledChange.push(he)}_unregisterOnDisabledChange(he){xe(this._onDisabledChange,he)}_forEachChild(he){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(he){this._isBoxedValue(he)?(this.value=this._pendingValue=he.value,he.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=he}}class Fi extends Nr{constructor(he,ae,Re){super(Pn(ae),Xn(Re,ae)),this.controls=he,this._initObservables(),this._setUpdateStrategy(ae),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(he,ae){return this.controls[he]?this.controls[he]:(this.controls[he]=ae,ae.setParent(this),ae._registerOnCollectionChange(this._onCollectionChange),ae)}addControl(he,ae,Re={}){this.registerControl(he,ae),this.updateValueAndValidity({emitEvent:Re.emitEvent}),this._onCollectionChange()}removeControl(he,ae={}){this.controls[he]&&this.controls[he]._registerOnCollectionChange(()=>{}),delete this.controls[he],this.updateValueAndValidity({emitEvent:ae.emitEvent}),this._onCollectionChange()}setControl(he,ae,Re={}){this.controls[he]&&this.controls[he]._registerOnCollectionChange(()=>{}),delete this.controls[he],ae&&this.registerControl(he,ae),this.updateValueAndValidity({emitEvent:Re.emitEvent}),this._onCollectionChange()}contains(he){return this.controls.hasOwnProperty(he)&&this.controls[he].enabled}setValue(he,ae={}){Mr(this,he),Object.keys(he).forEach(Re=>{Er(this,Re),this.controls[Re].setValue(he[Re],{onlySelf:!0,emitEvent:ae.emitEvent})}),this.updateValueAndValidity(ae)}patchValue(he,ae={}){null!=he&&(Object.keys(he).forEach(Re=>{this.controls[Re]&&this.controls[Re].patchValue(he[Re],{onlySelf:!0,emitEvent:ae.emitEvent})}),this.updateValueAndValidity(ae))}reset(he={},ae={}){this._forEachChild((Re,gn)=>{Re.reset(he[gn],{onlySelf:!0,emitEvent:ae.emitEvent})}),this._updatePristine(ae),this._updateTouched(ae),this.updateValueAndValidity(ae)}getRawValue(){return this._reduceChildren({},(he,ae,Re)=>(he[Re]=hr(ae),he))}_syncPendingControls(){let he=this._reduceChildren(!1,(ae,Re)=>!!Re._syncPendingControls()||ae);return he&&this.updateValueAndValidity({onlySelf:!0}),he}_forEachChild(he){Object.keys(this.controls).forEach(ae=>{const Re=this.controls[ae];Re&&he(Re,ae)})}_setUpControls(){this._forEachChild(he=>{he.setParent(this),he._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(he){for(const ae of Object.keys(this.controls)){const Re=this.controls[ae];if(this.contains(ae)&&he(Re))return!0}return!1}_reduceValue(){return this._reduceChildren({},(he,ae,Re)=>((ae.enabled||this.disabled)&&(he[Re]=ae.value),he))}_reduceChildren(he,ae){let Re=he;return this._forEachChild((gn,xi)=>{Re=ae(Re,gn,xi)}),Re}_allControlsDisabled(){for(const he of Object.keys(this.controls))if(this.controls[he].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}}class Xi extends Nr{constructor(he,ae,Re){super(Pn(ae),Xn(Re,ae)),this.controls=he,this._initObservables(),this._setUpdateStrategy(ae),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(he){return this.controls[he]}push(he,ae={}){this.controls.push(he),this._registerControl(he),this.updateValueAndValidity({emitEvent:ae.emitEvent}),this._onCollectionChange()}insert(he,ae,Re={}){this.controls.splice(he,0,ae),this._registerControl(ae),this.updateValueAndValidity({emitEvent:Re.emitEvent})}removeAt(he,ae={}){this.controls[he]&&this.controls[he]._registerOnCollectionChange(()=>{}),this.controls.splice(he,1),this.updateValueAndValidity({emitEvent:ae.emitEvent})}setControl(he,ae,Re={}){this.controls[he]&&this.controls[he]._registerOnCollectionChange(()=>{}),this.controls.splice(he,1),ae&&(this.controls.splice(he,0,ae),this._registerControl(ae)),this.updateValueAndValidity({emitEvent:Re.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(he,ae={}){Mr(this,he),he.forEach((Re,gn)=>{Er(this,gn),this.at(gn).setValue(Re,{onlySelf:!0,emitEvent:ae.emitEvent})}),this.updateValueAndValidity(ae)}patchValue(he,ae={}){null!=he&&(he.forEach((Re,gn)=>{this.at(gn)&&this.at(gn).patchValue(Re,{onlySelf:!0,emitEvent:ae.emitEvent})}),this.updateValueAndValidity(ae))}reset(he=[],ae={}){this._forEachChild((Re,gn)=>{Re.reset(he[gn],{onlySelf:!0,emitEvent:ae.emitEvent})}),this._updatePristine(ae),this._updateTouched(ae),this.updateValueAndValidity(ae)}getRawValue(){return this.controls.map(he=>hr(he))}clear(he={}){this.controls.length<1||(this._forEachChild(ae=>ae._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:he.emitEvent}))}_syncPendingControls(){let he=this.controls.reduce((ae,Re)=>!!Re._syncPendingControls()||ae,!1);return he&&this.updateValueAndValidity({onlySelf:!0}),he}_forEachChild(he){this.controls.forEach((ae,Re)=>{he(ae,Re)})}_updateValue(){this.value=this.controls.filter(he=>he.enabled||this.disabled).map(he=>he.value)}_anyControls(he){return this.controls.some(ae=>ae.enabled&&he(ae))}_setUpControls(){this._forEachChild(he=>this._registerControl(he))}_allControlsDisabled(){for(const he of this.controls)if(he.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(he){he.setParent(this),he._registerOnCollectionChange(this._onCollectionChange)}}const Dr={provide:fi,useExisting:(0,D.Gpc)(()=>ca)},Uo=(()=>Promise.resolve(null))();let ca=(()=>{class ge extends fi{constructor(ae,Re,gn,xi,vi){super(),this._changeDetectorRef=vi,this.control=new Wn,this._registered=!1,this.update=new D.vpe,this._parent=ae,this._setValidators(Re),this._setAsyncValidators(gn),this.valueAccessor=Dn(0,xi)}ngOnChanges(ae){if(this._checkForErrors(),!this._registered||"name"in ae){if(this._registered&&(this._checkName(),this.formDirective)){const Re=ae.name.previousValue;this.formDirective.removeControl({name:Re,path:this._getPath(Re)})}this._setUpControl()}"isDisabled"in ae&&this._updateDisabled(ae),Rt(ae,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(ae){this.viewModel=ae,this.update.emit(ae)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){ei(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(ae){Uo.then(()=>{var Re;this.control.setValue(ae,{emitViewToModelChange:!1}),null===(Re=this._changeDetectorRef)||void 0===Re||Re.markForCheck()})}_updateDisabled(ae){const Re=ae.isDisabled.currentValue,gn=""===Re||Re&&"false"!==Re;Uo.then(()=>{var xi;gn&&!this.control.disabled?this.control.disable():!gn&&this.control.disabled&&this.control.enable(),null===(xi=this._changeDetectorRef)||void 0===xi||xi.markForCheck()})}_getPath(ae){return this._parent?vo(ae,this._parent):[ae]}}return ge.\u0275fac=function(ae){return new(ae||ge)(D.Y36(nr,9),D.Y36(tn,10),D.Y36(kt,10),D.Y36(Ke,10),D.Y36(D.sBO,8))},ge.\u0275dir=D.lG2({type:ge,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[D._Bn([Dr]),D.qOj,D.TTD]}),ge})(),po=(()=>{class ge{}return ge.\u0275fac=function(ae){return new(ae||ge)},ge.\u0275dir=D.lG2({type:ge,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),ge})(),Ir=(()=>{class ge{}return ge.\u0275fac=function(ae){return new(ae||ge)},ge.\u0275mod=D.oAB({type:ge}),ge.\u0275inj=D.cJS({}),ge})();const Qs=new D.OlP("NgModelWithFormControlWarning"),$o={provide:nr,useExisting:(0,D.Gpc)(()=>ha)};let ha=(()=>{class ge extends nr{constructor(ae,Re){super(),this.validators=ae,this.asyncValidators=Re,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new D.vpe,this._setValidators(ae),this._setAsyncValidators(Re)}ngOnChanges(ae){this._checkFormPresent(),ae.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(Ao(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(ae){const Re=this.form.get(ae.path);return ei(Re,ae),Re.updateValueAndValidity({emitEvent:!1}),this.directives.push(ae),Re}getControl(ae){return this.form.get(ae.path)}removeControl(ae){fr(ae.control||null,ae,!1),xe(this.directives,ae)}addFormGroup(ae){this._setUpFormContainer(ae)}removeFormGroup(ae){this._cleanUpFormContainer(ae)}getFormGroup(ae){return this.form.get(ae.path)}addFormArray(ae){this._setUpFormContainer(ae)}removeFormArray(ae){this._cleanUpFormContainer(ae)}getFormArray(ae){return this.form.get(ae.path)}updateModel(ae,Re){this.form.get(ae.path).setValue(Re)}onSubmit(ae){return this.submitted=!0,function Kt(ge,he){ge._syncPendingControls(),he.forEach(ae=>{const Re=ae.control;"submit"===Re.updateOn&&Re._pendingChange&&(ae.viewToModelUpdate(Re._pendingValue),Re._pendingChange=!1)})}(this.form,this.directives),this.ngSubmit.emit(ae),!1}onReset(){this.resetForm()}resetForm(ae){this.form.reset(ae),this.submitted=!1}_updateDomValue(){this.directives.forEach(ae=>{const Re=ae.control,gn=this.form.get(ae.path);Re!==gn&&(fr(Re||null,ae),gr(gn)&&(ei(gn,ae),ae.control=gn))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(ae){const Re=this.form.get(ae.path);(function Te(ge,he){ir(ge,he)})(Re,ae),Re.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(ae){if(this.form){const Re=this.form.get(ae.path);Re&&function Me(ge,he){return Ao(ge,he)}(Re,ae)&&Re.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){ir(this.form,this),this._oldForm&&Ao(this._oldForm,this)}_checkFormPresent(){}}return ge.\u0275fac=function(ae){return new(ae||ge)(D.Y36(tn,10),D.Y36(kt,10))},ge.\u0275dir=D.lG2({type:ge,selectors:[["","formGroup",""]],hostBindings:function(ae,Re){1&ae&&D.NdJ("submit",function(xi){return Re.onSubmit(xi)})("reset",function(){return Re.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[D._Bn([$o]),D.qOj,D.TTD]}),ge})();const Da={provide:fi,useExisting:(0,D.Gpc)(()=>Us)};let Us=(()=>{class ge extends fi{constructor(ae,Re,gn,xi,vi){super(),this._ngModelWarningConfig=vi,this._added=!1,this.update=new D.vpe,this._ngModelWarningSent=!1,this._parent=ae,this._setValidators(Re),this._setAsyncValidators(gn),this.valueAccessor=Dn(0,xi)}set isDisabled(ae){}ngOnChanges(ae){this._added||this._setUpControl(),Rt(ae,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(ae){this.viewModel=ae,this.update.emit(ae)}get path(){return vo(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this.control.disabled&&this.valueAccessor.setDisabledState&&this.valueAccessor.setDisabledState(!0),this._added=!0}}return ge._ngModelWarningSentOnce=!1,ge.\u0275fac=function(ae){return new(ae||ge)(D.Y36(nr,13),D.Y36(tn,10),D.Y36(kt,10),D.Y36(Ke,10),D.Y36(Qs,8))},ge.\u0275dir=D.lG2({type:ge,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[D._Bn([Da]),D.qOj,D.TTD]}),ge})();const Sa={provide:Ke,useExisting:(0,D.Gpc)(()=>Mo),multi:!0};function qs(ge,he){return null==ge?`${he}`:(he&&"object"==typeof he&&(he="Object"),`${ge}: ${he}`.slice(0,50))}let Mo=(()=>{class ge extends At{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(ae){this._compareWith=ae}writeValue(ae){this.value=ae;const gn=qs(this._getOptionId(ae),ae);this.setProperty("value",gn)}registerOnChange(ae){this.onChange=Re=>{this.value=this._getOptionValue(Re),ae(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(ae){for(const Re of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(Re),ae))return Re;return null}_getOptionValue(ae){const Re=function Oo(ge){return ge.split(":")[0]}(ae);return this._optionMap.has(Re)?this._optionMap.get(Re):ae}}return ge.\u0275fac=function(){let he;return function(Re){return(he||(he=D.n5z(ge)))(Re||ge)}}(),ge.\u0275dir=D.lG2({type:ge,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(ae,Re){1&ae&&D.NdJ("change",function(xi){return Re.onChange(xi.target.value)})("blur",function(){return Re.onTouched()})},inputs:{compareWith:"compareWith"},features:[D._Bn([Sa]),D.qOj]}),ge})(),eo=(()=>{class ge{constructor(ae,Re,gn){this._element=ae,this._renderer=Re,this._select=gn,this._select&&(this.id=this._select._registerOption())}set ngValue(ae){null!=this._select&&(this._select._optionMap.set(this.id,ae),this._setElementValue(qs(this.id,ae)),this._select.writeValue(this._select.value))}set value(ae){this._setElementValue(ae),this._select&&this._select.writeValue(this._select.value)}_setElementValue(ae){this._renderer.setProperty(this._element.nativeElement,"value",ae)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return ge.\u0275fac=function(ae){return new(ae||ge)(D.Y36(D.SBq),D.Y36(D.Qsj),D.Y36(Mo,9))},ge.\u0275dir=D.lG2({type:ge,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),ge})();const Xo={provide:Ke,useExisting:(0,D.Gpc)(()=>Aa),multi:!0};function As(ge,he){return null==ge?`${he}`:("string"==typeof he&&(he=`'${he}'`),he&&"object"==typeof he&&(he="Object"),`${ge}: ${he}`.slice(0,50))}let Aa=(()=>{class ge extends At{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(ae){this._compareWith=ae}writeValue(ae){let Re;if(this.value=ae,Array.isArray(ae)){const gn=ae.map(xi=>this._getOptionId(xi));Re=(xi,vi)=>{xi._setSelected(gn.indexOf(vi.toString())>-1)}}else Re=(gn,xi)=>{gn._setSelected(!1)};this._optionMap.forEach(Re)}registerOnChange(ae){this.onChange=Re=>{const gn=[],xi=Re.selectedOptions;if(void 0!==xi){const vi=xi;for(let Jo=0;Jo<vi.length;Jo++){const bs=this._getOptionValue(vi[Jo].value);gn.push(bs)}}else{const vi=Re.options;for(let Jo=0;Jo<vi.length;Jo++){const ms=vi[Jo];if(ms.selected){const bs=this._getOptionValue(ms.value);gn.push(bs)}}}this.value=gn,ae(gn)}}_registerOption(ae){const Re=(this._idCounter++).toString();return this._optionMap.set(Re,ae),Re}_getOptionId(ae){for(const Re of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(Re)._value,ae))return Re;return null}_getOptionValue(ae){const Re=function Ms(ge){return ge.split(":")[0]}(ae);return this._optionMap.has(Re)?this._optionMap.get(Re)._value:ae}}return ge.\u0275fac=function(){let he;return function(Re){return(he||(he=D.n5z(ge)))(Re||ge)}}(),ge.\u0275dir=D.lG2({type:ge,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(ae,Re){1&ae&&D.NdJ("change",function(xi){return Re.onChange(xi.target)})("blur",function(){return Re.onTouched()})},inputs:{compareWith:"compareWith"},features:[D._Bn([Xo]),D.qOj]}),ge})(),ds=(()=>{class ge{constructor(ae,Re,gn){this._element=ae,this._renderer=Re,this._select=gn,this._select&&(this.id=this._select._registerOption(this))}set ngValue(ae){null!=this._select&&(this._value=ae,this._setElementValue(As(this.id,ae)),this._select.writeValue(this._select.value))}set value(ae){this._select?(this._value=ae,this._setElementValue(As(this.id,ae)),this._select.writeValue(this._select.value)):this._setElementValue(ae)}_setElementValue(ae){this._renderer.setProperty(this._element.nativeElement,"value",ae)}_setSelected(ae){this._renderer.setProperty(this._element.nativeElement,"selected",ae)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return ge.\u0275fac=function(ae){return new(ae||ge)(D.Y36(D.SBq),D.Y36(D.Qsj),D.Y36(Aa,9))},ge.\u0275dir=D.lG2({type:ge,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),ge})();function ea(ge){return"number"==typeof ge?ge:parseInt(ge,10)}let fs=(()=>{class ge{constructor(){this._validator=$t}ngOnChanges(ae){if(this.inputName in ae){const Re=this.normalizeInput(ae[this.inputName].currentValue);this._enabled=this.enabled(Re),this._validator=this._enabled?this.createValidator(Re):$t,this._onChange&&this._onChange()}}validate(ae){return this._validator(ae)}registerOnValidatorChange(ae){this._onChange=ae}enabled(ae){return null!=ae}}return ge.\u0275fac=function(ae){return new(ae||ge)},ge.\u0275dir=D.lG2({type:ge,features:[D.TTD]}),ge})();const Y={provide:tn,useExisting:(0,D.Gpc)(()=>le),multi:!0};let le=(()=>{class ge extends fs{constructor(){super(...arguments),this.inputName="minlength",this.normalizeInput=ae=>ea(ae),this.createValidator=ae=>kn(ae)}}return ge.\u0275fac=function(){let he;return function(Re){return(he||(he=D.n5z(ge)))(Re||ge)}}(),ge.\u0275dir=D.lG2({type:ge,selectors:[["","minlength","","formControlName",""],["","minlength","","formControl",""],["","minlength","","ngModel",""]],hostVars:1,hostBindings:function(ae,Re){2&ae&&D.uIk("minlength",Re._enabled?Re.minlength:null)},inputs:{minlength:"minlength"},features:[D._Bn([Y]),D.qOj]}),ge})();const ee={provide:tn,useExisting:(0,D.Gpc)(()=>be),multi:!0};let be=(()=>{class ge extends fs{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=ae=>ea(ae),this.createValidator=ae=>Ci(ae)}}return ge.\u0275fac=function(){let he;return function(Re){return(he||(he=D.n5z(ge)))(Re||ge)}}(),ge.\u0275dir=D.lG2({type:ge,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(ae,Re){2&ae&&D.uIk("maxlength",Re._enabled?Re.maxlength:null)},inputs:{maxlength:"maxlength"},features:[D._Bn([ee]),D.qOj]}),ge})(),wn=(()=>{class ge{}return ge.\u0275fac=function(ae){return new(ae||ge)},ge.\u0275mod=D.oAB({type:ge}),ge.\u0275inj=D.cJS({imports:[[Ir]]}),ge})(),er=(()=>{class ge{}return ge.\u0275fac=function(ae){return new(ae||ge)},ge.\u0275mod=D.oAB({type:ge}),ge.\u0275inj=D.cJS({imports:[wn]}),ge})(),ji=(()=>{class ge{static withConfig(ae){return{ngModule:ge,providers:[{provide:Qs,useValue:ae.warnOnNgModelWithFormControl}]}}}return ge.\u0275fac=function(ae){return new(ae||ge)},ge.\u0275mod=D.oAB({type:ge}),ge.\u0275inj=D.cJS({imports:[wn]}),ge})(),Zi=(()=>{class ge{group(ae,Re=null){const gn=this._reduceControls(ae);let Jo,xi=null,vi=null;return null!=Re&&(function Lr(ge){return void 0!==ge.asyncValidators||void 0!==ge.validators||void 0!==ge.updateOn}(Re)?(xi=null!=Re.validators?Re.validators:null,vi=null!=Re.asyncValidators?Re.asyncValidators:null,Jo=null!=Re.updateOn?Re.updateOn:void 0):(xi=null!=Re.validator?Re.validator:null,vi=null!=Re.asyncValidator?Re.asyncValidator:null)),new Fi(gn,{asyncValidators:vi,updateOn:Jo,validators:xi})}control(ae,Re,gn){return new Wn(ae,Re,gn)}array(ae,Re,gn){const xi=ae.map(vi=>this._createControl(vi));return new Xi(xi,Re,gn)}_reduceControls(ae){const Re={};return Object.keys(ae).forEach(gn=>{Re[gn]=this._createControl(ae[gn])}),Re}_createControl(ae){return gr(ae)||Rn(ae)||ti(ae)?ae:Array.isArray(ae)?this.control(ae[0],ae.length>1?ae[1]:null,ae.length>2?ae[2]:null):this.control(ae)}}return ge.\u0275fac=function(ae){return new(ae||ge)},ge.\u0275prov=D.Yz7({token:ge,factory:ge.\u0275fac,providedIn:ji}),ge})()},1810:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{gz:()=>us,m2:()=>oi,Q3:()=>En,OD:()=>yn,wm:()=>Bn,F0:()=>Cr,Od:()=>Ut,yS:()=>Ue,Bz:()=>J,lC:()=>js});var D=fe(4893),N=fe(8306),A=fe(576);function l(g,x){const C=(0,A.m)(g)?g:()=>g,U=Q=>Q.error(C());return new N.y(x?Q=>x.schedule(U,0,Q):U)}const lt=(0,fe(3888).d)(g=>function(){g(this),this.name="EmptyError",this.message="no elements in sequence"});var At=fe(8421);function Ke(g){return new N.y(x=>{(0,At.Xf)(g()).subscribe(x)})}var ct=fe(727),_t=fe(4482),Nt=fe(5403);function wt(){return(0,_t.e)((g,x)=>{let C=null;g._refCount++;const U=(0,Nt.x)(x,void 0,void 0,void 0,()=>{if(!g||g._refCount<=0||0<--g._refCount)return void(C=null);const Q=g._connection,ye=C;C=null,Q&&(!ye||Q===ye)&&Q.unsubscribe(),x.unsubscribe()});g.subscribe(U),U.closed||(C=g.connect())})}class Bt extends N.y{constructor(x,C){super(),this.source=x,this.subjectFactory=C,this._subject=null,this._refCount=0,this._connection=null,(0,_t.A)(x)&&(this.lift=x.lift)}_subscribe(x){return this.getSubject().subscribe(x)}getSubject(){const x=this._subject;return(!x||x.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:x}=this;this._subject=this._connection=null,null==x||x.unsubscribe()}connect(){let x=this._connection;if(!x){x=this._connection=new ct.w0;const C=this.getSubject();x.add(this.source.subscribe((0,Nt.x)(C,void 0,()=>{this._teardown(),C.complete()},U=>{this._teardown(),C.error(U)},()=>this._teardown()))),x.closed&&(this._connection=null,x=ct.w0.EMPTY)}return x}refCount(){return wt()(this)}}var st=fe(2076),at=fe(9646),ft=fe(1135),tn=fe(9841),kt=fe(7272),dn=fe(515),Qn=fe(7579);function on(g,x,C,U,Q){return(ye,Pe)=>{let Ze=C,zt=x,qn=0;ye.subscribe((0,Nt.x)(Pe,Pi=>{const Vi=qn++;zt=Ze?g(zt,Pi,Vi):(Ze=!0,Pi),U&&Pe.next(zt)},Q&&(()=>{Ze&&Pe.next(zt),Pe.complete()})))}}function Cn(g,x){return(0,_t.e)(on(g,x,arguments.length>=2,!0))}var se=fe(9300);function Wi(g){return g<=0?()=>dn.E:(0,_t.e)((x,C)=>{let U=[];x.subscribe((0,Nt.x)(C,Q=>{U.push(Q),g<U.length&&U.shift()},()=>{for(const Q of U)C.next(Q);C.complete()},void 0,()=>{U=null}))})}function ii(g=kn){return(0,_t.e)((x,C)=>{let U=!1;x.subscribe((0,Nt.x)(C,Q=>{U=!0,C.next(Q)},()=>U?C.complete():C.error(g())))})}function kn(){return new lt}function Ci(g){return(0,_t.e)((x,C)=>{let U=!1;x.subscribe((0,Nt.x)(C,Q=>{U=!0,C.next(Q)},()=>{U||C.next(g),C.complete()}))})}var Jt=fe(4671),en=fe(5698);function an(g,x){const C=arguments.length>=2;return U=>U.pipe(g?(0,se.h)((Q,ye)=>g(Q,ye,U)):Jt.y,(0,en.q)(1),C?Ci(x):ii(()=>new lt))}var An=fe(4004),Sn=fe(3900),Mi=fe(8675),mr=fe(262),wi=fe(4351),_i=fe(5577),Ki=fe(8505),ui=fe(8189),Ti=fe(9808);class Br{constructor(x,C){this.id=x,this.url=C}}class yn extends Br{constructor(x,C,U="imperative",Q=null){super(x,C),this.navigationTrigger=U,this.restoredState=Q}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class oi extends Br{constructor(x,C,U){super(x,C),this.urlAfterRedirects=U}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Tt extends Br{constructor(x,C,U){super(x,C),this.reason=U}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class En extends Br{constructor(x,C,U){super(x,C),this.error=U}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class si extends Br{constructor(x,C,U,Q){super(x,C),this.urlAfterRedirects=U,this.state=Q}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class fi extends Br{constructor(x,C,U,Q){super(x,C),this.urlAfterRedirects=U,this.state=Q}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class nr extends Br{constructor(x,C,U,Q,ye){super(x,C),this.urlAfterRedirects=U,this.state=Q,this.shouldActivate=ye}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Tr extends Br{constructor(x,C,U,Q){super(x,C),this.urlAfterRedirects=U,this.state=Q}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Zr extends Br{constructor(x,C,U,Q){super(x,C),this.urlAfterRedirects=U,this.state=Q}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Ur{constructor(x){this.route=x}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Mn{constructor(x){this.route=x}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class yo{constructor(x){this.snapshot=x}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class qr{constructor(x){this.snapshot=x}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class no{constructor(x){this.snapshot=x}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class dr{constructor(x){this.snapshot=x}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class cs{constructor(x,C,U){this.routerEvent=x,this.position=C,this.anchor=U}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const cn="primary";class Ot{constructor(x){this.params=x||{}}has(x){return Object.prototype.hasOwnProperty.call(this.params,x)}get(x){if(this.has(x)){const C=this.params[x];return Array.isArray(C)?C[0]:C}return null}getAll(x){if(this.has(x)){const C=this.params[x];return Array.isArray(C)?C:[C]}return[]}get keys(){return Object.keys(this.params)}}function Dt(g){return new Ot(g)}const Nn="ngNavigationCancelingError";function nn(g){const x=Error("NavigationCancelingError: "+g);return x[Nn]=!0,x}function pi(g,x,C){const U=C.path.split("/");if(U.length>g.length||"full"===C.pathMatch&&(x.hasChildren()||U.length<g.length))return null;const Q={};for(let ye=0;ye<U.length;ye++){const Pe=U[ye],Ze=g[ye];if(Pe.startsWith(":"))Q[Pe.substring(1)]=Ze;else if(Pe!==Ze.path)return null}return{consumed:g.slice(0,U.length),posParams:Q}}function Li(g,x){const C=g?Object.keys(g):void 0,U=x?Object.keys(x):void 0;if(!C||!U||C.length!=U.length)return!1;let Q;for(let ye=0;ye<C.length;ye++)if(Q=C[ye],!$r(g[Q],x[Q]))return!1;return!0}function $r(g,x){if(Array.isArray(g)&&Array.isArray(x)){if(g.length!==x.length)return!1;const C=[...g].sort(),U=[...x].sort();return C.every((Q,ye)=>U[ye]===Q)}return g===x}function Vr(g){return Array.prototype.concat.apply([],g)}function fo(g){return g.length>0?g[g.length-1]:null}function ei(g,x){for(const C in g)g.hasOwnProperty(C)&&x(g[C],C)}function fr(g){return(0,D.CqO)(g)?g:(0,D.QGY)(g)?(0,st.D)(Promise.resolve(g)):(0,at.of)(g)}const Io={exact:function To(g,x,C){if(!Rt(g.segments,x.segments)||!Me(g.segments,x.segments,C)||g.numberOfChildren!==x.numberOfChildren)return!1;for(const U in x.children)if(!g.children[U]||!To(g.children[U],x.children[U],C))return!1;return!0},subset:qe},ir={exact:function Zo(g,x){return Li(g,x)},subset:function Ds(g,x){return Object.keys(x).length<=Object.keys(g).length&&Object.keys(x).every(C=>$r(g[C],x[C]))},ignored:()=>!0};function Ao(g,x,C){return Io[C.paths](g.root,x.root,C.matrixParams)&&ir[C.queryParams](g.queryParams,x.queryParams)&&!("exact"===C.fragment&&g.fragment!==x.fragment)}function qe(g,x,C){return Te(g,x,x.segments,C)}function Te(g,x,C,U){if(g.segments.length>C.length){const Q=g.segments.slice(0,C.length);return!(!Rt(Q,C)||x.hasChildren()||!Me(Q,C,U))}if(g.segments.length===C.length){if(!Rt(g.segments,C)||!Me(g.segments,C,U))return!1;for(const Q in x.children)if(!g.children[Q]||!qe(g.children[Q],x.children[Q],U))return!1;return!0}{const Q=C.slice(0,g.segments.length),ye=C.slice(g.segments.length);return!!(Rt(g.segments,Q)&&Me(g.segments,Q,U)&&g.children[cn])&&Te(g.children[cn],x,ye,U)}}function Me(g,x,C){return x.every((U,Q)=>ir[C](g[Q].parameters,U.parameters))}class We{constructor(x,C,U){this.root=x,this.queryParams=C,this.fragment=U}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Dt(this.queryParams)),this._queryParamMap}toString(){return xe.serialize(this)}}class Xe{constructor(x,C){this.segments=x,this.children=C,this.parent=null,ei(C,(U,Q)=>U.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Se(this)}}class xt{constructor(x,C){this.path=x,this.parameters=C}get parameterMap(){return this._parameterMap||(this._parameterMap=Dt(this.parameters)),this._parameterMap}toString(){return mi(this)}}function Rt(g,x){return g.length===x.length&&g.every((C,U)=>C.path===x[U].path)}class Kt{}class Dn{parse(x){const C=new Mr(x);return new We(C.parseRootSegment(),C.parseQueryParams(),C.parseFragment())}serialize(x){const C=`/${Be(x.root,!0)}`,U=function qt(g){const x=Object.keys(g).map(C=>{const U=g[C];return Array.isArray(U)?U.map(Q=>`${Pt(C)}=${Pt(Q)}`).join("&"):`${Pt(C)}=${Pt(U)}`}).filter(C=>!!C);return x.length?`?${x.join("&")}`:""}(x.queryParams);return`${C}${U}${"string"==typeof x.fragment?`#${function rn(g){return encodeURI(g)}(x.fragment)}`:""}`}}const xe=new Dn;function Se(g){return g.segments.map(x=>mi(x)).join("/")}function Be(g,x){if(!g.hasChildren())return Se(g);if(x){const C=g.children[cn]?Be(g.children[cn],!1):"",U=[];return ei(g.children,(Q,ye)=>{ye!==cn&&U.push(`${ye}:${Be(Q,!1)}`)}),U.length>0?`${C}(${U.join("//")})`:C}{const C=function nt(g,x){let C=[];return ei(g.children,(U,Q)=>{Q===cn&&(C=C.concat(x(U,Q)))}),ei(g.children,(U,Q)=>{Q!==cn&&(C=C.concat(x(U,Q)))}),C}(g,(U,Q)=>Q===cn?[Be(g.children[cn],!1)]:[`${Q}:${Be(U,!1)}`]);return 1===Object.keys(g.children).length&&null!=g.children[cn]?`${Se(g)}/${C[0]}`:`${Se(g)}/(${C.join("//")})`}}function dt(g){return encodeURIComponent(g).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Pt(g){return dt(g).replace(/%3B/gi,";")}function un(g){return dt(g).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function In(g){return decodeURIComponent(g)}function Pn(g){return In(g.replace(/\+/g,"%20"))}function mi(g){return`${un(g.path)}${function Xn(g){return Object.keys(g).map(x=>`;${un(x)}=${un(g[x])}`).join("")}(g.parameters)}`}const Gr=/^[^\/()?;=#]+/;function gr(g){const x=g.match(Gr);return x?x[0]:""}const Rn=/^[^=?&#]+/,hr=/^[^&#]+/;class Mr{constructor(x){this.url=x,this.remaining=x}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Xe([],{}):new Xe([],this.parseChildren())}parseQueryParams(){const x={};if(this.consumeOptional("?"))do{this.parseQueryParam(x)}while(this.consumeOptional("&"));return x}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const x=[];for(this.peekStartsWith("(")||x.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),x.push(this.parseSegment());let C={};this.peekStartsWith("/(")&&(this.capture("/"),C=this.parseParens(!0));let U={};return this.peekStartsWith("(")&&(U=this.parseParens(!1)),(x.length>0||Object.keys(C).length>0)&&(U[cn]=new Xe(x,C)),U}parseSegment(){const x=gr(this.remaining);if(""===x&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(x),new xt(In(x),this.parseMatrixParams())}parseMatrixParams(){const x={};for(;this.consumeOptional(";");)this.parseParam(x);return x}parseParam(x){const C=gr(this.remaining);if(!C)return;this.capture(C);let U="";if(this.consumeOptional("=")){const Q=gr(this.remaining);Q&&(U=Q,this.capture(U))}x[In(C)]=In(U)}parseQueryParam(x){const C=function ti(g){const x=g.match(Rn);return x?x[0]:""}(this.remaining);if(!C)return;this.capture(C);let U="";if(this.consumeOptional("=")){const Pe=function Er(g){const x=g.match(hr);return x?x[0]:""}(this.remaining);Pe&&(U=Pe,this.capture(U))}const Q=Pn(C),ye=Pn(U);if(x.hasOwnProperty(Q)){let Pe=x[Q];Array.isArray(Pe)||(Pe=[Pe],x[Q]=Pe),Pe.push(ye)}else x[Q]=ye}parseParens(x){const C={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const U=gr(this.remaining),Q=this.remaining[U.length];if("/"!==Q&&")"!==Q&&";"!==Q)throw new Error(`Cannot parse url '${this.url}'`);let ye;U.indexOf(":")>-1?(ye=U.substr(0,U.indexOf(":")),this.capture(ye),this.capture(":")):x&&(ye=cn);const Pe=this.parseChildren();C[ye]=1===Object.keys(Pe).length?Pe[cn]:new Xe([],Pe),this.consumeOptional("//")}return C}peekStartsWith(x){return this.remaining.startsWith(x)}consumeOptional(x){return!!this.peekStartsWith(x)&&(this.remaining=this.remaining.substring(x.length),!0)}capture(x){if(!this.consumeOptional(x))throw new Error(`Expected "${x}".`)}}class Nr{constructor(x){this._root=x}get root(){return this._root.value}parent(x){const C=this.pathFromRoot(x);return C.length>1?C[C.length-2]:null}children(x){const C=Wn(x,this._root);return C?C.children.map(U=>U.value):[]}firstChild(x){const C=Wn(x,this._root);return C&&C.children.length>0?C.children[0].value:null}siblings(x){const C=Fi(x,this._root);return C.length<2?[]:C[C.length-2].children.map(Q=>Q.value).filter(Q=>Q!==x)}pathFromRoot(x){return Fi(x,this._root).map(C=>C.value)}}function Wn(g,x){if(g===x.value)return x;for(const C of x.children){const U=Wn(g,C);if(U)return U}return null}function Fi(g,x){if(g===x.value)return[x];for(const C of x.children){const U=Fi(g,C);if(U.length)return U.unshift(x),U}return[]}class Xi{constructor(x,C){this.value=x,this.children=C}toString(){return`TreeNode(${this.value})`}}function Gi(g){const x={};return g&&g.children.forEach(C=>x[C.value.outlet]=C),x}class yi extends Nr{constructor(x,C){super(x),this.snapshot=C,Po(this,x)}toString(){return this.snapshot.toString()}}function Ji(g,x){const C=function Ko(g,x){const Pe=new lr([],{},{},"",{},cn,x,null,g.root,-1,{});return new ks("",new Xi(Pe,[]))}(g,x),U=new ft.X([new xt("",{})]),Q=new ft.X({}),ye=new ft.X({}),Pe=new ft.X({}),Ze=new ft.X(""),zt=new us(U,Q,Pe,Ze,ye,cn,x,C.root);return zt.snapshot=C.root,new yi(new Xi(zt,[]),C)}class us{constructor(x,C,U,Q,ye,Pe,Ze,zt){this.url=x,this.params=C,this.queryParams=U,this.fragment=Q,this.data=ye,this.outlet=Pe,this.component=Ze,this._futureSnapshot=zt}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,An.U)(x=>Dt(x)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,An.U)(x=>Dt(x)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Ss(g,x="emptyOnly"){const C=g.pathFromRoot;let U=0;if("always"!==x)for(U=C.length-1;U>=1;){const Q=C[U],ye=C[U-1];if(Q.routeConfig&&""===Q.routeConfig.path)U--;else{if(ye.component)break;U--}}return function Hi(g){return g.reduce((x,C)=>({params:Object.assign(Object.assign({},x.params),C.params),data:Object.assign(Object.assign({},x.data),C.data),resolve:Object.assign(Object.assign({},x.resolve),C._resolvedData)}),{params:{},data:{},resolve:{}})}(C.slice(U))}class lr{constructor(x,C,U,Q,ye,Pe,Ze,zt,qn,Pi,Vi){this.url=x,this.params=C,this.queryParams=U,this.fragment=Q,this.data=ye,this.outlet=Pe,this.component=Ze,this.routeConfig=zt,this._urlSegment=qn,this._lastPathIndex=Pi,this._resolve=Vi}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Dt(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Dt(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(U=>U.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class ks extends Nr{constructor(x,C){super(C),this.url=x,Po(this,C)}toString(){return Dr(this._root)}}function Po(g,x){x.value._routerState=g,x.children.forEach(C=>Po(g,C))}function Dr(g){const x=g.children.length>0?` { ${g.children.map(Dr).join(", ")} } `:"";return`${g.value}${x}`}function Uo(g){if(g.snapshot){const x=g.snapshot,C=g._futureSnapshot;g.snapshot=C,Li(x.queryParams,C.queryParams)||g.queryParams.next(C.queryParams),x.fragment!==C.fragment&&g.fragment.next(C.fragment),Li(x.params,C.params)||g.params.next(C.params),function to(g,x){if(g.length!==x.length)return!1;for(let C=0;C<g.length;++C)if(!Li(g[C],x[C]))return!1;return!0}(x.url,C.url)||g.url.next(C.url),Li(x.data,C.data)||g.data.next(C.data)}else g.snapshot=g._futureSnapshot,g.data.next(g._futureSnapshot.data)}function ca(g,x){const C=Li(g.params,x.params)&&function Gt(g,x){return Rt(g,x)&&g.every((C,U)=>Li(C.parameters,x[U].parameters))}(g.url,x.url);return C&&!(!g.parent!=!x.parent)&&(!g.parent||ca(g.parent,x.parent))}function xr(g,x,C){if(C&&g.shouldReuseRoute(x.value,C.value.snapshot)){const U=C.value;U._futureSnapshot=x.value;const Q=function zr(g,x,C){return x.children.map(U=>{for(const Q of C.children)if(g.shouldReuseRoute(U.value,Q.value.snapshot))return xr(g,U,Q);return xr(g,U)})}(g,x,C);return new Xi(U,Q)}{if(g.shouldAttach(x.value)){const ye=g.retrieve(x.value);if(null!==ye){const Pe=ye.route;return Pe.value._futureSnapshot=x.value,Pe.children=x.children.map(Ze=>xr(g,Ze)),Pe}}const U=function rs(g){return new us(new ft.X(g.url),new ft.X(g.params),new ft.X(g.queryParams),new ft.X(g.fragment),new ft.X(g.data),g.outlet,g.component,g)}(x.value),Q=x.children.map(ye=>xr(g,ye));return new Xi(U,Q)}}function Ir(g){return"object"==typeof g&&null!=g&&!g.outlets&&!g.segmentPath}function Vo(g){return"object"==typeof g&&null!=g&&g.outlets}function ya(g,x,C,U,Q){let ye={};if(U&&ei(U,(Ze,zt)=>{ye[zt]=Array.isArray(Ze)?Ze.map(qn=>`${qn}`):`${Ze}`}),g===x)return new We(C,ye,Q);const Pe=hs(g,x,C);return new We(Pe,ye,Q)}function hs(g,x,C){const U={};return ei(g.children,(Q,ye)=>{U[ye]=Q===x?C:hs(Q,x,C)}),new Xe(g.segments,U)}class lo{constructor(x,C,U){if(this.isAbsolute=x,this.numberOfDoubleDots=C,this.commands=U,x&&U.length>0&&Ir(U[0]))throw new Error("Root segment cannot have matrix parameters");const Q=U.find(Vo);if(Q&&Q!==fo(U))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class va{constructor(x,C,U){this.segmentGroup=x,this.processChildren=C,this.index=U}}function ul(g,x,C){if(g||(g=new Xe([],{})),0===g.segments.length&&g.hasChildren())return Qi(g,x,C);const U=function zs(g,x,C){let U=0,Q=x;const ye={match:!1,pathIndex:0,commandIndex:0};for(;Q<g.segments.length;){if(U>=C.length)return ye;const Pe=g.segments[Q],Ze=C[U];if(Vo(Ze))break;const zt=`${Ze}`,qn=U<C.length-1?C[U+1]:null;if(Q>0&&void 0===zt)break;if(zt&&qn&&"object"==typeof qn&&void 0===qn.outlets){if(!Us(zt,qn,Pe))return ye;U+=2}else{if(!Us(zt,{},Pe))return ye;U++}Q++}return{match:!0,pathIndex:Q,commandIndex:U}}(g,x,C),Q=C.slice(U.commandIndex);if(U.match&&U.pathIndex<g.segments.length){const ye=new Xe(g.segments.slice(0,U.pathIndex),{});return ye.children[cn]=new Xe(g.segments.slice(U.pathIndex),g.children),Qi(ye,0,Q)}return U.match&&0===Q.length?new Xe(g.segments,{}):U.match&&!g.hasChildren()?Qr(g,x,C):U.match?Qi(g,0,Q):Qr(g,x,C)}function Qi(g,x,C){if(0===C.length)return new Xe(g.segments,{});{const U=function ha(g){return Vo(g[0])?g[0].outlets:{[cn]:g}}(C),Q={};return ei(U,(ye,Pe)=>{"string"==typeof ye&&(ye=[ye]),null!==ye&&(Q[Pe]=ul(g.children[Pe],x,ye))}),ei(g.children,(ye,Pe)=>{void 0===U[Pe]&&(Q[Pe]=ye)}),new Xe(g.segments,Q)}}function Qr(g,x,C){const U=g.segments.slice(0,x);let Q=0;for(;Q<C.length;){const ye=C[Q];if(Vo(ye)){const zt=da(ye.outlets);return new Xe(U,zt)}if(0===Q&&Ir(C[0])){U.push(new xt(g.segments[x].path,Da(C[0]))),Q++;continue}const Pe=Vo(ye)?ye.outlets[cn]:`${ye}`,Ze=Q<C.length-1?C[Q+1]:null;Pe&&Ze&&Ir(Ze)?(U.push(new xt(Pe,Da(Ze))),Q+=2):(U.push(new xt(Pe,{})),Q++)}return new Xe(U,{})}function da(g){const x={};return ei(g,(C,U)=>{"string"==typeof C&&(C=[C]),null!==C&&(x[U]=Qr(new Xe([],{}),0,C))}),x}function Da(g){const x={};return ei(g,(C,U)=>x[U]=`${C}`),x}function Us(g,x,C){return g==C.path&&Li(x,C.parameters)}class qs{constructor(x,C,U,Q){this.routeReuseStrategy=x,this.futureState=C,this.currState=U,this.forwardEvent=Q}activate(x){const C=this.futureState._root,U=this.currState?this.currState._root:null;this.deactivateChildRoutes(C,U,x),Uo(this.futureState.root),this.activateChildRoutes(C,U,x)}deactivateChildRoutes(x,C,U){const Q=Gi(C);x.children.forEach(ye=>{const Pe=ye.value.outlet;this.deactivateRoutes(ye,Q[Pe],U),delete Q[Pe]}),ei(Q,(ye,Pe)=>{this.deactivateRouteAndItsChildren(ye,U)})}deactivateRoutes(x,C,U){const Q=x.value,ye=C?C.value:null;if(Q===ye)if(Q.component){const Pe=U.getContext(Q.outlet);Pe&&this.deactivateChildRoutes(x,C,Pe.children)}else this.deactivateChildRoutes(x,C,U);else ye&&this.deactivateRouteAndItsChildren(C,U)}deactivateRouteAndItsChildren(x,C){x.value.component&&this.routeReuseStrategy.shouldDetach(x.value.snapshot)?this.detachAndStoreRouteSubtree(x,C):this.deactivateRouteAndOutlet(x,C)}detachAndStoreRouteSubtree(x,C){const U=C.getContext(x.value.outlet),Q=U&&x.value.component?U.children:C,ye=Gi(x);for(const Pe of Object.keys(ye))this.deactivateRouteAndItsChildren(ye[Pe],Q);if(U&&U.outlet){const Pe=U.outlet.detach(),Ze=U.children.onOutletDeactivated();this.routeReuseStrategy.store(x.value.snapshot,{componentRef:Pe,route:x,contexts:Ze})}}deactivateRouteAndOutlet(x,C){const U=C.getContext(x.value.outlet),Q=U&&x.value.component?U.children:C,ye=Gi(x);for(const Pe of Object.keys(ye))this.deactivateRouteAndItsChildren(ye[Pe],Q);U&&U.outlet&&(U.outlet.deactivate(),U.children.onOutletDeactivated(),U.attachRef=null,U.resolver=null,U.route=null)}activateChildRoutes(x,C,U){const Q=Gi(C);x.children.forEach(ye=>{this.activateRoutes(ye,Q[ye.value.outlet],U),this.forwardEvent(new dr(ye.value.snapshot))}),x.children.length&&this.forwardEvent(new qr(x.value.snapshot))}activateRoutes(x,C,U){const Q=x.value,ye=C?C.value:null;if(Uo(Q),Q===ye)if(Q.component){const Pe=U.getOrCreateContext(Q.outlet);this.activateChildRoutes(x,C,Pe.children)}else this.activateChildRoutes(x,C,U);else if(Q.component){const Pe=U.getOrCreateContext(Q.outlet);if(this.routeReuseStrategy.shouldAttach(Q.snapshot)){const Ze=this.routeReuseStrategy.retrieve(Q.snapshot);this.routeReuseStrategy.store(Q.snapshot,null),Pe.children.onOutletReAttached(Ze.contexts),Pe.attachRef=Ze.componentRef,Pe.route=Ze.route.value,Pe.outlet&&Pe.outlet.attach(Ze.componentRef,Ze.route.value),Uo(Ze.route.value),this.activateChildRoutes(x,null,Pe.children)}else{const Ze=function Oo(g){for(let x=g.parent;x;x=x.parent){const C=x.routeConfig;if(C&&C._loadedConfig)return C._loadedConfig;if(C&&C.component)return null}return null}(Q.snapshot),zt=Ze?Ze.module.componentFactoryResolver:null;Pe.attachRef=null,Pe.route=Q,Pe.resolver=zt,Pe.outlet&&Pe.outlet.activateWith(Q,zt),this.activateChildRoutes(x,null,Pe.children)}}else this.activateChildRoutes(x,null,U)}}class Mo{constructor(x,C){this.routes=x,this.module=C}}function eo(g){return"function"==typeof g}function As(g){return g instanceof We}const ea=Symbol("INITIAL_VALUE");function Vs(){return(0,Sn.w)(g=>(0,tn.a)(g.map(x=>x.pipe((0,en.q)(1),(0,Mi.O)(ea)))).pipe(Cn((x,C)=>{let U=!1;return C.reduce((Q,ye,Pe)=>Q!==ea?Q:(ye===ea&&(U=!0),U||!1!==ye&&Pe!==C.length-1&&!As(ye)?Q:ye),x)},ea),(0,se.h)(x=>x!==ea),(0,An.U)(x=>As(x)?x:!0===x),(0,en.q)(1)))}class Wr{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new fs,this.attachRef=null}}class fs{constructor(){this.contexts=new Map}onChildOutletCreated(x,C){const U=this.getOrCreateContext(x);U.outlet=C,this.contexts.set(x,U)}onChildOutletDestroyed(x){const C=this.getContext(x);C&&(C.outlet=null,C.attachRef=null)}onOutletDeactivated(){const x=this.contexts;return this.contexts=new Map,x}onOutletReAttached(x){this.contexts=x}getOrCreateContext(x){let C=this.getContext(x);return C||(C=new Wr,this.contexts.set(x,C)),C}getContext(x){return this.contexts.get(x)||null}}let js=(()=>{class g{constructor(C,U,Q,ye,Pe){this.parentContexts=C,this.location=U,this.resolver=Q,this.changeDetector=Pe,this.activated=null,this._activatedRoute=null,this.activateEvents=new D.vpe,this.deactivateEvents=new D.vpe,this.attachEvents=new D.vpe,this.detachEvents=new D.vpe,this.name=ye||cn,C.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const C=this.parentContexts.getContext(this.name);C&&C.route&&(C.attachRef?this.attach(C.attachRef,C.route):this.activateWith(C.route,C.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const C=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(C.instance),C}attach(C,U){this.activated=C,this._activatedRoute=U,this.location.insert(C.hostView),this.attachEvents.emit(C.instance)}deactivate(){if(this.activated){const C=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(C)}}activateWith(C,U){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=C;const Pe=(U=U||this.resolver).resolveComponentFactory(C._futureSnapshot.routeConfig.component),Ze=this.parentContexts.getOrCreateContext(this.name).children,zt=new ps(C,Ze,this.location.injector);this.activated=this.location.createComponent(Pe,this.location.length,zt),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return g.\u0275fac=function(C){return new(C||g)(D.Y36(fs),D.Y36(D.s_b),D.Y36(D._Vd),D.$8M("name"),D.Y36(D.sBO))},g.\u0275dir=D.lG2({type:g,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),g})();class ps{constructor(x,C,U){this.route=x,this.childContexts=C,this.parent=U}get(x,C){return x===us?this.route:x===fs?this.childContexts:this.parent.get(x,C)}}let Wa=(()=>{class g{}return g.\u0275fac=function(C){return new(C||g)},g.\u0275cmp=D.Xpm({type:g,selectors:[["ng-component"]],decls:1,vars:0,template:function(C,U){1&C&&D._UZ(0,"router-outlet")},directives:[js],encapsulation:2}),g})();function I(g,x=""){for(let C=0;C<g.length;C++){const U=g[C];V(U,ne(x,U))}}function V(g,x){g.children&&I(g.children,x)}function ne(g,x){return x?g||x.path?g&&!x.path?`${g}/`:!g&&x.path?x.path:`${g}/${x.path}`:"":g}function ce(g){const x=g.children&&g.children.map(ce),C=x?Object.assign(Object.assign({},g),{children:x}):Object.assign({},g);return!C.component&&(x||C.loadChildren)&&C.outlet&&C.outlet!==cn&&(C.component=Wa),C}function Ee(g){return g.outlet||cn}function Ae(g,x){const C=g.filter(U=>Ee(U)===x);return C.push(...g.filter(U=>Ee(U)!==x)),C}const Le={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Y(g,x,C){var U;if(""===x.path)return"full"===x.pathMatch&&(g.hasChildren()||C.length>0)?Object.assign({},Le):{matched:!0,consumedSegments:[],remainingSegments:C,parameters:{},positionalParamSegments:{}};const ye=(x.matcher||pi)(C,g,x);if(!ye)return Object.assign({},Le);const Pe={};ei(ye.posParams,(zt,qn)=>{Pe[qn]=zt.path});const Ze=ye.consumed.length>0?Object.assign(Object.assign({},Pe),ye.consumed[ye.consumed.length-1].parameters):Pe;return{matched:!0,consumedSegments:ye.consumed,remainingSegments:C.slice(ye.consumed.length),parameters:Ze,positionalParamSegments:null!==(U=ye.posParams)&&void 0!==U?U:{}}}function le(g,x,C,U,Q="corrected"){if(C.length>0&&function je(g,x,C){return C.some(U=>mt(g,x,U)&&Ee(U)!==cn)}(g,C,U)){const Pe=new Xe(x,function be(g,x,C,U){const Q={};Q[cn]=U,U._sourceSegment=g,U._segmentIndexShift=x.length;for(const ye of C)if(""===ye.path&&Ee(ye)!==cn){const Pe=new Xe([],{});Pe._sourceSegment=g,Pe._segmentIndexShift=x.length,Q[Ee(ye)]=Pe}return Q}(g,x,U,new Xe(C,g.children)));return Pe._sourceSegment=g,Pe._segmentIndexShift=x.length,{segmentGroup:Pe,slicedSegments:[]}}if(0===C.length&&function Ye(g,x,C){return C.some(U=>mt(g,x,U))}(g,C,U)){const Pe=new Xe(g.segments,function ee(g,x,C,U,Q,ye){const Pe={};for(const Ze of U)if(mt(g,C,Ze)&&!Q[Ee(Ze)]){const zt=new Xe([],{});zt._sourceSegment=g,zt._segmentIndexShift="legacy"===ye?g.segments.length:x.length,Pe[Ee(Ze)]=zt}return Object.assign(Object.assign({},Q),Pe)}(g,x,C,U,g.children,Q));return Pe._sourceSegment=g,Pe._segmentIndexShift=x.length,{segmentGroup:Pe,slicedSegments:C}}const ye=new Xe(g.segments,g.children);return ye._sourceSegment=g,ye._segmentIndexShift=x.length,{segmentGroup:ye,slicedSegments:C}}function mt(g,x,C){return(!(g.hasChildren()||x.length>0)||"full"!==C.pathMatch)&&""===C.path}function On(g,x,C,U){return!!(Ee(g)===U||U!==cn&&mt(x,C,g))&&("**"===g.path||Y(x,g,C).matched)}function Ui(g,x,C){return 0===x.length&&!g.children[C]}class wn{constructor(x){this.segmentGroup=x||null}}class er{constructor(x){this.urlTree=x}}function ji(g){return l(new wn(g))}function Lr(g){return l(new er(g))}class he{constructor(x,C,U,Q,ye){this.configLoader=C,this.urlSerializer=U,this.urlTree=Q,this.config=ye,this.allowRedirects=!0,this.ngModule=x.get(D.h0i)}apply(){const x=le(this.urlTree.root,[],[],this.config).segmentGroup,C=new Xe(x.segments,x.children);return this.expandSegmentGroup(this.ngModule,this.config,C,cn).pipe((0,An.U)(ye=>this.createUrlTree(Re(ye),this.urlTree.queryParams,this.urlTree.fragment))).pipe((0,mr.K)(ye=>{if(ye instanceof er)return this.allowRedirects=!1,this.match(ye.urlTree);throw ye instanceof wn?this.noMatchError(ye):ye}))}match(x){return this.expandSegmentGroup(this.ngModule,this.config,x.root,cn).pipe((0,An.U)(Q=>this.createUrlTree(Re(Q),x.queryParams,x.fragment))).pipe((0,mr.K)(Q=>{throw Q instanceof wn?this.noMatchError(Q):Q}))}noMatchError(x){return new Error(`Cannot match any routes. URL Segment: '${x.segmentGroup}'`)}createUrlTree(x,C,U){const Q=x.segments.length>0?new Xe([],{[cn]:x}):x;return new We(Q,C,U)}expandSegmentGroup(x,C,U,Q){return 0===U.segments.length&&U.hasChildren()?this.expandChildren(x,C,U).pipe((0,An.U)(ye=>new Xe([],ye))):this.expandSegment(x,U,C,U.segments,Q,!0)}expandChildren(x,C,U){const Q=[];for(const ye of Object.keys(U.children))"primary"===ye?Q.unshift(ye):Q.push(ye);return(0,st.D)(Q).pipe((0,wi.b)(ye=>{const Pe=U.children[ye],Ze=Ae(C,ye);return this.expandSegmentGroup(x,Ze,Pe,ye).pipe((0,An.U)(zt=>({segment:zt,outlet:ye})))}),Cn((ye,Pe)=>(ye[Pe.outlet]=Pe.segment,ye),{}),function $t(g,x){const C=arguments.length>=2;return U=>U.pipe(g?(0,se.h)((Q,ye)=>g(Q,ye,U)):Jt.y,Wi(1),C?Ci(x):ii(()=>new lt))}())}expandSegment(x,C,U,Q,ye,Pe){return(0,st.D)(U).pipe((0,wi.b)(Ze=>this.expandSegmentAgainstRoute(x,C,U,Ze,Q,ye,Pe).pipe((0,mr.K)(qn=>{if(qn instanceof wn)return(0,at.of)(null);throw qn}))),an(Ze=>!!Ze),(0,mr.K)((Ze,zt)=>{if(Ze instanceof lt||"EmptyError"===Ze.name)return Ui(C,Q,ye)?(0,at.of)(new Xe([],{})):ji(C);throw Ze}))}expandSegmentAgainstRoute(x,C,U,Q,ye,Pe,Ze){return On(Q,C,ye,Pe)?void 0===Q.redirectTo?this.matchSegmentAgainstRoute(x,C,Q,ye,Pe):Ze&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(x,C,U,Q,ye,Pe):ji(C):ji(C)}expandSegmentAgainstRouteUsingRedirect(x,C,U,Q,ye,Pe){return"**"===Q.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(x,U,Q,Pe):this.expandRegularSegmentAgainstRouteUsingRedirect(x,C,U,Q,ye,Pe)}expandWildCardWithParamsAgainstRouteUsingRedirect(x,C,U,Q){const ye=this.applyRedirectCommands([],U.redirectTo,{});return U.redirectTo.startsWith("/")?Lr(ye):this.lineralizeSegments(U,ye).pipe((0,_i.z)(Pe=>{const Ze=new Xe(Pe,{});return this.expandSegment(x,Ze,C,Pe,Q,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(x,C,U,Q,ye,Pe){const{matched:Ze,consumedSegments:zt,remainingSegments:qn,positionalParamSegments:Pi}=Y(C,Q,ye);if(!Ze)return ji(C);const Vi=this.applyRedirectCommands(zt,Q.redirectTo,Pi);return Q.redirectTo.startsWith("/")?Lr(Vi):this.lineralizeSegments(Q,Vi).pipe((0,_i.z)(ro=>this.expandSegment(x,C,U,ro.concat(qn),Pe,!1)))}matchSegmentAgainstRoute(x,C,U,Q,ye){if("**"===U.path)return U.loadChildren?(U._loadedConfig?(0,at.of)(U._loadedConfig):this.configLoader.load(x.injector,U)).pipe((0,An.U)(Vi=>(U._loadedConfig=Vi,new Xe(Q,{})))):(0,at.of)(new Xe(Q,{}));const{matched:Pe,consumedSegments:Ze,remainingSegments:zt}=Y(C,U,Q);return Pe?this.getChildConfig(x,U,Q).pipe((0,_i.z)(Pi=>{const Vi=Pi.module,ro=Pi.routes,{segmentGroup:co,slicedSegments:Zs}=le(C,Ze,zt,ro),Tl=new Xe(co.segments,co.children);if(0===Zs.length&&Tl.hasChildren())return this.expandChildren(Vi,ro,Tl).pipe((0,An.U)(Gs=>new Xe(Ze,Gs)));if(0===ro.length&&0===Zs.length)return(0,at.of)(new Xe(Ze,{}));const kl=Ee(U)===ye;return this.expandSegment(Vi,Tl,ro,Zs,kl?cn:ye,!0).pipe((0,An.U)(El=>new Xe(Ze.concat(El.segments),El.children)))})):ji(C)}getChildConfig(x,C,U){return C.children?(0,at.of)(new Mo(C.children,x)):C.loadChildren?void 0!==C._loadedConfig?(0,at.of)(C._loadedConfig):this.runCanLoadGuards(x.injector,C,U).pipe((0,_i.z)(Q=>Q?this.configLoader.load(x.injector,C).pipe((0,An.U)(ye=>(C._loadedConfig=ye,ye))):function bi(g){return l(nn(`Cannot load children because the guard of the route "path: '${g.path}'" returned false`))}(C))):(0,at.of)(new Mo([],x))}runCanLoadGuards(x,C,U){const Q=C.canLoad;if(!Q||0===Q.length)return(0,at.of)(!0);const ye=Q.map(Pe=>{const Ze=x.get(Pe);let zt;if(function Ms(g){return g&&eo(g.canLoad)}(Ze))zt=Ze.canLoad(C,U);else{if(!eo(Ze))throw new Error("Invalid CanLoad guard");zt=Ze(C,U)}return fr(zt)});return(0,at.of)(ye).pipe(Vs(),(0,Ki.b)(Pe=>{if(!As(Pe))return;const Ze=nn(`Redirecting to "${this.urlSerializer.serialize(Pe)}"`);throw Ze.url=Pe,Ze}),(0,An.U)(Pe=>!0===Pe))}lineralizeSegments(x,C){let U=[],Q=C.root;for(;;){if(U=U.concat(Q.segments),0===Q.numberOfChildren)return(0,at.of)(U);if(Q.numberOfChildren>1||!Q.children[cn])return l(new Error(`Only absolute redirects can have named outlets. redirectTo: '${x.redirectTo}'`));Q=Q.children[cn]}}applyRedirectCommands(x,C,U){return this.applyRedirectCreatreUrlTree(C,this.urlSerializer.parse(C),x,U)}applyRedirectCreatreUrlTree(x,C,U,Q){const ye=this.createSegmentGroup(x,C.root,U,Q);return new We(ye,this.createQueryParams(C.queryParams,this.urlTree.queryParams),C.fragment)}createQueryParams(x,C){const U={};return ei(x,(Q,ye)=>{if("string"==typeof Q&&Q.startsWith(":")){const Ze=Q.substring(1);U[ye]=C[Ze]}else U[ye]=Q}),U}createSegmentGroup(x,C,U,Q){const ye=this.createSegments(x,C.segments,U,Q);let Pe={};return ei(C.children,(Ze,zt)=>{Pe[zt]=this.createSegmentGroup(x,Ze,U,Q)}),new Xe(ye,Pe)}createSegments(x,C,U,Q){return C.map(ye=>ye.path.startsWith(":")?this.findPosParam(x,ye,Q):this.findOrReturn(ye,U))}findPosParam(x,C,U){const Q=U[C.path.substring(1)];if(!Q)throw new Error(`Cannot redirect to '${x}'. Cannot find '${C.path}'.`);return Q}findOrReturn(x,C){let U=0;for(const Q of C){if(Q.path===x.path)return C.splice(U),Q;U++}return x}}function Re(g){const x={};for(const U of Object.keys(g.children)){const ye=Re(g.children[U]);(ye.segments.length>0||ye.hasChildren())&&(x[U]=ye)}return function ae(g){if(1===g.numberOfChildren&&g.children[cn]){const x=g.children[cn];return new Xe(g.segments.concat(x.segments),x.children)}return g}(new Xe(g.segments,x))}class xi{constructor(x){this.path=x,this.route=this.path[this.path.length-1]}}class vi{constructor(x,C){this.component=x,this.route=C}}function Jo(g,x,C){const U=g._root;return xs(U,x?x._root:null,C,[U.value])}function bs(g,x,C){const U=function No(g){if(!g)return null;for(let x=g.parent;x;x=x.parent){const C=x.routeConfig;if(C&&C._loadedConfig)return C._loadedConfig}return null}(x);return(U?U.module.injector:C).get(g)}function xs(g,x,C,U,Q={canDeactivateChecks:[],canActivateChecks:[]}){const ye=Gi(x);return g.children.forEach(Pe=>{(function ka(g,x,C,U,Q={canDeactivateChecks:[],canActivateChecks:[]}){const ye=g.value,Pe=x?x.value:null,Ze=C?C.getContext(g.value.outlet):null;if(Pe&&ye.routeConfig===Pe.routeConfig){const zt=function ta(g,x,C){if("function"==typeof C)return C(g,x);switch(C){case"pathParamsChange":return!Rt(g.url,x.url);case"pathParamsOrQueryParamsChange":return!Rt(g.url,x.url)||!Li(g.queryParams,x.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!ca(g,x)||!Li(g.queryParams,x.queryParams);default:return!ca(g,x)}}(Pe,ye,ye.routeConfig.runGuardsAndResolvers);zt?Q.canActivateChecks.push(new xi(U)):(ye.data=Pe.data,ye._resolvedData=Pe._resolvedData),xs(g,x,ye.component?Ze?Ze.children:null:C,U,Q),zt&&Ze&&Ze.outlet&&Ze.outlet.isActivated&&Q.canDeactivateChecks.push(new vi(Ze.outlet.component,Pe))}else Pe&&Hn(x,Ze,Q),Q.canActivateChecks.push(new xi(U)),xs(g,null,ye.component?Ze?Ze.children:null:C,U,Q)})(Pe,ye[Pe.value.outlet],C,U.concat([Pe.value]),Q),delete ye[Pe.value.outlet]}),ei(ye,(Pe,Ze)=>Hn(Pe,C.getContext(Ze),Q)),Q}function Hn(g,x,C){const U=Gi(g),Q=g.value;ei(U,(ye,Pe)=>{Hn(ye,Q.component?x?x.children.getContext(Pe):null:x,C)}),C.canDeactivateChecks.push(new vi(Q.component&&x&&x.outlet&&x.outlet.isActivated?x.outlet.component:null,Q))}class hl{}function Ya(g){return new N.y(x=>x.error(g))}class Ws{constructor(x,C,U,Q,ye,Pe){this.rootComponentType=x,this.config=C,this.urlTree=U,this.url=Q,this.paramsInheritanceStrategy=ye,this.relativeLinkResolution=Pe}recognize(){const x=le(this.urlTree.root,[],[],this.config.filter(Pe=>void 0===Pe.redirectTo),this.relativeLinkResolution).segmentGroup,C=this.processSegmentGroup(this.config,x,cn);if(null===C)return null;const U=new lr([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},cn,this.rootComponentType,null,this.urlTree.root,-1,{}),Q=new Xi(U,C),ye=new ks(this.url,Q);return this.inheritParamsAndData(ye._root),ye}inheritParamsAndData(x){const C=x.value,U=Ss(C,this.paramsInheritanceStrategy);C.params=Object.freeze(U.params),C.data=Object.freeze(U.data),x.children.forEach(Q=>this.inheritParamsAndData(Q))}processSegmentGroup(x,C,U){return 0===C.segments.length&&C.hasChildren()?this.processChildren(x,C):this.processSegment(x,C,C.segments,U)}processChildren(x,C){const U=[];for(const ye of Object.keys(C.children)){const Pe=C.children[ye],Ze=Ae(x,ye),zt=this.processSegmentGroup(Ze,Pe,ye);if(null===zt)return null;U.push(...zt)}const Q=xa(U);return function ss(g){g.sort((x,C)=>x.value.outlet===cn?-1:C.value.outlet===cn?1:x.value.outlet.localeCompare(C.value.outlet))}(Q),Q}processSegment(x,C,U,Q){for(const ye of x){const Pe=this.processSegmentAgainstRoute(ye,C,U,Q);if(null!==Pe)return Pe}return Ui(C,U,Q)?[]:null}processSegmentAgainstRoute(x,C,U,Q){if(x.redirectTo||!On(x,C,U,Q))return null;let ye,Pe=[],Ze=[];if("**"===x.path){const co=U.length>0?fo(U).parameters:{};ye=new lr(U,co,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,wa(x),Ee(x),x.component,x,vl(C),Is(C)+U.length,_s(x))}else{const co=Y(C,x,U);if(!co.matched)return null;Pe=co.consumedSegments,Ze=co.remainingSegments,ye=new lr(Pe,co.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,wa(x),Ee(x),x.component,x,vl(C),Is(C)+Pe.length,_s(x))}const zt=function ba(g){return g.children?g.children:g.loadChildren?g._loadedConfig.routes:[]}(x),{segmentGroup:qn,slicedSegments:Pi}=le(C,Pe,Ze,zt.filter(co=>void 0===co.redirectTo),this.relativeLinkResolution);if(0===Pi.length&&qn.hasChildren()){const co=this.processChildren(zt,qn);return null===co?null:[new Xi(ye,co)]}if(0===zt.length&&0===Pi.length)return[new Xi(ye,[])];const Vi=Ee(x)===Q,ro=this.processSegment(zt,qn,Pi,Vi?cn:Q);return null===ro?null:[new Xi(ye,ro)]}}function Ka(g){const x=g.value.routeConfig;return x&&""===x.path&&void 0===x.redirectTo}function xa(g){const x=[],C=new Set;for(const U of g){if(!Ka(U)){x.push(U);continue}const Q=x.find(ye=>U.value.routeConfig===ye.value.routeConfig);void 0!==Q?(Q.children.push(...U.children),C.add(Q)):x.push(U)}for(const U of C){const Q=xa(U.children);x.push(new Xi(U.value,Q))}return x.filter(U=>!C.has(U))}function vl(g){let x=g;for(;x._sourceSegment;)x=x._sourceSegment;return x}function Is(g){let x=g,C=x._segmentIndexShift?x._segmentIndexShift:0;for(;x._sourceSegment;)x=x._sourceSegment,C+=x._segmentIndexShift?x._segmentIndexShift:0;return C-1}function wa(g){return g.data||{}}function _s(g){return g.resolve||{}}function Fa(g){return[...Object.keys(g),...Object.getOwnPropertySymbols(g)]}function es(g){return(0,Sn.w)(x=>{const C=g(x);return C?(0,st.D)(C).pipe((0,An.U)(()=>x)):(0,at.of)(x)})}class Ol extends class xl{shouldDetach(x){return!1}store(x,C){}shouldAttach(x){return!1}retrieve(x){return null}shouldReuseRoute(x,C){return x.routeConfig===C.routeConfig}}{}const nl=new D.OlP("ROUTES");class Pa{constructor(x,C,U,Q){this.injector=x,this.compiler=C,this.onLoadStartListener=U,this.onLoadEndListener=Q}load(x,C){if(C._loader$)return C._loader$;this.onLoadStartListener&&this.onLoadStartListener(C);const Q=this.loadModuleFactory(C.loadChildren).pipe((0,An.U)(ye=>{this.onLoadEndListener&&this.onLoadEndListener(C);const Pe=ye.create(x);return new Mo(Vr(Pe.injector.get(nl,void 0,D.XFs.Self|D.XFs.Optional)).map(ce),Pe)}),(0,mr.K)(ye=>{throw C._loader$=void 0,ye}));return C._loader$=new Bt(Q,()=>new Qn.x).pipe(wt()),C._loader$}loadModuleFactory(x){return fr(x()).pipe((0,_i.z)(C=>C instanceof D.YKP?(0,at.of)(C):(0,st.D)(this.compiler.compileModuleAsync(C))))}}class Ba{shouldProcessUrl(x){return!0}extract(x){return x}merge(x,C){return x}}function ws(g){throw g}function ts(g,x,C){return x.parse("/")}function bo(g,x){return(0,at.of)(null)}const fa={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},wl={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Cr=(()=>{class g{constructor(C,U,Q,ye,Pe,Ze,zt){this.rootComponentType=C,this.urlSerializer=U,this.rootContexts=Q,this.location=ye,this.config=zt,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new Qn.x,this.errorHandler=ws,this.malformedUriErrorHandler=ts,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:bo,afterPreactivation:bo},this.urlHandlingStrategy=new Ba,this.routeReuseStrategy=new Ol,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=Pe.get(D.h0i),this.console=Pe.get(D.c2e);const Vi=Pe.get(D.R0b);this.isNgZoneEnabled=Vi instanceof D.R0b&&D.R0b.isInAngularZone(),this.resetConfig(zt),this.currentUrlTree=function sr(){return new We(new Xe([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new Pa(Pe,Ze,ro=>this.triggerEvent(new Ur(ro)),ro=>this.triggerEvent(new Mn(ro))),this.routerState=Ji(this.currentUrlTree,this.rootComponentType),this.transitions=new ft.X({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var C;return null===(C=this.location.getState())||void 0===C?void 0:C.\u0275routerPageId}setupNavigations(C){const U=this.events;return C.pipe((0,se.h)(Q=>0!==Q.id),(0,An.U)(Q=>Object.assign(Object.assign({},Q),{extractedUrl:this.urlHandlingStrategy.extract(Q.rawUrl)})),(0,Sn.w)(Q=>{let ye=!1,Pe=!1;return(0,at.of)(Q).pipe((0,Ki.b)(Ze=>{this.currentNavigation={id:Ze.id,initialUrl:Ze.currentRawUrl,extractedUrl:Ze.extractedUrl,trigger:Ze.source,extras:Ze.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),(0,Sn.w)(Ze=>{const zt=this.browserUrlTree.toString(),qn=!this.navigated||Ze.extractedUrl.toString()!==zt||zt!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||qn)&&this.urlHandlingStrategy.shouldProcessUrl(Ze.rawUrl))return Rl(Ze.source)&&(this.browserUrlTree=Ze.extractedUrl),(0,at.of)(Ze).pipe((0,Sn.w)(Vi=>{const ro=this.transitions.getValue();return U.next(new yn(Vi.id,this.serializeUrl(Vi.extractedUrl),Vi.source,Vi.restoredState)),ro!==this.transitions.getValue()?dn.E:Promise.resolve(Vi)}),function gn(g,x,C,U){return(0,Sn.w)(Q=>function ge(g,x,C,U,Q){return new he(g,x,C,U,Q).apply()}(g,x,C,Q.extractedUrl,U).pipe((0,An.U)(ye=>Object.assign(Object.assign({},Q),{urlAfterRedirects:ye}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),(0,Ki.b)(Vi=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:Vi.urlAfterRedirects})}),function Va(g,x,C,U,Q){return(0,_i.z)(ye=>function Ma(g,x,C,U,Q="emptyOnly",ye="legacy"){try{const Pe=new Ws(g,x,C,U,Q,ye).recognize();return null===Pe?Ya(new hl):(0,at.of)(Pe)}catch(Pe){return Ya(Pe)}}(g,x,ye.urlAfterRedirects,C(ye.urlAfterRedirects),U,Q).pipe((0,An.U)(Pe=>Object.assign(Object.assign({},ye),{targetSnapshot:Pe}))))}(this.rootComponentType,this.config,Vi=>this.serializeUrl(Vi),this.paramsInheritanceStrategy,this.relativeLinkResolution),(0,Ki.b)(Vi=>{if("eager"===this.urlUpdateStrategy){if(!Vi.extras.skipLocationChange){const co=this.urlHandlingStrategy.merge(Vi.urlAfterRedirects,Vi.rawUrl);this.setBrowserUrl(co,Vi)}this.browserUrlTree=Vi.urlAfterRedirects}const ro=new si(Vi.id,this.serializeUrl(Vi.extractedUrl),this.serializeUrl(Vi.urlAfterRedirects),Vi.targetSnapshot);U.next(ro)}));if(qn&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:ro,extractedUrl:co,source:Zs,restoredState:Tl,extras:kl}=Ze,dl=new yn(ro,this.serializeUrl(co),Zs,Tl);U.next(dl);const El=Ji(co,this.rootComponentType).snapshot;return(0,at.of)(Object.assign(Object.assign({},Ze),{targetSnapshot:El,urlAfterRedirects:co,extras:Object.assign(Object.assign({},kl),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=Ze.rawUrl,Ze.resolve(null),dn.E}),es(Ze=>{const{targetSnapshot:zt,id:qn,extractedUrl:Pi,rawUrl:Vi,extras:{skipLocationChange:ro,replaceUrl:co}}=Ze;return this.hooks.beforePreactivation(zt,{navigationId:qn,appliedUrlTree:Pi,rawUrlTree:Vi,skipLocationChange:!!ro,replaceUrl:!!co})}),(0,Ki.b)(Ze=>{const zt=new fi(Ze.id,this.serializeUrl(Ze.extractedUrl),this.serializeUrl(Ze.urlAfterRedirects),Ze.targetSnapshot);this.triggerEvent(zt)}),(0,An.U)(Ze=>Object.assign(Object.assign({},Ze),{guards:Jo(Ze.targetSnapshot,Ze.currentSnapshot,this.rootContexts)})),function ki(g,x){return(0,_i.z)(C=>{const{targetSnapshot:U,currentSnapshot:Q,guards:{canActivateChecks:ye,canDeactivateChecks:Pe}}=C;return 0===Pe.length&&0===ye.length?(0,at.of)(Object.assign(Object.assign({},C),{guardsResult:!0})):function Go(g,x,C,U){return(0,st.D)(g).pipe((0,_i.z)(Q=>function Ua(g,x,C,U,Q){const ye=x&&x.routeConfig?x.routeConfig.canDeactivate:null;if(!ye||0===ye.length)return(0,at.of)(!0);const Pe=ye.map(Ze=>{const zt=bs(Ze,x,Q);let qn;if(function ds(g){return g&&eo(g.canDeactivate)}(zt))qn=fr(zt.canDeactivate(g,x,C,U));else{if(!eo(zt))throw new Error("Invalid CanDeactivate guard");qn=fr(zt(g,x,C,U))}return qn.pipe(an())});return(0,at.of)(Pe).pipe(Vs())}(Q.component,Q.route,C,x,U)),an(Q=>!0!==Q,!0))}(Pe,U,Q,g).pipe((0,_i.z)(Ze=>Ze&&function Xo(g){return"boolean"==typeof g}(Ze)?function os(g,x,C,U){return(0,st.D)(x).pipe((0,wi.b)(Q=>(0,kt.z)(function La(g,x){return null!==g&&x&&x(new yo(g)),(0,at.of)(!0)}(Q.route.parent,U),function Na(g,x){return null!==g&&x&&x(new no(g)),(0,at.of)(!0)}(Q.route,U),function yl(g,x,C){const U=x[x.length-1],ye=x.slice(0,x.length-1).reverse().map(Pe=>function ms(g){const x=g.routeConfig?g.routeConfig.canActivateChild:null;return x&&0!==x.length?{node:g,guards:x}:null}(Pe)).filter(Pe=>null!==Pe).map(Pe=>Ke(()=>{const Ze=Pe.guards.map(zt=>{const qn=bs(zt,Pe.node,C);let Pi;if(function Aa(g){return g&&eo(g.canActivateChild)}(qn))Pi=fr(qn.canActivateChild(U,g));else{if(!eo(qn))throw new Error("Invalid CanActivateChild guard");Pi=fr(qn(U,g))}return Pi.pipe(an())});return(0,at.of)(Ze).pipe(Vs())}));return(0,at.of)(ye).pipe(Vs())}(g,Q.path,C),function Qo(g,x,C){const U=x.routeConfig?x.routeConfig.canActivate:null;if(!U||0===U.length)return(0,at.of)(!0);const Q=U.map(ye=>Ke(()=>{const Pe=bs(ye,x,C);let Ze;if(function Pl(g){return g&&eo(g.canActivate)}(Pe))Ze=fr(Pe.canActivate(x,g));else{if(!eo(Pe))throw new Error("Invalid CanActivate guard");Ze=fr(Pe(x,g))}return Ze.pipe(an())}));return(0,at.of)(Q).pipe(Vs())}(g,Q.route,C))),an(Q=>!0!==Q,!0))}(U,ye,g,x):(0,at.of)(Ze)),(0,An.U)(Ze=>Object.assign(Object.assign({},C),{guardsResult:Ze})))})}(this.ngModule.injector,Ze=>this.triggerEvent(Ze)),(0,Ki.b)(Ze=>{if(As(Ze.guardsResult)){const qn=nn(`Redirecting to "${this.serializeUrl(Ze.guardsResult)}"`);throw qn.url=Ze.guardsResult,qn}const zt=new nr(Ze.id,this.serializeUrl(Ze.extractedUrl),this.serializeUrl(Ze.urlAfterRedirects),Ze.targetSnapshot,!!Ze.guardsResult);this.triggerEvent(zt)}),(0,se.h)(Ze=>!!Ze.guardsResult||(this.restoreHistory(Ze),this.cancelNavigationTransition(Ze,""),!1)),es(Ze=>{if(Ze.guards.canActivateChecks.length)return(0,at.of)(Ze).pipe((0,Ki.b)(zt=>{const qn=new Tr(zt.id,this.serializeUrl(zt.extractedUrl),this.serializeUrl(zt.urlAfterRedirects),zt.targetSnapshot);this.triggerEvent(qn)}),(0,Sn.w)(zt=>{let qn=!1;return(0,at.of)(zt).pipe(function Ia(g,x){return(0,_i.z)(C=>{const{targetSnapshot:U,guards:{canActivateChecks:Q}}=C;if(!Q.length)return(0,at.of)(C);let ye=0;return(0,st.D)(Q).pipe((0,wi.b)(Pe=>function bl(g,x,C,U){return function io(g,x,C,U){const Q=Fa(g);if(0===Q.length)return(0,at.of)({});const ye={};return(0,st.D)(Q).pipe((0,_i.z)(Pe=>function Ns(g,x,C,U){const Q=bs(g,x,U);return fr(Q.resolve?Q.resolve(x,C):Q(x,C))}(g[Pe],x,C,U).pipe((0,Ki.b)(Ze=>{ye[Pe]=Ze}))),Wi(1),(0,_i.z)(()=>Fa(ye).length===Q.length?(0,at.of)(ye):dn.E))}(g._resolve,g,x,U).pipe((0,An.U)(ye=>(g._resolvedData=ye,g.data=Object.assign(Object.assign({},g.data),Ss(g,C).resolve),null)))}(Pe.route,U,g,x)),(0,Ki.b)(()=>ye++),Wi(1),(0,_i.z)(Pe=>ye===Q.length?(0,at.of)(C):dn.E))})}(this.paramsInheritanceStrategy,this.ngModule.injector),(0,Ki.b)({next:()=>qn=!0,complete:()=>{qn||(this.restoreHistory(zt),this.cancelNavigationTransition(zt,"At least one route resolver didn't emit any value."))}}))}),(0,Ki.b)(zt=>{const qn=new Zr(zt.id,this.serializeUrl(zt.extractedUrl),this.serializeUrl(zt.urlAfterRedirects),zt.targetSnapshot);this.triggerEvent(qn)}))}),es(Ze=>{const{targetSnapshot:zt,id:qn,extractedUrl:Pi,rawUrl:Vi,extras:{skipLocationChange:ro,replaceUrl:co}}=Ze;return this.hooks.afterPreactivation(zt,{navigationId:qn,appliedUrlTree:Pi,rawUrlTree:Vi,skipLocationChange:!!ro,replaceUrl:!!co})}),(0,An.U)(Ze=>{const zt=function po(g,x,C){const U=xr(g,x._root,C?C._root:void 0);return new yi(U,x)}(this.routeReuseStrategy,Ze.targetSnapshot,Ze.currentRouterState);return Object.assign(Object.assign({},Ze),{targetRouterState:zt})}),(0,Ki.b)(Ze=>{this.currentUrlTree=Ze.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(Ze.urlAfterRedirects,Ze.rawUrl),this.routerState=Ze.targetRouterState,"deferred"===this.urlUpdateStrategy&&(Ze.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,Ze),this.browserUrlTree=Ze.urlAfterRedirects)}),((g,x,C)=>(0,An.U)(U=>(new qs(x,U.targetRouterState,U.currentRouterState,C).activate(g),U)))(this.rootContexts,this.routeReuseStrategy,Ze=>this.triggerEvent(Ze)),(0,Ki.b)({next(){ye=!0},complete(){ye=!0}}),function Yt(g){return(0,_t.e)((x,C)=>{try{x.subscribe(C)}finally{C.add(g)}})}(()=>{var Ze;ye||Pe||this.cancelNavigationTransition(Q,`Navigation ID ${Q.id} is not equal to the current navigation id ${this.navigationId}`),(null===(Ze=this.currentNavigation)||void 0===Ze?void 0:Ze.id)===Q.id&&(this.currentNavigation=null)}),(0,mr.K)(Ze=>{if(Pe=!0,function jn(g){return g&&g[Nn]}(Ze)){const zt=As(Ze.url);zt||(this.navigated=!0,this.restoreHistory(Q,!0));const qn=new Tt(Q.id,this.serializeUrl(Q.extractedUrl),Ze.message);U.next(qn),zt?setTimeout(()=>{const Pi=this.urlHandlingStrategy.merge(Ze.url,this.rawUrlTree),Vi={skipLocationChange:Q.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||Rl(Q.source)};this.scheduleNavigation(Pi,"imperative",null,Vi,{resolve:Q.resolve,reject:Q.reject,promise:Q.promise})},0):Q.resolve(!1)}else{this.restoreHistory(Q,!0);const zt=new En(Q.id,this.serializeUrl(Q.extractedUrl),Ze);U.next(zt);try{Q.resolve(this.errorHandler(Ze))}catch(qn){Q.reject(qn)}}return dn.E}))}))}resetRootComponentType(C){this.rootComponentType=C,this.routerState.root.component=this.rootComponentType}setTransition(C){this.transitions.next(Object.assign(Object.assign({},this.transitions.value),C))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(C=>{const U="popstate"===C.type?"popstate":"hashchange";"popstate"===U&&setTimeout(()=>{var Q;const ye={replaceUrl:!0},Pe=(null===(Q=C.state)||void 0===Q?void 0:Q.navigationId)?C.state:null;if(Pe){const zt=Object.assign({},Pe);delete zt.navigationId,delete zt.\u0275routerPageId,0!==Object.keys(zt).length&&(ye.state=zt)}const Ze=this.parseUrl(C.url);this.scheduleNavigation(Ze,U,Pe,ye)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(C){this.events.next(C)}resetConfig(C){I(C),this.config=C.map(ce),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(C,U={}){const{relativeTo:Q,queryParams:ye,fragment:Pe,queryParamsHandling:Ze,preserveFragment:zt}=U,qn=Q||this.routerState.root,Pi=zt?this.currentUrlTree.fragment:Pe;let Vi=null;switch(Ze){case"merge":Vi=Object.assign(Object.assign({},this.currentUrlTree.queryParams),ye);break;case"preserve":Vi=this.currentUrlTree.queryParams;break;default:Vi=ye||null}return null!==Vi&&(Vi=this.removeEmptyProps(Vi)),function vs(g,x,C,U,Q){if(0===C.length)return ya(x.root,x.root,x.root,U,Q);const ye=function Qs(g){if("string"==typeof g[0]&&1===g.length&&"/"===g[0])return new lo(!0,0,g);let x=0,C=!1;const U=g.reduce((Q,ye,Pe)=>{if("object"==typeof ye&&null!=ye){if(ye.outlets){const Ze={};return ei(ye.outlets,(zt,qn)=>{Ze[qn]="string"==typeof zt?zt.split("/"):zt}),[...Q,{outlets:Ze}]}if(ye.segmentPath)return[...Q,ye.segmentPath]}return"string"!=typeof ye?[...Q,ye]:0===Pe?(ye.split("/").forEach((Ze,zt)=>{0==zt&&"."===Ze||(0==zt&&""===Ze?C=!0:".."===Ze?x++:""!=Ze&&Q.push(Ze))}),Q):[...Q,ye]},[]);return new lo(C,x,U)}(C);if(ye.toRoot())return ya(x.root,x.root,new Xe([],{}),U,Q);const Pe=function ua(g,x,C){if(g.isAbsolute)return new va(x.root,!0,0);if(-1===C.snapshot._lastPathIndex){const ye=C.snapshot._urlSegment;return new va(ye,ye===x.root,0)}const U=Ir(g.commands[0])?0:1;return function $o(g,x,C){let U=g,Q=x,ye=C;for(;ye>Q;){if(ye-=Q,U=U.parent,!U)throw new Error("Invalid number of '../'");Q=U.segments.length}return new va(U,!1,Q-ye)}(C.snapshot._urlSegment,C.snapshot._lastPathIndex+U,g.numberOfDoubleDots)}(ye,x,g),Ze=Pe.processChildren?Qi(Pe.segmentGroup,Pe.index,ye.commands):ul(Pe.segmentGroup,Pe.index,ye.commands);return ya(x.root,Pe.segmentGroup,Ze,U,Q)}(qn,this.currentUrlTree,C,Vi,null!=Pi?Pi:null)}navigateByUrl(C,U={skipLocationChange:!1}){const Q=As(C)?C:this.parseUrl(C),ye=this.urlHandlingStrategy.merge(Q,this.rawUrlTree);return this.scheduleNavigation(ye,"imperative",null,U)}navigate(C,U={skipLocationChange:!1}){return function ja(g){for(let x=0;x<g.length;x++){const C=g[x];if(null==C)throw new Error(`The requested path contains ${C} segment at index ${x}`)}}(C),this.navigateByUrl(this.createUrlTree(C,U),U)}serializeUrl(C){return this.urlSerializer.serialize(C)}parseUrl(C){let U;try{U=this.urlSerializer.parse(C)}catch(Q){U=this.malformedUriErrorHandler(Q,this.urlSerializer,C)}return U}isActive(C,U){let Q;if(Q=!0===U?Object.assign({},fa):!1===U?Object.assign({},wl):U,As(C))return Ao(this.currentUrlTree,C,Q);const ye=this.parseUrl(C);return Ao(this.currentUrlTree,ye,Q)}removeEmptyProps(C){return Object.keys(C).reduce((U,Q)=>{const ye=C[Q];return null!=ye&&(U[Q]=ye),U},{})}processNavigations(){this.navigations.subscribe(C=>{this.navigated=!0,this.lastSuccessfulId=C.id,this.currentPageId=C.targetPageId,this.events.next(new oi(C.id,this.serializeUrl(C.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,C.resolve(!0)},C=>{this.console.warn(`Unhandled Navigation Error: ${C}`)})}scheduleNavigation(C,U,Q,ye,Pe){var Ze,zt;if(this.disposed)return Promise.resolve(!1);let qn,Pi,Vi;Pe?(qn=Pe.resolve,Pi=Pe.reject,Vi=Pe.promise):Vi=new Promise((Zs,Tl)=>{qn=Zs,Pi=Tl});const ro=++this.navigationId;let co;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(Q=this.location.getState()),co=Q&&Q.\u0275routerPageId?Q.\u0275routerPageId:ye.replaceUrl||ye.skipLocationChange?null!==(Ze=this.browserPageId)&&void 0!==Ze?Ze:0:(null!==(zt=this.browserPageId)&&void 0!==zt?zt:0)+1):co=0,this.setTransition({id:ro,targetPageId:co,source:U,restoredState:Q,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:C,extras:ye,resolve:qn,reject:Pi,promise:Vi,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),Vi.catch(Zs=>Promise.reject(Zs))}setBrowserUrl(C,U){const Q=this.urlSerializer.serialize(C),ye=Object.assign(Object.assign({},U.extras.state),this.generateNgRouterState(U.id,U.targetPageId));this.location.isCurrentPathEqualTo(Q)||U.extras.replaceUrl?this.location.replaceState(Q,"",ye):this.location.go(Q,"",ye)}restoreHistory(C,U=!1){var Q,ye;if("computed"===this.canceledNavigationResolution){const Pe=this.currentPageId-C.targetPageId;"popstate"!==C.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(Q=this.currentNavigation)||void 0===Q?void 0:Q.finalUrl)||0===Pe?this.currentUrlTree===(null===(ye=this.currentNavigation)||void 0===ye?void 0:ye.finalUrl)&&0===Pe&&(this.resetState(C),this.browserUrlTree=C.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(Pe)}else"replace"===this.canceledNavigationResolution&&(U&&this.resetState(C),this.resetUrlToCurrentUrlTree())}resetState(C){this.routerState=C.currentRouterState,this.currentUrlTree=C.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,C.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(C,U){const Q=new Tt(C.id,this.serializeUrl(C.extractedUrl),U);this.triggerEvent(Q),C.resolve(!1)}generateNgRouterState(C,U){return"computed"===this.canceledNavigationResolution?{navigationId:C,\u0275routerPageId:U}:{navigationId:C}}}return g.\u0275fac=function(C){D.$Z()},g.\u0275prov=D.Yz7({token:g,factory:g.\u0275fac}),g})();function Rl(g){return"imperative"!==g}let Za=(()=>{class g{constructor(C,U,Q,ye,Pe){this.router=C,this.route=U,this.tabIndexAttribute=Q,this.renderer=ye,this.el=Pe,this.commands=null,this.onChanges=new Qn.x,this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(C){if(null!=this.tabIndexAttribute)return;const U=this.renderer,Q=this.el.nativeElement;null!==C?U.setAttribute(Q,"tabindex",C):U.removeAttribute(Q,"tabindex")}ngOnChanges(C){this.onChanges.next(this)}set routerLink(C){null!=C?(this.commands=Array.isArray(C)?C:[C],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(){if(null===this.urlTree)return!0;const C={skipLocationChange:gt(this.skipLocationChange),replaceUrl:gt(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,C),!0}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:gt(this.preserveFragment)})}}return g.\u0275fac=function(C){return new(C||g)(D.Y36(Cr),D.Y36(us),D.$8M("tabindex"),D.Y36(D.Qsj),D.Y36(D.SBq))},g.\u0275dir=D.lG2({type:g,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(C,U){1&C&&D.NdJ("click",function(){return U.onClick()})},inputs:{queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[D.TTD]}),g})(),Ue=(()=>{class g{constructor(C,U,Q){this.router=C,this.route=U,this.locationStrategy=Q,this.commands=null,this.href=null,this.onChanges=new Qn.x,this.subscription=C.events.subscribe(ye=>{ye instanceof oi&&this.updateTargetUrlAndHref()})}set routerLink(C){this.commands=null!=C?Array.isArray(C)?C:[C]:null}ngOnChanges(C){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(C,U,Q,ye,Pe){if(0!==C||U||Q||ye||Pe||"string"==typeof this.target&&"_self"!=this.target||null===this.urlTree)return!0;const Ze={skipLocationChange:gt(this.skipLocationChange),replaceUrl:gt(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,Ze),!1}updateTargetUrlAndHref(){this.href=null!==this.urlTree?this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:gt(this.preserveFragment)})}}return g.\u0275fac=function(C){return new(C||g)(D.Y36(Cr),D.Y36(us),D.Y36(Ti.S$))},g.\u0275dir=D.lG2({type:g,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(C,U){1&C&&D.NdJ("click",function(ye){return U.onClick(ye.button,ye.ctrlKey,ye.shiftKey,ye.altKey,ye.metaKey)}),2&C&&D.uIk("target",U.target)("href",U.href,D.LSH)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[D.TTD]}),g})();function gt(g){return""===g||!!g}let Ut=(()=>{class g{constructor(C,U,Q,ye,Pe,Ze){this.router=C,this.element=U,this.renderer=Q,this.cdr=ye,this.link=Pe,this.linkWithHref=Ze,this.classes=[],this.isActive=!1,this.routerLinkActiveOptions={exact:!1},this.isActiveChange=new D.vpe,this.routerEventsSubscription=C.events.subscribe(zt=>{zt instanceof oi&&this.update()})}ngAfterContentInit(){(0,at.of)(this.links.changes,this.linksWithHrefs.changes,(0,at.of)(null)).pipe((0,ui.J)()).subscribe(C=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){var C;null===(C=this.linkInputChangesSubscription)||void 0===C||C.unsubscribe();const U=[...this.links.toArray(),...this.linksWithHrefs.toArray(),this.link,this.linkWithHref].filter(Q=>!!Q).map(Q=>Q.onChanges);this.linkInputChangesSubscription=(0,st.D)(U).pipe((0,ui.J)()).subscribe(Q=>{this.isActive!==this.isLinkActive(this.router)(Q)&&this.update()})}set routerLinkActive(C){const U=Array.isArray(C)?C:C.split(" ");this.classes=U.filter(Q=>!!Q)}ngOnChanges(C){this.update()}ngOnDestroy(){var C;this.routerEventsSubscription.unsubscribe(),null===(C=this.linkInputChangesSubscription)||void 0===C||C.unsubscribe()}update(){!this.links||!this.linksWithHrefs||!this.router.navigated||Promise.resolve().then(()=>{const C=this.hasActiveLinks();this.isActive!==C&&(this.isActive=C,this.cdr.markForCheck(),this.classes.forEach(U=>{C?this.renderer.addClass(this.element.nativeElement,U):this.renderer.removeClass(this.element.nativeElement,U)}),this.isActiveChange.emit(C))})}isLinkActive(C){const U=function vn(g){return!!g.paths}(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return Q=>!!Q.urlTree&&C.isActive(Q.urlTree,U)}hasActiveLinks(){const C=this.isLinkActive(this.router);return this.link&&C(this.link)||this.linkWithHref&&C(this.linkWithHref)||this.links.some(C)||this.linksWithHrefs.some(C)}}return g.\u0275fac=function(C){return new(C||g)(D.Y36(Cr),D.Y36(D.SBq),D.Y36(D.Qsj),D.Y36(D.sBO),D.Y36(Za,8),D.Y36(Ue,8))},g.\u0275dir=D.lG2({type:g,selectors:[["","routerLinkActive",""]],contentQueries:function(C,U,Q){if(1&C&&(D.Suo(Q,Za,5),D.Suo(Q,Ue,5)),2&C){let ye;D.iGM(ye=D.CRH())&&(U.links=ye),D.iGM(ye=D.CRH())&&(U.linksWithHrefs=ye)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],features:[D.TTD]}),g})();class Wt{}class Bn{preload(x,C){return C().pipe((0,mr.K)(()=>(0,at.of)(null)))}}class Vn{preload(x,C){return(0,at.of)(null)}}let ai=(()=>{class g{constructor(C,U,Q,ye){this.router=C,this.injector=Q,this.preloadingStrategy=ye,this.loader=new Pa(Q,U,zt=>C.triggerEvent(new Ur(zt)),zt=>C.triggerEvent(new Mn(zt)))}setUpPreloading(){this.subscription=this.router.events.pipe((0,se.h)(C=>C instanceof oi),(0,wi.b)(()=>this.preload())).subscribe(()=>{})}preload(){const C=this.injector.get(D.h0i);return this.processRoutes(C,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(C,U){const Q=[];for(const ye of U)if(ye.loadChildren&&!ye.canLoad&&ye._loadedConfig){const Pe=ye._loadedConfig;Q.push(this.processRoutes(Pe.module,Pe.routes))}else ye.loadChildren&&!ye.canLoad?Q.push(this.preloadConfig(C,ye)):ye.children&&Q.push(this.processRoutes(C,ye.children));return(0,st.D)(Q).pipe((0,ui.J)(),(0,An.U)(ye=>{}))}preloadConfig(C,U){return this.preloadingStrategy.preload(U,()=>(U._loadedConfig?(0,at.of)(U._loadedConfig):this.loader.load(C.injector,U)).pipe((0,_i.z)(ye=>(U._loadedConfig=ye,this.processRoutes(ye.module,ye.routes)))))}}return g.\u0275fac=function(C){return new(C||g)(D.LFG(Cr),D.LFG(D.Sil),D.LFG(D.zs3),D.LFG(Wt))},g.\u0275prov=D.Yz7({token:g,factory:g.\u0275fac}),g})(),Ii=(()=>{class g{constructor(C,U,Q={}){this.router=C,this.viewportScroller=U,this.options=Q,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},Q.scrollPositionRestoration=Q.scrollPositionRestoration||"disabled",Q.anchorScrolling=Q.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(C=>{C instanceof yn?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=C.navigationTrigger,this.restoredId=C.restoredState?C.restoredState.navigationId:0):C instanceof oi&&(this.lastId=C.id,this.scheduleScrollEvent(C,this.router.parseUrl(C.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(C=>{C instanceof cs&&(C.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(C.position):C.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(C.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(C,U){this.router.triggerEvent(new cs(C,"popstate"===this.lastSource?this.store[this.restoredId]:null,U))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return g.\u0275fac=function(C){D.$Z()},g.\u0275prov=D.Yz7({token:g,factory:g.\u0275fac}),g})();const Ni=new D.OlP("ROUTER_CONFIGURATION"),cr=new D.OlP("ROUTER_FORROOT_GUARD"),yr=[Ti.Ye,{provide:Kt,useClass:Dn},{provide:Cr,useFactory:function xo(g,x,C,U,Q,ye,Pe={},Ze,zt){const qn=new Cr(null,g,x,C,U,Q,Vr(ye));return Ze&&(qn.urlHandlingStrategy=Ze),zt&&(qn.routeReuseStrategy=zt),function Ts(g,x){g.errorHandler&&(x.errorHandler=g.errorHandler),g.malformedUriErrorHandler&&(x.malformedUriErrorHandler=g.malformedUriErrorHandler),g.onSameUrlNavigation&&(x.onSameUrlNavigation=g.onSameUrlNavigation),g.paramsInheritanceStrategy&&(x.paramsInheritanceStrategy=g.paramsInheritanceStrategy),g.relativeLinkResolution&&(x.relativeLinkResolution=g.relativeLinkResolution),g.urlUpdateStrategy&&(x.urlUpdateStrategy=g.urlUpdateStrategy),g.canceledNavigationResolution&&(x.canceledNavigationResolution=g.canceledNavigationResolution)}(Pe,qn),Pe.enableTracing&&qn.events.subscribe(Pi=>{var Vi,ro;null===(Vi=console.group)||void 0===Vi||Vi.call(console,`Router Event: ${Pi.constructor.name}`),console.log(Pi.toString()),console.log(Pi),null===(ro=console.groupEnd)||void 0===ro||ro.call(console)}),qn},deps:[Kt,fs,Ti.Ye,D.zs3,D.Sil,nl,Ni,[class Ps{},new D.FiY],[class Xa{},new D.FiY]]},fs,{provide:us,useFactory:function Hr(g){return g.routerState.root},deps:[Cr]},ai,Vn,Bn,{provide:Ni,useValue:{enableTracing:!1}}];function q(){return new D.PXZ("Router",Cr)}let J=(()=>{class g{constructor(C,U){}static forRoot(C,U){return{ngModule:g,providers:[yr,Jn(C),{provide:cr,useFactory:pn,deps:[[Cr,new D.FiY,new D.tp0]]},{provide:Ni,useValue:U||{}},{provide:Ti.S$,useFactory:ut,deps:[Ti.lw,[new D.tBr(Ti.mr),new D.FiY],Ni]},{provide:Ii,useFactory:Ie,deps:[Cr,Ti.EM,Ni]},{provide:Wt,useExisting:U&&U.preloadingStrategy?U.preloadingStrategy:Vn},{provide:D.PXZ,multi:!0,useFactory:q},[Os,{provide:D.ip1,multi:!0,useFactory:il,deps:[Os]},{provide:Ta,useFactory:rl,deps:[Os]},{provide:D.tb,multi:!0,useExisting:Ta}]]}}static forChild(C){return{ngModule:g,providers:[Jn(C)]}}}return g.\u0275fac=function(C){return new(C||g)(D.LFG(cr,8),D.LFG(Cr,8))},g.\u0275mod=D.oAB({type:g}),g.\u0275inj=D.cJS({}),g})();function Ie(g,x,C){return C.scrollOffset&&x.setOffset(C.scrollOffset),new Ii(g,x,C)}function ut(g,x,C={}){return C.useHash?new Ti.Do(g,x):new Ti.b0(g,x)}function pn(g){return"guarded"}function Jn(g){return[{provide:D.deG,multi:!0,useValue:g},{provide:nl,multi:!0,useValue:g}]}let Os=(()=>{class g{constructor(C){this.injector=C,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new Qn.x}appInitializer(){return this.injector.get(Ti.V_,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let U=null;const Q=new Promise(Ze=>U=Ze),ye=this.injector.get(Cr),Pe=this.injector.get(Ni);return"disabled"===Pe.initialNavigation?(ye.setUpLocationChangeListener(),U(!0)):"enabled"===Pe.initialNavigation||"enabledBlocking"===Pe.initialNavigation?(ye.hooks.afterPreactivation=()=>this.initNavigation?(0,at.of)(null):(this.initNavigation=!0,U(!0),this.resultOfPreactivationDone),ye.initialNavigation()):U(!0),Q})}bootstrapListener(C){const U=this.injector.get(Ni),Q=this.injector.get(ai),ye=this.injector.get(Ii),Pe=this.injector.get(Cr),Ze=this.injector.get(D.z2F);C===Ze.components[0]&&(("enabledNonBlocking"===U.initialNavigation||void 0===U.initialNavigation)&&Pe.initialNavigation(),Q.setUpPreloading(),ye.init(),Pe.resetRootComponentType(Ze.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return g.\u0275fac=function(C){return new(C||g)(D.LFG(D.zs3))},g.\u0275prov=D.Yz7({token:g,factory:g.\u0275fac}),g})();function il(g){return g.appInitializer.bind(g)}function rl(g){return g.bootstrapListener.bind(g)}const Ta=new D.OlP("Router Initializer")},5436:(Bi,Zt,fe)=>{"use strict";fe.d(Zt,{jt:()=>Jc,TH:()=>Oa,Vi:()=>jd,iD:()=>Th,IJ:()=>_d,M2:()=>Vd});var D=fe(4893),N=fe(9808),A=fe(8306),l=fe(8421);const{isArray:oe}=Array;function lt(w){return 1===w.length&&oe(w[0])?w[0]:w}var At=fe(5403);function Ke(...w){return 1===(w=lt(w)).length?(0,l.Xf)(w[0]):new A.y(function ct(w){return k=>{let _=[];for(let B=0;_&&!k.closed&&B<w.length;B++)_.push((0,l.Xf)(w[B]).subscribe((0,At.x)(k,ie=>{if(_){for(let ve=0;ve<_.length;ve++)ve!==B&&_[ve].unsubscribe();_=null}k.next(ie)})))}}(w))}var _t=fe(5032);new A.y(_t.Z);var Bt=fe(515),st=fe(3269);function at(...w){const k=(0,st.jO)(w),_=lt(w);return _.length?new A.y(B=>{let ie=_.map(()=>[]),ve=_.map(()=>!1);B.add(()=>{ie=ve=null});for(let ht=0;!B.closed&&ht<_.length;ht++)(0,l.Xf)(_[ht]).subscribe((0,At.x)(B,Ht=>{if(ie[ht].push(Ht),ie.every(jt=>jt.length)){const jt=ie.map(xn=>xn.shift());B.next(k?k(...jt):jt),ie.some((xn,Fn)=>!xn.length&&ve[Fn])&&B.complete()}},()=>{ve[ht]=!0,!ie[ht].length&&B.complete()}));return()=>{ie=ve=null}}):Bt.E}var ft=fe(9646),tn=fe(7579),kt=fe(4968),dn=fe(5963),Cn=(fe(1135),fe(9841),fe(7272)),Wi=fe(4482),ii=fe(4671);function kn(...w){const k=(0,st.jO)(w);return(0,Wi.e)((_,B)=>{const ie=w.length,ve=new Array(ie);let ht=w.map(()=>!1),Ht=!1;for(let jt=0;jt<ie;jt++)(0,l.Xf)(w[jt]).subscribe((0,At.x)(B,xn=>{ve[jt]=xn,!Ht&&!ht[jt]&&(ht[jt]=!0,(Ht=ht.every(ii.y))&&(ht=null))},_t.Z));_.subscribe((0,At.x)(B,jt=>{if(Ht){const xn=[jt,...ve];B.next(k?k(...xn):xn)}}))})}var Ci=fe(9300),$t=fe(2722),en=fe(5698),an=fe(4004),Sn=(fe(8675),fe(1884),fe(3900)),Mi=fe(8505),mr=fe(1005),wi=fe(3075),_i={left:"right",right:"left",bottom:"top",top:"bottom"};function Ki(w){return w.replace(/left|right|bottom|top/g,function(k){return _i[k]})}function ui(w){return w.split("-")[0]}var Ti={start:"end",end:"start"};function Br(w){return w.replace(/start|end/g,function(k){return Ti[k]})}var yn="top",oi="bottom",Tt="right",En="left",si="auto",fi=[yn,oi,Tt,En],nr="start",Tr="end",Ur="viewport",Mn="popper",qr=fi.reduce(function(w,k){return w.concat([k+"-"+nr,k+"-"+Tr])},[]),no=[].concat(fi,[si]).reduce(function(w,k){return w.concat([k,k+"-"+nr,k+"-"+Tr])},[]),to=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function Li(w){if(null==w)return window;if("[object Window]"!==w.toString()){var k=w.ownerDocument;return k&&k.defaultView||window}return w}function $r(w){return w instanceof Li(w).Element||w instanceof Element}function Vr(w){return w instanceof Li(w).HTMLElement||w instanceof HTMLElement}function fo(w){return"undefined"!=typeof ShadowRoot&&(w instanceof Li(w).ShadowRoot||w instanceof ShadowRoot)}function vo(w){return(($r(w)?w.ownerDocument:w.document)||window.document).documentElement}var ei=Math.max,fr=Math.min,sr=Math.round;function Io(){var w=navigator.userAgentData;return null!=w&&w.brands?w.brands.map(function(k){return k.brand+"/"+k.version}).join(" "):navigator.userAgent}function ir(){return!/^((?!chrome|android).)*safari/i.test(Io())}function Ao(w,k,_){void 0===k&&(k=!1),void 0===_&&(_=!1);var B=w.getBoundingClientRect(),ie=1,ve=1;k&&Vr(w)&&(ie=w.offsetWidth>0&&sr(B.width)/w.offsetWidth||1,ve=w.offsetHeight>0&&sr(B.height)/w.offsetHeight||1);var Ht=($r(w)?Li(w):window).visualViewport,jt=!ir()&&_,xn=(B.left+(jt&&Ht?Ht.offsetLeft:0))/ie,Fn=(B.top+(jt&&Ht?Ht.offsetTop:0))/ve,or=B.width/ie,qi=B.height/ve;return{width:or,height:qi,top:Fn,right:xn+or,bottom:Fn+qi,left:xn,x:xn,y:Fn}}function Zo(w){var k=Li(w);return{scrollLeft:k.pageXOffset,scrollTop:k.pageYOffset}}function To(w){return Ao(vo(w)).left+Zo(w).scrollLeft}function qe(w){return Li(w).getComputedStyle(w)}function Me(w){return w?(w.nodeName||"").toLowerCase():null}function We(w){return"html"===Me(w)?w:w.assignedSlot||w.parentNode||(fo(w)?w.host:null)||vo(w)}function Xe(w){var k=qe(w);return/auto|scroll|overlay|hidden/.test(k.overflow+k.overflowY+k.overflowX)}function xt(w){return["html","body","#document"].indexOf(Me(w))>=0?w.ownerDocument.body:Vr(w)&&Xe(w)?w:xt(We(w))}function Gt(w,k){var _;void 0===k&&(k=[]);var B=xt(w),ie=B===(null==(_=w.ownerDocument)?void 0:_.body),ve=Li(B),ht=ie?[ve].concat(ve.visualViewport||[],Xe(B)?B:[]):B,Ht=k.concat(ht);return ie?Ht:Ht.concat(Gt(We(ht)))}function Rt(w){return["table","td","th"].indexOf(Me(w))>=0}function nt(w){return Vr(w)&&"fixed"!==qe(w).position?w.offsetParent:null}function Dn(w){for(var k=Li(w),_=nt(w);_&&Rt(_)&&"static"===qe(_).position;)_=nt(_);return _&&("html"===Me(_)||"body"===Me(_)&&"static"===qe(_).position)?k:_||function Kt(w){var k=/firefox/i.test(Io());if(/Trident/i.test(Io())&&Vr(w)&&"fixed"===qe(w).position)return null;var ie=We(w);for(fo(ie)&&(ie=ie.host);Vr(ie)&&["html","body"].indexOf(Me(ie))<0;){var ve=qe(ie);if("none"!==ve.transform||"none"!==ve.perspective||"paint"===ve.contain||-1!==["transform","perspective"].indexOf(ve.willChange)||k&&"filter"===ve.willChange||k&&ve.filter&&"none"!==ve.filter)return ie;ie=ie.parentNode}return null}(w)||k}function xe(w,k){var _=k.getRootNode&&k.getRootNode();if(w.contains(k))return!0;if(_&&fo(_)){var B=k;do{if(B&&w.isSameNode(B))return!0;B=B.parentNode||B.host}while(B)}return!1}function Se(w){return Object.assign({},w,{left:w.x,top:w.y,right:w.x+w.width,bottom:w.y+w.height})}function dt(w,k,_){return k===Ur?Se(function Ds(w,k){var _=Li(w),B=vo(w),ie=_.visualViewport,ve=B.clientWidth,ht=B.clientHeight,Ht=0,jt=0;if(ie){ve=ie.width,ht=ie.height;var xn=ir();(xn||!xn&&"fixed"===k)&&(Ht=ie.offsetLeft,jt=ie.offsetTop)}return{width:ve,height:ht,x:Ht+To(w),y:jt}}(w,_)):$r(k)?function Be(w,k){var _=Ao(w,!1,"fixed"===k);return _.top=_.top+w.clientTop,_.left=_.left+w.clientLeft,_.bottom=_.top+w.clientHeight,_.right=_.left+w.clientWidth,_.width=w.clientWidth,_.height=w.clientHeight,_.x=_.left,_.y=_.top,_}(k,_):Se(function Te(w){var k,_=vo(w),B=Zo(w),ie=null==(k=w.ownerDocument)?void 0:k.body,ve=ei(_.scrollWidth,_.clientWidth,ie?ie.scrollWidth:0,ie?ie.clientWidth:0),ht=ei(_.scrollHeight,_.clientHeight,ie?ie.scrollHeight:0,ie?ie.clientHeight:0),Ht=-B.scrollLeft+To(w),jt=-B.scrollTop;return"rtl"===qe(ie||_).direction&&(Ht+=ei(_.clientWidth,ie?ie.clientWidth:0)-ve),{width:ve,height:ht,x:Ht,y:jt}}(vo(w)))}function un(w){return w.split("-")[1]}function In(w){return["top","bottom"].indexOf(w)>=0?"x":"y"}function Pn(w){var jt,k=w.reference,_=w.element,B=w.placement,ie=B?ui(B):null,ve=B?un(B):null,ht=k.x+k.width/2-_.width/2,Ht=k.y+k.height/2-_.height/2;switch(ie){case yn:jt={x:ht,y:k.y-_.height};break;case oi:jt={x:ht,y:k.y+k.height};break;case Tt:jt={x:k.x+k.width,y:Ht};break;case En:jt={x:k.x-_.width,y:Ht};break;default:jt={x:k.x,y:k.y}}var xn=ie?In(ie):null;if(null!=xn){var Fn="y"===xn?"height":"width";switch(ve){case nr:jt[xn]=jt[xn]-(k[Fn]/2-_[Fn]/2);break;case Tr:jt[xn]=jt[xn]+(k[Fn]/2-_[Fn]/2)}}return jt}function Xn(w){return Object.assign({},{top:0,right:0,bottom:0,left:0},w)}function qt(w,k){return k.reduce(function(_,B){return _[B]=w,_},{})}function Gr(w,k){void 0===k&&(k={});var B=k.placement,ie=void 0===B?w.placement:B,ve=k.strategy,ht=void 0===ve?w.strategy:ve,Ht=k.boundary,jt=void 0===Ht?"clippingParents":Ht,xn=k.rootBoundary,Fn=void 0===xn?Ur:xn,or=k.elementContext,qi=void 0===or?Mn:or,ur=k.altBoundary,uo=void 0!==ur&&ur,Yr=k.padding,Do=void 0===Yr?0:Yr,Wo=Xn("number"!=typeof Do?Do:qt(Do,fi)),pa=w.rects.popper,ns=w.elements[uo?qi===Mn?"reference":Mn:qi],Ho=function rn(w,k,_,B){var ie="clippingParents"===k?function Pt(w){var k=Gt(We(w)),B=["absolute","fixed"].indexOf(qe(w).position)>=0&&Vr(w)?Dn(w):w;return $r(B)?k.filter(function(ie){return $r(ie)&&xe(ie,B)&&"body"!==Me(ie)}):[]}(w):[].concat(k),ve=[].concat(ie,[_]),Ht=ve.reduce(function(jt,xn){var Fn=dt(w,xn,B);return jt.top=ei(Fn.top,jt.top),jt.right=fr(Fn.right,jt.right),jt.bottom=fr(Fn.bottom,jt.bottom),jt.left=ei(Fn.left,jt.left),jt},dt(w,ve[0],B));return Ht.width=Ht.right-Ht.left,Ht.height=Ht.bottom-Ht.top,Ht.x=Ht.left,Ht.y=Ht.top,Ht}($r(ns)?ns:ns.contextElement||vo(w.elements.popper),jt,Fn,ht),Yo=Ao(w.elements.reference),oa=Pn({reference:Yo,element:pa,strategy:"absolute",placement:ie}),as=Se(Object.assign({},pa,oa)),Ar=qi===Mn?as:Yo,So={top:Ho.top-Ar.top+Wo.top,bottom:Ar.bottom-Ho.bottom+Wo.bottom,left:Ho.left-Ar.left+Wo.left,right:Ar.right-Ho.right+Wo.right},ma=w.modifiersData.offset;if(qi===Mn&&ma){var rc=ma[ie];Object.keys(So).forEach(function(qa){var el=[Tt,oi].indexOf(qa)>=0?1:-1,pc=[yn,oi].indexOf(qa)>=0?"y":"x";So[qa]+=rc[pc]*el})}return So}const hr={name:"flip",enabled:!0,phase:"main",fn:function ti(w){var k=w.state,_=w.options,B=w.name;if(!k.modifiersData[B]._skip){for(var ie=_.mainAxis,ve=void 0===ie||ie,ht=_.altAxis,Ht=void 0===ht||ht,jt=_.fallbackPlacements,xn=_.padding,Fn=_.boundary,or=_.rootBoundary,qi=_.altBoundary,ur=_.flipVariations,uo=void 0===ur||ur,Yr=_.allowedAutoPlacements,Do=k.options.placement,Wo=ui(Do),pa=jt||(Wo!==Do&&uo?function Rn(w){if(ui(w)===si)return[];var k=Ki(w);return[Br(w),k,Br(k)]}(Do):[Ki(Do)]),ns=[Do].concat(pa).reduce(function(Rh,oc){return Rh.concat(ui(oc)===si?function gr(w,k){void 0===k&&(k={});var ie=k.boundary,ve=k.rootBoundary,ht=k.padding,Ht=k.flipVariations,jt=k.allowedAutoPlacements,xn=void 0===jt?no:jt,Fn=un(k.placement),or=Fn?Ht?qr:qr.filter(function(uo){return un(uo)===Fn}):fi,qi=or.filter(function(uo){return xn.indexOf(uo)>=0});0===qi.length&&(qi=or);var ur=qi.reduce(function(uo,Yr){return uo[Yr]=Gr(w,{placement:Yr,boundary:ie,rootBoundary:ve,padding:ht})[ui(Yr)],uo},{});return Object.keys(ur).sort(function(uo,Yr){return ur[uo]-ur[Yr]})}(k,{placement:oc,boundary:Fn,rootBoundary:or,padding:xn,flipVariations:uo,allowedAutoPlacements:Yr}):oc)},[]),Ho=k.rects.reference,Yo=k.rects.popper,oa=new Map,as=!0,Ar=ns[0],So=0;So<ns.length;So++){var ma=ns[So],rc=ui(ma),qa=un(ma)===nr,el=[yn,oi].indexOf(rc)>=0,pc=el?"width":"height",Yl=Gr(k,{placement:ma,boundary:Fn,rootBoundary:or,altBoundary:qi,padding:xn}),Kl=el?qa?Tt:En:qa?oi:yn;Ho[pc]>Yo[pc]&&(Kl=Ki(Kl));var Vl=Ki(Kl),Ec=[];if(ve&&Ec.push(Yl[rc]<=0),Ht&&Ec.push(Yl[Kl]<=0,Yl[Vl]<=0),Ec.every(function(Rh){return Rh})){Ar=ma,as=!1;break}oa.set(ma,Ec)}if(as)for(var Ph=function(oc){var yu=ns.find(function(vu){var Cc=oa.get(vu);if(Cc)return Cc.slice(0,oc).every(function(bu){return bu})});if(yu)return Ar=yu,"break"},Oh=uo?3:1;Oh>0&&"break"!==Ph(Oh);Oh--);k.placement!==Ar&&(k.modifiersData[B]._skip=!0,k.placement=Ar,k.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function Mr(w,k,_){return ei(w,fr(k,_))}function Wn(w){var k=Ao(w),_=w.offsetWidth,B=w.offsetHeight;return Math.abs(k.width-_)<=1&&(_=k.width),Math.abs(k.height-B)<=1&&(B=k.height),{x:w.offsetLeft,y:w.offsetTop,width:_,height:B}}const Xi={name:"preventOverflow",enabled:!0,phase:"main",fn:function Fi(w){var k=w.state,_=w.options,B=w.name,ie=_.mainAxis,ve=void 0===ie||ie,ht=_.altAxis,Ht=void 0!==ht&&ht,qi=_.tether,ur=void 0===qi||qi,uo=_.tetherOffset,Yr=void 0===uo?0:uo,Do=Gr(k,{boundary:_.boundary,rootBoundary:_.rootBoundary,padding:_.padding,altBoundary:_.altBoundary}),Wo=ui(k.placement),jo=un(k.placement),pa=!jo,ns=In(Wo),Ho=function Er(w){return"x"===w?"y":"x"}(ns),Yo=k.modifiersData.popperOffsets,oa=k.rects.reference,as=k.rects.popper,Ar="function"==typeof Yr?Yr(Object.assign({},k.rects,{placement:k.placement})):Yr,So="number"==typeof Ar?{mainAxis:Ar,altAxis:Ar}:Object.assign({mainAxis:0,altAxis:0},Ar),ma=k.modifiersData.offset?k.modifiersData.offset[k.placement]:null,rc={x:0,y:0};if(Yo){if(ve){var qa,el="y"===ns?yn:En,pc="y"===ns?oi:Tt,Yl="y"===ns?"height":"width",Kl=Yo[ns],Vl=Kl+Do[el],Ec=Kl-Do[pc],Uu=ur?-as[Yl]/2:0,Ph=jo===nr?oa[Yl]:as[Yl],Oh=jo===nr?-as[Yl]:-oa[Yl],tu=k.elements.arrow,Rh=ur&&tu?Wn(tu):{width:0,height:0},oc=k.modifiersData["arrow#persistent"]?k.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},yu=oc[el],vu=oc[pc],Cc=Mr(0,oa[Yl],Rh[Yl]),bu=pa?oa[Yl]/2-Uu-Cc-yu-So.mainAxis:Ph-Cc-yu-So.mainAxis,tg=pa?-oa[Yl]/2+Uu+Cc+vu+So.mainAxis:Oh+Cc+vu+So.mainAxis,rf=k.elements.arrow&&Dn(k.elements.arrow),Jf=null!=(qa=null==ma?void 0:ma[ns])?qa:0,Qf=Kl+tg-Jf,ep=Mr(ur?fr(Vl,Kl+bu-Jf-(rf?"y"===ns?rf.clientTop||0:rf.clientLeft||0:0)):Vl,Kl,ur?ei(Ec,Qf):Ec);Yo[ns]=ep,rc[ns]=ep-Kl}if(Ht){var Vu,nu=Yo[Ho],kh="y"===Ho?"height":"width",yd=nu+Do["x"===ns?yn:En],Kp=nu-Do["x"===ns?oi:Tt],xu=-1!==[yn,En].indexOf(Wo),vd=null!=(Vu=null==ma?void 0:ma[Ho])?Vu:0,Xp=xu?yd:nu-oa[kh]-as[kh]-vd+So.altAxis,Jp=xu?nu+oa[kh]+as[kh]-vd-So.altAxis:Kp,Nh=ur&&xu?function Nr(w,k,_){var B=Mr(w,k,_);return B>_?_:B}(Xp,nu,Jp):Mr(ur?Xp:yd,nu,ur?Jp:Kp);Yo[Ho]=Nh,rc[Ho]=Nh-nu}k.modifiersData[B]=rc}},requiresIfExists:["offset"]},Ko={name:"arrow",enabled:!0,phase:"main",fn:function yi(w){var k,_=w.state,B=w.name,ie=w.options,ve=_.elements.arrow,ht=_.modifiersData.popperOffsets,Ht=ui(_.placement),jt=In(Ht),Fn=[En,Tt].indexOf(Ht)>=0?"height":"width";if(ve&&ht){var or=function(k,_){return Xn("number"!=typeof(k="function"==typeof k?k(Object.assign({},_.rects,{placement:_.placement})):k)?k:qt(k,fi))}(ie.padding,_),qi=Wn(ve),ur="y"===jt?yn:En,uo="y"===jt?oi:Tt,Yr=_.rects.reference[Fn]+_.rects.reference[jt]-ht[jt]-_.rects.popper[Fn],Do=ht[jt]-_.rects.reference[jt],Wo=Dn(ve),jo=Wo?"y"===jt?Wo.clientHeight||0:Wo.clientWidth||0:0,Yo=jo/2-qi[Fn]/2+(Yr/2-Do/2),oa=Mr(or[ur],Yo,jo-qi[Fn]-or[uo]);_.modifiersData[B]=((k={})[jt]=oa,k.centerOffset=oa-Yo,k)}},effect:function Ji(w){var k=w.state,B=w.options.element,ie=void 0===B?"[data-popper-arrow]":B;null!=ie&&("string"==typeof ie&&!(ie=k.elements.popper.querySelector(ie))||!xe(k.elements.popper,ie)||(k.elements.arrow=ie))},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function lr(w,k,_){void 0===_&&(_=!1);var B=Vr(k),ie=Vr(k)&&function Hi(w){var k=w.getBoundingClientRect(),_=sr(k.width)/w.offsetWidth||1,B=sr(k.height)/w.offsetHeight||1;return 1!==_||1!==B}(k),ve=vo(k),ht=Ao(w,ie,_),Ht={scrollLeft:0,scrollTop:0},jt={x:0,y:0};return(B||!B&&!_)&&(("body"!==Me(k)||Xe(ve))&&(Ht=function Ss(w){return w!==Li(w)&&Vr(w)?function us(w){return{scrollLeft:w.scrollLeft,scrollTop:w.scrollTop}}(w):Zo(w)}(k)),Vr(k)?((jt=Ao(k,!0)).x+=k.clientLeft,jt.y+=k.clientTop):ve&&(jt.x=To(ve))),{x:ht.left+Ht.scrollLeft-jt.x,y:ht.top+Ht.scrollTop-jt.y,width:ht.width,height:ht.height}}function ks(w){var k=new Map,_=new Set,B=[];function ie(ve){_.add(ve.name),[].concat(ve.requires||[],ve.requiresIfExists||[]).forEach(function(Ht){if(!_.has(Ht)){var jt=k.get(Ht);jt&&ie(jt)}}),B.push(ve)}return w.forEach(function(ve){k.set(ve.name,ve)}),w.forEach(function(ve){_.has(ve.name)||ie(ve)}),B}function Dr(w){var k;return function(){return k||(k=new Promise(function(_){Promise.resolve().then(function(){k=void 0,_(w())})})),k}}var xr={placement:"bottom",modifiers:[],strategy:"absolute"};function zr(){for(var w=arguments.length,k=new Array(w),_=0;_<w;_++)k[_]=arguments[_];return!k.some(function(B){return!(B&&"function"==typeof B.getBoundingClientRect)})}function rs(w){void 0===w&&(w={});var _=w.defaultModifiers,B=void 0===_?[]:_,ie=w.defaultOptions,ve=void 0===ie?xr:ie;return function(Ht,jt,xn){void 0===xn&&(xn=ve);var Fn={placement:"bottom",orderedModifiers:[],options:Object.assign({},xr,ve),modifiersData:{},elements:{reference:Ht,popper:jt},attributes:{},styles:{}},or=[],qi=!1,ur={state:Fn,setOptions:function(Wo){var jo="function"==typeof Wo?Wo(Fn.options):Wo;Yr(),Fn.options=Object.assign({},ve,Fn.options,jo),Fn.scrollParents={reference:$r(Ht)?Gt(Ht):Ht.contextElement?Gt(Ht.contextElement):[],popper:Gt(jt)};var pa=function Po(w){var k=ks(w);return to.reduce(function(_,B){return _.concat(k.filter(function(ie){return ie.phase===B}))},[])}(function Uo(w){var k=w.reduce(function(_,B){var ie=_[B.name];return _[B.name]=ie?Object.assign({},ie,B,{options:Object.assign({},ie.options,B.options),data:Object.assign({},ie.data,B.data)}):B,_},{});return Object.keys(k).map(function(_){return k[_]})}([].concat(B,Fn.options.modifiers)));return Fn.orderedModifiers=pa.filter(function(ma){return ma.enabled}),function uo(){Fn.orderedModifiers.forEach(function(Do){var jo=Do.options,ns=Do.effect;if("function"==typeof ns){var Ho=ns({state:Fn,name:Do.name,instance:ur,options:void 0===jo?{}:jo});or.push(Ho||function(){})}})}(),ur.update()},forceUpdate:function(){if(!qi){var Wo=Fn.elements,jo=Wo.reference,pa=Wo.popper;if(zr(jo,pa)){Fn.rects={reference:lr(jo,Dn(pa),"fixed"===Fn.options.strategy),popper:Wn(pa)},Fn.reset=!1,Fn.placement=Fn.options.placement,Fn.orderedModifiers.forEach(function(ma){return Fn.modifiersData[ma.name]=Object.assign({},ma.data)});for(var Ho=0;Ho<Fn.orderedModifiers.length;Ho++)if(!0!==Fn.reset){var Yo=Fn.orderedModifiers[Ho],oa=Yo.fn,as=Yo.options;"function"==typeof oa&&(Fn=oa({state:Fn,options:void 0===as?{}:as,name:Yo.name,instance:ur})||Fn)}else Fn.reset=!1,Ho=-1}}},update:Dr(function(){return new Promise(function(Do){ur.forceUpdate(),Do(Fn)})}),destroy:function(){Yr(),qi=!0}};if(!zr(Ht,jt))return ur;function Yr(){or.forEach(function(Do){return Do()}),or=[]}return ur.setOptions(xn).then(function(Do){!qi&&xn.onFirstUpdate&&xn.onFirstUpdate(Do)}),ur}}var Ir={passive:!0},Qs={top:"auto",right:"auto",bottom:"auto",left:"auto"};function ua(w){var k,_=w.popper,B=w.popperRect,ie=w.placement,ve=w.variation,ht=w.offsets,Ht=w.position,jt=w.gpuAcceleration,xn=w.adaptive,Fn=w.roundOffsets,or=w.isFixed,qi=ht.x,ur=void 0===qi?0:qi,uo=ht.y,Yr=void 0===uo?0:uo,Do="function"==typeof Fn?Fn({x:ur,y:Yr}):{x:ur,y:Yr};ur=Do.x,Yr=Do.y;var Wo=ht.hasOwnProperty("x"),jo=ht.hasOwnProperty("y"),pa=En,ns=yn,Ho=window;if(xn){var Yo=Dn(_),oa="clientHeight",as="clientWidth";Yo===Li(_)&&"static"!==qe(Yo=vo(_)).position&&"absolute"===Ht&&(oa="scrollHeight",as="scrollWidth"),Yo=Yo,(ie===yn||(ie===En||ie===Tt)&&ve===Tr)&&(ns=oi,Yr-=(or&&Yo===Ho&&Ho.visualViewport?Ho.visualViewport.height:Yo[oa])-B.height,Yr*=jt?1:-1),ie!==En&&(ie!==yn&&ie!==oi||ve!==Tr)||(pa=Tt,ur-=(or&&Yo===Ho&&Ho.visualViewport?Ho.visualViewport.width:Yo[as])-B.width,ur*=jt?1:-1)}var qa,ma=Object.assign({position:Ht},xn&&Qs),rc=!0===Fn?function va(w){var _=w.y,ie=window.devicePixelRatio||1;return{x:sr(w.x*ie)/ie||0,y:sr(_*ie)/ie||0}}({x:ur,y:Yr}):{x:ur,y:Yr};return ur=rc.x,Yr=rc.y,Object.assign({},ma,jt?((qa={})[ns]=jo?"0":"",qa[pa]=Wo?"0":"",qa.transform=(Ho.devicePixelRatio||1)<=1?"translate("+ur+"px, "+Yr+"px)":"translate3d("+ur+"px, "+Yr+"px, 0)",qa):((k={})[ns]=jo?Yr+"px":"",k[pa]=Wo?ur+"px":"",k.transform="",k))}var da=rs({defaultModifiers:[{name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function Vo(w){var k=w.state,_=w.instance,B=w.options,ie=B.scroll,ve=void 0===ie||ie,ht=B.resize,Ht=void 0===ht||ht,jt=Li(k.elements.popper),xn=[].concat(k.scrollParents.reference,k.scrollParents.popper);return ve&&xn.forEach(function(Fn){Fn.addEventListener("scroll",_.update,Ir)}),Ht&&jt.addEventListener("resize",_.update,Ir),function(){ve&&xn.forEach(function(Fn){Fn.removeEventListener("scroll",_.update,Ir)}),Ht&&jt.removeEventListener("resize",_.update,Ir)}},data:{}},{name:"popperOffsets",enabled:!0,phase:"read",fn:function hs(w){var k=w.state;k.modifiersData[w.name]=Pn({reference:k.rects.reference,element:k.rects.popper,strategy:"absolute",placement:k.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function $o(w){var k=w.state,_=w.options,B=_.gpuAcceleration,ie=void 0===B||B,ve=_.adaptive,ht=void 0===ve||ve,Ht=_.roundOffsets,jt=void 0===Ht||Ht,Fn={placement:ui(k.placement),variation:un(k.placement),popper:k.elements.popper,popperRect:k.rects.popper,gpuAcceleration:ie,isFixed:"fixed"===k.options.strategy};null!=k.modifiersData.popperOffsets&&(k.styles.popper=Object.assign({},k.styles.popper,ua(Object.assign({},Fn,{offsets:k.modifiersData.popperOffsets,position:k.options.strategy,adaptive:ht,roundOffsets:jt})))),null!=k.modifiersData.arrow&&(k.styles.arrow=Object.assign({},k.styles.arrow,ua(Object.assign({},Fn,{offsets:k.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:jt})))),k.attributes.popper=Object.assign({},k.attributes.popper,{"data-popper-placement":k.placement})},data:{}},{name:"applyStyles",enabled:!0,phase:"write",fn:function ul(w){var k=w.state;Object.keys(k.elements).forEach(function(_){var B=k.styles[_]||{},ie=k.attributes[_]||{},ve=k.elements[_];!Vr(ve)||!Me(ve)||(Object.assign(ve.style,B),Object.keys(ie).forEach(function(ht){var Ht=ie[ht];!1===Ht?ve.removeAttribute(ht):ve.setAttribute(ht,!0===Ht?"":Ht)}))})},effect:function Qi(w){var k=w.state,_={popper:{position:k.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(k.elements.popper.style,_.popper),k.styles=_,k.elements.arrow&&Object.assign(k.elements.arrow.style,_.arrow),function(){Object.keys(k.elements).forEach(function(B){var ie=k.elements[B],ve=k.attributes[B]||{},Ht=Object.keys(k.styles.hasOwnProperty(B)?k.styles[B]:_[B]).reduce(function(jt,xn){return jt[xn]="",jt},{});!Vr(ie)||!Me(ie)||(Object.assign(ie.style,Ht),Object.keys(ve).forEach(function(jt){ie.removeAttribute(jt)}))})}},requires:["computeStyles"]}]});const Sa={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function Us(w){var k=w.state,B=w.name,ie=w.options.offset,ve=void 0===ie?[0,0]:ie,ht=no.reduce(function(Fn,or){return Fn[or]=function Da(w,k,_){var B=ui(w),ie=[En,yn].indexOf(B)>=0?-1:1,ve="function"==typeof _?_(Object.assign({},k,{placement:w})):_,ht=ve[0],Ht=ve[1];return ht=ht||0,Ht=(Ht||0)*ie,[En,Tt].indexOf(B)>=0?{x:Ht,y:ht}:{x:ht,y:Ht}}(or,k.rects,ve),Fn},{}),Ht=ht[k.placement],xn=Ht.y;null!=k.modifiersData.popperOffsets&&(k.modifiersData.popperOffsets.x+=Ht.x,k.modifiersData.popperOffsets.y+=xn),k.modifiersData[B]=ht}},Aa=["*"],Re=["dialog"];function pr(w){return"string"==typeof w}function yr(w){return null!=w}function Jn(w){return(w||document.body).getBoundingClientRect()}const Os={animation:!0,transitionTimerDelayMs:5},il=()=>{},{transitionTimerDelayMs:rl}=Os,Ta=new Map,c=(w,k,_,B)=>{let ie=B.context||{};const ve=Ta.get(k);if(ve)switch(B.runningTransition){case"continue":return Bt.E;case"stop":w.run(()=>ve.transition$.complete()),ie=Object.assign(ve.context,ie),Ta.delete(k)}const ht=_(k,B.animation,ie)||il;if(!B.animation||"none"===window.getComputedStyle(k).transitionProperty)return w.run(()=>ht()),(0,ft.of)(void 0).pipe(function xo(w){return k=>new A.y(_=>k.subscribe({next:ht=>w.run(()=>_.next(ht)),error:ht=>w.run(()=>_.error(ht)),complete:()=>w.run(()=>_.complete())}))}(w));const Ht=new tn.x,jt=new tn.x,xn=Ht.pipe(function se(...w){return k=>(0,Cn.z)(k,(0,ft.of)(...w))}(!0));Ta.set(k,{transition$:Ht,complete:()=>{jt.next(),jt.complete()},context:ie});const Fn=function Hr(w){const{transitionDelay:k,transitionDuration:_}=window.getComputedStyle(w);return 1e3*(parseFloat(k)+parseFloat(_))}(k);return w.runOutsideAngular(()=>{const or=(0,kt.R)(k,"transitionend").pipe((0,$t.R)(xn),(0,Ci.h)(({target:ur})=>ur===k));Ke((0,dn.H)(Fn+rl).pipe((0,$t.R)(xn)),or,jt).pipe((0,$t.R)(xn)).subscribe(()=>{Ta.delete(k),w.run(()=>{ht(),Ht.next(),Ht.complete()})})}),Ht.asObservable()};let C=(()=>{class w{constructor(){this.animation=Os.animation}}return w.\u0275fac=function(_){return new(_||w)},w.\u0275prov=D.Yz7({token:w,factory:w.\u0275fac,providedIn:"root"}),w})(),co=(()=>{class w{}return w.\u0275fac=function(_){return new(_||w)},w.\u0275mod=D.oAB({type:w}),w.\u0275inj=D.cJS({imports:[[N.ez]]}),w})(),dl=(()=>{class w{}return w.\u0275fac=function(_){return new(_||w)},w.\u0275mod=D.oAB({type:w}),w.\u0275inj=D.cJS({imports:[[N.ez]]}),w})(),ol=(()=>{class w{}return w.\u0275fac=function(_){return new(_||w)},w.\u0275mod=D.oAB({type:w}),w.\u0275inj=D.cJS({}),w})(),Du=(()=>{class w{}return w.\u0275fac=function(_){return new(_||w)},w.\u0275mod=D.oAB({type:w}),w.\u0275inj=D.cJS({imports:[[N.ez]]}),w})(),cu=(()=>{class w{}return w.\u0275fac=function(_){return new(_||w)},w.\u0275mod=D.oAB({type:w}),w.\u0275inj=D.cJS({}),w})();var M=(()=>{return(w=M||(M={}))[w.Tab=9]="Tab",w[w.Enter=13]="Enter",w[w.Escape=27]="Escape",w[w.Space=32]="Space",w[w.PageUp=33]="PageUp",w[w.PageDown=34]="PageDown",w[w.End=35]="End",w[w.Home=36]="Home",w[w.ArrowLeft=37]="ArrowLeft",w[w.ArrowUp=38]="ArrowUp",w[w.ArrowRight=39]="ArrowRight",w[w.ArrowDown=40]="ArrowDown",M;var w})();const pe=(w,k)=>!!k&&k.some(_=>_.contains(w)),De=(w,k)=>!k||null!=function pn(w,k){return k&&void 0!==w.closest?w.closest(k):null}(w,k),Fe="undefined"!=typeof navigator&&!!navigator.userAgent&&(/iPad|iPhone|iPod/.test(navigator.userAgent)||/Macintosh/.test(navigator.userAgent)&&navigator.maxTouchPoints&&navigator.maxTouchPoints>2||/Android/.test(navigator.userAgent));const He=["a[href]","button:not([disabled])",'input:not([disabled]):not([type="hidden"])',"select:not([disabled])","textarea:not([disabled])","[contenteditable]",'[tabindex]:not([tabindex="-1"])'].join(", ");function $e(w){const k=Array.from(w.querySelectorAll(He)).filter(_=>-1!==_.tabIndex);return[k[0],k[k.length-1]]}const tt=/\s+/,et=/  +/gi,Mt=/^start/,Et=/^end/,yt=/-(top|left)$/,It=/-(bottom|right)$/,Vt=/^left/,sn=/^right/,ni=/^start/,Xt=/^end/;function zn({placement:w,baseClass:k}){let _=Array.isArray(w)?w:w.split(tt),ie=_.findIndex(jt=>"auto"===jt);ie>=0&&["top","bottom","start","end","top-start","top-end","bottom-start","bottom-end","start-top","start-bottom","end-top","end-bottom"].forEach(function(jt){null==_.find(xn=>-1!==xn.search("^"+jt))&&_.splice(ie++,1,jt)});const ve=_.map(jt=>function Ct(w){return w.replace(Mt,"left").replace(Et,"right").replace(yt,"-start").replace(It,"-end")}(jt));return{placement:ve.shift(),modifiers:[{name:"bootstrapClasses",enabled:!!k,phase:"write",fn({state:jt}){const xn=new RegExp(k+"(-[a-z]+)*","gi"),Fn=jt.elements.popper,or=jt.placement;let qi=Fn.className;qi=qi.replace(xn,""),qi+=` ${function Ln(w,k){let[_,B]=k.split("-");const ie=_.replace(Vt,"start").replace(sn,"end");let ve=[ie];if(B){let ht=B;("left"===_||"right"===_)&&(ht=ht.replace(ni,"top").replace(Xt,"bottom")),ve.push(`${ie}-${ht}`)}return w&&(ve=ve.map(ht=>`${w}-${ht}`)),ve.join(" ")}(k,or)}`,qi=qi.trim().replace(et," "),Fn.className=qi}},hr,Xi,Ko,{enabled:!0,name:"flip",options:{fallbackPlacements:ve}},{enabled:!0,name:"preventOverflow",phase:"main",fn:function(){}}]}}function di(w){return w}function Un(w){return k=>(k.modifiers.push(Sa,{name:"offset",options:{offset:()=>w}}),k)}new Date(1882,10,12),new Date(2174,10,25);let Nc=(()=>{class w{}return w.\u0275fac=function(_){return new(_||w)},w.\u0275mod=D.oAB({type:w}),w.\u0275inj=D.cJS({imports:[[N.ez,wi.u5]]}),w})(),Xc=(()=>{class w{constructor(){this.autoClose=!0,this.placement=["bottom-start","bottom-end","top-start","top-end"]}}return w.\u0275fac=function(_){return new(_||w)},w.\u0275prov=D.Yz7({token:w,factory:w.\u0275fac,providedIn:"root"}),w})(),Vd=(()=>{class w{}return w.\u0275fac=function(_){return new(_||w)},w.\u0275dir=D.lG2({type:w,selectors:[["",8,"navbar"]]}),w})(),Oa=(()=>{class w{constructor(_,B){this.elementRef=_,this._renderer=B,this._disabled=!1}set disabled(_){this._disabled=""===_||!0===_,this._renderer.setProperty(this.elementRef.nativeElement,"disabled",this._disabled)}get disabled(){return this._disabled}}return w.\u0275fac=function(_){return new(_||w)(D.Y36(D.SBq),D.Y36(D.Qsj))},w.\u0275dir=D.lG2({type:w,selectors:[["","ngbDropdownItem",""]],hostAttrs:[1,"dropdown-item"],hostVars:3,hostBindings:function(_,B){2&_&&(D.Ikx("tabIndex",B.disabled?-1:0),D.ekj("disabled",B.disabled))},inputs:{disabled:"disabled"}}),w})(),jd=(()=>{class w{constructor(_,B){this.dropdown=_,this.placement="bottom",this.isOpen=!1,this.nativeElement=B.nativeElement}}return w.\u0275fac=function(_){return new(_||w)(D.Y36((0,D.Gpc)(()=>Jc)),D.Y36(D.SBq))},w.\u0275dir=D.lG2({type:w,selectors:[["","ngbDropdownMenu",""]],contentQueries:function(_,B,ie){if(1&_&&D.Suo(ie,Oa,4),2&_){let ve;D.iGM(ve=D.CRH())&&(B.menuItems=ve)}},hostVars:4,hostBindings:function(_,B){1&_&&D.NdJ("keydown.ArrowUp",function(ve){return B.dropdown.onKeyDown(ve)})("keydown.ArrowDown",function(ve){return B.dropdown.onKeyDown(ve)})("keydown.Home",function(ve){return B.dropdown.onKeyDown(ve)})("keydown.End",function(ve){return B.dropdown.onKeyDown(ve)})("keydown.Enter",function(ve){return B.dropdown.onKeyDown(ve)})("keydown.Space",function(ve){return B.dropdown.onKeyDown(ve)})("keydown.Tab",function(ve){return B.dropdown.onKeyDown(ve)})("keydown.Shift.Tab",function(ve){return B.dropdown.onKeyDown(ve)}),2&_&&D.ekj("dropdown-menu",!0)("show",B.dropdown.isOpen())}}),w})(),rd=(()=>{class w{constructor(_,B){this.dropdown=_,this.nativeElement=B.nativeElement}}return w.\u0275fac=function(_){return new(_||w)(D.Y36((0,D.Gpc)(()=>Jc)),D.Y36(D.SBq))},w.\u0275dir=D.lG2({type:w,selectors:[["","ngbDropdownAnchor",""]],hostAttrs:[1,"dropdown-toggle"],hostVars:1,hostBindings:function(_,B){2&_&&D.uIk("aria-expanded",B.dropdown.isOpen())}}),w})(),Th=(()=>{class w extends rd{constructor(_,B){super(_,B)}}return w.\u0275fac=function(_){return new(_||w)(D.Y36((0,D.Gpc)(()=>Jc)),D.Y36(D.SBq))},w.\u0275dir=D.lG2({type:w,selectors:[["","ngbDropdownToggle",""]],hostAttrs:[1,"dropdown-toggle"],hostVars:1,hostBindings:function(_,B){1&_&&D.NdJ("click",function(){return B.dropdown.toggle()})("keydown.ArrowUp",function(ve){return B.dropdown.onKeyDown(ve)})("keydown.ArrowDown",function(ve){return B.dropdown.onKeyDown(ve)})("keydown.Home",function(ve){return B.dropdown.onKeyDown(ve)})("keydown.End",function(ve){return B.dropdown.onKeyDown(ve)})("keydown.Tab",function(ve){return B.dropdown.onKeyDown(ve)})("keydown.Shift.Tab",function(ve){return B.dropdown.onKeyDown(ve)}),2&_&&D.uIk("aria-expanded",B.dropdown.isOpen())},features:[D._Bn([{provide:rd,useExisting:(0,D.Gpc)(()=>w)}]),D.qOj]}),w})(),Jc=(()=>{class w{constructor(_,B,ie,ve,ht,Ht,jt){this._changeDetector=_,this._document=ie,this._ngZone=ve,this._elementRef=ht,this._renderer=Ht,this._destroyCloseHandlers$=new tn.x,this._bodyContainer=null,this._positioning=function _n(){let w=null;return{createPopper(k){if(!w){let B=(k.updatePopperOptions||di)(zn(k));w=da(k.hostElement,k.targetElement,B)}},update(){w&&w.update()},setOptions(k){if(w){let B=(k.updatePopperOptions||di)(zn(k));w.setOptions(B)}},destroy(){w&&(w.destroy(),w=null)}}}(),this._open=!1,this.openChange=new D.vpe,this.placement=B.placement,this.container=B.container,this.autoClose=B.autoClose,this.display=jt?"static":"dynamic"}ngAfterContentInit(){this._ngZone.onStable.pipe((0,en.q)(1)).subscribe(()=>{this._applyPlacementClasses(),this._open&&this._setCloseHandlers()})}ngOnChanges(_){if(_.container&&this._open&&this._applyContainer(this.container),_.placement&&!_.placement.firstChange&&(this._positioning.setOptions({hostElement:this._anchor.nativeElement,targetElement:this._bodyContainer||this._menu.nativeElement,placement:this.placement,appendToBody:"body"===this.container}),this._applyPlacementClasses()),_.dropdownClass){const{currentValue:B,previousValue:ie}=_.dropdownClass;this._applyCustomDropdownClass(B,ie)}_.autoClose&&this._open&&(this.autoClose=_.autoClose.currentValue,this._setCloseHandlers())}isOpen(){return this._open}open(){this._open||(this._open=!0,this._applyContainer(this.container),this.openChange.emit(!0),this._setCloseHandlers(),this._anchor&&(this._anchor.nativeElement.focus(),"dynamic"===this.display&&this._ngZone.runOutsideAngular(()=>{this._positioning.createPopper({hostElement:this._anchor.nativeElement,targetElement:this._bodyContainer||this._menu.nativeElement,placement:this.placement,appendToBody:"body"===this.container,updatePopperOptions:Un([0,2])}),this._applyPlacementClasses(),this._zoneSubscription=this._ngZone.onStable.subscribe(()=>this._positionMenu())})))}_setCloseHandlers(){this._destroyCloseHandlers$.next(),function Ge(w,k,_,B,ie,ve,ht,Ht){_&&w.runOutsideAngular((w=>Fe?()=>setTimeout(()=>w(),100):w)(()=>{const xn=(0,kt.R)(k,"keydown").pipe((0,$t.R)(ie),(0,Ci.h)(qi=>qi.which===M.Escape),(0,Mi.b)(qi=>qi.preventDefault())),Fn=(0,kt.R)(k,"mousedown").pipe((0,an.U)(qi=>{const ur=qi.target;return 2!==qi.button&&!pe(ur,ht)&&("inside"===_?pe(ur,ve)&&De(ur,Ht):"outside"===_?!pe(ur,ve):De(ur,Ht)||!pe(ur,ve))}),(0,$t.R)(ie)),or=(0,kt.R)(k,"mouseup").pipe(kn(Fn),(0,Ci.h)(([qi,ur])=>ur),(0,mr.g)(0),(0,$t.R)(ie));Ke([xn.pipe((0,an.U)(qi=>0)),or.pipe((0,an.U)(qi=>1))]).subscribe(qi=>w.run(()=>B(qi)))}))}(this._ngZone,this._document,this.autoClose,_=>{this.close(),0===_&&this._anchor.nativeElement.focus()},this._destroyCloseHandlers$,this._menu?[this._menu.nativeElement]:[],this._anchor?[this._anchor.nativeElement]:[],".dropdown-item,.dropdown-divider")}close(){var _;this._open&&(this._open=!1,this._resetContainer(),this._positioning.destroy(),null===(_=this._zoneSubscription)||void 0===_||_.unsubscribe(),this._destroyCloseHandlers$.next(),this.openChange.emit(!1),this._changeDetector.markForCheck())}toggle(){this.isOpen()?this.close():this.open()}ngOnDestroy(){this.close()}onKeyDown(_){const B=_.which,ie=this._getMenuElements();let ve=-1,ht=null;const Ht=this._isEventFromToggle(_);if(!Ht&&ie.length&&ie.forEach((jt,xn)=>{jt.contains(_.target)&&(ht=jt),jt===this._document.activeElement&&(ve=xn)}),B!==M.Space&&B!==M.Enter){if(B!==M.Tab){if(Ht||ht){if(this.open(),ie.length){switch(B){case M.ArrowDown:ve=Math.min(ve+1,ie.length-1);break;case M.ArrowUp:if(this._isDropup()&&-1===ve){ve=ie.length-1;break}ve=Math.max(ve-1,0);break;case M.Home:ve=0;break;case M.End:ve=ie.length-1}ie[ve].focus()}_.preventDefault()}}else if(_.target&&this.isOpen()&&this.autoClose){if(this._anchor.nativeElement===_.target)return void("body"!==this.container||_.shiftKey?_.shiftKey&&this.close():(this._renderer.setAttribute(this._menu.nativeElement,"tabindex","0"),this._menu.nativeElement.focus(),this._renderer.removeAttribute(this._menu.nativeElement,"tabindex")));if("body"===this.container){const jt=this._menu.nativeElement.querySelectorAll(He);_.shiftKey&&_.target===jt[0]?(this._anchor.nativeElement.focus(),_.preventDefault()):!_.shiftKey&&_.target===jt[jt.length-1]&&(this._anchor.nativeElement.focus(),this.close())}else(0,kt.R)(_.target,"focusout").pipe((0,en.q)(1)).subscribe(({relatedTarget:jt})=>{this._elementRef.nativeElement.contains(jt)||this.close()})}}else ht&&(!0===this.autoClose||"inside"===this.autoClose)&&(0,kt.R)(ht,"click").pipe((0,en.q)(1)).subscribe(()=>this.close())}_isDropup(){return this._elementRef.nativeElement.classList.contains("dropup")}_isEventFromToggle(_){return this._anchor.nativeElement.contains(_.target)}_getMenuElements(){const _=this._menu;return null==_?[]:_.menuItems.filter(B=>!B.disabled).map(B=>B.elementRef.nativeElement)}_positionMenu(){const _=this._menu;this.isOpen()&&_&&("dynamic"===this.display?(this._positioning.update(),this._applyPlacementClasses()):this._applyPlacementClasses(this._getFirstPlacement(this.placement)))}_getFirstPlacement(_){return Array.isArray(_)?_[0]:_.split(" ")[0]}_resetContainer(){const _=this._renderer;this._menu&&_.appendChild(this._elementRef.nativeElement,this._menu.nativeElement),this._bodyContainer&&(_.removeChild(this._document.body,this._bodyContainer),this._bodyContainer=null)}_applyContainer(_=null){if(this._resetContainer(),"body"===_){const B=this._renderer,ie=this._menu.nativeElement,ve=this._bodyContainer=this._bodyContainer||B.createElement("div");B.setStyle(ve,"position","absolute"),B.setStyle(ie,"position","static"),B.setStyle(ve,"z-index","1055"),B.appendChild(ve,ie),B.appendChild(this._document.body,ve)}this._applyCustomDropdownClass(this.dropdownClass)}_applyCustomDropdownClass(_,B){const ie="body"===this.container?this._bodyContainer:this._elementRef.nativeElement;ie&&(B&&this._renderer.removeClass(ie,B),_&&this._renderer.addClass(ie,_))}_applyPlacementClasses(_){const B=this._menu;if(B){_||(_=this._getFirstPlacement(this.placement));const ie=this._renderer,ve=this._elementRef.nativeElement;ie.removeClass(ve,"dropup"),ie.removeClass(ve,"dropdown");const{nativeElement:ht}=B;"static"===this.display?(B.placement=null,ie.setAttribute(ht,"data-bs-popper","static")):(B.placement=_,ie.removeAttribute(ht,"data-bs-popper"));const Ht=-1!==_.search("^top")?"dropup":"dropdown";ie.addClass(ve,Ht);const jt=this._bodyContainer;jt&&(ie.removeClass(jt,"dropup"),ie.removeClass(jt,"dropdown"),ie.addClass(jt,Ht))}}}return w.\u0275fac=function(_){return new(_||w)(D.Y36(D.sBO),D.Y36(Xc),D.Y36(N.K0),D.Y36(D.R0b),D.Y36(D.SBq),D.Y36(D.Qsj),D.Y36(Vd,8))},w.\u0275dir=D.lG2({type:w,selectors:[["","ngbDropdown",""]],contentQueries:function(_,B,ie){if(1&_&&(D.Suo(ie,jd,5),D.Suo(ie,rd,5)),2&_){let ve;D.iGM(ve=D.CRH())&&(B._menu=ve.first),D.iGM(ve=D.CRH())&&(B._anchor=ve.first)}},hostVars:2,hostBindings:function(_,B){2&_&&D.ekj("show",B.isOpen())},inputs:{autoClose:"autoClose",dropdownClass:"dropdownClass",_open:["open","_open"],placement:"placement",container:"container",display:"display"},outputs:{openChange:"openChange"},exportAs:["ngbDropdown"],features:[D.TTD]}),w})(),zf=(()=>{class w{}return w.\u0275fac=function(_){return new(_||w)},w.\u0275mod=D.oAB({type:w}),w.\u0275inj=D.cJS({}),w})();class ku{constructor(k,_,B){this.nodes=k,this.viewRef=_,this.componentRef=B}}let Fr=(()=>{class w{constructor(_,B){this._el=_,this._zone=B}ngOnInit(){this._zone.onStable.asObservable().pipe((0,en.q)(1)).subscribe(()=>{c(this._zone,this._el.nativeElement,(_,B)=>{B&&Jn(_),_.classList.add("show")},{animation:this.animation,runningTransition:"continue"})})}hide(){return c(this._zone,this._el.nativeElement,({classList:_})=>_.remove("show"),{animation:this.animation,runningTransition:"stop"})}}return w.\u0275fac=function(_){return new(_||w)(D.Y36(D.SBq),D.Y36(D.R0b))},w.\u0275cmp=D.Xpm({type:w,selectors:[["ngb-modal-backdrop"]],hostAttrs:[2,"z-index","1055"],hostVars:6,hostBindings:function(_,B){2&_&&(D.Tol("modal-backdrop"+(B.backdropClass?" "+B.backdropClass:"")),D.ekj("show",!B.animation)("fade",B.animation))},inputs:{animation:"animation",backdropClass:"backdropClass"},decls:0,vars:0,template:function(_,B){},encapsulation:2}),w})();class mu{close(k){}dismiss(k){}}class Uf{constructor(k,_,B,ie){this._windowCmptRef=k,this._contentRef=_,this._backdropCmptRef=B,this._beforeDismiss=ie,this._closed=new tn.x,this._dismissed=new tn.x,this._hidden=new tn.x,k.instance.dismissEvent.subscribe(ve=>{this.dismiss(ve)}),this.result=new Promise((ve,ht)=>{this._resolve=ve,this._reject=ht}),this.result.then(null,()=>{})}get componentInstance(){if(this._contentRef&&this._contentRef.componentRef)return this._contentRef.componentRef.instance}get closed(){return this._closed.asObservable().pipe((0,$t.R)(this._hidden))}get dismissed(){return this._dismissed.asObservable().pipe((0,$t.R)(this._hidden))}get hidden(){return this._hidden.asObservable()}get shown(){return this._windowCmptRef.instance.shown.asObservable()}close(k){this._windowCmptRef&&(this._closed.next(k),this._resolve(k),this._removeModalElements())}_dismiss(k){this._dismissed.next(k),this._reject(k),this._removeModalElements()}dismiss(k){if(this._windowCmptRef)if(this._beforeDismiss){const _=this._beforeDismiss();!function q(w){return w&&w.then}(_)?!1!==_&&this._dismiss(k):_.then(B=>{!1!==B&&this._dismiss(k)},()=>{})}else this._dismiss(k)}_removeModalElements(){const k=this._windowCmptRef.instance.hide(),_=this._backdropCmptRef?this._backdropCmptRef.instance.hide():(0,ft.of)(void 0);k.subscribe(()=>{const{nativeElement:B}=this._windowCmptRef.location;B.parentNode.removeChild(B),this._windowCmptRef.destroy(),this._contentRef&&this._contentRef.viewRef&&this._contentRef.viewRef.destroy(),this._windowCmptRef=null,this._contentRef=null}),_.subscribe(()=>{if(this._backdropCmptRef){const{nativeElement:B}=this._backdropCmptRef.location;B.parentNode.removeChild(B),this._backdropCmptRef.destroy(),this._backdropCmptRef=null}}),at(k,_).subscribe(()=>{this._hidden.next(),this._hidden.complete()})}}var Eo=(()=>{return(w=Eo||(Eo={}))[w.BACKDROP_CLICK=0]="BACKDROP_CLICK",w[w.ESC=1]="ESC",Eo;var w})();let zl=(()=>{class w{constructor(_,B,ie){this._document=_,this._elRef=B,this._zone=ie,this._closed$=new tn.x,this._elWithFocus=null,this.backdrop=!0,this.keyboard=!0,this.dismissEvent=new D.vpe,this.shown=new tn.x,this.hidden=new tn.x}get fullscreenClass(){return!0===this.fullscreen?" modal-fullscreen":pr(this.fullscreen)?` modal-fullscreen-${this.fullscreen}-down`:""}dismiss(_){this.dismissEvent.emit(_)}ngOnInit(){this._elWithFocus=this._document.activeElement,this._zone.onStable.asObservable().pipe((0,en.q)(1)).subscribe(()=>{this._show()})}ngOnDestroy(){this._disableEventHandling()}hide(){const{nativeElement:_}=this._elRef,B={animation:this.animation,runningTransition:"stop"},ht=at(c(this._zone,_,()=>_.classList.remove("show"),B),c(this._zone,this._dialogEl.nativeElement,()=>{},B));return ht.subscribe(()=>{this.hidden.next(),this.hidden.complete()}),this._disableEventHandling(),this._restoreFocus(),ht}_show(){const _={animation:this.animation,runningTransition:"continue"};at(c(this._zone,this._elRef.nativeElement,(ve,ht)=>{ht&&Jn(ve),ve.classList.add("show")},_),c(this._zone,this._dialogEl.nativeElement,()=>{},_)).subscribe(()=>{this.shown.next(),this.shown.complete()}),this._enableEventHandling(),this._setFocus()}_enableEventHandling(){const{nativeElement:_}=this._elRef;this._zone.runOutsideAngular(()=>{(0,kt.R)(_,"keydown").pipe((0,$t.R)(this._closed$),(0,Ci.h)(ie=>ie.which===M.Escape)).subscribe(ie=>{this.keyboard?requestAnimationFrame(()=>{ie.defaultPrevented||this._zone.run(()=>this.dismiss(Eo.ESC))}):"static"===this.backdrop&&this._bumpBackdrop()});let B=!1;(0,kt.R)(this._dialogEl.nativeElement,"mousedown").pipe((0,$t.R)(this._closed$),(0,Mi.b)(()=>B=!1),(0,Sn.w)(()=>(0,kt.R)(_,"mouseup").pipe((0,$t.R)(this._closed$),(0,en.q)(1))),(0,Ci.h)(({target:ie})=>_===ie)).subscribe(()=>{B=!0}),(0,kt.R)(_,"click").pipe((0,$t.R)(this._closed$)).subscribe(({target:ie})=>{_===ie&&("static"===this.backdrop?this._bumpBackdrop():!0===this.backdrop&&!B&&this._zone.run(()=>this.dismiss(Eo.BACKDROP_CLICK))),B=!1})})}_disableEventHandling(){this._closed$.next()}_setFocus(){const{nativeElement:_}=this._elRef;if(!_.contains(document.activeElement)){const B=_.querySelector("[ngbAutofocus]"),ie=$e(_)[0];(B||ie||_).focus()}}_restoreFocus(){const _=this._document.body,B=this._elWithFocus;let ie;ie=B&&B.focus&&_.contains(B)?B:_,this._zone.runOutsideAngular(()=>{setTimeout(()=>ie.focus()),this._elWithFocus=null})}_bumpBackdrop(){"static"===this.backdrop&&c(this._zone,this._elRef.nativeElement,({classList:_})=>(_.add("modal-static"),()=>_.remove("modal-static")),{animation:this.animation,runningTransition:"continue"})}}return w.\u0275fac=function(_){return new(_||w)(D.Y36(N.K0),D.Y36(D.SBq),D.Y36(D.R0b))},w.\u0275cmp=D.Xpm({type:w,selectors:[["ngb-modal-window"]],viewQuery:function(_,B){if(1&_&&D.Gf(Re,7),2&_){let ie;D.iGM(ie=D.CRH())&&(B._dialogEl=ie.first)}},hostAttrs:["role","dialog","tabindex","-1"],hostVars:7,hostBindings:function(_,B){2&_&&(D.uIk("aria-modal",!0)("aria-labelledby",B.ariaLabelledBy)("aria-describedby",B.ariaDescribedBy),D.Tol("modal d-block"+(B.windowClass?" "+B.windowClass:"")),D.ekj("fade",B.animation))},inputs:{animation:"animation",ariaLabelledBy:"ariaLabelledBy",ariaDescribedBy:"ariaDescribedBy",backdrop:"backdrop",centered:"centered",fullscreen:"fullscreen",keyboard:"keyboard",scrollable:"scrollable",size:"size",windowClass:"windowClass",modalDialogClass:"modalDialogClass"},outputs:{dismissEvent:"dismiss"},ngContentSelectors:Aa,decls:4,vars:2,consts:[["role","document"],["dialog",""],[1,"modal-content"]],template:function(_,B){1&_&&(D.F$t(),D.TgZ(0,"div",0,1)(2,"div",2),D.Hsn(3),D.qZA()()),2&_&&D.Tol("modal-dialog"+(B.size?" modal-"+B.size:"")+(B.centered?" modal-dialog-centered":"")+B.fullscreenClass+(B.scrollable?" modal-dialog-scrollable":"")+(B.modalDialogClass?" "+B.modalDialogClass:""))},styles:["ngb-modal-window .component-host-scrollable{display:flex;flex-direction:column;overflow:hidden}\n"],encapsulation:2}),w})(),Eh=(()=>{class w{constructor(_){this._document=_}hide(){const _=Math.abs(window.innerWidth-this._document.documentElement.clientWidth),B=this._document.body,ie=B.style,{overflow:ve,paddingRight:ht}=ie;if(_>0){const Ht=parseFloat(window.getComputedStyle(B).paddingRight);ie.paddingRight=`${Ht+_}px`}return ie.overflow="hidden",()=>{_>0&&(ie.paddingRight=ht),ie.overflow=ve}}}return w.\u0275fac=function(_){return new(_||w)(D.LFG(N.K0))},w.\u0275prov=D.Yz7({token:w,factory:w.\u0275fac,providedIn:"root"}),w})(),Tc=(()=>{class w{constructor(_,B,ie,ve,ht,Ht){this._applicationRef=_,this._injector=B,this._document=ie,this._scrollBar=ve,this._rendererFactory=ht,this._ngZone=Ht,this._activeWindowCmptHasChanged=new tn.x,this._ariaHiddenValues=new Map,this._scrollBarRestoreFn=null,this._backdropAttributes=["animation","backdropClass"],this._modalRefs=[],this._windowAttributes=["animation","ariaLabelledBy","ariaDescribedBy","backdrop","centered","fullscreen","keyboard","scrollable","size","windowClass","modalDialogClass"],this._windowCmpts=[],this._activeInstances=new D.vpe,this._activeWindowCmptHasChanged.subscribe(()=>{if(this._windowCmpts.length){const jt=this._windowCmpts[this._windowCmpts.length-1];((w,k,_,B=!1)=>{this._ngZone.runOutsideAngular(()=>{const ie=(0,kt.R)(k,"focusin").pipe((0,$t.R)(_),(0,an.U)(ve=>ve.target));(0,kt.R)(k,"keydown").pipe((0,$t.R)(_),(0,Ci.h)(ve=>ve.which===M.Tab),kn(ie)).subscribe(([ve,ht])=>{const[Ht,jt]=$e(k);(ht===Ht||ht===k)&&ve.shiftKey&&(jt.focus(),ve.preventDefault()),ht===jt&&!ve.shiftKey&&(Ht.focus(),ve.preventDefault())}),B&&(0,kt.R)(k,"click").pipe((0,$t.R)(_),kn(ie),(0,an.U)(ve=>ve[1])).subscribe(ve=>ve.focus())})})(0,jt.location.nativeElement,this._activeWindowCmptHasChanged),this._revertAriaHidden(),this._setAriaHidden(jt.location.nativeElement)}})}_restoreScrollBar(){const _=this._scrollBarRestoreFn;_&&(this._scrollBarRestoreFn=null,_())}_hideScrollBar(){this._scrollBarRestoreFn||(this._scrollBarRestoreFn=this._scrollBar.hide())}open(_,B,ie,ve){const ht=ve.container instanceof HTMLElement?ve.container:yr(ve.container)?this._document.querySelector(ve.container):this._document.body,Ht=this._rendererFactory.createRenderer(null,null);if(!ht)throw new Error(`The specified modal container "${ve.container||"body"}" was not found in the DOM.`);this._hideScrollBar();const jt=new mu,xn=this._getContentRef(_,ve.injector||B,ie,jt,ve);let Fn=!1!==ve.backdrop?this._attachBackdrop(_,ht):void 0,or=this._attachWindowComponent(_,ht,xn),qi=new Uf(or,xn,Fn,ve.beforeDismiss);return this._registerModalRef(qi),this._registerWindowCmpt(or),qi.hidden.pipe((0,en.q)(1)).subscribe(()=>Promise.resolve(!0).then(()=>{this._modalRefs.length||(Ht.removeClass(this._document.body,"modal-open"),this._restoreScrollBar(),this._revertAriaHidden())})),jt.close=ur=>{qi.close(ur)},jt.dismiss=ur=>{qi.dismiss(ur)},this._applyWindowOptions(or.instance,ve),1===this._modalRefs.length&&Ht.addClass(this._document.body,"modal-open"),Fn&&Fn.instance&&(this._applyBackdropOptions(Fn.instance,ve),Fn.changeDetectorRef.detectChanges()),or.changeDetectorRef.detectChanges(),qi}get activeInstances(){return this._activeInstances}dismissAll(_){this._modalRefs.forEach(B=>B.dismiss(_))}hasOpenModals(){return this._modalRefs.length>0}_attachBackdrop(_,B){let ve=_.resolveComponentFactory(Fr).create(this._injector);return this._applicationRef.attachView(ve.hostView),B.appendChild(ve.location.nativeElement),ve}_attachWindowComponent(_,B,ie){let ht=_.resolveComponentFactory(zl).create(this._injector,ie.nodes);return this._applicationRef.attachView(ht.hostView),B.appendChild(ht.location.nativeElement),ht}_applyWindowOptions(_,B){this._windowAttributes.forEach(ie=>{yr(B[ie])&&(_[ie]=B[ie])})}_applyBackdropOptions(_,B){this._backdropAttributes.forEach(ie=>{yr(B[ie])&&(_[ie]=B[ie])})}_getContentRef(_,B,ie,ve,ht){return ie?ie instanceof D.Rgc?this._createFromTemplateRef(ie,ve):pr(ie)?this._createFromString(ie):this._createFromComponent(_,B,ie,ve,ht):new ku([])}_createFromTemplateRef(_,B){const ve=_.createEmbeddedView({$implicit:B,close(ht){B.close(ht)},dismiss(ht){B.dismiss(ht)}});return this._applicationRef.attachView(ve),new ku([ve.rootNodes],ve)}_createFromString(_){const B=this._document.createTextNode(`${_}`);return new ku([[B]])}_createFromComponent(_,B,ie,ve,ht){const Ht=_.resolveComponentFactory(ie),jt=D.zs3.create({providers:[{provide:mu,useValue:ve}],parent:B}),xn=Ht.create(jt),Fn=xn.location.nativeElement;return ht.scrollable&&Fn.classList.add("component-host-scrollable"),this._applicationRef.attachView(xn.hostView),new ku([[Fn]],xn.hostView,xn)}_setAriaHidden(_){const B=_.parentElement;B&&_!==this._document.body&&(Array.from(B.children).forEach(ie=>{ie!==_&&"SCRIPT"!==ie.nodeName&&(this._ariaHiddenValues.set(ie,ie.getAttribute("aria-hidden")),ie.setAttribute("aria-hidden","true"))}),this._setAriaHidden(B))}_revertAriaHidden(){this._ariaHiddenValues.forEach((_,B)=>{_?B.setAttribute("aria-hidden",_):B.removeAttribute("aria-hidden")}),this._ariaHiddenValues.clear()}_registerModalRef(_){const B=()=>{const ie=this._modalRefs.indexOf(_);ie>-1&&(this._modalRefs.splice(ie,1),this._activeInstances.emit(this._modalRefs))};this._modalRefs.push(_),this._activeInstances.emit(this._modalRefs),_.result.then(B,B)}_registerWindowCmpt(_){this._windowCmpts.push(_),this._activeWindowCmptHasChanged.next(),_.onDestroy(()=>{const B=this._windowCmpts.indexOf(_);B>-1&&(this._windowCmpts.splice(B,1),this._activeWindowCmptHasChanged.next())})}}return w.\u0275fac=function(_){return new(_||w)(D.LFG(D.z2F),D.LFG(D.zs3),D.LFG(N.K0),D.LFG(Eh),D.LFG(D.FYo),D.LFG(D.R0b))},w.\u0275prov=D.Yz7({token:w,factory:w.\u0275fac,providedIn:"root"}),w})(),Fc=(()=>{class w{constructor(_){this._ngbConfig=_,this.backdrop=!0,this.fullscreen=!1,this.keyboard=!0}get animation(){return void 0===this._animation?this._ngbConfig.animation:this._animation}set animation(_){this._animation=_}}return w.\u0275fac=function(_){return new(_||w)(D.LFG(C))},w.\u0275prov=D.Yz7({token:w,factory:w.\u0275fac,providedIn:"root"}),w})(),Xs=(()=>{class w{constructor(_,B,ie,ve){this._moduleCFR=_,this._injector=B,this._modalStack=ie,this._config=ve}open(_,B={}){const ie=Object.assign(Object.assign(Object.assign({},this._config),{animation:this._config.animation}),B);return this._modalStack.open(this._moduleCFR,this._injector,_,ie)}get activeInstances(){return this._modalStack.activeInstances}dismissAll(_){this._modalStack.dismissAll(_)}hasOpenModals(){return this._modalStack.hasOpenModals()}}return w.\u0275fac=function(_){return new(_||w)(D.LFG(D._Vd),D.LFG(D.zs3),D.LFG(Tc),D.LFG(Fc))},w.\u0275prov=D.Yz7({token:w,factory:w.\u0275fac,providedIn:"root"}),w})(),Al=(()=>{class w{}return w.\u0275fac=function(_){return new(_||w)},w.\u0275mod=D.oAB({type:w}),w.\u0275inj=D.cJS({providers:[Xs]}),w})(),zc=(()=>{class w{}return w.\u0275fac=function(_){return new(_||w)},w.\u0275mod=D.oAB({type:w}),w.\u0275inj=D.cJS({imports:[[N.ez]]}),w})(),ad=(()=>{class w{}return w.\u0275fac=function(_){return new(_||w)},w.\u0275mod=D.oAB({type:w}),w.\u0275inj=D.cJS({imports:[[N.ez]]}),w})(),th=(()=>{class w{}return w.\u0275fac=function(_){return new(_||w)},w.\u0275mod=D.oAB({type:w}),w.\u0275inj=D.cJS({imports:[[N.ez]]}),w})(),ic=(()=>{class w{}return w.\u0275fac=function(_){return new(_||w)},w.\u0275mod=D.oAB({type:w}),w.\u0275inj=D.cJS({imports:[[N.ez]]}),w})(),Fu=(()=>{class w{}return w.\u0275fac=function(_){return new(_||w)},w.\u0275mod=D.oAB({type:w}),w.\u0275inj=D.cJS({imports:[[N.ez]]}),w})(),eu=(()=>{class w{}return w.\u0275fac=function(_){return new(_||w)},w.\u0275mod=D.oAB({type:w}),w.\u0275inj=D.cJS({imports:[[N.ez]]}),w})(),Mh=(()=>{class w{}return w.\u0275fac=function(_){return new(_||w)},w.\u0275mod=D.oAB({type:w}),w.\u0275inj=D.cJS({imports:[[N.ez]]}),w})(),Ih=(()=>{class w{}return w.\u0275fac=function(_){return new(_||w)},w.\u0275mod=D.oAB({type:w}),w.\u0275inj=D.cJS({}),w})();new D.OlP("live announcer delay",{providedIn:"root",factory:function _u(){return 100}});let Xd=(()=>{class w{}return w.\u0275fac=function(_){return new(_||w)},w.\u0275mod=D.oAB({type:w}),w.\u0275inj=D.cJS({imports:[[N.ez]]}),w})(),gd=(()=>{class w{}return w.\u0275fac=function(_){return new(_||w)},w.\u0275mod=D.oAB({type:w}),w.\u0275inj=D.cJS({}),w})();const nf=[co,dl,ol,Du,cu,Nc,zf,Al,zc,gd,ad,th,ic,Fu,eu,Mh,Ih,Xd];let _d=(()=>{class w{}return w.\u0275fac=function(_){return new(_||w)},w.\u0275mod=D.oAB({type:w}),w.\u0275inj=D.cJS({imports:[nf,co,dl,ol,Du,cu,Nc,zf,Al,zc,gd,ad,th,ic,Fu,eu,Mh,Ih,Xd]}),w})()},5861:(Bi,Zt,fe)=>{"use strict";function D(A,l,oe,lt,At,Ke,ct){try{var _t=A[Ke](ct),Nt=_t.value}catch(wt){return void oe(wt)}_t.done?l(Nt):Promise.resolve(Nt).then(lt,At)}function N(A){return function(){var l=this,oe=arguments;return new Promise(function(lt,At){var Ke=A.apply(l,oe);function ct(Nt){D(Ke,lt,At,ct,_t,"next",Nt)}function _t(Nt){D(Ke,lt,At,ct,_t,"throw",Nt)}ct(void 0)})}}fe.d(Zt,{Z:()=>N})}},Bi=>{Bi(Bi.s=7563)}]);